[{"id": 103, "euler_id": 103, "title": "Special subset sums: optimum", "problem": "Let S(A) represent the sum of elements in set A of size n. We shall call it a special sum set if for any two non-empty disjoint subsets, B and C, the following properties are true:\nS(B) \u2260 S(C); that is, sums of subsets cannot be equal.\nIf B contains more elements than C then S(B) > S(C).\nIf S(A) is minimised for a given n, we shall call it an optimum special sum set. The first five optimum special sum sets are given below.\nn = 1: {1}n = 2: {1, 2}n = 3: {2, 3, 4}n = 4: {3, 5, 6, 7}n = 5: {6, 9, 11, 12, 13}\nIt seems that for a given optimum set, A = {a1, a2, ... , an}, the next optimum set is of the form B = {b, a1+b, a2+b, ... ,an+b}, where b is the \"middle\" element on the previous row.\nBy applying this \"rule\" we would expect the optimum set for n = 6 to be A = {11, 17, 20, 22, 23, 24}, with S(A) = 117. However, this is not the optimum set, as we have merely applied an algorithm to provide a near optimum set. The optimum set for n = 6 is A = {11, 18, 19, 20, 22, 25}, with S(A) = 115 and corresponding set string: 111819202225.\nGiven that A is an optimum special sum set for n = 7, find its set string.\nNOTE: This problem is related to Problem 105 and Problem 106.", "solution": "20313839404245", "difficulty": 45, "story": "Once upon a time, in a small village nestled among green hills, there lived an old wise woman named Mabel. Mabel was known throughout the village for her extraordinary wisdom and her ability to solve any problem thrown her way. People often sought her guidance, and she never disappointed.\n\nOne fine morning, as the sun painted the sky with hues of orange and pink, a young villager named Ethan approached Mabel's humble cottage. Ethan had a dilemma that he hoped Mabel could help him solve. He walked up to her door, took a deep breath, and knocked gently.\n\nMabel welcomed Ethan inside and listened attentively as he poured out his worries. \"Mabel, I am facing a mathematical problem,\" Ethan began. \"It revolves around a special type of sum set. I've been trying to solve it, but to no avail. Can you lend me your wisdom?\"\n\nMabel smiled warmly and motioned for Ethan to sit down beside her. As he explained the problem, she nodded thoughtfully, familiar with the intricacies of these special sum sets. She began to ponder how to weave this mathematical problem into a story that would help Ethan grasp its essence.\n\n\"My dear Ethan,\" Mabel began, \"imagine a kingdom ruled by a just and wise king. This kingdom was once plagued by disputes and unfair division of resources. Determined to find a solution, the king summoned his court mathematician, a brilliant mind named Professor Abacus.\"\n\nProfessor Abacus knew that mathematics held the key to resolving the kingdom's problems. He delved deep into his studies and discovered a magical set called an optimum special sum set. This set possessed unique characteristics that maintained harmony and fairness among different groups in the kingdom.\n\nThe king was enthralled by this concept and implored Professor Abacus to create a plan for implementing such a set. After extensive research and calculations, the professor devised a groundbreaking formula to construct the optimum special sum sets for any given size, n.\n\n\"The first five optimum special sum sets he created were magnificent,\" Mabel continued, \"and soon, the kingdom flourished as peace and prosperity spread throughout its lands. The sets went like this: {1}, {1, 2}, {2, 3, 4}, {3, 5, 6, 7}, and {6, 9, 11, 12, 13} for n equal to 1, 2, 3, 4, and 5, respectively.\"\n\nEthan marveled at the elegant simplicity of the sets but still wondered how they connected to his own mathematical problem. Mabel smiled knowingly and continued her tale.\n\n\"Legend has it,\" Mabel said with a twinkle in her eye, \"that Professor Abacus stumbled upon a peculiar pattern while creating these sets. He noticed that each subsequent optimum set could be obtained by adding a 'middle' element, b, to the previous set. This created a new set, B, where each element is equal to b plus the corresponding element from the previous set, A. This 'rule' seemed to lead him closer to the true optimum set for each n.\"\n\nEthan's eyes grew wider as he began to understand the connection between his problem and Professor Abacus' findings. The scenario weave Mabel created made the mathematical problem tangible and relevant.\n\n\"But,\" Mabel continued, raising an eyebrow playfully, \"the true optimum set is not always as it seems. Though it might seem that A = {11, 17, 20, 22, 23, 24} is the optimum set for n = 6, this is a mere approximation. The actual optimum set for n = 6 is A = {11, 18, 19, 20, 22, 25}, with a minimum sum of 115.\"\n\nEthan was fascinated by this revelation and eagerly waited for Mabel to unveil the full truth. There was a genuine excitement in his voice as he asked, \"So, dear Mabel, if A is an optimum special sum set for n = 7, what is its set string?\"\n\nMabel smiled, savoring the moment before revealing the answer. She knew that Ethan's curiosity had been piqued, and he had become invested in understanding the mathematical problem.\n\nAnd so, dear reader, with Ethan anxiously awaiting the answer, I leave you with the same question. If A is an optimum special sum set for n = 7, what is its set string?"}, {"id": 109, "euler_id": 109, "title": "Darts", "problem": "In the game of darts a player throws three darts at a target board which is split into twenty equal sized sections numbered one to twenty.\n\n\nThe score of a dart is determined by the number of the region that the dart lands in. A dart landing outside the red/green outer ring scores zero. The black and cream regions inside this ring represent single scores. However, the red/green outer ring and middle ring score double and treble scores respectively.\nAt the centre of the board are two concentric circles called the bull region, or bulls-eye. The outer bull is worth 25 points and the inner bull is a double, worth 50 points.\nThere are many variations of rules but in the most popular game the players will begin with a score 301 or 501 and the first player to reduce their running total to zero is a winner. However, it is normal to play a \"doubles out\" system, which means that the player must land a double (including the double bulls-eye at the centre of the board) on their final dart to win; any other dart that would reduce their running total to one or lower means the score for that set of three darts is \"bust\".\nWhen a player is able to finish  on their current score it is called a \"checkout\" and the highest checkout is 170: T20 T20 D25 (two treble 20s and double bull).\nThere are exactly eleven distinct ways to checkout on a score of 6:\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\nD3D1D2S2D2D2D1S4D1S1S1D2S1T1D1S1S3D1D1D1D1D1S2D1S2S2D1\nNote that D1 D2 is considered different to D2 D1 as they finish on different doubles. However, the combination S1 T1 D1 is considered the same as T1 S1 D1.\nIn addition we shall not include misses in considering combinations; for example, D3 is the same as 0 D3 and 0 0 D3.\nIncredibly there are 42336 distinct ways of checking out in total.\nHow many distinct ways can a player checkout with a score less than 100?", "solution": "38182", "difficulty": 45, "story": "Billy sat at the edge of his bed, contemplating the dartboard on his bedroom wall. He had always been fascinated by the game of darts, its precision and strategy. But today, there was more to it than just a game. Today, it held the key to his future.\n\nHis father, a former professional dart player, had passed away a few years ago. Billy had inherited not only his father's cherished dartboard but also his love for the sport. Now, standing at the crossroads of his life, Billy had a tough decision to make.\n\nHe wanted to pursue a career in darts, just like his father, but he knew it would be a risk. The odds of making it big in the competitive world of professional darts were slim. As he stared at the dartboard, he wondered if he could use the game itself to guide his decision.\n\nBilly's eyes fell upon the list of distinct ways to checkout on a score of 6. He couldn't help but marvel at the complexity of the game. Each throw had the potential to shape his fate. He began to imagine the possibilities, the combinations of darts that could lead him to victory.\n\nLost in thought, Billy's mind wandered to the mathematical problem he had read about earlier, the one about the number of distinct ways to checkout with a score less than 100. He realized that this problem was a metaphor for his own journey. Each option represented a different path he could take, with different risks and rewards.\n\nAs Billy stared at the dartboard, he felt a sense of clarity wash over him. This game was about so much more than just numbers and calculations. It was a symbol of his father's legacy and his own dreams. With a determined look on his face, he made up his mind.\n\nThe next day, Billy walked into the local dart competition. The stakes were high, but he was ready. He stepped up to the oche, dart in hand, and focused on the target ahead. The crowd fell silent as he threw his first dart. \n\nAs the dart soared through the air, time seemed to stand still. Billy watched with bated breath as it landed in the treble 20, a perfect start. With each subsequent throw, he calculated his every move, strategizing his way through the game.\n\nThe game went on, and with every dart, Billy grew more confident. He could feel the crowd's energy building, their excitement fueling his determination. One by one, he eliminated his opponents, his precision and skill shining through.\n\nFinally, it all came down to a single throw. Billy stood at a score of 54, with the possibility of checking out with a bullseye-double top combination. The pressure was immense, but he knew this was his moment.\n\nAs he raised his arm, he cast his doubts aside. This was what he had trained for, what he had sacrificed for. With one swift motion, he released the dart, watching it soar towards the board.\n\nAs the dart landed in the bullseye, the crowd erupted in applause. Billy had done it. He had made the impossible seem easy. In that moment, he knew he had chosen the right path, the path of darts.\n\nBut as the cheers died down, a new question formed in Billy's mind. How many distinct ways could he have checked out with a score less than 100? His victory was just the beginning, and he was ready to prove that he had what it took to become a champion.\n\nAnd so, as Billy basked in the glory of his triumph, a new journey began. A journey that would not only test his mathematical prowess but also his skills on the dartboard. The question remained unanswered, waiting to be solved.\n\nHow many distinct ways could a player check out with a score less than 100?\n\nAs Billy embarked on this quest for knowledge, he knew that the answer would shape not only his game but also his destiny."}, {"id": 111, "euler_id": 111, "title": "Primes with runs", "problem": "Considering 4-digit primes containing repeated digits it is clear that they cannot all be the same: 1111 is divisible by 11, 2222 is divisible by 22, and so on. But there are nine 4-digit primes containing three ones:\n1117, 1151, 1171, 1181, 1511, 1811, 2111, 4111, 8111\nWe shall say that M(n, d) represents the maximum number of repeated digits for an n-digit prime where d is the repeated digit, N(n, d) represents the number of such primes, and S(n, d) represents the sum of these primes.\nSo M(4, 1) = 3 is the maximum number of repeated digits for a 4-digit prime where one is the repeated digit, there are N(4, 1) = 9 such primes, and the sum of these primes is S(4, 1) = 22275. It turns out that for d = 0, it is only possible to have M(4, 0) = 2 repeated digits, but there are N(4, 0) = 13 such cases.\nIn the same way we obtain the following results for 4-digit primes.\n\nDigit, d\nM(4, d)\nN(4, d)\nS(4, d)\n0\n2\n13\n67061\n1\n3\n9\n22275\n2\n3\n1\n2221\n3\n3\n12\n46214\n4\n3\n2\n8888\n5\n3\n1\n5557\n6\n3\n1\n6661\n7\n3\n9\n57863\n8\n3\n1\n8887\n9\n3\n7\n48073\n\nFor d = 0 to 9, the sum of all S(4, d) is 273700.\nFind the sum of all S(10, d).", "solution": "612407567715", "difficulty": 45, "story": "Once upon a time in the quiet town of Numeria, a young girl named Emma had a peculiar fascination with numbers. She found mathematics to be like an enchanted realm, where patterns and relationships revealed themselves in the most captivating ways. Emma spent countless hours exploring the mysteries of numbers, often losing herself in their mesmerizing world.\n\nOne sunny afternoon, Emma stumbled upon an old book in a dusty corner of the town library. Its pages were worn and yellowed, exuding the scent of countless tales and forgotten knowledge. Intrigued, she opened it to a random page and her eyes fell upon a mathematical problem that seized her attention.\n\nThe problem, presented before her, was a captivating enigma that revolved around prime numbers and repeated digits. It intrigued Emma immensely, beckoning her into the realm of numbers once again. She read how four-digit primes with repeated digits posed a unique challenge, as they had to be carefully crafted to ensure they remained prime.\n\nEmma delved deeper into the problem, discovering that for each digit from 0 to 9, there existed a maximum number of repeated digits, denoted as M(4, d). Moreover, N(4, d) represented the number of such primes, and S(4, d) signified the sum of these primes.\n\nAs Emma perused through the list of M(4, d), N(4, d), and S(4, d) values, she marveled at the intricate web woven by numbers. The pages came alive with patterns and connections, captivating her imagination. She found herself yearning to embark on a quest to find the sum of all S(10, d).\n\nThe young mathematician couldn't help but wonder what secrets lay concealed behind these numbers. As she mulled over the problem in her mind, Emma felt an irresistible pull drawing her into the mathematical realm she loved so dearly. She realized that the answer to this question was not just a mere number but a gateway to understanding the underlying beauty of prime numbers and their unique properties.\n\nDriven by insatiable curiosity, Emma embarked on a journey of exploration and discovery. Armed with her trusty notebook and pencil, she meticulously started analyzing patterns, listing potential solutions, and unraveling the hidden meaning of primes with repeated digits.\n\nDays turned into weeks, and weeks turned into months, but Emma remained steadfast in her quest. She poured over renowned works of mathematics, delving into the minds of great mathematicians who came before her. The more Emma learned, the more fascinated she became by the infinite intricacies of numbers.\n\nThe people of Numeria watched in awe as Emma dedicated herself to understanding the profound secrets hidden within the mathematical problem. News of her quest spread far and wide, attracting the attention of mathematicians from distant lands. They, too, were captivated by her relentless pursuit of knowledge and the unyielding passion she displayed.\n\nAs Emma continued her journey, her understanding deepened, and her love for numbers flourished. She discovered new ways to approach the problem, unearthing previously unseen connections and patterns. Her notebook became her trusted ally, filled with scribbles and joyous exclamations marking each new revelation she stumbled upon.\n\nFinally, after months of tireless work and unwavering determination, Emma stood on the precipice of discovery. With each piece of the puzzle falling into place, she could almost taste the victory that awaited her. But as she reached the climax of her journey, Emma was struck by a question that lingered in her mind.\n\nShe wondered if others could unlock the secrets of the mathematical problem she had become so enthralled by. Would someone else perceive the patterns that had revealed themselves to her? Could they decipher the hidden messages within the numbers, just as she had?\n\nThe question echoed through Emma's mind, fueling her passion and insatiable curiosity. She knew that the answer lay not only within her, but within the hearts and minds of countless individuals who held a love for numbers themselves.\n\nAnd so, as Emma embarked on the final steps of her journey, she pondered the question that would linger in the hearts of mathematicians and number enthusiasts alike. Emma wondered if others would be able to find the sum of all S(10, d) - the sum of all four-digit primes with repeated digits for each digit from 0 to 9.\n\nHer journey had come to an end, but the adventure for others was just beginning. And with this question, Emma hoped to ignite a flame of curiosity in the minds of those who dare to explore the enchanting realm of numbers."}, {"id": 118, "euler_id": 118, "title": "Pandigital prime sets", "problem": "Using all of the digits 1 through 9 and concatenating them freely to form decimal integers, different sets can be formed. Interestingly with the set {2,5,47,89,631}, all of the elements belonging to it are prime.\nHow many distinct sets containing each of the digits one through nine exactly once contain only prime elements?", "solution": "44680", "difficulty": 45, "story": "Once upon a time in the quiet village of Numerica, there lived a curious young girl named Abigail. Abigail had always been fascinated by numbers and their infinite possibilities. She found herself spending hours immersed in a world of equations, equations and more equations, seeking patterns in the vast ocean of digits.\n\nOne sunny day, as Abigail was walking through the village, musing over calculations in her head, she noticed a mysterious old man sitting alone on a bench. He seemed lost in thought, and Abigail could sense an air of intelligence emanating from him.\n\nCuriosity getting the better of her, Abigail approached the old man. \"Excuse me, sir,\" she said shyly, \"Are you pondering a math problem?\"\n\nThe old man looked up, a glimmer of intrigue dancing in his eyes. \"Ah, my dear, it seems you have an affinity for numbers. As a matter of fact, yes,\" he replied. \"I've been grappling with a rather peculiar mathematical problem I came across recently.\"\n\nIntrigued, Abigail sat down beside the old man, her excitement palpable. \"Please sir, tell me more about this intriguing problem. I would love to help if I can.\"\n\nA smile appeared on the old man's face as he began to explain. \"Using all of the digits from 1 to 9, we can freely concatenate them to form decimal integers. And, my dear, from this playful rearrangement of numbers, we can create different sets.\"\n\nAbigail's eyes widened with excitement. \"Oh, I can already see the infinite possibilities, sir! But what makes this problem so special?\"\n\nThe old man leaned forward, his voice dropping to a whisper. \"Well, my dear, among these sets, there is a particular set with the elements {2, 5, 47, 89, 631}. Astonishingly, every single element in this set is a prime number.\"\n\nAbigail gasped, her mind racing to grasp the magnitude of such a discovery. \"That is truly remarkable, sir! But now, the question arises - how many distinct sets, containing each of the digits one through nine exactly once, can we form with only prime elements?\"\n\nThe old man nodded, impressed by Abigail's quick understanding. \"Precisely, my dear! That is the essence of the problem I am trying to untangle. The answer lies somewhere within the arcane depths of the numerical realm.\"\n\nWith their curiosity ablaze, Abigail and the old man began to discuss and debate, their minds buzzing with endless possibilities and potential solutions. They spent hours lost in their quest for answers, relishing every moment of the intellectual adventure.\n\nDays turned into weeks, and weeks into months, as the two intricate minds navigated the fascinating enigma together. Exploring various number arrangements and diving into the intricacies of prime numbers, they marveled at the limitless domains of mathematics.\n\nBut the question remained unanswered, an elusive secret that lingered between them and the vast universe of numbers. As dusk settled upon Numerica, Abigail looked at the old man with a spark of determination in her eyes.\n\n\"Sir, we have delved deep into this mathematical mystery, uncovering endless wonders. Yet, this question continues to elude us. Shall we rest for the night and continue our exploration tomorrow?\"\n\nThe old man smiled warmly, his eyes twinkling with pride. \"My dear Abigail, you are truly a remarkable young mathematician. Sleep well, and let the numbers dance through your dreams. For tomorrow, the answer awaits us, hidden within the symphony of digits.\"\n\nAnd so, as the stars filled the night sky, Abigail's dreams were filled with numerical patterns, prime numbers, and a quest for answers. As dawn broke, she would awake with fresh determination, ready to dive back into the enchanting world of mathematics and seek the solution to their grand mathematical problem.\n\nBut now, dear reader, it is your turn to embrace this mathematical quest. How many distinct sets, containing each of the digits one through nine exactly once, can be formed with only prime elements? The answer awaits, eager to be discovered by a curious mind like yours."}, {"id": 129, "euler_id": 129, "title": "Repunit divisibility", "problem": "A number consisting entirely of ones is called a repunit. We shall define R(k) to be a repunit of length k; for example, R(6) = 111111.\nGiven that n is a positive integer and GCD(n, 10) = 1, it can be shown that there always exists a value, k, for which R(k) is divisible by n, and let A(n) be the least such value of k; for example, A(7) = 6 and A(41) = 5.\nThe least value of n for which A(n) first exceeds ten is 17.\nFind the least value of n for which A(n) first exceeds one-million.", "solution": "1000023", "difficulty": 45, "story": "Once upon a time, in the enchanting kingdom of Mathlandia, there lived a young princess named Amelia. She was a clever girl, always seeking knowledge and finding delight in the realms of numbers and solutions. But little did she know that her insatiable curiosity would soon lead her on a truly remarkable adventure.\n\nOne sunny morning, while Princess Amelia was studying in the royal library, she came across an ancient scroll hidden beneath a stack of dusty books. Intrigued, she gently unraveled the scroll to reveal a series of intriguing mathematical puzzles and tales of numerical wonders. Her eyes widened with excitement as she immersed herself in the captivating stories.\n\nAmongst the tales lay a fascinating problem, one that captivated Princess Amelia's imagination. It was the story of R(k), the repunit of length k, and its curious relationship with positive integers. The scroll revealed that for any positive integer n whose greatest common divisor with 10 was 1, there would always exist a value, k, for which the repunit R(k) was divisible by n. Her heart raced with anticipation as she realized the significance of this discovery.\n\nDeeply intrigued by this mathematical enigma, Princess Amelia embarked on a quest to unravel its secrets. She consulted with the wise sages of Mathlandia, scoured ancient scrolls, and experimented with various numbers. Days turned into weeks, and weeks into months, but the princess remained undeterred.\n\nOne night, as she lay sleepless in her chambers, a brilliant idea struck her. \"What if,\" she pondered, \"I could find the least value of n for which the repunit R(k) first exceeds one-million?\" The very thought ignited a spark within her, driving away her fatigue and filling her mind with renewed energy. She felt compelled to solve this intricate puzzle but knew she needed more time.\n\nWith her calculation gears turning rapidly, Princess Amelia set forth on a grand adventure. She traversed through the majestic forests of Polynomialand, climbed the towering peaks of Algorithmia, and even sailed across the shimmering seas of the calculus coast. Along the way, she encountered countless challenges and marveled at the magical wonders of mathematics.\n\nFinally, after months of tireless exploration, Princess Amelia found herself at the summit of a misty peak. She gazed at the vast expanse of Mathlandia laid out before her, her heart pulsating with anticipation. The time had come to find the answer to her question, the least value of n where R(k) exceeds one-million.\n\nBut just as she was about to proceed with her calculations, a sudden gust of wind stole her breath away. The ancient scroll slipped from her hands and disappeared into the abyss below. Fear gripped her heart, but she realized that the solution she sought was not lost.\n\nWith unwavering resolve, Princess Amelia asked herself the question that had motivated her throughout her incredible journey. \"What,\" she called out to the universe, \"is the least value of n for which A(n) first exceeds one-million?\"\n\nAs the echoes of her question faded into the distant mountains, Princess Amelia felt a sense of fulfillment. Though she may never know the answer, she had learned that the true beauty of mathematics lies not in the solutions they provide, but in the unending possibilities they create.\n\nAnd so, dear reader, I present this question to you: What is the least value of n for which A(n) first exceeds one-million? The answer awaits your curiosity and determination as you embark on your very own journey of mathematical exploration."}, {"id": 130, "euler_id": 130, "title": "Composites with prime repunit property", "problem": "A number consisting entirely of ones is called a repunit. We shall define R(k) to be a repunit of length k; for example, R(6) = 111111.\nGiven that n is a positive integer and GCD(n, 10) = 1, it can be shown that there always exists a value, k, for which R(k) is divisible by n, and let A(n) be the least such value of k; for example, A(7) = 6 and A(41) = 5.\nYou are given that for all primes, p > 5, that p \u2212 1 is divisible by A(p). For example, when p = 41, A(41) = 5, and 40 is divisible by 5.\nHowever, there are rare composite values for which this is also true; the first five examples being 91, 259, 451, 481, and 703.\nFind the sum of the first twenty-five composite values of n for whichGCD(n, 10) = 1 and n \u2212 1 is divisible by A(n).", "solution": "149253", "difficulty": 45, "story": "Once upon a time, in a small village nestled at the foot of a majestic mountain, there lived a young, brilliant mathematician named Elena. She possessed an insatiable curiosity for numbers and a mind that could solve even the most perplexing mathematical problems. Her fame spread far and wide, attracting scholars and admirers from distant lands.\n\nIt was a sunny day when Elena received a letter from the Royal Palace. The kingdom's King had heard of her remarkable abilities and summoned her to the capital. Filled with excitement and a touch of nervousness, Elena embarked on a journey that would change her life forever.\n\nArriving at the opulent palace, Elena was escorted to the grand chamber, where the King sat upon his throne. He explained the conundrum that had been baffling his royal mathematicians for years - the enigma of the repunits and composite numbers.\n\nElena listened intently as the King detailed the problem. She learned about repunits, numbers comprised solely of ones. The King explained how these repunits could be expressed as R(k), where k denoted the length of the repunit. Furthermore, he stated that for any positive integer n that was coprime with ten, there would always exist a value k for which R(k) would be divisible by n. The King called this value A(n), the smallest such value. Elena's mind raced as her curiosity ignited with fervor.\n\nBut the intrigue did not end there. The King revealed that he had discovered a peculiar pattern among certain composite numbers. Normally, only primes greater than five had a connection with A(n). However, the King had discovered five rare composite numbers - 91, 259, 451, 481, and 703 - that satisfied the same condition. He urged Elena to investigate further, for he believed that these composite numbers held the key to unraveling the mysteries of repunits and their connection to composite numbers.\n\nElena's passion for numbers burned bright, and she accepted the challenge with a resolute determination. Days turned into weeks, and weeks turned into months as she delved deeper into the complex web of mathematics. Her days and nights were consumed by calculations, formulas, and an insatiable hunger for knowledge.\n\nAs Elena meticulously examined the properties of repunits and composite numbers, a realization struck her. A detailed and brilliantly intricate pattern emerged, revealing the fundamental link between the prime numbers and composite numbers that satisfied the condition. The numbers were meticulously intertwined, almost as if nature had designed it so.\n\nBut the revelation was bittersweet. Questions gnawed at Elena's mind, for the pattern seemed too perfect, too deliberate. Why were these particular composite numbers obeying the same rule as the primes? What was the significance of this connection? It was clear that the answer lay hidden within the realm of numbers, but Elena needed time to unravel the intricacies of this complex riddle.\n\nElena's journey had just begun, and even as the sun set on her last day at the palace, she could not rest. The King thanked her for her efforts and offered generous rewards, but Elena's mind was fixated on the puzzle before her. She had to discover the underlying reason behind the connection between composite numbers and repunits.\n\nAs she bid farewell to the palace and embarked on her return journey, a longing for answers burned within her heart. And so, the question lingered on her lips, ready to spill with the fervency of her desire. How could she find the sum of the first twenty-five composite values of n, where GCD(n, 10) equaled one, and n minus one was divisible by A(n)?\n\nHer journey had just begun, but the answer, she hoped, would eventually reveal itself. And so, dear reader, the question now falls to you. Can the puzzle be solved? Can you find the sum that eluded Elena and even the greatest mathematicians of her time?"}, {"id": 132, "euler_id": 132, "title": "Large repunit factors", "problem": "A number consisting entirely of ones is called a repunit. We shall define R(k) to be a repunit of length k.\nFor example, R(10) = 1111111111 = 11\u00d741\u00d7271\u00d79091, and the sum of these prime factors is 9414.\nFind the sum of the first forty prime factors of R(109).", "solution": "843296", "difficulty": 45, "story": "Once upon a time in the peaceful village of Numeria, there lived a young girl named Emma. Emma was not like the other children in her village, for she possessed a love and passion for numbers that ran deep within her soul. While her peers engaged in games of tag and hide-and-seek, Emma could be found immersed in mathematical puzzles and brainteasers.\n\nOne sunny afternoon, as Emma sat under her favorite oak tree, pondering over her latest conundrum, a magical creature appeared before her. It was a mischievous math fairy named Matilda. With her twinkling wings and mischievous smile, Matilda was known throughout Numeria as the guardian of all mathematical secrets.\n\n\"Dear Emma,\" Matilda said, her voice filled with excitement. \"I have a challenge for you, one that will put your love for numbers to the ultimate test!\"\n\nEmma's eyes sparkled with anticipation. \"Tell me, Matilda, what is the challenge you have in store for me?\"\n\nMatilda waved her wand, and a shimmering scroll appeared in front of Emma. Unrolling it carefully, she read the problem aloud:\n\n\"A number consisting entirely of ones is called a repunit. We shall define R(k) to be a repunit of length k.\nFor example, R(10) = 1111111111 = 11\u00d741\u00d7271\u00d79091, and the sum of these prime factors is 9414.\nFind the sum of the first forty prime factors of R(109).\"\n\nEmma's mind raced with excitement. She had heard of repunits before, but the challenge Matilda presented was beyond anything she had ever encountered. Determined to solve it, Emma delved into the world of repunits, prime factors, and mathematical patterns.\n\nDays turned into weeks as Emma puzzled over the intricacies of the problem. She scribbled numbers on countless pieces of parchment, lost in a sea of calculations and digits. Matilda, ever encouraging, guided her through the complex maze of algorithms, offering hints and cheering her on.\n\nAs the village buzzed with excitement about Emma's latest endeavor, the town elder, Oliver, approached her one day in awe. \"Emma,\" he said, his voice filled with admiration, \"your pursuit of knowledge is truly inspiring. The entire village is rooting for you.\"\n\nEmma looked up from her calculations, her eyes gleaming with determination. \"Thank you, Oliver. I won't stop until I solve this mathematical riddle and uncover the secrets it holds.\"\n\nWith renewed vigor, Emma immersed herself in her work. She poured over ancient books, consulted with scholars, and even journeyed to distant lands in search of forgotten knowledge. Months turned into years, but Emma refused to give up. She knew that somewhere within the digits of the repunit R(109) lay the answer she sought.\n\nAnd so, dear reader, the story rests in your hands. Can you help Emma uncover the solution to the sum of the first forty prime factors of R(109)? Can you solve the riddle that has eluded her and bring Numeria the knowledge it yearns for?\n\n"}, {"id": 134, "euler_id": 134, "title": "Prime pair connection", "problem": "Consider the consecutive primes p1 = 19 and p2 = 23. It can be verified that 1219 is the smallest number such that the last digits are formed by p1 whilst also being divisible by p2.\nIn fact, with the exception of p1 = 3 and p2 = 5, for every pair of consecutive primes, p2 > p1, there exist values of n for which the last digits are formed by p1 and n is divisible by p2. Let S be the smallest of these values of n.\nFind \u2211 S for every pair of consecutive primes with 5 \u2264 p1 \u2264 1000000.", "solution": "18613426663617118", "difficulty": 45, "story": "Once upon a time in the bustling city of Numeroville, there lived an ambitious young mathematician named Emma. Emma had an insatiable curiosity for numbers and an uncanny ability to perceive patterns. She was known by her peers as the \"Queen of Sequences.\"\n\nOne sunny afternoon, Emma found herself deep in thought as she strolled through the streets of Numeroville. She was pondering the magic and mystery that numbers held, contemplating the infinite possibilities they presented. Lost in her musings, she accidentally bumped into an elderly man who seemed to be in a rather bewildered state.\n\n\"Oh, my apologies, sir!\" Emma exclaimed. \"I was lost in thought and didn't see where I was going. Are you okay?\"\n\nThe man adjusted his glasses and smiled warmly at Emma. \"No harm done, young lady. It seems I've lost my way. I'm trying to locate a secret treasure hidden in the city, but the clues are all mathematical puzzles that I just can't solve.\"\n\nA flicker of excitement danced in Emma's eyes. \"Mathematical puzzles? That's my specialty! Perhaps I can help you.\"\n\nThe old man's eyes brightened as he looked at Emma. \"You would do that for me? Oh, thank you, dear. The first clue is right here in this note.\" He handed her a worn piece of parchment.\n\nCuriosity piqued, Emma unfolded the note and read aloud, \"Consider the consecutive primes p1 = 19 and p2 = 23. It can be verified that 1219 is the smallest number such that the last digits are formed by p1 whilst also being divisible by p2.\"\n\nEmma furrowed her brows, her mind racing to unravel the enigma presented before her. She studied the numbers, analyzing their patterns and relationships. Soon, she realized the significance of the problem.\n\n\"This is fascinating,\" Emma muttered under her breath. \"So, for every pair of consecutive primes, except for 3 and 5, there exists a value called 'n' that is divisible by p2 and has its last digits formed by p1. The question is, what is the smallest of these n values?\"\n\nThe puzzle seemed to consume her thoughts as Emma delved deeper into her calculations. She pushed herself, employing all her knowledge and abilities to solve this intriguing mathematical problem. Along her journey, she discovered the beauty of number theory and its applications in the real world.\n\nAs Emma ventured through Numeroville, seeking answers to each consecutive prime pair, she encountered numerous challenges. She met other characters\u2014a street artist who painted mathematical equations, a musician who composed symphonies inspired by prime numbers, and even a group of mischievous youngsters who used patterns to break secret codes.\n\nThrough these encounters, Emma not only unraveled mathematical secrets but also discovered the profound impact that numbers had on the lives of different people. The power of sequences and patterns wove together the fabric of society, from art and music to technology and everyday life.\n\nBut as Emma's quest neared its end, and she stood on the precipice of unravelling the final prime pair, she couldn't help but hesitate. \"What is the true significance of this? What does finding the smallest value of n really mean?\"\n\nFinally, she was faced with the ultimate question: \"For every pair of consecutive primes with 5 \u2264 p1 \u2264 1000000, what is the total sum of the smallest values of n?\"\n\nAs Emma halted her journey to ponder this tantalizing query, her heart raced with anticipation. Would the answer hold the key to the secret treasure? What would finding the sum of these smallest values reveal about the nature of numbers?\n\nAnd so, dear reader, I pose the same question to you: can you solve the mathematical problem that held Emma captive? What is the sum of the smallest values of n for each pair of consecutive primes, with 5 \u2264 p1 \u2264 1000000?"}, {"id": 135, "euler_id": 135, "title": "Same differences", "problem": "Given the positive integers, x, y, and z, are consecutive terms of an arithmetic progression, the least value of the positive integer, n, for which the equation, x2 \u2212 y2 \u2212 z2 = n, has exactly two solutions is n = 27:\n342 \u2212 272 \u2212 202 = 122 \u2212 92 \u2212 62 = 27\nIt turns out that n = 1155 is the least value which has exactly ten solutions.\nHow many values of n less than one million have exactly ten distinct solutions?", "solution": "4989", "difficulty": 45, "story": "Once upon a time, in the kingdom of Numeria, there was a young prince named Alexander. He was known throughout the land for his inquisitive mind and his love for solving puzzles and riddles. One day, a rumor spread across Numeria about a mystical artifact hidden deep within the Enigmatic Forest, said to possess unimaginable power. It was called the Crystal of Arithmetic, and it was said to have the ability to break any code and unlock the deepest secrets of the universe.\n\nEager to prove himself, Alexander decided to embark on a quest to find the Crystal of Arithmetic. He knew that solving mathematical problems might be the key to locating this elusive artifact. So, with a saddlebag filled with scrolls and a trusted steed named Euler, the prince ventured into the Enigmatic Forest.\n\nAs Alexander delved deeper into the forest, he encountered all sorts of trials and puzzles that tested his mathematical prowess. He solved equations hidden in ancient tree carvings, decoded cryptic symbols on moss-covered stones, and even tamed a wild equation that threatened to engulf him. But each challenge only heightened his determination to find the Crystal of Arithmetic.\n\nAfter days of searching and solving countless mathematical puzzles, Alexander stumbled upon an old, crumbling temple. It glowed with an ethereal blue light that seemed to beckon him inside. The prince cautiously stepped through the doorway, his heart pounding with excitement.\n\nInside, the temple was unlike anything Alexander had ever seen before. Walls adorned with intricate mathematical patterns and symbols surrounded him. At the center, atop a stone pedestal, rested the Crystal of Arithmetic. Its iridescent surface shimmered, reflecting the prince's awe-struck expression.\n\nBut just as Alexander reached out to grasp the crystal, a voice echoed through the temple. \"To prove yourself worthy of the Crystal of Arithmetic,\" the voice boomed, \"you must solve a mathematical problem that only the greatest minds can conquer.\"\n\nCuriosity piqued, Alexander listened attentively as the voice presented him with the mathematical problem. A sense of urgency filled him as he realized the fate of the artifact and his quest depended on finding the solution.\n\nContinuing his journey through the labyrinthine temple, Alexander analyzed the problem over and over again. He scribbled equations on parchment, discussing hypotheses with imaginary mathematical prodigies, and pondered deep into the night.\n\nDays turned into weeks, and the prince's determination wavered, but he refused to give up. He knew that the secret to the Crystal of Arithmetic lay within this mathematical problem, and he could not let Numeria down.\n\nFinally, after weeks of tireless effort, Alexander discovered an incredible breakthrough. The solution to the mathematical problem was within his grasp. A surge of excitement coursed through his veins as he realized the significance of his findings.\n\nBut as the prince stood in front of the Crystal of Arithmetic, ready to unlock its secrets, a chilling realization dawned upon him. The artifact was not within his reach; it required an answer to a much greater question. The question of how many values of n, less than one million, had exactly ten distinct solutions.\n\nThough exhaustion weighed heavily on his shoulders, Alexander couldn't suppress his thirst for knowledge. With a heavy heart, he began to ponder this new enigma, knowing that the fate of the artifact and his quest to unlock the mysteries of the universe depended on it.\n\nAnd so, dear reader, I ask you: how many values of n, less than one million, have exactly ten distinct solutions?"}, {"id": 138, "euler_id": 138, "title": "Special isosceles triangles", "problem": "Consider the isosceles triangle with base length, b=16, and legs, L=17.\n\n\nBy using the Pythagorean theorem it can be seen that the height of the triangle, h=172\u221282=15, which is one less than the base length.\nWith b=272 and L=305, we get h=273, which is one more than the base length, and this is the second smallest isosceles triangle with the property that h=b\u00b11.\nFind \u2211L for the twelve smallest isosceles triangles for which h=b\u00b11 and b, L are positive integers.", "solution": "1118049290473932", "difficulty": 45, "story": "Once upon a time in the charming village of Mathland, there lived a young girl named Lily. Lily was a curious and adventurous soul who always sought to unravel the mysteries and challenges that Mathland had to offer. \n\nOne sunny day, as Lily meandered through the streets of her village, she stumbled upon an intriguing book that whispered ancient secrets of geometry and numbers. As fate would have it, the very first page she opened revealed a problem that posed a fascinating conundrum. The problem spoke of isosceles triangles with base length, b, and leg length, L, that satisfied the unique condition of a difference of only one unit.\n\nLily's mathematical senses were immediately awakened, and she couldn't help but immerse herself in deciphering the hidden truth behind these peculiar triangles. She envisioned herself on a grand mathematical quest, unlocking the secrets that lay within these geometric enigmas. This became her singular goal - to find the twelve smallest isosceles triangles that fulfilled the condition h=b\u00b11.\n\nExcited by her newfound mathematical adventure, Lily consulted the village's wise sage, Professor Pythagoras. With his long white beard and infinite knowledge, Professor Pythagoras was renowned for his ability to solve any mathematical riddle. Together, they embarked on a journey that would take them to the farthest corners of Mathland in search of these mysterious triangles.\n\nAs they ventured into the enchanting Forest of Numbers, Lily's mind raced, imagining the endless possibilities and geometrical wonders that awaited them. They wandered along a winding path lined with towering trees and lush greenery, the air filled with a sense of anticipation. \n\nSuddenly, through a ray of sunlight, a glimmer caught Lily's eye. There, hidden amongst the foliage, stood a perfectly symmetrical isosceles triangle. Its base length, b, measured 16, and its leg length, L, astonishingly equaled 17. Lily marveled at the triangle's beauty and symmetry, noting that the difference between the base and height was exactly one unit.\n\n\"This must be the first triangle on our quest!\" Lily exclaimed, her voice ringing with excitement. Professor Pythagoras nodded in agreement, his eyes glittering with pride at Lily's enthusiasm. They carefully examined the triangle, pondering the intricate relationships between its sides and how they danced harmoniously.\n\nAs they continued their journey, Lily and Professor Pythagoras discovered more of these extraordinary triangles. Each time they stumbled upon one, they marveled at the elegance of the numerical patterns hidden within their geometric structures. Some triangles stood tall with bases surpassing 100, while others were petite, with base lengths as small as 9.\n\nTheir adventure took them across Mathland's vast lands, from the lofty Math-Mountain to the mysterious Lake of Equations. They solved countless puzzles and equations, their minds buzzing with the symphony of numbers. With each newly discovered triangle, the magic of mathematics enveloped Lily's heart even more.\n\nFinally, after months of exploration and calculation, they managed to uncover the twelve smallest isosceles triangles that adhered to the condition h=b\u00b11. Their minds brimmed with satisfaction and awe at the beauty hidden within these triangles. And yet, even in the face of this profound discovery, they couldn't help but wonder about the sum of the leg lengths, L.\n\nLily turned to Professor Pythagoras, a sparkle in her eyes, and asked the question that lingered in both their hearts, \"Professor, can you find the sum of the leg lengths, L, for these twelve magical triangles?\"\n\nAs the sun began to set on their mathematical adventure, the answer eluded them. The sum of the leg lengths, L, remained a tantalizing mystery. With their minds filled with mathematical curiosity, Lily and Professor Pythagoras journeyed back to Mathland, eager to share their quest and question with the village's gifted mathematicians.\n\nAnd so, dear reader, the story of the twelve smallest isosceles triangles for which h=b\u00b11 and b, L are positive integers rests in your hands. Can you solve the mathematical puzzle that Lily and Professor Pythagoras began? Can you find the sum of the leg lengths, L, for these twelve triangles and put an end to their mathematical journey?\n\nThe math awaits you, dear reader. Will you unravel its secret and complete the adventure?"}, {"id": 142, "euler_id": 142, "title": "Perfect Square Collection", "problem": "Find the smallest x + y + z with integers x > y > z > 0 such that x + y, x \u2212 y, x + z, x \u2212 z, y + z, y \u2212 z are all perfect squares.", "solution": "1006193", "difficulty": 45, "story": "Once upon a time, in the quaint village of Arithmetica, there lived a clever and inquisitive young girl named Emma. Emma was known for her love of numbers and the mysteries they held. One sunny morning, as she was strolling through the village market, Emma overheard whispers of a peculiar problem that piqued her interest.\n\nA group of villagers were discussing a mathematical enigma. They spoke of a quest to find three special numbers - x, y, and z - where x had to be greater than y, y greater than z, and all three had to be positive integers. But that wasn't all; these numbers held an even deeper secret. They had magical properties that made them the sum and difference of perfect squares.\n\nIntrigued by the challenge, Emma approached the villagers and asked for more details. They explained that in order to solve the problem, she needed to find the smallest possible values for x, y, and z that satisfied all the given conditions.\n\nWith a sparkle in her eyes, Emma's heart raced with excitement. She knew that this mathematical problem held the key to unraveling a hidden mystery, and she was determined to solve it.\n\nOver the next few weeks, Emma dedicated herself to studying and investigating this intriguing conundrum. She poured over books and consulted wise scholars, searching for any clue that could guide her toward the solution.\n\nHer journey led her through the wild forests and across vast meadows, where she encountered various obstacles that tested her skills and knowledge. Emma calculated intricate equations in her head, tirelessly testing different combinations of numbers until her fingertips were sore.\n\nAs Emma ventured deeper into the heart of this numerical labyrinth, her mind grew sharper, and her determination grew stronger. She began to see patterns emerging where others would miss them. She deciphered hidden relationships between the squares and the integers, feeling the numbers come alive in her mind.\n\nFinally, after weeks of intense effort, she had a breakthrough. A spark of revelation ignited within her as she unlocked the secret formula. Her heart raced, knowing that she now possessed the missing piece of the puzzle.\n\nBut just as Emma was about to celebrate her achievement, she stopped, realizing the power that lay within this enigma. It wasn't just about finding the answer; it was about the journey, the thrill of discovery, and the beauty of mathematics.\n\nEmma understood that this mathematical problem was more than just a test of her numerical prowess. It was a testament to her love for knowledge and her unwavering spirit. And so, she made a decision.\n\nShe would not be the one to reveal the solution, for this was a riddle that deserved to be unraveled by others. Emma's journey had unfolded before her eyes, as she learned the value of perseverance and the joy of unraveling the unknown.\n\nAnd now, dear reader, the time has come for you to embark on your own adventure. Armed with the knowledge of Emma's journey, can you find the solution to the mathematical problem that captivated her? Will you be the one to uncover the smallest values of x, y, and z that satisfy the magical conditions?\n\nAs you delve into the depths of this mathematical enigma, remember the spirit of Emma and the wonders that lie within the world of numbers. Your quest awaits."}, {"id": 162, "euler_id": 162, "title": "Hexadecimal numbers", "problem": "In  the hexadecimal number system numbers are represented using 16 different digits:\n0,1,2,3,4,5,6,7,8,9,A,B,C,D,E,F\nThe hexadecimal number AF when written in the decimal number system equals 10x16+15=175.\nIn the 3-digit hexadecimal numbers 10A, 1A0, A10, and A01 the digits 0,1 and A are all present.\nLike numbers written in base ten we write hexadecimal numbers without leading zeroes.\nHow many hexadecimal numbers containing at most sixteen hexadecimal digits exist with all of the digits 0,1, and A present at least once?\nGive your answer as a hexadecimal number.\n(A,B,C,D,E and F in upper case, without any leading or trailing code that marks the number as hexadecimal and without leading zeroes , e.g. 1A3F and not: 1a3f and not 0x1a3f and not $1A3F and not #1A3F and not 0000001A3F)", "solution": "3D58725572C62302", "difficulty": 45, "story": "Once upon a time in the quaint town of Numeroville, there lived a young and curious mathematician named Alice. Numbers fascinated her, and she spent her days and nights exploring their mysteries.\n\nOne sunny morning, as Alice was strolling through the town square, she noticed a peculiar old man selling antique books. Curiosity got the better of her, and she couldn't resist peeking at the titles. One book, in particular, caught her eye. It was titled \"The Enigma of Hexadecimals.\"\n\nAlice's eyes widened with excitement as she reached for the book. Little did she know that this book held the key to a fascinating adventure involving numbers.\n\nAs she delved into the pages, Alice couldn't help but become captivated by the mathematical problem presented. The author described how in the hexadecimal number system, numbers were represented using sixteen different digits: 0,1,2,3,4,5,6,7,8,9,A,B,C,D,E, and F. The author then presented a problem to the readers.\n\n\"The 3-digit hexadecimal numbers, such as 10A, 1A0, A10, and A01, have the unique property that the digits 0, 1, and A are all present. How many hexadecimal numbers, containing at most sixteen digits, exist with all of the digits 0, 1, and A present at least once?\"\n\nAlice's mind was abuzz with excitement. She couldn't let go of this problem. It consumed her thoughts, invaded her dreams. Determined to find the answer, she embarked on a quest, traversing through the mesmerizing landscapes of the Numeroville.\n\nThroughout her journey, Alice encountered various characters who held clues to the solution. A wise old owl shared tales of ancient numeral systems, a mischievous rabbit pointed her towards hidden mathematical patterns, and a mystical sorcerer revealed ancient hexagonal symbols.\n\nThese encounters and experiences, though magical, were not without challenges. Alice faced riddles from mystical creatures, navigated treacherous mathematical mazes, and deciphered complex equations carved into stones.\n\nAs Alice absorbed all the knowledge and experiences, she realized that the solution to the problem lay not only in mathematical calculations but also in the depth of her understanding. She had to think outside the box, beyond the numbers, and embrace the power of imagination.\n\nWith each step, Alice's understanding deepened, and she came to comprehend the core essence of the problem. It was not just about counting the numbers; it was about unraveling the beauty and patterns embedded within them.\n\nAnd so, dear reader, I leave you with this question: How many hexadecimal numbers, containing at most sixteen digits, exist with all of the digits 0, 1, and A present at least once? Embrace the journey, explore the possibilities, and let your imagination ignite the path to the solution."}, {"id": 164, "euler_id": 164, "title": "Numbers for which no three consecutive digits have a sum greater than a given value", "problem": "How many 20 digit numbers n (without any leading zero) exist such that no three consecutive digits of n have a sum greater than 9?", "solution": "378158756814587", "difficulty": 45, "story": "Once upon a time in the enchanting town of Numeria, there lived a brilliant young mathematician named Alice. Alice was known throughout the land for her clever mind and her love for solving complex mathematical problems. Her days were spent in her study, surrounded by books and scrolls filled with intricate equations and mind-boggling theorems.\n\nOne warm summer morning, as Alice was absorbed in her studies, a knock came at her door. Opening it, she found a peculiar figure standing before her. It was a mystical being \u2013 a Gnome \u2013 with a long white beard and a twinkle in his eyes.\n\n\"Mighty mathematician, I require your assistance,\" the Gnome said, his voice carrying a hint of urgency.\n\nCuriosity tugging at her, Alice invited the Gnome inside and offered him a seat. The Gnome introduced himself as Gnorbert and explained his predicament.\n\n\"In the distant realm of Gnomoria,\" Gnorbert began, \"our kingdom has been plagued by an ancient curse. The curse renders our enchanted machinery useless until we unlock its secret code.\"\n\nUnderstanding the gravity of the matter, Alice leaned forward. \"And what is this secret code?\" she asked eagerly.\n\nGnorbert reached into his tattered brown cloak and presented Alice with a piece of parchment. On it was a mathematical problem: how many 20-digit numbers, without any leading zeroes, existed such that no three consecutive digits of the number had a sum greater than 9?\n\nAlice's eyes sparkled with excitement. The Gnome's problem was genuinely challenging, as it combined the worlds of mathematics and logic. She realized that solving it held the key to breaking the curse that plagued Gnomoria.\n\nAs the days turned into weeks, Alice immersed herself in solving the conundrum. Her calculations covered countless pages, and she was determined to find the solution. The problem intrigued her because it required her to think deeply about the patterns forming within the numbers.\n\nAs she toiled diligently, Alice discovered that each digit in a number could range from 0 to 9. However, if the sum of any three consecutive digits exceeded 9, it would violate the curse's rule.\n\nShe pondered the different cases and scenarios, realizing she had to account for the possibilities where the sum of the three consecutive digits could be 10 or greater. Alice jotted down endless notes and equations, slowly piecing together the solution. Each time she thought she had it, another aspect of the problem would present itself, leading her back to the drawing board.\n\nDays turned into months, but Alice's determination never faltered. Her mind worked tirelessly, maneuvering through countless possibilities and scenarios. And through her tireless effort, she finally reached a breakthrough, or so she believed. Excitement surged within her as she neared the end of her journey.\n\nAt that precise moment, Gnorbert appeared once more at her doorstep. Startled, Alice beckoned him to come inside. \"Gnorbert, I may have found the solution to your curse!\" she exclaimed. \"But before I reveal it, tell me, how important is this code to Gnomoria?\"\n\nGnorbert's eyes glazed with a mixture of sadness and hope. \"The prosperity of our realm depends on it. The enchanted machinery powers our civilization, and without it, chaos will ensue. Gnomoria will crumble, and its people left hopeless.\"\n\nAlice's heart sank at the gravity of the situation. She knew that the burden of unlocking the secret code lay upon her shoulders. She had danced around countless calculations and complex equations, but she needed to be certain. She needed assurance that her solution was correct.\n\nTurning to Gnorbert, she asked, \"How much time do I have, Gnorbert? How much longer can Gnomoria endure without the solution?\"\n\nGnorbert's face fell, and he replied, \"A fortnight at most, mighty mathematician.\"\n\nAlice took a deep breath, understanding the weight of the task ahead. She promised Gnorbert that she would return to him with the answer before the fortnight was up.\n\nNow, the question remains for you, dear reader: How many 20-digit numbers n, without any leading zero, exist such that no three consecutive digits of n have a sum greater than 9?"}, {"id": 183, "euler_id": 183, "title": "Maximum product of parts", "problem": "Let N be a positive integer and let N be split into k equal parts, r = N/k, so that N = r + r + ... + r.\nLet P be the product of these parts, P = r \u00d7 r \u00d7 ... \u00d7 r = rk.\nFor example, if 11 is split into five equal parts, 11 = 2.2 + 2.2 + 2.2 + 2.2 + 2.2, then P = 2.25 = 51.53632.\nLet M(N) = Pmax for a given value of N.\nIt turns out that the maximum for N = 11 is found by splitting eleven into four equal parts which leads to Pmax = (11/4)4; that is, M(11) = 14641/256 = 57.19140625, which is a terminating decimal.\nHowever, for N = 8 the maximum is achieved by splitting it into three equal parts, so M(8) = 512/27, which is a non-terminating decimal.\nLet D(N) = N if M(N) is a non-terminating decimal and D(N) = -N if M(N) is a terminating decimal.\nFor example, \u2211\u2009D(N) for 5 \u2264 N \u2264 100 is 2438.\nFind \u2211\u2009D(N) for 5 \u2264 N \u2264 10000.", "solution": "48861552", "difficulty": 45, "story": "Once upon a time, in a quiet village nestled among rolling hills, there lived a young shepherd named Liam. Every day, he would lead his flock of sheep to the lush pastures, ensuring they had enough grass to graze upon. \n\nLiam was known for his knack of solving puzzles and taking delight in the wonders of mathematics. He would often contemplate various mathematical problems while tending to his sheep. One day, as he led his flock to a new pasture, he stumbled upon an old, weathered book lying beneath a towering oak tree.\n\nCuriosity piqued, Liam eagerly opened the book and was introduced to a captivating mathematical problem. It was a question about dividing a positive integer, N, into equal parts. The problem seemed fascinating to Liam, as he imagined applying it to his flock. \n\nLost in his thoughts, Liam wandered further into the pasture, pondering the possibilities. As he watched his sheep happily grazing, an idea struck him. \"What if I apply this concept to ensure the optimal use of the pasture for my flock?\" he wondered.\n\nDetermined to find the answer, Liam set forth on splitting the pasture into equal parts, just as the mathematical problem dictated. Taking a deep breath, he measured the area and divided it into k equal sections, each with the length r = N/k.\n\nEvery day, Liam carefully implemented this plan, moving the fences to create the perfect divided sections for his sheep. His flock seemed to thrive in the newly arranged pastures, as they now had ample space to roam and graze.\n\nMonths passed, and Liam's knowledge of the mathematical problem continued to shape his decisions. He realized that the optimal solution varied for each N. For example, for a pasture with an area of 11, he split it into four equal sections, resulting in the maximum product of P = (11/4)^4.\n\nWith every successful implementation, the question of D(N) lingered in Liam's mind. He wondered what significance lay within this function. Could the answer be found in the nature of terminating and non-terminating decimals? Liam yearned to explore this mystery further.\n\nAs the years flew by, the village began to recognize Liam's innovative approach to sheep-herding. Farmers marveled at the well-maintained pastures and flourishing flocks, all thanks to Liam's mathematical prowess. His methods were soon adopted by other shepherds, and the village began to prosper.\n\nYet, throughout this journey of discovery, Liam couldn't shake the ultimate question: What would be the sum of D(N) for 5 \u2264 N \u2264 10000? It beckoned him to delve deeper into the realm of mathematics and its hidden secrets. \n\nAnd so, dear reader, we find ourselves at the end of this story, contemplating the same question. Can you solve this intriguing puzzle and discover the sum of D(N)?"}, {"id": 197, "euler_id": 197, "title": "Investigating the behaviour of a recursively defined sequence", "problem": "Given is the function f(x) = \u230a230.403243784-x2\u230b \u00d7 10-9 ( \u230a \u230b is the floor-function),\nthe sequence un is defined by u0 = -1 and un+1 = f(un).\nFind un + un+1 for n = 1012.\nGive your answer with 9 digits after the decimal point.", "solution": "1.710637717", "difficulty": 45, "story": "Once upon a time in the Kingdom of Numeria, there lived a young and curious mathematician named Aria. Aria had always been fascinated by numbers and equations, spending countless hours pouring over textbooks and solving complex problems just for the sheer joy of it. One day, as she was browsing through an ancient tome in the royal library, she stumbled upon a mathematical problem that intrigued her.\n\nThe problem presented to Aria was no ordinary equation. It came in the form of a function, denoted as f(x), which had a rather complex composition. Aria's eyes lit up with excitement as she read the problem aloud to herself. She could hardly believe her luck at stumbling upon such a perplexing puzzle!\n\nGiven the function f(x) = \u230a230.403243784-x^2\u230b \u00d7 10^(-9), Aria soon discovered that the sequence un could be generated with this function. The sequence was defined such that u0 was -1, and each successive term un+1 was equal to f(un). Intrigued by this recursive rule, Aria set out on a quest to explore the sequence and unravel its hidden patterns.\n\nWhat Aria discovered was astonishing. As she plugged in different values of n to generate successive terms of the sequence, she was astounded by the fluctuations between positive and negative numbers, each with astonishing precision. The values of un seemed to dance with the rhythm of the numbers, never straying too far from one another.\n\nIt didn't take long for Aria to notice something peculiar. The sum of each term, un, and its successive term, un+1, held a mysterious significance. It was as if the universe conspired to create a meaningful relationship between these numbers. As Aria meticulously calculated the sum for various values of n, a realization dawned upon her\u2014an epiphany that would change the course of her life.\n\nIntrigued and determined to understand the implications of this relationship, Aria embarked on a journey across the Kingdom of Numeria to seek guidance from the great sages and mathematicians who resided there. She traveled through bustling cities, treacherous mountains, and enchanted forests, hoping to find someone who could shed light on the secret behind the sum of un and un+1.\n\nAlong the way, Aria encountered many obstacles and faced numerous challenges that tested her resolve. She courageously persevered, driven by her determination to uncover the hidden truth. Finally, after weeks of tireless travel, Aria stood before the Gates of Wisdom\u2014the abode of the most revered sage in all of Numeria.\n\nWith bated breath, Aria presented her findings to the sage, hoping for insight and guidance. The sage listened intently, nodding as Aria detailed her journey, the intricacies of the sequence, and the captivating sum of un and un+1. When she finished, the sage smiled, revealing a glimmer in his eyes.\n\n\"Aria,\" the sage began, \"you have stumbled upon a profound mathematical mystery\u2014one that has eluded scholars for generations. The sum of un and un+1 holds the key to unlocking the secrets of the universe itself. It is a message from the great cosmic mathematician, speaking to us through numbers.\"\n\nAria could hardly contain her excitement. She begged the sage to reveal the hidden truths and the significance of the sum. However, the sage merely chuckled, his voice carrying the weight of age and wisdom.\n\n\"Dear Aria, it is not for me to unveil the final answer to you. The solution lies within the realm of numbers themselves, waiting to be discovered by those who possess the audacity to venture further.\"\n\nThe sage's words hung in the air\u2014cryptic yet inspiring. Aria realized that her journey was far from over. This mathematical puzzle held a greater purpose, one that could reshape the understanding of mathematics and the world around her.\n\nWith newfound determination and a heart filled with curiosity, Aria bid farewell to the sage and set forth once more. Armed with the knowledge bestowed upon her, she delved deeper into the sequence, exploring further and searching for the elusive answer.\n\nAnd now, dear reader, I present you with the same question that plagued Aria's thoughts throughout her journey: can you solve the mathematical problem? What is the value of un + un+1 for n = 1012? The answer, with nine digits after the decimal point, is waiting to be unveiled.\n\nDo you dare to venture into the realm of numbers and unravel this enigma? The fate of mathematical discovery awaits your answer."}, {"id": 216, "euler_id": 216, "title": "Investigating the primality of numbers of the form 2n2-1", "problem": "Consider numbers t(n) of the form t(n) = 2n2-1 with n > 1.\nThe first such numbers are 7, 17, 31, 49, 71, 97, 127 and 161.\nIt turns out that only 49 = 7*7 and 161 = 7*23 are not prime.\nFor n \u2264 10000 there are 2202 numbers t(n)  that are prime.\nHow many numbers t(n) are prime for n \u2264 50,000,000 ?", "solution": "5437849", "difficulty": 45, "story": "Once upon a time, in a small village nestled between rolling hills, lived a young boy named Oliver. Oliver was known for his exceptional intelligence and curiosity. He spent most of his days wandering through the forest, observing the wonders of nature and marveling at the intricacies of the world around him. It was during one of these excursions that Oliver stumbled upon an ancient treasure map buried beneath a moss-covered stone.\n\nThe map depicted a journey to the top of a mighty mountain, where a fabled treasure was said to be hidden. Excited by the prospect of adventure, Oliver decided to embark on the quest. Little did he know that this adventure would not only test his physical strength but also his mathematical prowess.\n\nAs Oliver climbed higher and higher, his path became increasingly treacherous. With each step, the air grew thinner and his heart pounded in his chest. But Oliver was determined to reach the summit; he had come too far to turn back now. His unwavering persistence was fueled by the promise of the untold riches that awaited him.\n\nAs he ascended, Oliver's wandering mind began to ponder the intricacies of numbers. He found solace in the predictability of mathematics amidst the unpredictable nature of his climb. And that's when he remembered the ancient mathematical problem he had come across recently.\n\nThe problem stated that for numbers of the form t(n) = 2n^2 - 1, with n greater than 1, there were 2202 prime numbers for n less than or equal to 10,000. This fact fascinated Oliver; it was like a riddle waiting to be solved.\n\nThe climb became not only a physical challenge but also a mental one. Oliver's mind raced as he contemplated the patterns of these numbers. He wondered how many prime numbers of this form would exist for n less than or equal to 50,000,000.\n\nWith each step, Oliver's excitement grew. He was eager to reach the summit, not just for the treasure that awaited him but also to find answers to the mathematical problem. It became intertwined with his journey, propelling him forward even when his body screamed for rest.\n\nFinally, after days of arduous climbing, Oliver reached the top of the mountain. As he stood victorious on the summit, he soaked in the breathtaking view below. But his mind remained fixated on the mystery of the mathematical problem.\n\nIt was at that moment, with the wind at his back and the answer seemingly within his grasp, that Oliver pondered, \"How many numbers t(n) of the form 2n2 - 1 are prime for n less than or equal to 50,000,000?\"\n\nAnd so, dear reader, I leave you with this question. Can you solve the mathematical problem that eluded Oliver, and discover the number of prime numbers t(n) for n less than or equal to 50,000,000?"}, {"id": 225, "euler_id": 225, "title": "Tribonacci non-divisors", "problem": "\nThe sequence 1, 1, 1, 3, 5, 9, 17, 31, 57, 105, 193, 355, 653, 1201 ...\nis defined by T1 = T2 = T3 = 1 and Tn = Tn-1 + Tn-2 + Tn-3.\n\n\nIt can be shown that 27 does not divide any terms of this sequence.In fact, 27 is the first odd number with this property.\n\nFind the 124th odd number that does not divide any terms of the above sequence.", "solution": "2009", "difficulty": 45, "story": "Once upon a time in the Kingdom of Numeria, there lived a curious young mathematician named Ethan. Known for his uncanny ability to solve complex mathematical problems, Ethan spent his days and nights pondering over numerical mysteries.\n\nOne gloomy afternoon, while seated at his desk in the Royal Mathematics Hall, Ethan stumbled upon an intriguing sequence of numbers in an ancient tome. The sequence went like this: 1, 1, 1, 3, 5, 9, 17, 31, 57, 105, 193, 355, 653, 1201... It fascinated Ethan, and he couldn't resist delving further into its patterns and properties.\n\nHe read on and discovered that the sequence was defined as T1 = T2 = T3 = 1 and Tn = Tn-1 + Tn-2 + Tn-3, where Tn represents the nth term of the sequence. There was also another piece of intriguing information - it was proven that 27 did not divide any term of this sequence. In fact, 27 was the first odd number with this property.\n\nEthan's mind raced with excitement. He couldn't help but wonder if there were other odd numbers that possessed this unique property. Could there be a pattern hidden within the depths of this numerical puzzle?\n\nAs days turned into nights, Ethan delved deeper into the sequence, analyzing it from various angles. He filled pages with equations, scribbles, and calculations. Ethan was determined to crack this enigma and uncover the secrets of this sequence.\n\nWeeks turned into months, and still, Ethan toiled away, consumed by his mathematical quest. His obsession grew, and he barely noticed the world around him. Friends and family grew concerned, but Ethan couldn't tear himself away from the captivating nature of this sequence.\n\nFinally, on a crisp autumn evening, as the leaves outside danced in golden hues, Ethan stumbled upon a breakthrough. After countless hours of calculations, he successfully identified the 124th odd number that did not divide any term of the sequence.\n\nFilled with euphoria and a newfound sense of accomplishment, Ethan wondered if he had stumbled upon an even greater revelation. Could there be a pattern beyond the 124th odd number? And if so, what did it signify? Were there deeper secrets waiting to be unveiled?\n\nEthan's heart raced with anticipation as he contemplated these questions. The weight of his discovery pressed upon him, urging him to seek further knowledge. But as the moon shone brightly through his window, he realized that he needed help - help from mathematicians and scholars far and wide.\n\nSo, dear reader, I ask you, can you solve the mathematical problem that has captivated Ethan's heart and mind? Can you find the 124th odd number that does not divide any terms of the sequence? Are you willing to embark on this numerical adventure with Ethan and unlock the hidden patterns within this fascinating sequence?\n\nThe tale awaits your answer..."}, {"id": 291, "euler_id": 291, "title": "Panaitopol Primes", "problem": "\nA prime number p is called a Panaitopol prime if p=x4\u2212y4x3+y3 for some positive integers x and y.\n\nFind how many Panaitopol primes are less than 5\u00d71015.\n", "solution": "4037526", "difficulty": 45, "story": "In a quiet village nestled among rolling green hills, lived a young girl named Lily. With her vivid imagination and boundless curiosity, Lily possessed a love for puzzles and mysteries that kept her mind constantly occupied. Her favorite pastime was solving riddles and pondering enigmatic problems, seeking answers that lay hidden beneath the surface.\n\nOne sunny afternoon, as Lily sat on her porch, she overheard a conversation between her parents and the village mathematician, Professor Abbott. They were discussing a fascinating mathematical problem known as Panaitopol primes. Lily strained her ears, eager to learn more about this intriguing concept.\n\n\"A prime number p is called a Panaitopol prime,\" explained Professor Abbott, \"if it can be expressed as p = x^4 - y^4 / x^3 + y^3, where x and y are positive integers.\"\n\nLily's eyes sparkled with excitement. That seemed like a puzzle just waiting to be solved. She delved deeper into the conversation and discovered that the village had been baffled by the scarcity of Panaitopol primes, even more so now that their esteemed mathematician had proposed a challenge. The Professor had set out to ascertain how many of these peculiar primes existed below the vast threshold of 5\u00d710^15.\n\nIntrigued by the problem, Lily couldn't help but wonder about the significance of Panaitopol primes. She believed that numbers held secrets and stories of their own, and she yearned to unravel their mysteries.\n\nThat night, Lily's mind danced with thoughts of Panaitopol primes. In her dreams, she envisioned a world where numbers whispered secrets to one another, their voices like soft melodies that only a chosen few could hear. She wandered through an enchanted forest, searching for the answers that eluded her.\n\nWhen Lily awoke the next day, she was struck by an unshakeable determination. She was no longer just a young girl with an insatiable thirst for knowledge. She wanted to become the hero of her own story, the one who could solve the enigma of Panaitopol primes and bring enlightenment to her village.\n\nDays turned into weeks, and weeks into months as Lily dedicated her time to solving the riddle. With fervor and passion, she poured over countless mathematical equations, searching for patterns, and exploring every path that crossed her mind. She filled notebooks with her scribbles, her room became flooded with mathematical charts and diagrams, inching ever closer to the ultimate answer.\n\nBut as time ticked on, Lily couldn't help but feel a pang of doubt seep into her heart. The enormity of the task weighed heavily upon her small shoulders. Doubts crept into her dreams, clouding her once-clear purpose.\n\n\"What if I can never find the answer?\" Lily whispered to the night sky. A soft breeze rustled the leaves, as if whispering back reassuringly. In her heart, she knew that she couldn't give up. The pursuit of knowledge was too strong within her.\n\nAnd so, with renewed resolve, Lily dove back into the world of numbers. She vowed to decipher the hidden code that lay within Panaitopol primes, regardless of the time it took, or the sacrifices she had to make.\n\nBut now, as the days turned into years and her once-youthful face began to show the wisdom of her dedication, Lily wondered if she would ever complete this grand task. The village believed in her, seeing her as their beacon of hope, their unwavering light guiding them towards enlightenment. But could she live up to their expectations?\n\nAs Lily poured over her research one fateful evening, she stumbled upon a previously unnoticed pattern. Her heart began to race, a thrill of excitement coursing through her veins. Her intuition told her that she was on the verge of discovery.\n\nBut as dusk turned to dawn, Lily discovered something else. A deep and profound question echoed through her, demanding an answer. It was a question that had haunted her since the beginning, but now it became clear. She knew it was time to share her puzzle with the world, to pose the final question to those brave enough to listen.\n\nWith a trembling hand, Lily penned her question onto a sheet of paper, her eyes shining with anticipation. Her journey had led her to this moment, to the crossroads where logic and intuition intersected. There, amidst the mountains of numbers and equations, Lily wrote:\n\n\"How many Panaitopol primes can you find below 5\u00d710^15?\"\n\nAnd with that, she signed her name, Lily, the young girl who sought to unlock the secrets hiding within the numbers, leaving her question for the world to embrace.\n\nThe tale of Lily, the village's mathematician, had only just begun. Now, it was up to others to take up the challenge and reveal the hidden treasures of the Panaitopol primes."}, {"id": 294, "euler_id": 294, "title": "Sum of digits - experience #23", "problem": "\nFor a positive integer k, define d(k) as the sum of the digits of k in its usual decimal representation.\nThus d(42) = 4+2 = 6.\n\n\nFor a positive integer n, define S(n) as the number of positive integers k < 10n with the following properties :\nk is divisible by 23 and\nd(k) = 23.\n\nYou are given that S(9) = 263626 and S(42) = 6377168878570056.\n\n\nFind S(1112) and give your answer mod 109.\n", "solution": "789184709", "difficulty": 45, "story": "Once upon a time in the bustling city of Numeria, lived a young math prodigy named Amelia. Amelia possessed an extraordinary talent for numbers and an insatiable curiosity for all things mathematical. Her days were spent poring over formulas and equations, seeking hidden patterns and unraveling complex problems. \n\nOne sunny morning, as Amelia was sipping her favorite black tea in her cozy study, she stumbled upon an intriguing problem. She read aloud to herself, \"For a positive integer k, define d(k) as the sum of the digits of k in its usual decimal representation. Thus d(42) = 4+2 = 6.\" Her eyes flickered with excitement as she pondered over this mathematical conundrum.\n\nAmelia's mind whirled with ideas, and she immediately began to unravel the problem's implications. She realized that the function d(k) played a crucial role in the determination of S(n), which denoted the number of positive integers k less than 10n that were both divisible by 23 and had a digit sum of 23.\n\nUnbeknownst to Amelia, countless lives in Numeria were affected by her mathematical exploration. Companies relied on S(n) to forecast sales, politicians used its limitations to gauge public sentiment, and curious minds throughout the land couldn't resist solving the perplexing puzzle. An entire world's fate seemed to hang in the balance, and it was up to Amelia to solve the equation that had captivated her heart.\n\nAmidst her calculations, Amelia couldn't help but wonder how her findings would shape the lives of the people in Numeria. What would S(1112) be? How would it influence the world? With each passing moment, her curiosity grew stronger, compelling her to delve deeper into the mathematical abyss.\n\nDays turned into weeks, and Amelia found herself lost in a maelstrom of numbers and formulas. Time seemed to stand still as she methodically dissected the intricate patterns that lay hidden within S(n). And then, a breakthrough! The pieces fell into place, and the solution presented itself before her eyes.\n\nBut just as Amelia was about to rejoice in her accomplishment, a thought crossed her mind. The true value of her findings extended beyond mere numbers. It was the quest for knowledge, the relentless pursuit of answers, and the thrill of the unknown that had guided her every step.\n\nWith this revelation, Amelia paused for a moment to reflect on the power of mathematics. It was a language of order in a chaotic world, a doorway to understanding the mysteries of the universe. Mathematics transcended the boundaries of logic and reason, inviting dreamers like Amelia to explore the bounds of imagination.\n\nAs twilight bathed the city of Numeria, Amelia gazed out her study window at the twinkling stars. She felt a sense of fulfillment and accomplishment, knowing that her journey through numbers had forever altered the destiny of her world. And yet, there was one final question that lingered in her mind.\n\n\"My dear reader,\" Amelia whispered, her voice carrying the weight of a challenge, \"can you solve the mathematical problem that has captured my heart? Can you find S(1112) and give your answer mod 109?\"\n\nAnd as the moon rose in the night sky, Amelia closed her eyes, awaiting the day when a brave soul would step forward and accept her tantalizing challenge."}, {"id": 341, "euler_id": 341, "title": "Golomb's self-describing sequence", "problem": "The Golomb's self-describing sequence (G(n)) is the only nondecreasing sequence of natural numbers such that n appears exactly G(n) times in the sequence. The values of G(n) for the first few n are\n\nn123456789101112131415\u2026G(n)122334445556666\u2026\n\nYou are given that G(103)=86, G(106)=6137.\nYou are also given that \u2211G(n3)=153506976 for 1\u2264n<103.\nFind \u2211G(n3) for 1\u2264n<106.", "solution": "56098610614277014", "difficulty": 45, "story": "Once upon a time in the small village of Numeria, there lived a shy and curious young girl named Lily. She loved puzzles and riddles, always seeking answers to the questions that ignited her imagination. One sunny morning, Lily's teacher, Miss Mathilda, posed a perplexing problem to the class.\n\n\"Class, today we shall embark on a mathematical adventure,\" Miss Mathilda announced with a twinkle in her eye. \"We shall explore the mysterious world of Golomb's self-describing sequence, a sequence of numbers with a fascinating property. Can any of you unravel this enigma?\"\n\nLily's eyes sparkled with excitement. She had always been inclined towards mathematics, and this problem intrigued her immensely. As she delved into her studies, she discovered that the Golomb's self-describing sequence, denoted as G(n), was a unique nondecreasing sequence of natural numbers. What made it truly remarkable was that every number n appeared exactly G(n) times in the sequence.\n\nThe first few values of G(n) were already revealed to her: 1, 2, 2, 3, 3, 4, 4, 4, 5, 5, and so on, forming an intricate pattern. Lily pondered over the implications of this fascinating sequence, how it could be manipulated and explored. But she couldn't fathom the significance of this pattern and its relation to the world around her.\n\nDays turned into weeks, and Lily found herself engrossed in her quest for knowledge. She spent hours piecing together possible explanations, meticulously calculating and observing. Eventually, her hard work paid off, and she made two groundbreaking discoveries.\n\nFirstly, she found that G(103) equaled 86, and G(106) amounted to an astonishing 6137. These findings only deepened the mystery surrounding Golomb's self-describing sequence. Lily wondered why these numbers played such vital roles in unlocking the sequence's secrets.\n\nSecondly, as she delved further into her studies, she stumbled upon a remarkable revelation. The sum of G(n^3) from n equal to 1, all the way up to 103, was 153506976. This realization left Lily awestruck, and she couldn't help but wonder what the sum of G(n^3) for 1\u2264n<106 would be.\n\nThe magical stories and legends of Numeria whispered secrets to those who listened closely, where numbers danced on the pages and unraveled the mysteries of the world. Lily's mind filled with wonder and curiosity as she imagined the importance of Golomb's self-describing sequence. She yearned to unearth its significance, to comprehend the hidden threads connecting it to their lives.\n\nAs the days progressed, Lily became further entangled in her pursuit of the unknown. With every solved riddle, she grew closer to solving the riddle of Golomb's sequence. The village of Numeria reveled in her enthusiasm, for they, too, saw the world through her bright eyes.\n\nAnd now, dear reader, I pose this question to you: What is the sum of G(n^3) for 1\u2264n<106? Can you uncover the answer hidden within the enigma of Golomb's self-describing sequence?"}, {"id": 368, "euler_id": 368, "title": "A Kempner-like series", "problem": "The  harmonic series  1+12+13+14+... is well known to be divergent.\nIf we however omit from this series every term where the denominator has a 9 in it, the series remarkably enough converges to approximately 22.9206766193.\nThis modified harmonic series is called the Kempner series.\nLet us now consider another modified harmonic series by omitting from the harmonic series every term where the denominator has 3 or more equal consecutive digits.\nOne can verify that out of the first 1200 terms of the harmonic series, only 20 terms will be omitted.\nThese 20 omitted terms are:\n1111,1222,1333,1444,1555,1666,1777,1888,1999,11000,11110,\n11111,11112,11113,11114,11115,11116,11117,11118,11119\nThis series converges as well.\nFind the value the series converges to.\nGive your answer rounded to 10 digits behind the decimal point.", "solution": "253.6135092068", "difficulty": 45, "story": "Once upon a time, in a small village nestled in the heart of a lush green valley, lived a young girl named Amelia. Amelia was known for her insatiable curiosity and her love for numbers. She spent her days exploring the magic of mathematics, deciphering its secrets and unraveling its mysteries.\n\nOne sunny afternoon, as Amelia sat by the riverbank, she noticed an old man with a long gray beard sitting beneath a towering oak tree. Intrigued by his presence, Amelia approached him with a warm smile.\n\n\"Hello, sir! What brings you to our village?\" she asked politely.\n\nThe old man's eyes twinkled with wisdom as he replied, \"I am Dr. Kempner, a mathematician who has dedicated his life to unlocking the wonders of numbers. I have heard tales of your incredible intellect, young Amelia, and I have come seeking your assistance.\"\n\nAmelia's heart leaped with joy at the prospect of collaborating with a renowned mathematician. \"Of course, Dr. Kempner! How may I help you?\" she eagerly inquired.\n\nDr. Kempner, with a beaming smile, produced a piece of parchment from his satchel. The paper was adorned with intricate equations and symbols, dazzling Amelia's already enchanted gaze.\n\n\"The harmonic series,\" Dr. Kempner began, \"is a famous mathematical series that adds infinitely increasing fractions together. However, when we omit terms containing a '9' in the denominator, it astonishingly converges to a specific value - approximately 22.9206766193. This altered series is called the Kempner series.\"\n\nAmelia listened intently, her mind already buzzing with excitement.\n\n\"But that's not all,\" continued Dr. Kempner, his voice filled with anticipation. \"If we further modify the harmonic series, omitting terms with at least three consecutive repeated digits in the denominator, we find that out of the first 1200 terms, only 20 are omitted.\"\n\nAmelia gasped, her eyes widening in awe. \"That's incredibly rare!\" she exclaimed.\n\nDr. Kempner nodded, acknowledging the young girl's astuteness. \"Indeed, Amelia. These 20 omitted terms are: 1111, 1222, 1333, 1444, 1555, 1666, 1777, 1888, 1999, 11000, 11110, 11111, 11112, 11113, 11114, 11115, 11116, 11117, 11118, and 11119.\"\n\nAmelia's mind raced as she tried to fully comprehend the implications of this peculiar phenomenon. She could sense the profound mathematical implications, a mystery yearning to be fully understood.\n\n\"And now, my dear Amelia,\" said Dr. Kempner, his voice filled with anticipation, \"the question that perplexes me: What value does this modified harmonic series eventually converge to?\"\n\nAmelia's eyes gleamed with determination. She knew she had to find the answer, to unlock the secret hidden within the numbers. She spent countless hours, pouring over textbooks, scribbling down countless equations, and immersing herself in the marvels of mathematics.\n\nDays turned into weeks, weeks turned into months, but Amelia never lost hope. She knew that the power of determination and perseverance would eventually lead her to the solution.\n\nAnd so, the story of Amelia's mathematical quest continued, a tale woven intricately into the fabric of her village's history.\n\nBut dear reader, I leave you with this question: Can you uncover the value to which the modified harmonic series converges? What hidden secrets lie within the realm of numbers, waiting to be unlocked?"}, {"id": 377, "euler_id": 377, "title": "Sum of digits - experience #13", "problem": "\nThere are 16 positive integers that do not have a zero in their digits and that have a digital sum equal to 5, namely: \n5, 14, 23, 32, 41, 113, 122, 131, 212, 221, 311, 1112, 1121, 1211, 2111 and 11111.\nTheir sum is 17891.\n\n\nLet f(n) be the sum of all positive integers that do not have a zero in their digits and have a digital sum equal to n.\n\n\nFind \u2211i=117f(13i).\nGive the last 9 digits as your answer.\n", "solution": "732385277", "difficulty": 45, "story": "In the quaint little village of Numeria, lived a young girl named Lily. She was no ordinary girl - she possessed a unique gift for numbers. She could solve complex equations effortlessly and find patterns in the most obscure data sets. However, her love for mathematics was often misunderstood by her classmates, who considered her eccentric and peculiar.\n\nOne gloomy afternoon, as Lily was sitting by the window, she noticed a peculiar book lying on the windowsill. Its tattered pages hinted at a mysterious past, and her curiosity got the better of her. She opened the book to find a page filled with a mathematical problem.\n\nLily's eyes sparkled with excitement as she read the words on the page, and her mind immediately started working on the problem. She was captivated by the challenge it presented, the idea of finding a sum that satisfied certain conditions. Determined to solve it, Lily set out on a mathematical adventure.\n\nShe spent days and nights immersed in the problem, scribbling equations on her chalkboard, and exploring different possibilities. As her progress unfolded, she discovered a pattern that connected the integers without zeros in their digits and their digital sum.\n\nLily's excitement grew, and soon she found herself at the village's bustling library. She dug through mountains of dusty books, searching for anything that could help her further understand the mystery of the numbers. And there, in one old tome, she found the missing piece.\n\nAccording to the book, the sum of all positive integers without zeros in their digits, whose digital sum is n, could be represented by the function f(n). It was as if she had discovered a hidden treasure chest. Lily's mind raced, thinking of how this knowledge could be applied to the problem at hand.\n\nWith newfound determination, Lily returned home and resumed her calculations. She embarked on a journey through the sea of numbers, collecting data and analyzing it. As the days passed, she refined her methods, ensuring that her results were precise.\n\nAt last, the day arrived when Lily had her answer. With trembling excitement, she calculated \u2211i=117f(13i) and arrived at a final sum, but she paused. Lily realized that the magic of numbers was not just in finding their value but in the journey itself.\n\nAs the sun began to set, casting a golden glow upon her room, she closed her eyes and wondered what secrets were concealed within the sum. Maybe, just maybe, the answer held a key to unlocking new worlds, hidden knowledge, or a deeper understanding of the universe.\n\nWith a deep breath, Lily opened her eyes and wrote down the last nine digits of her calculated answer. She sat back, staring at the paper, a mix of awe and curiosity swirling within her. It was now time to pass the torch to someone else, to invite them into the world of numbers and challenges.\n\nDear reader, with the last nine digits as your answer, I pose this question to you: Can you unravel the mystery of \u2211i=117f(13i)? Can you unlock the secrets hidden within? The choice is yours."}, {"id": 399, "euler_id": 399, "title": "Squarefree Fibonacci Numbers", "problem": "\nThe first 15 fibonacci numbers are:\n1,1,2,3,5,8,13,21,34,55,89,144,233,377,610.\nIt can be seen that 8 and 144 are not squarefree: 8 is divisible by 4 and 144 is divisible by 4 and by 9. \nSo the first 13 squarefree fibonacci numbers are:\n1,1,2,3,5,13,21,34,55,89,233,377 and 610.\n\n\nThe 200th squarefree fibonacci number is:\n971183874599339129547649988289594072811608739584170445.\nThe last sixteen digits of this number are: 1608739584170445 and in scientific notation this number can be written as 9.7e53.\n\n\nFind the 100 000 000th squarefree fibonacci number.\nGive as your answer its last sixteen digits followed by a comma followed by the number in scientific notation (rounded to one digit after the decimal point).\nFor the 200th squarefree number the answer would have been: 1608739584170445,9.7e53\n\n\n\nNote: \nFor this problem, assume that for every prime p, the first fibonacci number divisible by p is not divisible by p2 (this is part of Wall's conjecture). This has been verified for primes \u2264 3\u00b71015, but has not been proven in general.\n\nIf it happens that the conjecture is false, then the accepted answer to this problem isn't guaranteed to be the 100 000 000th squarefree fibonacci number, rather it represents only a lower bound for that number.\n\n", "solution": "1508395636674243,6.5e27330467", "difficulty": 45, "story": "Once upon a time in a small village lived a young girl named Alice. Alice was known for her exceptional talent in mathematics. She spent her days exploring the wonders of numbers and solving complex problems that baffled even the village elders.\n\nOne day, a stranger arrived in the village with an intriguing proposition. He claimed to possess the secret to finding the 100,000,000th squarefree fibonacci number. As soon as Alice heard this, her curiosity was piqued, and she decided to meet the stranger and uncover the mystery.\n\nThe stranger, a wise old man named Mr. Smith, greeted Alice warmly. He explained the concept of the fibonacci sequence and how it could be used to calculate squarefree numbers. He shared the first 15 fibonacci numbers with Alice, emphasizing that not all of them were squarefree.\n\nAlice's eyes widened with fascination as she absorbed the information Mr. Smith shared. She instantly saw the elegant pattern of the fibonacci sequence and understood the significance of squarefree numbers. This newfound knowledge fueled her determination to uncover the mystery.\n\nAs Alice delved deeper into the subject, she also learned about Wall's conjecture, which stated that for every prime number, the first fibonacci number divisible by it would not be divisible by the square of that prime. While this conjecture had been verified for primes up to a certain range, it was yet to be proven in general.\n\nRealizing the enormity of the challenge, Alice spent days and nights tirelessly working through calculations, observing patterns, and pushing the boundaries of her mathematical understanding. She felt the weight of her mission to find the 100,000,000th squarefree fibonacci number, knowing that it could only be a lower bound if Wall's conjecture was false.\n\nAlice's dedication and perseverance paid off, as she embarked on an incredible journey through the labyrinth of numbers and equations. With each passing day, she unraveled new mysteries and revealed deeper insights into the nature of squarefree fibonacci numbers.\n\nThe entire village watched in awe as Alice solved complex problems with an ease that surpassed their understanding. She became a symbol of hope and inspiration, encouraging everyone to believe in the power of knowledge and the potential of their own minds.\n\nNow, as Alice neared the end of her incredible journey, she could finally taste the sweetness of victory. She stood on the brink of finding the 100,000,000th squarefree fibonacci number, a feat that had eluded countless mathematicians for centuries.\n\nBut before Alice could make her final calculation, a question lingered in her mind \u2013 a question that she hoped to pass on to future generations of mathematicians.\n\n\"What could be the last sixteen digits of the 100,000,000th squarefree fibonacci number?\" Alice wondered aloud. \"And in scientific notation, how might that number be written?\"\n\nWith fervent anticipation, Alice left her question hanging in the air, challenging those who followed her to unravel the mathematical mystery she had come so close to solving.\n\nAnd so, the legacy of Alice, the young mathematician who dared to explore the secrets of the fibonacci sequence, lived on. The village, inspired by her relentless pursuit of knowledge, continued to delve into the depths of mathematics, hoping to one day find the answer to Alice's final question.\n\nWill you be the one to solve this enigma and uncover the last sixteen digits of the 100,000,000th squarefree fibonacci number and its scientific notation?"}, {"id": 411, "euler_id": 411, "title": "Uphill paths", "problem": "\nLet n be a positive integer. Suppose there are stations at the coordinates (x, y) = (2i mod n, 3i mod n) for 0 \u2264 i \u2264 2n. We will consider stations with the same coordinates as the same station.\n\nWe wish to form a path from (0, 0) to (n, n) such that the x and y coordinates never decrease.\nLet S(n) be the maximum number of stations such a path can pass through.\n\nFor example, if n = 22, there are 11 distinct stations, and a valid path can pass through at most 5 stations. Therefore, S(22) = 5.\nThe case is illustrated below, with an example of an optimal path:\n\n\n\nIt can also be verified that S(123) = 14 and S(10000) = 48.\n\nFind \u2211\u2009S(k5) for 1 \u2264 k \u2264 30.\n", "solution": "9936352", "difficulty": 45, "story": "Once upon a time in a faraway land filled with rolling hills and lush green meadows, there was a small village called Numeria. Numeria was known for its people's love for mathematics. Every year, the village celebrated its Mathematics Day, where the village elders would pose intriguing mathematical problems for the townspeople to solve.\n\nThis year, Numeria was buzzing with excitement as the Mathematics Day approached. Among the villagers was a young and curious girl named Lily. She had always been captivated by the world of numbers and eagerly awaited the challenging problems that awaited her.\n\nAs the day of the event arrived, the village square transformed into a vibrant gathering. The colorful bunting fluttered in the breeze, and there was an air of anticipation.\n\nThe village elder, Mr. Rutherford, took center stage and announced the first problem of the day, a puzzle that required a keen eye for patterns and a creative mind. He introduced the problem with a smile, \"Dear villagers, today we have a fascinating problem that will test not only your mathematical prowess but also your ability to perceive patterns. The problem relates to finding the optimal path through a series of stations in our magical land.\"\n\nLily leaned forward, intrigued by what lay ahead.\n\nMr. Rutherford continued, \"Imagine a world with stations located at coordinates (x, y) = (2i mod n, 3i mod n), where n is a positive integer. We want to find a path from (0, 0) to (n, n) that never decreases in the x and y coordinates. The challenge is to find the maximum number of stations we can pass through along this path, denoted by S(n). For example, for n = 22, S(n) is equal to 5.\"\n\nAs Mr. Rutherford demonstrated the problem on a chalkboard, the townspeople were engrossed by the intricacies of the path. The path was treacherous, twisting and turning through the stations, and required a keen eye to navigate successfully.\n\nLily's mind raced with possibilities as she soaked in the details. She imagined herself traversing this mystical path, making decisions at each station, and continuing her journey. The problem consumed her thoughts, and she pondered how to approach the paths least traveled.\n\nThroughout the day, the villagers engaged in lively discussions, sharing their ideas and forming strategies. Mr. Rutherford encouraged them to think creatively, reminding them of the beauty and elegance that mathematics often held.\n\nWhen the afternoon sun mellowed, and the villagers began to tire, the Mathematics Day drew to a close. As everyone departed the square, deep in thought about the mathematical problem, Lily plucked up the courage to approach Mr. Rutherford.\n\n\"Mr. Rutherford,\" she began with a smile, \"I have a question about the problem we discussed today.\"\n\nThe elder turned his kind eyes toward her, \"Of course, my dear Lily. What can I help you with?\"\n\n\"My question is this,\" Lily hesitated, excitement and curiosity shining in her eyes, \"What is the answer to S(k5) for 1 \u2264 k \u2264 30? I cannot rest until I find the solution!\"\n\nMr. Rutherford chuckled warmly, appreciating the thirst for knowledge burning within Lily. \"Ah, my dear Lily, I cannot give you the answer just yet. In the spirit of Mathematics Day, I encourage you to solve the problem yourself. Seek guidance from the patterns you have discovered, trust in your mathematical intuition, and embark on your own adventure through the stations. I assure you, the answer will be all the more rewarding when you arrive at it.\"\n\nLily nodded, a mixture of determination and excitement in her heart. \"Thank you, Mr. Rutherford. I will embark on this journey and solve the problem on my own. I won't rest until I find the answer!\"\n\nAnd with that, Lily set off, her mind filled with calculations and patterns, ready to conquer the mathematical problem that had captivated her.\n\nSo, dear reader, I leave you with Lily's question: What is the sum of S(k5) for 1 \u2264 k \u2264 30? Can you solve the mathematical puzzle that fascinated both Lily and the villagers of Numeria?"}, {"id": 423, "euler_id": 423, "title": "Consecutive die throws", "problem": "Let n be a positive integer.\nA 6-sided die is thrown n times. Let c be the number of pairs of consecutive throws that give the same value.\nFor example, if n = 7 and the values of the die throws are (1,1,5,6,6,6,3), then the following pairs of consecutive throws give the same value:\n(1,1,5,6,6,6,3)\n(1,1,5,6,6,6,3)\n(1,1,5,6,6,6,3)\nTherefore, c = 3 for (1,1,5,6,6,6,3).\nDefine C(n) as the number of outcomes of throwing a 6-sided die n times such that c does not exceed \u03c0(n).1\nFor example, C(3) = 216, C(4) = 1290, C(11) = 361912500 and C(24) = 4727547363281250000.\nDefine S(L) as \u2211\u2009C(n) for 1 \u2264 n \u2264 L.\nFor example, S(50) mod 1\u00a0000\u00a0000\u00a0007 = 832833871.\nFind S(50\u00a0000\u00a0000) mod 1\u00a0000\u00a0000\u00a0007.\n 1 \u03c0 denotes the prime-counting function, i.e. \u03c0(n) is the number of primes \u2264 n.", "solution": "653972374", "difficulty": 45, "story": "Once upon a time in the bustling city of Numeropolis, there lived a young and brave mathematician named Ethan. He possessed an inquisitive mind, always seeking answers to the most puzzling questions. One day, Ethan stumbled upon an ancient scroll hidden deep within the city's archives. This scroll held a secret, a mystical mathematical problem that intrigued him beyond measure.\n\nAs Ethan unraveled the scroll, his eyes widened with anticipation. The problem involved throwing a 6-sided die a certain number of times and finding the number of pairs of consecutive throws that gave the same value. The solution would then be dependent on the outcome not exceeding a certain value defined by \u03c0(n), the prime-counting function.\n\nThe more Ethan delved into the problem, the more captivated he became. He could see the intricate patterns hiding within the numbers, the enigmatic dance of probability. It was as if the mathematical problem held a key to unlock the secrets of the universe itself.\n\nUnable to contain his curiosity, Ethan decided to investigate the problem further. He spent countless hours immersed in calculations and simulations, studying the behavior of the dice throws. The city of Numeropolis marveled at his dedication, as he tirelessly pursued the hidden truths surrounding the problem.\n\nDays turned into weeks, and weeks turned into months, but Ethan's determination never wavered. He knew that the solution lay not only in the numbers but in the story they told. The more he pondered, the more he realized that the problem affected not just the realm of mathematics, but the lives of the people around him.\n\nOne fateful evening, as Ethan strolled through the city's bustling marketplace, he overheard a distressed conversation between a fruit vendor and a baker. They spoke of their dwindling business, their profits diminishing each passing day. Ethan's mind immediately raced to his mathematical problem. Could the solution hold the key to their struggles? Could it provide an answer to their predicament?\n\nDriven by compassion, Ethan gathered the vendors and shared his findings. He explained how the outcome of the dice throws could affect their livelihoods, and how understanding the intricate patterns within the problem might enable them to make wise decisions. The vendors listened intently, their hope rekindled by the possibility of a solution.\n\nTogether, Ethan and the vendors pondered the problem, exploring different strategies and scenarios. They discussed the implications of their choices, realizing that the outcomes were not merely dictated by chance, but also by their ability to adapt and respond to the patterns they observed.\n\nAs the days turned into weeks once again, the city of Numeropolis began to witness a transformation. Through their newfound understanding, the vendors were able to adapt their strategies, maximizing their profits and creating a harmonious marketplace. Customers flocked to the stalls, attracted by the vendors' ability to predict and cater to their needs.\n\nEthan, content with the impact his knowledge had on the city, continued his quest to solve the mathematical problem. He shared his findings with scholars, students, and fellow mathematicians, igniting a spark of curiosity within each of them. Word of his discoveries spread far and wide, drawing attention from all corners of the mathematical realm.\n\nAs the years passed, Ethan's fame grew, and the city of Numeropolis became renowned for its mathematical prowess. Scholars from far and wide flocked to the city, hoping to learn from the great mathematician and contribute to the ongoing pursuit of knowledge.\n\nYet, even as Ethan's influence spread, he never lost sight of the question that had initiated his journey - the need to find S(50,000,000) mod 1,000,000,007. He knew that the solution to this final puzzle held the power to unlock even greater mysteries, to shed light on the deepest realms of mathematical understanding.\n\nAnd so, dear reader, the story invites you to embark on a journey of your own. Can you solve the mathematical problem that captivated Ethan's heart and transformed the city of Numeropolis? Can you find S(50,000,000) mod 1,000,000,007? As your mind races with possibilities and calculations, remember that the pursuit of knowledge holds infinite wonders, awaiting those with the courage to seek answers in the realm of numbers.\n"}, {"id": 452, "euler_id": 452, "title": "Long Products", "problem": "Define F(m,n) as the number of n-tuples of positive integers for which the product of the elements doesn't exceed m.\nF(10, 10) = 571.\nF(106, 106) mod 1\u00a0234\u00a0567\u00a0891 = 252903833.\nFind F(109, 109) mod 1\u00a0234\u00a0567\u00a0891.", "solution": "345558983", "difficulty": 45, "story": "Once upon a time in the bustling city of Mathematica, there lived a curious young girl named Emily. Emily was known throughout the town for her insatiable thirst for knowledge and her love for solving puzzles. Her room was filled with books, maps, and all sorts of intriguing artifacts that fueled her imagination.\n\nOne sunny afternoon, as Emily sat in her room, pondering over an ancient scroll she had recently discovered, she stumbled upon a mysterious mathematical problem. The scroll spoke of a function known as F(m,n), which defined the number of n-tuples of positive integers for which the product of the elements didn't exceed m. Fascinated by this mathematical enigma, Emily set out on a quest to unravel its secrets.\n\nDetermined to understand this problem, Emily ventured into her community seeking guidance from wise scholars, mathematicians, and even the town's elders. As she delved deeper into her research, she unearthed fascinating secrets and surprising connections.\n\nEmily discovered that F(10, 10) equaled 571, which she found quite intriguing. Her mathematical journey continued, and she soon came across another remarkable fact: F(106, 106) modulo 1,234,567,891 was equal to 252,903,833. This peculiar relationship between the inputs, outputs, and modulus captured her imagination, leaving her desperate to find the answers to the mathematical puzzle.\n\nDays turned into weeks, and weeks into months, but Emily's quest remained unfulfilled. The more she discovered, the more questions she had. She couldn't help but wonder\u2014what secret did the 1,234,567,891 modulus hold? And most importantly, what value would F(109, 109) yield modulo 1,234,567,891?\n\nAs time went by, the town of Mathematica began to recognize Emily's relentless pursuit of knowledge. Her passion for deciphering the hidden truths of mathematics inspired many, and the tale of her quest spread far and wide.\n\nAnd so, dear reader, I leave you with these questions: What is the value of F(109, 109) modulo 1,234,567,891? Can you solve this mathematical enigma that has intrigued Emily and captivated the town of Mathematica? Delve into the world of numbers, challenge your intellect, and satisfy the curiosity that lies within you."}, {"id": 476, "euler_id": 476, "title": "Circle Packing II", "problem": "Let R(a, b, c) be the maximum area covered by three non-overlapping circles inside a triangle with edge lengths a, b and c.\nLet S(n) be the average value of R(a, b, c) over all integer triplets (a, b, c) such that 1\u00a0\u2264\u00a0a\u00a0\u2264\u00a0b\u00a0\u2264\u00a0c\u00a0<\u00a0a\u00a0+\u00a0b\u00a0\u2264\u00a0n\nYou are given S(2) = R(1, 1, 1) \u2248 0.31998, S(5) \u2248 1.25899.\nFind S(1803) rounded to 5 decimal places behind the decimal point.", "solution": "110242.87794", "difficulty": 45, "story": "Once upon a time in a peaceful kingdom, there lived a brilliant young mathematician named Julian. Julian had always been fascinated by numbers and spent most of his time exploring the world through the lens of mathematics. He sought beauty and patterns in everything he encountered, from the elegant symmetry of flowers to the intricate rhythms of music.\n\nOne sunny day, as Julian sat under a giant oak tree in the meadow, he noticed three butterflies fluttering above him. Their graceful dance caught his attention, and he couldn't help but wonder how he could mathematically describe their movements. He observed that the butterflies never collided with each other, keeping a safe distance and forming a perfect triangle as they flitted around.\n\nCuriosity piqued, Julian decided to investigate further. He diligently measured the lengths of the triangle's sides, noting them down in his notebook. \"A fascinating mathematical problem lies here,\" Julian whispered to himself, his eyes shining with excitement.\n\nLater that evening, Julian retired to his study, pouring over his calculations. It wasn't long before he discovered a pattern. \"Let R(a, b, c) be the maximum area covered by three non-overlapping circles inside a triangle with edge lengths a, b, and c,\" he mused, scribbling furiously. \"And let S(n) be the average value of R(a, b, c) over all integer triplets (a, b, c) such that 1 \u2264 a \u2264 b \u2264 c < a + b \u2264 n.\"\n\nThe mathematical problem consumed him, and he spent days immersed in its intricacies. Julian jotted down formulas, drew countless diagrams, and derived elegant theorems. Slowly, but surely, he began to crack the code. He solved S(2), approximating R(1, 1, 1) to be 0.31998, and even managed to find S(5), which turned out to be about 1.25899. It was an exhilarating journey, one that whisked him away into a realm of pure numerical beauty.\n\nBut Julian's quest didn't end there. He yearned for more, hungry to explore the mathematical problem to its fullest extent. With unwavering determination, he set his sights on something greater\u2014S(1803). The number seemed so distant, yet Julian knew he was capable of achieving the impossible.\n\nMonths passed, and Julian's dedication remained unwavering. He painstakingly searched for every conceivable solution, poring over mountains of calculations and examining countless triangles. Slowly but surely, he edged closer to uncovering the truth. He could almost taste the victory, the sweet triumph of knowing that he, Julian, had solved the enigmatic S(1803) rounded to 5 decimal places behind the decimal point.\n\nNow, dear reader, the question lies with you. Can you follow in Julian's footsteps and continue his mathematical odyssey? Can you determine S(1803) rounded to 5 decimal places behind the decimal point? The revelation is waiting to be unveiled, a testament to your prowess as a mathematical explorer. Will you take up the challenge and emerge victorious, just as Julian did?"}, {"id": 480, "euler_id": 480, "title": "The Last Question", "problem": "Consider all the words which can be formed by selecting letters, in any order, from the phrase:\nthereisasyetinsufficientdataforameaningfulanswer\nSuppose those with 15 letters or less are listed in alphabetical order and numbered sequentially starting at 1.\nThe list would include:\n1 : a\n2 : aa\n3 : aaa\n4 : aaaa\n5 : aaaaa\n6 : aaaaaa\n7 : aaaaaac\n8 : aaaaaacd\n9 : aaaaaacde\n10 : aaaaaacdee\n11 : aaaaaacdeee\n12 : aaaaaacdeeee\n13 : aaaaaacdeeeee\n14 : aaaaaacdeeeeee\n15 : aaaaaacdeeeeeef\n16 : aaaaaacdeeeeeeg\n17 : aaaaaacdeeeeeeh\n...\n28 : aaaaaacdeeeeeey\n29 : aaaaaacdeeeeef\n30 : aaaaaacdeeeeefe\n...\n115246685191495242: euleoywuttttsss\n115246685191495243: euler\n115246685191495244: eulera\n...\n525069350231428029: ywuuttttssssrrrDefine P(w) as the position of the word w.\nDefine W(p) as the word in position p.\nWe can see that P(w) and W(p) are inverses: P(W(p)) = p and W(P(w)) = w.\nExamples:\nW(10) = aaaaaacdee\nP(aaaaaacdee) = 10\nW(115246685191495243) = euler\nP(euler) = 115246685191495243Find W(P(legionary) + P(calorimeters) - P(annihilate) + P(orchestrated) - P(fluttering)).\nGive your answer using lowercase characters (no punctuation or space).", "solution": "turnthestarson", "difficulty": 45, "story": "Once upon a time in a small village called Numerica, there lived a young boy named Ethan. Ethan was known throughout the village for his sharp mind and quick thinking. His love for numbers and problem-solving made him the go-to person for any math-related queries.\n\nOne sunny day, Ethan was approached by Mr. Anderson, an eccentric old man who lived on the outskirts of the village. Rumor had it that Mr. Anderson was a retired mathematician with a vast collection of unsolved mathematical problems. This piqued Ethan's interest, and he eagerly accepted the invitation to visit Mr. Anderson's house.\n\nAs Ethan arrived at the old man's doorstep, he was greeted by a mysterious aura that surrounded the place. Antique books filled the shelves, and the aroma of freshly brewed tea wafted through the air. Mr. Anderson welcomed Ethan with a warm smile and guided him to a cozy study.\n\n\"I'm glad you could make it, Ethan,\" Mr. Anderson said, settling into his armchair. \"I have a problem that has been baffling me for years, and I believe you could be the one to solve it.\"\n\nEthan's eyes sparkled with curiosity. \"Please, tell me more.\"\n\nMr. Anderson opened a worn-out notebook and flipped through its pages before pointing at a cryptic phrase:\n\n\"Here lies the unsolved riddle,\" Mr. Anderson began. \"Consider all the words which can be formed by selecting letters, in any order, from this phrase: 'thereisasyetinsufficientdataforameaningfulanswer.'\"\n\nEthan's mind immediately began to whir. He reread the phrase silently, letting his imagination unravel the possibilities.\n\n\"Suppose those with 15 letters or less are listed in alphabetical order and numbered sequentially starting at 1,\" Mr. Anderson continued. \"I've listed a few examples here.\"\n\nEthan's eyes darted across the examples, acknowledging the intricate patterns forming within the sequence. He realized that the position and word were inversely related. The excitement within him grew, and he turned to Mr. Anderson.\n\n\"Mr. Anderson, the relationship between the positions and words is extraordinary! The word in position p can be found by calculating W(p), and similarly, the position of a word w is determined by P(w). They are inverses of each other!\"\n\nMr. Anderson nodded, impressed by Ethan's insight. \"Indeed, Ethan. You have grasped the essence of this mathematical conundrum. But the true challenge lies in finding...\"\n\nBefore Mr. Anderson could complete his sentence, a gust of wind blew through the study, causing the windows to creak. Ethan noticed a crumpled piece of paper caught between the cracked window shutters. His eyes widened as he unfolded the paper.\n\nIt was a handwritten note that read: \"P(legionary) + P(calorimeters) - P(annihilate) + P(orchestrated) - P(fluttering).\" Ethan's heart raced as he realized this was the final piece of the puzzle.\n\n\"Mr. Anderson!\" Ethan exclaimed, \"This note is the key to understanding the significance of this problem! By calculating the positions of each word and performing the indicated operations, we can find the answer!\"\n\nMr. Anderson leaned forward, his eyes filled with anticipation. \"Go on, Ethan. What is the solution?\"\n\nEthan paused, his mind racing with calculations. He had come this far, unwrapping the enigma, but now something unexpected happened. As he uttered the final word of the puzzle, the room suddenly started swirling in a vortex.\n\nEthan and Mr. Anderson found themselves spinning through time, their surroundings changing rapidly. They glimpsed ancient civilizations, revolutionary breakthroughs, and futuristic wonders, all woven together by the threads of mathematics.\n\nAnd just as abruptly as it had started, the spinning ceased. Ethan and Mr. Anderson found themselves back in the study, panting and disoriented.\n\n\"Magnificent,\" Mr. Anderson gasped, a mix of awe and exhaustion in his eyes. \"We've traveled through time using the power of numbers.\"\n\nEthan's mind was abuzz with the adventure they had just experienced. He gazed at Mr. Anderson with newfound respect and admiration.\n\n\"But wait,\" Ethan interjected, realizing something crucial. \"We were so absorbed in the journey and the wonders of mathematics that I forgot to give you the answer.\"\n\nA smile crept across Mr. Anderson's face. \"Ethan, my young friend, that was never the answer I sought. The beauty of this problem lies in its perpetual enticement, in the eternal pursuit of knowledge and discovery.\"\n\nEthan's mind was ignited with the desire to uncover more mathematical mysteries, to delve into the depths of endless possibilities. And so, as he bid farewell to Mr. Anderson, Ethan carried with him a question that would forever linger:\n\n\"What is the solution to W(P(legionary) + P(calorimeters) - P(annihilate) + P(orchestrated) - P(fluttering))? Can you solve it?\"\n\nAnd with that question echoing in his mind, Ethan set off on a journey, embracing the joy of mathematics as he ventured into the realms of infinite possibilities."}, {"id": 509, "euler_id": 509, "title": "Divisor Nim", "problem": "\nAnton and Bertrand love to play three pile Nim.\nHowever, after a lot of games of Nim they got bored and changed the rules somewhat.\nThey may only take a number of stones from a pile that is a proper divisor of the number of stones present in the pile. E.g. if a pile at a certain moment contains 24 stones they may take only 1,2,3,4,6,8 or 12 stones from that pile.\nSo if a pile contains one stone they can't take the last stone from it as 1 isn't a proper divisor of 1.\nThe first player that can't make a valid move loses the game.\nOf course both Anton and Bertrand play optimally.\n\nThe triple (a,b,c) indicates the number of stones in the three piles.\nLet S(n) be the number of winning positions for the next player for 1 \u2264 a, b, c \u2264 n.S(10) = 692 and S(100) = 735494.\n\nFind S(123456787654321) modulo 1234567890.\n", "solution": "151725678", "difficulty": 45, "story": "Once upon a time in the quaint village of Nimbleton, two young friends named Anton and Bertrand spent their days playing games. Their favorite game was three pile Nim, a simple yet entertaining contest of strategy and wit. However, as they grew older and more skilled, the game began to lose its allure. They yearned for a new challenge, a twist that would reignite their passion for gameplay.\n\nOne bright summer day, as they sat beneath their favorite oak tree, a thought struck Anton. \"Bertrand, my friend, I believe it's time we change the rules of our beloved Nim. Let's introduce a new element of strategy that will truly test our skills.\"\n\nWith eyes aglow, Bertrand leaned in, eager to hear Anton's idea. \"Pray tell, Anton, what modifications do you propose?\"\n\nGrinning mischievously, Anton revealed his plan. \"Hear me out, Bertrand. In this new version, we may only take a number of stones from a pile that is a proper divisor of the number of stones present in that pile. Simply put, if a pile contains 24 stones, we may only take 1, 2, 3, 4, 6, 8, or 12 stones from it.\"\n\nBertrand's eyes widened with excitement. \"This adds a whole new dimension to the game! The possibilities are endless. But tell me, what happens if we cannot make a valid move?\"\n\nAnton paused, a devious smile playing on his lips. \"That, my friend, is the essence of our new challenge. The first player who cannot make a valid move loses the game.\"\n\nThe friends spent the entire afternoon engrossed in the new version of Nim. They analyzed each move, weighed their options, and strategized relentlessly. Anton and Bertrand both possessed sharp minds, and as they played, they realized that the game required a level of optimal thinking they had never encountered before.\n\nDays turned into weeks, and weeks into months, as Anton and Bertrand delved deeper into this mathematical playground. They discovered patterns, calculated scores, and developed strategies to outwit each other. Every game became a battle of intuition and intelligence.\n\nAs time went on, the friends noticed a peculiar phenomenon. Certain piles had more winning positions than others. They wondered if there was a way to determine the number of winning positions for any given number of stones.\n\nWith a newfound dedication, Anton and Bertrand began collecting data. They played countless games, keeping meticulous records of wins and losses, and the number of stones in each pile. They soon realized that a pattern emerged. The number of winning positions for the next player depended on the total number of stones in all three piles.\n\nExcitedly, they formulated a function, which they called S(n). This function represented the number of winning positions for the next player when the piles contained 1 \u2264 a, b, c \u2264 n stones. Anton and Bertrand spent countless hours exploring the behavior of this function, making predictions, and testing their theories.\n\nThey discovered that S(10) equaled 692 and S(100) amounted to a staggering 735494. The numbers fascinated them, and they couldn't help but wonder how the function would behave with even larger values of n.\n\nAnd so, our story brings us to the present, where Anton and Bertrand face a mathematical conundrum of enormous proportions. Their calculations led them to a mind-boggling number: S(123456787654321). Now, dear reader, we leave you with this question:\n\nWhat is the value of S(123456787654321) modulo 1234567890?\n\nWill you be the one to solve this mathematical puzzle and unravel the secrets that lie within?"}, {"id": 517, "euler_id": 517, "title": "A real recursion", "problem": "\nFor every real number a>1 is given the sequence ga by:\nga(x)=1 for x<a\nga(x)=ga(x\u22121)+ga(x\u2212a) for x\u2265a\nG(n)=gn(n)\nG(90)=7564511.\n\nFind \u2211G(p) for p prime and 10000000<p<10010000\nGive your answer modulo 1000000007.\n", "solution": "581468882", "difficulty": 45, "story": "Once upon a time in a small village nestled in the rolling hills, there lived a young girl named Lily. Lily was a bright and inquisitive child, always seeking new adventures and challenges to satisfy her curious mind. She possessed a rare gift for numbers and patterns, effortlessly solving mathematical puzzles that left adults scratching their heads.\n\nOne sunny afternoon, as Lily sat beneath a towering oak tree reciting prime numbers in her head, an old man approached her. His name was Professor Albright, a renowned mathematician who had heard of the girl's remarkable talent.\n\n\"Lily,\" he called, \"I have a question for you. Can you help me solve a perplexing mathematical problem?\"\n\nLily's eyes sparkled with curiosity as she eagerly nodded. Professor Albright presented her with the problem:\n\n\"For every real number a>1, a sequence ga is given. The formula is ga(x) = 1 for x < a and ga(x) = ga(x-1) + ga(x-a) for x \u2265 a. Now, find the sum \u2211G(p) for p prime and 10000000 < p < 10010000, where G(n) = gn(n) and G(90) = 7564511.\"\n\nLily's mind whirred to life as she tried to comprehend the intricate problem. She looked up at Professor Albright, determination shining in her eyes.\n\n\"I will solve this problem, Professor,\" she said with unwavering confidence.\n\nDays turned into weeks, and weeks into months as Lily delved deep into the mathematical formula. She pondered over sequences, equations, and numbers, trying to unlock the secret of ga and G(n). The villagers marveled at her intense focus and resilience, but most of all, they admired her indomitable spirit.\n\nOne evening, the autumn winds blew, carrying a gentle melody that whispered through the village. The children's laughter filled the air, giving the village a sense of tranquility. Among those children, playing and running with wild abandon, was Lily. Her face beamed with delight as she reveled in the joy of her youthful innocence.\n\n\"Professor Albright,\" she called out, catching a glimpse of him watching her from afar, \"I have a question for you.\"\n\nCuriosity piqued, the elderly professor approached Lily with a warm smile. \"What is it, my dear?\"\n\n\"Tell me, Professor, why is this mathematical problem so significant? How does it relate to the world outside these numbers? What impact does it have on our lives?\"\n\nProfessor Albright's smile turned into a contemplative expression as he gazed at the spirited young girl before him. \"Lily, my dear, this problem reveals the beauty of pattern and complexity. It allows us to explore the intricate dance of numbers, to understand the order and chaos that shape our universe. Solving this problem, while challenging, is a testament to our ability to grapple with the unknown, to seek knowledge and truth.\"\n\nLily pondered the professor's words, sensing the depth and wisdom behind them. She realized that mathematics was not just about cold calculations or equations on a page. It was about discovery, connection, and the endless possibilities that lay waiting to be explored.\n\nAs the sun set and darkness cast its ethereal shadows over the village, Lily sat beneath her favorite oak tree once more. She mulled over the mathematical problem, her mind buzzing with realization and awe. In this moment of clarity, she found herself wondering:\n\n\"What answers lie within these numbers? And how can mathematics shape our understanding of the world?\"\n\nAnd so, the story continues. The young Lily, armed with her insatiable thirst for knowledge, sets forth on a journey to solve the mathematical problem that lies at the heart of her existence. Will she find the elusive solution? Will she unlock the hidden depths of ga and G(n)? Only time will tell, as Lily dives deeper into the intricate world of mathematics, unraveling the mysteries one equation at a time.\n\nReader, are you ready to join Lily on this mathematical adventure? Can you solve the problem that has intrigued and challenged her? The numbers await, and the answers lie within the realm of possibility.\n\nWill you take the leap?\n\n"}, {"id": 520, "euler_id": 520, "title": "Simbers", "problem": "We define a simber to be a positive integer in which any odd digit, if present, occurs an odd number of times, and any even digit, if present, occurs an even number of times.\nFor example, 141221242 is a 9-digit simber because it has three 1's, four 2's and two 4's. \nLet Q(n) be the count of all simbers with at most n digits.\nYou are given Q(7) = 287975 and Q(100) mod 1 000 000 123 = 123864868.\nFind (\u22111\u2264u\u226439 Q(2u)) mod 1 000 000 123.", "solution": "238413705", "difficulty": 45, "story": "Once upon a time in the quaint village of Numeria, there lived a brilliant mathematician named Professor Albert. He was renowned for his incredible ability to solve even the most perplexing mathematical problems. His mind was like a vast labyrinth of numbers, equations, and patterns waiting to be unraveled.\n\nOne sunny morning, Professor Albert received a mysterious letter sealed with an intricate mathematical symbol, which piqued his curiosity. Inside, he found a complex problem that intrigued him. It was a puzzle known as the Simber Conundrum.\n\nAs he read the problem, Professor Albert's eyes lit up with excitement. He understood the significance of this challenge. The solution to the Simber Conundrum had the power to unlock a treasure that no one had ever laid their eyes upon. Determined and exhilarated, the professor decided to embark on a journey to solve it.\n\nThe quest led Professor Albert deep into the enchanted forests of Numeria. He traveled through thickets and across treacherous ravines, meditating on the problem at every step. The beauty of nature and the complexity of numbers intertwined, guiding him on his path.\n\nDays turned into weeks, and weeks into months, but the professor remained undeterred. He studied countless patterns, meticulously counting odd and even digits. The people of Numeria marveled at his dedication. They watched in awe as he devised elegant equations and formulas to push the boundaries of his understanding.\n\nFinally, after months of tireless effort, Professor Albert made a breakthrough. He constructed a theorem that elegantly defined the quantity Q(n), the count of all simbers with at most n digits. It was a remarkable achievement encapsulated in a simple equation. The village hailed him as a hero, their very own mathematical sorcerer.\n\nHowever, the true test of his brilliance awaited him. With the solution to Q(100), he found that it was necessary to calculate the value mod 1,000,000,123. The professor knew that a single miscalculation could ruin everything, sending him back to square one.\n\nHe locked himself inside his study, pouring over countless calculations, trying various methods until his head ached. Time seemed to stand still as he chased the elusive answer. And then, in a moment of sheer revelation, he discovered the correct value. Joy enveloped his heart, knowing that he was one step closer to unraveling the final mystery.\n\nBut the quest was far from over. As Professor Albert delved deeper into his research, he uncovered an intriguing pattern. He realized that to solve the ultimate puzzle, he needed to determine the sum of Q(2u) for values of u from 1 to 39. It was an astronomical calculation that would test even his incredible mathematical prowess.\n\nThe professor's eyes sparkled with anticipation. He worked tirelessly, feeding mountains of data into his calculations, seeking hidden connections within the numbers. Days turned into nights, and nights into days as he measured the vastness of the problem.\n\nFinally, the day of reckoning arrived. With trembling hands, Professor Albert looked at the final answer he had obtained. His heart raced as he calculated the value modulo 1,000,000,123.\n\nAs he stared at the result, the professor knew that he had come to the end of his journey. But the question remained unanswered. He wondered whether, after all his toil, there was another way to approach the Simber Conundrum. He couldn't help but ponder if someone else could find an alternative path to the hidden treasure.\n\nAnd so, dear reader, the story comes to a close, and a new chapter begins for you. Can you solve the Simber Conundrum? Can you find (\u22111\u2264u\u226439 Q(2u)) modulo 1,000,000,123? The fate of the treasure lies in your hands."}, {"id": 525, "euler_id": 525, "title": "Rolling Ellipse", "problem": "An ellipse E(a, b) is given at its initial position by equation:\nx2a2+(y\u2212b)2b2=1\nThe ellipse rolls without slipping along the x axis for one complete turn. Interestingly, the length of the curve generated by a focus is independent from the size of the minor axis:\nF(a,b)=2\u03c0\u00a0max(a,b)\n\nThis is not true for the curve generated by the ellipse center. Let C(a,b) be the length of the curve generated by the center of the ellipse as it rolls without slipping for one turn.\n\nYou are given C(2, 4) ~ 21.38816906.\nFind C(1, 4) + C(3, 4). Give your answer rounded to 8 digits behind the decimal point in the form ab.cdefghij.", "solution": "44.69921807", "difficulty": 45, "story": "Once upon a time, in a charming little town nestled in a valley, there lived a young girl named Amelia. Amelia was known for her remarkable intellect and her fondness for solving puzzles and riddles. She spent her days exploring the whimsical paths that crisscrossed her town, always in search of a new challenge. One sunny morning, as she strolled along the meandering lanes, she came across a peculiar old man sitting on a bench.\n\nThe man, who introduced himself as Professor Finnegan, had a twinkle in his eyes that immediately caught Amelia's attention. Intrigued, she approached him, curious to know what lay behind his mysterious demeanor. The professor, it seemed, had a particularly puzzling mathematical problem on his hands\u2014one that required an extraordinary mind to crack.\n\nAmelia's eyes sparkled with excitement as she listened to his tale. He explained that an ellipse, named E(a, b), remained stationary until it began rolling without slipping along the x-axis for one complete turn. What fascinated the professor was the discrepancy between the lengths of curves generated by different points on the ellipse. While the distances traveled by the focus remained constant, the same couldn't be said for the curve generated by the center of the ellipse.\n\nAs the professor delved deeper into the details, Amelia couldn't help but imagine the rolling ellipse in her mind. She saw the smooth, graceful motion and marveled at the elegance of its trajectory. It almost seemed like a dance\u2014the ellipse twirling passionately as it made its way along the x-axis.\n\nThe professor revealed a formula that intrigued Amelia even further. According to his calculations, the length of the curve generated by a focus\u2014let's call it F(a, b)\u2014was consistently proportional to the maximum value between a and b, multiplied by 2\u03c0. But the curve generated by the center of the ellipse\u2014let's call that C(a, b)\u2014defied such predictability.\n\nAmelia, captivated by the possibilities, was determined to understand this mystery. She longed to uncover the relationship between the lengths of the curves generated by the center, and she gazed at E(a, b) with newfound curiosity.\n\nThe professor then presented Amelia with a challenge. He asked her to find the value of C(1, 4) + C(3, 4), rounded to eight decimal places\u2014a daunting task, but one that Amelia was willing to embrace. She knew that this mathematical conundrum held the key to unlocking the secrets of the rolling ellipse.\n\nAs the day came to a close, Amelia bid farewell to the professor, her mind brimming with excitement and anticipation. She wandered home, consumed by the question that lingered before her: Could she solve this puzzle and uncover the splendid connection between the lengths of Curves C?\n\nAnd so, as the sun set over the quaint little town and the stars began to emerge, bathing the world in their ethereal glow, Amelia pondered the question that now belonged to her: What is C(1, 4) + C(3, 4), rounded to eight digits behind the decimal point in the form ab.cdefghij?\n\nNow, dear reader, I pose the same question to you. Can you solve this enigma and uncover the secret of the rolling ellipse?"}, {"id": 563, "euler_id": 563, "title": "Robot Welders", "problem": "A company specialises in producing large rectangular metal sheets, starting from unit square metal plates.  The welding is performed by a range of robots of increasing size.  Unfortunately, the programming options of these robots are rather limited.  Each one can only process up to 25 identical rectangles of metal, which they can weld along either edge to produce a larger rectangle.  The only programmable variables are the number of rectangles to be processed (up to and including 25), and whether to weld the long or short edge.\nFor example, the first robot could be programmed to weld together 11 raw unit square plates to make a 11\u00d71 strip.  The next could take 10 of these 11\u00d71 strips, and weld them either to make a longer 110\u00d71 strip, or a 11\u00d710 rectangle.  Many, but not all, possible dimensions of  metal sheets can be constructed in this way.\nOne regular customer has a particularly unusual order: The finished product should have an exact area, and the long side must not be more than 10% larger than the short side. If these requirements can be met in more than one way, in terms of the exact dimensions of the two sides, then the customer will demand that all variants be produced. For example, if the order calls for a metal sheet of area 889200, then there are three final dimensions that can be produced: 900\u00d7988, 912\u00d7975 and 936\u00d7950.  The target area of 889200 is the smallest area which can be manufactured in three different variants, within the limitations of the robot welders.\nLet M(n) be the minimal area that can be manufactured in exactly n variants with the longer edge not greater than 10% bigger than the shorter edge.  Hence M(3) = 889200.\nFind \u2211n=2100M(n).", "solution": "27186308211734760", "difficulty": 45, "story": "Once upon a time, in a bustling city called Metropolis, there was a small but thriving metal manufacturing company known as Metal Works Inc. They were renowned for their high-quality, custom-made metal sheets produced with utmost precision. The intricate welding process was carried out by a range of robots, each with its own unique capabilities.\n\nAmong the robots, there was one named Rusty, who had the ability to weld metal sheets together along either edge. Rusty's programming options were limited, as he could only process up to 25 identical rectangles of metal. However, this limitation never stopped Metal Works Inc. from creating innovative designs and delivering exceptional products.\n\nOne fine morning, a regular customer named Mr. Johnson entered the bustling Metal Works Inc. showroom. He was a peculiar man with a penchant for uniqueness. Mr. Johnson was looking for a metal sheet with a distinct set of requirements. The finished product had to have an exact area, and the long side must not exceed 10% of the short side. If more than one combination of dimensions met these criteria, Mr. Johnson demanded that all variants be produced.\n\nThis unusual order stirred up the curiosity of the Metal Works Inc. team. They realized that solving this mathematical problem would require their expertise, creativity, and the unique capabilities of their robots. Immediately, they set out on a quest to find the perfect solution for Mr. Johnson.\n\nThe head engineer, Professor Mason, gathered the team together and introduced them to the challenge at hand. They brainstormed different strategies, considering all the mathematical possibilities within the constraints of the robot welders. Each engineer eagerly participated, eager to crack the puzzle.\n\nWeeks passed, and many late nights were spent in the Metal Works Inc. laboratory. Finally, a breakthrough came as the team discovered a pattern among the possible dimensions of the metal sheets. They realized that certain areas of metal sheets could be manufactured in multiple variants, meeting Mr. Johnson's requirements.\n\nThe team hailed this discovery as a triumph, for they had solved the mathematical problem presented by Mr. Johnson. Professor Mason named this minimal area \"M(n),\" representing the smallest area that could be manufactured in exactly n variants with the longer edge not greater than 10% bigger than the shorter edge.\n\nAs Professor Mason documented their findings, he couldn't help but wonder about other possible areas and the corresponding values of M(n). How did these values change as the number of variants increased? To satisfy his curiosity, Professor Mason began calculating M(n) for different values of n.\n\nHowever, as Professor Mason delved deeper into his calculations, an intriguing question arose in his mind. What would be the sum of M(n) from n=2 to n=100? How could he find this sum, which represented the combined minimum areas that could be manufactured in various configurations?\n\nWith this very question in his mind, Professor Mason paused his calculations and decided to pen a letter to the readers of Metropolis. He wanted to challenge their mathematical prowess and curiosity. The letter concluded with a resounding question: \"Can you find the value of \u03a3n=2^100 M(n)?\"\n\nAnd so, the letter was published, capturing the attention of Metropolis' mathematicians, scientists, and curious citizens alike. Will you, dear reader, accept this challenge and solve the mystery of \u03a3n=2^100 M(n)?"}, {"id": 569, "euler_id": 569, "title": "Prime Mountain Range", "problem": "A mountain range consists of a line of mountains with slopes of exactly 45\u00b0, and heights governed by the prime numbers, pn. The up-slope of the kth mountain is of height p2k\u22121, and the downslope is p2k. The first few foot-hills of this range are illustrated below.\n\n\nTenzing sets out to climb each one in turn, starting from the lowest. At the top of each peak, he looks back and counts how many of the previous peaks he can see. In the example above, the eye-line from the third mountain is drawn in red, showing that he can only see the peak of the second mountain from this viewpoint. Similarly, from the 9th mountain, he can see three peaks, those of the 5th, 7th and 8th mountain.\nLet P(k) be the number of peaks that are visible looking back from the kth mountain.  Hence P(3)=1 and P(9)=3.\nAlso \u2211k=1100P(k)=227.\nFind \u2211k=12500000P(k).", "solution": "21025060", "difficulty": 45, "story": "Once upon a time, nestled in a picturesque valley, there stood a magnificent mountain range. Its peaks stretched towards the sky, forming a line of breathtaking summits that cascaded down into gentle foot-hills. Each mountain possessed a slope of precisely 45\u00b0, creating a symmetrical and awe-inspiring panorama.\n\nThe heights of these mountains, however, were not arbitrary. They were governed by a special set of numbers known as the prime numbers. In this range, the up-slope of the kth mountain measured the height of p2k\u22121, while the downslope reached a height of p2k. The first few foot-hills of this range are depicted below, their magnificence captured on canvas by artists over the years.\n\nIn the heart of this valley lived a curious adventurer named Tenzing. Eager to conquer the natural wonders that surrounded him, Tenzing decided to embark on a daring journey to climb each mountain in turn, starting from the lowest point. With a heart brimming with excitement, he began his ascent with the first mountain.\n\nAt the peak of each mountain, Tenzing paused to catch his breath and take in the breathtaking scenes before him. But what truly fascinated him was the view of the previous peaks he could behold from those lofty heights. Gazing back behind him, the intrepid climber counted the number of mountains he could see, their majestic shapes silhouetted against the sky.\n\nAs Tenzing continued his journey, he encountered a mesmerizing array of landscapes. From the third mountain, he caught sight of only one peak, the second mountain. The minimalism of the view evoked a sense of isolation and wonder, urging him to conquer more summits.\n\nIn his tireless pursuit of adventure, Tenzing climbed on, mountaintop after mountaintop. The ninth mountain brought him to a celestial viewpoint from which he could behold three peaks. There, stretching before him in all their glory, were the fifth, seventh, and eighth mountains, their grandeur reminding him of the vastness of the world.\n\nAs Tenzing pressed on, his collection of memories continued to grow. He marveled at the unique viewpoints each peak offered, drinking in the beauty and serenity that enveloped him. The world seemed to shrink beneath his feet as he soared higher, witnessing the harmony of nature in all its magnificence.\n\nUnbeknownst to Tenzing, the number of peaks visible from each summit played a vital role in his journey. It was a mathematical pattern that began to stir curiosity within him. He pondered the significance of this revelation, wondering if it held a deeper meaning, perhaps a secret pathway or a hidden treasure.\n\nFinally, after completing his daring conquest of the entire mountain range, Tenzing found himself back at the valley floor. With a twinkle in his eyes, he pieced together the answer to a riddle that had been tantalizing him throughout his journey. The sum of all the peaks he had seen on each climb, P(k), from the first to the one hundredth, yielded a remarkable total of 227.\n\nNow, as you embark on your own adventure through the peaks and valleys of mathematics, I leave you with a question. Can you determine the sum of P(k) for the next compelling journey, from the first to the astonishing 12,500,000th mountain?"}, {"id": 603, "euler_id": 603, "title": "Substring sums of prime concatenations", "problem": "Let S(n) be the sum of all contiguous integer-substrings that can be formed from the integer n. The substrings need not be distinct. \nFor example, S(2024)=2+0+2+4+20+02+24+202+024+2024=2304.\nLet P(n) be the integer formed by concatenating the first n primes together. For example, P(7)=2357111317.\nLet C(n,k) be the integer formed by concatenating k copies of P(n) together. For example, C(7,3)=235711131723571113172357111317.\nEvaluate S(C(106,1012)) mod (109+7).", "solution": "879476477", "difficulty": 45, "story": "Once upon a time, in a small village nestled between rolling hills, there lived a young girl named Lily. She had a curious mind and a penchant for adventure, often seeking out hidden treasures in the nooks and crannies of her village. On this particular day, as the sun cast a golden glow upon the landscape, Lily stumbled upon an old, dusty scroll tucked away in the corner of the village library.\n\nUnfurling the scroll, Lily's eyes widened as she read the intricate symbols and equations adorning its parchment. It was a mathematical problem, one that would soon consume her thoughts and challenge her logical reasoning. Determined to unravel its secrets, Lily embarked on a journey exploring numbers and the mysterious art of mathematics.\n\nAs she delved deeper into the problem, Lily's imagination took flight. She envisioned a world where numbers danced among the clouds, forming intricate patterns that guided the destiny of humankind. Lily's love for the beauty of numbers grew with each passing day, enthralled by the idea that an equation held the power to unlock hidden wonders.\n\nIn her quest for knowledge, Lily stumbled upon an old mathematician named Professor Octavius, renowned for his intellect and wisdom. Eager to learn from him, she approached him one afternoon in the village square, holding the ancient scroll tightly in her hands.\n\n\"Good day, Professor Octavius,\" Lily greeted, her eyes gleaming with curiosity. \"I have discovered a mathematical problem, and I seek your guidance in unlocking its secrets.\"\n\nThe professor's eyes twinkled with delight as he examined the scroll. With a wise nod, he began explaining the problem to Lily. He illustrated how S(n) could be computed by summing all contiguous integer-substrings of a given number n, while P(n) required the concatenation of the first n primes.\n\nLily was mesmerized by the professor's teachings. His words filled her mind, connecting her imagination with the realm of math. The scrolls had brought them together, intertwining their lives in a world where numbers held the key to unraveling mysteries.\n\nDays turned into weeks, and Lily's fascination grew. She spent countless hours exploring the properties of numbers, unleashing the power each one held. She developed a loyal friendship with Professor Octavius, who patiently guided her through the labyrinth of mathematical concepts.\n\nFinally, the day arrived when Lily's understanding of the problem had reached its peak. With her newfound knowledge, she couldn't help but be awestruck by the beauty hidden within the equation. The numbers seemed to whisper secrets only she could comprehend.\n\nLily knew the time had come for her to share her wisdom with the world. She couldn't keep these revelations to herself any longer. As the villagers gathered around, captivated by her words, she began to speak.\n\n\"My dear friends, I have embarked on a journey that has led me to explore the very fabric of our existence. Through the power of numbers, we are connected, intertwined in a vast web of mysteries waiting to be uncovered.\"\n\nWith each word, Lily's voice grew stronger, her passion igniting the hearts of those around her. She spoke of S(n), of P(n), and of the profound implications they held for the world at large. The villagers were enthralled by her presentation, their minds buzzing with newfound wonder.\n\nAs Lily concluded her speech, a hush fell over the crowd. The mathematician's words lingered in the air, demanding attention. And just as the anticipation grew, she posed a question that echoed through the hearts and minds of the villagers.\n\n\"Now, my dear friends, I challenge you with this puzzle: evaluate S(C(106,1012)) mod (109+7). Let your curiosity guide you, for the answer lies within the realm of numbers. Seek solace in your intellect and let your imagination soar. Who among you shall unlock the secrets of this ancient mathematical enigma?\"\n\nAnd so, dear reader, I pose the same question to you: Can you solve this mathematical problem that has captivated Lily and the villagers? Let your imagination soar, for the answer awaits within the intricate patterns of numbers."}, {"id": 619, "euler_id": 619, "title": "Square subsets", "problem": "For a set of positive integers {a,a+1,a+2,\u2026,b}, let C(a,b) be the number of non-empty subsets in which the product of all elements is a perfect square.\nFor example C(5,10)=3, since the products of all elements of {5,8,10}, {5,8,9,10} and {9} are perfect squares, and no other subsets of {5,6,7,8,9,10} have this property.\nYou are given that C(40,55)=15, and C(1000,1234)\u00a0mod\u00a01000000007=975523611.\nFind C(1000000,1234567)\u00a0mod\u00a01000000007.", "solution": "857810883", "difficulty": 45, "story": "Once upon a time, in the small village of Arithmopolis, lived a young, curious girl named Emma. Emma had always been captivated by the magic of numbers that surrounded her every day. Whether it was the petals on a flower or the stars in the night sky, she firmly believed that math was the key to understanding the world.\n\nOne sunny afternoon, Emma found herself sitting under the old oak tree, engrossed in a thick, dusty mathematical tome that she had borrowed from the village library. The book was filled with intriguing problems and equations, but one particular problem caught her attention \u2013 a mysterious puzzle known as C(a,b).\n\nShe read the problem carefully, trying to visualize what it meant. The book explained that C(a,b) represented the number of non-empty subsets of a set of positive integers, where the product of all the elements was a perfect square. Emma's mind began to spin with possibilities. What did this mean? How could she apply it to her daily life?\n\nAs Emma pondered the problem, she noticed an elderly woman named Mrs. Johnson approaching the oak tree. Mrs. Johnson had a reputation for being wise and all-knowing, so Emma decided to seek her guidance.\n\n\"Mrs. Johnson,\" Emma called out, \"I have come across a perplexing mathematical problem. It involves finding the number of non-empty subsets with perfect square products. I can't help but wonder how this problem could be relevant to our lives.\"\n\nMrs. Johnson smiled warmly and settled down beside Emma. \"Ah, young one, you have stumbled upon a fascinating concept indeed. Mathematics has a way of revealing secrets hidden in plain sight, and perhaps this problem holds the key to unlocking a hidden treasure.\"\n\nEmma's eyes sparkled with anticipation as she listened intently to Mrs. Johnson's words. The old woman continued, \"You see, Emma, this problem isn't merely about numbers \u2013 it's about patterns and connections. Just like in our lives, where seemingly unrelated events can hold profound significance when viewed from a different perspective.\"\n\nCuriosity piqued, Emma asked, \"But how can I apply this knowledge in my day-to-day life?\"\n\n\"Think of it this way,\" Mrs. Johnson replied. \"Imagine you're faced with a decision. You have a set of options before you, each represented by positive integers. By understanding the patterns of perfect square products, you may find a clue, a hidden message that helps you choose the path that leads to a positive outcome.\"\n\nEmma's mind buzzed with excitement and anticipation. She had never considered math as a tool for decision-making before. She thanked Mrs. Johnson for her wisdom and returned home, determined to put this newfound knowledge to the test.\n\nDays turned into weeks, and Emma's mind became fixated on the puzzle before her. She started examining every situation, seeking patterns and connections just as Mrs. Johnson had advised. Gradually, Emma's perception transformed, and she began seeing the world through mathematical lenses.\n\nFinally, the day arrived when she encountered the biggest challenge yet: a decision that could alter the course of her life entirely. Emma faced two distinct paths, each filled with opportunities and risks. She took a deep breath and closed her eyes, reaching into her mind for the mathematical secrets she had learned.\n\nAs she visualized the sets of positive integers representing these paths, Emma applied C(a,b) with precision and grace. She meticulously crafted subsets, calculating the perfect square products until the pattern emerged before her eyes. With determination, she made her choice, guided by the mysteries of mathematics.\n\nWeeks turned into months, and Emma's life took an unexpected turn. She found herself studying mathematics at the renowned Arithmopolis University while actively participating in groundbreaking research. The mathematical problem she had once pondered under the old oak tree had led her to incredible discoveries.\n\nOne evening, as Emma prepared to embark on a new endeavor, a question danced on the edge of her lips. She gazed at the night sky, filled with stars twinkling like mathematical mysteries waiting to be solved.\n\nEmma leaned forward, her voice filled with curiosity, and asked, \"If C(1000000,1234567) mod 1000000007 is the key to unraveling the secrets hidden within our universe, what wonders await those who can solve it?\"\n\nAnd so, dear reader, the question was laid before you. Will you accept Emma's challenge and unravel the secrets of C(a,b)?"}, {"id": 623, "euler_id": 623, "title": "Lambda Count", "problem": "The lambda-calculus is a universal model of computation at the core of functional programming languages. It is based on lambda-terms, a minimal programming language featuring only function definitions, function calls and variables. Lambda-terms are built according to the following rules:\nAny variable x (single letter, from some infinite alphabet) is a lambda-term.\nIf M and N are lambda-terms, then (MN) is a lambda-term, called the application of M to N.\nIf x is a variable and M is a term, then (\u03bbx.M) is a lambda-term, called an abstraction. An abstraction defines an anonymous function, taking x as parameter and sending back M.\nA lambda-term T is said to be closed if for all variables x, all occurrences of x within T are contained within some abstraction (\u03bbx.M) in T. The smallest such abstraction is said to bind the occurrence of the variable x. In other words, a lambda-term is closed if all its variables are bound to parameters of enclosing functions definitions. For example, the term (\u03bbx.x) is closed, while the term (\u03bbx.(xy)) is not because y is not bound.\nAlso, we can rename variables as long as no binding abstraction changes. This means that (\u03bbx.x) and (\u03bby.y) should be considered equivalent since we merely renamed a parameter. Two terms equivalent modulo such renaming are called \u03b1-equivalent. Note that (\u03bbx.(\u03bby.(xy))) and (\u03bbx.(\u03bbx.(xx))) are not \u03b1-equivalent, since the abstraction binding the first variable was the outer one and becomes the inner one. However, (\u03bbx.(\u03bby.(xy))) and (\u03bby.(\u03bbx.(yx))) are \u03b1-equivalent.\nThe following table regroups the lambda-terms that can be written with at most 15 symbols, symbols being parenthesis, \u03bb, dot and variables.\n(\u03bbx.x)(\u03bbx.(xx))(\u03bbx.(\u03bby.x))(\u03bbx.(\u03bby.y))(\u03bbx.(x(xx)))(\u03bbx.((xx)x))(\u03bbx.(\u03bby.(xx)))(\u03bbx.(\u03bby.(xy)))(\u03bbx.(\u03bby.(yx)))(\u03bbx.(\u03bby.(yy)))(\u03bbx.(x(\u03bby.x)))(\u03bbx.(x(\u03bby.y)))(\u03bbx.((\u03bby.x)x))(\u03bbx.((\u03bby.y)x))((\u03bbx.x)(\u03bbx.x))(\u03bbx.(x(x(xx))))(\u03bbx.(x((xx)x)))(\u03bbx.((xx)(xx)))(\u03bbx.((x(xx))x))(\u03bbx.(((xx)x)x))\nLet be \u039b(n) the number of distinct closed lambda-terms that can be written using at most n symbols, where terms that are \u03b1-equivalent to one another should be counted only once. You are given that \u039b(6)=1, \u039b(9)=2, \u039b(15)=20 and \u039b(35)=3166438.\nFind \u039b(2000). Give the answer modulo 1000000007.", "solution": "3679796", "difficulty": 45, "story": "Once upon a time, in a small village hidden away in the depths of a dense forest, lived a young and ambitious mathematician named Alice. Alice possessed an insatiable curiosity and a love for unraveling the mysteries of numbers and patterns. She spent her days immersed in books, lost in the enchanting world of mathematics. \n\nOne day, Alice stumbled upon an ancient scroll, hidden deep within the dusty shelves of a forgotten library. As she carefully unrolled the delicate parchment, her eyes widened with excitement. The scroll contained a mathematical problem known as the lambda-calculus, a universal model of computation.\n\nIntrigued by the problem, Alice dove headfirst into deciphering the intricacies of the lambda-terms. She marveled at the elegant simplicity of the language, as it encompassed only function definitions, function calls, and variables. As she delved deeper into the problem, Alice discovered the concept of closed lambda-terms, where every variable was bound to an enclosing function definition.\n\nThe more Alice explored, the more entranced she became. She reveled in the challenge of determining the number of distinct closed lambda-terms that could be constructed using a limited number of symbols. She feverishly scribbled equations and sketched diagrams, as her mind danced with the possibilities hidden within the lambda-calculus.\n\nDays turned into weeks, and weeks turned into months. Alice's obsession with the lambda-calculus consumed her every waking moment. The village folk began to grow concerned, as they witnessed the toll her relentless pursuit of knowledge was taking on her wellbeing. However, Alice was undeterred. The promise of discovery drove her forward.\n\nFinally, after countless sleepless nights and tireless research, Alice reached a breakthrough. With a triumphant smile on her face, she declared, \"\u039b(2000)! I have found you!\" The sheer magnitude of her accomplishment overwhelmed her, and she couldn't help but feel a sense of awe and accomplishment.\n\nBut as Alice's excitement subsided, a sense of unease settled in her heart. She questioned the purpose behind her relentless pursuit. Was there a greater significance to solving \u039b(2000)? What impact would her discovery have on the world? \n\nIn the midst of her contemplation, a gentle breeze whispered through her window, carrying with it the haunting melodies of the forest. The words of her dear mentor, Professor Euler, echoed in her mind, \"Mathematics is not merely about finding answers; it is about unlocking the secrets of the universe.\"\n\nWith renewed determination, Alice resolved to embark on a quest to understand the true essence of \u039b(2000). She embarked on a journey that took her far beyond the boundaries of her village, immersing herself in the wisdom of ancient scholars and seeking guidance from the most brilliant minds of her time.\n\nAs Alice roamed, she encountered individuals whose lives had been shaped by the subtle underpinnings of mathematics. She met a humble farmer whose yield depended on optimizing crop rotations, a musician whose mesmerizing melodies entwined with intricate mathematical patterns, and a thoughtful philosopher who sought to uncover the hidden harmony in the chaos of the universe.\n\nEach encounter brought her closer to an understanding that transcended the mere numbers and symbols on her quest to unlock the secrets of \u039b(2000). The village folk, amazed at her relentless pursuit, began to rally around her, offering support and encouragement. They formed a community of dreamers and thinkers, united in their shared passion for the beauty of mathematics.\n\nBut as Alice stood on the precipice of a grand revelation, she couldn't help but wonder: What does \u039b(2000) truly mean? How does it shape the world around us? And most importantly, what is the significance of this number to the human experience?\n\nAnd so, dear reader, I pose this question to you: Can you decipher the intricate labyrinth of \u039b(2000) and unravel the profound impact it holds? Join Alice on her journey of discovery, and let the enchanting world of mathematics reveal its secrets to you."}, {"id": 637, "euler_id": 637, "title": "Flexible digit sum", "problem": "\nGiven any positive integer n, we can construct a new integer by inserting plus signs between some of the digits of the base B representation of n, and then carrying out the additions.\n\n\nFor example, from n=12310  (n in base 10) we can construct the four base 10 integers 12310,  1+23=2410, 12+3=1510 and 1+2+3=610\n\n\nLet f(n,B)  be the smallest number of steps needed to arrive at a single-digit number in base B. For example, f(7,10)=0 and f(123,10)=1.\n\n\nLet g(n,B1,B2) be the sum of the positive integers i not exceeding n such that f(i,B1)=f(i,B2).\n\n\nYou are given g(100,10,3)=3302. \n\n\nFind g(107,10,3)\n", "solution": "49000634845039", "difficulty": 45, "story": "Once upon a time, in a land far away, there lived a young mathematics prodigy named Oliver. Oliver had an uncanny knack for numbers and loved solving complex mathematical problems. He spent most of his days in his study, poring over equations and uncovering the beauty of patterns.\n\nOne sunny morning, Oliver received a mysterious letter. It was an invitation to a prestigious mathematics conference at the Academy of Numerical Wonders. Excitement coursed through his veins as he packed his bags and embarked on a journey that would change his life forever.\n\nWhen Oliver arrived at the academy, he was surrounded by fellow mathematicians, all equally passionate about numbers. The atmosphere buzzed with intellectual energy, and Oliver found himself immersed in discussions and debates about various mathematical problems.\n\nDuring one particular session, the esteemed Professor Smith posed an intriguing question. He spoke of a mathematical problem that involved converting integers from one base to another by inserting plus signs between their digits. The problem intrigued Oliver, and he became eager to discover its intricacies.\n\nAs the days turned into weeks, Oliver delved deeper into the problem, toiling away in the academy's library. He realized that the problem's complexity grew with the size of the input integer and the base.\n\nUndeterred, Oliver began experimenting with different numbers, eagerly noting down the results. He discovered that he could construct various base-B integers from a given number n by inserting plus signs strategically. \n\nFor instance, if n = 123 in base 10, Oliver could construct 123, 1+23=24, 12+3=15, and 1+2+3=6 in just a few steps. He denoted the minimum number of steps needed to reach a single-digit number in base B as f(n, B).\n\nHis excitement grew as he realized the potential applications of this mathematical problem. Perhaps it could help optimize calculations or simplify algorithms. But one question continued to nag at Oliver's mind: What significance did f(n, B) hold?\n\nWhile Oliver embraced the challenge, a crucial realization struck him. After pondering over the problem for hours, he found that f(i, B1) and f(i, B2) influenced the sum of positive integers i not exceeding n. He symbolized this sum as g(n, B1, B2).\n\nOliver became consumed by the intricacies of f(i, B1) and f(i, B2). He tirelessly found patterns, formulated equations, and simulated countless scenarios. Time seemed to slip away as he engrossed himself in this mathematical quest.\n\nEventually, Oliver's dedication bore fruit. He discovered that g(100, 10, 3) equaled 3302, a triumph that brought him immense joy. But he yearned to dive even deeper into the problem's essence and understand its full potential.\n\nAs the sun set on the final day of the conference, Oliver's enthusiasm sparked a glimmer of hope within his heart. He looked around at his fellow mathematicians and considered the possibilities that lay before him. He pondered how the results might change when the limit shifted from 100 to 107.\n\nWith a renewed determination, Oliver made a promise to himself. He vowed to push the boundaries of human knowledge and find a way to calculate g(107, 10, 3). The problem haunted him as he bid farewell to his newfound friends, boarded a train, and headed back home to continue his quest.\n\nNow, dear reader, I pose this question to you: Can you solve the mathematical problem at hand? What is the value of g(107, 10, 3)? As you contemplate the solution, remember that numbers hold vast mysteries, waiting to be unraveled by those who dare to seek the truth."}, {"id": 642, "euler_id": 642, "title": "Sum of largest prime factors", "problem": "Let f(n) be the largest prime factor of n and F(n)=\u2211i=2nf(i).\nFor example F(10)=32, F(100)=1915 and F(10000)=10118280.\n\nFind F(201820182018). Give your answer modulus 109.", "solution": "631499044", "difficulty": 45, "story": "Once upon a time in the small kingdom of Numeria, there lived a young and curious princess named Adeline. Adeline was known for her insatiable thirst for knowledge and her love for solving puzzles. She spent most of her days wandering through the kingdom, seeking answers to the mysteries that surrounded her.\n\nOne sunny morning, as Adeline strolled through the palace gardens, she stumbled upon an old, dusty parchment hidden beneath a pile of fallen leaves. As she unfolded it, her eyes widened with intrigue. The parchment contained a peculiar mathematical problem known as f(n) and F(n).\n\nAdeline's mind raced with excitement as she read the challenge before her. She understood that f(n) represented the largest prime factor of a given number, while F(n) was the sum of f(i) as i varied from 2 to n. The problem seemed daunting, but the princess couldn't resist the allure of a mathematical mystery.\n\nWith this newfound puzzle consuming her thoughts, Adeline sought the help of the kingdom's wise and venerable mathematician, Professor Archimedes. She explained to him how the problem had unexpectedly found its way into her life and how she felt compelled to solve it.\n\nProfessor Archimedes listened intently, his white beard resting on his chest as he pondered the complexity of the situation. As the most knowledgeable mathematician in all of Numeria, he knew that unraveling the secrets of f(n) and F(n) could unlock unimaginable possibilities.\n\nAfter hours of poring over ancient manuscripts and enduring sleepless nights fueled by countless cups of tea, Professor Archimedes finally cracked the code. He discovered that F(n) had its own intricate pattern, one that revealed itself through a sequence of arithmetic manipulations.\n\nWith newfound determination, Adeline delved deeper into the world of numbers, determined to solve the mathematical conundrum that had taken hold of her heart. She spent countless hours analyzing the patterns, scrutinizing prime numbers, and examining the relationship between f(n) and F(n).\n\nAs her knowledge grew, so did her passion for numbers. Adeline began to see how mathematics wove its way through every aspect of life, from the intricate symmetry of flowers to the rhythmic melodies of music. The once daunting problem had become a gateway into a world of beauty and understanding.\n\nThe day of reckoning arrived\u2014the moment when Adeline would put her newfound mathematical prowess to the ultimate test. She discovered that f(201820182018) and F(201820182018) held the key to unlocking a great secret that had long been concealed within the kingdom's ancient artifacts.\n\nWith Professor Archimedes by her side, Adeline stood before the ornately carved door of the Numerian Hall of Mysteries. Legend had it that behind this very door lay a treasure capable of bringing prosperity and happiness to their beloved kingdom.\n\nThe door groaned open, revealing a room adorned with intricate symbols and enigmatic hieroglyphics. At the center of the chamber stood a pedestal adorned with an ancient golden artifact\u2014a sphere that shimmered with a celestial light.\n\nInscribed on the base of the artifact were the following words:\n\"Gaze upon the mysteries of F(201820182018) and learn of the abundance that lies within.\"\n\nAdeline\u2019s eyes met Professor Archimedes' wise gaze. She realized that solving this mathematical riddle was not merely an academic pursuit but a crucial step towards unveiling the age-old secret that could change the fate of their entire kingdom.\n\nAnd so, as the sun set on the horizon, Adeline and Professor Archimedes stepped forward, reaching out towards the artifact, and the story of their quest merged seamlessly with the mathematical problem that had brought them together.\n\nAs they took hold of the artifact, a brilliant light engulfed the room, and a voice seemed to resonate from within their minds, posing one final question:\n\n\"Find F(201820182018). Give your answer modulus 10^9.\"\n\nAnd now, dear reader, the task falls upon you to solve this enigma, to uncover the sum that holds the key to Numeria's destiny. Can you crack the code and reveal the answer hidden within the realm of numbers?"}, {"id": 648, "euler_id": 648, "title": "Skipping Squares", "problem": "For some fixed \u03c1\u2208[0,1], we begin a sum s at 0 and repeatedly apply a process: With probability \u03c1, we add 1 to s, otherwise we add 2 to s.\nThe process ends when either s is a perfect square or s exceeds 1018, whichever occurs first. For example, if s goes through 0,2,3,5,7,9, the process ends at s=9, and two squares 1 and 4 were skipped over.\nLet f(\u03c1) be the expected number of perfect squares skipped over when the process finishes.\nIt can be shown that the power series for f(\u03c1) is \u2211k=0\u221eak\u03c1k for a suitable (unique) choice of coefficients ak. Some of the first few coefficients are a0=1, a1=0, a5=\u221218, a10=45176.\nLet F(n)=\u2211k=0nak. You are given that F(10)=53964 and F(50)\u2261842418857(mod109).\nFind F(1000), and give your answer modulo 109.", "solution": "301483197", "difficulty": 45, "story": "Once upon a time in the quaint village of Mathlandia, there lived a young and curious mathematician named Alice. Alice was known for her love of patterns and numbers, always seeking to solve the greatest mathematical puzzles. She spent most of her time flipping through books and tinkering with equations, hoping to discover something new and exciting.\n\nOne sunny morning, Alice stumbled upon a mystical book hidden deep in the shelves of the village library. The book was bound in faded leather and had a peculiar title etched on its cover: \"The Enigma of the Skipping Squares.\" Intrigued, Alice opened the book to find a page filled with a perplexing mathematical problem.\n\nAs she read through the problem, Alice's eyes gleamed with excitement. The book described a process that involved summing numbers, probabilities, and perfect squares. The problem intrigued her, and she found herself captivated by the possibility of uncovering the unique coefficients behind this enigma.\n\nUnable to contain her excitement, Alice decided to embark on a quest to solve the mystery of the skipping squares. Armed with her trusty notebook and pencil, she set off on a mathematical adventure.\n\nDays turned into weeks as Alice dove deeper into the realm of numbers. She pondered over the mazes of equations and tirelessly calculated formulas. Every night, she would gather around the village's communal bonfire with her fellow scholars, discussing her progress and seeking their guidance.\n\nOne particular evening, as Alice's determination grew stronger, a brilliant idea sparked in her mind. She realized that the coefficients she sought might hold a clue to a profound truth hidden within the heart of mathematics. With renewed energy, Alice dove headfirst into her calculations, her pencil dancing across the pages of her notebook.\n\nTime flew by, and months turned into years. Alice devoted every waking hour to solve the mystery of the skipping squares, neglecting her friends and missing out on the simple joys of life. But she was driven by an overwhelming desire to unveil the secrets the book held.\n\nThen, one fateful night, a revelation dawned upon her. She discovered the true essence of the coefficients, the sacred pattern that governed the skipping squares. With trembling hands, she wrote down the final calculations and proof. She had found it, the answer to the enigma.\n\nBut as Alice read through her findings, she realized that something was amiss. The quest had consumed her life and taken her away from the world she once knew. The village had changed, and so had she. Regret filled her heart, and she yearned for the simplicity she had abandoned.\n\nFilled with newfound wisdom and a desire to return to her roots, Alice closed her notebook and set out on a different path. She used her knowledge to teach young minds, inspiring them to explore the beauty of mathematics without getting entangled in its complexities. Alice became a beacon of knowledge, guiding her students with patience and understanding.\n\nYears later, as Alice looked back on her journey, a thought crossed her mind. What if there was someone out there, someone just as curious and determined as she once was, longing to solve the mystery she had unravelled? Alice couldn't help but wonder how many squares they would skip over, how many new discoveries they would make.\n\nAnd so, dear reader, as you close this storybook, I ask you this: Can you solve the mathematical problem that Alice uncovered? Can you find F(1000), and give your answer modulo 109?"}, {"id": 653, "euler_id": 653, "title": "Frictionless Tube", "problem": "Consider a horizontal frictionless tube with length L millimetres, and a diameter of 20 millimetres. The east end of the tube is open, while the west end is sealed. The tube contains N marbles of diameter 20 millimetres at designated starting locations, each one initially moving either westward or eastward with common speed v.\nSince there are marbles moving in opposite directions, there are bound to be some collisions. We assume that the collisions are perfectly elastic, so both marbles involved instantly change direction and continue with speed v away from the collision site. Similarly, if the west-most marble collides with the sealed end of the tube, it instantly changes direction and continues eastward at speed v. On the other hand, once a marble reaches the unsealed east end, it exits the tube and has no further interaction with the remaining marbles.\nTo obtain the starting positions and initial directions, we use the pseudo-random sequence rj defined by:\nr1=6563116\nrj+1=rj2mod32745673\nThe west-most marble is initially positioned with a gap of (r1mod1000)+1 millimetres between it and the sealed end of the tube, measured from the west-most point of the surface of the marble. Then, for 2\u2264j\u2264N, counting from the west, the gap between the (j\u22121)th and jth marbles, as measured from their closest points, is given by (rjmod1000)+1 millimetres.\nFurthermore, the jth marble is initially moving eastward if rj\u226410000000, and westward if rj>10000000.\nFor example, with N=3, the sequence specifies gaps of 117, 432, and 173 millimetres. The marbles' centres are therefore 127, 579, and 772 millimetres from the sealed west end of the tube. The west-most marble initially moves eastward, while the other two initially move westward.\nUnder this setup, and with a five metre tube (L=5000), it turns out that the middle (second) marble travels 5519 millimetres before its centre reaches the east-most end of the tube.\nLet d(L,N,j) be the distance in millimetres that the jth marble travels before its centre reaches the eastern end of the tube. So d(5000,3,2)=5519. You are also given that d(10000,11,6)=11780 and d(100000,101,51)=114101.\nFind d(1000000000,1000001,500001).", "solution": "1130658687", "difficulty": 45, "story": "Once upon a time in a bustling city, there stood a grand carnival called \"The Marblemaze Extravaganza.\" This carnival was renowned for its mesmerizing mathematical marvels and mind-boggling games. It attracted visitors from far and wide, all eager to test their wits and challenge their understanding.\n\nAmong the dazzling exhibits was a tube that had captured everyone's attention. The tube stood five meters tall, its length looming over the crowd. Known as the \"Mathematical Marblemaze,\" it housed mysterious marbles that danced within, following a set of rules dictated by complex calculations.\n\nIntrigued visitors would watch as marbles of vibrant colors glided through the transparent tube. They marveled at the marbles' synchronized movements, their every collision orchestrated in perfect harmony. Curiosity sparked in the audience, wondering how these marbles managed to navigate the confined space.\n\nPeople flocked to the carnival to witness the enigma within the Mathematical Marblemaze, unaware of the intricate math governing its every move. Little did they know that the destiny of the marbles lay in an ancient mathematical problem waiting to be solved.\n\nAmidst the spectacle, there was a young girl named Lily who stood captivated by the swirling marbles. Her eyes followed the trajectory of each marble as they collided and changed direction, their vibrant colors streaking through the tube. The mathematical problem intrigued her, and she yearned to unravel its mystery.\n\nDriven by her curiosity, Lily spent countless hours studying the Mathematical Marblemaze. She observed the marbles' movements, calculating the angles and velocities at which they collided. The more she observed, the more she deciphered the patterns hidden within.\n\nLily realized that the starting positions and velocities of the marbles were not random but governed by the pseudo-random sequence depicted in the mathematical problem. The distances and directions were meticulously determined by calculations rooted in the sequence's properties, providing Lily with the crucial framework she needed to understand their movements.\n\nEager to put her newfound knowledge to the test, Lily decided to delve deeper into the Mathematical Marblemaze's mathematical layers. She diligently crunched numbers, ran simulations, and experimented with various tube lengths and marble configurations.\n\nOne fateful day, Lily stumbled upon a remarkable revelation. She discovered that the distance traveled by the central marble, `d(5000,3,2)`, was equal to 5519 millimeters before its center reached the eastern end of the tube. It was a breakthrough that drew gasps from mathematicians and stirred excitement in the minds of those who followed her journey.\n\nThe news of Lily's discovery spread like wildfire. The once-hushed whispers about the Mathematical Marblemaze now turned into fervent discussions among mathematicians and carnival-goers alike. People were mesmerized by Lily's inquisitive mind and her ability to decode the enigma of the marbles.\n\nAs fame and recognition swirled around her, Lily realized she had become a symbol of infinite possibilities. But she was not content with resting on her laurels. The question that lingered in her mind was even more challenging: \"What is `d(1000000000,1000001,500001)`?\" she pondered.\n\nDriven by an insatiable thirst for knowledge, Lily embarked on a new quest. She ventured into the depths of her mind, seeking answers and pushing the boundaries of mathematical understanding. Equipped with her passion and intellect, she was determined to uncover the secrets behind this perplexing calculation.\n\nAnd now, dear reader, I present you with the question that Lily sought to solve: What is `d(1000000000,1000001,500001)`?\n\nWill you step into Lily's shoes and rise to the challenge? The Mathematical Marblemaze awaits your answer, daring you to unlock its final riddle."}, {"id": 654, "euler_id": 654, "title": "Neighbourly Constraints", "problem": "\nLet T(n,m) be the number of m-tuples of positive integers such that the sum of any two neighbouring elements of the tuple is \u2264n.\n\n\nFor example, T(3,4)=8, via the following eight 4-tuples:\n(1,1,1,1)\n(1,1,1,2)\n(1,1,2,1)\n(1,2,1,1)\n(1,2,1,2)\n(2,1,1,1)\n(2,1,1,2)\n(2,1,2,1)\n\nYou are also given that T(5,5)=246, T(10,102)\u2261862820094(mod1000000007) and  T(102,10)\u2261782136797(mod1000000007).\n\n\nFind T(5000,1012)mod1000000007.\n", "solution": "815868280", "difficulty": 45, "story": "Once upon a time, in a quaint little village nestled among rolling hills and lush greenery, lived a young girl named Lily. Lily was intelligent and had a keen interest in mathematics. She loved to spend her days exploring complex equations and solving intricate puzzles.\n\nOne sunny morning, as she was strolling through the village square, she came across a peculiar old man sitting on a bench. His eyes sparkled with wisdom, and an air of mystery surrounded him. Intrigued, Lily approached the old man and struck up a conversation.\n\n\"Good morning, sir,\" Lily greeted politely. \"My name is Lily. I couldn't help but notice your intriguing presence. May I ask who you are?\"\n\nThe old man smiled kindly and replied, \"Ah, young Lily. I am Professor Morgan, a renowned mathematician. I have spent my life unraveling the mysteries of numbers and equations. Tell me, child, do you enjoy solving mathematical puzzles?\"\n\nLily's eyes lit up with delight. \"Indeed, Professor Morgan! I find great joy in exploring the world of numbers and unravelling their secrets. Do you have a puzzle for me?\"\n\nProfessor Morgan nodded and shared with Lily the mathematical problem.\n\n\"Let T(n,m) be the number of m-tuples of positive integers such that the sum of any two neighboring elements of the tuple is \u2264n. For example, T(3,4)=8, and so on,\" he explained.\n\nLily's mind buzzed with excitement as she imagined the infinite possibilities of m-tuples. She promised to find the solution and took her leave, eager to dive into this captivating challenge.\n\nDays turned into weeks, and weeks into months, as Lily immersed herself in the world of T(n,m). She meticulously analyzed every combination of m-tuples, exploring the patterns and relationships that emerged. She spent endless nights poring over her notes and scribbling furiously, fueled by her determination to unravel the puzzle set forth by Professor Morgan.\n\nEventually, Lily's tireless efforts bore fruit. In a triumphant moment of clarity, she discovered a breakthrough that shed light on the mysterious nature of T(n,m). A profound understanding of the problem permeated her being, awakening a sense of wonder in her soul.\n\nHowever, Lily realized that this newfound knowledge was too immense for her alone. She understood that the answer to T(5000,1012)mod1000000007 held significant importance, not only for her but for the mathematical community as a whole.\n\nWith this realization, Lily drafted a heartfelt letter to Professor Morgan, detailing her findings and seeking guidance:\n\n\"Dear Professor Morgan,\n\nI hope this letter finds you in good health and high spirits. I write to you with great excitement and a sense of urgency. After months of exploring T(n,m), I have made a breakthrough! I believe I have found the key to understanding T(5000,1012)mod1000000007.\n\nHowever, I find myself at a crossroads. Should I publish my findings and share them with the world? Or should I keep this revelation to myself and continue my solitary pursuit of knowledge?\n\nYour wisdom has guided me thus far, Professor Morgan. What do you advise? What course of action shall I take?\n\nI eagerly await your response.\n\nYours eagerly,\nLily\"\n\nDays turned into weeks once again, as Lily anxiously anticipated a reply from Professor Morgan. The weight of her decision pressed upon her, as she weighed the merits of sharing her discovery versus keeping it hidden away.\n\nFinally, a response arrived in the form of a letter, sealed with the emblem of Professor Morgan. Lily gingerly opened it, her heart pounding in her chest.\n\n\"My dear Lily,\n\nYour letter reached me at a most opportune time. Your findings are indeed remarkable and have vast implications for the world of mathematics.\n\nHowever, knowledge is a gift best shared. It is through collaboration and the exchange of ideas that true progress is made. I urge you to publish your findings and allow the world to marvel at your brilliance.\n\nRemember, a candle loses nothing by lighting another. Share your light with the world, my dear Lily, and watch as it illuminates the minds of countless others.\n\nWith utmost admiration,\nProfessor Morgan\"\n\nTears of joy welled up in Lily's eyes as she read Professor Morgan's letter. She knew deep down that he was right. Her discovery deserved to be shared, for the world to see and explore.\n\nAnd so, Lily mustered her courage, gathered her research, and prepared to share her findings with the mathematical community. But before embarking on this new chapter of her life, she couldn't help but wonder:\n\nWhat would be the impact of T(5000,1012)mod1000000007? How would those in the mathematical realm react to her discovery?\n\nAnd with that lingering question, Lily embarked on her journey, ready to unveil the extraordinary answer to the world.\n\n**Question for the Reader**: How will Lily's discovery of T(5000,1012)mod1000000007 impact the mathematical community, and what consequences will it have in the realm of numbers?"}, {"id": 666, "euler_id": 666, "title": "Polymorphic Bacteria", "problem": "Members of a species of bacteria occur in two different types: \u03b1 and \u03b2. Individual bacteria are capable of multiplying and mutating between the types according to the following rules:\nEvery minute, each individual will simultaneously undergo some kind of transformation.\nEach individual A of type \u03b1 will, independently, do one of the following (at random with equal probability):\nclone itself, resulting in a new bacterium of type \u03b1 (alongside A who remains)\nsplit into 3 new bacteria of type \u03b2 (replacing A)\n\nEach individual B of type \u03b2 will, independently, do one of the following (at random with equal probability):\nspawn a new bacterium of type \u03b1 (alongside B who remains)\ndie\n\nIf a population starts with a single bacterium of type \u03b1, then it can be shown that there is a 0.07243802 probability that the population will eventually die out, and a 0.92756198 probability that the population will last forever. These probabilities are given rounded to 8 decimal places.\n\n\nNow consider another species of bacteria, Sk,m (where k and m are positive integers), which occurs in k different types \u03b1i for 0\u2264i<k. The rules governing this species' lifecycle involve the sequence rn defined by:\n\nr0=306\nrn+1=rn2mod10007\n\nEvery minute, for each i, each bacterium A of type \u03b1i will independently choose an integer j uniformly at random in the range 0\u2264j<m. What it then does depends on q=rim+jmod5:\nIf q=0, A dies.\nIf q=1, A clones itself, resulting in a new bacterium of type \u03b1i (alongside A who remains).\nIf q=2, A mutates, changing into type \u03b1(2i)modk.\nIf q=3, A splits into 3 new bacteria of type \u03b1(i2+1)modk (replacing A).\nIf q=4, A spawns a new bacterium of type \u03b1(i+1)modk (alongside A who remains).\n\nIn fact, our original species was none other than S2,2, with \u03b1=\u03b10 and \u03b2=\u03b11.\n\n\nLet Pk,m be the probability that a population of species Sk,m, starting with a single bacterium of type \u03b10, will eventually die out. So P2,2=0.07243802. You are also given that P4,3=0.18554021 and P10,5=0.53466253, all rounded to 8 decimal places.\n\n\nFind P500,10, and give your answer rounded to 8 decimal places.\n", "solution": "0.48023168", "difficulty": 45, "story": "The Adventures of Bacterium Bill\n\nOnce upon a time, in a petri dish teeming with life, there lived a spirited bacterium named Bill. Bill was no ordinary bacterium; he belonged to a unique species called Sk,m.\n\nIn this bustling petri dish, there were many other bacterial species, each with its own quirks and behaviors. But Sk,m stood out from the rest. You see, Sk,m bacteria had the ability to multiply and mutate, thanks to a sequence of numbers called rn. This sequence determined their fate and the fate of their species.\n\nBill was a curious bacterium and often found himself pondering the mathematics that governed his existence. He would often explore the vast landscape of the petri dish, hopping from one colony to another, marveling at the diversity of life within.\n\nOne day, while Bill was observing a neighboring colony, he overheard a conversation between two bacteria\u2014Alpha and Beta. They were discussing the probability of their species dying out. Alpha mentioned that the probability for their species, S2,2, was 0.07243802, while Beta shared the probabilities for S4,3 and S10,5, which were 0.18554021 and 0.53466253 respectively.\n\nThis piqued Bill's interest. He wondered what the probability would be for his own species, P500,10. He knew it would be a challenging task to figure it out, but Bill was determined to find the answer.\n\nWith a newfound purpose, Bill embarked on an adventure through the petri dish. He traveled from one colony to another, seeking answers from wise old bacteria and consulting ancient mathematical scrolls. Along the way, he learned about the intricacies of the rn sequence and how it influenced the fate of his species.\n\nBill discovered that Pk,m could be calculated by using the formulas and rules governing the lifecycle of Sk,m bacteria. He understood that each bacterium of type \u03b1i would choose a random integer j, and depending on the value of q, it would either die, clone itself, mutate, split, or spawn a new bacterium. These decisions, seemingly random, were intricately connected to the probabilities of survival.\n\nAs Bill continued his quest for knowledge, he encountered an elderly bacterium named Professor Gamma. The professor was renowned for his deep understanding of mathematical patterns in the petri dish.\n\nExcitement filled Bill's tiny bacteria body as he approached Professor Gamma. \"Oh, wise Professor Gamma, I seek your guidance. I wish to calculate the probability P500,10 for my species, Sk,m,\" Bill exclaimed.\n\nThe professor listened intently, his eyes twinkling with wisdom. \"Ah, young Bill, you are on a noble quest indeed. The probability Pk,m can be found by iterating through the rn sequence, using the formulas and rules I'm sure you've learned about in your journey. But remember, my friend, it won't be an easy task.\"\n\nBill nodded, realizing the enormity of the task at hand. He had ventured far and wide, gathering knowledge and experiences, but solving this mathematical problem would truly be his greatest challenge yet.\n\nAnd so, dear reader, I leave you with this question: Can you calculate the probability P500,10 for Bill's species, Sk,m? What would be the fate of the bustling petri dish if Sk,m were to perish or thrive?\n\nThe answer lies within the numbers and formulas that govern the lifecycle of Sk,m bacteria. Can you unlock the mathematical secrets hidden in their world and solve the puzzle that has perplexed Bill and many others?\n\nThe adventure awaits. Will you take on the challenge and uncover the fate of Bill's species?"}, {"id": 669, "euler_id": 669, "title": "The King's Banquet", "problem": "The Knights of the Order of Fibonacci are preparing a grand feast for their king. There are n knights, and each knight is assigned a distinct number from 1 to n.\nWhen the knights sit down at the roundtable for their feast, they follow a peculiar seating rule: two knights can only sit next to each other if their respective numbers sum to a Fibonacci number.\nWhen the n knights all try to sit down around a circular table with n chairs, they are unable to find a suitable seating arrangement for any n>2 despite their best efforts. Just when they are about to give up, they remember that the king will sit on his throne at the table as well.\nSuppose there are n=7 knights and 7 chairs at the roundtable, in addition to the king\u2019s throne. After some trial and error, they come up with the following seating arrangement (K represents the king):\n\n\nNotice that the sums 4+1, 1+7, 7+6, 6+2, 2+3, and 3+5 are all Fibonacci numbers, as required. It should also be mentioned that the king always prefers an arrangement where the knight to the his left has a smaller number than the knight to his right. With this additional rule, the above arrangement is unique for n=7, and the knight sitting in the 3rd chair from the king\u2019s left is knight number 7.\nLater, several new knights are appointed to the Order, giving 34 knights and chairs in addition to the king's throne. The knights eventually determine that there is a unique seating arrangement for n=34 satisfying the above rules, and this time knight number 30 is sitting in the 3rd chair from the king's left.\nNow suppose there are n=99194853094755497 knights and the same number of chairs at the roundtable (not including the king\u2019s throne). After great trials and tribulations, they are finally able to find the unique seating arrangement for this value of n that satisfies the above rules.\nFind the number of the knight sitting in the 10000000000000000th chair from the king\u2019s left.", "solution": "56342087360542122", "difficulty": 45, "story": "Once upon a time, in the mystical kingdom of Mathematica, there existed an esteemed Order of Knights whose duty was to protect the land from any threat that may arise. These knights were not only skilled in the art of combat but were also well-versed in the ways of mathematics, using their knowledge to strategize and outsmart their adversaries.\n\nUnder the guidance of their wise and just king, King Fibonacci, the knights flourished and brought prosperity to the kingdom. To honor their achievements and celebrate their allegiance, King Fibonacci decided to host a grand feast for his loyal knights.\n\nAs preparations for the feast began, the knights realized that the seating arrangement needed to adhere to a peculiar rule. Each knight was assigned a unique number from 1 to n, and two knights could only sit next to each other if the sum of their respective numbers equaled a Fibonacci number.\n\nThis seating rule posed a challenge for the knights, as they were unable to find a suitable arrangement for any value of n greater than 2. Perplexed but determined, they brainstormed day and night, refusing to let their spirits wane.\n\nJust as they were about to give up, a realization struck them like a bolt of lightning. If they included the king's throne as part of the seating arrangement, they might be able to find a suitable arrangement. Excited by this newfound hope, the knights embarked on a quest to solve the seating puzzle.\n\nWith a total of n=7 knights and 7 chairs at the roundtable, the knights came up with a unique seating arrangement. They placed the king's throne at the head of the table, with the knights sitting in a circular pattern around it. The knight who sat in the 3rd chair from the king's left was knight number 7.\n\nEager to test their theory on a larger scale, the Order soon welcomed new recruits, adding 34 more knights to their ranks. This expanded the number of knights and chairs at the roundtable to 34, not including the king's throne. The knights toiled tirelessly, determined to find a unique seating arrangement that satisfied the Fibonacci sum rule. In the end, they succeeded, and knight number 30 found himself in the 3rd chair from the king's left.\n\nFilled with both excitement and trepidation, the knights faced their most challenging task yet. This time, they were confronted with a staggering number of n=99194853094755497 knights and an equal number of chairs at the roundtable. Defeating such an arduous problem required great trials and tribulations, but their resilience and unwavering dedication paid off.\n\nAfter countless days and sleepless nights, the knights finally discovered the unique seating arrangement that satisfied the Fibonacci sum rule for this astronomical value of n. They celebrated their victory, but they couldn't help but wonder about the knight sitting in the 10000000000000000th chair from the king's left.\n\nAnd so, dear reader, the question remains: Who is the knight sitting in the 10000000000000000th chair from the king's left?"}, {"id": 687, "euler_id": 687, "title": "Shuffling Cards", "problem": "A standard deck of 52 playing cards, which consists of thirteen ranks (Ace, Two, ..., Ten, King, Queen and Jack) each in four suits (Clubs, Diamonds, Hearts and Spades), is randomly shuffled.  Let us call a rank perfect if no two cards of that same rank appear next to each other after the shuffle.\n\nIt can be seen that the expected number of ranks that are perfect after a random shuffle equals 4324425\u224810.1741176471.\n\nFind the probability that the number of perfect ranks is prime. Give your answer rounded to 10 decimal places.", "solution": "0.3285320869", "difficulty": 45, "story": "Once upon a time, in the magical kingdom of Mathopia, there lived a young and curious girl named Alice. Alice had always been fascinated by numbers and patterns, and she was known throughout the kingdom for her mathematical prowess.\n\nOne sunny day, as Alice was strolling through her favorite garden, she stumbled upon a deck of colorful playing cards scattered across the ground. Intrigued, she scooped them up and started examining each one. The deck was complete, with all 52 cards present, and it consisted of thirteen ranks in four suits.\n\nAs Alice shuffled the deck, her mind started racing with numbers and possibilities. She pondered over the probability of finding certain card combinations after a random shuffle. Little did she know that this simple deck of cards would lead her on an unexpected mathematical adventure.\n\nThat night, Alice found herself unable to sleep. The question of perfect ranks plagued her mind. What were the chances of having a prime number of perfect ranks after shuffling the deck? She couldn't shake off the thought and decided to embark on a quest to find the answer.\n\nAlice set off on her journey, visiting various mathematicians and wise creatures who could aid her in her quest. Along the way, she met Professor Fibonacci, a renowned mathematician who specialized in number theory. He explained to Alice that a rank would be considered perfect if no two cards of that same rank appeared consecutively after the shuffle. Professor Fibonacci had calculated the expected number of perfect ranks to be approximately 10.1741176471.\n\nAs Alice traveled further, she encountered the legendary Oracle of Primes, a wise and mystical being who held the secrets to prime numbers. The Oracle revealed that the number of perfect ranks that would be prime after a shuffle was a fascinating concept. However, the Oracle refused to disclose the probability, leaving Alice even more intrigued and determined to solve the problem herself.\n\nWith newfound determination, Alice returned to Mathopia and delved deep into the world of numbers. She meticulously analyzed various patterns and card combinations, putting her mathematical skills to the test. Days turned into weeks, and weeks turned into months, as Alice tirelessly worked on the problem.\n\nFinally, after much effort and countless sleepless nights, Alice discovered a breakthrough. The probability of having a prime number of perfect ranks after shuffling the deck amounted to a single decimal place\u20140. Presenting her findings to the mathematicians and wise creatures she had met on her journey, Alice sought confirmation.\n\nThough the answer had been uncovered, Alice's quest wasn't complete. She wanted to share this mathematical marvel with the people of Mathopia, to ignite their curiosity and spark an interest in the beauty of numbers. With a deep breath, Alice looked at the horizon and decided it was time to return to her kingdom and reveal her discovery.\n\nAs she made her way back to Mathopia, Alice could hardly contain her excitement. The people eagerly gathered in the town square, awaiting her arrival. She stood before them, clutching the deck of cards in her hand, and shared her thrilling adventure, the story of her quest for the probability of having a prime number of perfect ranks after shuffling the deck.\n\nBut Alice's captivating tale came to an end, leaving the people craving one final piece of the puzzle. The crowd leaned forward, their eyes filled with anticipation, as Alice posed her question: \"What is the probability, rounded to 10 decimal places, that the number of perfect ranks after shuffling the deck is prime?\"\n\nAnd so, the people of Mathopia were left with a challenge\u2014a mathematical enigma that would continue to baffle and inspire them. Would they be able to solve the problem that Alice had uncovered? Only time would tell."}, {"id": 703, "euler_id": 703, "title": "Circular Logic II", "problem": "Given an integer n, n\u22653, let B={false,true} and let Bn be the set of sequences of n values from B. The function f from Bn to Bn is defined by f(b1\u2026bn)=c1\u2026cn where:\nci=bi+1 for 1\u2264i<n.\ncn=b1AND(b2XORb3), where AND and XOR are the logical AND and exclusive OR operations.\nLet S(n) be the number of functions T from Bn to B such that for all x in Bn, T(x)\u00a0AND\u00a0T(f(x))=false.\nYou are given that S(3)=35 and S(4)=2118.\nFind S(20). Give your answer modulo 1001001011.", "solution": "843437991", "difficulty": 45, "story": "Once upon a time in a small village, there was a young boy named Max who loved solving mysteries. From a young age, he had a knack for numbers and patterns, always seeking the thrill of uncovering hidden solutions. His curious mind had made him quite popular among the villagers, who often came to him with puzzles and riddles they couldn't solve.\n\nOne sunny afternoon, an elderly woman named Mrs. Anderson visited Max's house. She seemed quite distressed, clutching a crumpled piece of paper in her hand. Max invited her inside, sensing the urgency in her eyes.\n\n\"Max, I need your help,\" Mrs. Anderson said, her voice trembling. \"I found this intriguing mathematical problem, and I can't make any sense of it. I've spent days trying to figure it out, but I'm afraid I'm at a loss.\"\n\nIntrigued by her dilemma, Max unfolded the paper and read the problem carefully, his mind racing to grasp its significance.\n\n\"Given an integer n, n\u22653...\" Max mumbled to himself, his fingers tapping the table rhythmically. He was deep in thought, absorbed in the puzzle. Suddenly, he began pacing back and forth, connecting the dots in his mind.\n\n\"I think I may need a little time to crack this one, Mrs. Anderson,\" Max finally said, a spark of excitement in his eyes. \"But I promise you, I will do everything in my power to find the solution.\"\n\nWeeks turned into months, and Max dedicated himself to unraveling the enigma that gripped him. His sleepless nights were filled with calculations, diagrams, and an unyielding determination to solve the problem. Day by day, his understanding of the puzzle grew, until finally, he had a breakthrough.\n\nOne evening, as the sun painted the sky in hues of orange, Max sat with Mrs. Anderson in his backyard garden, ready to share his findings.\n\n\"Mrs. Anderson,\" Max began, his voice filled with a sense of triumph, \"this puzzle you brought me, it's quite fascinating. I now understand the role of this mathematical problem in everyday life.\"\n\nThe elderly woman's eyes twinkled with anticipation as Max continued.\n\n\"You see, this function, f, it's like a secret key that can be used to decode hidden messages. It takes sequences of values and transforms them into different combinations. But what's even more intriguing is the function T, the one that brings both chaos and order.\"\n\nMax explained how the function T, when applied to a sequence x in Bn, returns a value that determines if T(x) and T(f(x)) are false when compared together. It was as if the function acted like a gatekeeper, guarding the secrets of the sequences.\n\n\"Based on my calculations,\" Max said, his voice growing eager, \"I've determined that the number of functions T, denoted as S(n), can be a powerful tool for discerning patterns and uncovering hidden messages within these sequences.\"\n\nMrs. Anderson's eyes filled with awe and wonder as she soaked in Max's explanation. She could hardly believe a seemingly innocuous mathematical problem could hold such importance.\n\n\"But Max,\" she asked with anticipation, \"you still haven't told me S(20). I'm dying to know!\"\n\nMax looked at Mrs. Anderson, his gaze intense and unwavering. The significance of the number, S(20), was immense, as it would give them access to countless mysteries and unlock the potential within these sequences.\n\n\"I'm afraid,\" Max said, his voice filled with excitement, \"you will have to help me find the answer. What could be the value of S(20)? And remember, Mrs. Anderson, we must give our answer modulo 1001001011.\"\n\nAs the evening sky darkened, Max and Mrs. Anderson set to work, their minds brimming with possibilities. Together, they ventured into the world of numbers, chasing the solution to the mathematical problem that had captivated them both.\n\nAnd so, dear reader, I present the question to you: What is the value of S(20)? Can you find the answer, keeping in mind that we must give it modulo 1001001011?"}, {"id": 716, "euler_id": 716, "title": "Grid Graphs", "problem": "\nConsider a directed graph made from an orthogonal lattice of H\u00d7W nodes. \nThe edges are the horizontal and vertical connections between adjacent nodes.\nW vertical directed lines are drawn and all the edges on these lines inherit that direction. Similarly, H horizontal directed lines are drawn and all the edges on these lines inherit that direction.\n\n\nTwo nodes, A and B in a directed graph, are strongly connected if there is both a path, along the directed edges, from A to B as well as from B to A. Note that every node is strongly connected to itself.\n\n\nA strongly connected component in a directed graph is a non-empty set M of nodes satisfying the following two properties:\n\nAll nodes in M are strongly connected to each other.\nM is maximal, in the sense that no node in M is strongly connected to any node outside of M.\n\nThere are 2H\u00d72W ways of drawing the directed lines. Each way gives a directed graph G. We define S(G) to be the number of strongly connected components in G.\n\n\nThe illustration below shows a directed graph with H=3 and W=4 that consists of four different strongly connected components (indicated by the different colours).\n\n\n\n\nDefine C(H,W) to be the sum of S(G) for all possible graphs on a grid of H\u00d7W. You are given C(3,3)=408, C(3,6)=4696 and C(10,20)\u2261988971143(mod1000000007).\n\n\nFind C(10000,20000) giving your answer modulo 1000000007.\n", "solution": "238948623", "difficulty": 45, "story": "Once upon a time in a quaint little village, there lived a talented young mathematician named Lily. She had a remarkable ability to visualize complex mathematical concepts, making them seem like child's play. Lily's favorite pastime was exploring the deep and mysterious woods that surrounded the village, where she often found inspiration for her mathematical pursuits.\n\nOne sunny afternoon, Lily embarked on her usual adventure into the forest. As she strolled through the dense foliage, she stumbled upon a peculiar clearing. In the middle of the clearing was an ancient-looking chessboard, unlike any she had ever seen before. The chessboard was made up of tiny interconnected nodes, forming a grid just big enough for her to navigate.\n\nCuriosity filled Lily's heart as she examined the nodes closely. She noticed that each node had four adjacent nodes - left, right, top, and bottom. Following these directions, she could traverse the grid. However, a closer look made her realize that some edges between the nodes were directed, indicating the possibility of movement in only one direction.\n\nAs she pondered the significance of these directed edges, a gust of wind swept through the clearing. To her astonishment, the edges on the vertical lines aligned themselves in a certain direction, while those on the horizontal lines aligned in another. The directed lines seemed to convey a hidden message.\n\nIntrigued, Lily began to experiment with different ways to draw the directed lines on the grid. With each new configuration, she carefully counted the number of strongly connected components she discovered. A strongly connected component referred to a set of nodes that were not only interconnected but also had paths leading in both directions.\n\nLily soon discovered that there were countless ways of drawing the directed lines on the grid. Each configuration revealed a different number of strongly connected components. Her excitement grew as she realized the potential significance of her findings.\n\nWeeks turned into months as Lily tirelessly explored the mathematical properties of the directed graph. She diligently recorded her observations and compiled a vast collection of grid configurations, each with its unique count of strongly connected components. Over time, she noticed a pattern emerging - a sum seemed to be of utmost importance.\n\nTaking her discovery further, Lily defined C(H, W) as the sum of the counts of strongly connected components for all possible grid configurations of H\u00d7W dimensions. This sum, she believed, held the key to unlocking the secrets of connectivity within the graph.\n\nFor weeks on end, day and night, Lily toiled away, lost in her mathematical world, calculating C(3,3), C(3,6), and even the seemingly insurmountable C(10,20). Her dedication paid off when she finally cracked the code and found the remainder of C(10,20) modulo 1000000007.\n\nHowever, a new mathematical challenge loomed before her - one that would require her brilliance like never before. As she stood amidst the enchanted forest, with the ancient chessboard before her, Lily couldn't help but wonder about the magnitude of C(10000,20000). The enormity of the grid overwhelmed her, but she maintained an unwavering determination to solve this mathematical puzzle.\n\nAs the sunset painted the sky with vibrant shades of orange and purple, Lily stared at the mysterious chessboard. The forest grew silent, awaiting her next move. With her heart relentlessly pursuing the answer, she couldn't help but ask herself a crucial question:\n\nWhat is the value of C(10000,20000) modulo 1000000007?\n\nAnd so, with a mixture of anticipation and trepidation, Lily embarked on her greatest mathematical adventure yet - to unravel the secrets of the grid's connectivity and discover the elusive value that lay hidden within C(10000,20000)."}, {"id": 790, "euler_id": 790, "title": "Clock Grid", "problem": "There is a grid of length and width 50515093 points. A clock is placed on each grid point. The clocks are all analogue showing a single hour hand initially pointing at 12.\nA sequence St is created where:\nS0=290797St=St\u221212mod50515093t>0\nThe four numbers Nt=(S4t\u22124,S4t\u22123,S4t\u22122,S4t\u22121) represent a range within the grid, with the first pair of numbers representing the x-bounds and the second pair representing the y-bounds. For example, if Nt=(3,9,47,20), the range would be 3\u2264x\u22649 and 20\u2264y\u226447, and would include 196 clocks.\nFor each t (t>0), the clocks within the range represented by Nt are moved to the next hour 12\u21921\u21922\u2192\u22ef.\nWe define C(t) to be the sum of the hours that the clock hands are pointing to after timestep t.\nYou are given C(0)=30621295449583788, C(1)=30613048345941659, C(10)=21808930308198471 and C(100)=16190667393984172.\nFind C(105).", "solution": "16585056588495119", "difficulty": 45, "story": "Once upon a time in a distant kingdom, there was a young prince named Ethan. Prince Ethan had always enjoyed spending his days exploring the vast gardens surrounding the royal palace. The gardens were unlike any other \u2013 adorned with colorful flowers, majestic trees, and a peculiar grid of clocks.\n\nEvery clock was analogue, with a single hour hand initially pointing at 12. The grid spanned for miles, its length and width stretching across an astonishing 50,515,093 points. No one quite knew how or why the clocks were there, but the enchanting mystery made them all the more fascinating to the curious prince.\n\nOne sunny afternoon, while exploring the gardens, Ethan stumbled upon an old parchment hidden beneath the roots of a ancient oak tree. On it was a mathematical problem that piqued his interest. The problem stated:\n\n\"There is a grid of length and width 50515093 points. A clock is placed on each grid point. The clocks are all analogue, showing a single hour hand initially pointing at 12.\n\nA sequence St is created where: S0=290797 St=St\u221212mod50515093 t>0\n\nThe four numbers Nt=(S4t\u22124,S4t\u22123,S4t\u22122,S4t\u22121) represent a range within the grid, with the first pair of numbers representing the x-bounds and the second pair representing the y-bounds. For example, if Nt=(3,9,47,20), the range would be 3\u2264x\u22649 and 20\u2264y\u226447, and would include 196 clocks.\n\nFor each t (t>0), the clocks within the range represented by Nt are moved to the next hour 12\u21921\u21922\u2192\u22ef.\n\nWe define C(t) to be the sum of the hours that the clock hands are pointing to after timestep t.\n\nYou are given C(0)=30621295449583788, C(1)=30613048345941659, C(10)=21808930308198471, and C(100)=16190667393984172.\n\nFind C(105).\"\n\nPrince Ethan's eyes gleamed with excitement as he realized that this mathematical problem was directly linked to the very clocks that adorned the gardens. It seemed that by solving the problem, he would uncover an even greater secret hidden within the enchanted grid.\n\nAs he delved deeper into the problem, Ethan began to notice patterns emerging from the calculations. The sequence of numbers S0, S1, S2, and so on, held a hidden message just waiting to be deciphered. And the values of C(0), C(1), C(10), and C(100) were clues leading to an extraordinary revelation.\n\nSuddenly, a thought struck Ethan's mind. Could this sequence and the sum, C(t), unlock the hidden treasure of the kingdom? The young prince knew that he had stumbled upon something extraordinary, something that not only held the key to understanding the clocks but potentially to changing the fate of his kingdom.\n\nWith each passing day, Ethan dedicated countless hours to unraveling the secret of the grid and its clocks. His enthusiasm never waned, and his determination grew stronger with each small discovery he made. The clock faces became his compass, guiding him through the intricate labyrinth of the mathematical problem and into a world he never knew existed.\n\nHours turned into days, and days into months, as Prince Ethan immersed himself in the captivating mystery. And yet, despite his tireless efforts, the answer to C(105) eluded him. But he refused to give up. The stakes were higher now, for he had uncovered tales of legends that spoke of the grid's true power, a force that could bring prosperity or ruin to the kingdom.\n\nSo, dear reader, as the prince continues his relentless pursuit of knowledge, I leave you with a question:\n\nCan you solve the enigma of C(105)?"}, {"id": 819, "euler_id": 819, "title": "Iterative Sampling", "problem": "Given an n-tuple of numbers another n-tuple is created where each element of the new n-tuple is chosen randomly from the numbers in the previous n-tuple. For example, given (2,2,3) the probability that 2 occurs in the first position in the next 3-tuple is 2/3. The probability of getting all 2's would be 8/27 while the probability of getting the same 3-tuple (in any order) would be 4/9.\nLet E(n) be the expected number of steps starting with (1,2,\u2026,n) and ending with all numbers being the same.\nYou are given E(3)=27/7 and E(5)=468125/60701\u22487.711982 rounded to 6 digits after the decimal place.\nFind E(103). Give the answer rounded to 6 digits after the decimal place.", "solution": "1995.975556", "difficulty": 45, "story": "Once upon a time in the magical land of Numeria, there lived a skilled mathematician named Professor Fibonacci. He was known throughout the kingdom for his extraordinary skills in solving complex mathematical problems. Professor Fibonacci was loved and respected by all, for he used his knowledge to bring happiness and prosperity to the people.\n\nOne day, a young girl named Lily stumbled upon Professor Fibonacci's humble abode. She was in dire need of his help. Her village was facing a grave problem, and the solution lay within the bounds of mathematics. With hope in her eyes, Lily approached the mathematician and presented him with a mysterious puzzle.\n\n\"Professor Fibonacci,\" Lily began, her voice trembling with urgency. \"My village is plagued by a Curse of Disarray. Every day, the numbers that define our lives become jumbled and chaotic. The village elder told me that you are the only one who can help.\"\n\nIntrigued by the challenge, Professor Fibonacci took a moment to study the puzzle. It was unlike any he had encountered before. The puzzle involved n-tuples and probability, and it required the calculation of an expected number of steps. There was no doubt in his mind that the solution lay in the mathematical problem he was presented with.\n\nAs Professor Fibonacci immersed himself in solving the puzzle, the Curse of Disarray continued to torment and disrupt the lives of the villagers. The crops withered, and communication broke down, leading to chaos and despair. Each passing day brought more urgency to Lily's plea.\n\nWeeks turned into months, and months into years, as Professor Fibonacci dedicated himself to finding the answer. He tirelessly poured over books and scribbled equations on parchment, desperate to discover the key to breaking the curse. The village looked to him as their last hope, but time was running out.\n\nThen, one fateful night, when the full moon graced the dark sky, Professor Fibonacci had a breakthrough. He had finally cracked the puzzle that had plagued him for so long. The solution rested within E(n), the expected number of steps starting with a specific n-tuple and ending with all the numbers being the same.\n\nWith newfound excitement and hope, Professor Fibonacci rushed to gather the townspeople. He stood before them, holding a piece of parchment that bore the solution to their plight.\n\n\"My fellow villagers,\" he proclaimed, his voice resonating with confidence. \"Through the power of mathematics, I have found the key to breaking the Curse of Disarray. But I must warn you, the solution lies within a complex calculation known as E(103).\"\n\nThe villagers stopped in their tracks, their eyes fixated on Professor Fibonacci. The weight of their hopes and dreams hung in the air, mingled with a sense of anticipation and anxiety.\n\n\"Tell us, Professor Fibonacci,\" Lily spoke softly, her voice filled with both fear and hope. \"What is the value of E(103)? Can we finally be free from this curse that has plagued our lives?\"\n\nProfessor Fibonacci smiled gently, his eyes filled with determination. \"That, my dear friends, remains unknown. The value of E(103) is a mystery that needs to be solved. And it is up to us, together, to find the answer.\"\n\nThe villagers stood in silence, pondering the magnitude of the task ahead. They knew that the solution to their problem was within reach, but they also knew it required the combined efforts of all.\n\nAnd so, the people of Numeria embarked on a journey, delving into the depths of mathematics. They studied formulas, computed probabilities, and analyzed patterns, hoping to unlock the secrets hidden within the mathematical problem that had consumed their lives.\n\nThe journey was not easy. The villagers faced countless trials and tribulations, but they persevered. They clung to their unwavering belief that the answer was within their grasp.\n\nNow, dear reader, I leave you with this question: what is the value of E(103)? Can you solve the mathematical problem that tormented the people of Numeria for so long? The power to break the Curse of Disarray lies in your hands."}]