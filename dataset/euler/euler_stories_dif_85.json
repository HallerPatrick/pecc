[{"id": 257, "euler_id": 257, "title": "Angular Bisectors", "problem": "\nGiven is an integer sided triangle ABC with sides a \u2264 b \u2264 c. \n(AB = c, BC = a and AC = b).\nThe angular bisectors of the triangle intersect the sides at points E, F and G (see picture below).\n\n\n\n\nThe segments EF, EG and FG partition the triangle ABC into four smaller triangles: AEG, BFE, CGF and EFG.\nIt can be proven that for each of these four triangles the ratio area(ABC)/area(subtriangle) is rational.\nHowever, there exist triangles for which some or all of these ratios are integral.\n\n\nHow many triangles ABC with perimeter\u2264100,000,000 exist so that the ratio area(ABC)/area(AEG) is integral?\n", "solution": "139012411", "difficulty": 85, "story": "Once upon a time in the enchanted land of Arithmetica, there lived a young mathematician named Luka. Luka was known throughout the kingdom for his problem-solving abilities and his love for numbers. Every day, he would venture into the forest to discover new mathematical puzzles to solve.\n\nOne sunny morning, as Luka strolled through the woods, he stumbled upon a group of fairies gathered around a peculiar object. It was a magnificent triangle, shimmering in gold. The fairies explained to Luka that this triangle possessed special properties, holding within it a mathematical mystery.\n\nIntrigued, Luka examined the triangle and realized it was unlike any he had seen before. It had three sides named A, B, and C, with lengths a, b, and c, respectively. The fairies enlightened him, saying that AB was equal to the length of side c, BC to a, and AC to b.\n\nCurious, Luka asked the fairies what made this triangle so extraordinary.\n\n\"Ah, young mathematician,\" the fairies replied, \"the angular bisectors of this triangle intersect the sides at points E, F, and G.\"\n\nLuka looked at the triangle, visualizing the points E, F, and G. The fairies went on to explain that these points divided the original triangle into four smaller triangles: AEG, BFE, CGF, and EFG.\n\nThe fairies then dropped a fascinating bombshell: \"For each of these four triangles, the ratio between the area of the original triangle ABC and the area of the subtriangle is a rational number.\"\n\nLuka's eyes sparkled with excitement. The fairies continued, \"But here's the real mystery: there exist certain triangles where these ratios are not only rational but also integral!\"\n\nThe revelation intrigued Luka. He realized that this posed a captivating puzzle, one that he couldn't resist solving. Excitedly, he thanked the fairies and headed back to his humble abode.\n\nLuka spent days and nights deep in concentration, working diligently to comprehend the complexity of this mathematical conundrum. He scribbled equations, drew diagrams, and contemplated every possible angle.\n\nEventually, a thought occurred to him: would it be possible to find triangles that met these puzzling conditions, but with a restriction on their perimeters? This question struck Luka like a bolt of lightning, and he vowed to unravel the mystery.\n\nDays turned into weeks, and weeks into months as Luka explored this intricate problem. Perpetually motivated by his love for numbers, he delved deeper into the realm of triangles and ratios, his mind becoming one with the intriguing puzzle.\n\nAs Luka's journey unfolded, he continued to discover new triangles, one after another, that fit the given criteria. He marveled at their beauty, their precise measurements, and their integral ratios. The mathematical landscape before him became a treasure trove of possibilities.\n\nBut just as Luka was on the verge of solving the enigma, he suddenly realized something. What if the enigmatic triangle was hiding in plain sight, waiting to be found within the boundaries of a specific perimeter? This revelation puzzled him further, for he knew that the triangle's sides, a, b, and c, needed to satisfy the condition a \u2264 b \u2264 c.\n\nLuka pondered, \"How many triangles, ABC, with a perimeter less than or equal to 100,000,000, exist where the ratio of the area of the whole triangle to the area of subtriangle AEG is an integral number?\"\n\nHis mind buzzing with excitement and the tantalizing possibility of discovering an answer, Luka donned his thinking cap and continued to explore the countless permutations and combinations within triangles, ratios, and perimeters.\n\nAnd so, dear reader, I beseech you: How many triangles exist that fit this perplexing criterion? Can you find the solution to this mathematical enigma that has captivated the mind of Luka?\n\nAs you ponder this astonishing question, let your imagination soar, and perhaps, in the depths of your mathematical prowess, you will unearth the answer that eluded even the brilliant Luka."}, {"id": 261, "euler_id": 261, "title": "Pivotal Square Sums", "problem": "Let us call a positive integer k a square-pivot, if there is a pair of integers m > 0 and n \u2265 k, such that the sum of the (m+1) consecutive squares up to k equals the sum of the m consecutive squares from (n+1) on:\n\n(k-m)2 + ... + k2 = (n+1)2 + ... + (n+m)2.\nSome small square-pivots are\n4: 32 + 42\n = 52\n21: 202 + 212 = 292\n24: 212 + 222 + 232 + 242 = 252 + 262 + 272\n110: 1082 + 1092 + 1102 = 1332 + 1342Find the sum of all distinct square-pivots \u2264 1010.", "solution": "238890850232021", "difficulty": 85, "story": "Once upon a time in the bustling city of Mathematica, there lived an extraordinary tailor named Alfred. Alfred had an incredible knack for sewing and was famous for creating masterpieces that enchanted everyone who laid eyes on them. His garments were not just ordinary clothes; they were works of art. Each stitch told a story, and each button whispered a secret.\n\nOne day, a mysterious stranger entered Alfred's shop. The stranger wore a tattered cloak, worn-out shoes, and a weary expression. He approached Alfred with a humble request.\n\n\"Good sir, I seek a suit of clothes that will make me stand out from the crowd,\" the stranger said. \"I want to leave an impression wherever I go.\"\n\nThe tailor, intrigued by the man's request, began to measure him, taking note of every detail. As he worked, Alfred found himself lost in thought. He pondered the stranger's unique request and wondered how he could create something truly extraordinary.\n\nAs Alfred carefully crafted the suit, he considered the mathematical problem that had been bothering him for some time. He called it the \"square-pivot dilemma.\" The problem had captured his imagination, and he couldn't help but see the connection between his sewing and the enigmatic enigma.\n\nDays turned into nights as Alfred stitched the fabric together, his mind wandering through the intricate pattern of numbers. The suit began to take shape, and bit by bit, the tailor infused it with his longing for a solution to the mathematical mystery. Unbeknownst to him, the suit became more than just a piece of clothing; it contained the essence of the square-pivot problem.\n\nFinally, the day arrived when the suit was complete, shimmering in a dazzling array of colors like a radiant summer day. Alfred handed it to the stranger, hoping it would meet his expectations.\n\nThe stranger, now transformed by the striking suit, stood before the mirror and marveled at his new appearance. A sense of curiosity gleamed in his eyes as he gazed at himself, unaware of the secret woven into the fabric around him.\n\n\"You have exceeded my wildest expectations, dear tailor,\" the stranger exclaimed, tears of joy streaming down his face. \"But I sense something profound within this suit. There is more to it than meets the eye.\"\n\nAlfred smiled, satisfied that his work had resonated with the stranger so deeply. He stepped closer to the mysterious man, small wrinkles settling on his forehead.\n\n\"In this realm of numbers, I have pondered the square-pivot problem,\" Alfred confessed hesitantly. \"It haunts my thoughts day and night. I wonder, might this suit carry the answer I seek?\"\n\nThe stranger's eyes widened in astonishment, reflecting the flickering embers of curiosity within.\n\n\"The square-pivot problem,\" the stranger whispered, as if recognizing an ancient song. \"I have ventured far, seeking an answer that eludes me. Can it be that the solution lies hidden within this suit?\"\n\nAlfred nodded, hope sparking in his heart as the two of them contemplated the enigmatic equation of the problem's premise. Suddenly, a deep silence fell upon the room, leaving only the sound of distant birds chirping outside.\n\n\"My dear tailor,\" the stranger began, his voice barely above a whisper. \"I beg of you, tell me, is there a sum of all distinct square-pivots below a given number? Can you unravel this riddle that has consumed our thoughts?\"\n\nAs the question hung in the air, Alfred looked deep into the stranger's eyes. He saw a soul seeking answers and a mind hungry for understanding.\n\nThe tailor hesitated for a moment before giving a small, knowing smile. Unaware that the answer to his question lay within the suit he was wearing, the stranger left the shop, unknowingly carrying the weight of an unsolved mathematical mystery on his back.\n\nAnd so, dear reader, the story unfolds, leaving you with one lingering question: Can you solve the mathematical problem that Alfred and the stranger sought to unravel? What is the sum of all distinct square-pivots below 1010?\n\nThe answer awaits you, hidden in the depths of numerical intricacy, waiting to be discovered by an inquisitive mind willing to unravel the enigma."}, {"id": 264, "euler_id": 264, "title": "Triangle Centres", "problem": "Consider all the triangles having:\nAll their vertices on lattice points.\nCircumcentre at the origin O.\nOrthocentre at the point H(5, 0).\nThere are nine such triangles having a perimeter \u2264 50.\nListed and shown in ascending order of their perimeter, they are:\nA(-4, 3), B(5, 0), C(4, -3)\nA(4, 3), B(5, 0), C(-4, -3)\nA(-3, 4), B(5, 0), C(3, -4)\nA(3, 4), B(5, 0), C(-3, -4)\nA(0, 5), B(5, 0), C(0, -5)\nA(1, 8), B(8, -1), C(-4, -7)\nA(8, 1), B(1, -8), C(-4, 7)\nA(2, 9), B(9, -2), C(-6, -7)\nA(9, 2), B(2, -9), C(-6, 7)\n\nThe sum of their perimeters, rounded to four decimal places, is 291.0089.\nFind all such triangles with a perimeter \u2264 105.\nEnter as your answer the sum of their perimeters rounded to four decimal places.", "solution": "2816417.1055", "difficulty": 85, "story": "Once upon a time, in the bustling city of Euclasia, there lived a young girl named Lily. She was a curious and brilliant mathematician who always sought out new puzzles and problems to solve. Despite her tender age, Lily had already made a name for herself in the world of mathematics.\n\nOne day, as Lily was walking through the city's bustling market, she overheard whispers about a mysterious triangle that had captured the attention of mathematicians far and wide. It was said that this triangle possessed unique properties and had an intriguing connection to the world of lattice points.\n\nIntrigued by the rumors, Lily immediately set off to uncover the truth. She delved deep into the realms of mathematical knowledge, researching every detail about lattice points, circumcenters, and orthocenters. Little by little, she unraveled the secrets of this enigmatic triangle.\n\nThrough her research, Lily discovered that this unique triangle had vertices that were located solely on lattice points, with its circumcenter situated at the origin, O, and the orthocenter positioned at the point H(5, 0). She also learned that there were nine such triangles with a perimeter less than or equal to 50.\n\nWith newfound determination, Lily began the arduous task of finding these nine triangles. Armed with her mathematical prowess and a keen eye for patterns, she embarked on a journey through a labyrinth of calculations and computations.\n\nDays turned into nights, and nights turned into weeks, as Lily tirelessly worked to solve the puzzle laid before her. And finally, after numerous sleepless nights and countless scribbles on her notebook, Lily unveiled the nine triangles:\n\nTriangle 1: A(-4, 3), B(5, 0), C(4, -3)\nTriangle 2: A(4, 3), B(5, 0), C(-4, -3)\nTriangle 3: A(-3, 4), B(5, 0), C(3, -4)\n\nAnd so on, Lily listed and showed all nine triangles, each represented by a unique arrangement of lattice points. As she marveled at her achievement, she couldn't help but wonder about the significance of these triangles and their connection to the beguiling world of mathematics.\n\nSuddenly, a profound question formed in Lily's mind - a question that would guide her towards a new quest. If there were nine such triangles with a perimeter less than or equal to 50, then how many triangles would exist with a perimeter less than or equal to 105?\n\nThe answer to this question lay hidden within the folds of numbers and geometry. Lily knew that this was not just a matter of curiosity anymore but a mathematical endeavor that would test her limits and push her further.\n\nCan you help Lily solve this intriguing problem? How many triangles with a perimeter less than or equal to 105 exist, and what would be their sum of perimeters when rounded to four decimal places?\n\nAs you venture through your own journey of numbers and patterns, remember that the beauty of mathematics lies not only in its solutions but in the never-ending quest for knowledge and understanding."}, {"id": 275, "euler_id": 275, "title": "Balanced Sculptures", "problem": "Let us define a balanced sculpture of order n as follows:\nA polyomino made up of n+1 tiles known as the blocks (n tiles) and the plinth (remaining tile);\nthe plinth has its centre at position (x\u2009=\u20090, y\u2009=\u20090);\nthe blocks have y-coordinates greater than zero (so the plinth is the unique lowest tile);\nthe centre of mass of all the blocks, combined, has x-coordinate equal to zero.\nWhen counting the sculptures, any arrangements which are simply reflections about the y-axis, are not counted as distinct. For example, the 18 balanced sculptures of order 6 are shown below; note that each pair of mirror images (about the y-axis) is counted as one sculpture:\n\nThere are 964 balanced sculptures of order 10 and 360505 of order 15.How many balanced sculptures are there of order 18?", "solution": "15030564", "difficulty": 85, "story": "Once upon a time, in the enchanted land of Numeria, there lived a young mathematician named Lila. Lila had a special gift for solving complex mathematical problems, and she was always on the lookout for a new challenge.\n\nIt was a bright and sunny morning when Lila received an invitation to the annual Mathematical Symposium held at the Grand Academy of Numeria. Excited to showcase her skills, she immediately set off on her journey.\n\nAs Lila arrived at the Grand Academy, she was welcomed by a bustling crowd of scholars, all eager to exchange ideas and explore the mysteries of mathematics. The symposium was a grand affair, filled with dazzling exhibits and intriguing puzzles.\n\nLila's attention was soon drawn to a particularly captivating display, featuring a beautiful sculpture made up of tiles. The sculpture was meticulously crafted, with blocks of various shapes and sizes carefully arranged on a plinth. It had an air of elegance and symmetry that caught Lila's eye.\n\nCuriosity piqued, Lila began to investigate the sculpture. She noticed engraved words on a nearby plaque that explained its unique nature. It was called a \"balanced sculpture\" and had an order of n, denoting the number of tiles used.\n\n\"Intriguing,\" Lila murmured, her mind already whirling with possibilities. She read further, discovering the key characteristics of a balanced sculpture. The plinth held the lowest position, with its center at (x = 0, y = 0). The blocks, on the other hand, had y-coordinates greater than zero, ensuring the plinth's supremacy. And most importantly, the center of mass of all the blocks combined had an x-coordinate equal to zero.\n\nLila found herself captivated by the challenge presented in front of her. The mathematical problem of counting the number of balanced sculptures was like a riddle waiting to be solved.\n\nAs she delved deeper into her research, Lila discovered that finding the number of balanced sculptures of order n was no easy feat. For every order, there were numerous possibilities, but only a select few that met all the criteria.\n\nIn her pursuit of knowledge, Lila stumbled upon an astonishing fact. She learned that there were 964 balanced sculptures of order 10. The sheer magnitude of this number struck her with awe. The symposium buzzed with excitement, as scholars shared their own discoveries and celebrated the elegance of mathematics.\n\nBut Lila's thirst for knowledge was insatiable. She yearned to unravel the secrets of higher orders and their corresponding balanced sculptures. It was then she stumbled upon another remarkable revelation - there were a staggering 360,505 balanced sculptures of order 15.\n\n\"Imagine the beauty and complexity of those sculptures,\" Lila whispered, her eyes shining with wonder. \"What remarkable patterns and symmetries lie hidden within them?\"\n\nWith each new piece of information, Lila's fascination grew. She had only touched the surface of this mysterious realm, and she yearned to explore it further. Her mind became consumed by a single question: How many balanced sculptures existed of an order of 18?\n\nAs the symposium drew to a close, Lila gazed at the breathtaking sculptures surrounding her. The intricacies and elegance of their designs left her speechless. And yet, amidst the grandeur, she couldn't help but ponder her unanswered question.\n\nWalking away from the symposium, Lila couldn't shake off the burning curiosity that filled her mind. She knew that the answer to her question lay hidden within the depths of mathematics, waiting to be unraveled. And so, she turned to you, dear reader, with a glimmer of excitement in her eyes.\n\nHow many balanced sculptures are there of order 18?"}, {"id": 416, "euler_id": 416, "title": "A frog's trip", "problem": "A row of n squares contains a frog in the leftmost square. By successive jumps the frog goes to the rightmost square and then back to the leftmost square. On the outward trip he jumps one, two or three squares to the right, and on the homeward trip he jumps to the left in a similar manner. He cannot jump outside the squares. He repeats the round-trip travel m times.\nLet F(m, n) be the number of the ways the frog can travel so that at most one square remains unvisited.\nFor example, F(1, 3) = 4, F(1, 4) = 15, F(1, 5) = 46, F(2, 3) = 16 and F(2, 100) mod 109 = 429619151.\nFind the last 9 digits of F(10, 1012).", "solution": "898082747", "difficulty": 85, "story": "Once upon a time, in a lush and vibrant forest, there lived a curious little frog named Finn. Finn was known throughout the forest for his seemingly magical abilities. He could leap higher and farther than any other creature, and his jumps were always flawless and precise.\n\nOne sunny morning, as Finn was hopping happily along the forest floor, he noticed a row of colorful squares. With his insatiable curiosity, he couldn't resist investigating. As he approached the row of squares, he saw a small sign that read:\n\n\"Challenge: Froggy's Journey\"\n\nIntrigued, Finn read further, \"A row of n squares contains a frog in the leftmost square. By successive jumps, the frog goes to the rightmost square and then back to the leftmost square. On the outward trip, he jumps one, two, or three squares to the right, and on the homeward trip, he jumps to the left in a similar manner. However, he cannot jump outside the squares. He repeats the round-trip travel m times. Find the number of ways the frog can travel so that at most one square remains unvisited.\"\n\nFinn's eyes widened with excitement. He saw this as a challenge designed precisely for him. His keen mind quickly analyzed the problem, crunching the numbers and calculating the possibilities.\n\nDays turned into nights, and nights turned into days as Finn tirelessly pondered the problem. He hopped back and forth along the row of squares, exploring different paths and combinations. He took note of his jumps on a delicate leaf scroll, marking every possibility.\n\nDuring his journey, Finn's fellow forest creatures grew curious about his purposeful hops. They watched in awe as he effortlessly flew through the air, defying gravity with each leap. The squirrels, rabbits, and birds would gather around Finn, cheering him on, fascinated by his determination.\n\nAs time went on, the number of paths Finn discovered began to grow exponentially. The mathematical problem became a central part of his life, his thoughts consumed by the patterns and strategies. He felt as though he was on the cusp of solving the mystery, finding the elusive answer to the question posed by the forest challenge.\n\nBut, as Finn delved deeper into the problem, he grew perplexed. Despite his relentless efforts, he couldn't quite crack the code. There was something missing, something he couldn't quite grasp. He realized he needed a fresh perspective, someone to lend him a hand.\n\nWith newfound determination, Finn decided to embark on a journey to seek the wisdom of the wise Ms. Owl, who was known for her vast knowledge of mathematics. He ventured deep into the heart of the forest, guided by the moonlight and the symphony of night creatures.\n\nUpon reaching Ms. Owl's hollow, perched high in a towering oak tree, Finn shared his struggles and the mathematical problem that had consumed him. Ms. Owl listened intently, her wise eyes glowing with understanding.\n\n\"Finn,\" she said, her voice a gentle and soothing melody, \"The answers we seek often come from unexpected places. Sometimes, asking for help is the key to unlocking the mysteries we encounter.\"\n\nAs her words washed over him, Finn's spirit lifted. Suddenly, the fog around the mathematical problem seemed to dissipate, and a glimmer of new understanding emerged.\n\nLeaving Ms. Owl's hollow with renewed vigor, Finn returned to the row of squares, armed with a fresh perspective. The forest creatures gathered around him, eager to witness his next leap. As Finn prepared for his jump, a sense of anticipation hung in the air.\n\nAnd now, dear reader, the challenge is yours. Can you solve the mathematical problem that has captivated our intrepid frog Finn? What are the last 9 digits of F(10, 1012)? The forest creatures eagerly await your answer, their hopes resting on your ability to unravel the mysteries hidden within the jumps of our whimsical frog companion."}, {"id": 465, "euler_id": 465, "title": "Polar polygons", "problem": "The kernel of a polygon is defined by the set of points from which the entire polygon's boundary is visible. We define a polar polygon as a polygon for which the origin is strictly contained inside its kernel.\nFor this problem, a polygon can have collinear consecutive vertices. However, a polygon still cannot have self-intersection and cannot have zero area.\nFor example, only the first of the following is a polar polygon (the kernels of the second, third, and fourth do not strictly contain the origin, and the fifth does not have a kernel at all):\n\nNotice that the first polygon has three consecutive collinear vertices.\nLet P(n) be the number of polar polygons such that the vertices (x, y) have integer coordinates whose absolute values are not greater than n.\nNote that polygons should be counted as different if they have different set of edges, even if they enclose the same area. For example, the polygon with vertices [(0,0),(0,3),(1,1),(3,0)] is distinct from the polygon with vertices [(0,0),(0,3),(1,1),(3,0),(1,0)].\nFor example, P(1) = 131, P(2) = 1648531, P(3) = 1099461296175 and P(343) mod 1\u00a0000\u00a0000\u00a0007 = 937293740.\nFind P(713) mod 1\u00a0000\u00a0000\u00a0007.", "solution": "585965659", "difficulty": 85, "story": "Once upon a time, in a kingdom called Polyland, there lived a young and curious princess named Cassandra. Princess Cassandra had always been fascinated by the world of mathematics, and she spent her days exploring the castle library in search of intriguing problems to solve.\n\nOne sunny afternoon, as Cassandra skimmed through books on geometry, she stumbled upon an ancient parchment. The parchment contained a peculiar problem, one that piqued her interest immediately. It spoke of polar polygons, a concept she had never encountered before.\n\nThe problem stated that the kernel of a polygon is defined by the set of points from which the entire polygon's boundary is visible. Cassandra found this definition rather fascinating; she imagined standing at these kernel points and seeing the entire polygon stretch out before her, a hidden world revealed through the eyes of mathematics.\n\nEager to unravel the mysteries of polar polygons, Princess Cassandra dove deeper into the problem. She discovered that a polar polygon was defined as a polygon in which the origin, or (0,0) point, was strictly contained within its kernel. This meant that if she were to stand at the origin, she would be surrounded by the polygon's vertices, unable to see anything beyond its boundaries.\n\nThe mathematical problem presented a challenge - finding the number of polar polygons with vertices (x, y) that had integer coordinates whose absolute values were not greater than a given number, denoted as n. The problem emphasized that the polygons could have collinear consecutive vertices but could not have self-intersection or zero area.\n\nPrincess Cassandra's mind whirled as she pondered this intriguing problem. She decided to explore the world around her to gain inspiration and insights. She traveled to the nearby village, seeking the knowledge and wisdom of the villagers who were known for their deep understanding of geometry.\n\nIn the village, Princess Cassandra met an old mathematician named Professor Archimedes. His eyes sparkled with excitement upon hearing of her newfound interest in polar polygons. The professor explained that the study of polar polygons extended far beyond the boundaries of Polyland; it was a subject that bewildered mathematicians worldwide.\n\nProfessor Archimedes shared tales of famous mathematicians who had dedicated their lives to unraveling the mysteries of polar polygons. He explained that the process of counting these polygons was intricate, requiring immense mental calculations and clever geometric reasoning.\n\nAs Princess Cassandra listened to the professor's stories, her fascination grew exponentially. She was captivated by the complexity of the problem and its potential implications. The thought of discovering the number of polar polygons with vertices meeting specific conditions filled her with excitement.\n\nThe princess felt a newfound sense of purpose. Determined to uncover the solution to this perplexing question, Cassandra returned to the castle library, surrounded by piles of books and parchment. She spent days, weeks, and months engrossed in her studies, tirelessly searching for patterns, making calculations, and exploring the depths of mathematical possibilities.\n\nAs she delved into the problem, Princess Cassandra's understanding of geometry deepened. She realized that each polygon was unique, even if it enclosed the same area as another. The arrangement of the vertices created distinct polygons, each with its own set of edges and characteristics.\n\nFinally, after months of research, Princess Cassandra stood at the edge of a breakthrough. Her mind was filled with astonishing revelations and newfound knowledge of polar polygons. She had made significant strides in understanding how to count and classify these unique shapes, but despite all her efforts, the solution eluded her.\n\nWith each passing day, her frustration grew. The princess yearned for the magical moment of understanding the secret behind polar polygons. Yet, the answer remained just out of her reach, like a distant star in the night sky.\n\nOne evening, as Princess Cassandra sat by her window, gazing at the mesmerizing patterns of the stars, a thought struck her. What if she were to seek the guidance of other mathematicians from all corners of the world? Perhaps, together, they could unlock the secrets of polar polygons and solve this mathematical enigma.\n\nAnd so, dear reader, as the story reaches this turning point, I pose a question to you: Can you solve the mathematical problem that has captivated Princess Cassandra? Can you find P(713) mod 1 000 000 007, the number of polar polygons with vertices whose absolute coordinates are not greater than 713? The answer may lie within the depths of mathematics, waiting to be discovered by an astute mind."}, {"id": 482, "euler_id": 482, "title": "The incenter of a triangle", "problem": "\nABC is an integer sided triangle with incenter I and perimeter p.\nThe segments IA, IB and IC have integral length as well. \n\n\nLet L = p + |IA| + |IB| + |IC|. \n\n\nLet S(P) = \u2211\u2009L for all such triangles where p \u2264 P. For example, S(103) = 3619.\n\n\nFind S(107).\n", "solution": "1400824879147", "difficulty": 85, "story": "Once upon a time in the vibrant city of Mathlandia, there lived a young mathematician named Alice. Alice was known for her remarkable ability to solve even the most challenging mathematical problems, and her passion for numbers was second to none. She would spend countless hours immersed in equations and theorems, finding beauty and joy in the world of mathematics.\n\nOne sunny morning, as Alice sat in her favorite coffee shop, engrossed in her calculations, she noticed a peculiar advertisement on a nearby bulletin board. It caught her eye with its promise of an intriguing mathematical mystery.\n\n\"Can you solve the enigma of the integer-sided triangles?\" read the advertisement. It explained that an integer-sided triangle, ABC, was said to have an incenter, I, and the lengths of the segments IA, IB, and IC were all integers too. However, what fascinated Alice the most was the equation put forth by the advertisement.\n\n\"L = p + |IA| + |IB| + |IC|,\" she mused, repeating the equation to herself.\n\nThe notion of finding all such triangles piqued Alice's curiosity, and her mind instantly began to swirl with possibilities and potential solutions. And just like that, the mathematical problem presented itself as the cornerstone of her imagination.\n\nDetermined to solve this conundrum, Alice spent days and nights poring over notes, scribbling equations, and drawing endless diagrams. She discovered various theorems, formulas, and geometric properties that held the secret to unlocking the hidden treasures of these special triangles.\n\nBut Alice's work didn't stop at simply solving the problem. She felt a deep connection to the triangles, as if they were whispering stories only she could hear. What if these triangles held secrets beyond the realm of mathematics? What if they hid clues to a greater mystery waiting to be unraveled?\n\nAlice's passion turned into an obsession. She ventured into the city's libraries, archives, and even ancient mathematical texts to gather knowledge about the history of these special triangles. She discovered tales of lost civilizations, cryptic symbols, and legendary mathematicians who were guided by these triangles to uncover universal truths.\n\nHer exploration led her to ancient scrolls, where she stumbled upon a riddle. \"To find the ultimate answer, add the sum of L for all triangles with a perimeter less than or equal to P,\" the cryptic text read. \"But what is S(P), the sum you seek?\"\n\nAlice's heart quickened as she realized that the riddle echoed the very question she had been seeking to answer. It was a revelation that thrilled her, and she dedicated herself to unravelling the secrets locked within the mystical value of S(P).\n\nDays turned into weeks, and weeks turned into months. Alice dove even deeper into her quest, fueled by her insatiable desire to find the hidden treasures buried within the fabric of mathematical mysteries. But as time went on, she increasingly wondered if she would ever discover the true nature of S(P).\n\nAnd now, dear reader, it is your turn to explore this enchanting realm of mathematics. Can you find S(107), the sum that Alice sought after with unwavering enthusiasm? Will you be the one to crack the code and uncover the answer to this age-old riddle?\n\nRemember, just like Alice, you hold the power to unravel the mysteries of numbers and unleash the brilliance within. So, venture forth into the realm of integers, triangles, and enigmas. Embrace the magic embedded in mathematics, and dare to find the answer to S(107).\n\nAnd now, dear reader, the question remains: Can you solve the mysterious riddle of S(107)?"}, {"id": 508, "euler_id": 508, "title": "Integers in base i-1", "problem": "Consider the Gaussian integer i-1. A base i-1 representation of a Gaussian integer a+bi is a finite sequence of digits dn-1dn-2...d1d0 such that:\na+bi = dn-1(i-1)n-1 + dn-2(i-1)n-2 + ... + d1(i-1) + d0\nEach dk is in {0,1}\nThere are no leading zeroes, i.e. dn-1 \u2260 0, unless a+bi is itself 0\nHere are base i-1 representations of a few Gaussian integers:\n11+24i \u2192 111010110001101\n24-11i \u2192 110010110011\n8+0i \u2192 111000000\n-5+0i \u2192 11001101\n0+0i \u2192 0\n\nRemarkably, every Gaussian integer has a unique base i-1 representation!\n\nDefine f(a+bi) as the number of 1s in the unique base i-1 representation of a+bi. For example, f(11+24i) = 9 and f(24-11i) = 7.\n\nDefine B(L) as the sum of f(a+bi) for all integers a, b such that |a| \u2264 L and |b| \u2264 L. For example, B(500) = 10795060.\n\nFind B(1015) mod 1 000 000 007.", "solution": "891874596", "difficulty": 85, "story": "Once upon a time, in the mystical land of Pythagoria, there lived a young wizard named Leopold. Leopold was not like other wizards who focused solely on casting spells and brewing potions. He had a great passion for mathematics, especially when it seemed to intertwine with the magic of the world.\n\nOne sunny morning, as Leopold was strolling through the enchanted forest near his cottage, he stumbled upon an ancient book hidden beneath a moss-covered stone. Intrigued, he picked it up and blew off the dust, revealing the title \"The Secret Language of Numbers.\"\n\nLeopold's eyes widened with excitement as he opened the book. Within its pages, he discovered a mathematical problem he had never encountered before: the base i-1 representation of Gaussian integers. As he dug deeper into the problem, Leopold's fascination grew.\n\nIntrigued by the peculiar base i-1 representation, he decided to experiment with it. He converted various Gaussian integers into their unique base i-1 representations, marveling at the patterns that emerged. Every number had its own distinct sequence of 1s and 0s, telling a story only decipherable by those versed in the secret language of numbers.\n\nDays turned into weeks as Leopold lost himself in his studies. But as he ventured further into the realm of base i-1 representation, he discovered something extraordinary. Each number's representation had a corresponding value, denoted by f(a+bi), which measured the number of 1s present.\n\nLeopold couldn't help but imagine the possibilities of this newfound understanding. Perhaps he could use the values of f(a+bi) to unlock the hidden mysteries of Pythagoria, to manipulate the magical energies to his advantage. With this thought in mind, he made it his mission to decipher the true significance of f(a+bi).\n\nAs he delved deeper, Leopold stumbled upon a formula that fascinated him immensely. B(L), a function that calculated the sum of f(a+bi) for all integers a and b whose magnitudes were less than or equal to L. It was as if this function held the very essence of the enchantments that surrounded them.\n\nLeopold's heart raced with excitement as he realized the potential implications of B(L). If he could determine its value, he might be able to wield unimaginable power. His thoughts consumed him, and he yearned to uncover the hidden secrets concealed within B(L).\n\nQuickly realizing that L was a measure of the magnitude of the Gaussian integers involved, Leopold started to ponder its significance in the grand scheme of things. He wondered how this value could impact his life as a wizard and guide him in his magical endeavors.\n\nAs the days turned into nights, and the nights into weeks, Leopold obsessed over the problem. His mind raced with possibilities, unable to focus on anything else. The ancient book became his constant companion, always by his side, as he sought the answer to B(1015) mod 1 000 000 007.\n\nWith each passing moment, Leopold's eagerness grew. He yearned to solve the problem, to uncover the magic buried within. The mystical energies of Pythagoria seemed to whisper the answer, promising an ever-lasting treasure trove of power and understanding. But before he could claim this knowledge, he needed to solve the riddle that had captured his imagination.\n\nAnd so, dear reader, with the secret of B(1015) mod 1 000 000 007 still elusive, I leave you with the same question that plagues Leopold's mind. Can you solve the mathematical problem that has the power to unlock the secret language of numbers and the magic they hold within?"}, {"id": 522, "euler_id": 522, "title": "Hilbert's Blackout", "problem": "Despite the popularity of Hilbert's infinite hotel, Hilbert decided to try managing extremely large finite hotels, instead.\nTo cut costs, Hilbert wished to power the new hotel with his own special generator. Each floor would send power to the floor above it, with the top floor sending power back down to the bottom floor. That way, Hilbert could have the generator placed on any given floor (as he likes having the option) and have electricity flow freely throughout the entire hotel.\nUnfortunately, the contractors misinterpreted the schematics when they built the hotel. They informed Hilbert that each floor sends power to another floor at random, instead. This may compromise Hilbert's freedom to have the generator placed anywhere, since blackouts could occur on certain floors.\nFor example, consider a sample flow diagram for a three-story hotel:\n\nIf the generator were placed on the first floor, then every floor would receive power. But if it were placed on the second or third floors instead, then there would be a blackout on the first floor. Note that while a given floor can receive power from many other floors at once, it can only send power to one other floor.\nTo resolve the blackout concerns, Hilbert decided to have a minimal number of floors rewired. To rewire a floor is to change the floor it sends power to. In the sample diagram above, all possible blackouts can be avoided by rewiring the second floor to send power to the first floor instead of the third floor.\nLet F(n) be the sum of the minimum number of floor rewirings needed over all possible power-flow arrangements in a hotel of n floors. For example, F(3) = 6, F(8) = 16276736, and F(100) mod 135707531 = 84326147.\nFind F(12344321) mod 135707531.", "solution": "96772715", "difficulty": 85, "story": "Once upon a time, in a bustling city at the edge of a vast kingdom, there stood a grand hotel, known far and wide for its opulence and grandeur. It was called the Royal Palace Hotel, and it was a place where dreams were made and memories created. The hotel had been built many years ago, its architecture awe-inspiring and its interior a showcase of elegance.\n\nThe owner of the hotel, a distinguished mathematician by the name of Hilbert, was a man known for his love of numbers and his passion for puzzles. He had spent his life connecting dots, finding patterns in chaos, and delighting in the beauty of mathematics.\n\nOne day, Hilbert found himself intrigued by a mathematical problem that had been perplexing him for quite some time. Despite the overwhelming popularity of Hilbert's infinite hotel, he had a new idea in mind. He wished to manage an extremely large but finite hotel instead, with a unique twist.\n\nTo cut costs and ensure the efficient distribution of power, Hilbert designed a special generator that would be placed on one of the hotel's floors. Each floor would then send power to the floor above it, circulating it throughout the entire hotel. It was an ingenious plan, for Hilbert liked having the option to place the generator wherever he pleased. Perhaps it would be on the grandest floor that housed the penthouse suites, or maybe he'd opt for the basement, where the kitchens hummed with activity.\n\nHowever, fate had a different plan in store for Hilbert. The contractors who were responsible for bringing his vision to life misinterpreted the schematics and made a crucial mistake. Instead of each floor sending power to the floor above it, they informed Hilbert that the power flow would be random. Panic set in as Hilbert realized the implications of their blunder - blackouts could occur on certain floors.\n\nThe mathematician mulled over this problem day and night, determined to find a solution. He understood that to resolve the blackout concerns, a minimal number of floors would need to be rewired. By rewiring a floor, he could change the floor it sent power to, thus ensuring that no floor would suffer a blackout.\n\nHis mind abuzz with numbers and possibilities, Hilbert studied the flow diagrams of the hotel's design. He observed how power could travel between floors, sometimes reaching multiple levels simultaneously, and yet only being able to send power to a single floor. It was a complex puzzle, but one that ignited the mathematician's spirit.\n\nDays turned into weeks, and weeks into months, as Hilbert delved deeper into the mathematical problem that had consumed him. He scribbled equations, made countless calculations, and even enlisted the help of fellow mathematicians to decipher the intricate web of power flow. The Royal Palace Hotel became a haven of mathematical exploration, with Hilbert at the heart of it all.\n\nAs he neared the solution, Hilbert's excitement grew. Each night, as he retired to his suite at the topmost floor of the hotel, he could feel the answer inching closer. The Royal Palace Hotel echoed with anticipation, as if even its ornate walls were aware of the grand discovery at hand.\n\nAnd so, we find ourselves faced with the question that now rests in your hands. As Hilbert stands at the threshold of solving this mathematical puzzle, the fate of the Royal Palace Hotel lies in your ability to find the answer.\n\nDear reader, can you determine the value of F(12344321) mod 135707531? Can you fathom the minimum number of floor rewirings needed to avert all possible blackouts in this grand hotel?\n\nThe answer, hidden within the realm of numbers, awaits your discerning mind. Embark on this mathematical journey, unravel the secrets of power flow, and let the beauty of numbers guide your way."}, {"id": 529, "euler_id": 529, "title": "10-substrings", "problem": "A 10-substring of a number is a substring of its digits that sum to 10. For example, the 10-substrings of the number 3523014 are:\n3523014\n3523014\n3523014\n3523014A number is called 10-substring-friendly if every one of its digits belongs to a 10-substring. For example, 3523014 is 10-substring-friendly, but 28546 is not.\nLet T(n) be the number of 10-substring-friendly numbers from 1 to 10n (inclusive).\nFor example T(2) = 9 and T(5) = 3492.\nFind T(1018) mod 1 000 000 007.", "solution": "23624465", "difficulty": 85, "story": "Once upon a time in a small village nestled at the foot of a majestic mountain, there lived a young girl named Lily. Lily possessed a brilliant mind and a curiosity that surpassed her age. While the other children played simple games, Lily would often be found lost in a world of numbers and patterns, her mind constantly eager to solve the mysteries of mathematics.\n\nOne bright summer morning, as the sun's golden rays illuminated the village, a traveler arrived carrying a perplexing riddle. The riddle spoke of a numerical enigma known as the \"10-substring\" problem. The traveler explained that a 10-substring of a number was a substring of its digits that, when added together, equaled 10. He further clarified that a number was deemed \"10-substring-friendly\" if every single digit within that number belonged to a 10-substring.\n\nIntrigued by the traveler's riddle, Lily immersed herself in the world of 10-substrings. In her tiny bedroom, adorned with old mathematical textbooks and notebooks filled with scribbles, she began to explore the patterns and possibilities presented by this puzzle. Hours turned into days as Lily tirelessly calculated, her mind racing with new ideas and solutions.\n\nAs the village's annual Harvest Festival drew closer, Lily felt determined to unravel the secrets of the 10-substring problem. She believed that the answer to the riddle lay within the vast possibilities encapsulated by this conundrum.\n\nOne evening, while gazing at the stars and drawing inspiration from their celestial dance, an idea struck Lily like a bolt of lightning. She hurriedly scribbled a series of calculations on a crumpled piece of paper, her excitement palpable.\n\nThe following morning, Lily rushed through the village, her young legs carrying her with unparalleled determination. She sought out the traveler, eager to share her discoveries and seek guidance. As the villagers gathered around to observe, she recounted how she had calculated T(2) and T(5), the number of 10-substring-friendly numbers within certain ranges.\n\nThe traveler listened intently, impressed by Lily's intellect and drive. He acknowledged her efforts and confirmed that the answers she had derived were indeed correct. But then came the ultimate challenge \u2013 to find T(1018) mod 1,000,000,007. A daunting task, for it would require traversing a mind-bogglingly large number of possibilities.\n\nLily's eyes sparkled with a mix of determination and curiosity. The traveler's question had been woven into the fabric of her mind, becoming an integral part of her journey. But how could she possibly solve this monumental puzzle? Would her knowledge of 10-substrings be enough to unravel the secrets of such vast numbers?\n\nAs Lily stood among the villagers, their eyes filled with admiration and anticipation, she posed a question that echoed through the village square. \"Who among us can decipher the enigma of T(1018)? Can you unlock the intricacies of this mathematical labyrinth? The riddle of 10-substrings awaits your genius.\"\n\nAnd so, dear reader, the challenge is now passed on to you. Can you solve the mathematical problem that entranced young Lily and engaged the entire village? Can you find T(1018) mod 1,000,000,007? The answer lies within the realm of possibilities, just waiting to be discovered."}, {"id": 546, "euler_id": 546, "title": "The Floor's Revenge", "problem": "Define fk(n) = \u2211i=0n fk(\u230aik\u230b) where fk(0) = 1 and \u230ax\u230b denotes the floor function.\nFor example, f5(10) = 18, f7(100) = 1003, and f2(103) = 264830889564.\nFind (\u2211k=210 fk(1014)) mod (109+7).", "solution": "215656873", "difficulty": 85, "story": "Once upon a time, in the kingdom of Mathemavia, there lived a young and curious princess named Elena. Princess Elena had always been fascinated by numbers and equations, spending hours on end with her tutors, deciphering the secrets of the mathematical world. Little did she know that her passion for numbers would soon lead her on a thrilling adventure.\n\nOne sunny afternoon, while poring over ancient scrolls in the castle library, Princess Elena stumbled upon a peculiar mathematical problem inscribed on a worn-out parchment. As she began to parse its symbols and understand its complexity, she felt a sudden rush of curiosity. Determined to unravel its secrets, she embarked on a journey throughout the kingdom, seeking the wise scholars who possessed the knowledge to guide her.\n\nHer journey took her through rolling meadows and dense forests, until she arrived at King Mathias's majestic palace. King Mathias was known for his unparalleled wisdom and was considered the greatest mathematician in all the land. Summoning all her courage, Princess Elena presented the problem to the esteemed king, eager to hear his insights.\n\nKing Mathias gave a knowing smile and beckoned Princess Elena to sit beside him. He then began to explain the problem to her in great detail. \"Young Elena,\" he said, \"this mathematical problem challenges us to define a recursive function, fk(n), which involves summing certain terms determined by the floor function, \u230ax\u230b. The function requires us to substitute ik for each term and continue the process until reaching the base case.\"\n\nAs King Mathias continued, Princess Elena's eyes sparkled with excitement and understanding. She realized that the problem posed not only a mathematical puzzle but also held a deeper significance within the kingdom. However, King Mathias stopped himself, revealing that he had yet to find a solution to this intricate problem.\n\nConfounded yet undeterred, Princess Elena thanked the king for his guidance and left the palace, a newfound determination propelling her onwards. She ventured throughout Mathemavia, consulting renowned mathematicians, philosophers, and scholars in her quest to solve the enigma. Each interaction furnished her with pieces of the puzzle, bringing her closer to unlocking the secret hidden within the problem's numerical realm.\n\nMonths turned into years as Princess Elena tirelessly pursued an answer. She soaked up every piece of knowledge she encountered, delving deeper and deeper into the realm of numbers. The adventure consumed her, fueled by a determination that seemed boundless.\n\nAt long last, Princess Elena returned to the castle where she had first discovered the problem. Her mind brimmed with an abundance of mathematical wisdom, a treasure trove she was eager to share with the world. She gathered her fellow mathematicians and gifted scholars and presented her findings\u2014an intricate web of formulas and explanations that marveled even the most discerning minds.\n\nAs the room reverberated with applause, Princess Elena realized that she had uncovered something truly remarkable. Not only had she solved the problem at hand, but she had also unlocked a new realm of mathematical inquiry. The problem, it seemed, held answers far beyond what anyone could have imagined\u2014a doorway into a world where numbers reign supreme.\n\nWith her task complete, Princess Elena turned to the crowd of eager faces, her voice filled with wonderment. \"My dear friends,\" she asked, her eyes shining with passion, \"can you unravel this mathematical problem? Can you discover the hidden patterns and unveil the secrets that lie within? What is the value of (\u2211k=210 fk(1014)) mod (109+7)?\"\n\nAnd so, the question echoed through the halls, spanning through the ages, a challenge that would transcend time itself. The story of Princess Elena's quest had only just begun, inviting all who dared to venture deeper into the boundless world of mathematics.\n\nCan you solve this mathematical enigma and uncover the kingdom's secrets?"}, {"id": 553, "euler_id": 553, "title": "Power sets of power sets", "problem": "Let P(n) be the set of the first n positive integers {1, 2, ..., n}.\nLet Q(n) be the set of all the non-empty subsets of P(n).\nLet R(n) be the set of all the non-empty subsets of Q(n).\nAn element X\u00a0\u2208\u00a0R(n) is a non-empty subset of Q(n), so it is itself a set.\nFrom X we can construct a graph as follows:\nEach element Y\u00a0\u2208\u00a0X corresponds to a vertex and labeled with Y;\nTwo vertices Y1 and Y2 are connected if Y1\u00a0\u2229\u00a0Y2\u00a0\u2260\u00a0\u2205.\nFor example, X\u00a0=\u00a0{{1},\u00a0{1,2,3},\u00a0{3},\u00a0{5,6},\u00a0{6,7}} results in the following graph:\n\nThis graph has two connected components.\nLet C(n,k) be the number of elements of R(n) that have exactly k connected components in their graph.\nYou are given C(2,1)\u00a0=\u00a06, C(3,1)\u00a0=\u00a0111, C(4,2)\u00a0=\u00a0486, C(100,10)\u00a0mod\u00a01\u00a0000\u00a0000\u00a0007\u00a0=\u00a0728209718.\nFind C(104,10)\u00a0mod\u00a01\u00a0000\u00a0000\u00a0007.", "solution": "57717170", "difficulty": 85, "story": "Once upon a time in a small village nestled in the rolling hills, there lived a young girl named Lily. She was known for her keen intelligence and her insatiable thirst for knowledge. Every day, she would spend hours in her modest little cottage, pouring over books and engaging in deep contemplation.\n\nOne day, as Lily was reading a particularly intriguing book about mathematics, a unique problem caught her attention. The problem stated:\n\n\"Let P(n) be the set of the first n positive integers {1, 2, ..., n}.\nLet Q(n) be the set of all the non-empty subsets of P(n).\nLet R(n) be the set of all the non-empty subsets of Q(n).\nAn element X \u2208 R(n) is a non-empty subset of Q(n), so it is itself a set.\nFrom X, we can construct a graph as follows:\nEach element Y \u2208 X corresponds to a vertex and labeled with Y;\nTwo vertices Y1 and Y2 are connected if Y1 \u2229 Y2 \u2260 \u2205.\"\n\nIntrigued by this problem, Lily decided to delve deeper into its intricacies. She spent days and nights analyzing the patterns, connecting the dots between different subsets, and constructing the intricate graphs in her mind.\n\nLily discovered that the number of connected components in the graph varied depending on the elements of X. Each element in R(n) had a unique graph, and it was fascinating to see how they all fit together.\n\nOne evening, as the sun dipped below the horizon, Lily's contemplations led her to a remarkable realization. She discovered a formula to calculate the number of elements of R(n) that had exactly k connected components in their graph. This was denoted as C(n,k), and it fascinated her immensely.\n\nLily knew that this discovery had the potential to change the face of mathematics. With her heart brimming with curiosity, she pondered the untapped applications of this formula. She yearned to explore its implications and share her findings with the world.\n\nBut before she embarked on that journey, Lily found herself contemplating a simpler question. A question that had been bothering her ever since she stumbled upon this mathematical problem.\n\nWith a determined gleam in her eyes, Lily wondered, \"What is C(104,10) mod 1,000,000,007? Can you solve this enigma and unlock the secrets hidden in its elegant solution?\"\n\nAnd so, the story ends, leaving the reader with a tantalizing question that invites them to join Lily in unraveling the mysteries of this mathematical problem. What adventures await them as they navigate the intricacies of numbers and graphs? Only time will tell."}, {"id": 556, "euler_id": 556, "title": "Squarefree Gaussian Integers", "problem": "A Gaussian integer is a number z\u00a0=\u00a0a\u00a0+\u00a0bi where a, b are integers and i2\u00a0=\u00a0-1.\nGaussian integers are a subset of the complex numbers, and the integers are the subset of Gaussian integers for which b\u00a0=\u00a00.\nA Gaussian integer unit is one for which a2\u00a0+\u00a0b2\u00a0=\u00a01, i.e. one of 1, i, -1, -i.\nLet's define a proper Gaussian integer as one for which a\u00a0>\u00a00 and b\u00a0\u2265\u00a00.\nA Gaussian integer z1\u00a0=\u00a0a1\u00a0+\u00a0b1i is said to be divisible by z2\u00a0=\u00a0a2\u00a0+\u00a0b2i if z3\u00a0=\u00a0a3\u00a0+\u00a0b3i\u00a0=\u00a0z1/z2 is a Gaussian integer.\nz1z2=a1+b1ia2+b2i=(a1+b1i)(a2\u2212b2i)(a2+b2i)(a2\u2212b2i)=a1a2+b1b2a22+b22+a2b1\u2212a1b2a22+b22i=a3+b3i\nSo, z1 is divisible by z2 if a1a2+b1b2a22+b22 and a2b1\u2212a1b2a22+b22 are integers.\nFor example, 2 is divisible by 1\u00a0+\u00a0i because 2/(1\u00a0+\u00a0i)\u00a0=\u00a01\u00a0-\u00a0i is a Gaussian integer.\nA Gaussian prime is a Gaussian integer that is divisible only by a unit, itself or itself times a unit.\nFor example, 1\u00a0+\u00a02i is a Gaussian prime, because it is only divisible by 1, i, -1, -i, 1\u00a0+\u00a02i, i(1\u00a0+\u00a02i)\u00a0=\u00a0i\u00a0-\u00a02, -(1\u00a0+\u00a02i)\u00a0=\u00a0-1\u00a0-\u00a02i and -i(1\u00a0+\u00a02i)\u00a0=\u00a02\u00a0-\u00a0i.\n2 is not a Gaussian prime as it is divisible by 1\u00a0+\u00a0i.\nA Gaussian integer can be uniquely factored as the product of a unit and proper Gaussian primes.\nFor example 2\u00a0=\u00a0-i(1\u00a0+\u00a0i)2 and 1\u00a0+\u00a03i\u00a0=\u00a0(1\u00a0+\u00a0i)(2\u00a0+\u00a0i).\nA Gaussian integer is said to be squarefree if its prime factorization does not contain repeated proper Gaussian primes.\nSo 2 is not squarefree over the Gaussian integers, but 1\u00a0+\u00a03i is.\nUnits and Gaussian primes are squarefree by definition.\nLet f(n) be the count of proper squarefree Gaussian integers with a2\u00a0+\u00a0b2\u00a0\u2264\u00a0n.\nFor example f(10)\u00a0=\u00a07 because 1, 1\u00a0+\u00a0i, 1\u00a0+\u00a02i, 1\u00a0+\u00a03i\u00a0=\u00a0(1\u00a0+\u00a0i)(2\u00a0+\u00a0i), 2\u00a0+\u00a0i, 3 and 3\u00a0+\u00a0i\u00a0=\u00a0-i(1\u00a0+\u00a0i)(1\u00a0+\u00a02i) are squarefree, while 2\u00a0=\u00a0-i(1\u00a0+\u00a0i)2 and 2\u00a0+\u00a02i\u00a0=\u00a0-i(1\u00a0+\u00a0i)3 are not.\nYou are given f(102)\u00a0=\u00a054, f(104)\u00a0=\u00a05218 and f(108)\u00a0=\u00a052126906.\nFind f(1014).", "solution": "52126939292957", "difficulty": 85, "story": "Once upon a time in the enchanting kingdom of Mathlandia, there lived a young mathematician named Ethan. Ethan was a brilliant and curious soul whose love for numbers knew no bounds. He would spend hours delving into various mathematical problems, always seeking to unravel the mysteries they held.\n\nOne sunny day, as Ethan sat in the royal library of Mathlandia, poring over a particularly intriguing problem, he stumbled upon a dusty old tome. The book was ancient and worn, its pages yellowed with age. Curiosity piqued, Ethan blew away the dust and began to read.\n\nTo his amazement, the book revealed the secrets of the Gaussian integers. Ethan's heart raced with excitement as he realized the plethora of possibilities that awaited him in the realm of these unique numbers.\n\nAs he delved deeper, Ethan discovered the concept of proper squarefree Gaussian integers, those captivating numbers whose prime factorization did not contain repeated proper Gaussian primes. The challenge posed by this concept ignited a fire in his soul, and he set out on a journey to uncover the truth.\n\nVenturing far and wide, Ethan sought the guidance of sages and scholars who were well-versed in the ways of the Gaussian integers. With each encounter, his knowledge grew, and he came to understand that a Gaussian integer was divisible by another if certain conditions were met.\n\nOne fateful evening, as Ethan sat by a campfire deep in the heart of a mystical forest, he found himself pondering the significance of these prime numbers in the grand tapestry of Mathematics. What made them special? How many proper squarefree Gaussian integers existed? And most importantly, how could he calculate f(1014)?\n\nHis mind raced as he considered the implications of the answers. Would it reveal yet another hidden treasure in the realm of numbers? Without hesitation, he jotted down his thoughts and calculations, determined to solve this mathematical puzzle.\n\nBut as he continued his journey, a nagging question arose in his mind. What if f(1014) had no solution? What if there were no proper squarefree Gaussian integers within that range? The mere thought sent shivers down his spine, for it would challenge everything he believed about the beauty and elegance of Mathematics.\n\nAs he left the forest behind and returned to the bustling streets of Mathlandia, Ethan's heart was heavy with anticipation. The answer to f(1014) eluded him, and his mind was consumed by the question that lingered in the air. Could he solve this seemingly insurmountable mathematical problem?\n\nAnd so, dear reader, the challenge now falls upon you. Can you uncover the solution to f(1014)? Will the realm of the Gaussian integers yield its secrets to you? The answer awaits, shrouded in the hidden depths of numbers, waiting to be discovered."}, {"id": 594, "euler_id": 594, "title": "Rhombus Tilings", "problem": "\nFor a polygon P, let t(P) be the number of ways in which P can be tiled using rhombi and squares with edge length 1. Distinct rotations and reflections are counted as separate tilings.\n\n\nFor example, if O is a regular octagon with edge length 1, then t(O)=8. As it happens, all these 8 tilings are rotations of one another:\n\n\n\n\nLet Oa,b be the equal-angled convex octagon whose edges alternate in length between a and b.\n\nFor example, here is O2,1, with one of its tilings:\n\n\n\n\nYou are given that t(O1,1)=8, t(O2,1)=76 and t(O3,2)=456572.\n\n\nFind t(O4,2).\n", "solution": "47067598", "difficulty": 85, "story": "Once upon a time in the vibrant kingdom of Polygonia, there lived a young and curious mathematician named Oliver. Fascinated by the enchanting world of numbers and shapes, Oliver spent most of his days pouring over mathematical puzzles and conundrums.\n\nOne sunny morning, as Oliver was strolling through the royal gardens of Polygonia, he stumbled upon a mysterious fragment of a parchment. The delicate piece of paper bore an intriguing mathematical problem. It spoke of polygons, rhombi, and squares, presenting Oliver with an enchanting challenge.\n\nDetermined to unravel the mysteries within, Oliver rushed back to his study. He spread out the parchment before him, examining the intricate diagrams and calculations. The problem introduced a function called t(P) that counted the number of ways a polygon P could be tiled using rhombi and squares, each with an edge length of 1. Oliver marveled at the possibilities and ventured deeper into the world of polygonal tilings.\n\nAs he delved into the examples given in the problem, Oliver noticed the significance of rotations and reflections. Each tiling had distinct variations, adding to the complexity of the puzzle. It fascinated him to realize how different arrangements could emerge from the same starting polygon.\n\nThe parchment revealed that a regular octagon, denoted as O, could be tiled in 8 distinct ways. Oliver pondered over the detailed illustrations, visualizing the transformations within his mind. All eight tilings seemed similar yet uniquely different, challenging his perception of symmetry and rotation.\n\nBut it was the next polygon, O1,1, that took Oliver's breath away. It was an equal-angled convex octagon with alternating edge lengths of 1 and 1. As he studied the diagrams, he was astounded to learn that t(O1,1) equaled 8, just like the regular octagon O. The realization struck a chord within Oliver's mathematical heart, and he marveled at the unity and surprises hidden in the world of shapes and numbers.\n\nAs Oliver reached the tale of O2,1, he nearly jumped with excitement. The parchment revealed that this particular polygon could be tiled in 76 different ways. The challenge intensified, but the young mathematician was up for it. He meticulously studied the complexities of O2,1's tilings, carefully noting each nuance and transformation.\n\nBut the true test lay ahead for him \u2013 t(O3,2). Oliver's eyes widened as he absorbed the staggering number - 456572 ways to tile this enigmatic polygon. The possibilities seemed endless, and his mind raced with ideas, seeking patterns and symmetries among the thousands of arrangements.\n\nDays turned into weeks, and weeks turned into months as Oliver dedicated himself to unlocking the secrets hidden within the polygons. He scoured through ancient texts and traveled far to consult the wise scholars of Polygonia. With each new revelation, his excitement grew, fueling his determination to understand and solve the enigma that was t(O4,2).\n\nNow, dear reader, I leave you with the question that captivated Oliver's heart and mind: What is t(O4,2)? Can you envision the countless ways to tile this intriguing polygon, just as he did?\n\nEmbrace the challenge and embark on your own adventure into the captivating world of tilings and polygons."}, {"id": 818, "euler_id": 818, "title": "SET", "problem": "\nThe SET\u00ae card game is played with a pack of 81 distinct cards. Each card has four features (Shape, Color, Number, Shading). Each feature has three different variants (e.g. Color can be red, purple, green).\n\nA SET consists of three different cards such that each feature is either the same on each card or different on each card.\n\nFor a collection Cn of n cards, let S(Cn) denote the number of SETs in Cn. Then define F(n)=\u2211CnS(Cn)4 where Cn ranges through all collections of n cards (among the 81 cards).\nYou are given F(3)=1080 and F(6)=159690960.\n\nFind F(12).\n\n\nSET is a registered trademark of Cannei, LLC.  All rights reserved.  Used with permission from PlayMonster, LLC.", "solution": "11871909492066000", "difficulty": 85, "story": "Once upon a time in a small town called Numeria, there was a young girl named Lily. Lily was a math prodigy, always seeking new puzzles and challenges to test her skills. One sunny afternoon, as she sat in the local park, her attention was caught by a group of children playing a card game, filled with excitement and laughter.\n\nCuriosity piqued, Lily approached the group and discovered they were playing a game called SET\u00ae. The children explained the rules to her \u2013 how each card had four different features: Shape, Color, Number, and Shading. They told her about the different variants of each feature and how a SET was formed when three cards shared either the same or different features for each of the four traits.\n\nIntrigued, Lily watched as the game unfolded before her eyes. The children dealt out three cards, analyzing them intently to discover any SETs. Lily could see the mathematical patterns and possibilities, her mind whirring with excitement.\n\nAs days turned into weeks, Lily couldn't shake off her obsession with SET. Every moment she had, she immersed herself in the game, analyzing and counting. She sought to unravel the number of SETs in different collections of cards, eager to uncover the secrets buried within this numerical world.\n\nOne evening, Lily came across an intriguing problem. It asked her to find the value of F(12), which denoted the summation of S(Cn) raised to the power of four for every collection of n cards. The values of F(3) and F(6) were given as 1080 and 159690960, respectively. Determined to solve the puzzle, Lily began her quest.\n\nShe spent hours upon hours pouring over her notebook, filled with sketches, calculations, and theories. The people of Numeria noticed Lily's unwavering focus and boundless dedication to her numbers. Some whispered that she had become a bit strange, while others were mystified by her brilliance.\n\nMonths passed, and as the autumn leaves began to fall, Lily found herself engulfed in a world of numbers. Friends and family worried about her well-being, urging her to take a break and embrace the joys of life. But Lily couldn't let go of her mathematical puzzle. There was something extraordinary about SET, something she couldn't quite grasp.\n\nOn a cold winter's night, a revelation struck Lily as she sat by the fireplace, staring intently at the dancing flames. The pieces began to come together, forming a beautiful mosaic in her mind. She had discovered the key that would unlock the mystery of F(12).\n\nBut before she could rejoice in her success, a question arose \u2013 a question she now posed to you, dear reader. Can you find the value of F(12)? Can you solve the mathematical problem that consumed Lily's every waking moment? Can you complete the puzzle that had become her life's mission?\n\nThe answer awaits, hidden within the depths of the numerical realm. Are you ready to venture into the enchanting world of SET and discover the captivating solution?"}, {"id": 824, "euler_id": 824, "title": "Chess Sliders", "problem": "A Slider is a chess piece that can move one square left or right.\nThis problem uses a cylindrical chess board where the left hand edge of the board is connected to the right hand edge. This means that a Slider that is on the left hand edge of the chess board can move to the right hand edge of the same row and vice versa.\nLet L(N,K) be the number of ways K non-attacking Sliders can be placed on an N\u00d7N cylindrical chess-board.\nFor example, L(2,2)=4 and L(6,12)=4204761.\nFind L(109,1015)mod(107+19)2.", "solution": "26532152736197", "difficulty": 85, "story": "Once upon a time, in a land far, far away, there existed a kingdom ruled by a wise and just king named Leonard. King Leonard was known for his love of puzzles and riddles, constantly challenging his subjects to expand their minds and think critically. One day, a young servant named Eli approached the king with a perplexing problem that he had come across.\n\n\"Your Excellency,\" Eli said, bowing before the king, \"I have discovered a mathematical problem that I believe you will find intriguing.\"\n\nKing Leonard, always eager to be stimulated intellectually, gestured for Eli to continue. \"Please, enlighten me.\"\n\nEli began, \"Your Majesty, this problem involves a Slider, a unique chess piece that can move one square left or right. However, in this particular scenario, we have a cylindrical chessboard where the left and right edges are connected. Thus, a Slider on the left-hand edge can move to the right-hand edge of the same row, and vice versa.\"\n\nIntrigued by the concept, King Leonard leaned forward, his eyes glistening with excitement. \"Continue, young Eli. I am captivated.\"\n\nEli smiled before continuing, \"Your Majesty, the problem at hand is to determine the number of ways K non-attacking Sliders can be placed on an N\u00d7N cylindrical chessboard. For instance, if we have a 2x2 board, there are four possible arrangements, as denoted by L(2,2). Likewise, L(6,12) yields a staggering result of 4204761.\"\n\nKing Leonard's brow furrowed as he pondered the intricacies of the problem. \"This is indeed fascinating, Eli. I can see the potential applications in strategies and game theory. But is there a reason for solving this problem, or is it merely intellectual curiosity?\"\n\nEli's eyes sparkled as an idea formed. \"Your Majesty, imagine if we could utilize this knowledge to devise battle formations! With the ability to position Sliders strategically, we could create impenetrable defenses or launch devastating attacks. This problem holds the key to infinite possibilities.\"\n\nKing Leonard nodded, his mind racing with the potential implications of Eli's revelation. \"Indeed, Eli. This mathematical problem may hold the power to shape the destiny of our kingdom. Tell me, what is L(109,1015)mod(107+19)2?\"\n\nBefore Eli could respond, a messenger burst into the room, interrupting their discussion. \"Your Majesty! There's urgent news from the northern border. We are under attack!\"\n\nKing Leonard's eyes widened with determination and a flicker of hope. \"Eli, my dear servant, this mathematical problem may hold the key to our victory. You and I shall join forces to solve it, for our kingdom's survival may depend on it.\"\n\nWith renewed determination, Eli and King Leonard set forth on a quest to understand the solutions to L(109,1015)mod(107+19)2. A race against time began as they delved into the depths of mathematics, searching for patterns, developing formulas, and employing every bit of their knowledge and intellect.\n\nAs each day passed, their progress was met with countless questions, splendid revelations, and relentless perseverance. The castle walls reverberated with discussions of numbers, chess strategies, and the possibilities that lay within the mystifying realm of Sliders.\n\nBut the more they delved into the problem, the more elusive the solution became. It seemed as though the mathematical conundrum was intentionally hiding its secrets, testing their determination and wit.\n\nFinally, after weeks of tireless efforts, the fateful day arrived. Eli and King Leonard stood before a packed audience, eager to unveil their findings. The moment of truth had come, and all eyes were upon them.\n\nClearing his throat, Eli addressed the crowd, \"Ladies and gentlemen, we believe we have made tremendous progress in our quest to solve L(109,1015)mod(107+19)2. However, we have reached an impasse, a barrier that demands a fresh perspective, a new approach.\"\n\nSilence fell over the hall as the audience held their breath, waiting for the conclusive statement. Eli continued, \"And so, I stand before you today, humbled yet hopeful. I ask you, the brilliant minds of this kingdom, for your assistance in unraveling the final thread, for only together may we find the ultimate solution. Who among you shall rise to this challenge?\"\n\nThe crowd erupted in whispers and murmurs as people eagerly contemplated the mysterious mathematical problem. The air was thick with excitement and anticipation, for the fate of the kingdom hung in the balance.\n\nAnd so, dear reader, as you immerse yourself in this captivating tale and analyze the mathematical intricacies of the Slider problem, I pose the question to you: Can you find the solution to L(109,1015)mod(107+19)2? Will you be the one to unravel the final thread and guide this kingdom to victory?\n\nThe challenge awaits, my friend, the challenge awaits."}]