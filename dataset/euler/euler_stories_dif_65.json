[{"id": 143, "euler_id": 143, "title": "Investigating the Torricelli point of a triangle", "problem": "Let ABC be a triangle with all interior angles being less than 120 degrees. Let X be any point inside the triangle and let XA = p, XC = q, and XB = r.\nFermat challenged Torricelli to find the position of X such that p + q + r was minimised.\nTorricelli was able to prove that if equilateral triangles AOB, BNC and AMC are constructed on each side of triangle ABC, the circumscribed circles of AOB, BNC, and AMC will intersect at a single point, T, inside the triangle. Moreover he proved that T, called the Torricelli/Fermat point, minimises p + q + r. Even more remarkable, it can be shown that when the sum is minimised, AN = BM = CO = p + q + r and that AN, BM and CO also intersect at T.\n\nIf the sum is minimised and a, b, c, p, q and r are all positive integers we shall call triangle ABC a Torricelli triangle. For example, a = 399, b = 455, c = 511 is an example of a Torricelli triangle, with p + q + r = 784.\nFind the sum of all distinct values of p + q + r \u2264 120000 for Torricelli triangles.", "solution": "30758397", "difficulty": 65, "story": "Once upon a time in the kingdom of Mathylon, there was a land renowned for its extraordinary knowledge and love for mathematics. The people of Mathylon held a deep fascination for numbers, shapes, and equations. Amongst them were two young prodigies named Fermat and Torricelli.\n\nFermat was known for his brilliance in algebraic number theory, while Torricelli had a deep understanding of geometry. The two friends often spent their days discussing and challenging each other with various mathematical problems. One fine day, Fermat threw a challenge at Torricelli, a problem that would test his geometric prowess like never before.\n\n\"Torricelli, my friend,\" Fermat began with a mischievous glint in his eyes, \"I challenge you to find the position of a point, X, inside any triangle ABC, such that the sum of the lengths of XA, XC, and XB is minimized. And to make it more interesting, let's assume that all the interior angles of triangle ABC are less than 120 degrees.\"\n\nTorricelli's interest was immediately piqued. He delved into deep thought, pondering over the problem Fermat had presented to him. Days turned into weeks as Torricelli immersed himself in his study of triangles and circles. He meticulously sketched and calculated, exploring all possible scenarios within the confines of a triangle.\n\nFinally, after weeks of intense concentration, Torricelli had an epiphany. He discovered that if he constructed equilateral triangles AOB, BNC, and AMC on each side of triangle ABC, with points O, N, and M as their centers respectively, something remarkable happened. The circumscribed circles of AOB, BNC, and AMC intersected at a single point, T, within the triangle.\n\nTorricelli knew he had found something groundbreaking, a discovery that would change the way triangles were understood forever. He named this point T the Torricelli/Fermat point, in honor of the challenge his friend had posed to him. But what struck Torricelli the most was that point T not only minimized the sum of the lengths of XA, XC, and XB, but it also held another astonishing property.\n\nIntrigued, Torricelli continued his exploration. He found that when the sum of XA, XC, and XB was minimized, the lengths of AN, BM, and CO within the triangle ABC were all equal to the minimized sum. Furthermore, these lines intersected at the Torricelli/Fermat point, T.\n\nThe implications of Torricelli's discovery were enormous. He realized that if he could find triangles that met these conditions, he could classify them as Torricelli triangles. Each Torricelli triangle would have distinct values for p, q, and r, satisfying the equation p + q + r \u2264 120000 with all the variables being positive integers.\n\nThe news of Torricelli's remarkable findings spread like wildfire throughout the kingdom of Mathylon. Mathematicians and scholars from far and wide came to witness the unveiling of Torricelli's theorem. The excitement buzzed in the air as they marveled at Torricelli's beautiful geometric proofs.\n\nAs he stood in front of the crowd, Torricelli smiled, feeling proud of his accomplishment. But his mind was still curious, still thirsty for knowledge. He turned to Fermat, who had been eagerly following every step of his journey.\n\n\"Fermat,\" Torricelli paused, his eyes sparkling with anticipation, \"Will you take up yet another challenge? Can you find the sum of all distinct values of p + q + r \u2264 120000 for Torricelli triangles?\"\n\nAnd with that, Torricelli passed the baton of curiosity to his friend, waiting for Fermat's intellect to unravel the hidden treasures of this mathematical problem.\n\nCan you solve the question that Torricelli posed to Fermat? What is the sum of all distinct values of p + q + r \u2264 120000 for Torricelli triangles?"}, {"id": 147, "euler_id": 147, "title": "Rectangles in cross-hatched grids", "problem": "In a 3x2 cross-hatched grid, a total of 37 different rectangles could be situated within that grid as indicated in the sketch.\n\nThere are 5 grids smaller than 3x2, vertical and horizontal dimensions being important, i.e. 1x1, 2x1, 3x1, 1x2 and 2x2. If each of them is cross-hatched, the following number of different rectangles could be situated within those smaller grids:\n1x112x143x181x242x218Adding those to the 37 of the 3x2 grid, a total of 72 different rectangles could be situated within 3x2 and smaller grids.\nHow many different rectangles could be situated within 47x43 and smaller grids?", "solution": "846910284", "difficulty": 65, "story": "Once upon a time in a small village nestled between rolling hills, there lived a young and curious boy named Theo. Known for his insatiable appetite for knowledge, Theo spent most of his days exploring the world around him. One sunny afternoon, while wandering through an enchanted forest, he stumbled upon a group of mystical creatures engaged in a heated debate.\n\nIntrigued, Theo approached the creatures\u2014a giant, a talking squirrel, and a wise old owl\u2014who were trying to solve a perplexing mathematical problem. The giant, named Goliath, held up a sketch of a 3x2 cross-hatched grid.\n\n\"According to my calculations,\" Goliath proclaimed, a deep rumble in his voice, \"there are exactly 37 different rectangles that could be situated within this grid.\"\n\nTheo's eyes widened with curiosity as he observed the intricate patterns on the grid. He noticed that each of the smaller grids within the 3x2 hatched grid had distinct dimensions\u20141x1, 2x1, 3x1, 1x2, and 2x2.\n\n\"Not only does each smaller grid have its own number of rectangles,\" the talking squirrel named Nutkin chimed in, his excitement palpable, \"but when we add those smaller grid rectangles to the 37 in the 3x2 grid, we get a total of 72 different rectangles!\"\n\nTheo's mind raced with possibilities. He imagined the countless combinations and shapes that could be created within these cross-hatched grids. The wise old owl, Orion, looked at Theo with a knowing glimmer in his eyes.\n\n\"Theo,\" Orion hooted gently, \"imagine if we were to expand this problem to a larger grid, say a 47x43 grid and smaller. How many different rectangles could be situated within that?\"\n\nTheo's heart skipped a beat. The thought of solving such a complex problem excited him. He couldn't help but wonder about the countless combinations and shapes that would emerge within a grid of that magnitude.\n\nAs the sun began to dip below the horizon, casting an orange glow across the forest, Theo resolved to find the answer to Orion's question. He bid farewell to the enchanted creatures and made his way back to the village, determination fueling his every step.\n\nDays turned into weeks as Theo immersed himself in the world of mathematics. He poured over his books, studied diagrams, and tirelessly scribbled solutions on parchment. But despite his best efforts, the answer eluded him. The vastness of the problem overwhelmed his young mind.\n\nNow, here lies the mystery: How many different rectangles could be situated within a 47x43 and smaller grid? As Theo finds himself still searching for the answer, he wonders if you, dear reader, hold the key to this mathematical enigma. Can you solve the puzzle that has captured young Theo's imagination and set his heart ablaze with curiosity?\n\nTheo beckons you to join him on this quest for knowledge and discovery. Will you venture forth and unravel the mysteries of the grid?"}, {"id": 152, "euler_id": 152, "title": "Writing 1/2 as a sum of inverse squares", "problem": "There are several ways to write the number 1/2 as a sum of inverse squares using distinct integers.\nFor instance, the numbers {2,3,4,5,7,12,15,20,28,35} can be used:\n12=122+132+142+152+172+1122+1152+1202+1282+1352\nIn fact, only using integers between 2 and 45 inclusive, there are exactly three ways to do it, the remaining two being: {2,3,4,6,7,9,10,20,28,35,36,45} and {2,3,4,6,7,9,12,15,28,30,35,36,45}.\nHow many ways are there to write the number 1/2 as a sum of inverse squares using distinct integers between 2 and 80 inclusive?", "solution": "301", "difficulty": 65, "story": "Once upon a time, in a small village nestled at the foot of a tall mountain, there lived a young girl named Ava. Ava was known throughout the village as a curious and intelligent child. She had a mind that was constantly searching for answers and a heart that yearned for adventure.\n\nOne beautiful morning, as the early rays of the sun touched the rooftops of the village, Ava set off on a hike up the mysterious mountain. She had heard tales of hidden treasures and ancient secrets that were said to be guarded by the mountain's majestic peaks.\n\nAs Ava climbed higher and higher, the air became cooler, and the trees whispered ancient melodies in her ears. She pushed past the branches and thickets, determined to uncover the truths that lay ahead.\n\nAfter hours of climbing, her legs weary but her spirit undeterred, Ava finally reached a clearing. There, standing tall amidst the mist, was a magnificent stone statue of Pythagoras, the famous mathematician. Intrigued, Ava stepped closer to examine the statue.\n\nTo her surprise, the stone statue came to life. Pythagoras spoke with a gentle voice, \"Ah, Ava, seeker of knowledge. I have a mathematical problem for you, one that lies at the heart of the treasures hidden in this mountain.\"\n\nAva's eyes sparkled with excitement. She listened intently as Pythagoras explained the problem to her. He spoke of ways to write the number 1/2 as a sum of inverse squares, using distinct integers between 2 and 80. He shared the example of the set {2, 3, 4, 5, 7, 12, 15, 20, 28, 35}, how these numbers could create such a sum. And he mentioned that there were three ways to do it.\n\n\"The answer to this mathematical puzzle,\" Pythagoras said, \"holds the key to unlocking the hidden treasures of this mountain. Solve it, and you shall be rewarded with wisdom and riches beyond your wildest dreams.\"\n\nAva's mind raced with excitement. She knew that this mathematical problem held the secret she had been seeking. Determined, she sat down next to the statue, her pen and notebook in hand, ready to crack the code.\n\nDays turned into weeks as Ava immersed herself in the challenge. She shuffled numbers, drew diagrams, and scribbled calculations in her notebook. The wind whispered the answer to her, and the trees whispered encouragement.\n\nThe village watched in awe as Ava toiled day and night, her determination a beacon of hope. And finally, after weeks of relentless effort, Ava emerged from her study with a triumphant smile on her face. She had found the solution.\n\nBut the story doesn't end here. No, it merely begins again. Ava's journey opened her eyes to the wonders of mathematics. She realized that these numbers were not merely building blocks for the treasure hidden in the mountain, but also keys to unlocking the mysteries of the world.\n\nAnd so, dear reader, the question I pose to you is this: How many ways are there to write the number 1/2 as a sum of inverse squares using distinct integers between 2 and 80 inclusive? Will you venture on this mathematical journey, just like Ava, and seek the answer hidden within?"}, {"id": 153, "euler_id": 153, "title": "Investigating Gaussian Integers", "problem": "As we all know the equation x2=-1 has no solutions for real x.\n\nIf we however introduce the imaginary number i this equation has two solutions: x=i and x=-i.\n\nIf we go a step further the equation (x-3)2=-4 has two complex solutions: x=3+2i and x=3-2i.\nx=3+2i and x=3-2i are called each others' complex conjugate.\n\nNumbers of the form a+bi are called complex numbers.\n\nIn general a+bi and a\u2212bi are each other's complex conjugate.\nA Gaussian Integer is a complex number a+bi such that both a and b are integers.\n\nThe regular integers are also Gaussian integers (with b=0).\n\nTo distinguish them from Gaussian integers with b \u2260 0 we call such integers \"rational integers.\"\n\nA Gaussian integer is called a divisor of a rational integer n if the result is also a Gaussian integer.\n\nIf for example we divide 5 by 1+2i we can simplify 51+2i in the following manner:\n\nMultiply numerator and denominator by the complex conjugate of 1+2i: 1\u22122i.\n\nThe result is 51+2i=51+2i1\u22122i1\u22122i=5(1\u22122i)1\u2212(2i)2=5(1\u22122i)1\u2212(\u22124)=5(1\u22122i)5=1\u22122i.\n\nSo 1+2i is a divisor of 5.\n\nNote that 1+i is not a divisor of 5 because 51+i=52\u221252i.\n\nNote also that if the Gaussian Integer (a+bi) is a divisor of a rational integer n, then its complex conjugate (a\u2212bi) is also a divisor of n.\nIn fact, 5 has six divisors such that the real part is positive: {1, 1 + 2i, 1 \u2212 2i, 2 + i, 2 \u2212 i, 5}.\n\nThe following is a table of all of the divisors for the first five positive rational integers:\n\nn Gaussian integer divisors\nwith positive real partSum s(n) of these\n\ndivisors111\n21, 1+i, 1-i, 25\n31, 34\n41, 1+i, 1-i, 2, 2+2i, 2-2i,413\n51, 1+2i, 1-2i, 2+i, 2-i, 512\nFor divisors with positive real parts, then, we have: \u2211n=15s(n)=35.\nFor \u2211n=1105s(n)=17924657155.\nWhat is \u2211n=1108s(n)?", "solution": "17971254122360635", "difficulty": 65, "story": "Once upon a time in the small village of Mathlandia, there lived a young and curious mathematician named Lucas. Lucas had always been fascinated by numbers, especially the complexities of imaginary and complex numbers. His little cottage was filled with shelves lined with books on mathematical equations and theories.\n\nOne sunny afternoon, Lucas sat in his backyard surrounded by papers covered in calculations and diagrams. His mind was consumed by a particular problem he had been trying to solve for days. How could he find the sum of divisors for the first five positive rational integers?\n\nAs he pondered, Lucas noticed a peculiar figure in the distance, clad in a bright purple robe, wandering through the village square. The figure's name was Professa Countis, a renowned mathematician rumored to have discovered the secrets hidden within complex numbers and their divisors.\n\nDetermined to find answers, Lucas approached Professa Countis and introduced himself. The Professa listened intently to Lucas's predicament, visibly intrigued by his inquiry. \"Ah, divisors,\" the Professa muttered thoughtfully. \"Such interesting creatures, aren't they?\"\n\nWith a flick of his wrist, Professa Countis conjured a magnificent chalkboard seemingly out of thin air. He began to scribble equations and draw diagrams, explaining complex numbers and their relationship to rational integers. As the Professa spoke, Lucas's eyes widened in marvel and comprehension.\n\n\"You see, young Lucas,\" the Professa explained, \"Gaussian integers are key to unraveling the mysteries of divisors. They are like bridges connecting rational integers with complex numbers. By understanding their properties, we can find the divisors we seek.\"\n\nLucas hung onto every word, absorbing the knowledge like a sponge. As their discussion progressed, the Professa demonstrated various examples, showcasing how complex conjugates were essential in the world of divisors.\n\nFeeling enlightened and motivated, Lucas delved into the depths of his mathematical realm. He worked tirelessly, jotting down equations, manipulating numbers, and exploring the connections between rational and Gaussian integers.\n\nDays turned into weeks, and weeks into months as Lucas tirelessly computed and re-computed divisors. Finally, he arrived at a breakthrough. The sum of divisors for the first five positive rational integers with positive real parts was 35.\n\nOverjoyed yet hungry for more knowledge, Lucas forged ahead without hesitation. His quest for understanding grew stronger with each passing day. And now, dear reader, I pose a question to you:\n\nWhat is the sum of divisors for the first five positive rational integers, including 8?\n\nTo be continued..."}, {"id": 154, "euler_id": 154, "title": "Exploring Pascal's pyramid", "problem": "A triangular pyramid is constructed using spherical balls so that each ball rests on exactly three balls of the next lower level.\n\nThen, we calculate the number of paths leading from the apex to each position:\nA path starts at the apex and progresses downwards to any of the three spheres directly below the current position.\nConsequently, the number of paths to reach a certain position is the sum of the numbers immediately above it (depending on the position, there are up to three numbers above it).\nThe result is Pascal's pyramid and the numbers at each level n are the coefficients of the trinomial expansion \n(x + y + z)n.\nHow many coefficients in the expansion of (x + y + z)200000 are multiples of 1012?", "solution": "479742450", "difficulty": 65, "story": "Once upon a time in the mystical land of Numeria, there lived a talented young magician named Amelia. Amelia possessed a rare ability to wield the power of numbers and equations with unrivaled finesse. She could make numbers dance, equations sing, and mathematical puzzles come to life.\n\nOne day, as Amelia was strolling through the enchanted forest that surrounded her home, she came across a peculiar sight. In a small clearing stood a magnificent triangular pyramid made entirely of spherical balls. Each ball sat perfectly atop three balls of the next lower level, creating an awe-inspiring structure.\n\nIntrigued by the pyramid's mathematical elegance, Amelia approached it with curiosity. As she examined the balls closely, she noticed that they were not just ordinary spheres. Each one was adorned with mysterious symbols and seemed to emanate a faint glow of magic.\n\nAmelia's heart skipped a beat as an idea flickered in her mind. Could this be a mathematical puzzle waiting to be unlocked? She gingerly touched one of the balls, and to her amazement, a surge of energy coursed through her body. The symbols on the ball illuminated, forming a complex equation in Amelia's mind.\n\nSuddenly, a voice echoed through the clearing, smooth and melodic. \"Welcome, Amelia, the prodigious mathematician. I am Phelix, the spirit guardian of this pyramid. Solve my riddle and unlock the secrets within.\"\n\nAmelia's eyes sparkled with excitement, knowing she had stumbled upon something truly extraordinary. She closed her eyes, focused her thoughts, and allowed her mind to devour the enigma presented to her.\n\nAnd so, Amelia embarked on a journey of calculations and deep mathematical contemplations. She realized that the number of paths leading to each position in the pyramid was precisely the sum of the numbers immediately above it. The pyramid, as Phelix named it, was none other than Pascal's pyramid.\n\nWith each puzzle Amelia solved, the pyramid gleamed brighter, and her understanding of the magical nature of numbers swelled. The coefficients of the trinomial expansion (x + y + z) became her allies, paving the way for her future discoveries.\n\nAs she delved deeper into the pyramid's secrets, Amelia pondered a captivating question. How many coefficients in the expansion of (x + y + z)200000 were multiples of 1012? The answer eluded her, challenging her perception of the mathematical world and daring her to find the missing piece of the puzzle.\n\nDays turned into weeks, weeks into months, and Amelia's obsession with the question became consuming. She pored over countless notebooks filled with equations, attempted various approaches, and sought insight from fellow mathematicians far and wide. But no solution presented itself, and the mystery remained unsolved.\n\nThe story of Amelia and the magical pyramid spread throughout Numeria, capturing the imagination of young students and seasoned mathematicians alike. Scholars and academics pondered the question that had left Amelia transfixed, hoping to uncover the answer, to quench the thirst for knowledge that burned within them.\n\nAnd so, dear reader, the question lingers in the air, waiting to be taken up by a daring individual whose mind might hold the key. How many coefficients in the expansion of (x + y + z)200000 are multiples of 1012? Will you be the one to solve this mathematical enigma and bring closure to the tale that began with Amelia and the mystical pyramid in the enchanted forest of Numeria?"}, {"id": 157, "euler_id": 157, "title": "Solving the diophantine equation 1/a+1/b= p/10n ", "problem": "Consider the diophantine equation 1/a+1/b= p/10n with a, b, p, n positive integers and a \u2264 b.\nFor n=1 this equation has 20 solutions that are listed below:\n1/1+1/1=20/10\n1/1+1/2=15/10\n1/1+1/5=12/10\n1/1+1/10=11/10\n1/2+1/2=10/10\n1/2+1/5=7/10\n1/2+1/10=6/10\n1/3+1/6=5/10\n1/3+1/15=4/10\n1/4+1/4=5/10\n1/4+1/20=3/10\n1/5+1/5=4/10\n1/5+1/10=3/10\n1/6+1/30=2/10\n1/10+1/10=2/10\n1/11+1/110=1/10\n1/12+1/60=1/10\n1/14+1/35=1/10\n1/15+1/30=1/10\n1/20+1/20=1/10\nHow many solutions has this equation for 1 \u2264 n \u2264 9?", "solution": "53490", "difficulty": 65, "story": "Once upon a time, in the small village of Mathlandia, there lived a young girl named Audrey. Audrey had always been fascinated by numbers and patterns, and she spent most of her days exploring different mathematical concepts. Her curiosity had led her down many paths of learning, but there was one problem that had her completely captivated - the Diophantine equation.\n\nThe Diophantine equation was a puzzle that involved finding solutions for the equation 1/a + 1/b = p/10n, where a, b, p, and n were all positive integers, and a had to be less than or equal to b. Audrey had spent countless nights trying to crack this code, hoping to understand the harmonious dance of numbers that lay hidden within the equation.\n\nOne sunny day, as Audrey was wandering through the town square lost in her thoughts, she stumbled upon a hidden library. The library was tucked away in a forgotten corner, covered in ivy and mystery. Overcome by a sense of excitement, Audrey stepped inside.\n\nInside the library, Audrey discovered a book that seemed to hold the answers she had been seeking. The pages, weathered and yellowed with age, detailed the astonishing beauty of the Diophantine equation. The book contained a list of twenty solutions for the equation when n equaled one, each one more perplexing than the last.\n\nAs Audrey read through the elegant solutions, her mind began to spin. She visualized rows of numbers forming and dissolving, integers dancing around each other, and fractions merging to create harmonious combinations. The possibilities seemed endless, and Audrey realized that she was about to embark on a journey down a mathematical rabbit hole.\n\nDetermined to discover the solutions for n values ranging from one to nine, Audrey dove headfirst into her studies. Day and night, she immersed herself in the world of numbers, using her keen intellect to solve equation after equation. She experimented with different variables, created complex algorithms, and drew intricate diagrams - all in an effort to unravel the mystical patterns buried within the Diophantine equation.\n\nAs Audrey's understanding of the problem grew, so did her fascination. She had uncovered some solutions for n values two and three, but the road ahead seemed daunting. The problem had become more intricate, stretching the limits of her mathematical prowess. But Audrey's determination was unwavering, and she moved forward with an unwavering resolve.\n\nNow, dear reader, I leave you with a question. As you follow Audrey on her quest to solve the Diophantine equation, how many solutions do you think she will uncover for n values ranging from one to nine? The possibilities are endless, and the answer lies deep within the mysterious realm of numbers. Can you crack the code and unlock the secrets hidden within this magical equation?"}, {"id": 165, "euler_id": 165, "title": "Intersections", "problem": "A segment is uniquely defined by its two endpoints. By considering two line segments in plane geometry there are three possibilities: \nthe segments have zero points, one point, or infinitely many points in common.\nMoreover when two segments have exactly one point in common it might be the case that that common point is an endpoint of either one of the segments or of both. If a common point of two segments is not an endpoint of either of the segments it is an interior point of both segments.\nWe will call a common point T of two segments L1 and L2 a true intersection point of L1 and L2  if T is the only common point of L1 and L2  and T is an interior point of both segments.\n\nConsider the three segments L1, L2, and L3:\nL1: (27, 44) to (12, 32)\nL2: (46, 53) to (17, 62)\nL3: (46, 70) to (22, 40)\nIt can be verified that line segments L2 and L3 have a true intersection point. We note that as the one of the end points of L3: (22,40) lies on L1 this is not considered to be a true point of intersection. L1 and L2 have no common point. So among the three line segments, we find one true intersection point.\nNow let us do the same for 5000 line segments. To this end, we generate 20000 numbers using the so-called \"Blum Blum Shub\" pseudo-random number generator.\ns0 = 290797\nsn+1 = sn\u00d7sn (modulo 50515093)\ntn = sn (modulo 500)\nTo create each line segment, we use four consecutive numbers tn. That is, the first line segment is given by:\n(t1, t2) to (t3, t4)\nThe first four numbers computed according to the above generator should be: 27, 144, 12 and 232. The first segment would thus be (27,144) to (12,232).\nHow many distinct true intersection points are found among the 5000 line segments?", "solution": "2868868", "difficulty": 65, "story": "Once upon a time, in the peaceful kingdom of Numeria, there was a young and talented mathematician named Leo. Leo had always been fascinated by numbers and patterns, constantly seeking new mathematical challenges to solve. His love for math had even earned him a place at the prestigious Mathematical Academy, where he could pursue his passion under the guidance of renowned mathematicians.\n\nOne fine day, Leo was approached by an elderly woman named Greta, who seemed quite distressed. She explained that she was the queen's personal seamstress and had recently discovered an ancient tapestry hidden in the royal vault. The tapestry was said to hold a secret message that only the most gifted mathematicians could decipher.\n\nIntrigued by the mystery, Leo agreed to help Greta unravel the secrets of the tapestry. The queen, upon hearing of Leo's involvement, granted them access to the royal library, where they could study the tapestry under the watchful eyes of the grand librarian, Professor Ethan.\n\nAs Leo and Greta laid the tapestry on a large table, they were mesmerized by the intricate patterns and colors that adorned the fabric. The tapestry seemed to depict a vast landscape, with countless line segments intertwining and intersecting in a mesmerizing dance. Leo's mathematical instincts kicked in, realizing that this tapestry could be his greatest challenge yet.\n\nAs he examined the tapestry closely, Leo noticed that the line segments had distinct endpoints and that there were various possibilities for their intersections. Remembering his lessons, he thought back to a crucial mathematical problem he had come across before when considering line segments.\n\nTo fully understand the intricacies of the tapestry, Leo shared the mathematical problem with Greta. They discussed how two line segments could have no points in common, one point in common (which could be an endpoint of either one or even both segments), or infinitely many points in common. Additionally, they learned about the concept of true intersection points, which occurred when two segments had a common interior point that was the only point they shared.\n\nWith this newfound knowledge in mind, Leo examined the tapestry even closer. His trained eye could discern the distinct line segments woven into the fabric, and he was determined to solve the mystery they held. As he traced the pattern with his fingers, Leo realized that there were precisely 5000 line segments on the tapestry.\n\nBut what intrigued Leo even more was the thought of how many distinct true intersection points the line segments contained. He knew that the answer lay hidden within the numbers, but to unlock it, he needed to examine the sequence of numbers that generated the line segments.\n\nWithout any further delay, Leo began the task of revealing the secret embedded in the tapestry. He recited the ancient words spoken by the mathematicians of old, invoking the power of the \"Blum Blum Shub\" pseudo-random number generator. Following the instructions, he generated the first four numbers: 27, 144, 12, and 232.\n\nAs the needle of the generator's dial danced with each twist and turn, Leo carefully matched each set of four consecutive numbers with the corresponding line segment on the tapestry. From the first segment to the 5000th, he diligently recorded the true intersection points.\n\nHours turned into days, and Leo's determination refused to waver. He knew that the answer was close, that hidden within his calculations was the key to the tapestry's secret message. Greta stood by his side, always ready to offer support and encouragement.\n\nFinally, after countless sleepless nights and endless calculations, Leo arrived at the last line segment. The moment of truth had come. He examined his results, meticulously analyzing the true intersection points he had discovered along the way.\n\nLeo's heart raced as he tried to comprehend the significance of his findings. But before he could reach a conclusion, he realized that his journey had only just begun. The quest for knowledge had always been a series of never-ending mysteries, and this was no exception.\n\nSo now, dear reader, I present to you the same question that Leo faced. How many distinct true intersection points did he find among the 5000 line segments?"}, {"id": 168, "euler_id": 168, "title": "Number Rotations", "problem": "Consider the number 142857. We can right-rotate this number by moving the last digit (7) to the front of it, giving us 714285.\nIt can be verified that 714285=5\u00d7142857.\nThis demonstrates an unusual property of 142857: it is a divisor of its right-rotation.\nFind the last 5 digits of the sum of all integers n, 10 < n < 10100, that have this property.", "solution": "59206", "difficulty": 65, "story": "Once upon a time in the small town of Numeria, there lived a young and curious mathematician named Oliver. Oliver had always been fascinated by numbers and patterns. His days were spent exploring the infinite possibilities that lay within the realm of mathematics.\n\nOne sunny afternoon, as Oliver was delving deeper into a complex mathematical problem, he stumbled upon something intriguing. It was a cryptic message written in an ancient code, hidden within the pages of an old book he had stumbled upon at the local library.\n\nIntrigued, Oliver deciphered the code and discovered that it held a mathematical secret. The message revealed a peculiar property of a particular number: 142857. According to the message, this number had the extraordinary ability to be a divisor of its own right-rotation.\n\nOliver's mind raced with excitement. He immediately set out to investigate this magical property of 142857. As he dove into hours of calculations and analyses, he realized the immense significance of this discovery. It had the potential to revolutionize the world of mathematics!\n\nEager to unravel the full scope of this mystery, Oliver poured over countless equations and engaged in lengthy discussions with fellow mathematicians. Through his extensive efforts, he managed to uncover additional numbers that shared this exclusive property. These numbers became known as \"Right-Rotational Divisors.\"\n\nMonths turned into years, and Oliver dedicated himself completely to this newfound fascination. He examined countless mathematical scenarios, making strides in understanding the nature of these unique numbers. \n\nOne day, after years of tireless exploration, Oliver made a groundbreaking breakthrough. Through extensive calculations, he had determined that there existed a sum of all the integers between 10 and 10^100 that possessed this mysterious property. The answer to this mathematical puzzle lay in the last five digits of that sum.\n\nHolding his breath in anticipation, Oliver began to calculate the sum. The numbers grew exponentially, but his passion fueled his dedication. The sum grew larger and larger, as Oliver's excitement grew in harmony with each passing digit.\n\nAs Oliver got closer to determining the solution, a shiver ran down his spine. He realized that he was on the cusp of a mathematical revelation that could change the course of history. The answer lay just at the tip of his fingers.\n\nBut, dear reader, can you solve this perplexing puzzle? What are the last five digits of that magnificent sum of numbers? Is there a hidden pattern within the calculation that can lead you to the answer? The fate of the mathematical world rests in your hands.\n\nThe story of Oliver and his pursuit of the truth continues, even as you contemplate the possibility of resolving this mathematical enigma."}, {"id": 171, "euler_id": 171, "title": "Finding numbers for which the sum of the squares of the digits is a square", "problem": "For a positive integer n, let f(n) be the sum of the squares of the digits (in base 10) of n, e.g.\nf(3) = 32 = 9,\nf(25) = 22 + 52 = 4 + 25 = 29,\nf(442) = 42 + 42 + 22 = 16 + 16 + 4 = 36\nFind the last nine digits of the sum of all n, 0 < n < 1020, such that f(n) is a perfect square.", "solution": "142989277", "difficulty": 65, "story": "Once upon a time, in the quiet town of Mathville, lived a young girl named Lily. Lily had always been fascinated by numbers, equations, and the mysteries that they held. While her friends spent their days playing outside, Lily immersed herself in her endless collection of math books.\n\nOne sunny afternoon, as she sat in her room crunching numbers, Lily stumbled upon a peculiar mathematical problem. The words on the page captivated her imagination, and she became determined to solve it.\n\n\"For a positive integer n, let f(n) be the sum of the squares of the digits (in base 10) of n,\" the problem read. \"Find the last nine digits of the sum of all n, 0 < n < 1020, such that f(n) is a perfect square.\"\n\nIntrigued, Lily's mind swirled with possibilities. She pondered the problem, letting the numbers dance before her eyes. The concept of f(n) intrigued her. What if there existed a pattern in the sum of the squares of the digits? She knew she had to investigate further.\n\nDays turned into weeks, and weeks turned into months as Lily delved deeper into the problem. She examined the problem from various angles, experimenting with different values of n. Every day, she discovered new insights and pushed the boundaries of her mathematical prowess.\n\nLily scribbled countless equations, filling her notebook with intricate calculations. She saw patterns emerge, and her excitement grew. But with each new revelation, she found herself drawn farther away from the outside world. Lost in the beauty of numbers, she became oblivious to everything else.\n\nOne day, while searching through dusty old books at the local library, Lily stumbled upon a legend. It told of a mystical mathematician who had discovered the ultimate equation\u2014a solution to eternally surging numbers\u2014hidden somewhere in Mathville.\n\nThe legend spoke of a hidden chamber deep within the heart of Mathville, filled with ancient manuscripts and long-lost equations. But to find it, Lily would need to unravel the mysteries of f(n). The chamber's entrance would be revealed only if she could solve the mathematical problem that had consumed her life.\n\nEnergized by the prospect of unearthing the secrets of the legendary mathematician, Lily dedicated herself to unraveling the mysteries of the last nine digits of the sum of all n, where f(n) was a perfect square.\n\nShe spent sleepless nights pouring over algorithms, examining the behavior of numbers up to 1020. Lily would occasionally emerge from her mathematical cocoon, only to eat a quick meal before retreating again.\n\nWeeks turned into months, and months turned into a year. Lily's determination never wavered. Her love for numbers fueled her quest, but the solution remained just beyond her reach.\n\nAs she sat in her dimly lit room one night, surrounded by stacks of books and piles of paper, Lily felt a mix of excitement and frustration. She had exhausted every avenue, solve her nagging mathematical problem. The last nine digits of the sum of all n, where f(n) was a perfect square, eluded her. But she couldn't give up now, not after coming this far. \n\nWith a surge of determination, she resolved to embark on a final journey. She would travel through Mathville, seeking guidance from the wisest mathematicians of the land. Perhaps, hidden within the walls of libraries or etched into the annals of history, lay the key to her solution.\n\nSo, dear reader, I leave you with this question: Can you find the last nine digits of the sum of all n, 0 < n < 1020, such that f(n) is a perfect square? Will you uncover the solution that has stumped a young girl in her quest for mathematical enlightenment? The answer lies within the realms of numbers, waiting to be discovered."}, {"id": 196, "euler_id": 196, "title": "Prime triplets", "problem": "Build a triangle from all positive integers in the following way:\n\u00a01\n\u00a02\u00a0 3\n\u00a04\u00a0\u00a05\u00a0\u00a06\n\u00a07\u00a0\u00a08\u00a0\u00a09 1011 12 13 14 15\n16 17 18 19 20 21\n22 23 24 25 26 27 2829 30 31 32 33 34 35 3637 38 39 40 41 42 43 44 45\n46 47 48 49 50 51 52 53 54 55\n56 57 58 59 60 61 62 63 64 65 66\n. . .\nEach positive integer has up to eight neighbours in the triangle.\nA set of three primes is called a prime triplet if one of the three primes has the other two as neighbours in the triangle.\nFor example, in the second row, the prime numbers 2 and 3 are elements of some prime triplet.\nIf row 8 is considered, it contains two primes which are elements of some prime triplet, i.e. 29 and 31.\nIf row 9 is considered, it contains only one prime which is an element of some prime triplet: 37.\nDefine S(n) as the sum of the primes in row n which are elements of any prime triplet.\nThen S(8)=60 and S(9)=37.\nYou are given that S(10000)=950007619.\nFind \u00a0S(5678027) + S(7208785).", "solution": "322303240771079935", "difficulty": 65, "story": "Once upon a time, in the small village of Numeria, lived a young girl named Lily. She had always been fascinated with numbers. The villagers often sought her help when it came to solving mathematical problems, and she never failed to impress them with her brilliance. Lily had a talent for unraveling the mysteries hidden within the realm of numbers.\n\nOne day, while exploring the village library, Lily stumbled upon an ancient book filled with intriguing mathematical puzzles. As she flipped through the pages, a particular problem caught her attention. It was called \"The Triangle of Primes.\"\n\nThe problem stated that there was a special triangle built using positive integers. Every number had up to eight neighbors in the triangle. If a set of three prime numbers formed a prime triplet, where one of the primes had the other two as neighbors in the triangle, it was said to be a special set. The task was to find the sum of the prime numbers in a specific row of the triangle that formed any prime triplet.\n\nLily's curiosity was piqued. She had never encountered such a complex problem before. Enthralled by the challenge, she embarked on a journey to solve it.\n\nDays turned into weeks, and weeks turned into months, but Lily remained undeterred. She spent countless hours submerged in a sea of numbers, connecting the dots and unraveling the hidden patterns of the triangle. Through her determination and unyielding spirit, she made remarkable progress.\n\nAs Lily delved deeper into the problem, she realized that it held the key to unlocking the secrets of the prime numbers. The triangle intertwined the beauty of mathematics with the enigma of prime numbers, and Lily was determined to solve it. She knew that within those elusive prime triplets lay the answers to greater mathematical wonders.\n\nThe people of Numeria were captivated by Lily's pursuit of knowledge. They marveled at her dedication and wondered what secrets the triangle held. Friends and neighbors eagerly gathered to witness her progress and cheer her on. Lily had unknowingly become a symbol of hope and inspiration for those who yearned for knowledge.\n\nFinally, after tireless days and sleepless nights, Lily made a breakthrough. She discovered the sum of the prime numbers in a particular row of the triangle, which formed prime triplets. The villagers rejoiced at her success, but their celebrations were cut short when they realized the implications of her findings.\n\nThe sum she calculated was tremendous\u2014an astronomical number that held vast significance. Astonishingly, Lily found that S(10000) equaled 950007619. The magnitude of this number now left everyone puzzled. What was the significance of such a colossal sum?\n\nAs the villagers gathered around, contemplating the implications, Lily's eyes sparkled with excitement. She knew that the answer lied hidden within another mystery\u2014within the row numbers 5678027 and 7208785. With her unparalleled knowledge and unwavering determination, she could unlock the secrets these rows held. But she needed help.\n\nLily turned to her fellow villagers and saw a shimmer of curiosity in their eyes. She posed a challenge to them, an invitation to join her quest. In her voice full of hope and excitement, she exclaimed, \"Who among you will help me unveil the wonders hidden within S(5678027) + S(7208785)?\"\n\nThe villagers paused, consumed by the question. Will you be the one to help Lily solve the enigma of the Triangle of Primes? What secrets lie within the sum of these two rows? The story continues, waiting for those who dare to embark on this mathematical journey."}, {"id": 200, "euler_id": 200, "title": "Find the 200th prime-proof sqube containing the contiguous sub-string \"200\"", "problem": "We shall define a sqube to be a number of the form, p2q3, where p and q are distinct primes.\nFor example, 200 = 5223 or 120072949 = 232613.\nThe first five squbes are 72, 108, 200, 392, and 500.\nInterestingly, 200 is also the first number for which you cannot change any single digit to make a prime; we shall call such numbers, prime-proof. The next prime-proof sqube which contains the contiguous sub-string \"200\" is 1992008.\nFind the 200th prime-proof sqube containing the contiguous sub-string \"200\".", "solution": "229161792008", "difficulty": 65, "story": "Once upon a time, in the mystical land of Arithmia, there lived a brilliant mathematician named Professor Euler. He spent his days exploring the depths of mathematics, discovering new formulas, and solving puzzles that seemed impossible to others.\n\nOne day, as Professor Euler was sitting in his study, his eyes caught sight of a ancient manuscript. The manuscript had been passed down through generations, and it contained many cryptic messages and mysterious equations. Intrigued, Professor Euler began to decipher the hidden knowledge locked within its pages.\n\nAs he delved deeper into the ancient text, one problem caught his attention: the concept of \"squbes.\" The problem stated that a sqube was a number of the form p^2 * q^3, where p and q were distinct primes. Professor Euler was fascinated by this idea, as it introduced a unique way to connect prime numbers.\n\nDriven by his insatiable curiosity, Professor Euler started exploring squbes, making calculations, and unraveling patterns. He found that the first five squbes were 72, 108, 200, 392, and 500. He marveled at the beauty of these numbers and the relationship they shared with distinct primes.\n\nHowever, something even more intriguing caught Professor Euler's attention. The problem stated that 200 was the first number that couldn't be transformed by changing a single digit into a prime, making it \"prime-proof.\" This discovery fascinated him, and he became determined to find the next prime-proof sqube that contained the contiguous sub-string \"200\".\n\nDays turned into weeks, and Professor Euler immersed himself in his research. He tirelessly searched for this elusive number that would continue the sequence of prime-proof squbes with the sub-string \"200.\" He scribbled equations on chalkboards, stayed awake through countless nights, and tried every approach imaginable, but the answer eluded him.\n\nAs his frustration grew, Professor Euler considered giving up. But then he remembered the words of one of his mentors, who always taught him to see the beauty in the journey of discovery, rather than just the destination.\n\nWith renewed determination, Professor Euler set out on a quest across the land of Arithmia. He sought the guidance of fellow mathematicians, visited ancient libraries, and consulted legendary scholars. Their discussions often revolved around the mysterious nature of prime-proof squbes and the challenge of finding the 200th one containing the sub-string \"200\".\n\nNow, as the story comes to a close, dear reader, I must ask you a question. Can you solve the mathematical problem that consumed Professor Euler's life? Can you find the 200th prime-proof sqube that contains the contiguous sub-string \"200\"? May your mind be sharp and your calculations precise, for the answer lies within the realm of mathematics itself."}, {"id": 201, "euler_id": 201, "title": "Subsets with a unique sum", "problem": "For any set A of numbers, let sum(A) be the sum of the elements of A.\nConsider the set B = {1,3,6,8,10,11}. There are 20 subsets of B containing three elements, and their sums are:\n\nsum({1,3,6}) = 10,\nsum({1,3,8}) = 12,\nsum({1,3,10}) = 14,\nsum({1,3,11}) = 15,\nsum({1,6,8}) = 15,\nsum({1,6,10}) = 17,\nsum({1,6,11}) = 18,\nsum({1,8,10}) = 19,\nsum({1,8,11}) = 20,\nsum({1,10,11}) = 22,\nsum({3,6,8}) = 17,\nsum({3,6,10}) = 19,\nsum({3,6,11}) = 20,\nsum({3,8,10}) = 21,\nsum({3,8,11}) = 22,\nsum({3,10,11}) = 24,\nsum({6,8,10}) = 24,\nsum({6,8,11}) = 25,\nsum({6,10,11}) = 27,\nsum({8,10,11}) = 29.\nSome of these sums occur more than once, others are unique.\nFor a set A, let U(A,k) be the set of unique sums of k-element subsets of A, in our example we find U(B,3) = {10,12,14,18,21,25,27,29} and sum(U(B,3)) = 156.\nNow consider the 100-element set S = {12, 22, ... , 1002}.\nS has 100891344545564193334812497256 50-element subsets.\nDetermine the sum of all integers which are the sum of exactly one of the 50-element subsets of S, i.e. find sum(U(S,50)).", "solution": "115039000", "difficulty": 65, "story": "Once upon a time in the bustling village of Mathville, there lived a young and curious girl named Lily. Her mind was filled with endless questions and her heart craved adventure. Every day, Lily would explore the village and its enchanted surroundings, hoping to stumble upon something extraordinary.\n\nOne sunny morning, as she wandered through the colorful gardens of the Mathville Academy, she stumbled upon a peculiar wooden box hidden beneath a bed of flowers. Intrigued, Lily cautiously opened the box to uncover a beautifully scripted note and a small stack of numbers.\n\nThe note beckoned Lily to solve a fascinating mathematical problem. With her eyes fixed on the words, she began reading aloud, \"For any set A of numbers, let sum(A) be the sum of the elements of A.\"\n\nAs the wind gently ruffled her hair, Lily's imagination whisked her away into a realm where numbers danced and equations shimmered. She envisioned herself as a brave mathematician, embarking on a thrilling journey to unlock the secrets hidden within the numbers inside the box.\n\nLike a seasoned treasure hunter, Lily meticulously examined the contents. The set B = {1,3,6,8,10,11} stirred her adventurous spirit. Excitement coursed through her veins as she delved deeper into the mathematical problem.\n\n\"Wow,\" she whispered to herself. \"There are a total of 20 subsets of B containing three elements, each with a unique sum.\"\n\nLily traced her finger along the handwritten sums, marveling at the patterns that emerged. The mathematical problem intrigued her, leaving her no choice but to venture further into the magical realm of numbers.\n\nGuided by the mysteries of the wooden box, Lily embarked on a quest to solve yet another mathematical problem. She discovered a 100-element set, S = {12, 22, ... , 1002}, hidden among the ancient scrolls of the Mathville library.\n\nSolving this problem posited an even greater challenge to Lily's inquisitive mind. She discovered that S had a staggering 100891344545564193334812497256 50-element subsets. Lily gasped in awe at the vastness of possibilities these numbers presented.\n\nHer mind twirled with anticipation as she imagined the many unique sums that lay hidden within the subsets. The question burned in her heart, as she tried to imagine the enormity of the numbers that would arise from sum(U(S,50)).\n\nAs the sun began to set, casting a golden hue over the village, Lily closed the box with a mixture of satisfaction and yearning. The mathematical problem had transformed her perception of the world, unveiling a captivating universe hidden behind the fa\u00e7ade of everyday life.\n\nWith the wooden box tucked safely under her arm, Lily returned to her humble abode, ready to embark on yet another incredible mathematical journey. Amidst the twinkling stars and the rustling leaves, she pondered the ultimate question that had befallen her:\n\nWhat would be the sum of all integers which are the sum of exactly one of the 50-element subsets of S? In simpler terms, could she solve sum(U(S,50))?\n\nAnd so, dear reader, in the spirit of Lily's unyielding curiosity and quest for knowledge, the question now rests upon your shoulders. Can you solve the mathematical problem that has captivated the young mathematician's heart?"}, {"id": 221, "euler_id": 221, "title": "Alexandrian Integers", "problem": "We shall call a positive integer A an \"Alexandrian integer\", if there exist integers p, q, r such that:\nA=p\u22c5q\u22c5r\nand\n1A=1p+1q+1r\nFor example, 630 is an Alexandrian integer (p=5,q=\u22127,r=\u221218).\nIn fact, 630 is the 6th Alexandrian integer,  the first 6 Alexandrian integers being: 6, 42, 120, 156, 420, and 630.\nFind the 150000th Alexandrian integer.", "solution": "1884161251122450", "difficulty": 65, "story": "Once upon a time in the bustling city of Mathematica, there lived a young mathematician named Alice. Alice had a deep passion for numbers and their hidden patterns, always seeking to uncover the mysteries they held. She was particularly enchanted by a set of integers known as Alexandrian integers.\n\nAlexandrian integers possessed a peculiar property: they could be expressed as the product of three integers, let's say p, q, and r, in such a way that 1/A equaled 1/p + 1/q + 1/r. It was a fascinating concept that had puzzled mathematicians for centuries.\n\nAlice spent countless hours trying to grasp the secrets of Alexandrian integers, poring over equations and scribbling formulas. Finally, after days and nights of relentless calculations, she had an epiphany. The key to understanding these enigmatic numbers lay in their prime factors.\n\nWith newfound determination, she decided to embark on a quest to discover the 150,000th Alexandrian integer. She packed her trusty notebook, an assortment of pens, and a large bolt of inspiration. Armed with curiosity and a thirst for knowledge, Alice set off into the sprawling realm of mathematics.\n\nShe journeyed far and wide, traversing mountains of formulas and delving into valleys of equations. Along the way, she met fellow mathematicians who offered bits of advice and encouragement. They spoke of the magic contained within the Alexandrian integers, the elegance of their patterns, and the beauty of their compositions.\n\nAs Alice reached the edge of her mental map, she stumbled upon a hidden chamber buried deep within an ancient library. The air crackled with an electrifying energy as she peered into the dimly lit room. There, she discovered a dusty tome adorned with intricate symbols and equations\u2014a treasure trove of Alexandrian secrets.\n\nFeverishly flipping through the pages, Alice's eyes widened with each revelation. She marveled at the countless Alexandrian integers that graced the ancient text. The sheer magnitude of their existence overwhelmed her, but she refused to back down.\n\nThe young mathematician immersed herself in the depths of the tome, letting the numbers weave a tapestry of precision around her mind. The more she understood, the closer she felt to the essence of the mysterious Alexandrian integers. It was as if she could almost touch the enigmatic digits that danced on the pages before her.\n\nDays turned into weeks, weeks into months, and still, Alice persisted. She reveled in the thrill of unlocking each new secret, inching ever closer to the elusive 150,000th Alexandrian integer. She pondered the patterns, dissected the formulas, and crafted intricate equations in her quest for the ultimate solution.\n\nNow, dear reader, I leave you with a question. Can you find the 150,000th Alexandrian integer? Amidst the vast tapestry of numbers and equations, will you be the one to unravel the enchanting mystery hidden within its digits?"}, {"id": 226, "euler_id": 226, "title": "A Scoop of Blancmange", "problem": "The blancmange curve is the set of points (x,y) such that 0\u2264x\u22641 and y=\u2211n=0\u221es(2nx)2n, where s(x) is the distance from x to the nearest integer.\nThe area under the blancmange curve is equal to \u00bd, shown in pink in the diagram below.\n\n\nLet C be the circle with centre (14,12) and radius 14, shown in black in the diagram.\nWhat area under the blancmange curve is enclosed by C?Give your answer rounded to eight decimal places in the form 0.abcdefgh", "solution": "0.11316017", "difficulty": 65, "story": "Once upon a time, in a quaint little village called Mathlandia, there lived a young girl named Lily. Lily had always been fascinated with numbers and patterns. While most children her age played outside, Lily could be found in her room, poring over mathematical puzzles and equations.\n\nOne sunny afternoon, as she was working on her latest puzzle, Lily stumbled upon an intriguing mathematical problem called the \"blancmange curve.\" It was a curve defined by an infinite series and had a peculiar shape. The more she read about it, the more enchanted she became.\n\nThe problem described an area under the blancmange curve which equaled to exactly half. Lily imagined this area as an enchanted land hidden within the boundaries of her village. She dreamed of exploring it, but she knew she needed something more.\n\nIt was then that Lily remembered something her grandmother had once told her. \"Lily, never underestimate the power of imagination and determination,\" she used to say. \"If you truly believe in something, it will find its way to you.\"\n\nInspired by her grandmother's words, Lily decided to set out on an adventure to find the area enclosed by the blancmange curve. She gathered her compass, her notebook filled with calculations, and embarked on a journey through the narrow streets of Mathlandia.\n\nShe walked for days, following the formula to find the enchanted land hidden beneath the curve. Along the way, she met peculiar characters who guided her with their wisdom. Geometry gurus explained the intricacies of shapes, while algebraic wizards shared their knowledge of formulas.\n\nFinally, after what seemed like an eternity, Lily found herself standing at the edge of a magnificent garden. The grass was vibrant green, and colorful flowers bloomed everywhere. But what caught her attention was a perfect circle at the heart of the garden.\n\nLily approached the circle with curiosity. It was a beautiful, black circle with its center located at (14,12) and a radius of 14. It reminded Lily of her grandmother's comforting presence.\n\nWith a sudden realization, Lily recognized that the circle, C, and the area under the blancmange curve were intertwined. The enchanted land she sought was somehow connected to the circle before her.\n\nBut how? Lily pondered this question, her imagination running wild with possibilities. Was there a hidden code within the circle? Or was it the key that unlocked the entrance to the fabled land under the blancmange curve?\n\nNow, dear reader, I invite you to join Lily in her quest. Can you solve the mystery of the area under the blancmange curve enclosed by the circle, C? What enchanting secrets lie within this realm of numbers and shapes?\n\nTake a moment to let your own imagination soar, and find the answer to this captivating mathematical problem."}, {"id": 227, "euler_id": 227, "title": "The Chase", "problem": "The Chase is a game played with two dice and an even number of players.\nThe players sit around a table and the game begins with two opposite players having one die each. On each turn, the two players with a die roll it.\nIf the player rolls 1, then the die passes to the neighbour on the left.\nIf the player rolls 6, then the die passes to the neighbour on the right.\nOtherwise, the player keeps the die for the next turn.\nThe game ends when one player has both dice after they have been rolled and passed; that player has then lost.\nIn a game with 100 players, what is the expected number of turns the game lasts?\nGive your answer rounded to ten significant digits.", "solution": "3780.618622", "difficulty": 65, "story": "Once upon a time in the bustling town of Numerica, there was an annual tradition that brought all the locals together - a game called \"The Chase.\" This game, played with two dice and an even number of players, was unlike any other. It was a test of strategy, cunning, and luck. And this year, the stakes were higher than ever before.\n\nIn the heart of Numerica stood a grand dining hall, where the game would take place. The walls were adorned with paintings of famous mathematicians and the chandeliers sparkled with a thousand crystals. Tonight, 100 players had gathered, each hoping to emerge victorious.\n\nThe players took their seats around a large circular table. As they settled in, they couldn't help but feel the excitement crackling in the air. The game was about to begin, and they were eager to demonstrate their skills.\n\nThe host, Professor Magnus, stood at the head of the table. He was a renowned mathematician and the mastermind behind this extraordinary game. With a mischievous twinkle in his eye, he explained the rules to the eager participants.\n\n\"The Chase, my dear players, is a game of chance and strategy,\" Professor Magnus announced. \"We shall begin with two opposite players holding one die each. On each turn, these players will roll their dice. If a player rolls a 1, the die will pass to their neighbor on the left. But if they roll a 6, it will pass to the right. And if their rolls do not result in a 1 or a 6, they shall keep the die for their next turn. The game continues until one player ends up with both dice after they have been rolled and passed. And that player, my friends, shall be the unfortunate loser.\"\n\nAs the game commenced, the players took turns rolling the dice, their eyes following the fate of the small cubes. Laughter filled the air as the dice bounced across the table, changing hands and creating alliances in their wake.\n\nAmong the participants was a young girl named Lily. She was a prodigy in mathematics and was determined to win, despite being the youngest and least experienced player at the table. Lily observed the game unfolding, analyzing each roll with a keen eye.\n\nAs the rounds went by, Lily noticed a pattern emerging. The dice often rolled to the left, with players frequently passing them to their neighbors in that direction. It seemed that the number 1 had a preference for the left side of the table.\n\nLily's curiosity grew, and with each passing turn, she scribbled calculations and diagrams on a notepad, trying to unravel the mystery. The other players noticed her intensity, but they dismissed it as the typical fascination of a child.\n\nHowever, Lily was onto something significant. The puzzle of \"The Chase\" intrigued her, and she couldn't help but wonder - what was the expected number of turns the game would last?\n\nAs the hours ticked by, Lily's calculations became more precise and her predictions more accurate. She could now estimate the probable number of turns it would take for a player to lose both dice. The answer hovered on the tip of her tongue, but she yearned for confirmation.\n\nFinally, after countless rolls and nail-biting suspense, the game reached its climax. Two players remained, locked in a battle of wit and chance. Lily watched, her heart pounding, as the dice danced between the final contenders.\n\nAnd then, in a rapid succession of rolls and passes, one player emerged victorious. The other, now empty-handed, was declared the loser. The dining hall erupted in applause and cheers, drowning out the question that burned in Lily's mind.\n\nAs the players dispersed, Lily clutched her notepad tightly. She vowed to find the answer, to uncover the expected number of turns the game had lasted. For deep within her mathematical mind, she understood that this puzzle held secrets waiting to be discovered.\n\nAnd so, dear reader, I ask you now: What is the expected number of turns the game \"The Chase\" lasted? Will you tread the path of Lily, seeking the hidden truth behind this complex game of chance? The answer lies before you, waiting to be unveiled."}, {"id": 232, "euler_id": 232, "title": "The Race", "problem": "Two players share an unbiased coin and take it in turns to play The Race.\nOn Player 1's turn, the coin is tossed once. If it comes up Heads, then Player 1 scores one point; if it comes up Tails, then no points are scored.\nOn Player 2's turn, a positive integer, T, is chosen by Player 2 and the coin is tossed T times. If it comes up all Heads, then Player 2 scores 2T\u22121 points; otherwise, no points are scored.\nPlayer 1 goes first and the winner is the first to 100 or more points.\nPlayer 2 will always selects the number, T, of coin tosses that maximises the probability of winning.\nWhat is the probability that Player 2 wins?\nGive your answer rounded to eight decimal places in the form 0.abcdefgh.", "solution": "0.83648556", "difficulty": 65, "story": "Once upon a time, in a small village nestled on the outskirts of a vast forest, there lived two best friends named Oliver and Lily. They were inseparable and spent their days exploring the woods, climbing trees, and engaging in friendly competitions.\n\nOne sunny afternoon, as they were lounging by a babbling brook, Oliver pulled out a coin from his pocket and flashed a mischievous smile. \"Lily, I challenge you to a game. I call it The Race!\"\n\nCuriosity sparkled in Lily's eyes as she asked, \"What's that?\"\n\nOliver explained the rules of The Race. \"We'll share this unbiased coin and take turns tossing it. On my turn, if it lands on Heads, I score one point. If it lands on Tails, no points are awarded. On your turn, you get to choose a positive integer, T, and toss the coin T times. If it lands on all Heads, you score 2T - 1 points. If it doesn't, no points are given. The first one to reach 100 points wins!\"\n\nLily pondered for a moment, scanning the forest as if searching for inspiration. \"I'm in. But how do we determine who goes first?\"\n\nOliver grinned and said, \"Let's have a quick game of rock-paper-scissors!\" They held their hands out and matched their palms against each other. Oliver's rock beat Lily's scissors, making him the first player.\n\nOliver eagerly took the coin and tossed it high into the air. Heads. He earned his first point, much to his delight. Lily, ever the strategist, studied the coin before formulating her plan. She realized that winning depended on her ability to maximize her chances during each turn.\n\nThe next time it was Lily's turn, she contemplated her options. Should she choose a high number of tosses, maximizing her potential points, but also risking failure? Or should she play it safe with fewer tosses?\n\nWith her mathematical mind at work, Lily carefully calculated her odds. She knew she had to select the number of tosses, T, that would maximize her probability of winning. She thought of various strategies, trying to find the perfect balance between risk and reward.\n\nAs the days turned into weeks, Oliver and Lily played The Race relentlessly, both determined to emerge victorious. Lily's analytical nature guided her decisions, and she began to dominate the game. Oliver, albeit frustrated by his repeated losses, marveled at Lily's seemingly innate ability to choose the optimum number of tosses.\n\nTheir games evolved into a blend of skill and chance, intertwined with Lily's strategic calculations. Their friends watched in awe, wondering how Lily always managed to outsmart Oliver at every turn.\n\nOne day, as the sun cast a golden glow over the forest, Oliver paused the game and looked at Lily. \"How do you do it, Lily? How do you always know the perfect number of tosses to maximize your chances?\"\n\nLily smiled, her eyes twinkling with the joy of discovery. \"It's all about probability, Oliver. By choosing the number of tosses that gives me the highest probability of landing all Heads, I increase my chances of winning. It's a math problem, you see. What do you think the probability that I win is?\"\n\nAs Oliver pondered Lily's question, he couldn't help but appreciate the beauty of their game\u2014the melding of strategy, probability, and friendship. The time spent in the forest had taught them so much more than just how to win or lose. It had taught them the importance of analyzing situations, making calculated decisions, and embracing the challenges that life presented.\n\nSo, dear reader, as Oliver contemplates the probability, I pose the same question to you. What is the probability that Lily wins The Race?"}, {"id": 239, "euler_id": 239, "title": "Twenty-two Foolish Primes", "problem": "A set of disks numbered 1 through 100 are placed in a line in random order.\nWhat is the probability that we have a partial derangement such that exactly 22 prime number discs are found away from their natural positions?\n(Any number of non-prime disks may also be found in or out of their natural positions.)\nGive your answer rounded to 12 places behind the decimal point in the form 0.abcdefghijkl.", "solution": "0.001887854841", "difficulty": 65, "story": "Once upon a time in the bustling city of Numerica, there lived a quirky mathematician named Professor Fibonacci. With a mind teeming with numbers, he spent his days pondering math problems, searching for patterns, and delving into complex equations. Professor Fibonacci was known far and wide for his genius, but little did people know that his true gift lay in unraveling the secrets of the unseen.\n\nOne fateful day, as the professor sat in his cozy study filled to the brim with books, scrolls, and mathematical instruments, a mysterious letter arrived in a flurry of emerald green feathers. Curiosity piqued, he carefully unsealed the envelope and began to read.\n\n\"Dear Professor Fibonacci,\n\nWe are in desperate need of your extraordinary mathematical abilities. Our city, Numerica, is facing a peculiar phenomenon. It appears that a heinous act of mischief has taken place among a set of disks numbered 1 through 100. These disks have been scattered randomly and placed in a line, bringing chaos and confusion to our once harmonious city. As the custodian of Numerica's numerical integrity, we implore you to solve this enigma.\n\nThe heart of the matter lies in the probability of a partial derangement within this line of disks. We seek to determine the likelihood that exactly 22 prime number discs are found away from their natural positions. While any number of non-prime disks may also be found in or out of their natural positions, it is crucial to identify the pivotal position of the primes.\n\nWe hope you will accept this challenge and restore order to Numerica, for the balance of our world relies on your expertise.\n\nSincerely,\nThe Council of Numerica\"\n\nIntrigued by the enigmatic problem presented before him, Professor Fibonacci put on his thinking cap and set to work immediately. He shuffled through his piles of papers, scribbling complex equations, and mapping out probabilities. The entire city seemed to hold its breath as the professor dove deep into the depths of his calculations.\n\nDays turned into weeks, and still, Professor Fibonacci was consumed by his quest. Anything remotely resembling a clue was dissected fervently until he found himself immersed within a sea of numbers, theories, and diagrams. Finally, after days of tireless searching, his vision blurred from pouring over page after page of calculations, he discovered the answer.\n\nThe solution held the key to unraveling the mystery, a glimmer of insight that would guide Numerica back to order and harmony. But the professor wondered, would the council accept his findings? Or would they require further proof of his mathematical prowess? Professor Fibonacci decided the best approach would be to present his solution in person, allowing his passion and deep understanding to convince them.\n\nWith newfound determination, he packed his bags and embarked on a journey to Numerica's grand city hall. The streets teemed with people, whispering rumors of the professor's imminent arrival. The council waited in anticipation.\n\nAs he entered the grand chamber, the council members gathered around, their faces a tapestry of hope and skepticism. The professor took a deep breath, his voice rising with excitement.\n\n\"Ladies and gentlemen of Numerica, I present to you my solution. After countless hours of calculations, I have determined the probability that exactly 22 prime number discs are found away from their natural positions.\"\n\nThe room fell silent as everyone waited with bated breath to hear Professor Fibonacci's revelation. But just as he was about to disclose his answer, a startling thought struck him. Would revealing the solution to this intricate mathematical problem truly restore harmony to Numerica? Or was there a greater purpose hidden within this riddle?\n\nAnd so, instead of revealing the answer outright, Professor Fibonacci paused and posed a question to the council and the people of Numerica.\n\n\"What is the probability that we have a partial derangement such that exactly 22 prime number discs are found away from their natural positions?\"\n\nThe question hung in the room, swirling with possibilities and unknowns. The council and the people of Numerica gasped and exchanged confused glances. It was now up to them to determine the probability that would bring unity and peace back to their beloved city.\n\nAnd so, dear reader, as Numerica faces its greatest mathematical challenge, the destiny of the city lies in your hands. Can you crack the code and uncover the answer that will bring order to numerical chaos?"}, {"id": 247, "euler_id": 247, "title": "Squares under a hyperbola", "problem": "Consider the region constrained by 1 \u2264 x and 0 \u2264 y \u2264 1/x.\n\nLet S1 be the largest square that can fit under the curve.\nLet S2 be the largest square that fits in the remaining area, and so on. \nLet the index of Sn be the pair (left, below) indicating the number of squares to the left of Sn and the number of squares below Sn.\n\n\n\n\nThe diagram shows some such squares labelled by number. \nS2 has one square to its left and none below, so the index of S2 is (1,0).\nIt can be seen that the index of S32 is (1,1) as is the index of S50. \n50 is the largest n for which the index of Sn is (1,1).\n\n\nWhat is the largest n for which the index of Sn is (3,3)?\n", "solution": "782252", "difficulty": 65, "story": "Once upon a time, in the mysterious land of Numerialia, there resided a clever young girl named Lily. Lily had a deep fascination with numbers and patterns, always seeking the next great mathematical mystery to unravel. Her favorite place to ponder these mysteries was in the enchanting Numerial Forest.\n\nOne sunny day, as Lily sat beneath the shade of a large oak tree in the forest, she noticed a peculiar trail of squares etched into the ground. They were arranged in a unique pattern that seemed to follow a mathematical rule. Curiosity sparked within her, and she decided to embark on a thrilling adventure to uncover the secret behind these squares.\n\nFollowing the trail, Lily ventured deep into the heart of the forest, navigating through thick underbrush and scaling rocky cliffs. After what felt like an eternity, she stumbled upon an ancient library nestled within a hidden clearing. A towering statue of an old mathematician guarded the entrance, holding a scroll tightly clutched in his outstretched hand.\n\nLily approached the statue, her heart pounding with anticipation. Plucking the scroll from the statue's grasp, she unrolled it carefully, revealing a perplexing mathematical problem:\n\n\"Consider the region constrained by 1 \u2264 x and 0 \u2264 y \u2264 1/x.\n\nLet S1 be the largest square that can fit under the curve.\nLet S2 be the largest square that fits in the remaining area, and so on. \nLet the index of Sn be the pair (left, below) indicating the number of squares to the left of Sn and the number of squares below Sn.\n\nThe diagram shows some such squares labeled by number. \nS2 has one square to its left and none below, so the index of S2 is (1,0).\nIt can be seen that the index of S32 is (1,1) as is the index of S50.\n50 is the largest n for which the index of Sn is (1,1).\n\nWhat is the largest n for which the index of Sn is (3,3)?\"\n\nLily's excitement grew exponentially as she realized that the squares she had been following through the forest were intricately linked to this mathematical problem. This was an opportunity to put her skills to the test and solve the unsolved!\n\nDetermined, Lily studied the diagram on the scroll, tracing the squares with her finger. As the sun began to set, painting the sky in vibrant hues of gold and purple, she scribbled down countless calculations, exploring the properties of the squares. The forest around her came alive with anticipation, whispering secrets and urging her forward.\n\nAs she delved deeper into the enigma, Lily realized that the squares revealed a mesmerizing pattern within their indices as they grew larger. Each square seemed to be intricately connected and dependent on the ones before it. It was like a delicate dance, orchestrated by the infinite possibilities of mathematics.\n\nDays turned into nights, and nights into days, but Lily never wavered in her pursuit. Every moment spent unraveling the mathematical tapestry brought her closer to the answer. She sketched diagrams, crunched numbers, and tested countless hypotheses, determined to solve the mystery.\n\nFinally, with the last rays of sunlight peeking through the library's ancient stained glass windows, Lily reached a breakthrough. Her eyes widened as she discovered that the largest n for which the index of Sn was (3,3) would unveil the ultimate truth hidden within the Numerial Forest.\n\nElated, Lily took a step back, savoring her triumph. Now, as she stood on the precipice of solving the enigma, she realized that it was time to embark on her final quest \u2013 to find the largest n for which the index of Sn was (3,3). But first, she needed a well-deserved rest.\n\nSo, dear reader, as Lily prepares herself for the grandest adventure of them all, can you uncover the answer to her question? What is the largest n for which the index of Sn is (3,3)?"}, {"id": 266, "euler_id": 266, "title": "Pseudo Square Root", "problem": "\nThe divisors of 12 are: 1,2,3,4,6 and 12.\nThe largest divisor of 12 that does not exceed the square root of 12 is 3.\nWe shall call the largest divisor of an integer n that does not exceed the square root of n the pseudo square root (PSR) of n.\nIt can be seen that PSR(3102)=47.\n\n\nLet p be the product of the primes below 190.\nFind PSR(p) mod 1016.\n", "solution": "1096883702440585", "difficulty": 65, "story": "Once upon a time in the quiet village of Mathland, lived a young boy named Ethan. Ethan was a curious and precocious child, with a love for numbers and a mind that constantly sought answers. Every day, he would immerse himself in the world of mathematics, exploring its intricate patterns and hidden secrets. It was through his adventures that he befriended an extraordinary old man named Professor Magnus.\n\nProfessor Magnus was revered in Mathland for his profound knowledge of numbers and his ability to solve even the most perplexing mathematical problems. The villagers often sought his guidance whenever they faced an enigma they couldn't crack. And so, one sunny morning, Ethan decided to visit the wise professor, seeking answers to a problem that had been puzzling him for quite some time.\n\nAs Ethan made his way through the meandering trails of Mathland, he couldn't help but wonder about the secret the professor would share with him. He reached Professor Magnus' quaint cottage, knocked on the door, and found himself face to face with the man known to possess the keys to numerical mysteries.\n\n\"Ah, young Ethan! I've been expecting you,\" the professor greeted him with a warm smile. \"Come on in, my boy. What brings you here today?\"\n\nEthan took a seat across from Professor Magnus and eagerly presented him with the mathematical problem that had consumed his thoughts. The professor listened attentively as Ethan explained the intriguing problem at hand.\n\n\"The divisors of 12 are: 1, 2, 3, 4, 6, and 12,\" Ethan began. \"The largest divisor of 12 that does not exceed the square root of 12 is 3. This makes it the pseudo square root (PSR) of 12. Furthermore, PSR(3102) is 47.\"\n\nProfessor Magnus furrowed his brows, deep in thought. He started to pace around the room, his eyes fixed on an ancient chalkboard covered in cryptic mathematical equations. After some contemplation, he turned to Ethan with a glimmer in his eyes.\n\n\"Ethan, my boy, you have stumbled upon a remarkable problem. But what you may not know is that behind this mathematical riddle lies a secret of utmost importance\u2014a secret that holds the very fabric of Mathland together,\" Professor Magnus said, his voice filled with awe.\n\nEthan sat up, his curiosity piqued. \"What do you mean, Professor? How can a mathematical problem hold such power?\"\n\nThe old man approached a bookshelf lined with dusty tomes, searching for a specific volume. Finally, he retrieved a worn-out book embossed with the image of a quill.\n\n\"You see, Ethan, this problem holds the key to unlocking the primal forces of prime numbers,\" Professor Magnus explained. \"It revolves around the product of the primes below 190, denoted as p. And what we seek is the PSR of p, modulo 1016.\"\n\nAs Professor Magnus continued to explain the intricacies of the problem, Ethan's eyes widened with astonishment. He realized the immense importance of the task at hand, understanding that finding the PSR of p held the potential to unravel mysteries hidden within prime numbers.\n\nTheir conversation ensued, filled with complex mathematical jargon and theory. Ethan absorbed the knowledge like a sponge, his mind expanding with each passing minute. The young boy and the wise old professor embarked upon a mathematical journey, delving deeper and deeper into the realm of numbers.\n\nAs the sun began to set, painting the sky with hues of crimson and gold, Professor Magnus smiled at Ethan. \"My young friend, I have shared with you the secrets of this mathematical puzzle. Now it is up to you to navigate the path and uncover the PSR of p, mod 1016. Do you believe you are ready?\"\n\nEthan glanced at the professor, his determination shining through his eyes. \"I am ready, Professor Magnus. I will find the solution to this enigma.\"\n\nWith a final nod, the professor bid Ethan farewell, knowing that the young boy possessed the potential to solve the mathematical problem that lay before him.\n\nAnd so, as Ethan walked back to his village, a sense of purpose ignited within him. The weight of the mathematical problem he held in his mind was now his responsibility to unravel. With every step he took, Ethan posed himself the question:\n\n\"Can I find the PSR of p, mod 1016?\"\n\nThe answer could only be discovered by exploring the realm of numbers, seeking patterns yet unseen, and unraveling the enigma that had captured the imagination of Mathland.\n\nAs the journey began, the question echoed in Ethan's mind, beckoning him to embark on an adventure into the unknown\u2014his quest to unlock the secrets of the pseud square root."}, {"id": 274, "euler_id": 274, "title": "Divisibility Multipliers", "problem": "For each integer p > 1 coprime to 10 there is a positive divisibility multiplier m < p which preserves divisibility by p for the following function on any positive integer, n:\nf(n) = (all but the last digit of n) + (the last digit of n) * m\nThat is, if m is the divisibility multiplier for p, then f(n) is divisible by p if and only if n is divisible by p.\n(When n is much larger than p, f(n) will be less than n and repeated application of f provides a multiplicative divisibility test for p.)\nFor example, the divisibility multiplier for 113 is 34.\nf(76275) = 7627 + 5 * 34 = 7797 : 76275 and 7797 are both divisible by 113f(12345) = 1234 + 5 * 34 = 1404 : 12345 and 1404 are both not divisible by 113\nThe sum of the divisibility multipliers for the primes that are coprime to 10 and less than 1000 is 39517. What is the sum of the divisibility multipliers for the primes that are coprime to 10 and less than 107?", "solution": "1601912348822", "difficulty": 65, "story": "Emma was always intrigued by numbers. From a young age, she had a fascination with mathematical patterns and problems. But her curious mind didn't stop there. Emma loved stories too \u2014 fairy tales, adventures, and mysteries that transported her to magical worlds.\n\nOne sunny afternoon, Emma was sitting in the park reading a book about numbers. As she read about prime numbers and their incredible properties, she stumbled upon a fascinating mathematical problem.\n\nShe became immersed in the story of coprime numbers and their relationship to the divisibility multiplier function. Emma's mind whirled with possibilities as she thought of all the ways the function could be used in real life.\n\nSuddenly, a gust of wind blew across the park, rustling the pages of her book. Emma looked up to see a small, elderly woman standing beside her. She had a twinkle in her eye and a mischievous smile on her face.\n\n\"You seem to have stumbled upon something interesting, my dear,\" the woman said, her voice filled with curiosity.\n\nEmma looked at the woman, intrigued by her sudden appearance. \"Yes, I came across this mathematical problem about the divisibility multiplier function. It's fascinating! I can't help but wonder how it could be applied in the real world.\"\n\nThe woman chuckled softly and motioned for Emma to follow her. They walked through the park, the woman's steps light yet determined.\n\nAs they journeyed deeper into the park, Emma noticed something peculiar. The trees seemed to grow taller and thicker, casting a magical aura that enveloped them. She looked around, her eyes wide with wonder.\n\nThe woman stopped in front of a majestic oak tree, its branches towering overhead like a protective canopy. She turned to Emma with a serious expression on her face.\n\n\"Emma, this tree holds a secret. Hidden within its roots is a portal to a world where numbers come alive,\" the woman said, placing her hand on the trunk of the tree.\n\nEmma gasped in disbelief but couldn't resist the allure of the unknown. She reached out, mirroring the woman's actions, and was instantly engulfed in a brilliant light.\n\nWhen Emma opened her eyes, she found herself in a bustling marketplace filled with artisans and traders. The air was filled with excitement and the sounds of laughter and chatter.\n\nThe elderly woman led Emma through the market, pointing out various stalls and explaining the unique role each played in this world. Emma felt a strange energy buzzing around her as if the numbers whispered their secrets in her ear.\n\nFinally, they arrived at a stall where a group of mathematicians were studying a large, ancient tome. The pages were filled with complex equations and diagrams. Emma's heart raced as she realized that the answers she sought might lie within this book.\n\nOne of the mathematicians turned to face her. His eyes widened with recognition, and he smiled warmly. \"Welcome, Emma. We've been waiting for you.\"\n\nHe explained that this hidden world was a place where ancient mathematical knowledge was preserved, and their goal was to uncover the secrets locked within the divisibility multiplier function.\n\nDays turned into weeks as Emma submerged herself in the study of numbers, drawing connections between the function and various mathematical principles. She solved puzzles, taught others, and pushed the boundaries of her own understanding.\n\nFinally, as Emma neared the end of her time in the magical world, the mathematicians called her to a grand assembly. All the scholars and mathematicians gathered around, eagerly awaiting her findings.\n\nEmma took a deep breath, her voice resonating with confidence as she shared her discoveries. The mathematicians listened intently, their faces a mix of awe and excitement.\n\nAs she finished, the entire assembly erupted into applause, impressed by Emma's dedication and breakthroughs. She had unlocked new dimensions of the divisibility multiplier function, opening doors to endless possibilities.\n\nBut as Emma stood there, basking in their admiration, a single question burned in her mind. It was the same question that had sparked her adventure and consumed her thoughts throughout her journey.\n\n\"What is the sum of the divisibility multipliers for the primes that are coprime to 10 and less than 107?\" she asked.\n\nThe room fell silent as the mathematicians exchanged knowing glances. Emma watched, anticipation building within her, as they prepared to reveal the answer to her question.\n\nBut that, my dear reader, is where our story must end. The solution to this mathematical problem is yours to discover. So I ask you, what is the sum of the divisibility multipliers for the primes that are coprime to 10 and less than 107?"}, {"id": 280, "euler_id": 280, "title": "Ant and seeds", "problem": "A laborious ant walks randomly on a 5x5 grid. The walk starts from the central square. At each step, the ant moves to an adjacent square at random, without leaving the grid; thus there are 2, 3 or 4 possible moves at each step depending on the ant's position.\nAt the start of the walk, a seed is placed on each square of the lower row. When the ant isn't carrying a seed and reaches a square of the lower row containing a seed, it will start to carry the seed. The ant will drop the seed on the first empty square of the upper row it eventually reaches.\nWhat's the expected number of steps until all seeds have been dropped in the top row? \nGive your answer rounded to 6 decimal places.", "solution": "430.088247", "difficulty": 65, "story": "Once upon a time, in a lush meadow, there lived an extraordinary ant named Arthur. Now, Arthur wasn't your typical ant. He had an insatiable curiosity and a keen mind that always craved knowledge. While his ant companions were content with a simple life of finding food and tending to their colony, Arthur yearned for something more. He wanted to explore, he wanted to discover, and he wanted to solve the mysteries of the world.\n\nOne sunny morning, as Arthur set out on his daily adventure, he found himself standing in front of a peculiar contraption. It was a 5x5 grid, made up of small wooden squares. The center square glinted with an array of colorful seeds. Intrigued, Arthur took a step forward, completely unaware of the mathematical journey that awaited him.\n\nAs he stepped onto the central square, the ground beneath him began to rumble, signaling the start of his journey. Trying to maintain his balance, Arthur walked forward, his tiny legs carrying him to an adjacent square at random. The contraption seemed to have a life of its own, offering a multitude of paths for Arthur to take.\n\nAs Arthur ventured further, he realized that each square of the lower row contained a seed. Being a responsible ant, he felt compelled to gather these precious seeds. The moment he touched a seed, a magical bond formed between Arthur and it. The seed clung to him like a loyal friend, and Arthur knew he had to carry it with him until it found its rightful place.\n\nWith each step, Arthur's anticipation grew. He had to find the perfect spot to drop the seeds. He had to solve the puzzle and unveil the secret woven within the maze of the grid. The stakes were high, for the lives of those seeds depended on him. Time passed, and the sun began its descent towards the horizon, casting a warm golden glow over the meadow.\n\nAs Arthur wandered through the labyrinthine paths of the grid, carefully carrying the seeds, he couldn't help but wonder, \"How long will it take for me to complete this journey? How many steps am I away from success?\"\n\nHis nimble mind started to ponder the possibilities, the probabilities, and the intricacies of the problem. With each passing moment, his curiosity intensified, driving him to find an answer. He knew that the fate of the seeds relied on his ability to navigate the grid efficiently.\n\nAs Arthur neared the upper row, he felt a jolt of excitement. The moment of truth was here. The moment to test his mathematical prowess had arrived. He stood at the precipice of discovery, ready to scatter the seeds to their rightful destinations on the top row.\n\nBut as Arthur looked out over the horizon of the meadow, a question tugged at his mind, refusing to let go. He turned to all those who had followed his journey, all those who were eager to witness the solution to the mathematical problem.\n\n\"What is the expected number of steps until all seeds have been dropped in the top row?\" he asked, making them realize that the answer lay within their own intellect, their own capacity to solve the mathematical enigma that had unfolded before them.\n\nAnd so, dear reader, as Arthur stood there, seeds in his grasp, ready to change the course of the meadow's destiny, the question remains: can you deduce the solution to this mathematical problem and uncover the secrets hidden within the 5x5 grid?"}, {"id": 292, "euler_id": 292, "title": "Pythagorean Polygons", "problem": "We shall define a pythagorean polygon  to be a convex polygon with the following properties:there are at least three vertices,\nno three vertices are aligned,\neach vertex has integer coordinates,\neach edge has integer length.For a given integer n, define P(n) as the number of distinct pythagorean polygons for which the perimeter is \u2264\u2009n.\nPythagorean polygons should be considered distinct as long as none is a translation of another.\nYou are given that P(4)\u2009=\u20091, P(30)\u2009=\u20093655 and P(60)\u2009=\u2009891045.\nFind P(120).", "solution": "3600060866", "difficulty": 65, "story": "Once upon a time, in the quaint little town of Pythagoria, there lived a young girl named Lily. She was known for her love of adventure and her insatiable curiosity. Lily spent most of her time exploring the forests, climbing trees, and seeking hidden treasures.\n\nOne sunny afternoon, while she was busy investigating a mysterious trail, Lily stumbled upon an ancient map. The map appeared to be centuries old, with faded markings and intricate drawings. Unfolding it carefully, Lily discovered that it held the secret to finding an elusive treasure hidden deep within the heart of the forest.\n\nWith excitement and anticipation bubbling within her, Lily followed the map's directions to a hidden clearing. As she reached the center, sunlight streamed through the foliage, illuminating a peculiar stone with etchings of polygons and strange symbols.\n\nCuriosity got the better of Lily, and she couldn't resist touching the stone. In an instant, the stone glowed brightly, enveloping Lily in a shimmering light. When it receded, she found herself standing in front of a wise old spirit named Pythago.\n\n\"Greetings, young traveler,\" Pythago spoke in a voice as ancient as time itself. \"You have awakened me from my slumber with your inquisitive touch.\"\n\nLily's heart skipped a beat. She had heard tales of the legendary Pythago, known for his vast knowledge of numbers and mathematical marvels.\n\n\"I seek the treasure hidden deep within this forest,\" Lily said with a mixture of excitement and trepidation in her voice.\n\n\"The treasure you seek is not material wealth,\" Pythago replied, his eyes twinkling. \"It lies in the realm of mathematics, in the form of Pythagorean polygons.\"\n\nLily's brow furrowed. \"Pythagorean polygons? What are those?\"\n\nPythago smiled, his long beard flowing. \"A Pythagorean polygon is a polygon that meets specific mathematical criteria. It must have at least three vertices, with no three vertices aligned. Additionally, all of its edges must have integer lengths, and each vertex must have integer coordinates.\"\n\nLily listened intently, her mind racing with questions about the treasure and its connection to Pythagorean polygons.\n\n\"For a given number n,\" Pythago continued, \"define P(n) as the number of distinct Pythagorean polygons with a perimeter less than or equal to n.\"\n\nLily's eyes widened with wonder. She couldn't help but wonder how the treasure was tied to this mathematical problem.\n\nPythago observed the spark of curiosity in Lily's eyes and explained further. \"The number of distinct Pythagorean polygons increases as n gets larger. It's a challenging puzzle waiting to be solved.\"\n\nLily's adventurous spirit reignited, fueling her determination to find the elusive treasure. She knew that to unlock the treasure's location, she had to dive deep into the world of Pythagorean polygons.\n\nThus began Lily's mathematical journey. She spent countless hours studying the properties of polygons and exploring their fascinating intricacies. She pored over books and consulted expert mathematicians, determined to crack the code.\n\nMonths turned into years, but Lily's determination never wavered. Each day brought her closer to solving the mathematical puzzle that held the key to the hidden treasure. And though she encountered hurdles and challenges along the way, her love for adventure and her thirst for knowledge continued to drive her forward.\n\nNow, dear reader, I leave you with this question: What is the value of P(120)? Can you solve the mathematical problem that will lead Lily to the long-awaited treasure?"}, {"id": 334, "euler_id": 334, "title": "Spilling the beans", "problem": "In Plato's heaven, there exist an infinite number of bowls in a straight line.\nEach bowl either contains some or none of a finite number of beans.\nA child plays a game, which allows only one kind of move: removing two beans from any bowl, and putting one in each of the two adjacent bowls. The game ends when each bowl contains either one or no beans.\nFor example, consider two adjacent bowls containing 2 and 3 beans respectively, all other bowls being empty. The following eight moves will finish the game:\n\nYou are given the following sequences:\n\n\nif\u00a0\u00a0is evenif\u00a0\u00a0is oddwhere\u00a0\u00a0is the floor function\u00a0and\u00a0is the bitwise XOR operator.t0=123456,ti={ti\u221212,if\u00a0ti\u22121\u00a0is even\u230ati\u221212\u230b\u2295926252,if\u00a0ti\u22121\u00a0is oddwhere\u00a0\u230ax\u230b\u00a0is the floor function\u00a0and\u00a0\u2295is the bitwise XOR operator.bi=(timod211)+1.\n\nThe first two terms of the last sequence are b1=289 and b2=145.\nIf we start with b1 and b2 beans in two adjacent bowls, 3419100 moves would be required to finish the game.\nConsider now 1500 adjacent bowls containing b1,b2,\u2026,b1500 beans respectively, all other bowls being empty. Find how many moves it takes before the game ends.", "solution": "150320021261690835", "difficulty": 65, "story": "Once upon a time in a village nestled amidst rolling green hills, there lived a curious and mischievous young girl named Lily. Lily had a highly active imagination and would often disappear into the woods near her home, lost in a world of whimsy. One sunny day, she stumbled upon an old, weathered book hidden beneath a moss-covered rock.\n\nAs Lily opened the book, a cloud of dust escaped its pages, and an enchanting story began to unfold. The book told the tale of Plato's heaven, a realm where countless bowls stood in a straight line, containing either a finite number of beans or nothing at all. The children in this heavenly realm engaged in a peculiar game that fascinated Lily.\n\nIn this game, the child was allowed a single move: removing two beans from any bowl and placing one in each of the two adjacent bowls. The objective was to continue playing until every bowl contained either one or no beans. The book then presented a mathematical problem, challenging the reader to determine the number of moves required in a specific scenario.\n\nLily was captivated by the riddle-like nature of the problem. She couldn't help but wonder how long it would take to complete the game if certain conditions were met. Her curious mind spun with possibilities as she started to imagine herself in Plato's heaven, playing the game alongside the other children.\n\nWith the knowledge of the problem firmly in her mind, Lily ventured into the meadow, where an ancient willow tree stood. Its gnarled branches whispered secrets to the wind, and Lily felt compelled to share her newfound knowledge with the wise tree.\n\nShe climbed the tree with determination, eager to seek answers from its ancient wisdom. The tree, known to possess mystical powers, whispered comfortingly to Lily as she presented her question. With a gentle rustle of leaves, the tree conveyed its response.\n\n\"The number of moves required depends on the sequence of beans contained within the bowls, young Lily. These beans follow a peculiar pattern, determined by mathematical equations.\"\n\nLily listened intently as the tree explained that the sequence of beans could be derived from a series of calculations. Starting with the numbers 123456, each subsequent term was dependent on the preceding term. If the previous term was even, it was halved and subjected to a bitwise XOR operation with 926252. If the previous term was odd, it was halved and the floor function was applied. Additionally, each bowl's number of beans was given by the modulus operation of the corresponding term in the sequence, plus one.\n\nWith this knowledge, Lily's mind whirled with possibilities. She could see how essential mathematical thinking was to solving the problem. The tree encouraged her curiosity and understanding, leaving her with the question of how many moves it would take to finish the game when starting with 1500 adjacent bowls, each containing beans determined by the sequence derived from the problem itself.\n\nAs the sun began to set, casting a warm glow over the meadow, Lily descended from the willow tree with a newfound determination. She knew that solving the problem required careful calculations and astute observations. With the allure of Plato's heaven still captivating her thoughts, Lily set off on a journey of intellectual exploration, eager to unlock the puzzle hidden in the pages of her ancient book.\n\nAnd so, dear reader, the question remains: How many moves would it take for Lily to finish the game using 1500 adjacent bowls, each containing beans determined by the sequence provided?"}, {"id": 335, "euler_id": 335, "title": "Gathering the beans", "problem": "Whenever Peter feels bored, he places some bowls, containing one bean each, in a circle. After this, he takes all the beans out of a certain bowl and drops them one by one in the bowls going clockwise. He repeats this, starting from the bowl he dropped the last bean in, until the initial situation appears again. For example with 5 bowls he acts as follows:\n\nSo with 5 bowls it takes Peter 15 moves to return to the initial situation.\nLet M(x) represent the number of moves required to return to the initial situation, starting with x bowls. Thus, M(5) = 15. It can also be verified that M(100) = 10920.\nFind \u2211k=01018M(2k+1). Give your answer modulo 79.", "solution": "5032316", "difficulty": 65, "story": "Peter was a curious young boy with a love for puzzles and mysteries. He was always on the lookout for something challenging to keep his mind occupied. One sunny afternoon, as he sat in his backyard, he wondered how he could create his own puzzle using objects he had readily available. That's when he came across a bag of colorful beans sitting on a shelf.\n\nPeter's eyes lit up with excitement as he grabbed the bag of beans. He knew he could use them to create an intriguing puzzle. He carefully poured the beans onto the table, count them one by one. There were twelve beans in total, and that was the perfect number to start his puzzle.\n\nHe placed the twelve beans in a circle on a large wooden tray. Each bean occupied its own little bowl, carefully arranged in a clockwise fashion. As he stared at his creation, Peter pondered how he could manipulate the beans to create an intricate pattern.\n\nAfter a moment of contemplation, an idea struck Peter's mind. He reached for a small wooden stick and started moving the beans in a specific order. He would take all the beans out of a particular bowl and drop them one by one in the bowls, going clockwise.\n\nPeter repeated this process, starting from the bowl where he had dropped the last bean, until the initial arrangement reappeared. The challenge was to determine how many moves it would take for the beans to return to their starting positions. For twelve bowls, this seemed like a difficult task.\n\nWith a determined expression on his face, Peter set out to solve the puzzle he had created. He meticulously moved the beans around, calculating the number of moves in his head. As he progressed, he realized that it was taking quite some time to complete the pattern.\n\nDays turned into weeks, and weeks turned into months. Peter tirelessly continued his endeavor, eager to crack the puzzle he had so ingeniously created. He was determined to find the number of moves it would take for the twelve beans to return to their starting positions.\n\nAs he moved closer to a solution, Peter's excitement grew. He knew that the answer would not only solve his puzzle but also unlock new doors of understanding in the vast world of mathematics. And so, he pressed on, diligently counting each move and documenting his progress.\n\nFinally, after what seemed like an eternity, Peter's hard work paid off. He found the answer. It took him exactly 95 moves for the twelve beans to return to their starting positions. Triumphantly, he jotted down the result in his notebook.\n\nEcstatic with this newfound knowledge, Peter couldn't wait to share his puzzle with others. He wondered how different numbers of bowls would affect the number of moves needed to reach the initial arrangement. How could one determine the number of moves for any given number of bowls?\n\nWith unyielding curiosity, Peter embarked on a quest to explore this mathematical problem further. He decided to name the number of moves needed to return to the initial situation, starting with x bowls, as M(x). Peter wondered how he could find M(x) for different numbers of bowls and how it would lead him to even more thrilling mathematical possibilities.\n\nAs he delved deeper into the intricacies of the problem, Peter's world expanded. He discovered that M(5) equaled 15 and M(100) equaled 10,920. These revelations only fueled his thirst for knowledge. He couldn't help but wonder what other remarkable patterns and theories he could unravel through the lens of mathematics.\n\nAnd so, Peter's journey to unlock the mysteries of M(x) began. With every new variation of bowls and beans, he found himself immersed in a world of patterns, calculations, and endless possibilities. He challenged himself to find the sum of M(2k+1) for different values of k, all the while contemplating the remarkable mathematical beauty that lay within.\n\nAs you follow Peter's footsteps on this journey, gazing at the tray of colorful beans, you can't help but ask yourself: What is the sum of M(2k+1) when k ranges from 0 to 1018? Can you find the answer?"}, {"id": 354, "euler_id": 354, "title": "Distances in a bee's honeycomb ", "problem": "Consider a honey bee's honeycomb where each cell is a perfect regular hexagon with side length 1.\n\n\n\nOne particular cell is occupied by the queen bee.\nFor a positive real number L, let B(L) count the cells with distance L from the queen bee cell (all distances are measured from centre to centre); you may assume that the honeycomb is large enough to accommodate for any distance we wish to consider. \nFor example, B(3)=6, B(21)=12 and B(111111111)=54.\nFind the number of L\u22645\u00d71011 such that B(L)=450.", "solution": "58065134", "difficulty": 65, "story": "Once upon a time in a lush green meadow, there existed a bustling community of bees. The colony was home to thousands of worker bees, all toiling away to create the complex structure that housed their beloved queen bee. This structure was none other than a magnificent honeycomb, where each cell was a perfect regular hexagon with a side length of 1.\n\nWithin the heart of this honeycomb, one cell stood out from the rest, as it was occupied by the queen bee herself. Surrounded by her loyal subjects, she ruled with grace and wisdom, guiding the colony through their daily endeavors. It was said that the queen possessed a deep understanding of the honeycomb's intricate geometry, for she was known to weave mathematical intricacies into every aspect of her reign.\n\nOne day, an enigmatic visitor arrived at the meadow. He was a wandering mathematician, known for finding beauty within numbers and patterns. Entranced by the harmonious hum of the bees and the precision of their honeycomb, he decided to spend some time amongst them.\n\nAs the mathematician immersed himself in their world, he couldn't help but be captivated by the unique mathematical properties of the honeycomb. He discovered that each cell in the honeycomb had a specific distance from the queen bee's cell, which he denoted as L. Intrigued, he devised a function, B(L), to count the cells with distance L from the queen bee's cell. The distances were measured from center to center, ensuring utmost accuracy.\n\nWeeks turned into months, and the mathematician delved ever deeper into the honeycomb's mysteries. He found that B(L) could yield fascinating results. For instance, B(3) equaled 6, representing the six cells that lay precisely three units away from the queen bee's cell. Similarly, B(21) equaled 12, and even B(111111111) counted 54 cells. However, he couldn't help but wonder: how many values of L, less than or equal to 5\u00d710^11, returned a value of 450 for B(L)?\n\nAs the mathematician pondered this question, a newfound determination sparked within him. He resolved to find the answer and unravel the hidden complexities of the honeycomb. In his quest for knowledge, he spent countless hours documenting his findings and analyzing the patterns that emerged.\n\nWith each passing day, the glimmer of a solution seemed closer. Each new insight and revelation brought him closer to unlocking the secrets of the honeycomb. And within these revelations lay the potential to change the way humans understood the intricate connections between mathematics and nature. The honeycomb became a metaphor for the delicate balance of precision and beauty that governed the world.\n\nThe story of the mathematician and the honeycomb would forever remain etched in the annals of bee folklore. But as we delve into this sweet tale, we leave you with one final question: How many values of L, less than or equal to 5\u00d710^11, will yield a value of 450 for B(L)? Can you crack the code hidden within the honeycomb and reveal the secrets that lie within?"}, {"id": 370, "euler_id": 370, "title": "Geometric triangles", "problem": "Let us define a geometric triangle as an integer sided triangle with sides a \u2264 b \u2264 c so that its sides form a geometric progression, i.e. b2\u00a0=\u00a0a\u00a0\u00b7\u00a0c\u00a0.\u00a0\nAn example of such a geometric triangle is the triangle with sides a = 144, b = 156 and c = 169.\nThere are 861805 geometric triangles with perimeter \u2264 106 .\nHow many geometric triangles exist with perimeter \u2264 2.5\u00b71013 ?", "solution": "41791929448408", "difficulty": 65, "story": "Once upon a time in the kingdom of Mathlandia, there lived a young and curious mathematician named Amelia. Amelia possessed a remarkable talent for numbers and had a penchant for unraveling the mysteries that lay hidden within them. She spent her days lost in a world of equations and formulas, always pushing the boundaries of her understanding.\n\nOne breezy morning, Amelia stumbled upon an intriguing problem while sifting through an ancient mathematical tome. It spoke of geometric triangles and their elusive nature. Amelia's curiosity piqued, she delved deeper into the problem, determined to solve it.\n\nAs Amelia immersed herself in her studies, she discovered that geometric triangles were a rare kind of triangle. Their sides formed a geometric progression, meaning that the square of the middle side was equal to the product of the other two sides. Excitedly, Amelia examined an example - a geometric triangle with sides measuring 144, 156, and 169. Their perimeters added up to 469 units.\n\nIntrigued, Amelia wondered how many geometric triangles existed with a perimeter less than or equal to 2.5 x 10^13. The problem consumed her thoughts, becoming a mystery she desperately wanted to unravel. She pondered over the possibilities, the equations dancing in her mind, until she determined to find the answer.\n\nDays turned into weeks, and weeks into months. Amelia tirelessly explored the world of geometric progression, meticulously calculating the sides of every possible triangle. Every night, she would gaze upon the starry sky, finding solace in their geometric patterns.\n\nAs the seasons changed, a strange phenomenon took place across Mathlandia. The trees seemed to sway in peculiar angles, the flowers bloomed in mesmerizing patterns, and even the wind whispered harmoniously mathematical melodies. A mystical connection had formed between Amelia's quest and the world around her.\n\nOne day, as Amelia sat amidst her dusty books and ink-stained parchment, a thought dawned upon her. She realized that her journey had gone beyond mere numbers. It had become a part of her being, shaping her perceptions and shaping her existence. The mathematical problem Evolved into a realm of imagination and possibilities.\n\nGazing out her window, Amelia witnessed the sun setting in a glorious display of colors, casting a warm glow over Mathlandia. The answer to her question was within reach, but it was not for her alone to discover. She knew that the riddle of the geometric triangles held great significance, not just for mathematicians, but for the world at large.\n\nAmelia decided to share her findings with the people, hoping that it would inspire others to embark on their own mathematical journeys. She wanted them to challenge their intellect, to question the limits of what they believed was possible.\n\nWith her newfound determination, Amelia put pen to paper, translating her mathematical findings into a language that would speak to all. She penned a book, filled with stories that wove math and imagination into a seamless tapestry. It became an instant sensation, captivating the hearts and minds of people across Mathlandia.\n\nAs the final page turned, Amelia reflected upon her journey. The mathematical problem that had launched her quest had become a catalyst for her own growth. She was no longer merely Amelia, a mathematician, but Amelia, the dream-weaver, the harbinger of new ideas.\n\nBut there it lay, that haunting question still untouched, nestled within the minds of those who had read her book. How many geometric triangles existed with a perimeter less than or equal to 2.5 x 10^13? It begged to be answered, awaiting the genius who would dare to seek it out.\n\nAnd so, dear reader, I pose the question to you. Can you solve the puzzle hidden within the mathematical realms? Can you uncover the secrets of these enigmatic geometric triangles?"}, {"id": 384, "euler_id": 384, "title": "Rudin-Shapiro sequence", "problem": "Define the sequence a(n) as the number of adjacent pairs of ones in the binary expansion of n (possibly overlapping).\nE.g.: a(5) = a(1012) = 0, a(6) = a(1102) = 1, a(7) = a(1112) = 2\nDefine the sequence b(n) = (-1)a(n).\nThis sequence is called the Rudin-Shapiro sequence.\nAlso consider the summatory sequence of b(n): s(n)=\u2211i=0nb(i).\nThe first couple of values of these sequences are:\nn\u00a0 \u00a0 \u00a0 \u00a0 0 \u00a0 \u00a0 1 \u00a0 \u00a0 2 \u00a0 \u00a0 3 \u00a0 \u00a0 4 \u00a0 \u00a0 5 \u00a0 \u00a0 6 \u00a0 \u00a0 7\na(n) \u00a0 \u00a0 0 \u00a0 \u00a0 0 \u00a0 \u00a0 0 \u00a0 \u00a0 1 \u00a0 \u00a0 0 \u00a0 \u00a0 0 \u00a0 \u00a0 1 \u00a0 \u00a0 2\nb(n) \u00a0 \u00a0 1 \u00a0 \u00a0 1 \u00a0 \u00a0 1 \u00a0 \u00a0-1 \u00a0 \u00a0 1 \u00a0 \u00a0 1 \u00a0 \u00a0-1 \u00a0 \u00a0 1\ns(n) \u00a0 \u00a0 1 \u00a0 \u00a0 2 \u00a0 \u00a0 3 \u00a0 \u00a0 2 \u00a0 \u00a0 3 \u00a0 \u00a0 4 \u00a0 \u00a0 3 \u00a0 \u00a0 4\nThe sequence s(n) has the remarkable property that all elements are positive and every positive integer k occurs exactly k times.\nDefine g(t,c), with 1 \u2264 c \u2264 t, as the index in s(n) for which t occurs for the c'th time in s(n).\nE.g.: g(3,3) = 6, g(4,2) = 7 and g(54321,12345) = 1220847710.\nLet F(n) be the fibonacci sequence defined by:\nF(0)=F(1)=1 and\nF(n)=F(n-1)+F(n-2) for n>1.\nDefine GF(t)=g(F(t),F(t-1)).\nFind \u2211\u2009GF(t) for 2\u2264t\u226445.", "solution": "3354706415856332783", "difficulty": 65, "story": "In a small village nestled in the heart of a dense forest, there lived a young girl named Lily. She possessed a remarkable curiosity and an insatiable thirst for knowledge, always seeking out mysteries and riddles to unravel. Her favorite haunt was the village library, where she would spend hours poring over dusty tomes and ancient manuscripts, seeking hidden secrets that lay within the pages.\n\nOne fateful day, as Lily was engrossed in deciphering an enigma written in a book she had stumbled upon, she noticed a peculiar symbol etched on the corner of a worn-out page. It resembled a series of ones and zeros, an odd pattern that seemed to hold some deeper significance. Intrigued, she delved deeper into its meaning and discovered an entire mathematical problem woven into the pages.\n\nThe problem held a mystical allure, promising untold wonders and secrets waiting to be unveiled. It spoke of a sequence called the Rudin-Shapiro sequence, derived from a binary representation of numbers, and the exploration of its summatory sequence. Lily marveled at the intricacy of the problem and how it was intertwined with the Fibonacci sequence, another mathematical phenomenon she had encountered before.\n\nAs she read on, Lily's fascination deepened. The Rudin-Shapiro sequence possessed a remarkable property, with positive integers repeating a precise number of times in the summatory sequence. And she desperately wanted to uncover the essence of this enigma, to understand the hidden patterns that lay dormant within the numbers.\n\nHer curiosity now ignited into a burning passion, Lily embarked on a quest to decipher the labyrinthine nature of the Rudin-Shapiro sequence. Days turned into weeks, and weeks into months. Determined, she meticulously examined the binary representations of numbers, seeking patterns, and documenting her findings. In her pursuit of answers, the boundaries between night and day blurred, as she stayed awake, consumed by her relentless quest.\n\nSoon, Lily began to realize that the sequence held a profound significance, not just in the realm of mathematics but in the world around her. Its underlying patterns mirrored the ebb and flow of life itself, its ups and downs, and the interconnectedness of every living being. She marveled at the elegance of the numbers and how they seemingly dictated the universe's very tapestry.\n\nBut as Lily dived deeper into the labyrinth, she had one burning question in her heart: the true essence of GF(t), the index in the summatory sequence where a particular Fibonacci number occurred for the specific time in line with the previous number. The answer to this question eluded her, like a whisper in the wind, a secret just beyond her reach.\n\nAnd so, with her heart set on discovering the truth, Lily came to the end of her journey. She sat with her pen poised over a blank sheet of paper, the weight of the mathematical problem heavy on her shoulders. Her calculations were accurate, her understanding profound, but as she penned the final lines, she knew there was something missing.\n\nThe summation of GF(t) for 2\u2264t\u226445 held the answer to the enigma that had consumed her for so long, yet its solution remained beyond her grasp. With a sigh, she leaned back in her chair and wondered, her mind filled with countless possibilities. How would she crack this final code? What did the answer hold? And could it be the key to unlocking the deepest secrets of the universe?\n\nAs her thoughts swirled in her mind, Lily looked out the window, the setting sun casting a warm glow upon her face. With renewed determination shining in her eyes, she knew that this was not the end of her journey. It was merely the beginning \u2013 the invitation to explore further and delve into the boundless mysteries that lay waiting to be unraveled.\n\nAnd so, she looked at her notepad one last time, contemplating the puzzle that had changed her life forever. With a voice full of wonder and eagerness, she asked herself and anyone who dare listen, \"Can you find the sum of GF(t) for 2\u2264t\u226445? Can you unravel the last remaining secret of the Rudin-Shapiro sequence and the Fibonacci series?\"\n\nThe forest whispered its response, as if to say that the answer lay within the hearts and minds of those who sought it. And Lily, driven by an indomitable spirit and an insatiable thirst for knowledge, set forth on a new quest, eager to embrace the challenges that lay ahead.\n\nAnd so, dear reader, the question remains: Can you find the sum of GF(t) for 2\u2264t\u226445?"}, {"id": 433, "euler_id": 433, "title": "Steps in Euclid's algorithm", "problem": "\nLet E(x0, y0) be the number of steps it takes to determine the greatest common divisor of x0 and y0 with Euclid's algorithm. More formally:x1 = y0, y1 = x0 mod y0xn = yn-1, yn = xn-1 mod yn-1\nE(x0, y0) is the smallest n such that yn = 0.\n\n\nWe have E(1,1) = 1, E(10,6) = 3 and E(6,10) = 4.\n\n\nDefine S(N) as the sum of E(x,y) for 1 \u2264 x,y \u2264 N.\nWe have S(1) = 1, S(10) = 221 and S(100) = 39826.\n\n\nFind S(5\u00b7106).\n", "solution": "326624372659664", "difficulty": 65, "story": "Once upon a time in the tranquil village of Numeria, there lived a young boy named Ethan. Ethan was known for his inquisitive nature and his love for numbers. While other children played with dolls and toy trucks, Ethan spent his days pouring over books about mathematics and solving complex equations. \n\nOne sunny afternoon, Ethan stumbled upon an old dusty tome in the library. The book was filled with ancient mathematical problems, and his eyes lit up with excitement. As he flipped through the pages, one problem caught his attention: the enigmatic Euclid's algorithm. \n\nIntrigued, Ethan read the problem aloud to himself. He discovered that Euclid's algorithm was a method to determine the greatest common divisor between two numbers. It involved a series of steps to find the remainder when one number is divided by another repeatedly until that remainder becomes zero. The number of steps taken was denoted as E(x, y), and Ethan was fascinated by the concept.\n\nAs days turned into weeks, Ethan became obsessed with Euclid's algorithm. He spent countless hours sharpening his mathematical skills, eagerly solving various examples using the algorithm. The young boy even created a chart to record the number of steps it took to find the greatest common divisor for different pairs of numbers.\n\nThe village folks soon noticed his extraordinary passion for mathematics. Some were impressed, while others found it peculiar. Nonetheless, the village elders recognized Ethan's talent and decided to support his ambition. They encouraged him to participate in a prestigious mathematics competition that would be held in a nearby city.\n\nEthan's eyes shimmered with excitement at the opportunity. He spent every waking hour preparing for the competition, solving complex problems and unraveling the mysteries of Euclid's algorithm. Finally, the day of the competition arrived, and Ethan set off to showcase his mathematical prowess.\n\nIn the grand hall of the competition, skilled mathematicians from far and wide gathered to witness the brilliance of their peers. Ethan was nervous but determined to prove himself. As the challenges were presented one by one, he swiftly solved them, impressing the judges with his vast knowledge and mastery.\n\nAfter hours of intense problem-solving, the final round arrived. The question was challenging, involving complex numbers and intricate patterns. Ethan's mind raced, searching for an answer amidst the swirl of numbers on the page.\n\nWith a spark of inspiration, he suddenly remembered the mathematical problem that had started it all\u2014the enigmatic Euclid's algorithm. He realized that the solution lay hidden within the steps of the algorithm. It was a eureka moment that filled him with a sense of awe and wonder.\n\nEthan's heart raced as he weaved his solution into the final problem, drawing on the beauty and elegance of Euclid's algorithm. The audience watched in silence as he presented his answer, explaining how his calculations led him to the final result.\n\nThe judges were astounded. Ethan's solution was not only correct but also ingeniously simple, using Euclid's algorithm as the foundation for his reasoning. His profound understanding of the mathematical problem had won him the accolades of his peers.\n\nAs the applause thundered through the hall, Ethan couldn't help but wonder about the magnitude of his achievement. The experience had taught him more than just solving mathematical problems\u2014it had taught him the value of persistence, curiosity, and the beauty that lay within the world of numbers.\n\nNow, dear reader, it is your turn to tackle the enigma. Can you figure out the sum, S(5\u00b710^6), just as Ethan once did? Can you follow in his footsteps and uncover the secret hidden within Euclid's algorithm, just waiting to be revealed? The answer lies within the numbers, and the world of mathematics awaits your exploration."}, {"id": 441, "euler_id": 441, "title": "The inverse summation of coprime couples", "problem": "\nFor an integer M, we define R(M) as the sum of 1/(p\u00b7q) for all the integer pairs p and q which satisfy all of these conditions:\n\n 1 \u2264 p < q \u2264 M\n p + q \u2265 M\n p and q are coprime.\n\nWe also define S(N) as the sum of R(i) for 2 \u2264 i \u2264 N.\nWe can verify that S(2) = R(2) = 1/2, S(10) \u2248 6.9147 and S(100) \u2248 58.2962.\n\n\nFind S(107). Give your answer rounded to four decimal places.\n", "solution": "5000088.8395", "difficulty": 65, "story": "Once upon a time in the picturesque village of Mathlandia, a curious young girl named Amelia resided. Amelia was praised for her sharp intellect and fervent curiosity, and her favorite pastime was pondering the wonders of mathematics. She often ventured into the village square, where people gathered to trade and exchange their mathematical puzzlements, challenges, and problems.\n\nOne day, as Amelia approached the village square, she noticed a commotion at the center. A formidable-looking mathematician stood on a stage, elegantly dressed in a black suit and top hat. He announced, \"Ladies and gentlemen, gather around! I present to you a perplexing mathematical conundrum that will engage your minds and challenge your intellect.\"\n\nIntrigued, Amelia quickly made her way to the front while the crowd murmured with anticipation. The mathematician smiled at her and said, \"Ah, young Amelia, I'm glad to see you've joined us. Today, I present to you a problem that will test your wit. Are you ready?\"\n\nAmelia nodded eagerly, her eyes shining with excitement. The mathematician continued, \"For an integer M, we define R(M)...\"\n\nAs the mathematician explained the problem with captivating eloquence, its complexity revealed itself before Amelia's very eyes. The crowd listened intently, and Amelia watched as their expressions shifted from awe to deep contemplation.\n\nAs the mathematical problem was intricately unraveled, Amelia became determined to solve it. She decided to consult various mathematical treatises and delve into her studies. Days flew by as she immersed herself in the depths of the problem, missing meals and sleep, completely consumed by the pursuit of a solution.\n\nAmelia did not find the answer right away, but each day brought her a step closer to understanding the task at hand. She discovered that R(M) begged for a keen understanding of prime numbers, divisibility, and patterns within a given range.\n\nFinally, one morning after countless nights of study, Amelia had unlocked a remarkable insight. She burst into the village square, bursting with excitement. \"Eureka!\" she shouted, capturing the attention of everyone around her.\n\nThe villagers turned their eyes toward Amelia, intrigued by her exclamation. The mathematician, standing nearby, smirked with amusement. \"Young Amelia, have you discovered the solution to the enigma?\"\n\nAmelia nodded, a broad smile stretching across her face. She was brimming with confidence as she confidently declared, \"I have found the solution to this intricate puzzle, dear mathematician.\"\n\nThe crowd leaned in, eager to hear her explanation. She eloquently laid out the solution, reciting the sum of R(M) and S(N) with complete clarity, captivating the audience with her mathematical prowess. The villagers marveled at her mind, impressed by her intellectual prowess.\n\nHowever, Amelia's mission was not yet complete. In her excitement, she had neglected the most crucial part\u2014the question that would drive others to challenge themselves. She cleared her throat and addressed the crowd, her voice carrying across the square, \"Now, dear villagers, I present this challenge to all of you. Can you find S(107)?\"\n\nThe village square fell into deep silence, the challenge lingering in the air, calling upon the villagers' mathematical skills. As people dispersed, eager to embark on their own personal quests for the solution, Amelia found satisfaction in knowing that she had sparked a flame of curiosity in others.\n\nAnd so, the villagers wandered back to their homes, pondering the enchanting problem that Amelia had presented. Each night, they too immersed themselves in mathematical studies, slowly teasing apart the complexities of the problem. Days turned into weeks, and weeks turned into months. The village of Mathlandia buzzed with the thrill of the unresolved question, its citizens transformed into avid problem solvers.\n\nAs for Amelia, she was content to watch from afar, knowing that she had ignited the spark, encouraging others to engage in the beautiful dance with numbers. And she knew, one day, she would witness the collective triumph as the villagers discovered the magic within S(107).\n\nNow, dear reader, the challenge is yours. Can you solve S(107), rounding your answer to four decimal places?"}, {"id": 466, "euler_id": 466, "title": "Distinct terms in a multiplication table", "problem": "Let P(m,n) be the number of distinct terms in an m\u00d7n multiplication table.\nFor example, a 3\u00d74 multiplication table looks like this:\n\u00d7 12341 12342 24683 36912\nThere are 8 distinct terms {1,2,3,4,6,8,9,12}, therefore P(3,4) = 8.\nYou are given that:\nP(64,64) = 1263,\nP(12,345) = 1998, and\nP(32,1015) = 13826382602124302.\nFind P(64,1016).", "solution": "258381958195474745", "difficulty": 65, "story": "Once upon a time in the kingdom of Numeria, a young mathematician named Ethan lived. Passionate about numbers and always eager to solve complex problems, he had gained a reputation for his sharp mind and problem-solving abilities. His fame reached even the royal court, and the king himself requested Ethan's presence.\n\nOne bright morning, Ethan arrived at the grand castle, where he was led to the Royal Library. There, on a large table, he found a collection of dusty and ancient books, all pertaining to mathematics. The king, wearing a magnificent crown atop his head, eagerly approached Ethan.\n\n\"Young mathematician, I seek your assistance,\" the king said, his voice carrying authority. \"I have been pondering a problem that has stumped the scholars of Numeria. It involves a multiplication table, you see.\"\n\nEthan's eyes sparkled with excitement, sensing the weight of the task ahead. \"Please, your Majesty, explain the problem to me.\"\n\nThe king cleared his throat and unfolded a scroll. \"In a multiplication table, P(m,n) represents the number of distinct terms. For instance, P(3,4) would be the number of unique numbers that appear in a 3\u00d74 table.\"\n\nAs he spoke, the king gestured towards a vibrant painting adorning the wall. It depicted a beautiful garden, filled with mathematicians and intricate multiplication tables floating gracefully in the air. Ethan's mind began to churn, connecting the dots between the mathematical problem and the grand story it could tell.\n\n\"Your Majesty, may I have permission to tell this mathematical tale through a story?\" Ethan asked, a glimmer of excitement in his eyes.\n\nThe king smiled, amused by the young mathematician's enthusiasm. \"By all means, proceed, Ethan.\"\n\nEthan took a deep breath and began his narrative:\n\n\"In the enchanting land of Numeria, nestled between two great mountains, lived a tribe known as the Multiplicants. This tribe was revered for their exceptional mastery of numbers, and they prided themselves on their wondrous multiplication tables.\n\nOne day, a troupe of wandering mathematicians set foot in Numeria, bearing news of incredible multiplication tables that lay beyond the mountains. Eager to explore these new mathematical territories, the Multiplicants embarked on a journey, each armed with their own theories and strategies.\n\nAs they ventured through the pass between the majestic mountains, they came across a vast field. It stretched as far as the eye could see, filled with an endless array of multiplication tables, shimmering under the gentle rays of the Numerian sun.\n\nThe Multiplicants marveled at the sight. Tables of various sizes, with different values of m and n, spread before them like a vibrant tapestry. But something puzzled them: the number of distinct terms in each table varied greatly.\n\nDetermined to understand this phenomenon, the Multiplicants banded together to devise a plan. They proposed different strategies, conjectures, and formulas, each hoping to unlock the secret behind the number of distinct terms in the multiplication tables.\n\nThey theorized that the dimensions of the tables, m and n, held the key. And so, they began their quest to find the elusive patterns and unveil the mysteries hidden within these mathematical landscapes.\"\n\nAs Ethan continued his tale, the king listened intently, genuinely intrigued by the world he wove from the mathematical problem. The entire court was captivated as the story unfolded, each person's imagination blending with Ethan's words.\n\nHe narrated the journey of the Multiplicants, their trials and errors, and their relentless pursuit of understanding the relationship between the dimensions of the table and the number of distinct terms. The mathematical problem became an integral part of the story, guiding the characters' decisions and shaping their fate.\n\nAnd finally, as the story reached its climax, Ethan paused for a moment, letting the suspense linger in the air. Then, with a smile, he asked the king, \"Your Majesty, can you guess what P(64,1016) is?\"\n\nThe king, his interest piqued, pondered the question. The courtiers exchanged intrigued glances as their minds whirled with possibilities.\n\nEthan, satisfied by the reaction, gazed at the king expectantly, awaiting his response. But before the king could answer, Ethan turned to the audience and posed his final question, \"And what about you, distinguished listeners? Can you unravel the secret behind P(64,1016)?\"\n\nWith that, Ethan's tale came to an end, leaving the answer to the mathematical problem to the imagination of those who heard it. The silence that followed soon erupted into a lively discussion, the Royal Library abuzz with excitement and speculation.\n\nAnd so, dear reader, I invite you to ponder upon this mathematical puzzle and let your own mathematical journey begin. What is the value of P(64,1016)?"}, {"id": 470, "euler_id": 470, "title": "Super Ramvok", "problem": "Consider a single game of Ramvok:\nLet t represent the maximum number of turns the game lasts. If t = 0, then the game ends immediately. Otherwise, on each turn i, the player rolls a die. After rolling, if i < t the player can either stop the game and receive a prize equal to the value of the current roll, or discard the roll and try again next turn. If i = t, then the roll cannot be discarded and the prize must be accepted. Before the game begins, t is chosen by the player, who must then pay an up-front cost ct for some constant c. For c = 0, t can be chosen to be infinite (with an up-front cost of 0). Let R(d, c) be the expected profit (i.e. net gain) that the player receives from a single game of optimally-played Ramvok, given a fair d-sided die and cost constant c. For example, R(4, 0.2) = 2.65. Assume that the player has sufficient funds for paying any/all up-front costs.\nNow consider a game of Super Ramvok:\nIn Super Ramvok, the game of Ramvok is played repeatedly, but with a slight modification. After each game, the die is altered. The alteration process is as follows: The die is rolled once, and if the resulting face has its pips visible, then that face is altered to be blank instead. If the face is already blank, then it is changed back to its original value. After the alteration is made, another game of Ramvok can begin (and during such a game, at each turn, the die is rolled until a face with a value on it appears). The player knows which faces are blank and which are not at all times. The game of Super Ramvok ends once all faces of the die are blank.\nLet S(d, c) be the expected profit that the player receives from an optimally-played game of Super Ramvok, given a fair d-sided die to start (with all sides visible), and cost constant c. For example, S(6, 1) = 208.3.\nLet F(n) = \u2211\u20094\u2264d\u2264n\u2211\u20090\u2264c\u2264n S(d, c).\nCalculate F(20), rounded to the nearest integer.", "solution": "147668794", "difficulty": 65, "story": "Once upon a time in the small town of Numeria, there lived a young and curious mathematician named Ethan. Ethan was known for his love of puzzles and games that tested his logical thinking. He spent most of his days in the local library, exploring the vast world of mathematics.\n\nOne sunny day, as Ethan was engrossed in a fascinating book, a peculiar old man approached him. The old man, with a twinkle in his eye, introduced himself as Mr. O'Connell, a renowned mathematician who had discovered a hidden treasure buried deep within the neighboring forest.\n\nIntrigued by the prospect of adventure and the opportunity to apply his mathematical skills, Ethan eagerly agreed to accompany Mr. O'Connell on his treasure hunt. Before embarking on their journey, Mr. O'Connell shared with Ethan a perplexing mathematical problem that held the key to finding the treasure.\n\n\"Consider a single game of Ramvok,\" explained Mr. O'Connell, his voice filled with excitement. He continued to explain the rules and possibilities, how t represented the maximum number of turns the game could last, and the consequences of each roll. Ethan listened attentively, his mind racing to find a solution to this intriguing problem.\n\nAs they ventured into the dense forest, they encountered various obstacles and challenges along the way. Climbing treacherous paths, crossing raging rivers, and deciphering ancient riddles, Ethan's mathematical prowess provided invaluable assistance at every turn. The mathematical problem elucidated by Mr. O'Connell became intertwined with their journey, giving Ethan the tools to solve each predicament they encountered.\n\nDays turned into weeks as Ethan and Mr. O'Connell delved deeper into the forest, their spirits undeterred. They faced enchanted creatures, traveled through mystical realms, and solved intricate puzzles. With every solved riddle and mathematical challenge, Ethan's confidence grew, leading them one step closer to the treasure's location.\n\nFinally, after a grueling journey, they arrived at a hidden cave tucked away amidst a majestic waterfall. The cave revealed a dazzling chamber, lit by sparkling gemstones that adorned the walls. In the center of the chamber stood a pedestal, upon which sat an ancient, golden dice.\n\n\"This is it, my dear friend,\" exclaimed Mr. O'Connell, his voice filled with awe. \"By solving the mathematical problem I presented to you, we have arrived at the treasure's location.\"\n\nEthan's heart raced with anticipation as he stared at the golden dice. He could feel the weight of the entire journey resting upon his shoulders, knowing that the answer to the mathematical problem held the power to unlock untold riches. This was the pivotal moment, the culmination of his mathematical journey.\n\nBut as Ethan pondered the mathematical problem and its significance, he couldn't help but feel a sense of hesitance. The treasure couldn't possibly be the ultimate reward; rather, it was the pursuit of knowledge and the discovery of newfound abilities that truly made this adventure worthwhile.\n\nWith a heavy heart, Ethan turned to Mr. O'Connell and posed a question that had been lingering in his mind.\n\n\"What if the treasure lies not in the answer to the mathematical problem, but in the journey itself? What if the true reward is the growth, the knowledge, and the camaraderie we have shared along the way?\"\n\nMr. O'Connell smiled, his eyes brimming with pride. \"My young friend, you have truly grasped the essence of this journey. The treasure lies not in the riches it promises, but in the experiences and wisdom gained through the pursuit of knowledge.\"\n\nAs they exited the cave, back into the sunlight, Ethan couldn't help but feel a sense of contentment. The mathematical problem they had embarked upon had become the catalyst for his personal growth, sparking a deep appreciation for the power of mathematics in the real world.\n\nAnd so, with newfound wisdom and a heart filled with gratitude, Ethan continued on his path, eager to solve the mathematical problem that had initiated his incredible adventure.\n\nAs you, the reader, reflect upon Ethan's journey, I pose a question to you:\n\nWhat is the value of F(20), rounded to the nearest integer?\n\nThe answer lies within the mathematical problem Ethan encountered on his treacherous journey, patiently waiting for a brilliant mathematician to uncover its secrets."}, {"id": 477, "euler_id": 477, "title": "Number Sequence Game", "problem": "The number sequence game starts with a sequence S of N numbers written on a line.\nTwo players alternate turns. The players on their respective turns must select and remove either the first or the last number remaining in the sequence.\nA player's own score is (determined by) the sum of all the numbers that player has taken. Each player attempts to maximize their own sum.\nIf N = 4 and S = {1, 2, 10, 3}, then each player maximizes their own score as follows:\nPlayer 1: removes the first number (1)\nPlayer 2: removes the last number from the remaining sequence (3)\nPlayer 1: removes the last number from the remaining sequence (10)\nPlayer 2: removes the remaining number (2)\nPlayer 1 score is 1 + 10 = 11.\nLet F(N) be the score of player 1 if both players follow the optimal strategy for the sequence S = {s1, s2,\u00a0...,\u00a0sN} defined as:\ns1 = 0\nsi+1 = (si2 + 45) modulo 1 000 000 007\nThe sequence begins with S\u00a0=\u00a0{0,\u00a045,\u00a02070,\u00a04284945,\u00a0753524550,\u00a0478107844,\u00a0894218625,\u00a0...}.\nYou are given F(2)\u00a0=\u00a045, F(4)\u00a0=\u00a04284990, F(100)\u00a0=\u00a026365463243, F(104)\u00a0=\u00a02495838522951.\nFind F(108).", "solution": "25044905874565165", "difficulty": 65, "story": "Once upon a time, in the Kingdom of Numeria, there lived two young siblings named Emma and Ethan. They were both fascinated by the beauty of numbers and the wonders of mathematics. Every day, they would gather under the giant oak tree near their home, eagerly discussing various mathematical puzzles and games.\n\nOne sunny afternoon, as they sat under the oak tree, Emma discovered a peculiar game called the number sequence game. She explained it to Ethan, and their eyes widened with anticipation. Both siblings were determined to unravel the depths of this mathematical mystery.\n\nThe game started with a sequence of numbers written on a line. Emma and Ethan learned that they had to take turns removing either the first or the last number remaining in the sequence. The goal was to maximize their own score by selecting numbers wisely.\n\nAs Emma read out the instructions, Ethan's eyes sparkled with excitement. He could already feel the thrill of the game coursing through his veins. \"Let's try it!\" Ethan exclaimed, and Emma nodded in agreement.\n\nThey started with N = 4, following the sequence S = {1, 2, 10, 3}. Both siblings quickly realized they had to plan strategically if they wanted to win. Player 1, Emma, decided to remove the first number, while Ethan, Player 2, opted for the last remaining number, calculating every move with intense concentration.\n\nWith each turn, the numbers disappeared, and the siblings' scores grew. They were neck and neck, vying for victory. Emma skillfully removed the last number from the remaining sequence, leaving only the digit 10. Ethan watched with bated breath, pondering his next move. In the end, his decision to remove the remaining number secured Emma's win with a final score of 11.\n\nEmma and Ethan were thrilled by the exhilarating experience and couldn't wait to explore more intricate sequences. Their journey led them to a special sequence called S, which was defined as follows: s1 = 0, and si+1 = (si^2 + 45) modulo 1,000,000,007.\n\nAs they delved into the world of this perplexing sequence, Emma and Ethan discovered a remarkable pattern. They marveled at how one number led to another, seemingly without any connection. The siblings knew that unlocking the secrets of this sequence would require exceptional mathematical prowess.\n\nDays turned into weeks and weeks into months. Emma and Ethan tirelessly analyzed the sequence's elements, hoping to uncover its hidden meaning. Each new discovery fueled their enthusiasm even more. They found beauty and elegance in the chaos of numbers.\n\nFinally, the day arrived when Emma and Ethan stumbled upon a breakthrough. They cracked the code and deciphered the optimal strategy to maximize their scores in the sequence S. With F(2) = 45 and F(4) = 4,284,990, they could only imagine the immense score that awaited them for F(108).\n\nTheir hearts pounded with anticipation as they spoke the question that had been swirling in their minds since they first encountered the sequence. \"What,\" Emma asked, her voice filled with excitement, \"is F(108)?\"\n\nAnd so, dear reader, the journey into the depths of this mathematical riddle awaits you. Are you ready to unlock the mystery and find out what lies beyond?"}, {"id": 542, "euler_id": 542, "title": "Geometric Progression with Maximum Sum", "problem": "Let S(k) be the sum of three or more distinct positive integers having the following properties:\nNo value exceeds k.\nThe values form a geometric progression.\nThe sum is maximal.S(4)\u00a0=\u00a04\u00a0+\u00a02\u00a0+\u00a01\u00a0=\u00a07S(10)\u00a0=\u00a09\u00a0+\u00a06\u00a0+\u00a04\u00a0=\u00a019S(12)\u00a0=\u00a012\u00a0+\u00a06\u00a0+\u00a03\u00a0=\u00a021S(1000)\u00a0=\u00a01000\u00a0+\u00a0900\u00a0+\u00a0810\u00a0+\u00a0729\u00a0=\u00a03439\nLet T(n)=\u2211k=4n(\u22121)kS(k).T(1000) = 2268\nFind T(1017).", "solution": "697586734240314852", "difficulty": 65, "story": "Once upon a time, in the small town of Numeralia, there lived a young girl named Emma. Emma was a curious and restless soul, always seeking adventure and knowledge. She spent most of her days exploring the forests surrounding her village, searching for hidden treasures and secret paths.\n\nOne sunny morning, as Emma ventured deeper into the woods, she stumbled upon a peculiar door carved into the trunk of a giant oak tree. Curiosity overtaking her, she pushed it open and found herself in a whimsical world filled with numbers and mathematical wonders.\n\nStanding before Emma was an old man with wispy white hair and spectacles perched precariously on his nose. He introduced himself as Professor Fibonacci, the guardian of Numeralia. The professor shared with Emma a riddle that held the key to his magical realm.\n\n\"Dear Emma,\" the professor said, \"I have a mathematical problem for you to solve. Let S(k) be the sum of three or more distinct positive integers that form a geometric progression, with no value exceeding k. The goal is to find the sum that is maximized.\"\n\nIntrigued by the challenge, Emma listened intently as the professor continued. He then presented her with a few examples, illustrating how the summations changed with increasing values of k.\n\n\"S(4) = 4 + 2 + 1 = 7,\" the professor explained, pointing to the first example. \"While for S(10), we have 9 + 6 + 4 = 19. And for S(12), the sum is 12 + 6 + 3 = 21.\"\n\nEager to solve the task, Emma pondered and observed that as k increased, the summations grew larger but seemed erratic or unpredictable.\n\nSeeing Emma's earnestness, the professor smiled and offered a piece of advice. \"Consider the function T(n) = \u2211k=4n(\u22121)kS(k). For instance, for T(1000), the result is 2268. Can you find the value of T(1017)?\"\n\nEmma's mind raced as she grappled with the numerical conundrum. She knew that in order to crack the puzzle, she needed to find a reliable method to calculate the maximum sums for different values of k. It was a challenge that demanded both logic and creativity.\n\nAs Emma embarked on her quest to unlock the secret of T(1017), she traversed through the enchanting world of Numeralia, encountering wondrous mathematical phenomenon at every turn. The townsfolk were always eager to engage in intellectual discourse, sharing their knowledge and insights with her.\n\nDays turned into weeks, and weeks into months, but Emma persisted with unwavering determination. She consulted volumes of ancient scrolls, worked through countless mathematical equations, and even sought the guidance of the wisest minds in Numeralia.\n\nEventually, after relentless effort and dedication, Emma's mind sparkled with newfound knowledge. With each piece of the puzzle she unraveled, her confidence grew. She discovered fascinating relationships between geometric progressions, prime numbers, and recurring patterns.\n\nNow, dear reader, it is your turn. Enter the realm of Numeralia and follow in Emma's footsteps. Can you solve the riddle of T(1017)? Will you discover the true essence of S(k) using Fibonacci's intricate mathematical framework?\n\nThe mystery and magic of Numeralia await, and the answer lies within your grasp. Will you accept the challenge and embark on this mathematical adventure?\n\nTell me, what is T(1017)?"}, {"id": 558, "euler_id": 558, "title": "Irrational base", "problem": "Let r be the real root of the equation x3\u00a0=\u00a0x2\u00a0+\u00a01.\nEvery positive integer can be written as the sum of distinct increasing powers of r.\nIf we require the number of terms to be finite and the difference between any two exponents to be three or more, then the representation is unique.\nFor example, 3\u00a0=\u00a0r\u00a0-10\u00a0+\u00a0r\u00a0-5\u00a0+\u00a0r\u00a0-1\u00a0+\u00a0r\u00a02 and 10\u00a0=\u00a0r\u00a0-10\u00a0+\u00a0r\u00a0-7\u00a0+\u00a0r\u00a06.\nInterestingly, the relation holds for the complex roots of the equation.\nLet w(n) be the number of terms in this unique representation of n. Thus w(3)\u00a0=\u00a04 and w(10)\u00a0=\u00a03.\nMore formally, for all positive integers n, we have:n = \u2211k=\u2212\u221e\u221e bk\u00a0rk\nunder the conditions that:bk is 0 or 1 for all k;bk\u00a0+\u00a0bk+1\u00a0+\u00a0bk+2\u00a0\u2264\u00a01 for all k;w(n) = \u2211k=\u2212\u221e\u221e bk is finite.\nLet S(m)\u00a0= \u2211j=1m w(j2).\nYou are given S(10) = 61 and S(1000) = 19403.\nFind S(5 000 000).", "solution": "226754889", "difficulty": 65, "story": "Once upon a time, in the vibrant town of Mathematica, there lived a young and curious girl named Fiona. Fiona had always possessed a deep love for mathematics and spent countless hours exploring the intricate world of numbers and formulas.\n\nOne fine morning, as Fiona delved into her mathematics books, she stumbled upon an intriguing problem. It involved a root, r, and the representation of positive integers as the sum of distinct increasing powers of that root. Captivated by the idea, Fiona decided to explore this mathematical conundrum further.\n\nShe dug deeper into the problem, meticulously working through the formulas and equations. Fiona discovered the fascinating uniqueness of these representations, where any positive integer could be expressed as the sum of powers of r with finite terms and a difference of three or more between exponents. Not only did this hold true for the real root, but it extended to the complex roots as well.\n\nThe more Fiona explored, the more engrossed she became. She uncovered the function w(n), which represented the number of terms in the unique representation of a positive integer. Fascinated, she found joy in delving into different values of n and calculating the corresponding w(n). It was like unlocking hidden secrets in the realm of numbers.\n\nBy the time Fiona reached the summation function, S(m), she was positively enamored. S(m) allowed her to calculate the sum of w(j^2) from 1 to m. It was as if she held the key to understanding the patterns and intricacies of the unique representations within her grasp.\n\nDays turned into weeks, and weeks into months as Fiona passionately devoted herself to this mathematical journey. Her excitement grew as she successfully calculated S(10) and S(1000) using her newfound knowledge. But a single question lingered in her mind, like a tiny seed waiting to sprout and bloom.\n\nOne evening, as the sun set over Mathematica, Fiona closed her books and gazed out her window, with her mind still buzzing with numbers and equations. The question loomed larger and louder in her thoughts: What is S(5,000,000)?\n\nFiona couldn't ignore the pull of the unresolved problem any longer. The quest for S(5,000,000) consumed her thoughts, and she knew it would be the ultimate test of her mathematical prowess. Determined to solve the mystery, Fiona embarked on a journey of discovery, armed with pencil and paper, ready to face the challenge head-on.\n\nWhat lies beyond S(1000)? Is there a grand pattern waiting to be unveiled? Fiona wondered. She knew that somewhere within the intricacies of this mathematical problem lay a deeper understanding of the very fabric of numbers and their relationships.\n\nAnd so, as the dawn broke on a new day, Fiona took her first step, eager to find the solution to S(5,000,000). Will you join her in this mathematical adventure and unravel the secrets of the unique representations?"}, {"id": 631, "euler_id": 631, "title": "Constrained Permutations", "problem": "Let (p1p2\u2026pk) denote the permutation of the set 1,...,k that maps pi\u21a6i. Define the length of the permutation to be k; note that the empty permutation () has length zero.\nDefine an occurrence of a permutation p=(p1p2\u2026pk) in a permutation P=(P1P2\u2026Pn) to be a sequence 1\u2264t1<t2<\u22ef<tk\u2264n such that pi<pj if and only if Pti<Ptj for all i,j\u2208{1,...,k}.\nFor example, (1243) occurs twice in the permutation (314625): once as the 1st, 3rd, 4th and 6th elements (3465), and once as the 2nd, 3rd, 4th and 6th elements (1465).\nLet f(n,m) be the number of permutations P of length at most n such that there is no occurrence of the permutation 1243 in P and there are at most m occurrences of the permutation 21 in P.\nFor example, f(2,0)=3, with the permutations (), (1), (1,2) but not (2,1).\nYou are also given that f(4,5)=32 and f(10,25)=294400.\nFind f(1018,40) modulo 1000000007.", "solution": "869588692", "difficulty": 65, "story": "Once upon a time, in a small village tucked away in the mountains, lived a young girl named Lily. Lily had always been intrigued by numbers and patterns. She loved to spend her days exploring the beauty of mathematics and the secrets it held. One day, while she was reading a book on permutations and occurrences, she stumbled upon a peculiar mathematical problem that captured her attention with its complexity and elegance.\n\nIn the heart of the village, there was a legendary tree called the Permutation Tree. It was said that the tree possessed mystical powers and could fulfill one's deepest desires. The catch, however, was that in order to make a wish, one had to solve a mathematical puzzle that the Permutation Tree set forth.\n\nLily was determined to test her mathematical prowess and see if she could be the one to unlock the secrets of the Permutation Tree. Armed with the problem given in the book, she spent hours poring over the details and understanding its intricacies.\n\nAs she delved deeper into her exploration, Lily discovered that the problem involved finding specific permutations and occurrences within permutations. It required her to count the number of permutations P of length at most n, which did not contain the permutation 1243. Additionally, she had to ensure that there were at most m occurrences of the permutation 21 in P.\n\nAs she pondered this artful conundrum, Lily couldn't help but wonder how this mathematical problem could relate to the Permutation Tree. She knew there must be a profound connection, but what could it be?\n\nDay turned into night as Lily tirelessly worked on the problem. She found herself becoming more and more enamored with the elegant nature of the mathematics. The concept of permutations and the constraints they could uphold fascinated her beyond measure.\n\nFinally, after days of calculations and exploration, Lily's hard work paid off. She found the solution she was seeking, and it all came together like a beautiful masterpiece. The solution, however, was just the beginning of her journey.\n\nEager to put her newfound knowledge to the test, Lily ventured to the Permutation Tree with a glimmer of hope in her eyes. She stood before the ancient tree and whispered her question into the wind, \"Permutation Tree, I seek to understand the mysteries of f(1018,40). Tell me, what is the value of f(1018,40) modulo 1000000007?\"\n\nAs her question echoed through the forest, a hushed silence filled the air. Suddenly, branches began to sway and leaves rustled, as if communicating with one another. The Permutation Tree seemed to come alive, reacting to Lily's query.\n\nBut before the tree could reveal its answer, a gust of wind swirled around Lily, filling her with anticipation. Slowly, it spelled out a message on a nearby stone tablet:\n\n\"Dear Lily, the path of discovery lies within you. You have shown great determination and skill in unraveling the secrets of this mathematical problem. Now, I challenge you to continue your journey and solve the equation for yourself. The answer awaits your mathematical genius.\"\n\nAs Lily read the message, a mix of emotions flooded her being. The Permutation Tree had not given her the solution, but a greater gift instead \u2013 an opportunity to push her limits, challenge her intellect, and unlock a world of understanding.\n\nFueled by a newfound determination, Lily left the Permutation Tree with a burning question in her heart. How would she approach solving this fascinating mathematical problem, f(1018,40) modulo 1000000007?\n\nAnd so, dear reader, the question now falls to you: can you solve this intricate mathematical puzzle and uncover the answer locked within its midst?"}, {"id": 664, "euler_id": 664, "title": "An infinite game", "problem": "Peter is playing a solitaire game on an infinite checkerboard, each square of which can hold an unlimited number of tokens.\nEach move of the game consists of the following steps:\nChoose one token T to move. This may be any token on the board, as long as not all of its four adjacent squares are empty.\nSelect and discard one token D from a square adjacent to that of T.\nMove T to any one of its four adjacent squares (even if that square is already occupied).\n\n\nThe board is marked with a line called the dividing line. Initially, every square to the left of the dividing line contains a token, and every square to the right of the dividing line is empty:\n\n\nPeter's goal is to get a token as far as possible to the right in a finite number of moves. However, he quickly finds out that, even with his infinite supply of tokens, he cannot move a token more than four squares beyond the dividing line.\nPeter then considers starting configurations with larger supplies of tokens: each square in the dth column to the left of the dividing line starts with dn tokens instead of 1. This is illustrated below for n=1:\n\n\nLet F(n) be the maximum number of squares Peter can move a token beyond the dividing line. For example, F(0)=4.\nYou are also given that F(1)=6, F(2)=9, F(3)=13, F(11)=58 and F(123)=1173.\nFind F(1234567).", "solution": "35295862", "difficulty": 65, "story": "Once upon a time in the quaint town of Mathchester, there lived a young boy named Peter. Peter had always been fascinated by puzzles and mysteries, and his favorite subject in school was mathematics. He loved the way numbers and equations could unlock secrets and solve puzzles.\n\nOne day, as Peter was walking through the town square, he noticed a crowd gathered around a peculiar-looking board game. Curiosity got the better of him, and he pushed his way through the crowd to see what it was all about.\n\nThere, in the center of the square, stood a large checkerboard with an infinite number of squares. Each square was marked with a line called the dividing line. Peter couldn't help but notice that all the squares to the left of the dividing line contained a token, while those to the right were empty.\n\nIntrigued, Peter approached the game's host and asked what it was all about. The host explained that it was a solitaire game and challenged Peter to give it a try. Being a lover of puzzles, Peter eagerly accepted.\n\nThe host explained the rules of the game to Peter. Each move consisted of three steps: choosing a token to move, discarding a token from an adjacent square, and moving the chosen token to any one of its four adjacent squares.\n\nAs Peter played the game, he realized that his goal was to move a token as far as possible to the right in a finite number of moves. It seemed easy at first, but Peter soon learned that he could only move a token up to four squares beyond the dividing line.\n\nDetermined to solve the puzzle, Peter spent hours strategizing and experimenting with different moves. He was fascinated by the challenge presented by the game and was determined to find the maximum number of squares he could move a token beyond the dividing line.\n\nPeter couldn't help but wonder if starting configurations with larger supplies of tokens would allow him to move a token even farther. As he pondered this, he remembered his mathematical knowledge and realized that the game was a perfect application of a mathematical problem.\n\nHe called upon his math skills and began calculating the maximum number of squares he could move a token beyond the dividing line based on the number of tokens in each column. He discovered that the maximum number of squares he could move a token was given by a function called F(n), where n represented the number of tokens in each column to the left of the dividing line.\n\nEager to put his newfound knowledge to the test, Peter decided to challenge himself by finding F(1234567), the maximum number of squares he could move a token beyond the dividing line in a starting configuration where each square in the column had 1234567 tokens.\n\nAs Peter delved deeper into the mathematical problem, he couldn't help but wonder how the function F(n) was derived. He knew that the initial values of the function were F(0) = 4, F(1) = 6, F(2) = 9, F(3) = 13, F(11) = 58, and F(123) = 1173. But what about F(1234567)?\n\nWith excitement and determination in his eyes, Peter set off on a new quest. He embarked on a journey to solve the puzzle and find F(1234567). As he ventured further into the world of mathematics and logic, he couldn't help but wonder what wonders awaited him at the end of his journey. Would he be able to crack the code and unravel the mystery behind F(1234567)? Only time would tell.\n\nAnd so, dear reader, I leave you with the same question that consumed Peter's thoughts: can you find F(1234567)?"}, {"id": 680, "euler_id": 680, "title": "Yarra Gnisrever", "problem": "Let N and K be two positive integers.\nFn is the n-th Fibonacci number: F1=F2=1, Fn=Fn\u22121+Fn\u22122 for all n\u22653.\nLet sn=F2n\u22121modN and let tn=F2nmodN.\nStart with an array of integers A=(A[0],\u22ef,A[N\u22121]) where initially every A[i] is equal to i.\nNow perform K successive operations on A, where the j-th operation consists of reversing the order of those elements in A with indices between sj and tj (both ends inclusive).\nDefine R(N,K) to be \u2211i=0N\u22121i\u00d7A[i] after K operations.\nFor example, R(5,4)=27, as can be seen from the following procedure:\nInitial position: (0,1,2,3,4)\nStep 1 - Reverse A[1] to A[1]: (0,1,2,3,4)\nStep 2 - Reverse A[2] to A[3]: (0,1,3,2,4)\nStep 3 - Reverse A[0] to A[3]: (2,3,1,0,4)\nStep 4 - Reverse A[3] to A[1]: (2,0,1,3,4)\nR(5,4)=0\u00d72+1\u00d70+2\u00d71+3\u00d73+4\u00d74=27\nAlso, R(102,102)=246597 and R(104,104)=249275481640.\nFind R(1018,106) giving your answer modulo 109.", "solution": "563917241", "difficulty": 65, "story": "Once upon a time, in the magical land of Numeria, there lived a young apprentice named Lucius. Lucius had always been fascinated by numbers and their intricate patterns. His dream was to become a great sorcerer and use his mathematical prowess to solve the world's biggest mysteries.\n\nOne sunny morning, Lucius was summoned to the Tower of Numeria by his mentor, Professor Archimedes. Excitement filled the air as Lucius made his way through the winding corridors, his mind racing with anticipation.\n\nAs Lucius entered the tower, he found himself surrounded by shelves piled high with ancient scrolls, each filled with secrets waiting to be unraveled. Professor Archimedes sat hunched over a desk, his spectacles perched on the edge of his nose as he peered intently at an old parchment.\n\n\"Ah, Lucius,\" the professor said, looking up. \"I have a task for you, one that I believe will truly test the limits of your mathematical ability.\" He held out the parchment, and Lucius took it eagerly, his eyes scanning the intricate symbols and equations.\n\nProfessor Archimedes explained the problem to Lucius. It involved Fibonacci numbers and an array of integers. The task was to perform a series of operations on the array, reversing elements between certain indices, and then calculate the sum of the final array multiplied by their respective indices. It seemed like a daunting task, but Lucius was undeterred. He knew that understanding the Fibonacci sequence was the key to unlocking the secret of this problem.\n\nLucius delved deep into the world of Fibonacci numbers, studying their patterns and properties. Late into the night, the young apprentice would lose himself in calculations and equations. As the days turned into weeks, his understanding of the problem grew, and he stumbled upon a profound realization.\n\nThe Fibonacci sequence, with its mesmerizing spiral pattern, held the key to unlocking the hidden powers of Numeria. Its inherent beauty and elegance were woven into the very fabric of the magical land, shaping its landscapes and influencing the paths of its inhabitants.\n\nOne day, while wandering through the Enchanted Forest, Lucius stumbled upon a weary traveler named Seraphina. Seraphina was a mythical creature, half-human and half-fairy, who was renowned for her wisdom and intelligence. Intrigued by Lucius' enthusiasm, she listened attentively as he explained the mathematical problem Professor Archimedes had presented to him.\n\n\"Ah, young Lucius,\" Seraphina said with a knowing smile. \"The answer to your problem lies in the harmony of the Fibonacci sequence. Seek the golden ratio that binds the numbers together and guides the path of your array.\"\n\nLucius was taken aback by Seraphina's revelation. He had never considered this aspect of the problem. The golden ratio, a mathematical constant found throughout nature and art, was said to hold immense power and balance. With newfound determination, Lucius returned to the Tower of Numeria, ready to alter the very fabric of the array.\n\nDays turned into weeks, and weeks into months. Lucius, fueled by his newfound understanding of the problem and motivated by his desire to honor the wisdom of Seraphina, tirelessly performed the operations on the array. He meticulously reversed the elements, constructing the perfect sequence that harnessed the magic of the Fibonacci numbers.\n\nAfter performing the final operation, Lucius stood back, his heart pounding with anticipation. The array now held the symmetry and balance that mirrored the Fibonacci sequence itself. The journey had been arduous, but Lucius felt a sense of satisfaction like no other.\n\nAs he calculated the sum, his eyes widened with wonder. The number that lay before him was astronomical, reaching the very edges of comprehension. And yet, it was not the magnitude of the answer that captivated Lucius. It was the realization of the hidden patterns and insights that lay within the realm of mathematical possibilities.\n\nLucius knew that this discovery would forever shape the world of Numeria. The power of mathematics and the intricate beauty of the Fibonacci sequence would be celebrated, cherished, and incorporated into the very foundation of the land.\n\nAnd now, dear reader, I present you with a question that will test your mathematical abilities and unlock the secrets of Numeria. Can you find the answer to the problem that Lucius faced? Can you calculate R(1018, 106) and give your answer modulo 109? The power lies in your hands."}, {"id": 685, "euler_id": 685, "title": "Inverse Digit Sum II", "problem": "Writing down the numbers which have a digit sum of 10 in ascending order, we get:\n19,28,37,46,55,64,73,82,91,109,118,\u2026\n\nLet f(n,m) be the mth occurrence of the digit sum n. For example, f(10,1)=19, f(10,10)=109 and f(10,100)=1423.\n\nLet S(k)=\u2211n=1kf(n3,n4). For example S(3)=7128 and S(10)\u226132287064mod1000000007.\n\nFind S(10000) modulo 1000000007.", "solution": "662878999", "difficulty": 65, "story": "Once upon a time, in the quiet town of Numeria, lived a young mathematician named Oliver. Oliver was a curious soul, always looking for patterns and connections in the world around him. One sunny morning, as he sipped his coffee and gazed out the window, he stumbled upon an intriguing problem in a book he had borrowed from the library.\n\nThe problem stated, \"Writing down the numbers which have a digit sum of 10 in ascending order, we get: 19, 28, 37, 46, 55, 64, 73, 82, 91, 109, 118\u2026\"\n\nOliver's eyes widened with excitement. He loved a good mathematical challenge, and this problem seemed particularly fascinating. He quickly grabbed his notebook, scribbling down the numbers and calculating their digit sums. As he delved deeper into the calculations, he uncovered a pattern that intrigued him even more.\n\n\"Let f(n,m) be the mth occurrence of the digit sum n,\" the problem continued. \"For example, f(10,1)=19, f(10,10)=109, and f(10,100)=1423.\"\n\nOliver's mind raced with possibilities. What if he could determine a formula to find the nth occurrence of any digit sum? And what about the summation function S(k), as described in the problem? There was so much to explore, and Oliver couldn't wait to uncover the secrets hidden within.\n\nDays turned into weeks, and weeks into months as Oliver immersed himself in his newfound mathematical quest. The townspeople marveled at his dedication, as he was often seen studying at the local caf\u00e9, lost in a world of numbers and equations. The enigmatic problem he had discovered became his obsession, and he spent countless hours working on it.\n\nAs he delved deeper into the intricacies of the problem, Oliver's commitment began to influence the core of his very being. The mathematical discoveries he made expanded his understanding of the world, and he saw connections everywhere \u2013 in the petals of a flower, in the patterns of the night sky, even in the way the wind whispered through the trees.\n\nOliver's passion for mathematics became a guiding force in his life. It shaped his decisions, provided him with purpose, and ultimately influenced his career path. He became a renowned mathematician, sharing his discoveries and inspiring future generations.\n\nBut deep down, Oliver longed for one answer - to the final question posed by the problem that had captured his heart. What was S(10000) modulo 1000000007? He knew that only by solving this mathematical conundrum would he find true contentment.\n\nAnd so, dear reader, I leave you with this question: Can you solve the mathematical problem that captivated Oliver's mind and shaped his destiny? What is S(10000) modulo 1000000007?"}, {"id": 723, "euler_id": 723, "title": "Pythagorean Quadrilaterals", "problem": "A pythagorean triangle with catheti a and b and hypotenuse c is characterized by the well-known equation a2+b2=c2. However, this can also be formulated differently:\nWhen inscribed into a circle with radius r, a triangle with sides a, b and c is pythagorean, if and only if a2+b2+c2=8r2.\nAnalogously, we call a quadrilateral ABCD with sides a, b, c and d, inscribed in a circle with radius r, a pythagorean quadrilateral, if a2+b2+c2+d2=8r2. \nWe further call a pythagorean quadrilateral a pythagorean lattice grid quadrilateral, if all four vertices are lattice grid points with the same distance r from the origin O (which then happens to be the centre of the circumcircle).\n\nLet f(r) be the number of different pythagorean lattice grid quadrilaterals for which the radius of the circumcircle is r. For example f(1)=1, f(2)=1, f(5)=38 and f(5)=167. \nTwo of the pythagorean lattice grid  quadrilaterals with r=5 are illustrated below:\n\n\n\n\n\nLet S(n)=\u2211d|nf(d). For example, S(325)=S(52\u22c513)=f(1)+f(5)+f(5)+f(13)+f(65)+f(513)=2370 and S(1105)=S(5\u22c513\u22c517)=5535.\n\nFind S(1411033124176203125)=S(56\u22c5133\u22c5172\u22c529\u22c537\u22c541\u22c553\u22c561).", "solution": "1395793419248", "difficulty": 65, "story": "Once upon a time, in the vibrant city of Numeria, there lived a young and curious mathematician named Alex. Alex had a reputation for leaving no problem unsolved, and their favorite pastime was weaving mathematical puzzles into stories. One sunny afternoon, as Alex strolled through the bustling marketplace, they stumbled upon a dusty old book tucked away in a forgotten corner of a vendor's stall. The book's yellowed pages were filled with intriguing problems and peculiar tales.\n\nIntrigued, Alex purchased the book and rushed back to their cozy study. As they turned the pages, their eyes fixated on a problem that seemed to hold a certain mystical allure. The problem described pythagorean lattice grid quadrilaterals and the fascinating concept of S(n), the sum of the corresponding function values for its factors.\n\nUnable to resist, Alex delved into the story that accompanied the problem. The tale spoke of a long-lost kingdom where pythagorean lattice grid quadrilaterals were said to possess extraordinary powers. It was rumored that understanding these quadrilaterals and deciphering the secrets hidden within their geometric patterns would grant the solver unimaginable wisdom and magic.\n\nWith their curiosity piqued, Alex undertook a journey to uncover the truth behind this mysterious mathematics. They embarked on countless adventures, deciphering ancient scrolls and consulting wise sages. Along the way, they encountered people who shared their knowledge of the pythagorean lattice grid quadrilaterals, some welcoming, others reluctant.\n\nOne fateful day, Alex stumbled upon an old sage named Professor Lattice. The Professor resided in a quaint cottage near a picturesque lake and was renowned for his unparalleled expertise in all matters mathematical. As the sun set over the lake, Alex eagerly approached the wise Professor, yearning for answers.\n\n\"Professor Lattice,\" Alex began, \"I have come seeking your guidance on the enigmatic nature of pythagorean lattice grid quadrilaterals. Are these truly keys to unlocking the magic that lies hidden within our world?\"\n\nThe Professor turned to Alex with a twinkle in his eyes. \"Indeed, my young apprentice. Pythagorean lattice grid quadrilaterals hold secrets beyond what meets the eye. They are the very fabric of both mathematics and reality.\"\n\nAlex leaned in, captivated by the Professor's words. \"But how does one unravel these secrets, Professor? What purpose do these quadrilaterals serve?\"\n\nThe Professor smiled knowingly. \"Ah, my dear pupil, the purpose lies in the pursuit of knowledge itself. The sum S(n), derived from these quadrilaterals, marks the path to understanding the intricate relationships that bind our world. Through diligent study and exploration, one can unlock the deeper meanings hidden within.\"\n\nMoved by the Professor's wisdom, Alex committed themselves to the task. Days turned into weeks, and weeks turned into months. They would sit by the lake with the Professor, solving intricate problems, and diving into the depths of pythagorean lattice grid quadrilaterals.\n\nAs their understanding grew, Alex began to realize that behind the numbers and formulas lay a profound beauty, a harmonious dance between the abstract and the tangible. In the patterns formed by these quadrilaterals, they discovered the elegance of mathematics and the intricate connections woven throughout our universe.\n\nBut despite their progress, one question remained unanswered, the crux of their quest. What was the value of S(1411033124176203125)? The Professor had given Alex clues, guiding their way, but the final answer eluded them.\n\nNow, dear reader, the story has reached a crossroads. You have joined Alex and explored the wonders of pythagorean lattice grid quadrilaterals. Do you possess the knowledge, the fortitude, to solve the mystery that lies at the heart of this tale? What is S(1411033124176203125), and what secrets shall it unveil?\n\nThe answer awaits, calling upon your mathematical prowess and your imagination. Are you ready to embark on this final adventure?"}, {"id": 729, "euler_id": 729, "title": "Range of periodic sequence", "problem": "Consider the sequence of real numbers an defined by the starting value a0 and the recurrence\nan+1=an\u22121an for any n\u22650.\n\nFor some starting values a0 the sequence will be periodic. For example, a0=12 yields the sequence:\n12,\u221212,12,\u2026\n\nWe are interested in the range of such a periodic sequence which is the difference between the maximum and minimum of the sequence. For example, the range of the sequence above would be 12\u2212(\u221212)=2.\n\nLet S(P) be the sum of the ranges of all such periodic sequences with a period not exceeding P.\nFor example, S(2)=22\u22482.8284, being the sum of the ranges of the two sequences starting with a0=12 and a0=\u221212. \nYou are given S(3)\u224814.6461 and S(5)\u2248124.1056.\n\nFind S(25), rounded to 4 decimal places.", "solution": "308896374.2502", "difficulty": 65, "story": "Once upon a time, in the land of Numeria, there was a young mathematician named Jasper. Jasper was a curious and adventurous soul who had a knack for solving difficult mathematical problems. One day, while exploring the ancient library of Numeria, he stumbled upon an old, dusty book that caught his eye.\n\nAs he gingerly opened the book, he found himself immersed in a story about a mysterious artifact known as the \"Sequence Stone.\" Legend had it that the Sequence Stone had the power to harness the essence of numerical patterns, granting unimaginable abilities to those who could decipher its secrets.\n\nIntrigued by the tale, Jasper delved deeper into the book and discovered a complex mathematical problem related to the Sequence Stone. The problem stated that the stone's powers were directly linked to a specific type of sequence called the \"periodic sequence.\"\n\nThe problem challenged Jasper to find the sum of the ranges of all periodic sequences with a period not exceeding a given number, P. Fascinated by the possibilities this presented, Jasper decided to take on the challenge and solve the puzzle.\n\nDays turned into weeks, and weeks into months, as Jasper dedicated himself to cracking the mystery of the Sequence Stone. With countless sleepless nights and tireless calculations, he made progress, gradually uncovering the workings of periodic sequences.\n\nOn one particular evening, while Jasper was charting his findings in his study, a soft, eerie glow enveloped the room. He looked up to find a spectral figure materializing before him. It was an ancient mathematician, the author of the book he had discovered.\n\n\"Young Jasper,\" the ghostly figure whispered, \"Your quest for the Sequence Stone has brought you closer to discovering the true nature of the periodic sequences. The fate of Numeria and all of its inhabitants rests in your hands. Solve this problem, and you shall wield unimaginable power.\"\n\nWith renewed determination, Jasper studied the problem further, realizing that the sum of the ranges of these periodic sequences was crucial in understanding the magnitude of the Sequence Stone's power. He calculated the sums for various values of P, gradually unraveling the stone's potential.\n\nFinally, after countless calculations and meticulous analysis, Jasper achieved a breakthrough: S(25)\u22481292.6184.\n\nHis heart raced with excitement, for he knew that he had come one step closer to unlocking the secrets of the Sequence Stone. But as the realization sunk in, he couldn't help but wonder, what would be the true nature of the Sequence Stone's power? And how could he harness it for the benefit of Numeria?\n\nAs Jasper closed the ancient book, questions swirled in his mind. What would be the consequences of his discoveries? And could he find a way to ensure the Sequence Stone's powers were used responsibly?\n\nLittle did he know that his journey had only just begun. The mystery of the Sequence Stone awaited him, and the responsibility of its mathematical secrets now rested upon his shoulders.\n\nAnd so, dear reader, I ask you: Can you solve the mathematical problem that Jasper faced? What is the sum of the ranges of all periodic sequences with periods not exceeding 25, rounded to 4 decimal places?"}, {"id": 730, "euler_id": 730, "title": "Shifted Pythagorean Triples", "problem": "\nFor a non-negative integer k, the triple (p,q,r) of positive integers is called a k-shifted Pythagorean triple if p2+q2+k=r2\n\n\n(p,q,r) is said to be primitive if gcd(p,q,r)=1.\n\n\nLet Pk(n) be the number of primitive k-shifted Pythagorean triples such that 1\u2264p\u2264q\u2264r and p+q+r\u2264n.  For example, P0(104)=703 and P20(104)=1979. \n\n\nDefine \nS(m,n)=\u2211k=0mPk(n)\nYou are given that S(10,104)=10956. \n\n\nFind S(102,108)\n", "solution": "1315965924", "difficulty": 65, "story": "Once upon a time in the quaint town of Numerland, there lived a young and curious mathematician named Lily. Lily had a great passion for numbers and solving mathematical puzzles, which led her to spend most of her days tinkering with complex problems. She had an insatiable hunger for knowledge and could never resist a mathematical challenge. One day, she stumbled upon a peculiar problem that captured her attention.\n\nLily discovered a mathematical problem that dealt with the Pythagorean theorem, which fascinated her. It involved something called \"k-shifted Pythagorean triples,\" where the sum of squares of two numbers and the square of a third equaled another number squared. The problem challenged her to determine the number of primitive k-shifted Pythagorean triples within certain constraints.\n\nAs Lily delved into the problem, she couldn't help but imagine a world where numbers came alive. She envisioned a beautiful land filled with Pythagorean triples, each possessing unique qualities and abilities based on their values. In this fantastical land, primitive triples were seen as the purest and most valuable ones, with their magical properties shining brightly.\n\nLily's excitement grew deep within her as she realized the magnitude of this problem, for its solution carried immense significance for the land of Numerland. To her, this was not just another mathematical puzzle, but a vital discovery that could unlock new dimensions of understanding.\n\nDays turned into weeks, and weeks turned into months as Lily tirelessly worked on solving the problem. She consulted ancient texts written by the great mathematicians who came before her, seeking clues and insights to guide her towards the solution. It was a task that required both patience and determination, but Lily was undeterred.\n\nMeanwhile, the land of Numerland was enchanted by Lily's endeavor. The residents, who were also quite fond of numbers and mathematics, cheered her on, offering encouragement and support. They believed that this quest held the key to unraveling the mysteries of the universe, and they patiently awaited an answer that would shake the world.\n\nIn the midst of her struggle, Lily encountered obstacles. Some days, the numbers seemed to mock her, refusing to be arranged in a way that would satisfy the Pythagorean triples. Doubt started to creep into her thoughts, and she wondered if she had bitten off more than she could chew. But every time she felt discouraged, she would find an unexpected clue that reignited her determination.\n\nThe day finally arrived when Lily's perseverance paid off. She solved the problem, finding the elusive answer that had eluded mathematicians for centuries. S(10,104) equaled 10,956, and the land of Numerland rejoiced. Lily's triumph was celebrated with grand festivities, fireworks lighting up the night sky, and songs of victory echoing through the streets.\n\nBut as the jubilation faded away, a new question arose in the minds of the people. What would happen if they expanded the range and considered different values for m and n? Could the answer change drastically, or would it remain within a certain range? The people of Numerland turned their gazes towards Lily, eagerly awaiting her response.\n\nNow it is your turn, dear reader, to embrace the mathematical puzzle that captivated Lily and the inhabitants of Numerland. What will be the value of S(102,108)? Can you unlock the secrets hidden behind the numbers and reveal the answer that has eluded us all?"}, {"id": 735, "euler_id": 735, "title": "Divisors of 2n2", "problem": "Let f(n) be the number of divisors of 2n2 that are no greater than n. For example, f(15)=8 because there are 8 such divisors: 1,2,3,5,6,9,10,15. Note that 18 is also a divisor of 2\u00d7152 but it is not counted because it is greater than 15.\nLet F(N)=\u2211n=1Nf(n). You are given F(15)=63, and F(1000)=15066.\nFind F(1012).", "solution": "174848216767932", "difficulty": 65, "story": "Once upon a time in the kingdom of Numeria, there lived a talented young mathematician named Lucas. Lucas was deeply fascinated by numbers and patterns, and his greatest ambition was to solve the mysteries of the mathematical world. As luck would have it, a curious challenge soon presented itself to him - a puzzle that had perplexed the brightest minds of Numeria for centuries.\n\nWord of Lucas's mathematical prowess reached the ears of the king, who summoned him to the royal chambers. Sitting atop a lavish throne, King Alaric III cut an imposing figure with his flowing robe and regal demeanor.\n\n\"Lucas, I have a task for you,\" the king said, his voice resonating through the grand hall. \"In my extensive library, I stumbled upon an obscure scroll that posed a question, and I believe only you can find the answer.\"\n\nCuriosity piqued, Lucas approached the king, eager to hear the challenge. The king took a deep breath and spoke: \"Let f(n) be the number of divisors of 2n2 that are no greater than n. Your quest is to find F(1012). The mysteries of this problem have baffled even the greatest scholars for centuries.\"\n\nLucas's eyes widened, realizing the magnitude of the task that lay ahead. The fate of Numeria now rested on his young shoulders. Determined to succeed, he poured over ancient tomes and spent sleepless nights in pursuit of a solution.\n\nDays turned into weeks, and weeks turned into months, but Lucas refused to yield. His bedroom was covered in scribbled calculations and discarded failed attempts. Yet, despite the setbacks, his determination only grew stronger.\n\nAs Lucas dug deeper into the realm of divisors and prime numbers, a story began to take shape in his mind. He envisioned a young prince named Sebastian, who found himself lost in a mystical forest. With every step he took, the forest grew denser, the trees taller, and the air filled with an enchanting sense of mystery.\n\nTo escape the enigmatic forest, Sebastian had to solve a series of mathematical conundrums that guarded his path. In each puzzle, he encountered a number and had to determine how many divisors it possessed. With only his intellect and a sense of adventure to guide him, Sebastian delved into the world of prime numbers and divisibility rules.\n\nAs Sebastian solved each puzzle, the forest around him transformed. Sunlight filtered through the canopy, birdsong filled the air, and a sense of clarity washed over him. The once daunting forest became a place of newfound knowledge and enlightenment.\n\nSebastian's journey mirrored Lucas's own quest for the elusive F(1012). Both sought answers to impossible questions, unrelenting in their pursuit of mathematical mastery. And as Lucas weaved this tale in his mind, he realized that the answer to the challenge lay hidden within the very fabric of his story.\n\nThe sounds of trumpets and fanfare filled the air as Lucas presented his findings to the king. His heart raced, his palms sweating with anticipation. King Alaric III leaned forward, excitement sparkling in his eyes.\n\n\"Your Majesty,\" Lucas began, his voice calm yet filled with conviction, \"I have found a way to solve the intricate puzzle. But before I present the answer, I have a question for you. Would you like to hear the story that arose from my pursuit?\"\n\nThe king nodded eagerly, signaling for Lucas to continue.\n\n\"Well, then let me tell you the tale of a brave prince named Sebastian, lost in a forest of numbers, where every step he took led him deeper into mathematical riddles,\" Lucas began, his voice captivating and precise. \"And as his journey intertwined with my own, the solution emerged from the depths of the story, woven into the very essence of its fabric.\"\n\nThe court listened with bated breath as Lucas narrated the captivating story, his words painting vivid images in their minds. And when he reached the end, when Sebastian's final mathematical challenge was met, Lucas raised his gaze to meet the king's eyes.\n\n\"Your Majesty,\" Lucas said, his voice resolute, \"the answer to F(1012) cannot be given directly, for it is a part of the mysterious forest that Sebastian traversed. To find the answer, one must venture into that realm of numbers, just as Sebastian did. Only in that journey will the truth be revealed.\"\n\nThe court was transfixed, their minds spinning with the possibilities and implications of Lucas's words. The king's face lit up with newfound understanding, a spark of wonder in his eyes.\n\n\"So, dear Lucas, in your own words, I ask you this: What is F(1012)?\"\n\nAnd so, the question hangs in the air, waiting to be solved. The mathematical riddle, interwoven with a tale of adventure and knowledge, awaits a mastermind to unravel its secrets and bring enlightenment to the kingdom of Numeria. Will you, dear reader, be the one to answer?\n\nWhat is F(1012)?"}, {"id": 765, "euler_id": 765, "title": "Trillionaire", "problem": "\nStarting with 1 gram of gold you play a game. Each round you bet a certain amount of your gold: if you have x grams you can bet b grams for any 0\u2264b\u2264x. You then toss an unfair coin: with a probability of 0.6 you double your bet (so you now have x+b), otherwise you lose your bet (so you now have x\u2212b).\n\n\nChoosing your bets to maximize your probability of having at least a trillion (1012) grams of gold after 1000 rounds, what is the probability that you become a trillionaire?\n\n\nAll computations are assumed to be exact (no rounding), but give your answer rounded to 10 digits behind the decimal point.\n", "solution": "0.2429251641", "difficulty": 65, "story": "Once upon a time in the bustling city of Numeria, there lived a clever and ambitious young merchant named Alina. Alina was well-known for her sharp mind and keen eye for numbers. She dreamt of great riches and longed for a life of luxury beyond imagination. One day, a mysterious traveler arrived in Numeria, bringing with him an intriguing proposition.\n\nThe traveler claimed to possess a magical coin that, with a flick of the wrist, could turn mere gold into untold wealth. He offered Alina a challenge, promising her unimaginable riches if she could outsmart the enigma of probability. Intrigued by the proposition, Alina agreed to embark on this mathematical journey.\n\nThe traveler handed Alina a single gram of gold, and with it, a set of rules. Every round, Alina would have the opportunity to bet a portion of her gold, anywhere from 0 to the total amount she possessed. Each bet would be subjected to the flip of an unfair coin. If the coin landed on heads, her bet would be doubled, and she would gain that amount of gold. If it landed on tails, she would lose her bet and her gold would be reduced accordingly.\n\nAlina's goal was to achieve the unimaginable \u2013 to amass a whopping trillion grams of gold after exactly 1000 rounds. She was to make her bet strategically, maximizing the probability of reaching this astronomical sum.\n\nDetermined to succeed, Alina set up her humble quarters as a den of calculations. Day and night, her walls were adorned with graphs, charts, and probabilities. She tirelessly analyzed various betting strategies, as her brain churned with ideas, all in pursuit of that coveted trillionaire's status.\n\nAs the days turned into weeks and the weeks into months, Alina's calculations grew ever more complex. She triumphed over countless sleepless nights, pouring over her notebooks as the weight of the mathematical problem pressed on her mind. Her dream of riches had become an obsession, and the whole city of Numeria buzzed with whispers of the \"Gold Gamble.\"\n\nWhispers turned to shouts when news of Alina's progress reached the ears of the townsfolk. The streets were filled with awe-struck merchants, their eyes aglow with a mixture of envy and admiration. Alina had become a symbol of possibility, proof that the pursuit of wealth was not just a dream for the elite.\n\nBut Alina's journey was far from over, and the stakes had never been higher. With each passing round, the thrill of potential wealth intertwined with the fear of utter ruin. Every bet held immense weight, as she calculated the probability of her reign as a trillionaire.\n\nNow, as the climax of this mathematical tale loomed, the big day approached. Alina would compete in her 1000th and final round. The crowd had gathered, eagerly awaiting the outcome of her gamble. Would her tireless efforts prove victorious, or was it all in vain?\n\nAs Alina stood in the center of the grand hall, her hands trembling with anticipation, one question burned in her mind. It hung in the air, almost palpable, as she gazed at the traveler who had started it all. With a voice echoing across the chamber, Alina asked her final question, her voice trembling with a mixture of hope and trepidation, \"What is the probability that I shall become a trillionaire?\"\n\nAnd with those words, the air was still, the crowd holding its breath, waiting for an answer. The traveler, his eyes sparkling with a knowing smile, merely responded with a cryptic, \"The answer will reveal itself in due time.\"\n\nAs the story concludes and the pages turn, the question hangs in the reader's mind. The challenge waits, ready to be unraveled. What then, dear reader, is the probability that Alina became a trillionaire?"}, {"id": 782, "euler_id": 782, "title": "Distinct Rows and Columns", "problem": "The complexity of an n\u00d7n binary matrix is the number of distinct rows and columns.\n\nFor example, consider the 3\u00d73 matrices\nA=(101000101)B=(000000111)\nA has complexity 2 because the set of rows and columns is {000,101}.\nB has complexity 3 because the set of rows and columns is {000,001,111}.\n\nFor 0\u2264k\u2264n2, let c(n,k) be the minimum complexity of an n\u00d7n binary matrix with exactly k ones.\n\nLet\nC(n)=\u2211k=0n2c(n,k)\nFor example, C(2)=c(2,0)+c(2,1)+c(2,2)+c(2,3)+c(2,4)=1+2+2+2+1=8.\nYou are given C(5)=64, C(10)=274 and C(20)=1150.\n\nFind C(104).", "solution": "318313204", "difficulty": 65, "story": "Once upon a time in a small town called Numerictopia, there lived a young girl named Lily. Lily was fascinated by numbers and patterns from a very young age. She found solace in the intricacies of equations and the elegance of mathematics. Her parents, who were both artists, often wondered where Lily's love for numbers came from, but they encouraged her curiosity nonetheless.\n\nOne day, as Lily was walking through the town square, she noticed a puzzling poster pinned on a bulletin board. It read, \"The Complexity Challenge: Solve the perplexing mathematical problem and win a grand prize!\"\n\nIntrigued, Lily read further about the problem. It was called the \"Complexity of Binary Matrices,\" and it fascinated her beyond measure. The problem challenged participants to determine the minimum complexity of an n\u00d7n binary matrix with exactly k ones. Lily saw the elegance in this problem, as it required both logic and creativity.\n\nDetermined to crack the mystery, Lily began delving into the world of binary matrices. She spent countless hours studying the patterns and searching for the perfect solution. As she delved deeper into her research, she discovered that the complexity of a binary matrix was the number of distinct rows and columns it possessed.\n\nExcited by this revelation, Lily set out to find examples to better understand the concept. She sketched out two 3\u00d73 matrices, Matrix A and Matrix B, on the pages of her notebook. A contained ones at positions (1,1), (1,3), (2,3), and (3,2), while B had ones at positions (3,7), (3,8), and (3,9).\n\nCalculating the complexity, Lily realized that Matrix A had a complexity of 2 since it had two distinct rows and two distinct columns - {101,000} and {101,010} respectively. On the other hand, Matrix B had a complexity of 3 due to the following distinct rows and columns - {000,001,111}.\n\nEquipped with this newfound knowledge, Lily felt closer to solving the mathematical problem. She scribbled furiously in her notebook, developing theories, and forming strategies. She reasoned that for 0\u2264k\u2264n^2, let c(n,k) represent the minimum complexity of an n\u00d7n binary matrix with exactly k ones.\n\nPutting all her discoveries together, Lily developed a formula for C(n):\n\nC(n) = \u2211(k=0 to n^2) c(n,k).\n\nShe saw that C(n) was the sum of minimum complexities for all possible values of k.\n\nDetermined to put her understanding to the test, Lily worked through various matrices of different sizes, calculating their complexity and adding them to her overall C(n) sum. She abided by the rules of the problem and strived to find the most efficient solutions for each matrix.\n\nThe days turned into weeks, and weeks into months, as Lily filled page after page of her notebook with explanations, calculations, and proposed solutions. Her passion for the problem consumed her, and she began to see Fibonacci sequences and golden ratios in her sleep.\n\nOne day, the town of Numerictopia organized a grand event honoring the increase in mathematical curiosity among its residents. Mathematicians, professors, and enthusiasts flocked to the town square, eager to showcase their solutions and theories.\n\nAs the event unfolded, Lily stood at the center, nervously clutching her notebook. She had poured her heart and soul into her research, and she hoped for recognition of her tireless efforts.\n\nHowever, as she watched others present their findings, she realized just how much more there was to learn. The problem's complexity astounded her. She saw brilliant minds grappling with the same challenges that she had wrestled with. It was humbling yet inspiring.\n\nLily's dream of finding the solution to C(104) seemed far away in that moment, but her determination remained unwavering. As the event drew to a close, she turned to the audience with a burning question in her eyes and asked, \"Can you find C(104)?\"\n\nAnd so, dear reader, the challenge lies before you. Can you solve the mathematical problem and find C(104)?"}, {"id": 821, "euler_id": 821, "title": "123-Separable", "problem": "\nA set, S, of integers is called 123-separable if S, 2S and 3S are disjoint. Here 2S and 3S are obtained by multiplying all the elements in S by 2 and 3 respectively.\n\nDefine F(n) to be the maximum number of elements of\n(S\u222a2S\u222a3S)\u2229{1,2,3,\u2026,n}\nwhere S ranges over all 123-separable sets.\n\nFor example, F(6)=5 can be achieved with either S={1,4,5} or S={1,5,6}.\nYou are also given F(20)=19.\n\nFind F(1016).", "solution": "9219661511328178", "difficulty": 65, "story": "Once upon a time, in the small village of Mathland, there lived a young and inquisitive girl named Lily. Lily had always found solace in numbers and equations, spending her days exploring the world through the lens of mathematics.\n\nOne sunny afternoon, a peculiar problem came to Lily's attention. She stumbled upon an ancient scroll, hidden deep within her grandfather's library. As she unraveled its fragile pages, she discovered a seemingly unsolvable mathematical problem. This problem had confounded mathematicians for centuries, and Lily's heart raced with excitement as she read it.\n\nThe problem stated that a set, S, of integers is called 123-separable if S, 2S, and 3S are disjoint. In simpler terms, none of the elements in the sets S, 2S (which is obtained by multiplying all elements in S by 2), or 3S (obtained by multiplying all elements in S by 3) can be the same. Lily quickly jotted down the given example, where F(6) equaled 5, and where two different 123-separable sets, S, could be chosen to get the same result.\n\nExcitement coursed through Lily's veins. She knew she had to solve this problem, to understand the intricacies behind the numbers. For days, she delved into her books and experiments, tirelessly scribbling equations and testing different sets to find the solution.\n\nAs she worked, a story began to form in her mind. It was a tale of an ancient kingdom, plagued by an evil sorceress who had cast a spell on numbers. The people of the land had forgotten the joy of mathematics, living their lives in fear and confusion.\n\nLily's story revolved around a young prince named Lucas, who saw through the fog of the sorceress's spell. Armed with a sharp mind and a thirst for knowledge, he embarked on a quest to find the key to unlocking the mystical power of numbers.\n\nThroughout Lucas's journey, he encountered various challenges, each steeped in mathematics. He solved puzzles involving prime numbers, geometric sequences, and complex equations. But it was the 123-separable problem that proved to be the key to his final triumph.\n\nIn his quest, Lucas met an old sage who held the secrets to overcoming the sorceress's spell. The sage taught him about the power of 123-separable sets, how they could be used to unlock the hidden magic in numbers. Fueled by understanding, Lucas dedicated himself to finding the ultimate solution.\n\nInspired by her story, Lily continued her pursuit of the answer. She experimented with different strategies, exploring the relationships between sets and numbers. She was determined to solve the riddle and bring the joy of mathematics back to her village, just as Lucas had done in her tale.\n\nAs the days turned into weeks, Lily finally found herself standing on the precipice of discovery. She could almost taste the solution, her mind buzzing with anticipation. Words spilled out in her story, as Lucas stared at the ancient scroll, his eyes filled with wonder. In that moment, she knew it was time to bring her journey to an end.\n\nBut the question lingered in her mind, and now in the minds of the readers who would hear her tale. What was the solution to this perplexing problem? What was F(1016)?\n\nLily closed her books, her voice echoing through the pages of her story. She turned to the readers and posed the question firmly, her eyes sparkling with excitement. The answer lay hidden within the depths of mathematics, waiting for a keen mind to unlock its secrets.\n\nAnd so, dear reader, I leave this final question to you. Can you solve the riddle that has captivated Lily's mind? Can you bring closure to her story and discover the value of F(1016)?\n\nThe answer awaits, quietly nestled within the realm of numbers, ready to be revealed by the power of your intellect."}]