[{"id": 328, "euler_id": 328, "title": "Lowest-cost Search", "problem": "We are trying to find a hidden number selected from the set of integers {1, 2, ..., n} by asking questions. \nEach number (question) we ask, has a cost equal to the number asked and we get one of three possible answers: \"Your guess is lower than the hidden number\", or\n \"Yes, that's it!\", or\n \"Your guess is higher than the hidden number\".\nGiven the value of n, an optimal strategy minimizes the total cost (i.e. the sum of all the questions asked) for the worst possible case. E.g.\nIf n=3, the best we can do is obviously to ask the number \"2\". The answer will immediately lead us to find the hidden number (at a total cost = 2).\nIf n=8, we might decide to use a \"binary search\" type of strategy: Our first question would be \"4\" and if the hidden number is higher than 4 we will need one or two additional questions.\nLet our second question be \"6\". If the hidden number is still higher than 6, we will need a third question in order to discriminate between 7 and 8.\nThus, our third question will be \"7\" and the total cost for this worst-case scenario will be 4+6+7=17.\nWe can improve considerably the worst-case cost for n=8, by asking \"5\" as our first question.\nIf we are told that the hidden number is higher than 5, our second question will be \"7\", then we'll know for certain what the hidden number is (for a total cost of 5+7=12).\nIf we are told that the hidden number is lower than 5, our second question will be \"3\" and if the hidden number is lower than 3 our third question will be \"1\", giving a total cost of 5+3+1=9.\nSince 12>9, the worst-case cost for this strategy is 12. That's better than what we achieved previously with the \"binary search\" strategy; it is also better than or equal to any other strategy.\nSo, in fact, we have just described an optimal strategy for n=8.\nLet C(n) be the worst-case cost achieved by an optimal strategy for n, as described above.\nThus C(1) = 0, C(2) = 1, C(3) = 2 and C(8) = 12.\nSimilarly, C(100) = 400 and \u2211n=1100C(n)=17575.\nFind \u2211n=1200000C(n) .", "solution": "260511850222", "difficulty": 95, "story": "Once upon a time, in a small kingdom nestled in the rolling hills, there lived a young and curious prince named Sebastian. From a young age, Sebastian had a fervent love for mathematics, constantly seeking out new puzzles and problems to solve. One day, an intriguing mathematical problem found its way to the prince's attention, captivating his imagination.\n\nThe problem whispered of a hidden number nestled in the realm of integers, waiting to be discovered by the inquisitive. Sebastian read about the cost associated with each question asked, with the ultimate goal of finding the hidden number while minimizing the total cost. The possibilities intrigued him, and he couldn't resist but ponder upon it day and night.\n\nAs Sebastian ventured through the kingdom, he couldn't help but notice the whispers of a legendary mathematician known as Professor Archimedes. In hushed voices, people spoke of his extraordinary abilities to solve the most enigmatic mathematical problems. Eager to meet this sage, Sebastian embarked on a journey to find him.\n\nAfter days of traveling, Sebastian arrived at a modest cottage nestled in the forest. There, he found Professor Archimedes engrossed in his studies, surrounded by stacks of books and parchment. The professor looked up with a wise smile as Sebastian approached.\n\n\"Greetings, young prince,\" Professor Archimedes said graciously. \"I sensed your arrival in the realm of mathematics. What conundrum brings you here today?\"\n\nSebastian eagerly shared the mathematical problem he had come across, the one about finding the hidden number with minimum cost.\n\nProfessor Archimedes listened attentively, stroking his long silver beard. \"Ah, that is quite the puzzle indeed. It reminds me of the quest for knowledge hidden deep within the universe.\" He paused, savoring the moment. \"But it seems you seek its solution, young prince.\"\n\nSebastian leaned forward, eyes gleaming with anticipation. \"Do you know the answer, Professor?\"\n\nA knowing glimmer shone in Professor Archimedes' eyes. \"Young prince, the journey towards the solution is as important as the answer itself. Let me tell you a tale that may hold the key to your quest.\"\n\nSebastian leaned in, captivated by the professor's words.\n\n\"There was once a kingdom fraught with turmoil,\" Professor Archimedes began. \"Deep within the heart of this land lay a hidden chest filled with priceless treasures. The problem was that only the one who possessed the key could unlock its secrets. Many tried, and many failed.\"\n\nSebastian's excitement grew as he realized the professor was weaving the mathematical problem into a fantastical tale.\n\nThe professor continued, \"One day, a brave knight named Sir Gerald set out on a quest to find the hidden key. He interrogated townsfolk, traveled through treacherous woods, and climbed challenging cliffs. But no matter how valiant his efforts, he could not locate the elusive key.\"\n\nSebastian's mind raced, making connections between the professor's story and the mathematical problem he sought to solve.\n\n\"However, Sir Gerald was not one to be defeated easily,\" Professor Archimedes continued. \"He called upon the assistance of a wise old sage, who instructed him to approach the problem with a strategy. Sir Gerald pondered countless possibilities, considering the cost of each decision he would make.\"\n\nSebastian nodded, starting to see the relevance of the professor's tale. Each twist and turn mirrored the mathematical problem he longed to unravel.\n\n\"The sage suggested that Sir Gerald's first question should be the key to unlocking the puzzle,\" the professor hinted. \"In the same way, young prince, your choice of the first number to ask will carry great significance. It will set the stage for your strategy and, ultimately, the total cost you must bear.\"\n\nWith newfound clarity, Sebastian began to see the hidden depths within the mathematical problem. It was not merely a mind game; it held the power to unlock secrets and treasures yet to be uncovered.\n\nAs the story drew to a close, Professor Archimedes paused, letting the moment hang in the air.\n\n\"Remember, young prince,\" the professor said, eyes sparkling with wisdom. \"The solution lies within your mind, waiting to be discovered as you traverse the realms of numbers. Embrace the challenge, and let your curiosity guide you.\"\n\nSebastian thanked the professor for his captivating tale and embarked on his journey back to the castle. His mind buzzed with the possibilities and strategies he could employ to find the hidden number while minimizing the cost.\n\nBack in his chambers, Sebastian stared at the mathematical problem scrawled on parchment, its digits glowing like a constellation.\n\nAnd so, dear reader, with all the adventures and lessons shared, the question remains: What will be Sebastian's optimal strategy to find \u2211n=1200000C(n)? Will he unlock the secrets hidden within the realm of numbers and emerge victorious in his quest for knowledge?"}, {"id": 338, "euler_id": 338, "title": "Cutting Rectangular Grid Paper", "problem": "A rectangular sheet of grid paper with integer dimensions w \u00d7 h is given. Its grid spacing is 1.\nWhen we cut the sheet along the grid lines into two pieces and rearrange those pieces without overlap, we can make new rectangles with different dimensions.\nFor example, from a sheet with dimensions 9 \u00d7 4 , we can make rectangles with dimensions 18 \u00d7 2, 12 \u00d7 3 and 6 \u00d7 6 by cutting and rearranging as below:\n\n\nSimilarly, from a sheet with dimensions 9 \u00d7 8 , we can make rectangles with dimensions 18 \u00d7 4 and 12 \u00d7 6 .\nFor a pair w and h, let F(w,h) be the number of distinct rectangles that can be made from a sheet with dimensions w \u00d7 h .\nFor example, F(2,1) = 0, F(2,2) = 1, F(9,4) = 3 and F(9,8) = 2. \nNote that rectangles congruent to the initial one are not counted in F(w,h).\nNote also that rectangles with dimensions w \u00d7 h and dimensions h \u00d7 w are not considered distinct.\nFor an integer N, let G(N) be the sum of F(w,h) for all pairs w and h which satisfy 0 < h \u2264 w \u2264 N.\nWe can verify that G(10) = 55, G(103) = 971745 and G(105) = 9992617687.\nFind G(1012). Give your answer modulo 108.", "solution": "15614292", "difficulty": 95, "story": "Once upon a time, in the quiet town of Numerica, there lived a young girl named Lily. Lily had always been fascinated by the world of numbers and mathematics. She loved spending her days exploring the patterns and puzzles hidden within the realm of digits.\n\nOne sunny afternoon, Lily stumbled upon an old box in her attic. Curiosity piqued, she opened it to find a stack of grid papers with various dimensions. Each sheet was filled with perfectly aligned squares, carefully separated by grid lines. Lily's eyes sparkled with excitement as she realized these were no ordinary papers; they were a gateway to a mathematical adventure.\n\nLily took a deep breath and decided to tackle a challenging puzzle that lay within the dusty box. The puzzle involved cutting the grid paper along the lines and rearranging the pieces into new rectangles with different dimensions. Deep down, Lily knew that she had to master this problem to unlock the secrets hidden within the attic.\n\nWith unwavering determination, Lily spent hours meticulously cutting and rearranging the paper. She experimented with different dimensions, folding and unfolding, trying to understand the magic behind the process. As she worked, she noticed a pattern emerging; each time she rearranged the pieces, she created unique rectangles with distinct measurements.\n\nThis realization sparked a fire within Lily. She yearned to discover the total number of distinct rectangles that could be formed from the grid paper. She wanted to delve deep into the intricacies of the problem and understand its essence. Lily became committed to finding a formula that would unlock the secrets of her beloved grid papers.\n\nDays turned into weeks, and weeks into months, but Lily did not waver on her quest. She delved deep into the world of mathematics, consulting books and seeking guidance from esteemed experts. The problem became more than just a puzzle; it became her passion.\n\nHer journey eventually led her to a solution\u2014a formula that would help her determine the number of distinct rectangles for any given pair of dimensions w and h. This formula gave her the ability to calculate F(w,h) in her sleep. She reveled in the elegance of the solution, and her excitement grew with each new rectangle she discovered.\n\nBut as her knowledge expanded, so did her hunger for more challenging problems. Lily yearned for a grander goal\u2014a sum that would encompass all pairs of dimensions within a specific range. She desired to find G(N), the sum of F(w,h) for all pairs w and h, where 0 < h \u2264 w \u2264 N. She knew that this sum would bring her to the pinnacle of her mathematical journey.\n\nAnd so, with pencil in hand and determination in her eyes, Lily set out to find the elusive G(N). She poured over countless grids of varying dimensions, carefully calculating the number of distinct rectangles that could be formed from each. Her dedication knew no bounds; she scribbled equations and crossed them out, searching for a pattern that would lead her closer to G(N).\n\nAs the days turned into nights, Lily's excitement grew. Each new discovery illuminated a fresh corner of the mathematical landscape. G(N) began to take shape in her calculations, revealing itself little by little. Lily felt the exhilaration of nearing the answer, yet the mountain still seemed so high.\n\nAnd now, dear reader, the time has come for you to carry on this mathematical journey. By finding G(1012), the sum of F(w,h) for all pairs w and h that satisfy the given conditions, you shall unravel the secrets that eluded even Lily's curious mind. So, I ask you, can you crack this mathematical conundrum and discover G(1012)? The attic awaits your exploration, and the dusty box yearns to reveal its hidden treasures."}, {"id": 427, "euler_id": 427, "title": "n-sequences", "problem": "A sequence of integers S = {si} is called an n-sequence if it has n elements and each element si satisfies 1 \u2264 si \u2264 n. Thus there are nn distinct n-sequences in total.\nFor example, the sequence S = {1, 5, 5, 10, 7, 7, 7, 2, 3, 7} is a 10-sequence.\nFor any sequence S, let L(S) be the length of the longest contiguous subsequence of S with the same value.\nFor example, for the given sequence S above, L(S) = 3, because of the three consecutive 7's.\nLet f(n) = \u2211 L(S) for all n-sequences S.\nFor example, f(3) = 45, f(7) = 1403689 and f(11) = 481496895121.\nFind f(7\u00a0500\u00a0000) mod 1\u00a0000\u00a0000\u00a0009.", "solution": "97138867", "difficulty": 95, "story": "Once upon a time in the small village of Numerica, there lived a young mathematician named Lily. Lily was a curious soul, always seeking patterns and equations in the world around her. She would spend hours in her room, surrounded by piles of books and stacks of papers, trying to solve mathematical problems that seemed unsolvable to others. Her passion for numbers was unmatched, and she longed for a challenge that would push her skills to their limits.\n\nOne sunny day, as Lily was lying under a tree, gazing up at the clouds and contemplating the mysteries of the universe, she overheard a conversation between two villagers. They were discussing a peculiar pattern that had emerged from their daily rituals of counting and numbering objects.\n\nIntrigued, Lily approached them and asked what they were talking about. The villagers explained that they had stumbled upon a way to calculate the length of a specific type of sequence, called an n-sequence. They had discovered that each element in the sequence could only range from 1 to n, and there were precisely nn different n-sequences. Lily's eyes widened with excitement. This was the challenge she had been waiting for!\n\nEager to put her mathematical prowess to the test, Lily began studying the patterns and intricacies of n-sequences. She spent countless sleepless nights meticulously analyzing the various combinations and their lengths. With each passing day, she became more engrossed in her research, scribbling equations and formulas onto her bedroom walls.\n\nOne evening, while deeply immersed in her work, Lily made a groundbreaking discovery. She realized that by finding the longest contiguous subsequence of a given n-sequence, she could calculate its length. This groundbreaking concept gave birth to a new function, which she called L(S), where S represented a specific n-sequence.\n\nWith her newfound knowledge, Lily delved deeper into her research and began exploring the implications of her function. She calculated L(S) for numerous n-sequences, meticulously recording her findings in her notes. Fascinated by her own findings, she defined a new function, f(n), which would sum up L(S) for all n-sequences of a given length.\n\nAs Lily delved into the world of f(n), she discovered its astonishing potential. It wasn't just a mere mathematical equation; it was a gateway to understanding patterns and unraveling the mysteries of the numbers themselves. The function seemed to hold a secret, one she felt compelled to uncover.\n\nDays turned into weeks, and weeks into months as Lily dedicated herself to the study of f(n). She pushed her mind to its limits, exploring the vast iterations of n-sequences and calculating L(S) for each one. But with each passing calculation, the complexity exponentially increased, making her task seem insurmountable.\n\nDoubt began to cloud Lily's mind. Would she ever find the solution? Would she ever be able to grasp the true essence of f(n)? The weight of the unanswered question burdened her, almost driving her to the point of giving up. But deep down, Lily knew she couldn't abandon her quest. She had come too far, and she knew she was on the brink of a momentous discovery.\n\nSo, she persevered, day and night, refusing to surrender to the overwhelming odds stacked against her. She poured over her calculations, searching for patterns amidst the chaos. And then, like a luminous beam of light illuminating the darkness, the solution appeared before her eyes.\n\nBut that's where our story leaves off. As the protagonist, it's now your turn to uncover the answer to Lily's question. Can you find f(7,500,000) mod 1,000,000,009? The fate of Numerica's ancient mathematical secret lies in your hands."}, {"id": 438, "euler_id": 438, "title": "Integer part of polynomial equation's solutions", "problem": "\nFor an n-tuple of integers t = (a1, ..., an), let (x1, ..., xn) be the solutions of the polynomial equation xn + a1xn-1 + a2xn-2 + ... + an-1x + an = 0.\n\n\nConsider the following two conditions:\nx1, ..., xn are all real.\nIf x1, ..., xn are sorted, \u230axi\u230b = i for 1 \u2264 i \u2264 n. (\u230a\u00b7\u230b: floor function.)\n\nIn the case of n = 4, there are 12 n-tuples of integers which satisfy both conditions.\nWe define S(t) as the sum of the absolute values of the integers in t.\nFor n = 4 we can verify that \u2211\u2009S(t) = 2087 for all n-tuples t which satisfy both conditions.\n\n\nFind \u2211\u2009S(t) for n = 7.\n", "solution": "2046409616809", "difficulty": 95, "story": "Once upon a time in the charming town of Numerica, there lived a young girl named Alice. Alice was a peculiar child with an insatiable hunger for numbers. She found solace in the world of mathematics and spent her days exploring its intricate beauty.\n\nOne sunny afternoon, as Alice sat underneath a towering oak tree, she stumbled upon an old, dusty book hidden among the tangle of roots. Curiosity piqued, she carefully opened the pages and discovered a fascinating mathematical problem. It spoke of n-tuples and polynomial equations, and it was a puzzle that both challenged and thrilled her.\n\nAlice read attentively, her mind swirling with possibilities. The problem described two conditions that had to be met: all the solutions, denoted as x1, x2, x3...xn, had to be real numbers, and when sorted, they had to satisfy the floor function, where \u230axi\u230b equaled i for 1 \u2264 i \u2264 n. It intrigued Alice, and she wondered how these numbers could be arranged to fulfill such requirements.\n\nAs she delved deeper into the book, Alice discovered that for n = 4, there were exactly 12 n-tuples of integers that satisfied both conditions. A thought struck her like a lightning bolt - she could test these tuples herself! Alice couldn't contain her excitement and hurriedly scribbled down the equations in her notebook.\n\nShowing great perseverance, Alice solved each equation, determined to reach the answer. She found that the sum of the absolute values of the integers in each tuple, denoted as S(t), was crucial in determining the final solution. For n = 4, the sum of S(t) was calculated as 2087. Alice marveled at the elegant patterns woven within these numbers, their beauty apparent to her discerning eye.\n\nDays turned into weeks, and Alice's fascination grew stronger. She couldn't stop thinking about the problem, even when her friends beckoned her to play tag or go on adventures. Her mind was consumed with the quest to find the sum of S(t) for n = 7.\n\nWith relentless determination, Alice embarked on her mathematical adventure, exploring the depths of its complexity. She pondered the interplay between the real numbers and the floor function, analyzing how they could intertwine to form the desired tuples. Her pencil flew across the pages of her notebook, as she consulted textbooks and called upon imaginary mathematical friends for guidance.\n\nThe walls of Alice's room were soon adorned with sketches of equations, calculations, and notes. The town of Numerica marveled at this young girl's unwavering pursuit of knowledge. Word of her mathematical prowess spread like wildfire, inspiring other budding mathematicians to explore the mysteries of numbers.\n\nAnd so, we find ourselves at this crossroad, dear reader. The mathematical problem of obtaining \u2211 S(t) for n = 7 looms ahead, waiting for an earnest soul to solve it. Will you pick up where Alice left off? Can you unlock the beauty hidden within these numbers and find the elusive answer?\n\nAs the story unfolds in the realm of Numerica, Alice's question lingers in the air, begging to be answered: What is the sum of S(t) for n = 7?"}, {"id": 447, "euler_id": 447, "title": "Retractions C", "problem": "\nFor every integer n>1, the family of functions fn,a,b is defined \nby  \nfn,a,b(x)\u2261ax+bmodn for a,b,x integer and  0<a<n,0\u2264b<n,0\u2264x<n. \n\nWe will call fn,a,b a retraction if fn,a,b(fn,a,b(x))\u2261fn,a,b(x)modn for every 0\u2264x<n.\nLet R(n) be the number of retractions for n.\n\n\nF(N)=\u2211n=2NR(n). \nF(107)\u2261638042271mod1000000007.\n\nFind F(1014).\nGive your answer modulo 1000000007.\n", "solution": "530553372", "difficulty": 95, "story": "Once upon a time in the land of Numeria, there lived a brilliant mathematician named Professor Euler. Professor Euler had a remarkable mind and was known far and wide for his groundbreaking discoveries in the field of mathematics. His latest conquest was unraveling the secrets behind the family of functions fn,a,b.\n\nIn the kingdom of Numeria, the fn,a,b functions held mythical significance, believed to possess the power to unlock hidden enchantments. For every integer n greater than 1, the functions were designed to transform any number x within a given range into a new number ax+bmodn. But there was a catch - fn,a,b was considered a retraction only if fn,a,b(fn,a,b(x))\u2261fn,a,b(x)modn for every 0\u2264x<n.\n\nThe number of retractions for each value of n was represented as R(n). Professor Euler's mathematical prowess enabled him to determine R(n) for several values of n, but the real challenge lay in calculating the sum of R(n) for all n greater than or equal to 2. Professor Euler denoted this sum as F(N), with N being the last desired value of n.\n\nOne sunny morning, as Professor Euler sat in his study poring over the complexities of the fn,a,b functions, a curious young girl named Lily knocked on his door.\n\n\"Excuse me, Professor Euler,\" Lily said, her eyes brimming with excitement. \"I've heard rumors that you've discovered the secrets of the fn,a,b functions. Is it true?\"\n\nProfessor Euler smiled warmly at the young girl. \"Indeed, my dear,\" he replied. \"I have uncovered the mysteries surrounding these functions. They possess incredible potential, but their true power lies in the retractions they form.\"\n\nLily's eyes widened with wonder. She had always been captivated by the magic of numbers and the hidden patterns they held. \"Tell me more, Professor Euler,\" she urged.\n\nProfessor Euler proceeded to explain how the fn,a,b functions were not merely mathematical entities but possessed the ability to unlock mystical forces within the kingdom. The retractions played a crucial role in harnessing this power.\n\n\"In order to truly comprehend the extent of their power, Lily,\" Professor Euler said, his voice tinged with anticipation, \"we must calculate the sum of all the retractions. This sum, denoted as F(N), will give us the key to unlocking the ultimate enchantment.\"\n\nLily's eyes sparkled with curiosity. She had always dreamt of experiencing something extraordinary, and Professor Euler's words sparked a fire within her.\n\n\"Professor,\" Lily asked, her voice trembling with excitement, \"what is F(1014)? Can we calculate it, and if so, what marvels would it unleash upon Numeria?\"\n\nProfessor Euler's expression turned thoughtful. \"F(1014) is a mighty challenge indeed, Lily,\" he replied. \"Its calculation requires a level of mathematical prowess that surpasses even my own. But if we can solve this mystery, who knows what wonders may await us?\"\n\nWith determination gleaming in her eyes, Lily made a silent vow. She would become Professor Euler's dedicated apprentice, helping him decipher the complexities of F(1014). Together, they embarked on an incredible mathematical journey, unraveling the secrets of the fn,a,b functions and pushing the boundaries of their understanding.\n\nAnd so, dear reader, the question remains: Can you solve the enigma of F(1014)? Can you analyze the intricacies of the fn,a,b functions and calculate their sum with aplomb? The fate of Numeria's wonders rests in your hands."}, {"id": 453, "euler_id": 453, "title": "Lattice Quadrilaterals", "problem": "A simple quadrilateral is a polygon that has four distinct vertices, has no straight angles and does not self-intersect.\nLet Q(m, n) be the number of simple quadrilaterals whose vertices are lattice points with coordinates (x,y) satisfying 0 \u2264 x \u2264 m and 0 \u2264 y \u2264 n.\nFor example, Q(2, 2) = 94 as can be seen below:\n\nIt can also be verified that Q(3, 7) = 39590, Q(12, 3) = 309000 and Q(123, 45) = 70542215894646.\nFind Q(12345, 6789) mod 135707531.", "solution": "104354107", "difficulty": 95, "story": "Once upon a time in the land of Numerica, where numbers and shapes ruled supreme, there lived a young polygon named Polly. Polly was a simple quadrilateral, content with her life filled with straight angles, neatly intersecting lines, and a cozy home formed by her four distinct vertices.\n\nNow, Polly had always been a curious quadrilateral, with an insatiable thirst for knowledge. She loved exploring the vast landscapes of Numerica and was particularly fascinated with the lattice points and their coordinates. Polly would spend endless hours traversing the grid-like terrains, counting the lattice points she encountered.\n\nOne beautiful sunny day, as Polly was exploring the coordinates (x,y) satisfying 0 \u2264 x \u2264 m and 0 \u2264 y \u2264 n, she stumbled upon a perplexing puzzle. It was a mathematical problem etched onto a stone tablet, and it read:\n\n\"A simple quadrilateral is a polygon that has four distinct vertices, has no straight angles and does not self-intersect.\nLet Q(m, n) be the number of simple quadrilaterals whose vertices are lattice points with coordinates (x,y) satisfying 0 \u2264 x \u2264 m and 0 \u2264 y \u2264 n.\nFor example, Q(2, 2) = 94 as can be seen below:\n\nIt can also be verified that Q(3, 7) = 39590, Q(12, 3) = 309000 and Q(123, 45) = 70542215894646.\nFind Q(12345, 6789) mod 135707531.\"\n\nThis mathematical problem intrigued Polly to no end. She realized that solving this problem could uncover some fascinating secrets about the vast world of simple quadrilaterals. The very thought sent a spark of excitement coursing through her polygons.\n\nDetermined to solve the mystery, Polly embarked on an incredible journey throughout Numerica. She consulted wise mathematicians, scoured ancient texts, and even sought advice from the Supreme Circle, who was known for her immense wisdom. She traveled from polygon kingdom to polygon kingdom, gathering clues and piecing together the intricate puzzle.\n\nAs Polly tirelessly continued her quest, she encountered various challenges along the way. Some geometric shapes were downright complex, while others seemed to defy logic. Still, she persevered, driven by her insatiable curiosity and the desire to uncover the final piece of the puzzle.\n\nAfter months of toiling, Polly finally arrived at the breathtaking Golden Lattice Temple. This ancient temple was said to hold the key to unlocking the secrets of the mathematical problem she had encountered. The sun cast a golden glow upon the temple, illuminating the path to her destiny.\n\nWith bated breath, Polly approached the temple's entrance, her polygons quivering with anticipation. She pushed open the massive doors and entered a chamber filled with shimmering mathematical equations. The walls were adorned with intricate patterns, each one representing a different simple quadrilateral.\n\nAs Polly studied the patterns, her mathematical mind began to piece together the final answer. She reveled in the realization that she had solved the mystery at last. The numbers aligned perfectly, and she knew that she had discovered the formula for Q(12345, 6789) mod 135707531.\n\nBut as she basked in the glory of her accomplishment, a question formed in her mind. A question she believed only the reader, dear friend, could answer:\n\n\"What is Q(12345, 6789) mod 135707531?\"\n\nAnd so, dear reader, the question now falls into your hands. Can you unlock the secrets of Polly's journey and solve the mathematical problem?"}, {"id": 490, "euler_id": 490, "title": "Jumping frog", "problem": "There are n stones in a pond, numbered 1 to n. Consecutive stones are spaced one unit apart.\nA frog sits on stone 1. He wishes to visit each stone exactly once, stopping on stone n. However, he can only jump from one stone to another if they are at most 3 units apart. In other words, from stone i, he can reach a stone j if 1 \u2264 j \u2264 n and j is in the set {i-3, i-2, i-1, i+1, i+2, i+3}.\nLet f(n) be the number of ways he can do this. For example, f(6) = 14, as shown below:\n1 \u2192 2 \u2192 3 \u2192 4 \u2192 5 \u2192 6 \n1 \u2192 2 \u2192 3 \u2192 5 \u2192 4 \u2192 6 \n1 \u2192 2 \u2192 4 \u2192 3 \u2192 5 \u2192 6 \n1 \u2192 2 \u2192 4 \u2192 5 \u2192 3 \u2192 6 \n1 \u2192 2 \u2192 5 \u2192 3 \u2192 4 \u2192 6 \n1 \u2192 2 \u2192 5 \u2192 4 \u2192 3 \u2192 6 \n1 \u2192 3 \u2192 2 \u2192 4 \u2192 5 \u2192 6 \n1 \u2192 3 \u2192 2 \u2192 5 \u2192 4 \u2192 6 \n1 \u2192 3 \u2192 4 \u2192 2 \u2192 5 \u2192 6 \n1 \u2192 3 \u2192 5 \u2192 2 \u2192 4 \u2192 6 \n1 \u2192 4 \u2192 2 \u2192 3 \u2192 5 \u2192 6 \n1 \u2192 4 \u2192 2 \u2192 5 \u2192 3 \u2192 6 \n1 \u2192 4 \u2192 3 \u2192 2 \u2192 5 \u2192 6 \n1 \u2192 4 \u2192 5 \u2192 2 \u2192 3 \u2192 6\nOther examples are f(10) = 254 and f(40) = 1439682432976.\nLet S(L) = \u2211 f(n)3 for 1 \u2264 n \u2264 L.\nExamples:\nS(10) = 18230635\nS(20) = 104207881192114219\nS(1 000) mod 109 = 225031475\nS(1 000 000) mod 109 = 363486179\nFind S(1014) mod 109.", "solution": "777577686", "difficulty": 95, "story": "Once upon a time, in a faraway land called Numeria, there lived a clever but mischievous little frog named Freddy. Freddy was not your ordinary amphibian - he possessed a rare gift for mathematics.\n\nFreddy lived in a beautiful pond surrounded by lush greenery. The pond was filled with n stones, each numbered from 1 to n, and they were spaced exactly one unit apart. One sunny morning, as Freddy hopped from stone to stone, he stumbled upon a mysterious mathematical problem inscribed on a large lily pad.\n\nIntrigued, Freddy began to read. The problem stated that he had to visit each stone only once, starting from stone 1 and ending on stone n. The catch was that he could only jump from one stone to another if they were at most 3 units apart.\n\nAs Freddy pondered the problem, he couldn't help but feel a wave of excitement rush over him. He saw it as a challenge, an opportunity to put his mathematical skills to the test. Determined to find the solution, he decided to embark on an extraordinary adventure.\n\nFreddy began his journey, hopping from stone to stone, carefully calculating the possibilities at each step. He realized that the number of ways he could accomplish this task was represented by a mathematical function called f(n), with 'n' indicating the total number of stones.\n\nWith each leap, Freddy's excitement grew as he discovered new patterns and possibilities. He saw that the solutions could be achieved through various combinations and sequences, each one unique and fascinating. From stone to stone, he danced to the rhythm of mathematics, uncovering the hidden symphony of numbers.\n\nAs Freddy hopped from stone 1 to stone n, he encountered numerous obstacles and puzzles along the way. He overcame them all with his sharp mind and creative thinking. His journey was not merely physical but also a mental exploration through the vast world of mathematical possibilities.\n\nEventually, after numerous leaps, Freddie completed his quest, reaching stone n with a triumphant leap. He was ecstatic, knowing that he had accomplished something remarkable. But his adventure wasn't just a personal victory. It had also uncovered the power of mathematics and the beauty it held, even in the smallest of details.\n\nHowever, as the journey came to an end, Freddy couldn't help but wonder about the sum of all the solutions he had discovered during his adventure. He realized that the sum, denoted by S(L), could be calculated by finding the cube of each f(n) for 1 \u2264 n \u2264 L and adding them all together.\n\nFreddy couldn't wait to find the value of S(1014) mod 109, but he knew he couldn't solve it on his own. He needed someone else to take up the challenge and unlock the secret that lay within this final puzzle.\n\nAs his adventure concluded, Freddy turned to the readers and asked, \"Can you determine S(1014) mod 109? Can you find the sum of all the incredible ways I journeyed through the stones using the mathematical function? Can you unleash the power of numbers and complete the final quest?\"\n\nAnd so, dear reader, the question remains - can you solve the mathematical problem and uncover the value of S(1014) mod 109?\n\nThe answer awaits, hidden within the depths of numerical magic."}, {"id": 589, "euler_id": 589, "title": "Poohsticks Marathon", "problem": "\nChristopher Robin and Pooh Bear love the game of Poohsticks so much that they invented a new version which allows them to play for longer before one of them wins and they have to go home for tea. The game starts as normal with both dropping a stick simultaneously on the upstream side of a bridge. But rather than the game ending when one of the sticks emerges on the downstream side, instead they fish their sticks out of the water, and drop them back in again on the upstream side. The game only ends when one of the sticks emerges from under the bridge ahead of the other one having also 'lapped' the other stick - that is, having made one additional journey under the bridge compared to the other stick.\n\n\nOn a particular day when playing this game, the time taken for a stick to travel under the bridge varies between a minimum of 30 seconds, and a maximum of 60 seconds. The time taken to fish a stick out of the water and drop it back in again on the other side is 5 seconds. The current under the bridge has the unusual property that the sticks' journey time is always an integral number of seconds, and it is equally likely to emerge at any of the possible times between 30 and 60 seconds (inclusive). It turns out that under these circumstances, the expected time for playing a single game is 1036.15 seconds (rounded to 2 decimal places). This time is measured from the point of dropping the sticks for the first time, to the point where the winning stick emerges from under the bridge having lapped the other.\n\n\nThe stream flows at different rates each day, but maintains the property that the journey time in seconds is equally distributed amongst the integers from a minimum, n, to a maximum, m, inclusive. Let the expected time of play in seconds be E(m,n). Hence E(60,30)=1036.15...\n\n\nLet S(k)=\u2211m=2k\u2211n=1m\u22121E(m,n).\n\n\nFor example S(5)=7722.82 rounded to 2 decimal places.\n\n\nFind S(100) and give your answer rounded to 2 decimal places.\n", "solution": "131776959.25", "difficulty": 95, "story": "Once upon a time in the enchanting Hundred Acre Wood, Christopher Robin and Pooh Bear spent their days exploring, playing games, and enjoying the company of their friends. Their favorite pastime was a game called Poohsticks, a simple yet thrilling game of dropping sticks off a bridge and waiting to see whose stick emerged first on the downstream side. But as the duo's excitement grew, so did their desire for a more challenging version of the game.\n\nOne sunny day, as they sat on the bridge overlooking the babbling brook, a mischievous idea sparked in Christopher Robin's mind. He turned to Pooh Bear with a gleam in his eyes and said, \"What if, my dear Pooh, we make our beloved Poohsticks game last longer? What if we drop our sticks back into the water and continue the game until one stick laps the other?\"\n\nPooh Bear's face lit up with delight. \"Oh, how splendidly exciting that sounds, Christopher Robin! We shall play and play, and the fun will never end!\"\n\nAnd so, their modified version of Poohsticks was born. They dropped their sticks simultaneously on the upstream side of the bridge and eagerly watched as the sticks disappeared beneath the surface. Once the sticks emerged on the downstream side, they fished them out, their hands dripping with anticipation and joy, and dropped them back in on the upstream side.\n\nThe rules of this new game dictated that only when one stick emerged from under the bridge, having made one additional journey compared to the other stick, would the game end. The pairs of journeys under the bridge made the game more intriguing, and Christopher Robin and Pooh Bear found themselves lost in the magic of their game for hours on end.\n\nBut every game has its unique challenges, and this game of Poohsticks was no exception. The time taken for a stick to travel under the bridge varied, with a minimum of 30 seconds and a maximum of 60 seconds. To complicate matters further, the time taken to fish a stick out of the water and drop it back in again was a fixed 5 seconds.\n\nUnbeknownst to our friends, the current under the bridge had a remarkable property. The sticks' journey time would always be an integral number of seconds, and it was equally likely to emerge at any of the possible times between 30 and 60 seconds.\n\nSlowly but steadily, Christopher Robin and Pooh Bear immersed themselves in this intricate game. They developed strategies, calculated probabilities, and marveled at the elusive nature of time. The joy they experienced dwarfed any meal or honey pot they could ever savor.\n\nAs the seasons changed and days turned into months, they found themselves measuring time in anticipation. Yet, time slipped through their fingers, proving to be as elusive as the seconds under the bridge. The concept of expected time became paramount as they sought to find a way to predict the average game duration.\n\nAfter countless hours of musing and tinkering, they discovered that the expected time for playing a single game, under these peculiar circumstances, amounted to precisely 1036.15 seconds. To their delight, they realized their quest for a longer-lasting game had reached its mathematical apex.\n\nTheir discovery ignited a fire within their curious hearts. They flourished under the magic of numbers and probabilities, drawing inspiration from their beloved Poohsticks game, where whimsy danced hand-in-hand with logic.\n\nIn the years that followed, Christopher Robin and Pooh Bear delved deeper into mathematics, constantly seeking new puzzles and challenges to guide their thoughts. Their unwavering friendship and shared curiosity fueled their intellectual journeys, and they embarked on countless adventures together, both within and outside the realm of numbers.\n\nNow, as we journey back to the Hundred Acre Wood, I must pose a question to you, dear reader. Given the sum S(k) = \u2211m=2k\u2211n=1m\u22121E(m,n), with k representing the maximum journey time under the bridge, what is the value of S(100)? Can you solve this intricate mathematical problem and uncover the true essence of time lost in the whimsical world of Poohsticks?"}, {"id": 591, "euler_id": 591, "title": "Best Approximations by Quadratic Integers", "problem": "Given a non-square integer d, any real x can be approximated arbitrarily close by quadratic integers a+bd, where a,b are integers. For example, the following inequalities approximate \u03c0 with precision 10\u221213:\n43756361915202\u22126188084046055<\u03c0<7211333155822\u22121019836515172 \nWe call BQAd(x,n) the quadratic integer closest to x with the absolute values of a,b not exceeding n. We also define the integral part of a quadratic integer as Id(a+bd)=a.\nYou are given that:\nBQA2(\u03c0,10)=6\u221222\nBQA5(\u03c0,100)=265\u221255\nBQA7(\u03c0,106)=560323\u22122117817\nI2(BQA2(\u03c0,1013))=\u22126188084046055Find the sum of |Id(BQAd(\u03c0,1013))| for all  non-square positive integers less than 100.", "solution": "526007984625966", "difficulty": 95, "story": "Once upon a time in the small village of Mathhaven, nestled deep in the valleys of a far-off land, there lived a young and curious mathematician named Amelia. Amelia had a knack for numbers and a passion for unraveling the mysteries of the universe through mathematical equations. She spent her days pouring over textbooks, scribbling on parchment, and finding solace in the beautiful patterns and symmetries that numbers held.\n\nOne fateful day, as Amelia delved deeper into the realm of quadratic integers, she stumbled upon a mathematical problem that intrigued her like none other. It spoke of approximating any real number, no matter how complex, with the help of quadratic integers. It was a concept she had never encountered before, and she was instantly captivated.\n\nThe problem went on to present various examples, showcasing the power of quadratic integers and their ability to approximate with immense precision. Most notably, it mentioned how beloved \u03c0 could be approximated using quadratic integers as close as one desired. It went on to define the function BQAd(x,n), which denoted the quadratic integer closest to a real number x, with the absolute values of a and b not exceeding n.\n\nAmelia's mind raced with possibilities. She knew that this newfound knowledge held tremendous potential. For the first time, she could see the intertwining beauty of mathematics and the real world. But she also knew that applying this concept practically would require her to make a leap of faith, to step beyond the safety of theory and into the realm of experimentation.\n\nDriven by her insatiable curiosity, Amelia decided to put the power of quadratic integers to the test. She wanted to understand their impact in real-life scenarios, and so she embarked on a journey that would change her life forever.\n\nAs Amelia traveled from village to village, she encountered people with diverse backgrounds and unique mathematical problems. She approached each situation with an open mind, using her knowledge of quadratic integers to bring a fresh perspective to the challenges at hand. In one village, she helped the blacksmith optimize the design of his horseshoes using quadratic approximations. In another, she assisted the village healer in determining the most effective dosage of medicines through precise quadratic calculations.\n\nWord of Amelia's remarkable abilities soon spread throughout the land. Scholars and commonfolk alike sought her advice, eager to witness the transformative power of quadratic integers in action. Amelia became a beacon of hope, inspiring others to explore the beauty and practicality of mathematics.\n\nBut as Amelia continued her journey, she couldn't help but wonder about the limits of quadratic integers. How far could she push the boundaries of approximation? And what would be the cumulative effect of these approximations on the integral parts of quadratic integers?\n\nDeep in thought, Amelia found herself on the edge of a cliff overlooking a vast expanse of land. She gazed at the rolling hills and sparkling rivers, lost in contemplation. The answer to her question lay on the tip of her tongue, yet it eluded her. She yearned to know the sum of the integral parts of quadratic integers for all the non-square positive integers below 100. \n\nAmelia realized the significance of her question. It wasn't just a mathematical puzzle; it was a gateway to unraveling the secrets of the quadratic world. Solving this problem would provide invaluable insights into the interplay between numbers and approximation, offering endless possibilities for future discoveries.\n\nWith a determined glint in her eyes, Amelia scribbled the question into her notebook, vowing to find the answer. She knew that the path ahead would be challenging, that it would demand countless hours of calculation and an unwavering dedication to the pursuit of knowledge. But she was ready. Ready to embrace the enigma of quadratic integers and unlock their hidden potential.\n\nAnd so, dear reader, I pose this question to you: What is the sum of |Id(BQAd(\u03c0,1013))| for all non-square positive integers less than 100? Can you venture into the realm of numbers, just as Amelia did, and uncover the elusive solution? The answer awaits, a testament to the beauty and mystery of mathematics."}, {"id": 702, "euler_id": 702, "title": "Jumping Flea", "problem": "A regular hexagon table of side length N is divided into equilateral triangles of side length 1. The picture below is an illustration of the case N=3.\n\n\nAn flea of negligible size is jumping on this table. The flea starts at the centre of the table. Thereafter, at each step, it chooses one of the six corners of the table, and jumps to the mid-point between its current position and the chosen corner.\nFor every triangle T, we denote by J(T) the minimum number of jumps required for the flea to reach the interior of T. Landing on an edge or vertex of T is not sufficient.\nFor example, J(T)=3 for the triangle marked with a star in the picture: by jumping from the centre half way towards F, then towards C, then towards E.\nLet S(N) be the sum of J(T) for all the upper-pointing triangles T in the upper half of the table. For the case N=3, these are the triangles painted black in the above picture.\nYou are given that S(3)=42, S(5)=126, S(123)=167178, and S(12345)=3185041956.\nFind S(123456789).", "solution": "622305608172525546", "difficulty": 95, "story": "Once upon a time in a small village, there was a young girl named Lily who loved exploring the vast fields surrounding her home. She was known for her curiosity and fearlessness. One sunny afternoon, as Lily ventured into the woods, she stumbled upon a hidden opening that led her to a magical land.\n\nAs she stepped through the portal, she found herself in a breathtaking meadow full of vibrant flowers and chirping birds. In the center of this enchanting place stood a hexagonal table, shimmering with golden outlines and patterns. Lily's eyes widened with wonder as she approached the table, her heart pounding with excitement.\n\nLily had always been fascinated by puzzles and brain-teasers, so this peculiar table immediately intrigued her. She leaned closer and noticed that it was divided into tiny equilateral triangles, each measuring one unit in length. The hexagonal table seemed to invite Lily to solve its mystery.\n\nSuddenly, something peculiar caught her eye \u2013 a tiny flea, barely visible to the naked eye, hopping around the table. It started at the center and then chose one of the six corners before making a leap towards the midpoint between its current position and the chosen corner.\n\nIntrigued by this playful flea, Lily observed its movements carefully. Soon, it became clear that each jump brought the flea closer to the interior of specific upper-pointing triangles. She realized that this flea's hops could be represented as a mathematical problem.\n\nCuriosity piqued, Lily began to ponder the mystery while observing the flea's every move. As the creature skittered from one triangle to another, Lily couldn't help but wonder about the true nature of this fascinating game.\n\nDays turned into weeks, and Lily found herself spending more and more time in the magical meadow. Every leap of the flea became a clue, guiding her towards the answer to the problem. She witnessed firsthand how the flea calculated the minimum number of jumps required to reach the interior of each upper-pointing triangle.\n\nStruck by inspiration, Lily embarked on a quest to uncover the secrets hidden within the hexagonal table. She delved deep into her studies, studying the properties of equilateral triangles and analyzing the flea's pattern of movement. Her passion for solving puzzles and her newfound understanding of the game drove her forward.\n\nCountless hours were spent experimenting and strategizing. Lily's determination fueled her exploration, leading her to solve the puzzles one by one. Each time she unraveled the magic within a triangle, a sense of accomplishment washed over her.\n\nAfter years of tireless effort, Lily had conquered the challenges presented in various hexagonal tables. From size N=3 to N=12345, she triumphed over every obstacle along the way. As she completed each puzzle, the sum of J(T) for all the upper-pointing triangles in the upper half of the table revealed itself.\n\nNow, it was time for Lily's final test \u2013 the ultimate culmination of her journey. The tables had grown increasingly complex, but she was undeterred. She was ready to face the grand puzzle that awaited her.\n\nWith anticipation and adrenaline coursing through her veins, Lily approached the magnificent hexagonal table with a side length of N=123456789. This colossal challenge was like nothing she had encountered before. The stakes were high, and the outcome would determine her legacy as a master of mathematical puzzles.\n\nAll the knowledge she had acquired, all the trials she had overcome, and all the leaps the flea had taken brought her to this defining moment. With a deep breath, Lily cast her gaze upon the table and its intricate design, preparing herself for the final riddle.\n\nAs she pondered the true essence of the puzzle, she couldn't help but wonder about the answer to S(123456789). What was the sum of J(T) for all the upper-pointing triangles in the upper half of the table?\n\nAnd so, dear reader, I pose this question to you: Can you solve the mathematical problem that Lily sought to conquer? What is the value of S(123456789)?"}, {"id": 768, "euler_id": 768, "title": "Chandelier", "problem": "A certain type of chandelier contains a circular ring of n evenly spaced candleholders.\nIf only one candle is fitted, then the chandelier will be imbalanced. However, if a second identical candle is placed in the opposite candleholder (assuming n is even) then perfect balance will be achieved and the chandelier will hang level.\nLet f(n,m) be the number of ways of arranging m identical candles in distinct sockets of a chandelier with n candleholders such that the chandelier is perfectly balanced.\nFor example, f(4,2)=2: assuming the chandelier's four candleholders are aligned with the compass points, the two valid arrangements are \"North & South\" and \"East & West\". Note that these are considered to be different arrangements even though they are related by rotation.\nYou are given that f(12,4)=15 and f(36,6)=876.\nFind f(360,20).", "solution": "14655308696436060", "difficulty": 95, "story": "Once upon a time in the enchanting village of Numeria, there lived a talented young math magician named Milo. Milo was just an ordinary boy with extraordinary mathematical skills. He could calculate complex equations quicker than a blink of an eye and solve puzzles that baffled even the most seasoned mathematicians.\n\nOne bright summer day, as Milo ventured through the village, he stumbled upon a peculiar sight. A magnificent chandelier, adorned with sparkling crystals, hung in the center of the bustling town square. The villagers marveled at its beauty, but there was a problem\u2014a certain kind of problem.\n\nThe chandelier, with its circular ring of candleholders, had been crafted with the utmost care. However, if only one candle was fitted onto it, the balance was disrupted, causing it to hang askew. It was visually displeasing to the villagers and certainly not what they had hoped for.\n\nMilo's curious nature was piqued, and he couldn't resist the allure of solving this mathematical conundrum. He approached the chandelier, studying it intently, his mind buzzing with possibilities. It struck him that if a second identical candle were placed in the opposite candleholder, perfect balance would be achieved, and the chandelier would hang level.\n\nThe thought of finding a solution delighted Milo, but he also knew that this problem went beyond mere aesthetics. The villagers had placed their hopes on this chandelier as a symbol of unity and harmony. It needed to be perfectly balanced.\n\nWithout delay, Milo began experimenting with the arrangement of candles on the chandelier. He realized that each unique arrangement formed a different balance, even if they were related by rotation. For instance, if the chandelier had four candleholders, there were two valid arrangements: \"North & South\" and \"East & West.\"\n\nAs the days turned into weeks, Milo continued his diligent quest for the ideal arrangement. The villagers observed his unwavering determination, their faith in him growing exponentially. The chandelier needed Milo's magic touch, and he wasn't about to disappoint.\n\nFinally, after much trial and error, Milo discovered the patterns and relationships governing the balance of candles on the circular chandelier. With a great sense of accomplishment, he called out the numbers confidently, announcing how many ways m identical candles could be arranged in n distinct sockets to achieve perfection.\n\nOne day, word of Milo's success reached the ears of two young villagers, Eliza and Oliver. They had always been fond of mathematics, and their curiosity now burned with the desire to follow in Milo's footsteps. They were determined to understand the intricacies of this curious chandelier conundrum.\n\nEliza and Oliver approached Milo, their eyes beaming with excitement. They asked him a question that had been burning in their minds. \"Milo, we have heard of your brilliant achievements. Could you tell us the number of ways m identical candles can be arranged in n distinct sockets of a chandelier with perfect balance?\"\n\nMilo smiled at the eager young minds, knowing that he had ignited their mathematical passion. He leaned in, preparing to share his wisdom, but suddenly stopped himself. A thought struck him, and he realized that Eliza and Oliver were ready to uncover the secrets for themselves.\n\nWith a playful grin, Milo posed a new challenge to Eliza and Oliver. \"My dear friends, I have an extraordinary task for you. I want you to find the number of ways m identical candles can be arranged in n distinct sockets of a chandelier that contains 360 candleholders and 20 candles. Can you solve this mystery?\"\n\nAs Eliza and Oliver exchanged exhilarated glances, the village of Numeria buzzed with anticipation for a new generation of math magicians in the making. And with their boundless determination and Milo's guidance, the chandelier's perfect balance would forever remain a captivating journey of discovery.\n\nSo, dear reader, as you embark on your own mathematical quest, can you find the answer to Milo's question? How many ways can m identical candles be arranged in n distinct sockets of a chandelier with 360 candleholders and 20 candles?"}, {"id": 777, "euler_id": 777, "title": "Lissajous Curves", "problem": "For coprime positive integers a and b, let Ca,b be the curve defined by:\nx=cos\u2061(at)y=cos\u2061(b(t\u2212\u03c010))\nwhere t varies between 0 and 2\u03c0.\nFor example, the images below show C2,5 (left) and C7,4 (right):\n\n\n\nDefine d(a,b)=\u2211(x2+y2), where the sum is over all points (x, y) at which Ca,b crosses itself.\nFor example, in the case of C2,5 illustrated above, the curve crosses itself at two points: (0.31, 0) and (-0.81, 0), rounding coordinates to two decimal places, yielding d(2,5)=0.75. Some other examples are d(2,3)=4.5, d(7,4)=39.5, d(7,5)=52, and d(10,7)=23.25.\nLet s(m)=\u2211d(a,b), where this sum is over all pairs of coprime integers a,b with 2\u2264a\u2264m and 2\u2264b\u2264m.\nYou are given that s(10)=1602.5 and s(100)=24256505.\nFind s(106). Give your answer in scientific notation rounded to 10 significant digits; for example s(100) would be given as 2.425650500e7.", "solution": "2.533018434e23", "difficulty": 95, "story": "Once upon a time, in a kingdom far away, there lived a wise old mathematician named Professor Archimedes. He was renowned for his brilliant mind and his ability to solve any mathematical problem that came his way. But there was one problem that had intrigued him for years, a problem that seemed to have no solution. It was a problem that had vexed him for so long that he couldn't help but ponder over it day and night.\n\nThe problem was known as the Coaxial Curve Mystery, and it had been a subject of debate among mathematicians for centuries. The mystery revolved around a peculiar curve defined by two positive, coprime integers, a and b. Professor Archimedes had spent countless hours studying the properties of this curve, trying to find a pattern or a formula that would unveil its secrets.\n\nLegend had it that this mysterious curve had the power to grant its discoverer unimaginable knowledge and wisdom. Many had tried to solve the puzzle, but all had failed. It seemed as though the curve was intentionally hiding its true nature, only revealing snippets of its enigma to those who dared to venture into its depths.\n\nOne day, a young and aspiring mathematician named Lily arrived at the Kingdom, eager to learn from the wise Professor Archimedes. She had heard tales of his brilliance and had traveled from afar to seek his guidance in her pursuit of knowledge.\n\nLily was a voracious learner, always hungry for new challenges and eager to unravel the mysteries of the universe. When she heard about the Coaxial Curve Mystery, her eyes sparkled with excitement. She knew that this was her chance to prove herself and make a name for herself in the world of mathematics.\n\nAfter much persuasion, Professor Archimedes agreed to mentor Lily. He saw in her a fierce determination and an insatiable curiosity that reminded him of his younger self. Together, they delved deep into the intricacies of the Coaxial Curve Mystery, exploring its properties and searching for elusive solutions.\n\nDays turned into weeks and weeks turned into months. Lily and Professor Archimedes tirelessly worked, pouring over pages and pages of equations, hoping to find a breakthrough. But despite their efforts, the solution remained elusive.\n\nAs time went on, Lily began to feel disheartened. Doubt began to creep into her mind, and she questioned whether she was truly capable of solving such a profound mystery. But just as she was about to give up, a ray of hope shone through the darkness.\n\nOne evening, while staring at the night sky, decorated with stars that resembled the curves they had been studying, Lily had a sudden realization. She rushed to Professor Archimedes, her eyes shining with excitement.\n\n\"Professor, I think I've found something!\" she exclaimed, unable to contain her enthusiasm. \"I have discovered a pattern in the way the curve crosses itself!\"\n\nProfessor Archimedes, ever the skeptic, listened intently as Lily described her observations. He scrutinized her findings, testing them for inconsistencies, and after many calculations, he realized that Lily was onto something.\n\nThe revelation filled the air with an electrifying energy. Lily and Professor Archimedes worked together to refine her findings, meticulously calculating the sums and exploring the intricacies of the Coaxial Curve. The pieces of the puzzle started to come together, but there was still a missing piece, a final answer that remained elusive.\n\nAnd so, they turned to you, dear reader. Armed with their discoveries and their unyielding determination, they invite you to dive into the world of the Coaxial Curve Mystery. Professor Archimedes and Lily are convinced that with your help, they can finally unlock the secret that has eluded mathematicians for centuries.\n\nBut the question remains, can you solve the mathematical problem that has intrigued Professor Archimedes for so long? Can you find the sum s(10^6) and put an end to the Coaxial Curve Mystery? The fate of knowledge and wisdom hangs in the balance. It is up to you to rise to the challenge and become a part of mathematical history."}, {"id": 781, "euler_id": 781, "title": "Feynman Diagrams", "problem": "Let F(n) be the number of connected graphs with blue edges (directed) and red edges (undirected) containing:\n\ntwo vertices of degree 1, one with a single outgoing blue edge and the other with a single incoming blue edge.\nn vertices of degree 3, each of which has an incoming blue edge, a different outgoing blue edge and a red edge.\n\nFor example, F(4)=5 because there are 5 graphs with these properties:\n\n\n\nYou are also given F(8)=319.\nFind F(50000). Give your answer modulo 1000000007.\nNOTE: Feynman diagrams are a way of visualising the forces between elementary particles. Vertices represent interactions. The blue edges in our diagrams represent matter particles (e.g. electrons or positrons) with the arrow representing the flow of charge. The red edges (normally wavy lines) represent the force particles (e.g. photons). Feynman diagrams are used to predict the strength of particle interactions.", "solution": "162450870", "difficulty": 95, "story": "In the quiet town of Mathville, the eccentric but brilliant Professor Fibonacci lived in a small cottage at the edge of town. Known for his love of numbers and puzzles, the professor would spend hours poring over complex mathematical problems, searching for their hidden patterns and solutions.\n\nOne day, a young girl named Lily stumbled upon the professor's cottage while exploring the nearby forest. Fascinated by the strange symbols and equations on the walls, she stepped inside cautiously.\n\nAs she entered, Lily noticed Professor Fibonacci sitting at his desk, his eyes fixed on a particularly challenging problem scrawled across a chalkboard. Curiosity piqued, she couldn't help but ask what he was working on.\n\n\"I'm glad you dropped by, young Lily,\" the professor replied. \"I'm trying to solve an intriguing mathematical puzzle involving graphs, vertices, and edges. It's quite fascinating, really.\"\n\nIntrigued, Lily approached the chalkboard, her eyes scanning the problem description. The professor explained that there were various types of edges in these graphs\u2014blue edges, representing directed connections, and red edges, representing undirected connections.\n\nHe continued, \"In particular, I'm interested in finding out the number of connected graphs that satisfy specific criteria. For example, I need to determine how many graphs contain two vertices of degree 1\u2014one with a single outgoing blue edge and the other with a single incoming blue edge. Additionally, the graphs must have n vertices of degree 3, each with an incoming blue edge, a different outgoing blue edge, and a red edge.\"\n\nLily furrowed her brows, trying to understand the concept. Numbers, shapes, and arrows swirled in her mind, forming pictures she couldn't quite grasp. Although slightly overwhelmed, she couldn't help but start doodling a few examples of these strange graphs on her notepad.\n\nAs days turned into weeks, Lily found herself visiting Professor Fibonacci regularly. She became increasingly captivated by the mystery of the graphs and the ever-evolving complexity of the puzzle. The pair spent hours discussing various methods, hypothesizing solutions, and occasionally inventing new rules to test the boundaries of what was known. Lily's excitement grew, and her passion for mathematics flourished under the professor's guidance.\n\nSlowly, her notepad filled with countless examples and diagrams\u2014meticulously drawn blue and red edges intertwining to create intricate patterns. The professor marveled at Lily's creativity and dedication, encouraging her to keep exploring and experimenting.\n\nOne sunny afternoon, as the pair sat in the cottage garden, their discussion turned to the elusive F(50000). Lily gazed at the professor, a mix of awe and determination in her eyes.\n\n\"Professor Fibonacci,\" she ventured, \"if we can find patterns in smaller examples, could we possibly discover a formula or algorithm to calculate F(50000)?\"\n\nThe professor smiled, his eyes twinkling with delight. \"Indeed, my dear Lily, that is the question that has consumed me for months. The more we understand these graphs, their symmetries, and their relationships, the closer we come to unraveling the secrets hidden within.\"\n\nLily's heart raced with excitement, and she couldn't wait to dive deeper into the mathematical rabbit hole she had stumbled upon. With F(8) and countless other examples guiding their way, the professor and Lily embarked on a grand quest to unveil the solution to F(50000), eager to challenge the limits of human understanding.\n\nAnd so, the story of Professor Fibonacci and Lily's exploration of these mysterious and beautiful graphs continues. As they venture further into the realm of mathematics, the question remains: Can they unlock the secrets hidden within the ever-expanding world of interconnected graphs and determine the value of F(50000) modulo 1000000007?\n\nWill you be the one to solve this mathematical puzzle?"}, {"id": 786, "euler_id": 786, "title": "Billiard", "problem": "\nThe following diagram shows a billiard table of a special quadrilateral shape.\nThe four angles A,B,C,D are 120\u2218,90\u2218,60\u2218,90\u2218 respectively, and the lengths AB and AD are equal.\n\n\n\n\n\nThe diagram on the left shows the trace of an infinitesimally small billiard ball, departing from point A, bouncing twice on the edges of the table, and finally returning back to point A. The diagram on the right shows another such trace, but this time bouncing eight times:\n\n\n\n\n\nThe table has no friction and all bounces are perfect elastic collisions.\nNote that no bounce should happen on any of the corners, as the behaviour would be unpredictable.\n\n\nLet B(N) be the number of possible traces of the ball, departing from point A, bouncing at most N times on the edges and returning back to point A.\n\n\nFor example, B(10)=6, B(100)=478, B(1000)=45790.\n\n\nFind B(109).\n", "solution": "45594532839912702", "difficulty": 95, "story": "Once upon a time in a distant land, there was a young prince named Alexander. He was known throughout the kingdom for his brilliance and love for challenges. One day, while exploring the castle library, he stumbled upon an ancient book with a curious problem that intrigued his mathematical mind.\n\nThe book contained a diagram of a billiard table, unlike any Alexander had ever seen before. It was a special quadrilateral shape with four angles marked as A, B, C, and D. The angles were 120\u2218, 90\u2218, 60\u2218, and 90\u2218 respectively. What fascinated Alexander the most was that the lengths AB and AD were equal.\n\nUnable to resist the lure of the problem, Alexander decided to investigate further. He read that the diagram showed the trace of an infinitesimally small billiard ball departing from point A, bouncing twice on the edges of the table, and finally returning back to point A. The book also showed another trace with the ball bouncing eight times.\n\nThe details captivated Alexander. He imagined the ball bouncing off the edges with perfect elasticity, no friction impeding its path. However, he noticed a crucial note that no bounce should occur on any of the corners, as the behavior would be unpredictable.\n\nAs the prince pondered the problem, he could sense a magical connection between the land he ruled and the mysterious table. Something in his gut told him that unraveling the secret would bring great prosperity to his kingdom.\n\nWeeks turned into months as Alexander delved deeper into the mathematical problem. He determined that the number of possible traces of the ball, departing from point A, and bouncing at most N times on the edges, was denoted as B(N).\n\nExcitement welled up within him as he discovered examples of B(N). The book highlighted that B(10) equaled 6, B(100) equaled 478, and B(1000) equaled 45790. Each result seemed to be a stepping stone to the grand revelation he sought.\n\nDetermined to unlock the ultimate potential hidden within the problem, Alexander devoted all his time to finding the value of B(109). This became his obsession, with servants worriedly whispering about the toll it was taking on his physical and mental well-being.\n\nBut what mattered to Alexander was the flourishing future he envisioned for his kingdom. He knew that the unique shape of the billiard table held the key to unlocking untapped resources and technological advancements. The perfect elasticity of the ball's bounces symbolized the limitless potential that awaited his people.\n\nAs the days turned into nights, Alexander's dedication did not waver. He sacrificed sleep, neglected his recreational pursuits, and even missed important council meetings. His quest for the answer to B(109) consumed his very being.\n\nNow, his journey culminates in this story, with the question burning brighter than ever. Can you, dear reader, solve the mathematical problem that has captivated Prince Alexander's entire existence? What is the value of B(109)?"}, {"id": 806, "euler_id": 806, "title": "Nim on Towers of Hanoi", "problem": "This problem combines the game of Nim with the Towers of Hanoi. For a brief introduction to the rules of these games, please refer to Problem 301 and Problem 497, respectively.\nThe unique shortest solution to the Towers of Hanoi problem with n disks and 3 pegs requires 2n\u22121 moves. Number the positions in the solution from index 0 (starting position, all disks on the first peg) to index 2n\u22121 (final position, all disks on the third peg).\nEach of these 2n positions can be considered as the starting configuration for a game of Nim, in which two players take turns to select a peg and remove any positive number of disks from it. The winner is the player who removes the last disk.\nWe define f(n) to be the sum of the indices of those positions for which, when considered as a Nim game, the first player will lose (assuming an optimal strategy from both players).\nFor n=4, the indices of losing positions in the shortest solution are 3,6,9 and 12. So we have f(4)=30.\nYou are given that f(10)=67518.\nFind f(105). Give your answer modulo 1000000007.", "solution": "94394343", "difficulty": 95, "story": "Once upon a time in the enchanted kingdom of Numerica, there lived a young mathematician named Lana. Lana was known for her brilliant mind and was always seeking new mathematical challenges to solve. She would spend her days exploring the magical library of Numerica, where books whispered knowledge and numbers danced across the pages.\n\nOne day, as Lana was perusing through a tome of mathematical puzzles, she stumbled upon a peculiar problem that intrigued her. It combined the game of Nim with the Towers of Hanoi, two games she was quite familiar with. It appeared to be a mind-boggling challenge, and Lana couldn't resist the temptation to unravel its secrets.\n\nAccording to the problem, the shortest solution to the Towers of Hanoi with n disks and 3 pegs required 2n\u22121 moves. The positions in this solution were numbered from index 0 to 2n\u22121. These positions could also be considered as the starting configurations for a game of Nim, where two players would take turns removing disks from a peg. The player who removed the last disk would win. Lana was tasked with finding the sum of the indices of losing positions, where the first player would lose assuming both players played optimally.\n\nLana's curiosity was piqued, and she couldn't resist the challenge. She spent days and nights immersed in calculations and strategies, trying to crack the code of this unique problem. As she delved deeper, Lana discovered a hidden pattern in the indices of the losing positions. For n=4, the losing positions had indices 3, 6, 9, and 12. The sum of these indices was 30, which she denoted as f(4).\n\nNow excited and determined, Lana was committed to solving the biggest mystery of all. She crunched the numbers and found that f(10) equaled a staggering 67518. Every calculation brought her closer to the elusive answer, and her passion for this mathematical conundrum grew with each passing moment.\n\nAs Lana continued her journey through the magical kingdom of Numerica, she wondered about the value of f(105). It was an impressive number, and she couldn't help but ponder what its true value might be. The answer would surely unlock a world of knowledge and understanding, but the question remained - what was f(105) modulo 1000000007?\n\nWith a determined sparkle in her eyes, Lana set forth on a new quest. She gathered her wits, her knowledge, and embarked on an adventure filled with numbers, strategy, and excitement. The fate of f(105) rested upon her shoulders, and the captivating journey to solve the mathematical problem had only just begun.\n\nSo, dear reader, can you help Lana in her quest? What is the value of f(105) modulo 1000000007? The answer lies within the mystical realm of Numerica, waiting to be unraveled by those who dare to seek the truth."}, {"id": 812, "euler_id": 812, "title": "Dynamical Polynomials", "problem": "A dynamical polynomial is a monicleading coefficient is 1 polynomial f(x) with integer coefficients such that f(x) divides f(x2\u22122).\nFor example, f(x)=x2\u2212x\u22122 is a dynamical polynomial because f(x2\u22122)=x4\u22125x2+4=(x2+x\u22122)f(x).\nLet S(n) be the number of dynamical polynomials of degree n.\nFor example, S(2)=6, as there are six dynamical polynomials of degree 2:\nx2\u22124x+4,x2\u2212x\u22122,x2\u22124,x2\u22121,x2+x\u22121,x2+2x+1\nAlso, S(5)=58 and S(20)=122087.\nFind S(10000). Give your answer modulo 998244353.", "solution": "986262698", "difficulty": 95, "story": "In the small town of Maplewood, there lived a young girl named Emily who had always been fascinated by puzzles and numbers. Her favorite pastime was spending hours in the town library, pouring over books about mathematics and challenging herself with brainteasers. The town library had an extensive collection of ancient books, and it was in one of these old tomes that Emily stumbled upon a mathematical problem that would change her life.\n\nAs she turned the pages of the book, Emily's eyes widened when she came across a passage that spoke of dynamical polynomials. The author detailed how a dynamical polynomial was a unique polynomial with integer coefficients that had a specific property: it could divide its own squared value minus two. The author called it a \"fascinating mathematical enigma.\"\n\nIntrigued by this concept, Emily delved into the world of dynamical polynomials. She discovered that a polynomial like f(x) = x^2 - x - 2 was indeed a dynamical polynomial because when substituting x^2 - 2 into the equation, it resulted in f(x^2 - 2) = x^4 - 5x^2 + 4, which could be factored into (x^2 + x - 2) * f(x). The possibilities seemed endless as she realized the vast potential that lay hidden within these polynomials.\n\nDetermined to explore this field further, Emily sought out the help of her mathematics teacher, Professor Thompson. The professor turned out to be just as enamored with the concept of dynamical polynomials and became Emily's mentor, guiding her through the intricate nature of these mathematical entities. They spent countless hours working side by side, analyzing different polynomials, and deriving new patterns. Slowly but surely, Emily's understanding grew, and she started to unravel the secrets of the dynamical polynomials.\n\nWord of Emily's remarkable abilities in mathematics began to spread throughout the town. Some believed she had a gift, while others saw her as a prodigy. Among those who took an interest in Emily's studies was a mysterious old man named Mr. Stevens. He had once been a distinguished mathematician but had since retired from academia and settled down in Maplewood.\n\nMr. Stevens knew something about dynamical polynomials that Emily had not yet discovered. He had uncovered a formula to calculate the number of dynamical polynomials of a given degree, denoted as S(n). Intrigued, Emily approached Mr. Stevens to learn more about this formula.\n\nAs Emily sat with Mr. Stevens in his cozy study, the old mathematician revealed that the formula for S(n) was not an easy one. It involved complex calculations and was to be taken modulo 998244353. The task seemed daunting, but Emily's determination soared. She knew that finding the value of S(10000) would not be an easy feat, but it was a challenge that she was willing to take on.\n\nDays turned into weeks, and weeks turned into months, as Emily and Mr. Stevens delved deeper into the mathematical labyrinth of dynamical polynomials. They worked alongside each other, combing through mountains of calculations, deriving new theories, and testing their hypotheses. Their collaboration was intense, filled with moments of elation and occasional frustrations.\n\nAs they neared the end of their journey, Emily was on the verge of solving the elusive formula for S(10000). Her heart raced with excitement, knowing that her findings could revolutionize the field of mathematics. However, amidst her jubilation, a lingering question dawned upon her:\n\n\"Could S(10000) truly be calculated? And if so, what would be its value modulo 998244353?\"\n\nWith that lingering question, Emily knew her journey was not quite complete. The answer laid hidden within the mathematical realm, waiting to be unlocked. And so, she set off on her quest, driven by a relentless curiosity and an unquenchable thirst for knowledge.\n\nAs she ventured forth, solving the mathematical problem became an obsession, consuming her thoughts day and night. Emily knew that the answer would be her ultimate triumph\u2014a testament to her perseverance, her intellect, and her love for the enigmatic world of mathematics.\n\nBut dear reader, can you solve the mystery that Emily pursued relentlessly? Can you find the value of S(10000) modulo 998244353?"}]