[{"id": 88, "euler_id": 88, "title": "Product-sum numbers", "problem": "A natural number, N, that can be written as the sum and product of a given set of at least two natural numbers, {a1, a2, ... , ak} is called a product-sum number: N = a1 + a2 + ... + ak = a1 \u00d7 a2 \u00d7 ... \u00d7 ak.\nFor example, 6 = 1 + 2 + 3 = 1 \u00d7 2 \u00d7 3.\nFor a given set of size, k, we shall call the smallest N with this property a minimal product-sum number. The minimal product-sum numbers for sets of size, k = 2, 3, 4, 5, and 6 are as follows.\nk=2: 4 = 2 \u00d7 2 = 2 + 2k=3: 6 = 1 \u00d7 2 \u00d7 3 = 1 + 2 + 3k=4: 8 = 1 \u00d7 1 \u00d7 2 \u00d7 4 = 1 + 1 + 2 + 4k=5: 8 = 1 \u00d7 1 \u00d7 2 \u00d7 2 \u00d7 2  = 1 + 1 + 2 + 2 + 2k=6: 12 = 1 \u00d7 1 \u00d7 1 \u00d7 1 \u00d7 2 \u00d7 6 = 1 + 1 + 1 + 1 + 2 + 6\nHence for 2\u2264k\u22646, the sum of all the minimal product-sum numbers is 4+6+8+12 = 30; note that 8 is only counted once in the sum.\nIn fact, as the complete set of minimal product-sum numbers for 2\u2264k\u226412 is {4, 6, 8, 12, 15, 16}, the sum is 61.\nWhat is the sum of all the minimal product-sum numbers for 2\u2264k\u226412000?", "solution": "7587457", "difficulty": 40, "story": "Once upon a time, in the village of Mathematica, there lived a curious and inquisitive young girl named Lily. Lily loved numbers and equations, and every day she would explore the village on her trusty bicycle, in search of intriguing mathematical problems to solve.\n\nOne sunny day, as Lily pedaled down the village streets, she overheard a conversation between two villagers. They spoke of a mystical problem \u2013 the quest for minimal product-sum numbers. Lily's ears perked up, and she couldn't resist but eavesdrop on their conversation.\n\nIntrigued, Lily listened intently as the villagers shared their knowledge about these unique numbers. They explained that a minimal product-sum number is a natural number that can be expressed both as the sum and the product of a given set of at least two natural numbers. For example, the number 6 could be written as 1+2+3 and 1*2*3, making it a product-sum number.\n\nThe villagers continued, discussing how the minimal product-sum numbers varied with the size of the sets. They mentioned that for sets of size k=2, 3, 4, 5, and 6, the minimal product-sum numbers were 4, 6, 8, 12, and 15 respectively. Lily's mind raced with excitement as she absorbed all this new information.\n\nDetermined to uncover more about these fascinating numbers, Lily spent weeks delving into the depths of her books and researching the concept of minimal product-sum numbers. She realized that finding the solution for a given set's minimal product-sum number was no easy feat. It required analytical thinking, logical deduction, and problem-solving skills. But the most exciting aspect was the challenge it presented \u2013 to discover the sum of all these minimal product-sum numbers for sets of size 2 to 12,000.\n\nAs days turned into nights, Lily's passion for mathematics grew stronger. She became consumed by the mystery of these numbers, desperate to solve the ultimate question: What is the sum of all the minimal product-sum numbers for sets of size 2 to 12,000?\n\nEvery evening, under the twinkling stars, Lily would sit by her window, gazing at the moon, contemplating the enigma that lay before her. She dreamed of a world where she could unlock the secret to these numbers, a world where she could contribute to the vast realm of mathematics by adding her own discoveries.\n\nOne fateful night, as Lily lay in bed, unable to sleep, her mind buzzed with numbers and equations. Suddenly, a thought struck her \u2013 a way to approach the problem. She jumped out of bed and hurriedly scribbled her idea on a piece of paper. With trembling hands, she picked up her bicycle in the pitch blackness of the night and pedaled off into the village.\n\nAs dawn broke and the village came alive, Lily excitedly ran to the town square, where a gathering of mathematicians and intellectuals awaited her arrival. She shared her revolutionary approach to the problem of minimal product-sum numbers, explaining her strategy and how it differed from previous methods.\n\nThe gathering was astounded by Lily's brilliance and ingenuity. They marveled at her passion and dedication to unraveling the mysteries of mathematics. They knew she held the key to not only solving this particular problem but also inspiring future generations of mathematicians.\n\nAnd now, dear reader, it is your turn to venture into the realm of numbers. Can you calculate the sum of all the minimal product-sum numbers for sets of size 2 to 12,000? Will you follow in Lily's footsteps and continue her quest? The power to unlock the secrets of these intriguing numbers lies in your hands.\n\nSo, tell me, will you accept this mathematical challenge?"}, {"id": 90, "euler_id": 90, "title": "Cube digit pairs", "problem": "Each of the six faces on a cube has a different digit (0 to 9) written on it; the same is done to a second cube. By placing the two cubes side-by-side in different positions we can form a variety of 2-digit numbers.\nFor example, the square number 64 could be formed:\n\n\nIn fact, by carefully choosing the digits on both cubes it is possible to display all of the square numbers below one-hundred: 01, 04, 09, 16, 25, 36, 49, 64, and 81.\nFor example, one way this can be achieved is by placing {0, 5, 6, 7, 8, 9} on one cube and {1, 2, 3, 4, 8, 9} on the other cube.\nHowever, for this problem we shall allow the 6 or 9 to be turned upside-down so that an arrangement like {0, 5, 6, 7, 8, 9} and {1, 2, 3, 4, 6, 7} allows for all nine square numbers to be displayed; otherwise it would be impossible to obtain 09.\nIn determining a distinct arrangement we are interested in the digits on each cube, not the order.\n{1, 2, 3, 4, 5, 6} is equivalent to {3, 6, 4, 1, 2, 5}\n{1, 2, 3, 4, 5, 6} is distinct from {1, 2, 3, 4, 5, 9}\nBut because we are allowing 6 and 9 to be reversed, the two distinct sets in the last example both represent the extended set {1, 2, 3, 4, 5, 6, 9} for the purpose of forming 2-digit numbers.\nHow many distinct arrangements of the two cubes allow for all of the square numbers to be displayed?", "solution": "1217", "difficulty": 40, "story": "Once upon a time, in a small village nestled amidst rolling green hills, there lived two best friends named Emma and Daniel. They were inseparable and spent most of their days exploring the enchanting forests that surrounded their village.\n\nOne sunny afternoon, while they were deep in the heart of the woods, they stumbled upon an abandoned cottage. It was old and worn, with crumbling walls and a thatched roof that had seen better days. Curiosity got the better of Emma and Daniel, and they cautiously stepped inside to explore.\n\nTo their amazement, they discovered a peculiar room filled with ancient relics and odd contraptions. But the most fascinating object was a pair of beautifully crafted wooden cubes. The cubes had intricate carvings on each face and were different from anything they had ever seen.\n\nEmma and Daniel were drawn to the cubes like magnets. They carefully inspected them and noticed that each face of both cubes had a different digit written on them, ranging from 0 to 9. The cubes seemed to hold a mysterious power, and Emma could feel her mind buzzing with possibilities.\n\nAs they played with the cubes, turning them this way and that, they realized that by placing them side-by-side in different positions, they could form a variety of two-digit numbers. The cubes held the key to unlocking a mathematical puzzle.\n\nIntrigued and eager to solve it, they studied the cubes more closely. Emma's sharp mind quickly realized the significance of the puzzle \u2013 by choosing the digits on both cubes carefully, they could display all the square numbers below one hundred.\n\nWith excited anticipation, they began their quest to find the perfect arrangement of digits on the cubes. Emma's analytical approach and Daniel's creative thinking complemented each other perfectly, and together they experimented with different combinations.\n\nAfter hours of trial and error, they stumbled upon a breakthrough. By placing {0, 5, 6, 7, 8, 9} on one cube and {1, 2, 3, 4, 8, 9} on the other cube, they discovered that they could create all nine square numbers below one hundred.\n\nBut just as they were about to celebrate their victory, a thought struck them. They wondered if they could achieve the same result with different digit combinations. Would there be other distinct arrangements that would allow them to display all the square numbers?\n\nDetermined to find out, Emma and Daniel continued to explore different possibilities. They discovered that by allowing 6 and 9 to be turned upside-down, they could create even more unique combinations. For instance, {0, 5, 6, 7, 8, 9} and {1, 2, 3, 4, 6, 7} represented the extended set {1, 2, 3, 4, 5, 6, 9} and could also display all the square numbers.\n\nExcited by this revelation, Emma and Daniel wondered how many other distinct arrangements were possible. They pondered if there was a systematic way to determine the exact number of combinations that satisfied the puzzle.\n\nWith curiosity burning in their hearts, they sought to solve the mystery of the cubes. They knew that behind the magical allure of the wooden cubes lay the key to unlocking the answer. But the question remained \u2013 how many distinct arrangements of the two cubes would allow them to display all the square numbers?\n\nAnd so, the adventure of Emma and Daniel continued, driven by the sheer joy of unraveling the enigma that lay within the cubes. But the ultimate answer still eluded them, leaving the question lingering in the air for those who dared to embark on this mathematical quest.\n\nHow many distinct arrangements of the two cubes allow for all of the square numbers to be displayed?"}, {"id": 110, "euler_id": 110, "title": "Diophantine reciprocals II", "problem": "In the following equation x, y, and n are positive integers.\n1x+1y=1n\nIt can be verified that when n=1260 there are 113 distinct solutions and this is the least value of n for which the total number of distinct solutions exceeds one hundred.\nWhat is the least value of n for which the number of distinct solutions exceeds four million?\nNOTE: This problem is a much more difficult version of Problem 108 and as it is well beyond the limitations of a brute force approach it requires a clever implementation.", "solution": "9350130049860600", "difficulty": 40, "story": "Once upon a time in a land known as Mathenopia, there lived a young mathematician named Ethan. Ethan had always been passionate about numbers and equations, spending countless hours studying and solving problems. He was known throughout the land for his extraordinary abilities, and often people would come seeking his help.\n\nOne day, a weary traveler arrived at Ethan's doorstep. The traveler introduced himself as Milo, a scholar from a distant kingdom, and he had come seeking Ethan's expertise in an unusual mathematical problem. Intrigued, Ethan invited him in and listened attentively as Milo explained the problem.\n\n\"There is an equation,\" Milo began, \"where x, y, and n are positive integers - 1x + 1y = 1n. The interesting part is that when n equals 1260, there are exactly 113 distinct solutions. It is the smallest value of n that exceeds one hundred distinct solutions. However, I need to find the smallest value of n that exceeds four million distinct solutions.\"\n\nEthan's eyes widened with excitement. He had never encountered such a challenging problem before. He immediately knew he had to help Milo find the desired solution. However, it was an incredibly complex puzzle that required a clever implementation, far beyond the limitations of a brute force approach.\n\nThe two mathematicians spent days, nights, and every waking moment, engrossed in solving the problem. They experimented with various techniques, theories, and algorithms, seeking patterns and connections that might crack the code. The people of Mathenopia watched in awe as the two brilliant minds worked tirelessly.\n\nAs weeks turned into months, and months into a year, Ethan and Milo refused to give up. They were determined to find the answer. Despite numerous setbacks, their perseverance knew no bounds. Their breakthrough came in the form of an elegant equation transformation.\n\nOne day, while observing a meandering river, Ethan noticed a similarity between the twists and turns of the water and the patterns they had been examining. He rushed back to his study, furiously scribbling calculations on numerous scrolls. The pieces fell into place, and he knew they were on the right track.\n\nWith renewed energy, Ethan and Milo embarked on a new approach. They began to chart the patterns, map the connections, and unravel the mystery hidden within the equation. Day and night, they delved deeper into the mathematical realm, pushing the boundaries of their own brilliance.\n\nFinally, after years of relentless pursuit, Ethan and Milo reached a milestone: they found the first few values that exceeded four million distinct solutions. They marveled at their achievement, realizing the magnitude of their accomplishment. However, the ultimate question still remained:\n\n\"What is the **least value** of n that exceeds four million distinct solutions?\"\n\nWith that lingering question in their minds, Ethan and Milo realized they had come to a crossroad. The answer to the mathematical problem lay just beyond their reach, waiting to be solved. They needed a fresh perspective, a break from their rigorous routine.\n\nAnd so, they set forth on a journey to seek wisdom from the renowned mathematicians across the land. With hope in their hearts and a burning desire to conquer the problem, Ethan and Milo vowed to continue their quest. The fate of Mathenopia's mathematical legacy rested upon their shoulders.\n\nAs the winds carried them to distant lands, they wondered, \"Who will help unlock the final pieces of this intriguing puzzle? Will we ever reach the solution that lies just beyond the horizon?\"\n\nAnd so, dear reader, I pose this question to you:\n\n\"What is the least value of n that exceeds four million distinct solutions?\"\n\nNow, it is your turn to embark on this mathematical adventure and solve the enigma that has perplexed Ethan, Milo, and the entire land of Mathenopia."}, {"id": 122, "euler_id": 122, "title": "Efficient exponentiation", "problem": "The most naive way of computing n15 requires fourteen multiplications:\nn \u00d7 n \u00d7 ... \u00d7 n = n15\nBut using a \"binary\" method you can compute it in six multiplications:\nn \u00d7 n = n2n2 \u00d7 n2 = n4n4 \u00d7 n4 = n8n8 \u00d7 n4 = n12n12 \u00d7 n2 = n14n14 \u00d7 n = n15\nHowever it is yet possible to compute it in only five multiplications:\nn \u00d7 n = n2n2 \u00d7 n = n3n3 \u00d7 n3 = n6n6 \u00d7 n6 = n12n12 \u00d7 n3 = n15\nWe shall define m(k) to be the minimum number of multiplications to compute nk; for example m(15) = 5.\nFor 1 \u2264 k \u2264 200, find \u2211 m(k).", "solution": "1582", "difficulty": 40, "story": "Once upon a time, in a quaint little village nestled in a valley, there lived a young girl named Ada. Ada was known for her insatiable curiosity and her love for all things numbers. While other children played outside, Ada would immerse herself in books and mathematical puzzles. Her favorite pastime was solving complex problems that challenged her mind.\n\nOne sunny day, as Ada sat under the shade of a large oak tree, she stumbled upon a fascinating mathematical problem. It went like this:\n\n\"The most naive way of computing n15 requires fourteen multiplications:\nn \u00d7 n \u00d7 ... \u00d7 n = n15\nBut using a 'binary' method, you can compute it in six multiplications:\nn \u00d7 n = n2\nn2 \u00d7 n2 = n4\nn4 \u00d7 n4 = n8\nn8 \u00d7 n4 = n12\nn12 \u00d7 n2 = n14\nn14 \u00d7 n = n15\nHowever, it is yet possible to compute it in only five multiplications:\nn \u00d7 n = n2\nn2 \u00d7 n = n3\nn3 \u00d7 n3 = n6\nn6 \u00d7 n6 = n12\nn12 \u00d7 n3 = n15\nWe shall define m(k) to be the minimum number of multiplications to compute nk; for example, m(15) = 5.\nFor 1 \u2264 k \u2264 200, find \u2211 m(k).\"\n\nAda's eyes widened with excitement. This mathematical problem was unlike anything she had ever encountered before. The power of reducing the number of multiplications fascinated her. She knew that solving this problem could lead to groundbreaking discoveries.\n\nFrom that moment on, Ada's obsession with this problem consumed her every waking moment. She spent countless hours scribbling equations on parchment and experimenting with different values of k. Her determination drove her to explore every possible avenue.\n\nAs days turned into weeks, Ada's understanding of the problem grew, and she devised new methods to compute nk. She explored different patterns and sought inspiration from the natural world around her. The village's elders watched in awe as this young girl delved deeper into the realm of mathematics.\n\nOne day, Ada stumbled upon an intriguing revelation. She discovered a unique way to approach the problem, requiring even fewer multiplications than what was previously known. Her excitement knew no bounds as she realized the sheer elegance of this solution.\n\nAda's discovery had the potential to revolutionize the field of mathematics. The news of her remarkable achievement spread far and wide, capturing the attention of scholars and mathematicians from all corners of the world. They flocked to the village, eager to witness the genius of this young prodigy.\n\nThe village hall was abuzz with excitement as everyone gathered to hear Ada speak. She stood before the crowd, her eyes gleaming with pride and her voice resonating with passion. She shared her journey of exploration, her struggles, and the moment of triumph when she uncovered the solution.\n\n\"This mathematical problem has captivated my heart, and I have found a way to compute nk in an even more efficient manner,\" Ada proclaimed. \"But I pose this question to all of you: Can you find the value of \u2211 m(k) for 1 \u2264 k \u2264 200? Can you unlock the depths of this problem and uncover the hidden beauty within?\"\n\nSilence filled the hall as Ada's words sank in. The challenge had been thrown to the world, and it was up to the brightest minds to embark on their own quest for the solution.\n\nAnd so, the story of the mathematical problem traveled far and wide, enriching the lives of those who encountered it. The search for knowledge and understanding reached new heights as the aspiring mathematicians attempted to crack the code laid out by Ada.\n\nAs for Ada, she continued her journey of exploration, venturing into uncharted territories of mathematics, leaving a lasting legacy for generations to come.\n\nBut dear reader, can you solve the perplexing problem laid before Ada and the world? Can you find the value of \u2211 m(k) for 1 \u2264 k \u2264 200? For within the solution lies a world of wonder, waiting to be unraveled."}, {"id": 131, "euler_id": 131, "title": "Prime cube partnership", "problem": "There are some prime values, p, for which there exists a positive integer, n, such that the expression n3 + n2p is a perfect cube.\nFor example, when p = 19, 83 + 82\u00d719 = 123.\nWhat is perhaps most surprising is that for each prime with this property the value of n is unique, and there are only four such primes below one-hundred.\nHow many primes below one million have this remarkable property?", "solution": "173", "difficulty": 40, "story": "Once upon a time, in a small town called Arithville, there lived a young prodigy named Ethan. From an early age, Ethan had a deep fascination with numbers and patterns. He spent his days tinkering with equations, exploring the mystical world of mathematics.\n\nOne sunny day, while wandering through the dusty shelves of the local library, Ethan stumbled upon an old, weathered book. Its pages were yellowed and brittle, as if whispering tales from a distant past. The title read \"The Enigma of Primes.\"\n\nIntrigued, Ethan flipped through the pages until his eyes fell upon a problem that set his mind ablaze. It spoke of prime values, p, and integers, n, and their connection to the enigmatic expression ```n3 + n2p```, which, given certain circumstances, resulted in a perfect cube.\n\nLost in thought, Ethan leaned back against an overstuffed chair and gazed out the library window. Could there be a deeper meaning behind these prime values? And how many primes below one million possessed this remarkable property?\n\nAs the days turned into weeks, Ethan became consumed by the problem. He dove headfirst into research, scouring books and journals, and consulting with fellow mathematicians. The more he delved into the mystery, the more he realized the profound implications it held.\n\nEthan's curiosity led him to explore the story behind these prime values. He discovered that for each prime with this property, the value of n was unique. It was as if some divine hand had carefully orchestrated the numbers so that they aligned in perfect synchrony.\n\nWord of Ethan's incredible journey spread throughout the town, and soon, people started seeking his assistance. Frustrated parents approached him, searching for answers to their children's math problems. A famous artist asked him to decipher the hidden patterns in her masterpiece. Seemingly unrelated incidents now carried the handprint of this mathematical enigma.\n\nOne evening, while engrossed in his research, Ethan had an epiphany. He realized that this problem was not merely a mathematical puzzle but a roadmap to unlocking the secrets of the universe. The values of p and n were not random; they were intertwined, dancing together in a symphony of numbers.\n\nEthan's face beamed with excitement as he worked tirelessly to solve mathematical expressions, manipulating variables and constants. Night turned into day, but his passion burned brighter than ever. Unbeknownst to him, his relentless pursuit was steering him toward a truth greater than he could fathom.\n\nMonths passed, but Ethan refused to give up. He was on the brink of an incredible discovery, one that would forever change the way humanity perceived mathematics. As he narrowed his focus on primes below one million, he wondered how many of them would hold the secret to this remarkable property.\n\nAnd now, dear reader, as Ethan stands at the precipice of his revelation, I leave you with a question: how many primes below one million have this extraordinary property?\n\nCan you solve the riddle that captured Ethan's heart and sparked a quest for enlightenment?"}, {"id": 174, "euler_id": 174, "title": "Counting the number of \"hollow\" square laminae that can form one, two, three, ... distinct arrangements", "problem": "We shall define a square lamina to be a square outline with a square \"hole\" so that the shape possesses vertical and horizontal symmetry.\nGiven eight tiles it is possible to form a lamina in only one way: 3x3 square with a 1x1 hole in the middle. However, using thirty-two tiles it is possible to form two distinct laminae.\n\n\nIf t represents the number of tiles used, we shall say that t = 8 is type L(1) and t = 32 is type L(2).\nLet N(n) be the number of t \u2264 1000000 such that t is type L(n); for example, N(15) = 832.\nWhat is \u2211\u2009N(n) for 1 \u2264 n \u2264 10?", "solution": "209566", "difficulty": 40, "story": "Once upon a time, in the small village of Mathlandia, there lived a young boy named Ethan. Ethan had always been fascinated by numbers, shapes, and patterns. He spent his days exploring the countryside, looking for anything that would spark his mathematical curiosity.\n\nOne sunny afternoon, while exploring the outskirts of the village, Ethan stumbled upon an old, dusty book hidden underneath a pile of leaves. Intrigued, he carefully blew away the dust and opened the book. To his surprise, the pages were filled with intricate mathematical problems and puzzles.\n\nExcitement tingled through Ethan's veins as he began to read the first problem in the book. It was about square laminas, a concept he had never encountered before. With wide eyes, he read about how eight tiles could form a unique square lamina with a hole in the middle. But what caught his attention even more was the mention of thirty-two tiles being able to form two distinct laminas.\n\nEthan's mind raced with possibilities. What could these laminas look like? How could thirty-two tiles form two unique shapes? The mathematical problem consumed his every thought. He daydreamed about different combinations, drawing sketch after sketch to visualize the possibilities.\n\nUnable to contain his excitement, Ethan rushed back to the village and shared his incredible discovery with his best friend, Lily. Lily was as intrigued as Ethan and they spent hours poring over the problem, trying to envision the different square laminas that could be created.\n\nDays turned into weeks, and weeks turned into months as Ethan and Lily delved deeper into the world of square laminas. They built models using various types of tiles, experimenting with different arrangements, searching for patterns. They invested their hearts and minds into the quest to understand the mathematical problem fully.\n\nTheir dedication caught the attention of the village elders. Impressed by their determination, the elders decided to organize a competition so that Ethan and Lily could share their knowledge with others. The competition would challenge the villagers to create their own laminas using different numbers of tiles.\n\nEthan and Lily eagerly took on the responsibility, preparing for the competition day and night. They compiled their findings and created examples of laminas using different tile counts, explaining the significance of the number of distinct laminas that could be formed. The duo hoped to inspire others with their passion for mathematics.\n\nAs the village gathered for the competition, Ethan and Lily proudly presented their research. They told tales of their discoveries, showcasing the laminas they had created and the various tile counts that produced different results. The villagers listened intently, captivated by the beauty and complexity of square laminas.\n\nThe competition began, and villagers of all ages embraced the challenge. They put their creativity to the test, exploring the possibilities of square laminas with different numbers of tiles. The air buzzed with excitement as they constructed unique shapes and shared their newfound knowledge with each other.\n\nMonths later, Mathlandia had become a hub of mathematical exploration. The villagers, young and old, delved into the world of square laminas, exchanging ideas and pushing the boundaries of their understanding. The village had transformed into a haven for mathematical enthusiasts, thanks to the passion and dedication of Ethan and Lily.\n\nOne evening, as the sun dipped below the horizon, Ethan and Lily sat together, basking in the sense of accomplishment. They glanced at each other, a question forming in their minds. With a smile, Lily asked, \"Ethan, after all this time, after all we have learned, can you tell me the sum of N(n) for 1 \u2264 n \u2264 10?\"\n\nEthan, filled with awe and gratitude for the journey they had embarked upon, pondered the question. He knew it would take time, calculations, and careful analysis. But the answer was within his grasp, just waiting to be discovered.\n\nAnd so, dear reader, the question remains: Can you, like Ethan, determine the sum of N(n) for 1 \u2264 n \u2264 10?"}, {"id": 207, "euler_id": 207, "title": "Integer partition equations", "problem": "For some positive integers k, there exists an integer partition of the form\u00a0\u00a0 4t = 2t + k,\nwhere 4t, 2t, and k are all positive integers and t is a real number.\nThe first two such partitions are 41 = 21 + 2 and 41.5849625... = 21.5849625... + 6.\nPartitions where t is also an integer are called perfect. \nFor any m \u2265 1 let P(m) be the proportion of such partitions that are perfect with k \u2264 m.\nThus P(6) = 1/2.\nIn the following table are listed some values of P(m)\n\u00a0\u00a0\u00a0P(5) = 1/1\n\u00a0\u00a0\u00a0P(10) = 1/2\n\u00a0\u00a0\u00a0P(15) = 2/3\n\u00a0\u00a0\u00a0P(20) = 1/2\n\u00a0\u00a0\u00a0P(25) = 1/2\n\u00a0\u00a0\u00a0P(30) = 2/5\n\u00a0\u00a0\u00a0...\n\u00a0\u00a0\u00a0P(180) = 1/4\n\u00a0\u00a0\u00a0P(185) = 3/13\nFind the smallest m for which P(m) < 1/12345", "solution": "44043947822", "difficulty": 40, "story": "Once upon a time, in a quaint little village named Arden, there lived a young shepherd named Leo. Leo was a bright and curious lad, always seeking new knowledge to expand his understanding of the world. His days were spent with his flock of sheep, wandering through the lush meadows and rolling hills, and his nights were filled with wonder as he gazed upon the twinkling stars in the night sky.\n\nOne fateful day, as Leo was tending to his sheep, he stumbled upon an old worn-out book hidden amongst the wildflowers. Intrigued, he picked it up and dusted off its weathered cover. It seemed to contain a collection of riddles and puzzles, enthralling his inquisitive mind.\n\nAs Leo perused through the pages, he stumbled upon a peculiar problem that piqued his interest - a mathematical conundrum that involved integer partitions. The problem stated that for some positive integers, there exists a partition of the form 4t = 2t + k, where t is a real number. However, these partitions are further classified as \"perfect\" when t is also an integer.\n\nThe young shepherd's eyes lit up with excitement. The problem seemed like a key to unlock the mysteries of the universe. Determined to solve it, Leo spent every spare moment pondering over the riddle. He would often lie on the grass, contemplating the solution as his sheep grazed contentedly by his side.\n\nDays turned into weeks and weeks into months, but Leo's determination did not waver. He sought the guidance of the village scholars, spending long hours discussing the problem and searching for patterns in the given values of P(m). As he delved deeper into the world of mathematical partitions, Leo discovered the hidden beauty of numbers and their intricate relationships.\n\nAmidst his ardent pursuit, Leo stumbled upon a groundbreaking insight. A revelation that seemed to unlock a new realm of understanding within his mind. It was the realization that the proportions of perfect partitions, denoted by P(m), were not random occurrences but delicately woven into a pattern.\n\nExcitement coursed through Leo's veins as he plunged deeper into deciphering the enigma. The values of P(m) showcased an unusual repetitiveness that captivated his imagination. He marveled at their harmonious dance, shifting like melodies, yet remaining steadfast in their structure.\n\nLeo's journey toward the solution became an adventure of intellect and spirit, stretching beyond the boundaries of his little village. He corresponded with other scholars from distant lands, sharing his observations and theories. They engaged in passionate debates and collaborative endeavors, igniting the fire of knowledge that burned within them all.\n\nAs the years went by, Leo's reputation as a brilliant shepherd-mathematician grew far and wide. His insights into the problem of perfect partitions fascinated scholars, captivating their hearts and minds. They eagerly awaited each of his correspondences, hoping for a glimmer of the ultimate solution that would finally unravel this complex conundrum.\n\nAnd yet, amidst all the knowledge he had gained and the acclaim he had garnered, there remained one burning question that haunted Leo's every waking moment. As he peered at the night sky, surrounded by his loyal flock, a single thought lingered in his mind.\n\nWhat is the smallest positive integer m that would make P(m) less than 1/12345?\n\nAnd with that lingering question, Leo's story intertwines with the mathematical problem, their destinies entwined. Will you, dear reader, take up Leo's quest and solve this puzzle that has bewildered minds for ages? Can you uncover the secret to the smallest m that would satisfy this elusive equation?"}, {"id": 214, "euler_id": 214, "title": "Totient Chains", "problem": "Let \u03c6 be Euler's totient function, i.e. for a natural number n,\n\u03c6(n) is the number of k, 1 \u2264 k \u2264 n, for which gcd(k,n) = 1.\nBy iterating \u03c6, each positive integer generates a decreasing chain of numbers ending in 1.\nE.g. if we start with 5 the sequence 5,4,2,1 is generated.\nHere is a listing of all chains with length 4:\n\n5,4,2,1\n7,6,2,1\n8,4,2,1\n9,6,2,1\n10,4,2,1\n12,4,2,1\n14,6,2,1\n18,6,2,1\nOnly two of these chains start with a prime, their sum is 12.\nWhat is the sum of all primes less than 40000000 which generate a chain of length 25?", "solution": "1677366278943", "difficulty": 40, "story": "Once upon a time in the kingdom of Mathelandia, there lived a young prince named Elias. Elias was known for his insatiable curiosity and sharp intellect. From a very young age, he had a passion for mathematics and spent hours exploring the vast world of numbers.\n\nOne sunny morning, while strolling through the royal gardens, Elias stumbled upon an ancient scroll adorned with intricate mathematical symbols. Intrigued by its mysterious aura, Elias unfurled the scroll and began to read. To his surprise, it contained a mathematical problem that he had never encountered before.\n\nThe problem spoke of a function called Euler's totient function, \u03c6. It described how, by iterating this function, a chain of decreasing numbers would be generated, eventually ending in 1. Elias's eyes sparkled as he realized the beauty and complexity nestled within the problem.\n\nDetermined to unravel its secrets, Elias delved into the world of numbers. He reasoned that finding chains of length four was just the beginning, but it was the chains of length 25 that captivated his imagination. Elias spent countless nights poring over calculations, scribbling formulas, and devouring ancient texts in search of the elusive pattern that would lead him to the answer.\n\nMonths passed, but Elias's determination never wavered. Even as the kingdom faced turmoil and unrest, Elias was undeterred. He saw the solution to this mathematical problem as not only a personal puzzle but also a way to bring order and unity to his beloved Mathelandia.\n\nAs Elias became engrossed in his quest, rumors of his mathematical prowess spread throughout the kingdom. People started seeking him out, eager to hear the latest updates on his progress. Scholars, mathematicians, and even rival princes flocked to his side, all desiring a glimpse of the solution that would unveil the true power hidden within numbers.\n\nOne day, a message arrived from a neighboring kingdom. It carried tidings of a great mathematical gathering, where minds from far and wide would convene to share their insights and seek answers to unsolved problems. Elias knew that this was his chance to present his findings, and perhaps, to find the missing piece that would make the puzzle whole.\n\nBut there was a catch. The message stated that only those who could solve a specific mathematical problem would be given entry to the gathering. The problem, of course, was none other than the one that had consumed Elias's every waking thought.\n\nUnder the weight of anticipation, Elias wondered if it was all worth it. He had dedicated so much time and energy to solving this puzzle, and now it seemed as if the world was conspiring against him. The stakes were high, and the pressure almost unbearable.\n\nAnd so, dear reader, I leave you with this question: What is the sum of all primes less than 40,000,000 that generate a chain of length 25? Will Elias find the solution in time? And most importantly, will the power of numbers bring the unity and peace that Mathelandia so desperately needs?\n\nOnly time will tell."}, {"id": 231, "euler_id": 231, "title": "The prime factorisation of binomial coefficients", "problem": "The binomial coefficient (103)=120.\n120=23\u00d73\u00d75=2\u00d72\u00d72\u00d73\u00d75, and 2+2+2+3+5=14.\nSo the sum of the terms in the prime factorisation of (103) is 14.\n\nFind the sum of the terms in the prime factorisation of (2000000015000000).\n", "solution": "7526965179680", "difficulty": 40, "story": "Story: The Enigmatic Expedition\n\nOnce upon a time, in a quaint little town nestled between rolling hills, lived a young girl named Amelia. Amelia was no ordinary girl; she possessed an insatiable curiosity and an innate love for adventure. Often, she would embark on exciting quests with her loyal companion, a mischievous rabbit named Oliver.\n\nOne sunny morning, as they strolled along a cobblestone path, a peculiar invitation fluttered down from the sky and landed at Amelia's feet. It was an invitation to participate in \"The Enigmatic Expedition,\" a legendary race that spanned the entire kingdom. The letter promised a grand prize for the winner, an ancient treasure said to possess unimaginable powers.\n\nCuriosity piqued, Amelia rushed home to gather her gear. Alongside Oliver, they readied themselves for the upcoming adventure. On the day of the race, Amelia found herself amongst a motley crew of competitors, each possessing their own unique talents and skills.\n\nAs they traversed through enchanted forests, treacherous mountains, and mystical caves, the challenges proved formidable. Amelia and Oliver relied on their wit and determination, solving riddles and puzzles to progress. However, as the race intensified, a moment of desperation presented itself.\n\nDeep within a hidden valley, obscured by thick vegetation, stood a daunting door. Engraved upon it, a mathematical problem had been etched into the ancient wood. Intrigued and determined, Amelia studied the enigmatic inscription carefully.\n\n\"The binomial coefficient (103) equals 120, and 120 equals 2 x 2 x 2 x 3 x 5. The sum of these prime factors is 14,\" Amelia whispered aloud, pondering its significance. The numbers hovered before her, the key to unlocking the mysterious door.\n\nAmelia's mind raced, connecting the dots between this cryptic mathematical riddle and her present predicament. She realized that the answer she sought lay within the solution to the equation.\n\nHer heart pounding with excitement, Amelia fervently crunched the numbers, seeking the pattern that would reveal the secret. Oliver, sensing her determination, hopped around her, as if urging her on.\n\nSuddenly, it clicked. The way forward was clear. The sum of the terms in the prime factorization of (2000000015000000)\u2014that was the answer she needed to progress beyond this door and continue the enigmatic expedition.\n\nWhat could this vast number possibly be? Would its prime factors hold the key to proceeding on this perilous adventure? Amelia's eyes gleamed with determination as she grasped the intricacies of the puzzle.\n\nAnd so, dear reader, as Amelia stood before that mysterious door, calculating the sum of the prime factors of (2000000015000000), we must ask you:\n\nWhat is the sum of the terms in the prime factorization of (2000000015000000)? Can you unravel the enigma that has consumed Amelia and Oliver on their extraordinary expedition?"}, {"id": 235, "euler_id": 235, "title": "An Arithmetic Geometric sequence", "problem": "\nGiven is the arithmetic-geometric sequence u(k) = (900-3k)rk-1.\nLet s(n) = \u03a3k=1...nu(k).\n\n\nFind the value of r for which s(5000) = -600,000,000,000.\n\n\nGive your answer rounded to 12 places behind the decimal point.\n", "solution": "1.002322108633", "difficulty": 40, "story": "Once upon a time in the small village of Brookshire, there lived a young shepherd named Ethan. He tended to a small flock of sheep, and his days were filled with the peaceful monotony of herding and grazing. Ethan was a bright young lad, always yearning for knowledge and seeking answers to the mysteries of the world.\n\nOne particularly hot summer day, as he guided his sheep across the lush meadows, Ethan noticed a glimmer of sunlight reflecting off a mysterious object in the grass. Curiosity piqued, he dismounted from his horse and walked toward it, his flock obediently trailing behind. To his astonishment, he found a dusty leather-bound book gently nestled in the grass.\n\nEthan's hands trembled with excitement as he opened the book, revealing ancient pages filled with cryptic symbols and equations. Although most of the text was beyond his understanding, he recognized enough to know that he held a treasure trove of knowledge.\n\nAs the sun descended below the horizon, casting a golden hue over the meadow, Ethan settled down beneath a towering oak tree and let his imagination be guided by the words on those delicate pages. His eyes widened with wonder as he stumbled upon a mathematical problem that seemed to leap off the page.\n\nThe problem went something like this: Given an arithmetic-geometric sequence u(k) = (900-3k)rk-1, find the value of r for which s(5000) = -600,000,000,000, rounded to 12 decimal places. The words danced before Ethan's eyes, and he was captivated by the enigma it presented. He had never encountered such complexity in his pastoral life.\n\nDays turned into weeks, and Ethan found himself engrossed in deciphering the intricacies of the mathematical problem. Each evening, after caring for his flock, he would retire to his humble cottage with his newfound wealth of knowledge and embark on a journey of discovery.\n\nThe villagers noticed a change in their young shepherd. He no longer seemed content with the simplicity of his everyday life. Instead, Ethan's mind was consumed by the mathematical problem, his thoughts revolving around finding the value of r, the elusive enchantment that could unlock a hidden world for him.\n\nOne by one, his neighbors began to approach him, their faces etched with concern. \"Ethan,\" they would say, \"you are a humble shepherd. What purpose could this pursuit of numbers serve?\"\n\nBut Ethan merely smiled at their words. Deep down, he knew that this mathematical problem held more than just numerical significance. It was a gateway to comprehension, an opportunity to explore the intricacies of the universe. His heart whispered that within those abstract equations lay the answers to a myriad of questions yet unasked.\n\nAs the months went by, Ethan's obsession grew. He had stumbled upon a revelation, a hint that the value of r could transform not only his understanding of the world but also his destiny. He was so close, yet the answer remained just outside his grasp.\n\nNow, dear reader, I leave you with this question: Can you find the value of r for which s(5000) equals precisely -600,000,000,000? Step into Ethan's shoes, delve into the world of numbers, and unlock the secrets that lay within the pages of that ancient book. What adventures await you beyond the arithmetic-geometric allure?\n\nAs the sun sets over the peaceful village of Brookshire, and the sheep graze contentedly, the story of Ethan and his pursuit of mathematical enlightenment begs the questions: Will he unlock the answer? Will he find meaning in these numbers? Can you solve the problem left unsolved, awaiting a clever mind to untangle the mystery?"}, {"id": 265, "euler_id": 265, "title": "Binary Circles", "problem": "2N binary digits can be placed in a circle so that all the N-digit clockwise subsequences are distinct.\nFor N=3, two such circular arrangements are possible, ignoring rotations:\n\nFor the first arrangement, the 3-digit subsequences, in clockwise order, are: 000, 001, 010, 101, 011, 111, 110 and 100.\nEach circular arrangement can be encoded as a number by concatenating the binary digits starting with the subsequence of all zeros as the most significant bits and proceeding clockwise. The two arrangements for N=3 are thus represented as 23 and 29:\n00010111\u20092 = 23\n00011101\u20092 = 29\nCalling S(N) the sum of the unique numeric representations, we can see that S(3) = 23 + 29 = 52.\nFind S(5).", "solution": "209110240768", "difficulty": 40, "story": "Once upon a time in a small village, there lived a clever and curious young girl named Lily. Lily had a passion for puzzles and mathematics. She would spend hours immersed in books, learning new concepts and solving intricate problems. This made her a bit of an oddity in the village, as most children preferred playing games or running around outside.\n\nOne bright and sunny morning, while Lily was perched on her favorite spot under an old oak tree with her trusted notebook and pencil, scratching her head over a particularly challenging problem, her attention was caught by a commotion in the distance. Curiosity piqued, she stood up and rushed toward the sound.\n\nAs she approached the village square, she saw a group of townsfolk gathered around a large wooden board covered in binary digits. The board seemed to have captivated everyone's attention, and whispers of excitement filled the air.\n\nIntrigued, Lily made her way through the crowd and glanced at the board. She recognized the familiar binary numbers and immediately noticed that they were arranged in a circular pattern. The villagers were enthralled by the beauty and complexity of it all.\n\nCuriosity beckoned Lily, and she asked the nearest villager what had inspired the creation of this mathematical marvel. The villager explained, \"Legend has it that this arrangement of binary digits holds a secret. It is said that 2N binary digits can be placed in a circle so that all N-digit subsequences, read in clockwise order, are distinct. Only a few arrangements exist, and this board holds one of them.\"\n\nLily's eyes widened with excitement; her mathematical instincts took over. She realized that the binary digits formed unique representations of circular arrangements and that the sum of all these representations, S(N), was the key to unlocking the secret. Determined to solve this perplexing problem, she sat down with her notebook and began to calculate.\n\nDays turned into weeks as Lily meticulously worked through the multitude of possibilities. She drew diagrams, developed formulas, and tested her theories, driven by an insatiable thirst for knowledge. Every breakthrough she made inspired her to delve deeper into the problem.\n\nFinally, after countless hours of brainstorming, Lily's face lit up with an explosion of joy. She had found the solution, a formula that would unlock the sum of all the unique numeric representations for the circular arrangement of 2N binary digits. Her calculation revealed that S(5) equaled a significant yet elusive number.\n\nAs she held the answer in her hands, satisfaction overwhelmed her. But what could this enigmatic number mean? Why was it so crucial? Lily knew she had to share her discovery with the villagers who had become captivated by the binary board.\n\nGathering the villagers around her, she confidently declared, \"I have solved the puzzle! S(5) is a remarkable sum, but it holds a secret yet to be unraveled. Each arrangement has a unique representation in binary digits, but what could this all mean? Why were we drawn to this puzzle in the first place? What secrets does it hold?\"\n\nThe villagers, filled with anticipation, looked at Lily, waiting for her to continue. A sense of wonder filled the air as they considered the significance of S(5) and the implications it held. The once-small village was now wrapped in a cloak of enchantment, its people eager to unravel the mysteries their clever young girl had discovered.\n\nAnd so, dear reader, the question remains: What is the sum S(5)? Can you solve the riddle and uncover the secrets hidden within this binary world?"}, {"id": 287, "euler_id": 287, "title": "Quadtree encoding (a simple compression algorithm)", "problem": "The quadtree encoding allows us to describe a 2N\u00d72N  black and white image as a sequence of bits (0 and 1). Those sequences are to be read from left to right like this:\nthe first bit deals with the complete 2N\u00d72N region;\n\"0\" denotes a split:\nthe current 2n\u00d72n region is divided into 4 sub-regions of dimension 2n-1\u00d72n-1,\nthe next bits contains the description of the top left, top right, bottom left and bottom right sub-regions - in that order;\n\"10\" indicates that the current region contains only black pixels;\n\"11\" indicates that the current region contains only white pixels.Consider the following 4\u00d74 image (colored marks denote places where a split can occur):\n\nThis image can be described by several sequences, for example :\n\"001010101001011111011010101010\", of length 30, or\n\"0100101111101110\", of length 16, which is the minimal sequence for this image.\nFor a positive integer N, define DN as the 2N\u00d72N image with the following coloring scheme:\nthe pixel with coordinates x\u2009=\u20090, y\u2009=\u20090 corresponds to the bottom left pixel,\nif (x\u2009-\u20092N-1)2\u2009+\u2009(y\u2009-\u20092N-1)2\u2009\u2264\u200922N-2 then the pixel is black,\notherwise the pixel is white.What is the length of the minimal sequence describing D24\u2009?", "solution": "313135496", "difficulty": 40, "story": "Once upon a time, in a land shrouded in mystery, there was a young mathematician named Ethan. Ethan was not like most mathematicians he knew. While others confined themselves to books and formulas, Ethan had a passion for adventure and solving puzzles in unconventional ways.\n\nOne sunny morning, Ethan received a mysterious envelope in the mail. The envelope was old and tattered, as if it had traveled through time itself. Ethan opened it cautiously and found a map inside, dotted with strange symbols and equations. At the corner of the map, there was a perplexing riddle written in elegant calligraphy.\n\n\"In the land of Quadrima, where black and white unite, seek the answer to the puzzle, hidden out of sight. To decode the mysteries of this ancient land, solve the mathematical problem with nimble mind and steady hand.\"\n\nIntrigued by the riddle, Ethan embarked on a quest to unravel the secrets of Quadrima. Armed with his mathematical knowledge, he deciphered the meaning behind the symbols on the map. The symbols represented a vast 2N\u00d72N image, divided into regions of black and white pixels.\n\nAs Ethan studied the map, he realized that the key to understanding Quadrima lay in the quadtree encoding. The map was encoded with a sequence of bits that described the image, with \"0\" denoting a split, \"10\" indicating a black region, and \"11\" representing a white region. The length of the sequence varied based on the intricacy of the image.\n\nWith each step, Ethan's fascination grew. His mind began to imagine the possibilities of applying this unique encoding to real-world scenarios. He saw how it could be used to compress data, optimize image recognition algorithms, and even improve satellite imaging technology. The potential was endless.\n\nLost in his thoughts, Ethan's gaze fell upon the final part of the riddle, which asked for the length of the minimal sequence describing a particular 2N\u00d72N image. It was a challenge that called upon his mathematical prowess, his ability to see patterns where others saw chaos.\n\nEthan's heart raced with excitement. The answer to the riddle was tantalizingly close, yet it remained just out of reach. He couldn't help but wonder what magnificent secrets awaited him if he could crack this enigma of Quadrima.\n\nAs the sun set and night enveloped the land, Ethan found himself lost in thought. He pondered over the problem, exploring various approaches and mathematical techniques. Hours turned into days, and days turned into weeks, but still, the answer eluded him.\n\nBut Ethan refused to give up. He was determined to conquer the puzzle of Quadrima, to uncover the length of the minimal sequence describing the image. He knew that the solution would reveal more than just a number; it would unlock a world of possibilities.\n\nAnd so, dear reader, I leave you with the same question that consumed Ethan's mind. What is the length of the minimal sequence describing D24? Can you uncover the answer and unravel the mysteries that lie within? The secrets of Quadrima await those with the courage to embark on this mathematical adventure."}, {"id": 304, "euler_id": 304, "title": "Primonacci", "problem": "\nFor any positive integer n the function next_prime(n) returns the smallest prime p  such that p>n.\n\n\nThe sequence a(n) is defined by:\na(1)=next_prime(1014) and a(n)=next_prime(a(n-1)) for n>1.\n\n\nThe fibonacci sequence f(n) is defined by:\nf(0)=0, f(1)=1 and f(n)=f(n-1)+f(n-2) for n>1.\n\n\nThe sequence b(n) is defined as f(a(n)).\n\n\nFind \u2211\u2009b(n) for 1\u2264n\u2264100 000. \nGive your answer mod 1234567891011. \n\n\n\n\n", "solution": "283988410192", "difficulty": 40, "story": "Once upon a time in the magical land of Numeria, there lived a young and curious mathematician named Ethan. He had always been fascinated by numbers and the wonders they could unlock. One day, while flipping through a dusty old book in the library, he stumbled upon a particular mathematical problem that piqued his interest. It spoke of a sequence of numbers and the Fibonacci sequence and ended with a perplexing question.\n\nEthan's eyes sparkled with excitement as he delved into the problem. His mind raced with ideas, but he couldn't quite figure out how the two sequences were connected. Determined to unravel the mystery, he set forth on a grand adventure.\n\nHe packed his belongings, bid farewell to his family, and set off to find a wise old mathematician named Professor Benjamin, known for his vast understanding of numbers and their intricacies. Ethan believed that Professor Benjamin held the key to unlocking the connection between the two sequences.\n\nThe journey was arduous, with Ethan traversing through treacherous mountains, dense forests, and vast deserts. Finally, he reached the outskirts of a quaint little village where Professor Benjamin resided.\n\nAs he approached the professor's humble abode, Ethan noticed a majestic aura surrounding the place. The garden was adorned with flowers of vibrant colors, each carefully arranged. Even the number of petals on each flower seemed to follow a pattern. This only fueled Ethan's curiosity further.\n\nUpon meeting the professor, Ethan explained the enigma he had found in the old book. Professor Benjamin listened intently, his wise eyes twinkling with interest. No stranger to the mathematical world, he immediately understood the significance of the problem.\n\n\"Ethan, my young friend, you have stumbled upon a fascinating interplay between prime numbers, the Fibonacci sequence, and the sequence b(n) derived from it,\" the professor said with a smile.\n\nWith bated breath, Ethan watched as the professor began to explain the underlying principle. He spoke of sequences intertwining like the twists and turns of a magical tapestry, each element relying on the others for its existence. He taught Ethan about prime numbers, Fibonacci's spiral, and the extraordinary connection between them.\n\nEthan's mind was ablaze with patterns and possibilities. He understood how the sequence a(n) was intricately linked to the Fibonacci sequence, as each term in a(n) was a prime number greater than the previous one. And now, he knew how to calculate the sequence b(n) by substituting the values of a(n) into the Fibonacci sequence formula.\n\nThe two mathematicians spent hours engrossed in the beauty of numbers, exploring the depths of their connection. But as the days turned into nights, Ethan's journey drew to a close, and he realized he had one final piece missing: the sum of b(n) for 1\u2264n\u2264100,000, modulo 1,234,567,891,011.\n\nThe professor and Ethan bid their farewells, and Ethan embarked on his return journey, puzzling over the final question. He knew that finding the answer would be a challenge, but he also knew that it held the power to unlock countless mysteries hidden within the realm of numbers.\n\nAnd so, as Ethan made his way back through the treacherous terrain of Numeria, overcoming hurdles and obstacles, he couldn't help but wonder: Could he find the elusive answer to the mathematical problem? Would he be able to calculate the sum of b(n) within the given constraints?\n\nAs the young mathematician continued his journey, the question burned in his mind, fueling his determination and driving him forward. Finally, he arrived back home, ready to immerse himself once again in his studies and seek the solution he craved.\n\nDear reader, can you solve the enigma Ethan stumbled upon? Can you calculate \u2211\u2009b(n) for 1\u2264n\u2264100,000, modulo 1,234,567,891,011?"}, {"id": 307, "euler_id": 307, "title": "Chip Defects", "problem": "\nk defects are randomly distributed amongst n integrated-circuit chips produced by a factory (any number of defects may be found on a chip and each defect is independent of the other defects).\n\n\nLet p(k,n) represent the probability that there is a chip with at least 3 defects.\nFor instance p(3,7) \u2248 0.0204081633.\n\n\nFind p(20 000, 1 000 000) and give your answer rounded to 10 decimal places in the form 0.abcdefghij\n", "solution": "0.7311720251", "difficulty": 40, "story": "Once upon a time, in a small town nestled next to the rolling hills, there was a bustling integrated-circuit factory called TechnoChip. This factory was known far and wide for producing state-of-the-art chips that powered the latest technological marvels. However, hidden within its walls lay an intriguing mystery that nobody knew about.\n\nInside TechnoChip, there was a brilliant mathematician named Dr. Emily Miller. She had always been fascinated by the intricate patterns and probabilities hidden within numbers. Driven by her insatiable curiosity, she had spent years studying the probabilities of defects in the chips produced by the factory.\n\nOne sunny morning, as Dr. Miller sipped her coffee in the factory's cafeteria, she overheard a conversation between two technicians. They were discussing the possibility of a chip having at least three defects. Immediately intrigued, Dr. Miller approached the technicians and asked how often this occurrence took place.\n\n\"Ah, well, it's quite rare, Dr. Miller,\" one of the technicians replied. \"But we're not quite sure how rare. Would you like us to run some calculations for you?\"\n\nThe mathematician's eyes sparkled with excitement. \"Yes, please! I'd love to know the probability of a chip having at least three defects.\"\n\nWith that, the technicians scurried off to collect data from the production records. They then returned to Dr. Miller's office with their findings \u2014 k defects distributed among n integrated-circuit chips. In this case, k was a whopping 20,000, while n stood at 1,000,000.\n\nDr. Miller meticulously studied the data while her mind began to race. She was determined to decipher the probability that a chip contained at least three defects in this particular scenario. The answer to this mathematical problem nagged at her, urging her to find the solution.\n\nAs days turned into weeks, Dr. Miller tirelessly worked on her calculations. She pored over countless probability theorems and ran intricate simulations. Her determination was unwavering, driven by the mystery that shrouded the TechnoChip factory.\n\nFinally, after many sleepless nights, Dr. Miller had arrived at a conclusion. The probability that there would be a chip with at least three defects (p(20,000, 1,000,000)) was 0.abcdefghij\u2014rounded to ten decimal places.\n\nNow, dear reader, it is your turn. Can you crack this mathematical puzzle? What is the precise value of p(20,000, 1,000,000)? As Dr. Emily Miller eagerly awaits your answer, think carefully, analyze the problem, and unravel the mystery that lies hidden within the labyrinth of numbers."}, {"id": 310, "euler_id": 310, "title": "Nim Square", "problem": "\nAlice and Bob play the game Nim Square.\nNim Square is just like ordinary three-heap normal play Nim, but the players may only remove a square number of stones from a heap.\nThe number of stones in the three heaps is represented by the ordered triple (a,b,c).\nIf 0\u2264a\u2264b\u2264c\u226429 then the number of losing positions for the next player is 1160.\n\n\nFind the number of losing positions for the next player if 0\u2264a\u2264b\u2264c\u2264100 000.\n", "solution": "2586528661783", "difficulty": 40, "story": "Once upon a time, in the picturesque village of Mathtopia, lived two friends named Alice and Bob. They were known throughout the village for their love of games and puzzles, and their competitive nature was unmatched. Their favorite pastime was spending sunny afternoons challenging each other to various mathematical games, always aiming to outsmart one another.\n\nOne day, Alice stumbled upon an intriguing mathematical problem while exploring the depths of an ancient library. It was called \"Nim Square,\" a variation of the classic game Nim. Unable to contain her excitement, she hurriedly made her way to Bob's house, clutching the old parchment containing the problem tightly.\n\nAs Bob opened the door, he noticed Alice's flushed face and sparkling eyes. \"What's gotten you so excited?\" he asked, intrigued by her unusual demeanor.\n\nBreathlessly, Alice explained, \"Bob, I've found a fascinating mathematical problem called Nim Square. It's just like regular Nim, except players can only remove a square number of stones from a heap. We have to find out the number of losing positions for the next player when there are three heaps. The problem even provides a specific scenario!\"\n\nBob's interest was piqued, but he couldn't help but feel overwhelmed. The scenario Alice mentioned seemed manageable, but what about a larger one? \"Alice, what if we extend the problem? What if we consider a case where 0 is less than or equal to 'a,' 'b' is less than or equal to 'c,' and they're all less than or equal to 100,000?\"\n\nAlice's eyes widened as she realized the extent of the task at hand. \"That's the question, Bob. We need to find the number of losing positions for the next player in such a scenario. Can we solve it?\"\n\nBob thought for a moment, pondering the immense scale of their undertaking. Yet, the challenge invigorated him. \"Alice, why don't we embark on a grand adventure to find the solution? Let's journey to the fabled Land of Numbers, where ancient mathematical secrets are said to be hidden. Perhaps there, we might find the wisdom needed to crack this problem wide open.\"\n\nAlice's excitement surged anew. The enchanting Land of Numbers was legendary among mathematicians, rumored to hold the answers to the most perplexing problems. Together, Alice and Bob gathered their belongings and set forth on their grand adventure.\n\nAs they traversed breathtaking landscapes and crossed treacherous terrain, Alice and Bob encountered numerous puzzles and mathematical conundrums they had never dreamed of before. Each challenge tested their problem-solving skills and the strength of their friendship.\n\nFinally, after days of arduous travel, Alice and Bob reached the heart of the Land of Numbers. There, amidst sweeping hills and ancient ruins, they discovered an ancient sage. With a long white beard and wise eyes that sparkled mischievously, the sage welcomed the duo.\n\n\"Welcome, seekers of knowledge,\" the sage greeted them. \"State your purpose, and perhaps I shall share the answers you seek.\"\n\nWith determination in her voice, Alice unfolded the parchment and presented the Nim Square problem to the sage. She recounted the scenario in Mathtopia and expressed their desire to solve the extended problem.\n\nThe sage listened attentively, his gaze fixed on the parchment. After a few moments of careful consideration, he spoke. \"Ah, the allure of Nim Square is indeed fascinating. To find the number of losing positions for the next player in the scenario where 'a,' 'b,' and 'c' lie between 0 and 100,000, one must delve into the depths of mathematics and tread the path of combinatorics.\"\n\nAlice and Bob leaned in, hanging onto the sage's every word. They thirsted for knowledge and a way to unravel the mystery.\n\n\"It is no easy feat,\" the sage continued, \"for the solution lies within the intricate patterns of triangular numbers, where each of the heaps will take on distinct values. To ascertain the number of losing positions, one must navigate the labyrinth of mathematical equations woven among the dimensions of probability theory and number theory.\"\n\nAlice and Bob exchanged a glance, their initial excitement mixed with a tinge of trepidation. The magnitude of the problem astounded them, but they were determined to find the solution, as true champions of intellect.\n\nIn that moment, the sage smiled warmly. \"Take your time, young seekers. Explore the vast realm of possibilities. Engage in endless trials and challenges that shape the essence of mathematics. Perhaps, by persevering through your shared journey, the answer to your question will be revealed.\"\n\nNow, dear reader, as Alice and Bob venture deeper into the Land of Numbers, the question falls upon you: How many losing positions are there for the next player when 'a,' 'b,' and 'c' lie between 0 and 100,000? Can you uncover the mathematical secrets that lie within?"}, {"id": 327, "euler_id": 327, "title": "Rooms of Doom", "problem": "A series of three rooms are connected to each other by automatic doors.\n\nEach door is operated by a security card. Once you enter a room the door automatically closes and that security card cannot be used again. A machine at the start will dispense an unlimited number of cards, but each room (including the starting room) contains scanners and if they detect that you are holding more than three security cards or if they detect an unattended security card on the floor, then all the doors will become permanently locked. However, each room contains a box where you may safely store any number of security cards for use at a later stage.\nIf you simply tried to travel through the rooms one at a time then as you entered room 3 you would have used all three cards and would be trapped in that room forever!\nHowever, if you make use of the storage boxes, then escape is possible. For example, you could enter room 1 using your first card, place one card in the storage box, and use your third card to exit the room back to the start. Then after collecting three more cards from the dispensing machine you could use one to enter room 1 and collect the card you placed in the box a moment ago. You now have three cards again and will be able to travel through the remaining three doors. This method allows you to travel through all three rooms using six security cards in total.\nIt is possible to travel through six rooms using a total of 123 security cards while carrying a maximum of 3 cards.\nLet C be the maximum number of cards which can be carried at any time.\nLet R be the number of rooms to travel through.\nLet M(C,R) be the minimum number of cards required from the dispensing machine to travel through R rooms carrying up to a maximum of C cards at any time.\nFor example, M(3,6)=123 and M(4,6)=23.And, \u2211\u2009M(C,6)=146 for 3 \u2264 C \u2264 4.\nYou are given that \u2211\u2009M(C,10)=10382 for 3 \u2264 C \u2264 10.\nFind \u2211\u2009M(C,30) for 3 \u2264 C \u2264 40.", "solution": "34315549139516", "difficulty": 40, "story": "The dimly lit corridors echoed with the faint sound of footsteps as Detective Max Reynolds made his way through the abandoned research facility. The place had an eerie feel to it, like a forgotten secret buried beneath the layers of dust and time.\n\nAs he entered the first room, Max noticed the row of automatic doors lining the opposite wall. The security cards dispensed by the machine caught his attention immediately. He reached out and grabbed a few, wondering why they would be needed in an abandoned facility. Little did he know that these cards held the key to his escape.\n\nCuriosity piqued, Max decided to explore further. He entered the second room cautiously, feeling a tingling sensation wash over him. A set of scanners behind glass panels glared at him as he stepped inside. It was clear that these scanners were monitoring the number of security cards he possessed.\n\nSuddenly, a voice echoed through hidden speakers, \"Warning! You are holding more than three security cards. Please dispose of the excess immediately.\"\n\nMax's heart raced, and he quickly realized the severity of the situation. Without hesitation, he deposited the extra cards into the storage box provided in the corner of the room. The scanners blinked in approval, and the voice continued, \"Thank you for your compliance. Proceed.\"\n\nRelieved, Max walked towards the third room, glancing over his shoulder to ensure the doors behind him stayed open. He marveled at the clever mechanism that allowed him to store the cards, avoiding the permanent lockdown that would trap him forever.\n\nIn the third room, Max found himself in a dilemma. He had used up his three cards to get this far, and he couldn't move forward without risking getting locked in. He realized he needed a new plan.\n\nLost in thought, Max retraced his steps back to the first room, knowing that there was a way to bypass this puzzle. He used his final card to gain access and placed one in the storage box. With a sigh of relief, he exited the room and returned to the starting point.\n\nCollecting three more cards from the dispenser, Max made his way back to the first room again. He retrieved the card he had stored earlier, and now he possessed three cards once more. Keeping two in his hand, he carefully placed one in the box, ensuring not to violate the scanners' rules.\n\nThe doors opened, beckoning him forward. Max carried on, using the cards and the storage box as a means to bypass the restrictions in each room. He was amazed at the elegance of this mathematical problem turned real-life challenge. The facility's architects had clearly intended for someone to solve this puzzle, using logic and strategy to navigate through a seemingly inescapable maze.\n\nSeveral hours passed, and Max finally emerged from the last room, damp with sweat but triumphant. He had completed the journey through all six rooms, using only 123 security cards in total. Gasping for breath, he couldn't help but marvel at the cleverness behind this intricate design.\n\nAs he left the facility behind, Max couldn't shake off the lingering question in his mind. What would be the minimum number of cards required if there were thirty rooms to pass through? How would the dynamics of the system change, and could he still find a way to escape while carrying a maximum of three cards?\n\nNow, dear reader, it is your turn to unravel the mystery. Can you find the solution to this perplexing mathematical problem and determine the minimum number of cards required to navigate through thirty rooms, all while carrying a maximum of three cards?"}, {"id": 365, "euler_id": 365, "title": "A huge binomial coefficient", "problem": "\nThe binomial coefficient (1018109) is a number with more than 9 billion (9\u00d7109) digits.\n\n\nLet M(n,k,m) denote the binomial coefficient (nk) modulo m.\n\n\nCalculate \u2211M(1018,109,p\u22c5q\u22c5r) for 1000<p<q<r<5000 and p,q,r prime.\n", "solution": "162619462356610313", "difficulty": 40, "story": "Once upon a time, in the small town of Arithville, lived a young and gifted mathematician named Emma. Emma had always had a fascination with numbers and could solve complex mathematical problems with ease. Even as a child, she would spend hours lost in the world of equations and formulas, finding joy in unraveling their mysteries.\n\nOne sunny day, while Emma was exploring the depths of an antique bookstore, she stumbled upon a worn-out journal hidden beneath a pile of dusty old books. Curiosity got the better of her, and she couldn't resist opening the journal to discover its secrets.\n\nInside, she found a handwritten note that piqued her interest. The note contained a mathematical problem that seemed almost impossible to solve. It talked about the binomial coefficient, a number with over nine billion digits, and a perplexing function denoted as M(n,k,m).\n\nEmma's eyes sparkled with excitement as she delved further into the note. The problem demanded her to calculate the summation of M(1018,109,p\u22c5q\u22c5r) for 1000 < p < q < r < 5000, where p,q, and r were all prime numbers.\n\nRealizing the complexity of the task at hand, Emma couldn't help but feel an indescribable thrill pulsating through her veins. She knew that solving this mathematical enigma would require all her knowledge and expertise. But something in her heart told her that this was not just any problem; this had the potential to unlock secrets unimaginable.\n\nDriven by her determination, Emma decided to dedicate her time and energy to understanding the concept of the binomial coefficient and its modulo operation. She spent days pouring over textbooks and research papers, reaching out to esteemed mathematicians from around the world for guidance. The problem had consumed her entirely, and she had lost track of everything else in her life.\n\nAs time flew by, Emma's obsession with the mathematical problem began to take a toll on her. She barely slept, ate sparingly, and rarely ventured out of her room. Her once lively spirit began to fade, and her enthusiasm waned. The problem that once ignited her passion was now becoming an insurmountable burden.\n\nEmma found herself torn between her love for mathematics and her well-being. She knew that she had to make a difficult decision for her own sake. Reluctantly, she closed the journal, vowing to put the problem aside and focus on her own happiness.\n\nMonths went by, and Emma's life started to regain a sense of normalcy. She reconnected with friends, explored other interests, and even found solace in teaching young children the beauty of mathematics. But deep down, she couldn't help but wonder if she had made the right choice.\n\nOne evening, while cleaning out her basement, Emma stumbled upon the forgotten journal once again. Its presence was a poignant reminder of the unfinished puzzle that had haunted her. She decided to open it one last time, to confront the enigma that had eluded her for so long.\n\nAs Emma flipped through the pages, her eyes settled on the final entry in the journal. It was a question, a question to which she still didn't know the answer. The question asked, \"Can you solve \u2211M(1018,109,p\u22c5q\u22c5r) for 1000 < p < q < r < 5000 and p,q,r prime?\"\n\nEmma sat there, captivated by the possibility of solving this mind-boggling problem. Should she embark on this mathematical odyssey once more? Should she dedicate herself to finding the solution, no matter the cost?\n\nAnd so, dear reader, I leave it to you - the bearer of this story - the one who now knows of the mysterious problem that captured Emma's heart. Will you take on the challenge and solve this enigma that has eluded the young mathematician? Can you find the sum of \u2211M(1018,109,p\u22c5q\u22c5r) for 1000 < p < q < r < 5000 and p,q,r prime?\n\nThe decision is now yours to make."}, {"id": 366, "euler_id": 366, "title": "Stone Game III", "problem": "\nTwo players, Anton and Bernhard, are playing the following game.\nThere is one pile of n stones.\nThe first player may remove any positive number of stones, but not the whole pile.\nThereafter, each player may remove at most twice the number of stones his opponent took on the previous move.\nThe player who removes the last stone wins.\n\n\nE.g. n=5\nIf the first player takes anything more than one stone the next player will be able to take all remaining stones.\nIf the first player takes one stone, leaving four, his opponent will take also one stone, leaving three stones.\nThe first player cannot take all three because he may take at most 2x1=2 stones. So let's say he takes also one stone, leaving 2. The second player can take the two remaining stones and wins.\nSo 5 is a losing position for the first player.\nFor some winning positions there is more than one possible move for the first player.\nE.g. when n=17 the first player can remove one or four stones.\n\n\nLet M(n) be the maximum number of stones the first player can take from a winning position at his first turn and M(n)=0 for any other position.\n\n\n\u2211\u2009M(n) for n\u2264100 is 728.\n\n\nFind  \u2211\u2009M(n) for n\u22641018.\nGive your answer modulo 108.\n", "solution": "88351299", "difficulty": 40, "story": "Once upon a time in a small village nestled at the foot of a mountain, there lived two friends named Anton and Bernhard. During the day, they would go about their daily chores, but at night, they would gather at the local tavern to indulge in their favorite pastime - playing games.\n\nOne evening, as they sat at their usual table near the hearth, a mysterious traveler joined them. His name was Marcus, and he was known for his love of riddles and puzzles. Intrigued by his reputation, Anton and Bernhard decided to challenge him to a game.\n\nMarcus smiled, nodding appreciatively. \"Very well, my friends. I have a game that involves strategy and a touch of mathematics. Get ready.\"\n\nAnton and Bernhard exchanged excited glances, their competitive spirits brimming. Marcus then began explaining the rules of the game.\n\n\"Here's how it works,\" Marcus explained. \"There is a pile of n stones. The first player may remove any positive number of stones, but not the entire pile. After that, each player may remove at most twice the number of stones that his opponent took on the previous move. The player who removes the last stone wins.\"\n\nAnton and Bernhard furrowed their brows, trying to grasp the concept. It was a far cry from the usual games they played, but it piqued their interest.\n\n\"To better understand,\" Marcus continued, \"let's consider an example. Suppose there are 5 stones in the pile. If the first player takes anything more than one stone, the next player will be able to take all the remaining stones. However, if the first player takes one stone, leaving four, his opponent will also take one stone, leaving three. The first player cannot take all three because he may take at most 2 times 1, which equals 2 stones. So, let's say he also takes one stone, leaving two. The second player can take the remaining two stones and wins. Hence, 5 is a losing position for the first player.\"\n\nAnton and Bernhard exchanged glances once again, this time contemplating the possibilities. Marcus noticed the newfound determination on their faces and smiled. The game had captivated their imagination.\n\n\"For some winning positions, there is more than one possible move for the first player,\" Marcus added, intriguing them further. \"For example, when there are 17 stones in the pile, the first player can remove either one or four stones.\"\n\nAnton's eyes brightened as he seized onto a strategy in his mind, while Bernhard rubbed his chin thoughtfully, calculating the possible moves. They couldn't help but feel the thrill of the game and its mathematical intricacies.\n\nAs the night grew older, the trio played numerous rounds, exploring various stone configurations and devising strategies to outsmart one another. Each turn brought new calculations, as Anton and Bernhard tried to understand the optimal number of stones to take in order to secure victory.\n\nHours turned into an entire night, and with every passing game, their minds grew sharper and more nimble. They played until the tavern keeper announced the arrival of dawn, and the last embers of the fire began to fade.\n\nFinally, as the sun peered over the distant mountaintop, casting its warm glow upon the sleepy village, Anton and Bernhard realized they had met their intellectual match in Marcus.\n\nThe three friends bid each other farewell, promising to reunite for another game in the future. Anton and Bernhard exchanged a knowing look, their minds still buzzing with calculations and strategies, curiosity unabated.\n\nAs they left the tavern, the morning breeze whispered through the village streets, carrying the final words Marcus had spoken before they parted ways.\n\n\"Tell me, my friends,\" Marcus said with a twinkle in his eye, \"what is the sum of M(n) for n\u22641018? Give your answer modulo 108.\"\n\nAnton and Bernhard stood there for a moment, their thoughts whirling with the possibilities. And as they headed home, the question burned in their minds, driving them to seek the answer, not just for the sake of the game, but for the sheer joy of unraveling the mystery.\n\nSo I ask you now, dear reader, can you solve the mathematical puzzle put forth by Marcus? What is the sum of M(n) for n\u22641018? Give your answer modulo 108."}, {"id": 374, "euler_id": 374, "title": "Maximum Integer Partition Product", "problem": "An integer partition of a number n is a way of writing n as a sum of positive integers.\nPartitions that differ only in the order of their summands are considered the same.\nA partition of n into distinct parts is a partition of n in which every part occurs at most once.\nThe partitions of 5 into distinct parts are:\n5, 4+1 and 3+2.\nLet f(n) be the maximum product of the parts of any such partition of n into distinct parts and let m(n) be the number of elements of any such partition of n with that product.\nSo f(5)=6 and m(5)=2.\nFor n=10 the partition with the largest product is 10=2+3+5, which gives f(10)=30 and m(10)=3.\nAnd their product, f(10)\u00b7m(10) = 30\u00b73 = 90\nIt can be verified that\n\u2211\u2009f(n)\u00b7m(n) for 1 \u2264 n \u2264 100 = 1683550844462.\nFind \u2211\u2009f(n)\u00b7m(n) for 1 \u2264 n \u2264 1014.\nGive your answer modulo 982451653, the 50 millionth prime.", "solution": "334420941", "difficulty": 40, "story": "Once upon a time in the Kingdom of Arithmoria, there was a young princess named Ava. Princess Ava was curious and intelligent, always searching for knowledge and inspiration. It was said that she had inherited her love for numbers from her mother, the Queen, who had been a renowned mathematician.\n\nOne beautiful summer day, Princess Ava came across an ancient book hidden in the royal library. Its pages were yellowed with age, but the words written inside sparkled with the intrigue of mathematical mysteries. As she sat down to explore its contents, a particular problem caught her eye.\n\nThe problem discussed partitions of a number, and how to find the maximum product of the parts in a partition where each part occurred only once. Princess Ava couldn't resist the challenge. She closed her eyes and imagined herself unraveling the intricacies of this mathematical conundrum.\n\nAs Ava delved deeper into the problem, she realized that every number had its unique set of partitions. The larger the number, the more possibilities there were. She marveled at the elegance of the solutions, seeing patterns and connections between different partitions.\n\nDays turned into weeks, and weeks into months, as Princess Ava immersed herself in the world of numbers. The partitions of each number danced before her eyes, and she discovered fascinating relationships and properties. Her passion for mathematics grew with every new insight.\n\nMeanwhile, a rival kingdom, Quadradiana, under the rule of the cunning King Cedric, cast an envious eye upon Arithmoria. King Cedric had heard whispers of Princess Ava's mathematical prowess and feared that her brilliance could be used against him.\n\nIn a treacherous attempt to eliminate Princess Ava, King Cedric plotted to steal the ancient book from Arithmoria. He believed that the knowledge within its pages held the key to unlocking the secrets of power and supremacy.\n\nOne moonlit night, as Princess Ava sat surrounded by her mathematical musings, a group of dark figures crept into the royal library. Suppressing her panic, she quickly hid the book, not wanting its secrets to fall into the wrong hands. Princess Ava discreetly watched from the shadows as the intruders rummaged through the shelves, searching for the treasure of knowledge.\n\nJust as King Cedric's men were about to give up their hunt, a splash of moonlight illuminated the hidden book. It was a stroke of luck that the light guided their eyes to the very place where Princess Ava had concealed it. The intruders, now triumphant, seized the ancient book and retreated into the night.\n\nDevastated by the loss of her mathematical companion, Princess Ava knew that she had to retrieve the book at any cost. With determination burning in her eyes, she set off on a perilous journey to Quadradiana.\n\nAs Princess Ava approached the imposing castle of King Cedric, a thought occurred to her. If she could solve the mathematical problem presented in the book, it might grant her the power to not only retrieve it but also ensure the safety and prosperity of Arithmoria. She realized that the solution lay in finding the sum of the maximum product of the parts and the number of partitions for every integer from 1 to 1014, modulo the 50 millionth prime number.\n\nWith renewed resolve, Princess Ava faced the treacherous puzzles and riddles laid before her by the guards of Quadradiana. Each solved riddle brought her closer to King Cedric's throne room and the coveted ancient book.\n\nAs she finally stood before King Cedric, Princess Ava claimed the right to challenge him to a duel of intellect. She would solve the mathematical problem, and if successful, King Cedric would relinquish not only the ancient book but also his ambitions against Arithmoria.\n\nAfter hours of intense calculations and deep thought, Princess Ava approached the climax of her mathematical journey. The solution to the problem confronted her, tantalizingly close yet ever elusive. She could almost taste the thrill of victory.\n\nBut as the story of Princess Ava drawing to a close, dear reader, it is now your turn to solve the mystery. What is the value of \u2211\u2009f(n)\u00b7m(n) for 1 \u2264 n \u2264 1014, modulo 982451653, the 50 millionth prime? Only you hold the key to Princess Ava's triumph. So, tell me, my dear reader, can you solve the mathematical problem and ensure Princess Ava's success?"}, {"id": 375, "euler_id": 375, "title": "Minimum of subsequences", "problem": "Let Sn be an integer sequence produced with the following pseudo-random number generator:\nS0=290797Sn+1=Sn2mod50515093\n\nLet A(i,j) be the minimum of the numbers Si,Si+1,\u2026,Sj for i\u2264j.\nLet M(N)=\u2211A(i,j) for 1\u2264i\u2264j\u2264N.\nWe can verify that M(10)=432256955 and M(10000)=3264567774119.\n\nFind M(2000000000).\n", "solution": "7435327983715286168", "difficulty": 40, "story": "Once upon a time in a small village nestled deep in the mountains, there lived a young shepherd named Milo. Milo was known far and wide for his exceptional skills in tending to his sheep. He spent most of his days high up on the green hills, surrounded by the peaceful bleating of his flock and the breathtaking view of the valley below.\n\nOne sunny morning, as Milo was leading his herd to a lush grazing spot, he stumbled upon a peculiar object half-buried in the soft earth. Curiosity got the better of him, and he bent down to examine it more closely. It was an ancient-looking parchment, yellowed with age, inscribed with a mysterious script.\n\n\"This must hold a secret!\" thought Milo.\n\nExcitement rushing through his veins, Milo took the parchment back to his cozy cottage and began deciphering the symbols. Hours turned into days as he poured over ancient texts and consulted learned scholars, until finally, a breakthrough came.\n\nThe parchment contained instructions for a mathematical problem that went far beyond anything Milo had ever encountered. The sequence of numbers, the formula, the complexities of it all\u2014Milo was both fascinated and bewildered.\n\nDetermined to uncover the hidden meaning behind the problem, Milo took it upon himself to solve it. He delved into the depths of his knowledge of mathematics, spending nights scribbling away at his calculations. The once tranquil hills now echoed with the sound of his fervent pencil.\n\nBut it wasn't just questions of numbers that consumed Milo's mind. The problem had become a metaphorical maze, intertwining with his thoughts, and ultimately, his dreams. He couldn't separate himself from it; it was as if his very purpose was now entangled with the solution.\n\nDays turned into weeks, and weeks into months, yet Milo persisted in unraveling the enigma. The more he learned, the more clarity he sought. The village folk, amazed by his unwavering dedication, rallied around him, offering encouragement and support.\n\nThrough the long nights spent poring over the ancient script, Milo discovered patterns within the numbers, elegant formulas that somehow weaved themselves into the very tapestry of existence. It seemed that solving the problem would bring about a profound revelation, unveiling secrets beyond ordinary perception.\n\nAs Milo approached the climax of his journey, he felt a mixture of anticipation and trepidation. The answer to the problem held immense power, and he wondered how it would reshape his understanding of the world. With each step closer to the truth, he felt an undeniable surge of purpose, as if there was something greater at stake.\n\nAnd so, dear reader, I leave you with this question: How will Milo's quest for the solution to this mathematical problem change him and the world around him? Is it the answer that holds the power, or the journey itself? Will the numbers unlock the deepest secrets of the universe, or will they simply lead to a greater mystery?\n\nOnly you can solve this equation, dear reader."}, {"id": 386, "euler_id": 386, "title": "Maximum length of an antichain", "problem": "Let n be an integer and S(n) be the set of factors of n.\nA subset A of S(n) is called an antichain of S(n) if A contains only one element or if none of the elements of A divides any of the other elements of A.\nFor example: S(30) = {1, 2, 3, 5, 6, 10, 15, 30}\n{2, 5, 6} is not an antichain of S(30).\n{2, 3, 5} is an antichain of S(30).\nLet N(n) be the maximum length of an antichain of S(n).\nFind \u2211\u2009N(n) for 1 \u2264 n \u2264 108", "solution": "528755790", "difficulty": 40, "story": "In the bustling city of Numeria, mathematicians from far and wide gathered for the annual Mathematics Symposium. Among them was a young prodigy named Sophia, with her curly hair and eager eyes. Sophia was no ordinary mathematician. At just sixteen years old, she possessed a remarkable ability to see patterns in numbers that others couldn't fathom.\n\nAs the symposium commenced, various presentations were made on intriguing mathematical problems. Sophia eagerly absorbed the knowledge, her mind buzzing with excitement. But it was during a lecture by Professor Alexander, a renowned mathematician, that she heard about a problem that piqued her interest.\n\n\"Let n be an integer,\" Professor Alexander began, his voice commanding the attention of everyone in the room. \"Consider the set of factors of n, denoted as S(n). Now, imagine a subset A of S(n) where A contains only one element or none of the elements in A divides any of the other elements.\"\n\nSophia listened intently, intrigued by this concept of antichains. Professor Alexander continued, \"We call such a subset an antichain of S(n). For example, let's take the integer 30. The set of factors of 30 is {1, 2, 3, 5, 6, 10, 15, 30}. {2, 5, 6} is not an antichain of S(30), but {2, 3, 5} is an antichain of S(30). Now, let N(n) be the maximum length of an antichain of S(n).\"\n\nSophia's mind raced with possibilities. The concept of antichains fascinated her, and she knew that she had stumbled upon something extraordinary. She had to solve this problem, but how?\n\nDays turned into weeks, and weeks turned into months as Sophia dedicated herself to unraveling the mystery of antichains. She poured over countless equations, analyzed countless examples, and discussed her findings with fellow mathematicians. Even though the journey was arduous, Sophia remained determined.\n\nAs time passed, Sophia discovered fascinating patterns. She noticed that prime numbers had antichains of length one since their only factor was themselves. However, composite numbers posed greater challenges. The longer the list of prime factors, the more difficult it became to find an antichain.\n\nSophia's excitement grew exponentially as she made progress. She recorded her findings meticulously, creating a library of equations and solutions. It felt like she was piecing together a grand puzzle, and every discovery was an accomplishment of its own.\n\nFinally, the day of the symposium arrived. Sophia stood before the gathered experts, a sense of satisfaction spreading through her nerves. She presented her findings, her voice trembling with excitement as she shared her journey of exploration and the patterns she had unraveled.\n\nThe mathematicians were captivated by Sophia's research, the possibilities that unfolded before them. They marveled at the potential applications of antichains, from cryptography to optimization algorithms. The room buzzed with excitement, and Sophia's heart thrilled at the impact her work could have on the world.\n\nBut deep within, Sophia still had one question nagging at her. As her presentation drew to a close, she addressed the audience, a glimmer of curiosity dancing in her eyes. \"Now that we have explored various examples and uncovered fascinating patterns, I pose this question to all of you. What is the sum of N(n) for 1 \u2264 n \u2264 108?\"\n\nThe room fell silent as everyone contemplated the magnitude of the question. They knew that Sophia's work had laid the foundation, but this question required collective effort. An air of determination filled the symposium as mathematicians from all corners of Numeria vowed to solve the enigmatic problem Sophia had posed.\n\nAnd so, the question hung in the air, its solution eluding them, but their minds brimming with possibilities. Together, they would embark on a new journey, fueled by the promise of discovery and the knowledge that mathematics held yet-untold wonders."}, {"id": 395, "euler_id": 395, "title": "Pythagorean tree", "problem": "\nThe Pythagorean tree is a fractal generated by the following procedure:\n\n\nStart with a unit square. Then, calling one of the sides its base (in the animation, the bottom side is the base):\n Attach a right triangle to the side opposite the base, with the hypotenuse coinciding with that side and with the sides in a 3-4-5 ratio. Note that the smaller side of the triangle must be on the 'right' side with respect to the base (see animation).\n Attach a square to each leg of the right triangle, with one of its sides coinciding with that leg.\n Repeat this procedure for both squares, considering as their bases the sides touching the triangle.\n\nThe resulting figure, after an infinite number of iterations, is the Pythagorean tree.\n\n\n\n\nIt can be shown that there exists at least one rectangle, whose sides are parallel to the largest square of the Pythagorean tree, which encloses the Pythagorean tree completely.\n\n\nFind the smallest area possible for such a bounding rectangle, and give your answer rounded to 10 decimal places.\n", "solution": "28.2453753155", "difficulty": 40, "story": "Once upon a time in the small town of Pythagoria, there lived a young girl named Lily. Lily was always curious about the world around her, eager to explore and discover new things. One day, as she was walking through the town square, she stumbled upon a mysterious old book lying on a bench.\n\nIntrigued, Lily picked up the book and began flipping through its weathered pages. To her surprise, she found herself immersed in a world of mathematical wonders and enchanting fractals. The pages were filled with illustrations of intricate patterns, captivating her imagination.\n\nAs she delved deeper into the book, Lily stumbled upon a particular page that caught her attention. It contained the Pythagorean tree and a mathematical problem that seemed both intriguing and challenging. This problem piqued her curiosity, and she knew she had to find a way to solve it.\n\nFrom that moment on, Lily's world revolved around the Pythagorean tree. She spent her days studying it, sketching countless triangles, and drawing squares in the hopes of unlocking its secrets. The townspeople, amused by her fervor, dubbed her \"The Pythagorean Explorer.\"\n\nOver time, Lily realized that the Pythagorean tree was a fractal that represented growth and transformation. She learned to appreciate the beauty and complexity that lay within its simple construction. The tree seemed to symbolize the infinite possibilities that lay within the world of mathematics.\n\nOne evening, as the sun began to set, Lily sat under the shade of the largest square in the Pythagorean tree. She gazed up at the branches that stretched above her, their symmetry mesmerizing. Lost in her thoughts, she wondered if there was more to the tree than meets the eye.\n\nSuddenly, a thought struck her. If the Pythagorean tree was infinite, could it be contained within a finite shape? Could there exist a rectangle that enveloped the entire fractal? This realization sparked a fire within Lily, and she knew she had to find the answer.\n\nDays turned into weeks as Lily dedicated herself to solving the problem. She immersed herself in her studies, scribbling calculations and geometric equations. She visualized bounding rectangles of various sizes, attempting to find the smallest possible area.\n\nAs the town buzzed with anticipation, word of Lily's pursuit reached the ears of a renowned mathematician, Professor Ericson. He was not only amazed by Lily's determination but also impressed by the elegant and complex problem she was attempting to solve.\n\nTogether, Lily and Professor Ericson worked tirelessly, analyzing the Pythagorean tree from all angles, considering its intricacies and complexities. They discussed and debated, each bringing their unique perspective to the table. The townspeople watched in awe as their collective wisdom brought them closer to unraveling the mystery.\n\nFinally, the day arrived when Professor Ericson and Lily stood before the townspeople, their minds filled with awe and wonder. With a smile, Professor Ericson posed the question that had captivated everyone's attention: \"What is the smallest possible area for a bounding rectangle that perfectly encloses the Pythagorean tree?\"\n\nThe townspeople murmured among themselves, excitement and anticipation filling the air. They had witnessed Lily's unwavering determination, and now, the answer to their question seemed within reach. Their eyes turned to Lily, who stood before them, ready to embark on the final leg of her journey.\n\nAnd so, dear reader, I leave you with this question: Can you solve the mathematical problem that has captivated Lily and the entire town of Pythagoria? What is the smallest area possible for a bounding rectangle that encloses the infinite beauty of the Pythagorean tree?"}, {"id": 396, "euler_id": 396, "title": "Weak Goodstein sequence", "problem": "\nFor any positive integer n, the nth weak Goodstein sequence {g1, g2, g3, ...} is defined as:\n g1 = n\n for k > 1, gk is obtained by writing gk-1 in base k, interpreting it as a base k + 1 number, and subtracting 1.\n\nThe sequence terminates when gk becomes 0.\n\n\nFor example, the 6th weak Goodstein sequence is {6, 11, 17, 25, ...}:\n g1 = 6.\n g2 = 11 since 6 = 1102, 1103 = 12, and 12 - 1 = 11.\n g3 = 17 since 11 = 1023, 1024 = 18, and 18 - 1 = 17.\n g4 = 25 since 17 = 1014, 1015 = 26, and 26 - 1 = 25.\n\nand so on.\n\n\nIt can be shown that every weak Goodstein sequence terminates.\n\n\nLet G(n) be the number of nonzero elements in the nth weak Goodstein sequence.\nIt can be verified that G(2) = 3, G(4) = 21 and G(6) = 381.\nIt can also be verified that \u2211\u2009G(n) = 2517 for 1 \u2264 n < 8.\n\n\nFind the last 9 digits of \u2211\u2009G(n) for 1 \u2264 n < 16.\n", "solution": "173214653", "difficulty": 40, "story": "Once upon a time, in a land where numbers ruled and mathematical mysteries thrived, there lived a young girl named Lily. She had always been fascinated by the magic of numbers, drawn to the patterns and secrets they held. Her days were spent exploring the vast library of mathematical knowledge, searching for hidden gems that would unravel the mysteries of the universe.\n\nOne sunny afternoon, as Lily delved deep into the realms of abstract mathematics, she stumbled upon a peculiar problem\u2014 the nth weak Goodstein sequence. The words danced off the page, igniting a curiosity that consumed her. Intrigued by the challenge it posed, Lily set out on a quest to understand the enigma that lay before her.\n\nIn her small village, Lily sought guidance from the wise old mathematician, Professor Fibonacci. With his sage advice, she embarked on a journey to discover the secrets of the weak Goodstein sequence. Day and night, she toiled away, studying the intricacies of base numbers, conversions, and subtraction.\n\nHer efforts were rewarded when she unraveled the beauty hidden within the Goodstein sequence. As the numbers transformed under the power of base conversions, Lily marveled at the magic of mathematics.\n\nAs she grew more engrossed in her studies, Lily realized the profound implications of the Goodstein sequence. Everything she had learned about numbers, patterns, and computations culminated in this mathematical wonder. The weak Goodstein sequence defied logic and exhibited an elegant chaos that fascinated her. It was an invaluable treasure still untapped by the world.\n\nDriven by her newfound passion, Lily channeled her energy into calculating the numbers within the Goodstein sequence. She scribbled countless equations, lost in the realm of computation. The sequence became her muse, her guiding star in the vast and complex world of math.\n\nBut as Lily's excitement grew, so did the scale of her challenge. The Goodstein sequence seemed to stretch endlessly, and the calculations grew more intricate with each term. Determined to unravel its secrets, she pushed herself harder, as long as the numbers whispered their magic to her.\n\nDays turned into weeks, and weeks into months, until finally, one starry night, Lily came to a realization. She had cracked the code, deciphering the last nine digits of the sum of the Goodstein sequence for 1 \u2264 n < 16. It was a moment of triumph, of immeasurable joy.\n\nBut as the numbers fell into place, Lily's heart swelled with one final question that echoed through her mind. She now turned to you, dear reader, with a twinkle in her eye and a smile on her lips. Can you discover the last nine digits of \u2211\u2009G(n) for 1 \u2264 n < 16?\n\nAnd so, armed with the knowledge and the spark of curiosity, the baton is passed from Lily to you, inviting you to immerse yourself in the wonder of mathematics and solve the puzzle that has captivated their hearts for so long. Will you accept the challenge and unlock the secrets that lie beyond the weak Goodstein sequence? The answer awaits, nestled amidst the beauty of numbers."}, {"id": 405, "euler_id": 405, "title": "A rectangular tiling", "problem": "\nWe wish to tile a rectangle whose length is twice its width.\nLet T(0) be the tiling consisting of a single rectangle.\nFor n > 0, let T(n) be obtained from T(n-1) by replacing all tiles in the following manner:\n\n\n\n\nThe following animation demonstrates the tilings T(n) for n from 0 to 5:\n\n\n\n\nLet f(n) be the number of points where four tiles meet in T(n).\nFor example, f(1) = 0, f(4) = 82 and f(109) mod 177 = 126897180.\n\n\nFind f(10k) for k = 1018, give your answer modulo 177.\n", "solution": "237696125", "difficulty": 40, "story": "Once upon a time, in a quaint little village by the name of Mathland, there lived a talented architect named Leonardo. Leonardo had a special knack for creating magnificent designs that left everyone in awe. His talent, coupled with a charming personality, made him a beloved figure among the villagers.\n\nOne day, Leonardo received a peculiar request from the village mayor. The mayor wanted him to design a community center that would become the centerpiece of Mathland. Eager to take on the challenge, Leonardo immediately set to work, sketching and planning the structure.\n\nAs Leonardo delved into the project, he faced a unique challenge. The mayor insisted that the community center be built in the shape of a rectangle, where the length was always twice the width. Leonardo pondered over the problem and started incorporating his mathematical prowess into the design.\n\nHe named the initial tiling of the rectangle T(0) and decided to cover it with a single rectangle. This would serve as the foundation for the rest of the tiling design. With each iteration, represented by T(n), Leonardo replaced all the tiles in a specific manner, creating a stunning pattern.\n\nLeonardo's creative mind worked tirelessly, imagining the intricate details of each tile replacement. As he continued designing, he realized that he needed to keep track of something essential to maintain the flow and integrity of the pattern. These were the points where four tiles met. He decided to name them f(n).\n\nThe more Leonardo progressed, the more fascinated he became with these meeting points. He observed that f(1) equaled zero, meaning no four tiles met at any point within T(1). He pondered over what f(4) could be, and as his calculations confirmed, there were precisely eighty-two such points.\n\nThe process continued, and Leonardo's designs became more and more intricate with every iteration. As he dreamed about T(109), his mind raced with excitement. It was a challenge to find f(109) modulo 177, but the thought of completing this task thrilled him.\n\nNow, dear reader, imagine yourself standing next to Leonardo in his workshop, where the walls are adorned with sketches and calculations. As you admire his progress, you can't help but wonder about the mystery of the meeting points at the heart of all his designs.\n\nYou turn to Leonardo, whose eyes shine with determination, and you ask him, \"What could f(10k) be with k = 1018? Can you give me the answer modulo 177?\"\n\nLeonardo's smile widens as he sees your curiosity. He ponders your question for a moment, his creative mind whirring with possibilities, and then he says, \"The answer lies within the pattern I have created. Study it, analyze it, and use your mathematical prowess to reveal the solution. Tell me, dear reader, what is f(10k) mod 177?\"\n\nAnd so, with the challenge set before you, you embark on your own journey of mathematical exploration. Will you be able to decipher the hidden beauty of Leonardo's designs? Will you unlock the secret of f(10k) modulo 177?\n\nOnly time will tell."}, {"id": 418, "euler_id": 418, "title": "Factorisation triples", "problem": "\nLet n be a positive integer. An integer triple (a, b, c) is called a factorisation triple of n if: 1 \u2264 a \u2264 b \u2264 c\n a\u00b7b\u00b7c = n.\n\nDefine f(n) to be a + b + c for the factorisation triple (a, b, c) of n which minimises c / a. One can show that this triple is unique.\n\n\nFor example, f(165) = 19, f(100100) = 142 and f(20!) = 4034872.\n\n\nFind f(43!).\n", "solution": "1177163565297340320", "difficulty": 40, "story": "Once upon a time in the bustling city of Numeria, there lived a young mathematician named Amelia. She had a brilliant mind and an insatiable curiosity for all things numerical. Her days were spent poring over complex equations and solving mathematical riddles. Despite her young age, Amelia had become quite famous in her city for her remarkable ability to tackle even the most perplexing problems.\n\nOne sunny morning, as she sipped on a cup of tea in her favorite caf\u00e9, an elderly man named Albert approached her. He had a peculiar look on his face, a mix of excitement and desperation. Intrigued, Amelia invited him to join her at her table.\n\n\"Good morning, sir. How may I help you today?\" she asked kindly.\n\n\"Ah, my dear Amelia,\" Albert said, his voice trembling slightly, \"I have a mathematical conundrum that has plagued me for ages. You see, I am searching for a factorisation triple for an extraordinary number. But no matter how hard I try, I cannot find it.\"\n\nAmelia's eyes sparkled with interest. She loved a good challenge, and this seemed like a fascinating puzzle. \"Pray tell me, sir, what is this unusual number you speak of?\"\n\nAlbert leaned closer, his voice barely above a whisper. \"It is none other than forty-three factorial.\" He smiled knowingly, realizing the immensity of the task he had just set before Amelia.\n\nAmelia's eyes widened in astonishment. Forty-three factorial was an astronomical number\u2014equal to the product of multiplying all the positive integers from one to forty-three. The challenge was clear: find the factorization triple that minimizes the ratio of the largest to the smallest number.\n\nDetermined to solve the riddle, Amelia delved deep into her study of factorization triples. She scrutinized the properties of such triples, seeking the one that would unlock the secrets of forty-three factorial. Days turned into weeks, and weeks into months, but Amelia remained undeterred. She tirelessly made calculations, scribbling numbers and formulas onto countless pages of her notebook.\n\nAs her journey progressed, Amelia also discovered the stories behind each factorization triple she encountered. The tales of the numbers came alive in her mind\u2014a dance between the mathematical and the human. She saw elegance in the union of factors, harmony in the carefully constructed equations.\n\nOne afternoon, as Amelia's eyes scanned through rows of numbers, she found herself at a crossroads. The factorization triple she had discovered seemed to lead her down two distinct paths\u2014a choice between order and chaos, between clarity and uncertainty.\n\nAmelia's heart raced as she contemplated the different options. Should she choose the triple that minimized the ratio of the largest to the smallest number? Or should she follow her intuition, which whispered to her that there might be something more profound hidden in the labyrinth of numbers?\n\nHer mind, sharp as ever, weighed the possibilities. She considered the significance of minimizing the ratio\u2014how it could simplify complex systems and provide a more elegant solution. But she also understood the power of the unknown, the boundless potential that lay beyond the comprehensible.\n\nAmelia's gaze shifted from her calculations to the world around her. She saw the city's vibrant streets, filled with people engaged in their own journeys. Every person, she realized, was a factor in their own unique equation\u2014a piece of a larger puzzle. And just like her mathematical conundrum, their lives were an intricate dance between choices and forces they couldn't always control.\n\nLost in her contemplation, Amelia closed her notebook and looked up at the sky. A gentle breeze played with her hair, as if urging her to embrace the uncertainty. The answer to Albert's mathematical riddle, she realized, lay not only in the numbers but also in the journey itself. The choice she made would reveal not only a solution but also something essential about herself.\n\nAnd so, dear reader, I invite you to join Amelia on her quest. What path will she choose? Can you find the factorization triple that minimizes the ratio of the largest to the smallest number in forty-three factorial? Will Amelia find the key to crack the code of Albert's enigmatic puzzle?"}, {"id": 431, "euler_id": 431, "title": "Square Space Silo", "problem": "Fred the farmer arranges to have a new storage silo installed on his farm and having an obsession for all things square he is absolutely devastated when he discovers that it is circular. Quentin, the representative from the company that installed the silo, explains that they only manufacture cylindrical silos, but he points out that it is resting on a square base. Fred is not amused and insists that it is removed from his property.\nQuick thinking Quentin explains that when granular materials are delivered from above a conical slope is formed and the natural angle made with the horizontal is called the angle of repose. For example if the angle of repose, \u03b1=30 degrees, and grain is delivered at the centre of the silo then a perfect cone will form towards the top of the cylinder. In the case of this silo, which has a diameter of 6m, the amount of space wasted would be approximately 32.648388556 m3. However, if grain is delivered at a point on the top which has a horizontal distance of x metres from the centre then a cone with a strangely curved and sloping base is formed. He shows Fred a picture.\n\n\nWe shall let the amount of space wasted in cubic metres be given by V(x). If x=1.114785284, which happens to have three squared decimal places, then the amount of space wasted, V(1.114785284)\u224836. Given the range of possible solutions to this problem there is exactly one other option: V(2.511167869)\u224849. It would be like knowing that the square is king of the silo, sitting in splendid glory on top of your grain.\nFred's eyes light up with delight at this elegant resolution, but on closer inspection of Quentin's drawings and calculations his happiness turns to despondency once more. Fred points out to Quentin that it's the radius of the silo that is 6 metres, not the diameter, and the angle of repose for his grain is 40 degrees. However, if Quentin can find a set of solutions for this particular silo then he will be more than happy to keep it.\nIf Quick thinking Quentin is to satisfy frustratingly fussy Fred the farmer's appetite for all things square then determine the values of x for all possible square space wastage options and calculate \u2211x correct to 9 decimal places.", "solution": "23.386029052", "difficulty": 40, "story": "Once upon a time, on a sprawling farm nestled between rolling hills and vibrant fields, there lived a farmer named Fred. Fred was a man of routines and principles, but above all, he had an inexplicable fondness for all things square. From the perfectly aligned rows of crops to the precisely angled corners of his farmhouse, everything on his farm adhered to the symmetry of squares.\n\nOne sunny morning, Fred received a call from Quentin, a representative from a company that specialized in installing storage silos. Quentin, a charismatic and quick-thinking individual, was excited to present a new silo to Fred that he just knew would revolutionize his farming operation.\n\nEagerly, Quentin explained the advantages of the silo, but Fred's excitement quickly turned to devastation when he discovered that the silo was not the square design he had envisioned. Instead, it was a perfectly cylindrical structure with a circular base.\n\n\"I'm sorry, Quentin, but this cannot do,\" Fred said firmly, his disappointment evident. \"My farm thrives on squares, and this just won't match.\"\n\nQuentin, determined to salvage the situation, offered a proposition. \"Fred, let me explain the beauty of this cylindrical silo. You see, when granular materials are delivered from above, a conical slope forms inside. The angle at which this slope meets the horizontal is called the angle of repose.\"\n\nFred raised an eyebrow, intrigued despite himself. Quentin continued, \"If the angle of repose is, say, 30 degrees, and the grain is delivered at the silo's center, a perfect cone will form towards the top of the cylinder. However, if the grain is delivered at a point away from the center, a cone with a uniquely curved and sloping base will form.\"\n\nWith that, Quentin showed Fred a picture, depicting the wastage of space inside the silo at various points of delivery. The image portrayed a square-like shape forming at one of the delivery points, and Fred's eyes lit up with renewed delight.\n\n\"But Quentin, how do we calculate the amount of space wasted in each scenario?\" Fred asked.\n\nQuentin smiled and said, \"Let us denote the amount of space wasted, in cubic meters, as V(x), where x represents the horizontal distance in meters from the center of the silo to the delivery point. For example, if x is approximately 1.114785284, the wasted space will be about 36 cubic meters.\"\n\nFred leaned in closer, fascinated by the possibilities. \"Are there any other values of x that result in square space wastage?\" he inquired.\n\nQuentin nodded. \"Indeed, there is another option. If x is approximately 2.511167869, the wasted space will amount to around 49 cubic meters. It will be like having a square sitting atop your grain, Fred.\"\n\nFred's eyes sparkled with delight, but his enthusiasm soon wavered as he inspected Quentin's drawings and calculations. \"Quentin, my friend, you may have missed a crucial detail. You assumed the diameter of the silo to be 6 meters, but it is, in fact, the radius. Additionally, the angle of repose for my grain is 40 degrees.\"\n\nA hint of worry flickered in Quentin's eyes, but he was not one to back down from a challenge. With determination, he assured Fred that he would find a set of solutions tailored to his specific silo.\n\nFred, ever the man of principles, offered Quentin an incentive. \"If you can find a set of solutions for this particular silo, I'll be more than happy to keep it. Please, Quentin, satisfy my frustratingly fussy appetite for all things square.\"\n\nAnd so, the story unfolds, with Quentin embarking on a mathematical quest to determine the values of x that would result in square space wastage for Fred's cylindrical silo. As he grapples with the intricate calculations and precise measurements, Quentin's mind races while his fingers dance across the keyboard.\n\nNow, dear reader, can you solve this mathematical problem that lies at the heart of Fred and Quentin's story? Can you determine the values of x for all possible square space wastage options? And, most importantly, can you calculate the sum of these values, correct to 9 decimal places?\n\n"}, {"id": 449, "euler_id": 449, "title": "Chocolate covered candy", "problem": "Phil the confectioner is making a new batch of chocolate covered candy. Each candy centre is shaped like an ellipsoid of revolution defined by the equation:\nb2x2+b2y2+a2z2=a2b2.\nPhil wants to know how much chocolate is needed to cover one candy centre with a uniform coat of chocolate one millimeter thick.\n\nIf a=1 mm and b=1 mm, the amount of chocolate required is 283\u03c0 mm3\nIf a=2 mm and b=1 mm, the amount of chocolate required is approximately 60.35475635 mm3.\nFind the amount of chocolate in mm3 required if a=3 mm and b=1 mm. Give your answer as the number rounded to 8 decimal places behind the decimal point.", "solution": "103.37870096", "difficulty": 40, "story": "Once upon a time, in a quaint little town named Sweetville, there lived a confectioner named Phil. Phil was known far and wide for his delectable chocolate creations that would make anyone's taste buds dance with delight. His little candy shop, nestled in the heart of the town, was always filled with the scent of melted chocolate, attracting customers from all walks of life.\n\nOne sunny morning, as Phil opened his shop, he discovered a long-lost recipe for a secret candy. His eyes widened with excitement and curiosity as he read the instructions. The candy center was supposed to be shaped like an ellipsoid of revolution, a mathematical shape that Phil had never encountered before.\n\nIntrigued, Phil set off to solve the mystery of the ellipsoid of revolution. He delved into his beloved books and consulted trusted mathematicians in the town. After tireless hours of research and calculations, Phil finally uncovered the equation that defined the candy center: b^2x^2 + b^2y^2 + a^2z^2 = a^2b^2.\n\nHowever, Phil's mathematical quest didn't end there. He wanted to know more about his newfound shape. Phil wanted to know how much chocolate would be needed to cover one candy center with a uniform coat, one millimeter thick. His customers deserved nothing but perfection, and Phil wasn't about to disappoint them.\n\nWith bated breath, Phil eagerly studied the mathematical problem, which revealed that if a = 1 mm and b = 1 mm, the amount of chocolate required would be 283\u03c0 mm^3. Phil marveled at the intricate calculations involved in determining the chocolate quantity down to the last cubic millimeter. His mind wandered as he imagined the candy centers being immersed in a sea of luscious chocolate, ready to bring joy to his customers' lives.\n\nPondering further, Phil wondered how much chocolate he would need if a = 2 mm and b = 1 mm. To his surprise, the answer was approximately 60.35475635 mm^3. The amount was significantly less than what he would have expected, dawning on him the importance of the dimensions a and b in determining the required chocolate amount.\n\nNow, a new question lingered in Phil's mind. What would the amount of chocolate in mm^3 be if a = 3 mm and b = 1 mm? The answer would hold the key to creating the perfect candy, ensuring a harmonious balance between the candy center and its chocolate coating.\n\nAs Phil looked out of his candy shop window, a glimmer of anticipation sparkled in his eyes. He knew that the solution to this mathematical problem would be the final piece of his candy-making puzzle. And so, with renewed determination, Phil set out to uncover the magic number, guiding his path towards the most delightful candy experience his customers would ever taste.\n\nAnd so, dear reader, as you contemplate Phil's quest, I leave you with a question: What is the amount of chocolate in mm^3 required if a = 3 mm and b = 1 mm? Can you solve this confectionary mystery and help Phil create the perfect candy?"}, {"id": 455, "euler_id": 455, "title": "Powers With Trailing Digits", "problem": "Let f(n) be the largest positive integer x less than 109 such that the last 9 digits of nx form the number x (including leading zeros), or zero if no such integer exists.\nFor example:\nf(4) = 411728896 (4411728896 = ...490411728896) \nf(10) = 0\nf(157) = 743757 (157743757 = ...567000743757)\n\u2211\u2009f(n), 2 \u2264 n \u2264 103 = 442530011399\nFind \u2211\u2009f(n), 2 \u2264 n \u2264 106.", "solution": "450186511399999", "difficulty": 40, "story": "In the small town of Willowbrook, there lived a young boy named Oliver. Oliver was a curious and imaginative child, always seeking adventure and mysteries to solve. He was known for his insatiable thirst for knowledge, and his favorite subject happened to be mathematics.\n\nOne day, as Oliver was flipping through the pages of an old math book he found in his grandfather's attic, he stumbled upon an intriguing problem. It was no ordinary problem, but one that seemed to hold a secret, wrapped in a web of numbers.\n\nOliver read the problem over and over again, trying to decipher its meaning. His eyes widened with excitement as he realized the importance of the task. He could feel a surge of adrenaline coursing through his veins. This wasn't just any math problem; it was a mystery waiting to be unraveled.\n\nDetermined to crack the code, Oliver embarked on a journey of mathematical exploration. He spent days and nights huddled over his notebook, scribbling equations and testing different theories. His mind was consumed by the numbers, each digit holding a hidden clue.\n\nAs the days turned into weeks, Oliver's excitement only grew. He began to notice patterns and connections between the numbers. Each new breakthrough brought him closer to solving the problem. He could almost taste victory.\n\nMeanwhile, the townspeople of Willowbrook noticed the change in Oliver. They marveled at the focus and dedication he displayed. They were inspired by his determination and eagerly provided their support whenever he needed it.\n\nOne by one, the pieces of the puzzle fell into place. Oliver's hard work and perseverance were paying off. He could see the answer on the horizon, just within his grasp. But the closer he got, the harder the problem seemed to become.\n\nThen, one fateful night, as Oliver lay staring at the starlit sky, he had an epiphany. It was as if the universe whispered the solution into his ear. His heart raced with anticipation as he rushed to his room, flipping through his notebook, searching for the missing link.\n\nAnd there it was, hidden among the equations and calculations, the final piece of the puzzle. Oliver's eyes widened in awe and disbelief as he realized the magnitude of what he had accomplished. He had solved the problem, cracked the code that had remained a mystery for so long.\n\nBut as Oliver celebrated his victory, a new question arose within him. The numbers, the solution he had discovered, were just a fraction of a larger problem. His eyes twinkled with excitement as he wondered what lay ahead. What treasures did the mathematical world hold for him to uncover?\n\nSo, dear reader, as you accompany Oliver on his journey, I pose a question to you. Can you solve the mathematical problem that captured Oliver's heart and ignited his passion? Can you find \u2211\u2009f(n), 2 \u2264 n \u2264 106?\n\nThe answer lies within the depths of numbers, waiting to be discovered. Are you ready to embark on this adventure and let the world of mathematics enchant you?"}, {"id": 469, "euler_id": 469, "title": "Empty chairs", "problem": "\nIn a room N chairs are placed around a round table.\nKnights enter the room one by one and choose at random an available empty chair.\nTo have enough elbow room the knights always leave at least one empty chair between each other.\n\n\nWhen there aren't any suitable chairs left, the fraction C of empty chairs is determined.\nWe also define E(N) as the expected value of C.\nWe can verify that E(4) = 1/2 and E(6) = 5/9.\n\n\nFind E(1018). Give your answer rounded to fourteen decimal places in the form 0.abcdefghijklmn.\n", "solution": "0.56766764161831", "difficulty": 40, "story": "Once upon a time in the kingdom of Numeria, there was a young and ambitious knight named Sir Marcus. Sir Marcus was known throughout the land for his incredible bravery and unwavering loyalty to the crown. He had fought in many battles, single-handedly vanquishing entire armies. His reputation was so great that he caught the attention of King Arthur himself.\n\nOne day, King Arthur summoned Sir Marcus to his chamber. \"Sir Marcus,\" the king began, \"I have a most peculiar predicament. As you know, I am a lover of mathematics and puzzles. I have been presented with a mathematical problem that has been troubling me. I have pondered over it for days, but I cannot find a solution. I need your help.\"\n\nIntrigued, Sir Marcus listened intently as King Arthur explained the problem to him. The king spoke of knights entering a room, opting for a random empty chair. They left at least one empty chair between each other for comfort. When there were no suitable chairs left, they calculated the fraction of empty chairs called \"C.\" The king was especially interested in determining the expected value of C.\n\nAs he listened, Sir Marcus couldn't help but imagine a room filled with knights, each searching for a chair while maintaining a respectful distance from one another. The scene played out in his mind like a well-choreographed dance. The mathematical problem fascinated him, and he resolved to find a solution for the king.\n\nFor days and nights, Sir Marcus delved into the world of numbers and patterns. His quest for knowledge led him to scholars, mathematicians, and even visiting wizards. Everyone provided their insights, but no one had been able to crack the problem entirely.\n\nThe young knight's dreams were filled with symbols, equations, and arrows pointing towards the unknown. He became obsessed, consumed by the challenge before him.\n\nMonths passed, and Sir Marcus was no closer to finding a solution. His once vibrant spirit started fading away, his eyes drooping with exhaustion. Fearful for the knight's well-being, the kind-hearted King Arthur visited him in his quarters.\n\n\"Sir Marcus, my loyal knight,\" the king said gently, \"I appreciate all the effort you've put into solving this mathematical problem. But sometimes, it's essential to remember that the mind needs rest. You cannot solve everything by yourself. Perhaps it is time to take a step back and approach the problem from a different perspective.\"\n\nThe knight pondered the king's words, his thoughts swirling like leaves blown by the wind. Maybe he had been too focused on finding a single solution, unable to see what was right in front of him. Sir Marcus realized that he needed to combine his love for math with his innate creativity.\n\nWith newfound determination, Sir Marcus embarked on a journey throughout Numeria. He met musicians, painters, poets, and dancers\u2014people who expressed themselves through art. Inspired by their passion, he began to see patterns in their work, hidden equations lurking underneath every stroke of a brush or strum of a guitar.\n\nDays turned into weeks, and weeks into months as Sir Marcus delved deeper into his artistic exploration. Slowly, the pieces of the puzzle began to come together. The knights entering the room, the chairs spaced apart\u2014they were like notes in a symphony, harmonizing with one another.\n\nOne fateful evening, as the sun set and the sky painted a vibrant tapestry of oranges and purples, Sir Marcus stumbled upon a breakthrough. A revelation so profound that his heart fluttered with anticipation.\n\nWith trembling hands, Sir Marcus compiled his findings, filled with eagerness and the desire to share his discovery with King Arthur. He knew that he had finally cracked the mathematical problem that had eluded them all.\n\nBut what is Sir Marcus's solution to the mathematical problem? Will his findings satisfy the king's curiosity and put his mind at ease? And most importantly, what is the value of E(1018)? Are you brave enough to step into Sir Marcus's shoes and solve the puzzle yourself?\n\nThe answer awaits you, just beyond the borders of this story. The path is yours to walk, and the solution lies within your reach. Will you solve the mystery that baffled the brightest minds of Numeria?"}, {"id": 487, "euler_id": 487, "title": "Sums of power sums", "problem": "Let fk(n) be the sum of the kth powers of the first n positive integers.\nFor example, f2(10) = 12 + 22 + 32 + 42 + 52 + 62 + 72 + 82 + 92 + 102 = 385.\nLet Sk(n) be the sum of fk(i) for 1 \u2264 i \u2264 n. For example, S4(100) = 35375333830.\nWhat is \u2211\u2009(S10000(1012) mod p) over all primes p between 2 \u22c5 109 and 2 \u22c5 109 + 2000?", "solution": "106650212746", "difficulty": 40, "story": "Once upon a time in a small village called Mathlandia, there lived a young and brilliant mathematician named Alice. Alice had an insatiable curiosity for numbers and mathematics. She spent her days engrossed in solving complex equations, theorems, and conjectures, always eager to uncover the secrets of the world through the lens of numbers.\n\nOne sunny morning, as Alice was strolling through the village, she overheard a conversation between two elders. They were discussing a mysterious artifact that was said to possess unimaginable power. It was rumored to grant whoever solved a particular mathematical problem the ability to control the elements of nature.\n\nIntrigued, Alice interrupted the conversation and eagerly asked about the problem. The seasoned elders, impressed by her passion, shared the problem with her. They spoke of the famous sum Sk(n) and the challenge of calculating the sum \u2211\u2009(S10000(1012) mod p) over all primes p between 2\u22c5109 and 2\u22c5109 + 2000. They explained that the artifact could only be unlocked if one could solve this seemingly impossible mathematical feat.\n\nAlice's eyes lit up with excitement. She knew she had to unravel the mystery behind this enigmatic problem. Determined and fueled by her curiosity, she headed straight to her humble abode.\n\nDays turned into weeks, and weeks into months, as Alice delved deeper into the problem. She tirelessly scribbled equations, ran calculations, and experimented with various formulas. She became so absorbed in her quest that she seldom slept or ate.\n\nAs the villagers noticed Alice's dedication, they rallied around her, providing support and encouragement whenever she stumbled upon yet another seemingly unsolvable roadblock. Time seemed to blur as Alice ventured further down the rabbit hole of numbers.\n\nHer relentless pursuit finally paid off. After countless sleepless nights and endless days of pondering, Alice had a eureka moment. She had discovered a breakthrough in her understanding of the problem, a unique insight that had eluded everyone before her.\n\nNow, Alice stood at a crossroads. She possessed the key to unlocking the ancient artifact, but she had a choice to make. Should she claim the power for herself, or should she share her discovery with the world, knowing that it could change everything?\n\nHer altruistic heart guided her decision. She realized that mathematics was not just for personal gain but for the betterment of society. Alice had always believed that knowledge should be shared, and so she resolved to reveal her findings to the world.\n\nThe news of Alice's remarkable discovery spread like wildfire throughout the land. Scholars, scientists, and mathematicians from every corner flocked to her village, eager to learn from her and to contribute to this new field of mathematical exploration. Together, they worked tirelessly, building upon her breakthrough, pushing the boundaries of knowledge and reshaping the world.\n\nAnd so, dear reader, I leave you with a question. Can you solve the mathematical problem that captivated Alice's mind and opened the door to a boundless realm of knowledge and possibilities? What is \u2211\u2009(S10000(1012) mod p) over all primes p between 2\u22c5109 and 2\u22c5109 + 2000?\n\nThe answer lies within the realm of numbers, waiting to be discovered by those passionate enough to embark on this quest. May your journey be as exhilarating as Alice's, and may you find the solution that connects you to the magical world of mathematics."}, {"id": 497, "euler_id": 497, "title": "Drunken Tower of Hanoi", "problem": "Bob is very familiar with the famous mathematical puzzle/game, \"Tower of Hanoi,\" which consists of three upright rods and disks of different sizes that can slide onto any of the rods. The game begins with a stack of n disks placed on the leftmost rod in descending order by size. The objective of the game is to move all of the disks from the leftmost rod to the rightmost rod, given the following restrictions:\nOnly one disk can be moved at a time.\nA valid move consists of taking the top disk from one stack and placing it onto another stack (or an empty rod).\nNo disk can be placed on top of a smaller disk.\nMoving on to a variant of this game, consider a long room k units (square tiles) wide, labeled from 1 to k in ascending order. Three rods are placed at squares a, b, and c, and a stack of n disks is placed on the rod at square a.\nBob begins the game standing at square b. His objective is to play the Tower of Hanoi game by moving all of the disks to the rod at square c. However, Bob can only pick up or set down a disk if he is on the same square as the rod / stack in question.\nUnfortunately, Bob is also drunk. On a given move, Bob will either stumble one square to the left or one square to the right with equal probability, unless Bob is at either end of the room, in which case he can only move in one direction. Despite Bob's inebriated state, he is still capable of following the rules of the game itself, as well as choosing when to pick up or put down a disk.\nThe following animation depicts a side-view of a sample game for n = 3, k = 7, a = 2, b = 4, and c = 6:\n\nLet E(n,k,a,b,c) be the expected number of squares that Bob travels during a single optimally-played game. A game is played optimally if the number of disk-pickups is minimized.\nInterestingly enough, the result is always an integer. For example, E(2,5,1,3,5) = 60 and E(3,20,4,9,17) = 2358.\nFind the last nine digits of \u22111\u2264n\u226410000 E(n,10n,3n,6n,9n).", "solution": "684901360", "difficulty": 40, "story": "Once upon a time, in the bustling town of Mathematica, lived a man named Bob. Bob was known by all for his love of puzzles and games, especially one called the Tower of Hanoi. He spent countless hours solving this mathematical puzzle, maneuvering disks from one rod to another with utmost precision.\n\nOne sunny afternoon, Bob received an intriguing letter from a distant relative inviting him to visit their estate on the outskirts of town. The letter revealed a tantalizing secret: hidden within the estate was a room known as the \"Puzzle Parlor,\" where Bob would encounter a variation of the Tower of Hanoi puzzle.\n\nIntrigued by the challenge, Bob eagerly packed his bags and set off on an adventure to the mysterious estate. As he arrived at the grand entrance, he was met by his cousin, Samuel, who guided him through the opulent halls towards the Puzzle Parlor.\n\nThe room was immense, stretching out before them with three sturdy rods positioned at different squares. Bob's eyes widened as Samuel explained the rules of the puzzle. His objective was to move all the disks from the rod at square a to the rod at square c. However, there was a catch - Bob could only pick up or set down a disk if he was standing on the same square as the rod or stack in question.\n\nBut what really caught Bob's attention was the special condition of the puzzle. As Samuel explained, whenever Bob made a move, he would stumble one square to the left or right with equal probability, unless he was at either end of the room. Bob couldn't help but chuckle at the whimsy of this additional challenge. It seemed that fate had conspired to make this the ultimate test of his skills.\n\nUndeterred by the uncertainty of his own steps, Bob took a deep breath and decided to embark on the puzzle. With every move, he contemplated his next step, carefully deciding which disk to pick up and where to place it. The room seemed to spin around him as he weaved through the rods, his mind focused solely on the puzzle at hand.\n\nHours turned into days, and Bob tried various strategies, searching for the optimal way to play the game. Though his footsteps stumbled unpredictably, his mathematical mind guided him through the maze of possibilities. He understood that each decision he made affected the number of times he had to pick up a disk, ultimately influencing the expected number of squares he traveled during the game.\n\nBob's determination was unyielding. He persevered through countless attempts, always striving to minimize the number of disk-pickups, which in turn would decrease the expected number of squares he traveled. The puzzles became more challenging, with larger stacks of disks and wider rooms. Nevertheless, Bob pressed on, relentlessly testing his mental fortitude and mathematical acumen.\n\nAs he faced the final challenge \u2013 a room with a width of 10,000 squares and stacks of disks at positions 3n, 6n, and 9n \u2013 Bob couldn't help but marvel at how far he had come. The journey had been arduous and filled with twists and turns, both literal and mathematical. Yet, he found solace in the beauty of the puzzle, in its ability to engage his mind, and in the satisfaction of finding the unexpected allure of numbers.\n\nNow, dear reader, it is your turn to take up the challenge. Can you decipher the last nine digits of the sum of Bob's expected number of squares traveled for the various Tower of Hanoi puzzles he encountered on his extraordinary journey?\n\nAs you set forth on this mathematical odyssey, where logic intertwines with randomness, remember Bob's tireless pursuit of minimizing disk-pickups. Think deeply, for in the answer lies the essence of the puzzle's mystery. Can you find the solution, and unlock the secret hidden within the numbers?\n\n"}, {"id": 498, "euler_id": 498, "title": "Remainder of polynomial division", "problem": "For positive integers n and m, we define two polynomials Fn(x) = xn and Gm(x) = (x-1)m.\nWe also define a polynomial Rn,m(x) as the remainder of the division of Fn(x) by Gm(x).\nFor example, R6,3(x) = 15x2 - 24x + 10.\nLet C(n, m, d) be the absolute value of the coefficient of the d-th degree term of Rn,m(x).\nWe can verify that C(6, 3, 1) = 24 and C(100, 10, 4) = 227197811615775.\nFind C(1013, 1012, 104) mod 999999937.", "solution": "472294837", "difficulty": 40, "story": "Once upon a time in the kingdom of Mathlandia, there lived a talented young mathematician named Ryan. Ryan was not your average mathematician. He had a unique ability to see patterns in numbers and solve complex problems effortlessly. His talent had earned him a reputation far and wide, and he was highly regarded by his peers.\n\nOne fine day, a messenger arrived at Ryan's doorstep, carrying a sealed letter with the royal crest of Mathlandia. The letter was an invitation from King Mathias himself, requesting Ryan's assistance with a problem that had been puzzling the kingdom's scholars for many years.\n\nIntrigued by the challenge, Ryan set off to the royal palace. As he made his way through the grand corridors, he couldn't help but wonder what awaited him. When Ryan entered the king's study, he was greeted by a room filled with books and various mathematical instruments.\n\n\"Ah, Ryan! I'm pleased you could come,\" King Mathias said, rising from his massive wooden chair. \"We have a mathematical problem that has eluded us for decades, and we believe you can help solve it.\"\n\nRyan listened intently as the king explained the problem involving polynomials and divisors. The sheer complexity of the problem fascinated him. It was like trying to unravel the secrets of the universe with nothing but numbers.\n\nThe king continued, \"We have been trying to find the remainder of the division of polynomials Fn(x) by Gm(x) for various values of n and m. This remainder, Rn,m(x), holds great importance to us. There's a specific term, the d-th degree term, whose coefficient we need to determine. We call this coefficient C(n, m, d). So far, we have managed to solve many cases, but the one we need your help with is quite baffling.\"\n\nRyan's mind began to race, thinking of the possibilities and potential solutions. If he could crack this problem, he would not only prove his worth as a mathematician but also contribute to the knowledge and prosperity of Mathlandia.\n\nFor several days and nights, Ryan immersed himself in the problem given by the king. He scoured through countless textbooks, made endless calculations, and experimented with intricate formulas. His determination never faltered, for he knew that the answer held the potential to unlock the secrets of unseen patterns and connections in mathematics.\n\nDays turned into weeks, and weeks turned into months. Ryan became so consumed by the problem that he barely ate or slept. His hair grew unkempt, and his eyes were bloodshot from countless hours spent poring over equations and diagrams.\n\nFinally, after months of relentless work, something extraordinary happened. Ryan discovered a breakthrough. He found an ingenious method of calculating the coefficient C(n, m, d) using modular arithmetic. His heart raced with excitement as he realized the immense significance of this discovery.\n\nEager to share his finding with King Mathias and the scholars of Mathlandia, Ryan returned to the palace. There, in the king's study, he unveiled his solution, explaining the intricacies of modular arithmetic and its application to the problem.\n\nAs Ryan finished his explanation, an audible gasp filled the room. King Mathias, the scholars, and even the royal court were astounded by the elegance of his solution. They hailed Ryan as a hero, for his work would undoubtedly influence the future of mathematics in the kingdom and beyond.\n\nHowever, as the celebrations subsided and the crowd dispersed, a lingering question remained in Ryan's mind. He knew his solution was a significant scientific achievement, but he wondered if it held any practical value in the real world.\n\nNow, dear reader, it is up to you to solve the final piece of the puzzle. What is C(1013, 1012, 104) mod 999999937? Take a moment to absorb the story of Ryan's remarkable journey and use your mathematical prowess to uncover the answer that eluded all others.\n\nRemember, hidden within this complex equation lies the key to a kingdom's knowledge. Fate and destiny await your calculations. Will you accept the challenge and uncover the secret of C(1013, 1012, 104) mod 999999937?"}, {"id": 501, "euler_id": 501, "title": "Eight Divisors", "problem": "The eight divisors of 24 are 1, 2, 3, 4, 6, 8, 12 and 24.\nThe ten numbers not exceeding 100 having exactly eight divisors are 24, 30, 40, 42, 54, 56, 66, 70, 78 and 88.\nLet f(n) be the count of numbers not exceeding n with exactly eight divisors.\nYou are given f(100)\u00a0=\u00a010, f(1000)\u00a0=\u00a0180 and f(106)\u00a0=\u00a0224427.\nFind f(1012).", "solution": "197912312715", "difficulty": 40, "story": "Once upon a time, in a small village nestled in the mountains, lived a young girl named Lily. Lily was known for her curious and inquisitive nature, always seeking new puzzles and mysteries to solve. One sunny morning, as she walked through the village square, she stumbled upon an old, dusty book lying on a worn-out wooden bench.\n\nHer eyes lit up with excitement as she read the title: \"The Secrets of Numbers.\" Intrigued, Lily opened the book and began flipping through its pages. As she scanned each page, she noticed an interesting mathematical problem. It spoke of divisors and numbers, piquing her interest even further.\n\n\"The eight divisors of 24 are 1, 2, 3, 4, 6, 8, 12, and 24,\" she read aloud. \"And there are ten numbers not exceeding 100 with exactly eight divisors.\" Lily's mind started buzzing with questions. What could those ten numbers be? How could she find them? And more importantly, why did this matter so much?\n\nUnable to contain her excitement, Lily decided to embark on a thrilling adventure. She knew that solving this puzzle might lead her to uncover something extraordinary. With a sense of purpose in her heart, she set out on a journey to meet the wise mathematician living in an enchanted forest nearby.\n\nAs Lily ventured into the dense forest, the trees seemed to whisper and point her towards the path she should take. After what felt like hours of hiking, she arrived at a small cottage surrounded by vibrant flowers and towering trees. With a deep breath, she knocked on the door.\n\nTo her surprise, a friendly, old man with a long white beard opened the door. He introduced himself as Professor Newton, a renowned mathematician who had spent his entire life unraveling the mysteries of numbers. Lily explained her quest to him, hoping he would guide her in her search for the ten numbers with exactly eight divisors.\n\nThe wise professor smiled and invited her into his cozy study. Together, they delved into the world of divisors and numbers, exploring different patterns and formulas. Lily marveled at the complexity and beauty of mathematics, feeling her passion grow with each passing moment.\n\nDays turned into weeks, and weeks into months, as Lily and Professor Newton poured over textbooks, scribbled calculations, and contemplated the intricacies of divisors. They discovered that f(n) represented the count of numbers not exceeding n with exactly eight divisors. Armed with their newfound knowledge, they solved f(100) and f(1000) with sheer determination and a dash of brilliance.\n\nBut their quest was not yet over. Before parting ways, Professor Newton bequeathed Lily the most challenging task of all\u2014to find and solve f(1012), the count of numbers not exceeding one trillion with exactly eight divisors. The professor assured her that solving this problem would unveil hidden secrets about the nature of numbers, and perhaps, even change the world as they know it.\n\nAnd so, armed with her talent, curiosity, and a touch of magic from the enchanted forest, Lily set off on a new adventure. But as she pondered over Professor Newton's challenge, she wondered\u2014would she be able to find f(1012)? Would this elusive answer change her life as it had changed the professor's? And most importantly, would she unravel the mystical power hidden within the world of numbers?\n\nAs you read this story, dear reader, pause for a moment and ponder the mathematical problem at the heart of Lily's journey. Can you solve f(1012)? Can you uncover the secrets of those numbers not exceeding one trillion with exactly eight divisors?"}, {"id": 515, "euler_id": 515, "title": "Dissonant Numbers", "problem": "Let d(p,n,0) be the multiplicative inverse of n modulo prime p, defined as n\u00a0\u00d7\u00a0d(p,n,0)\u00a0=\u00a01\u00a0mod\u00a0p.\nLet d(p,n,k) = \u2211i=1nd(p,i,k\u22121) for k\u00a0\u2265\u00a01.\nLet D(a,b,k) = \u2211(d(p,p-1,k) mod p) for all primes a\u00a0\u2264\u00a0p\u00a0<\u00a0a\u00a0+\u00a0b.\nYou are given:\nD(101,1,10) = 45\nD(103,102,102) = 8334\nD(106,103,103) = 38162302Find D(109,105,105).", "solution": "2422639000800", "difficulty": 40, "story": "The sun was setting over the small village of Oakbrook, casting a warm hue over the tranquil streets. In the heart of the village stood an ancient oak tree, its branches reaching out toward the sky as if to touch the secrets whispered among the stars.\n\nNestled within the village was a humble blacksmith named Marcus, renowned for his skill in forging the finest weapons and armor. Marcus had always been fascinated by numbers and patterns, finding solace in the infinite possibilities they seemed to offer. Little did he know that his love for numbers would soon lead him on a grand adventure.\n\nOne fateful morning, as Marcus was engrossed in his work, a traveler entered his shop. The stranger had a weathered face and eyes full of intensity.\n\n\"Good day, sir,\" Marcus greeted him with a smile. \"What can I do for you?\"\n\nThe traveler paused for a moment, as if considering his words carefully. \"I seek the legendary Sword of Sages, said to grant the wielder unimaginable power. But to forge such a weapon, I require a mathematical solution.\"\n\nIntrigued, Marcus put down his hammer and quizzically looked at the traveler. \"What kind of mathematical solution do you need?\"\n\nThe traveler drew a map from his tattered cloak, revealing intricate equations and formulas. \"I need the value of D(109,105,105). It is the key to unlocking the sword's true potential.\"\n\nMarcus was taken aback. He had heard tales of the Sword of Sages, but never had he imagined that it could be bound by a mathematical problem.\n\n\"I am no mathematician,\" Marcus replied hesitantly. \"But I am willing to help. Together, we shall find the solution.\"\n\nAnd so, Marcus and the traveler embarked on a journey that would take them to distant lands and ancient libraries. They sought out mathematicians and scholars, seeking advice and guidance.\n\nAs they delved deeper into the world of numbers, Marcus's fascination grew. The mathematical problem had become the core of his existence, driving him forward. It was as if the solution itself held the key to unlocking the mysteries of the universe.\n\nTheir travels took them to the grand city of Mathemore, where the greatest minds of the realm convened. There, in the Hall of Equations, Marcus stood before a gathering of renowned mathematicians.\n\n\"I have traveled far and wide, seeking the solution to this mathematical problem - D(109,105,105),\" Marcus declared, his voice filled with determination. \"I implore you, great scholars, to join me on this quest for knowledge.\"\n\nThe mathematicians exchanged curious glances, and a hush fell over the room. One by one, they approached Marcus, their eyes filled with both skepticism and intrigue.\n\n\"We shall help you,\" they said, their voices resonating with a mixture of excitement and uncertainty.\n\nDays turned into weeks, and weeks into months. Marcus and the scholars dedicated themselves to the pursuit of this elusive solution. They scribbled equations on parchment, exchanged theories, and conducted countless experiments.\n\nEach small discovery brought them closer to unraveling the mystery. The mathematicians marveled at the patterns inherent within the problem, captivated by its intricate design.\n\nFinally, after countless sleepless nights and tireless efforts, they arrived at a breakthrough. The numbers aligned, revealing a glimpse of the solution they had sought for so long.\n\nBut just as the mathematicians reached the pinnacle of their achievement, a question hung in the air: \"What is the value of D(109,105,105)?\"\n\nAnd so, dear reader, I pose this question to you. Can you uncover the value of D(109,105,105)? Can you solve the riddle that has captivated the minds of scholars and adventurers alike?\n\nAs the sun sets on another day, the village of Oakbrook awaits your answer. Will you be the one to unlock the secret hidden within the mathematical problem, and in doing so, unleash the power of the Sword of Sages?"}, {"id": 538, "euler_id": 538, "title": "Maximum quadrilaterals", "problem": "Consider a positive integer sequence S\u00a0=\u00a0(s1,\u00a0s2,\u00a0...,\u00a0sn).\nLet f(S) be the perimeter of the maximum-area quadrilateral whose side lengths are 4 elements (si, sj, sk, sl) of S (all i, j, k, l distinct). If there are many quadrilaterals with the same maximum area, then choose the one with the largest perimeter.\nFor example, if S\u00a0=\u00a0(8,\u00a09,\u00a014,\u00a09,\u00a027), then we can take the elements (9,\u00a014,\u00a09,\u00a027) and form an isosceles trapezium with parallel side lengths 14 and 27 and both leg lengths 9. The area of this quadrilateral is 127.611470879... It can be shown that this is the largest area for any quadrilateral that can be formed using side lengths from S. Therefore, f(S)\u00a0=\u00a09\u00a0+\u00a014\u00a0+\u00a09\u00a0+\u00a027\u00a0=\u00a059.\nLet un\u00a0=\u00a02B(3n)\u00a0+\u00a03B(2n)\u00a0+\u00a0B(n+1), where B(k) is the number of 1 bits of k in base 2.\nFor example, B(6)\u00a0=\u00a02, B(10)\u00a0=\u00a02 and B(15)\u00a0=\u00a04, and u5\u00a0=\u00a024\u00a0+\u00a032\u00a0+\u00a02\u00a0=\u00a027.\nAlso, let Un be the sequence (u1,\u00a0u2,\u00a0...,\u00a0un).\nFor example, U10\u00a0=\u00a0(8,\u00a09,\u00a014,\u00a09,\u00a027,\u00a016,\u00a036,\u00a09,\u00a027,\u00a028).\nIt can be shown that f(U5)\u00a0=\u00a059, f(U10)\u00a0=\u00a0118, f(U150)\u00a0=\u00a03223.\nIt can also be shown that \u2211\u2009f(Un)\u00a0=\u00a0234761 for 4\u00a0\u2264\u00a0n\u00a0\u2264\u00a0150.\nFind \u2211\u2009f(Un) for 4\u00a0\u2264\u00a0n\u00a0\u2264\u00a03\u00a0000\u00a0000.", "solution": "22472871503401097", "difficulty": 40, "story": "Once upon a time in the town of Mathlandia, there was a talented mathematician named Professor Euclid. He was known for his love of numbers and his ability to solve the most complex mathematical problems. Every year, the Mathlandia Mathematics Society organized a competition to challenge the brightest young minds in the town. As fate would have it, this year's competition revolved around a rather intriguing problem, one that would test the participants' understanding of sequences and quadrilaterals.\n\nProfessor Euclid had decided to mentor a young prodigy named Amelia, who had a remarkable talent for numbers. Amelia was thrilled to have the opportunity to work with the renowned mathematician, and they began brainstorming together.\n\nTheir journey started by studying all the known mathematical properties related to different types of quadrilaterals. They discovered that a quadrilateral could have various forms, each with its own set of side lengths and angles. Professor Euclid explained to Amelia that it was essential to find the maximum-area quadrilateral, as it would provide the highest score in the competition.\n\nAs they delved deeper into the problem, they realized that the crucial factor was the sequence of positive integers, Un. This sequence was defined in terms of binary representation and the number of 1 bits. Professor Euclid explained how this sequence played a pivotal role in determining the perimeter of the maximum-area quadrilateral. The mathematical problem challenged the participants to find the sum of perimeters for a specific range of n.\n\nAmelia found herself fascinated by the mathematical problem, but also overwhelmed by its complexity. She spent hours studying the various properties of quadrilaterals and exploring strategies to solve the problem. Professor Euclid patiently guided her, sharing his expertise and insights.\n\nAs days turned into weeks, Amelia's understanding of the problem grew, and she became more confident in her abilities. She felt the excitement building up within her, as she knew she was getting closer to the solution. However, she also couldn't help but wonder about the significance of this problem in the grand scheme of things. How could this intricate calculation contribute to solving real-world challenges?\n\nAmelia's mind was filled with countless possibilities. Perhaps this problem had applications in architecture, where determining maximum-area quadrilaterals could help optimize materials and design structures more efficiently. Or maybe it could be used in cutting-edge technology, where it would pave the way for advancements in computer graphics or simulations.\n\nThe day of the competition finally arrived, and Amelia was more determined than ever to showcase her newfound knowledge. She stood on the stage, facing a sea of eager faces. The voice of the announcer echoed through the auditorium, revealing the problem that had consumed her thoughts for weeks.\n\n\"As Professor Euclid and Amelia explored the world of quadrilaterals and sequences, they stumbled upon a profound mathematical problem. Their question to you is this: What is the sum of perimeters for the maximum-area quadrilaterals for the sequence Un, where 4 \u2264 n \u2264 3,000,000?\"\n\nThe crowd held its breath, waiting for an answer. Amelia, surrounded by the support of Professor Euclid and her fellow competitors, felt a sense of purpose. She had dedicated herself to unraveling the intricacies of this problem, and now she was ready to find the solution.\n\nBut the story does not end here. The question now falls to you, dear reader. Can you solve the mathematical problem that has captivated the minds of Professor Euclid and Amelia? What is the sum of perimeters for the maximum-area quadrilaterals?\n\nTake a leap into the realm of numbers and uncover the hidden truths. The future of Mathlandia awaits your answer."}, {"id": 552, "euler_id": 552, "title": "Chinese leftovers II", "problem": "\nLet An be the smallest positive integer satisfying  An mod pi = i  for all 1 \u2264 i \u2264 n, where pi is the\ni-th prime.\nFor example A2 = 5, since this is the smallest positive solution of the system of equations \n A2 mod 2 = 1 \n A2 mod 3 = 2\nThe system of equations for A3 adds another constraint. That is, A3 is the smallest positive solution of\n A3 mod 2 = 1 \n A3 mod 3 = 2\n A3 mod 5 = 3\nand hence A3 = 23. Similarly, one gets A4 = 53 and A5 = 1523.\n\n\nLet S(n) be the sum of all primes up to n that divide at least one element in the sequence A.\nFor example, S(50) = 69 = 5 + 23 + 41, since 5 divides A2, 23 divides A3 and 41 divides A10 = 5765999453. No other prime number up to 50 divides an element in A.\n\n\nFind S(300000).", "solution": "326227335", "difficulty": 40, "story": "Once upon a time, in the quiet village of Mathlandia, a young boy named Arthur had a gift for numbers. From a very young age, he could solve complex math problems effortlessly, leaving even the most seasoned mathematicians amazed. However, Arthur's passion for mathematics made him a bit of an outcast among his peers. While they played outside, he would spend hours locked away in his room, lost in the world of numbers.\n\nOne day, as Arthur was flipping through the pages of an old math book, he stumbled upon a peculiar problem. It was a series of equations, each with a unique condition. Fascinated, he read it through repeatedly, trying to understand its underlying pattern.\n\n\"Let An be the smallest positive integer satisfying An mod pi = i for all 1 \u2264 i \u2264 n, where pi is the i-th prime,\" he muttered to himself, scratching his head. \"This seems complicated!\"\n\nBut Arthur was not one to shy away from a challenge. Intrigued, he began working on the first equation, A2 mod 2 = 1, and found that the answer was 5. He continued with the second equation, A2 mod 3 = 2, and discovered that A2 was indeed 5.\n\nHis excitement grew as he moved on to the next set of equations, A3 mod 2 = 1, A3 mod 3 = 2, and A3 mod 5 = 3. After much calculation, he finally arrived at the smallest positive solution: A3 was 23.\n\nRealizing there was a pattern emerging, Arthur pressed ahead to solve A4 and A5. Hours turned into days, but his determination held firm. For each equation, he yearned to uncover the smallest positive integer that would satisfy all the conditions. Finally, he wrote down A4 = 53 and A5 = 1523, the next numbers in the sequence.\n\nHis excitement grew as he dove deeper into this fascinating sequence of numbers, discovering that certain primes could divide these elements. This led him to the sum function, S(n), which measured the sum of all primes up to n that divided at least one element in the sequence A.\n\nArthur began calculating S(n) for various values of n, observing patterns, and marveling at the mathematical beauty before him. As he delved further into the world of S(n), he started to see connections between the primes and these special integers that satisfied the equations he had worked so hard to solve.\n\nBut the real question that plagued Arthur's mind was this: What is S(300000)? What could be the sum of all primes up to 300000 that divide at least one element in the magnificent sequence A he had uncovered?\n\nWith a determined look on his face, Arthur made his decision. It was time to embark on a grand adventure, searching for clues and unraveling the secrets of these extraordinary numbers. He knew that finding the value of S(300000) would not only satisfy his intellectual curiosity but also unlock the hidden power within the sequence A.\n\nAnd so, Arthur set out on a quest, armed with his trusty math book, a map of prime numbers, and an unyielding determination to solve the enigma of S(300000). But he knew he couldn't do it alone. He needed help from those who shared his love for numbers.\n\nDear reader, can you help Arthur solve this mathematical puzzle? What is the value of S(300000)? Join Arthur on his quest and let's uncover the secrets together!"}, {"id": 588, "euler_id": 588, "title": "Quintinomial coefficients", "problem": "\nThe coefficients in the expansion of (x+1)k are called binomial coefficients.\nAnaloguously the coefficients in the expansion of (x4+x3+x2+x+1)k are called quintinomial coefficients. (quintus= Latin for fifth).\n\n\nConsider the expansion of (x4+x3+x2+x+1)3:\nx12+3x11+6x10+10x9+15x8+18x7+19x6+18x5+15x4+10x3+6x2+3x+1\nAs we can see 7 out of the 13 quintinomial coefficients for k=3 are odd.\n\n\nLet Q(k) be the number of odd coefficients in the expansion of (x4+x3+x2+x+1)k.\nSo Q(3)=7.\n\n\nYou are given Q(10)=17 and Q(100)=35.\n\nFind  \u2211k=118Q(10k).\n", "solution": "11651930052", "difficulty": 40, "story": "The dusty antique shop on the corner of Elm Street had always been a haven for the curious and the inquisitive. Its owner, Mr. Robinson, was a kindly old man with a twisted white beard that seemed to have a mind of its own. He relished in sharing tales from bygone eras with those who entered his humble shop. \n\nOne autumn day, a young girl named Sophie wandered into the shop, her eyes wide with wonder. She had a penchant for adventure and a thirst for knowledge, and she believed that Mr. Robinson's shop held the answers to all the mysteries of the world. \n\n\"Ah, young Sophie, what brings you here today?\" Mr. Robinson greeted her with a friendly smile. \n\n\"I'm on a quest, Mr. Robinson,\" Sophie replied, her voice filled with determination. \"A quest to solve a mathematical riddle that has been plaguing my mind.\"\n\nIntrigued, Mr. Robinson leaned closer. \"Pray tell, my dear, what puzzle has captured your thoughts?\"\n\nSophie recounted the mathematical problem that had consumed her. She spoke of binomial coefficients and quintinomial coefficients, and how odd coefficients played a crucial role in the expansion of certain expressions. Mr. Robinson's eyes sparkled with delight.\n\n\"My dear child, you have stumbled upon a truly fascinating enigma,\" he exclaimed. \"The quintinomial coefficients are a rare gem of mathematical lore. Let me show you something.\"\n\nMr. Robinson reached behind the counter and pulled out an ancient leather-bound tome. Its pages were yellowed with age, but the symbols and equations were still sharp and clear. Sophie eagerly peered over the old man's shoulder as he turned to a specific page.\n\n\"Behold, the expansion of (x4+x3+x2+x+1)3,\" Mr. Robinson said, pointing at the equations written in precise ink. \"Every coefficient in this expansion represents a quintinomial coefficient. Count them, my dear.\"\n\nSophie's eyes darted across the page as she tallied the odd coefficients. \"There are seven,\" she exclaimed, a spark of triumph in her voice.\n\nMr. Robinson beamed with pride. \"Indeed, young Sophie, you have unravelled a secret thread in the tapestry of mathematics. But your journey does not end here. You must continue your pursuit.\"\n\nSophie nodded, her mind whirling with possibilities. She understood that the expansion of (x4+x3+x2+x+1)k held the key to finding the number of odd coefficients, Q(k). If she could solve it, she would be one step closer to unraveling the mathematical mysteries of the world.\n\nMonths passed, and Sophie delved deeper into the realm of numbers and equations. She spent countless hours poring over dusty textbooks and seeking guidance from her teachers. With every passing day, her understanding grew, and her passion burned brighter.\n\nOne day, as the sun began its descent behind the horizon, Sophie returned to Mr. Robinson's shop. She held a notebook filled with scribbles and calculations, a testament to her unwavering determination.\n\n\"Mr. Robinson, I have solved the mystery,\" she exclaimed, a mix of excitement and exhaustion in her voice. \"I have found Q(10) to be 17 and Q(100) to be 35. But now, I face a new challenge. I must find \u2211k=118Q(10k). Can you help me?\"\n\nMr. Robinson's eyes twinkled with pride. \"Ah, young Sophie, you have come so far on your journey. But the final step must be taken by you alone. The answer lies within the countless possibilities of numbers, waiting to be unlocked.\"\n\nSophie bit her lip, her mind racing to solve the final equation. She had come so far, and she refused to be deterred by the complexities before her. With determination in her heart, she clenched her fists and set out to weave together the fragments of her numerical conquest.\n\nAs Sophie ventured into the realm of equations, the question begs of you, dear reader: can you help her solve the final enigma, \u2211k=118Q(10k)? The challenge awaits, and the destiny of a young girl's aspirations is in your hands."}, {"id": 598, "euler_id": 598, "title": "Split Divisibilities", "problem": "\nConsider the number 48.\nThere are five pairs of integers a and b (a\u2264b) such that a\u00d7b=48: (1,48), (2,24), (3,16), (4,12) and (6,8).\nIt can be seen that both 6 and 8 have 4 divisors.\nSo of those five pairs one consists of two integers with the same number of divisors.\n\nIn general:\nLet C(n) be the number of pairs of positive integers a\u00d7b=n, (a\u2264b) such that a and b have the same number of divisors; so C(48)=1.\n\n\nYou are given C(10!)=3: (1680, 2160), (1800, 2016) and (1890,1920). \nFind C(100!)", "solution": "543194779059", "difficulty": 40, "story": "Once upon a time, in the small town of Numeria, there lived a young girl named Emma. Emma was a brilliant mathematician and had a particular fondness for numbers and patterns. She spent her days exploring the fascinating world of mathematical problems, always searching for the next challenge.\n\nOne sunny morning, as Emma was sitting by the window, absorbed in her thoughts, she noticed an unfamiliar figure approaching. It was an elderly man with silver hair and a wise demeanor. Intrigued, Emma invited him inside, eager to learn more about the stranger.\n\nThe man introduced himself as Professor Archimedes, a renowned mathematician who had journeyed far and wide to find someone who could help him with a perplexing problem. Emma's eyes sparkled with excitement, realizing that she had stumbled upon an opportunity to showcase her skills.\n\nAs the professor presented the mathematical problem, Emma listened intently. He described how the number 48 had five pairs of integers, but only one pair had two integers with the same number of divisors. Emma was captivated by the elegant nature of this problem and pondered what it truly meant.\n\nProfessor Archimedes continued to explain that a solution was necessary to understand a more significant quandary concerning C(100!). This was pivotal for unlocking new realms of mathematical possibilities. Emma's mind raced, contemplating the significance of C(100!). What secrets could it reveal about the world of mathematics?\n\nImmersed in her thoughts, Emma realized that she had stumbled upon the opportunity of a lifetime. She saw this as her chance to prove herself and make a remarkable mathematical discovery. Her heart pounding with anticipation, Emma made a decision that would set her on an incredible adventure.\n\n\"I will help you, Professor Archimedes,\" Emma declared, determined to solve the mystery of C(100!). She knew that this quest to unlock the secrets of C(100!) had the potential to reshape the world of mathematics as they knew it.\n\nAnd so, Emma and Professor Archimedes embarked on a journey together. They traveled through dusty libraries, consulted ancient scrolls, and engaged in countless intellectual debates. Along the way, they encountered other brilliant minds who joined their quest, each bringing their own unique perspectives.\n\nAs they delved deeper into their research, Emma discovered fascinating patterns and connections. She realized that C(100!) was not an ordinary mathematical problem but rather a gateway to an unimaginable universe of possibilities. The more she understood, the more she yearned to uncover the secrets hidden within.\n\nBut as their journey unfolded, Emma couldn't shake the feeling that time was running out. The urgency to find the solution grew stronger within her. Would she be able to decipher the enigma of C(100!) and unlock its immense power?\n\nAs the story draws to a close, a question lingers in the reader's mind: What is the value of C(100!)? This mathematical problem holds the key to unlocking an extraordinary world of knowledge and discovery. Will Emma and the professor find the solution in time? Can they unveil the secrets hidden within C(100!) and forever change the landscape of mathematics?\n\nOnly you, dear reader, can answer that question. Solve the mathematical problem of C(100!) and embark on your own journey to unlock the mysteries of Numeria."}, {"id": 604, "euler_id": 604, "title": "Convex path in square", "problem": "\nLet F(N) be the maximum number of lattice points in an axis-aligned N\u00d7N square that the graph of a single strictly convex increasing function can pass through.\n\n\nYou are given that F(1)=2, F(3)=3,  F(9)=6, F(11)=7, F(100)=30 and F(50000)=1898. \nBelow is the graph of a function reaching the maximum 3 for N=3:\n\n\n\n\nFind F(1018).\n", "solution": "1398582231101", "difficulty": 40, "story": "In the small town of Willowbrook, there lived a young and brilliant mathematician named Emily. Numbers danced in her mind, equations whispered in her dreams, and logic flowed through her veins. She had an insatiable curiosity, a thirst for knowledge, and an uncanny ability to see patterns in the world around her.\n\nOne sunny morning, as Emily strolled through the town square, she noticed a poster hanging on the community board. \"Mathematical Wonder Challenge,\" it read in bold letters. Intrigued, she leaned closer to read the details.\n\nThe challenge had been organized by the renowned mathematician, Professor Albert McAllister, who was impressed by the youth's intellectual prowess and sought to push her mind to its limits. The task at hand was to determine the maximum number of lattice points that a single strictly convex increasing function could pass through in an axis-aligned N\u00d7N square. The values for F(1), F(3), F(9), F(11), F(100), and even F(50000) were provided, but the elusive answer for F(1018) remained a mystery.\n\nEager to solve this mathematical riddle and prove her worth, Emily retreated to her study and dove headfirst into her calculations. Days turned into weeks, and chalk-covered blackboards adorned her walls. She mustered her perseverance and determination, refusing to succumb to the complexities of the problem.\n\nLate one evening, while staring at the graph she had meticulously sketched, inspiration struck. A glimmer of insight illuminated her mind, and she was certain she had found a breakthrough. A mixture of excitement and skepticism surged through her as she put her theory to the test.\n\nReturning to the town square, Emily sought out Professor McAllister to share her findings. He listened intently as she explained her approach and divulged her proposed solution. The professor's eyes widened with amazement, for Emily had unearthed a new method of calculating F(N) that had potential far beyond the mathematical confines of this challenge.\n\nThe discovery had profound implications, not just for the field of mathematics but also for various scientific disciplines. It created a wave of excitement, as scholars and researchers flocked to Willowbrook, eager to collaborate with Emily and explore the power and possibilities of her newfound formula.\n\nHowever, with her mind brimming with possibilities, Emily couldn't shake her lingering question: What was the elusive F(1018)? As her days filled with collaboration and exploration, she often found herself gazing out of her window, lost in thought.\n\nNow, dear reader, this is where you come in. Can you help Emily solve the final piece of the puzzle? What is F(1018)? The fate of this tiny town, the trailblazing mathematician, and the future of endeavors yet to be discovered are all in your hands.\n\nSo, tell us, can you unravel the mystery and find the solution?"}, {"id": 616, "euler_id": 616, "title": "Creative numbers", "problem": "Alice plays the following game, she starts with a list of integers L and on each step she can either:\nremove two elements a and b from L and add ab to L\nor conversely remove an element c from L that can be written as ab, with a and b being two integers such that a,b>1, and add both a and b to LFor example starting from the list L={8}, Alice can remove 8 and add 2 and 3 resulting in L={2,3} in a first step. Then she can obtain L={9} in a second step.\nNote that the same integer is allowed to appear multiple times in the list.\nAn integer n>1 is said to be creative if for any integer m>1 Alice can obtain a list that contains m starting from L={n}.\n\nFind the sum of all creative integers less than or equal to 1012.", "solution": "310884668312456458", "difficulty": 40, "story": "Once upon a time in a small village nestled deep in the mountains, there lived a curious and adventurous young girl named Alice. She was known for her inquisitive mind and her undying thirst for knowledge. While the other children spent their days playing hide-and-seek or climbing trees, Alice could often be found lost in books, exploring worlds far beyond the village.\n\nOne day, as Alice was perusing the dusty shelves of the old village library, a tattered book caught her eye. It was a book of riddles and puzzles, bound in faded leather with gilded letters that spelled out \"The Enigma of L\". Intrigued, Alice eagerly picked up the book and began to read.\n\nAs she delved deeper into the pages, Alice discovered a fascinating mathematical problem that piqued her interest. It told the story of a game, a game that Alice had never heard of before. The game involved a list of integers, and Alice was captivated by the possibilities it presented.\n\nAlice read on, realizing that the game had different rules, rules that seemed to defy logic. She could either remove two elements from the list, multiply them, and add the product back into the list. Or, she could remove an element that could be written as the product of two integers, and add both those integers back into the list. The goal was to manipulate the list in such a way that she could obtain any given integer by starting with a single number.\n\nThe more she read, the more Alice's mind raced with excitement. She imagined herself playing the game, navigating through a world where numbers danced and twirled, waiting to be rearranged. She wondered how she could use this newfound knowledge to solve other puzzles and unravel the secrets of the universe.\n\nAlice couldn't wait to share her discovery with the village. She imagined the joy on their faces when they, too, realized the potential of this game. But she also wondered if she could be the first to solve the ultimate puzzle \u2013 finding the sum of all creative integers less than or equal to 1012.\n\nAs Alice closed the book, she looked out at the village, the rolling hills, and the distant mountains. She felt a surge of determination and an unyielding urge to explore the boundaries of her imagination. With a sparkle in her eyes, she whispered to herself, \"Can you solve the enigma of L?\"\n\nAnd so, dear reader, I pose the same question to you. Can you uncover the sum of all creative integers less than or equal to 1012? Only you have the power to unlock the mysteries that lie within the countless possibilities of L."}, {"id": 617, "euler_id": 617, "title": "Mirror Power Sequence", "problem": "For two integers n,e>1, we define a (n,e)-MPS (Mirror Power Sequence) to be an infinite sequence of integers (ai)i\u22650 such that for all i\u22650, ai+1=min(aie,n\u2212aie) and ai>1. Examples of such sequences are the two (18,2)-MPS sequences made of alternating 2 and 4.\nNote that even though such a sequence is uniquely determined by n,e and a0, for most values such a sequence does not exist. For example, no (n,e)-MPS exists for n<6.\nDefine C(n) to be the number of (n,e)-MPS for some e, and D(N)=\u2211n=2NC(n).\nYou are given that D(10)=2, D(100)=21, D(1000)=69, D(106)=1303 and D(1012)=1014800.\nFind D(1018).", "solution": "1001133757", "difficulty": 40, "story": "Once upon a time, in the whimsical land of Numeria, there lived a young mathematician named Alex. From a tender age, Alex was fascinated by the mysterious world of numbers. Their hidden patterns and enchanting sequences had captivated the young mathematician's heart. Alex spent countless hours exploring the depths of numerical wonders, eagerly seeking answers to the unsolved riddles of Mathematics.\n\nMathematics was an innate part of Numeria. It governed even the smallest aspects of daily life, from measuring the ingredients for potions to calculating the distance between floating islands in the sky. The inhabitants of Numeria admired mathematicians for their unique ability to decipher these complex codes.\n\nOne sunny day, as Alex sat under the shade of an ancient oak tree, engrossed in pages filled with equations and theories, a sudden gust of wind swept through, flipping the pages of Alex's notebook. Startled, they reached out to catch the escaping sheets, but one eluded their grasp and flew high into the clouds.\n\n\"I must retrieve it!\" Alex exclaimed, determined not to leave a single piece of knowledge lost. With an adrenaline-fueled burst of energy, they gathered their belongings and began their journey to recover the missing page.\n\nThe trail of the flying page led Alex to the doorstep of the revered Mathemagician, an enigmatic figure renowned for their mastery over numbers. The Mathemagician resided in a grand tower, perched atop the highest mountain of Numeria, known as Summist Peak.\n\nHuffing and puffing, Alex climbed the endless stairs, finally reaching the summit to find the Mathemagician in deep contemplation, surrounded by countless scrolls and ancient texts.\n\n\"I seek your guidance, mighty Mathemagician,\" Alex pleaded. \"I have lost a page containing a fascinating mathematical problem. It has been my dream to solve it. Can you help me?\"\n\nThe Mathemagician peered at Alex with kind eyes and a knowing smile. \"Ah, young mathematician, you have come at an opportune moment. I have been pondering the same conundrum, but alas, its solution eludes me.\"\n\nPerplexed yet hopeful, Alex shared the mathematical problem that had vanished with the wind. The Mathemagician listened intently, nodding at each crucial detail.\n\n\"This (n,e)-MPS, as you call it, is a labyrinth of infinite possibilities,\" the Mathemagician mused. \"It holds the key to unraveling the secrets of numbers.\"\n\nUnable to contain their excitement, Alex asked, \"Is it really possible to find all the (n,e)-MPS? Can we crack the code?\"\n\nThe Mathemagician's eyes twinkled with mystery. \"For most values, no such sequence exists. However, for some miraculous combinations, truth is unveiled. We seek C(n), the number of (n,e)-MPS for some e, and the sum of C(n) for all values of N yields D(N).\"\n\nAs the Mathemagician explained, the significance of D(N) became evident to Alex. It was the pathway to enlightenment, the gateway to understanding the complexities lying in the depths of the (n,e)-MPS.\n\nInspired and determined, Alex thanked the Mathemagician and promised to decipher the secrets they had uncovered together. With newfound purpose, they left Summist Peak, eager to explore further and seek out the missing page.\n\nAs Alex embarked on their quest, traveling through distant lands, studying ancient manuscripts, and engaging in countless conversations with fellow scholars, they realized that this mathematical problem was no ordinary hurdle. It demanded unwavering perseverance, clever strategies, and an unquenchable thirst for knowledge.\n\nNow, dear reader, the time has come for you to enter Numeria's enchanting realm. Can you solve the riddle that has puzzled scholars and mathematicians alike? Can you uncover the missing piece of the puzzle for D(1018)? The journey awaits."}, {"id": 634, "euler_id": 634, "title": "Numbers of the form a2b3", "problem": "\nDefine F(n) to be the number of integers x\u2264n that can be written in the form x=a2b3, where a and b are integers not necessarily different and both greater than 1.\n\nFor example, 32=22\u00d723  and 72=32\u00d723 are the only two integers less than 100 that can be written in this form. Hence, F(100)=2.\n\n\nFurther you are given F(2\u00d7104)=130 and F(3\u00d7106)=2014.\n\n\nFind F(9\u00d71018).\n", "solution": "4019680944", "difficulty": 40, "story": "Once upon a time in the quaint town of Numeropolis, a young mathematician named Amelia resided. Amelia had always been fascinated by numbers ever since she was a little girl, spending countless hours solving complex mathematical problems. Her love for numbers was so great that she had turned her house into a personal library filled with books on various subjects of mathematics.\n\nOne particular day, Amelia received a mysterious letter that piqued her curiosity. It was an invitation to a gathering of the most brilliant mathematicians in the world, where they would engage in an intense mathematical competition. The invitation stated that the first round would involve a problem that had stumped even the most renowned mathematicians, and it was up to the participants to solve it.\n\nIntrigued, Amelia decided to attend the gathering. She packed her bags, bid farewell to Numeropolis, and embarked on a journey to the grand city that hosted the competition. As soon as she arrived, Amelia was greeted by a bustling atmosphere filled with excitement and anticipation. She could feel the intellectual energy in the air as she entered the massive hall where the competition would take place.\n\nAmelia took her seat among the other participants, eagerly waiting for the challenge to begin. A tall, bespectacled man named Professor Euler took the stage and introduced the problem for the first round.\n\nHe began, \"Ladies and gentlemen, the problem for today revolves around a function called F(n), where n is a positive integer. F(n) counts the number of integers x less than or equal to n that can be expressed in the form x = a^2 * b^3, where both a and b are integers greater than 1. For example, F(100) equals 2 because only two numbers, 32 and 72, satisfy the given condition.\"\n\nAmelia's eyes sparkled with excitement. This problem seemed like a perfect fit for her, given her passion for numbers. She knew that she had to solve this challenge and show the world her mathematical prowess.\n\nAs the days passed, Amelia delved into the problem, spending countless hours deciphering its intricacies. She immersed herself in the world of squares and cubes, lost in her thoughts, considering various possible values of a and b. She made rigorous notes, created graphs, and even tried to find patterns among the numbers.\n\nThe days turned into weeks, and yet Amelia was determined to unravel the mystery behind F(n). She found excitement in each small discovery, bringing her closer to the solution. Her dedication and perseverance caught the attention of her fellow competitors, who marveled at her relentless pursuit of the answer.\n\nFinally, the day of the final round arrived. Amelia, along with the other mathematicians, gathered on the stage to present their findings. Professor Euler called upon each participant to reveal their solution to the problem, one by one. Each mathematician shared their thoughts and approached the problem from different angles, presenting their findings with pride.\n\nWhen it was Amelia's turn, she confidently walked up to the stage, ready to present her solution. She shared her journey of exploring different values of a and b, the patterns she had discovered, and the deductions she had made. Her mathematical prowess shone through as she explained her ideas with precision and eloquence.\n\nThe crowd was captivated by Amelia's presentation, applauding her with admiration and respect. Professor Euler, impressed by her meticulous approach, congratulated her on her exceptional work before announcing the end of the competition.\n\nAs the participants dispersed and the excitement of the competition faded away, Amelia's mind was still engrossed in the problem. She realized that even though she had come so close to finding the solution, there was one remaining question that still eluded her: F(9 \u00d7 10^18).\n\nAmelia knew that she couldn't rest until she solved this final piece of the puzzle. With determination gleaming in her eyes, she returned to Numeropolis. Armed with newfound knowledge and a deeper understanding of the problem, she continued her pursuit of F(9 \u00d7 10^18), determined to unveil the answer to the enigma that had captivated her mind.\n\nAnd so, the question remains: What is F(9 \u00d7 10^18)? Can you help Amelia find the solution to this captivating mathematical problem?"}, {"id": 635, "euler_id": 635, "title": "Subset sums", "problem": "\nLet Aq(n) be the number of subsets, B, of the set {1,2,...,q\u22c5n} that satisfy two conditions:\n1) B has exactly n elements;\n2) the sum of the elements of B is divisible by n.\n\n\nE.g. A2(5)=52 and A3(5)=603.\n\nLet Sq(L) be \u2211Aq(p) where the sum is taken over all primes p\u2264L.\nE.g. S2(10)=554, S2(100) mod 1000000009=100433628 and S3(100) mod 1000000009=855618282.\n\n\nFind S2(108)+S3(108). Give your answer modulo 1000000009.\n", "solution": "689294705", "difficulty": 40, "story": "Once upon a time in the magical village of Numeria, lived a young wizard named Ethan. Ethan was known for his incredible ability to solve complex mathematical problems with ease. He had a deep passion for all things mathematical and spent most of his time discovering new theorems and solving challenging equations.\n\nOne sunny morning, Ethan received an invitation from the Grand Wizard to attend a prestigious magical conference in the neighboring Kingdom of Mathenia. The conference was a gathering of the greatest wizards and mathematicians in the land, and Ethan was beyond excited to be a part of it.\n\nAs Ethan journeyed to Mathenia, he couldn't help but wonder about the mysteries that awaited him at the conference. Little did he know that his mathematical skills were about to be put to the ultimate test.\n\nUpon arriving at the conference, Ethan was greeted by a tall, wise wizard named Professor Calculus. The professor had a reputation for posing the most intriguing mathematical puzzles and riddles. Ethan knew he had to stay focused and prove himself as a worthy mathematician.\n\nProfessor Calculus gathered all the attendees and addressed them with a challenging problem. He began by introducing a concept called \"Aq(n)\" - the number of subsets, B, of the set {1,2,...,q\u22c5n} that satisfy two conditions. Ethan listened attentively as Professor Calculus explained the problem, his mind racing with possibilities.\n\nThroughout the conference, Ethan immersed himself in the intricacies of the problem. He saw how the solution to Aq(n) required a deep understanding of divisors, prime numbers, and modular arithmetic. It intrigued him, and he couldn't help but wonder what the real-world implications of solving this problem could be.\n\nEthan met fellow mathematicians who were equally captivated by the problem. They spent hours discussing strategies, collaborating, and exchanging ideas. The problem became a central topic during the conference, influencing the conversations and inspiring new research directions.\n\nDays turned into weeks, and before he knew it, the conference was drawing to a close. Ethan realized that he had learned more than he ever imagined, not just about the mathematical problem at hand but about the power of collaboration and the impact of mathematical discoveries.\n\nAs the final day approached, Ethan couldn't help but reflect on his journey. He wondered about the true significance of S2(108) + S3(108). How could this knowledge change the world? How could it revolutionize the fields of cryptography, data encryption, or even scientific research?\n\nWith a renewed sense of purpose, Ethan stood before the conference attendees as the closing ceremony began. The Grand Wizard himself took the stage and addressed the crowd. \"My fellow mathematicians, wizards, and scholars,\" he began. \"The pursuit of knowledge is a never-ending journey. Today, we have explored the wonders of Aq(n) and Sq(L). But what lies beyond this? What other mathematical mysteries await our discovery?\"\n\nEthan felt a surge of exhilaration as the Grand Wizard concluded his speech. The question kept resonating in his mind. What lies beyond? What other mathematical wonders awaited him and his fellow mathematicians?\n\nAnd so, dear reader, I pose the same question to you now - What is the value of S2(108) + S3(108)? Can you unravel the secrets of the mathematical problem that enchanted Ethan and the wizards of Numeria and Mathenia alike? The answer awaits, and it is up to you to embark on your own mathematical journey and uncover the truth. Will you accept the challenge?"}, {"id": 638, "euler_id": 638, "title": "Weighted lattice paths", "problem": "Let Pa,b denote a path in a a\u00d7b lattice grid with following properties:\nThe path begins at (0,0) and ends at (a,b).\nThe path consists only of unit moves upwards or to the right; that is the coordinates are increasing with every move.\n\n\nDenote A(Pa,b) to be the area under the path. For the example of a P4,3 path given below, the area equals 6.\n\n\n\n\nDefine G(Pa,b,k)=kA(Pa,b). Let C(a,b,k) equal the sum of G(Pa,b,k) over all valid paths in a a\u00d7b lattice grid. \n\n\nYou are given that\n\nC(2,2,1)=6\nC(2,2,2)=35\nC(10,10,1)=184756\nC(15,10,3)\u2261880419838mod1000000007\nC(10000,10000,4)\u2261395913804mod1000000007\n\n\nCalculate \u2211k=17C(10k+k,10k+k,k) . Give your answer modulo 1000000007", "solution": "18423394", "difficulty": 40, "story": "Once upon a time in a small town called Mathtopia, there lived a curious young boy named Oliver. Oliver had always been fascinated by numbers and patterns, spending countless hours exploring mathematical problems and solving equations. His love for mathematics was so great that he even dreamt of becoming a renowned mathematician one day.\n\nOne sunny morning, Oliver stumbled upon an ancient scroll hidden beneath the dusty shelves of the town's forgotten library. As he unrolled the fragile parchment, he discovered a peculiar problem scrawled in elegant calligraphy. The problem described a path in a lattice grid and the calculation of various sums.\n\nCuriosity piqued, Oliver immersed himself in studying the problem. He meticulously analyzed the equations, determined to unveil their hidden secrets. The more he pondered over the intricacies of the problem, the more fascinated he became.\n\nDays turned into weeks, and weeks turned into months as Oliver tirelessly worked on cracking the mathematical mystery. He deciphered the patterns within paths and deduced the formulas for the different sums involved. The knowledge that he was gradually unraveling an enigma gave him an insurmountable thrill.\n\nAs word of Oliver's exceptional talent spread throughout Mathtopia, the town's inhabitants marveled at his brilliance. They sought his guidance with their own mathematical conundrums, approaching him with equations and riddles that left their minds perplexed. Oliver felt a surge of joy each time he helped someone understand a concept or untangle a puzzling problem.\n\nBut amidst all the adulation, Oliver's mind was constantly consumed by the original mathematical problem engraved on the ancient scroll. He couldn't shake off the feeling that there was something more significant hidden beneath its surface, something that held the power to unlock a treasure trove of knowledge.\n\nOne fateful day, while Oliver was busy scribbling formulas on a chalkboard in his room, an elderly man named Mr. Winston knocked on his door. Mr. Winston was the wise elder of Mathtopia, known for his profound wisdom and mysterious ways.\n\n\"I've heard of your remarkable mathematical abilities, young Oliver,\" Mr. Winston said, his voice trembling with anticipation. \"I come bearing a riddle that has plagued our town for ages, and I believe you may hold the key to its solution.\"\n\nIntrigued, Oliver listened intently as Mr. Winston described the mathematical problem that had confounded Mathtopia's brightest minds for generations. His eyes widened, for the problem seemed eerily similar to the one he had been working on for months.\n\nOliver's heart raced as he realized that the ancient scroll and Mr. Winston's riddle were intertwined. It was as if the universe had conspired to guide him towards a profound revelation. Determined to solve the puzzle that had eluded his predecessors, Oliver embarked on a remarkable quest for knowledge and understanding.\n\nAs he delved deeper into the intricate world of mathematics, Oliver discovered connections and correlations he had never imagined. The patterns he observed in paths through the lattice grid began to align with the theories he had studied.\n\nThe days turned into nights, and nights turned into restless slumbers as Oliver's mind raced with numbers and formulas. The people of Mathtopia whispered in anticipation, sensing that their town's fate was entwined with the young mathematician's quest.\n\nFinally, after months of tireless exploration, Oliver arrived at a breakthrough. The solution to the mathematical problem lay before him, tantalizingly close yet ever so elusive. He grasped the essence of the problem, unraveled its intricate web of patterns, and calculated the sums that had so confounded his ancestors.\n\nHowever, a lingering question remained in Oliver's mind. A question that could only be answered with the collective intelligence of Mathtopia. With a newfound sense of purpose, he gathered the people of his town, sharing his calculations and presenting them with his final question.\n\n\"\u2211k=17C(10k+k,10k+k,k) modulo 1000000007, can you solve it?\" Oliver asked, his voice filled with anticipation.\n\nAs the townsfolk contemplated the question, their minds filled with the wonders of mathematics, a newfound unity enveloped Mathtopia. From that day forward, the town became a haven for mathematicians and enthusiasts alike, where the pursuit of knowledge and the thrill of solving mathematical enigmas united its people.\n\nAnd so, the story of Mathtopia and Oliver's quest for understanding continues. Can you solve the mathematical problem that has captured the town's imagination? The answer lies within the depths of your own mathematical prowess."}, {"id": 646, "euler_id": 646, "title": "Bounded Divisors", "problem": "\nLet n be a natural number and  p1\u03b11\u22c5p2\u03b12...pk\u03b1k its prime factorisation.\nDefine the Liouville function \u03bb(n) as \u03bb(n)=(\u22121)\u2211i=1k\u03b1i.\n(i.e. \u22121 if the sum of the exponents \u03b1i is odd and 1 if the sum of the exponents is even. )\nLet S(n,L,H)  be the sum \u03bb(d)\u22c5d over all divisors d of n for which L\u2264d\u2264H.\n\n\nYou are given:\n\u2219S(10!,100,1000)=1457\n\u2219S(15!,103,105)=\u2212107974\n\u2219S(30!,108,1012)=9766732243224.\n\nFind S(70!,1020,1060) and give your answer modulo 1000000007.\n", "solution": "845218467", "difficulty": 40, "story": "Once upon a time, in the small town of Mathville, there lived a young girl named Lily. Lily was unlike any other child in her town. While the other kids were playing outside or engaging in regular activities, Lily found solace and excitement in solving mathematical puzzles. Her love for numbers and problem-solving had earned her the nickname \"The Math Whiz.\"\n\nOne sunny afternoon, as Lily was flipping through the pages of her favorite math book, she stumbled upon a peculiar problem. It was no ordinary math puzzle; it involved the Liouville function and the sum of divisors. Fascinated, Lily delved deeper into the problem.\n\nIn her quest to understand the mathematical enigma, Lily discovered that the Liouville function, denoted as \u03bb(n), was a function that determined the sign of a divisor sum based on the exponents of its prime factorization. If the sum of the exponents was odd, the sign was -1, and if the sum of the exponents was even, the sign was 1.\n\nAs Lily continued her research, she found some intriguing examples. The book mentioned that S(10!, 100, 1000) equaled 1457, while S(15!, 103, 105) was equal to -107974, and S(30!, 108, 1012) amounted to 9766732243224.\n\nThese calculations fascinated Lily. She marveled at how numbers and formulas could unlock hidden patterns and secrets. The numbers whispered to her, telling tales of their own. But it was a question presented in the problem that piqued Lily's curiosity the most.\n\nThe question asked: What was S(70!, 1020, 1060), and what would the answer be when reduced modulo 1000000007?\n\nLily's mind whirled with excitement. Her fingers danced over the pages of her math book, sketching equations and scribbling down formulas. She knew that to solve this puzzle, she needed to discover the fundamental properties of the Liouville function and its relationship with the sum of divisors.\n\nDays turned into weeks as Lily toiled over the problem. She sought advice from her math teachers, who were equally perplexed by the complexity of the question. Moments of frustration tempted her to quit, but she knew she had come too far to give up now.\n\nThe townspeople of Mathville began to notice Lily's absence from everyday activities. Worried for her, they flocked to her doorstep, hoping to provide guidance and support. But Lily's determination to solve the problem was unwavering.\n\nFinally, after weeks of relentless calculations, Lily made a breakthrough. She discovered a pattern in the problem, an intricate dance between prime numbers and their exponents. The Liouville function was the key that unlocked the hidden treasure within the sum of divisors.\n\nWith new hope surging through her veins, Lily spent endless nights poring over numbers and equations. She scribbled furiously in her notebook, carefully tracking each step of her solution. And then, as the sun rose on a bright morning, a smile bloomed on Lily's face.\n\nWith a sense of satisfaction and accomplishment, Lily knew she had found the solution to the problem she had spent weeks unraveling. But before she could celebrate, she realized the quest was not yet complete. She had to ensure the final answer reduced modulo 1000000007.\n\nAs evening descended upon Mathville, Lily leaned back in her chair and looked out at the twinkling stars. She held the answer in the palm of her hands, but she wondered if others would find it as captivating as she did. She pondered the magical beauty of mathematics and its ability to unlock the mysteries of the universe.\n\nAnd as she gazed at the night sky, a question formed in her mind: Can you solve the enigma of S(70!, 1020, 1060) modulo 1000000007?\n\nWith that question lingering in the air, Lily closed her math book and rested her weary head. The solution was hers to keep, waiting patiently for someone else to uncover its secrets."}, {"id": 660, "euler_id": 660, "title": "Pandigital Triangles", "problem": "We call an integer sided triangle n-pandigital if it contains one angle of 120 degrees and, when the sides of the triangle are written in base n, together they use all n digits of that base exactly once.\n\nFor example, the triangle (217, 248, 403) is 9-pandigital because it contains one angle of 120 degrees and the sides written in base 9 are 2619,3059,4879 using each of the 9 digits of that base once.\nFind the sum of the largest sides of all n-pandigital triangles with 9\u2264n\u226418.", "solution": "474766783", "difficulty": 40, "story": "Once upon a time in the small village of Numeria, lived a young and curious girl named Ava. Ava had always been fascinated by numbers and patterns. Her day-to-day routine mainly revolved around solving complex math problems and exploring the wonders of arithmetic.\n\nOne sunny afternoon, as Ava was attending her math class at the village school, Mr. Mathews, the enthusiastic math teacher, presented the class with a peculiar mathematical problem. He began, \"Class, today we have an intriguing puzzle that will test your logical skills and problem-solving abilities.\"\n\nWith anticipation in her eyes, Ava leaned forward, eager to hear the problem that lay ahead.\n\nMr. Mathews continued, \"We call an integer-sided triangle n-pandigital if it contains one angle of 120 degrees and, when the sides of the triangle are written in base n, together they use all n digits of that base exactly once.\"\n\nPerplexed, the students pondered over the question while trying to comprehend its complexity. However, Ava felt her mathematical instincts tingling, and her curiosity bubbled within her.\n\nShe couldn't resist the allure of this enigma, so she decided to embark on a mathematical adventure to unravel the mystery of the n-pandigital triangles. Day and night, Ava immersed herself in books, challenging her intellect to grasp this peculiar phenomenon.\n\nAs weeks turned into months, Ava's dedication bore fruit. She discovered a plethora of marvelous examples showcasing the n-pandigital triangles. From remarkable triangles like the (264, 951, 783) in base 9 to incredible ones like the (1170, 235, 882) in base 12.\n\nThe more Ava explored, the more patterns she discovered. The beauty of numbers danced before her very eyes, as the triangles formed intricate shapes and sizes, all united by the underlying properties of mathematics.\n\nAva's excitement was contagious, and she shared her findings with Mr. Mathews, who marveled at her enthusiasm and dedication. Soon, the entire village of Numeria began to take an interest in the concept of n-pandigital triangles.\n\nAs the village buzzed with mathematical excitement, there was a shift in the air. A sense of anticipation filled Ava's heart as she wondered if there was more to these triangles than just their properties. Could these n-pandigital triangles hold a secret message or a hidden treasure?\n\nAva pondered over this thought day and night, imagining limitless possibilities. She began scrutinizing every detail of the triangles, searching for clues that might lead her on a thrilling adventure.\n\nAnd so, dear reader, I leave you with a question that has puzzled both Ava and the village of Numeria: What if these n-pandigital triangles are not just fascinating mathematical constructs, but keys to unlocking an incredible world of treasure and adventure?\n\nCan you solve the mathematical problem posed by Mr. Mathews and unravel the mystery behind these magical triangles? The future of Numeria's hidden treasures lies in your hands."}, {"id": 670, "euler_id": 670, "title": "Colouring a Strip", "problem": "A certain type of tile comes in three different sizes - 1\u00d71, 1\u00d72, and 1\u00d73 - and in four different colours: blue, green, red and yellow. There is an unlimited number of tiles available in each combination of size and colour.\nThese are used to tile a 2\u00d7n rectangle, where n is a positive integer, subject to the following conditions:\nThe rectangle must be fully covered by non-overlapping tiles.\nIt is not permitted for four tiles to have their corners meeting at a single point.\nAdjacent tiles must be of different colours.\nFor example, the following is an acceptable tiling of a 2\u00d712 rectangle:\n\n\nbut the following is not an acceptable tiling, because it violates the \"no four corners meeting at a point\" rule:\n\n\nLet F(n) be the number of ways the 2\u00d7n rectangle can be tiled subject to these rules. Where reflecting horizontally or vertically would give a different tiling, these tilings are to be counted separately.\nFor example, F(2)=120, F(5)=45876, and F(100)\u226153275818(mod1000004321).\nFind F(1016)mod1000004321.", "solution": "551055065", "difficulty": 40, "story": "Once upon a time in the colorful village of Numeralia, there was a talented young artist named Lily. With her vivid imagination and skilled hands, Lily had transformed her town into a breathtaking mosaic of colors and patterns. But there was one place she longed to explore her creativity even further - the abandoned mansion at the edge of the village.\n\nLegend had it that the mansion was filled with magical secrets, and no one had dared to venture inside for years. Lily's heart raced with excitement as she stood before the rusty gates that guarded the mansion. She took a deep breath and pushed them open, stepping into a world frozen in time.\n\nInside, she discovered a dusty workshop, filled with tools and paints. As she explored further, she stumbled upon an ancient book, its pages filled with mysterious symbols and diagrams.\n\nIntrigued, Lily began to decipher the pages, and that's when she came across the mathematical problem that could unlock the mansion's secrets. The problem described a unique tiling technique for a 2\u00d7n rectangle, using tiles of different sizes and colors, with specific rules to follow.\n\nThe young artist's eyes sparkled with wonder as she imagined the possibilities. The abandoned mansion would be a blank canvas awaiting her artistic touch. Excitement coursed through her veins as she devised a plan to execute the tiling masterpiece.\n\nLily spent days meticulously tiling the walls and floors of the mansion, following the rules set forth in the mathematical problem. She carefully selected tiles of various colors and sizes, creating mesmerizing patterns that brought life back to the vacant rooms.\n\nThe mansion soon became a spectacle of color and artistry, drawing people from far and wide to witness Lily's creation. The villagers marveled at the intricate patterns and unique combinations of tiles, unaware of the unsolved mathematical problem underlying the masterpiece.\n\nLily's fame grew with each passing day, and she reveled in her newfound success. But amidst the applause and admiration, a question nagged at the back of her mind - the question that had brought her to the mansion in the first place.\n\nAs the villagers gathered for the grand unveiling of the mansion's renovations, Lily stood atop a grand staircase, gazing at the crowd below. She took a deep breath and posed a question that had eluded her all along.\n\n\"Tell me, my friends,\" she began, her voice filled with anticipation, \"how many ways can this 2\u00d7n rectangle be tiled, following the rules laid out in this mathematical problem? Can you solve this puzzle that has fueled my creative journey?\"\n\nThe crowd fell silent, captivated by the challenge Lily had presented. Whispers filled the air as people contemplated the puzzle, their minds racing with possibilities.\n\nAnd so, as Lily looked out at her expectant audience, she waited for the answer that would not only complete her artistic journey but also unlock the deepest secrets of the abandoned mansion."}, {"id": 683, "euler_id": 683, "title": "The Chase II", "problem": "Consider the following variant of \"The Chase\" game. This game is played between n players sitting around a circular table using two dice. It consists of n\u22121 rounds, and at the end of each round one player is eliminated and has to pay a certain amount of money into a pot. The last player remaining is the winner and receives the entire contents of the pot.\nAt the beginning of a round, each die is given to a randomly selected player. A round then consists of a number of turns.\nDuring each turn, each of the two players with a die rolls it. If a player rolls a 1 or a 2, the die is passed to the neighbour on the left; if the player rolls a 5 or a 6, the die is passed to the neighbour on the right; otherwise, the player keeps the die for the next turn.\nThe round ends when one player has both dice at the beginning of a turn. At which point that player is immediately eliminated and has to pay s2 where s is the number of completed turns in this round. Note that if both dice happen to be handed to the same player at the beginning of a round, then no turns are completed, so the player is eliminated without having to pay any money into the pot.\nLet G(n) be the expected amount that the winner will receive. For example G(5) is approximately 96.544, and G(50) is 2.82491788e6 in scientific notation rounded to 9 significant digits.\nFind G(500), giving your answer in scientific notation rounded to 9 significant digits.", "solution": "2.38955315e11", "difficulty": 40, "story": "Once upon a time, in the bustling town of Numeria, there lived a group of five friends named Alice, Bob, Charlie, David, and Eve. These five mathematical enthusiasts were known for their love of puzzles and games, always seeking new challenges to test their reasoning and logic.\n\nOne fine day, as they gathered around their usual circular table, Alice shared an unusual game she had discovered called \"The Chase.\" The friends were immediately intrigued, their curiosity piqued by the mathematical aspects of the game.\n\nThe game consisted of n\u22121 rounds, with each round eliminating one player until only the winner remained. At the beginning of each round, two dice were handed out randomly. The players took turns rolling the dice. If a player rolled a 1 or 2, they passed the die to the left, and if they rolled a 5 or 6, they passed it to the right. Otherwise, they kept the die for the next turn.\n\nAs Alice explained the rules, the others exchanged puzzled glances. The game seemed complex yet captivating, blending probability, reasoning, and strategy. They decided to play the game themselves and immerse themselves in its challenges.\n\nRound after round, the friends experienced the exhilaration of rolling dice and passing them around the table, eagerly calculating the probabilities and strategizing their moves. Every turn brought a wave of anticipation and excitement.\n\nAs the rounds progressed, each player had their fair share of eliminations, causing a sigh of disappointment mixed with laughter. Coins clinked into the growing pot at the center of the table, and dreams of winning the substantial prize tantalized their minds.\n\nTheir passion for the game deepened as they reinvented strategies and analyzed the impact of each roll. Mathematical equations danced in their heads, melding seamlessly with their unwavering determination to emerge victorious.\n\nDays turned into weeks, and their arithmetic prowess flourished. They became masters in Probability's Palace, unlocking its secrets with each roll of the dice. The pot grew larger, mirroring their growing excitement.\n\nFinally, after numerous intense rounds, only two players\u2014Charlie and Eve\u2014were left. The final round would determine the ultimate champion and the recipient of the substantial pot.\n\nWith bated breath, the friends watched as Charlie and Eve began the final round, two dice placed in their hands. They calculated the odds, analyzing each roll's potential impact on their progress. The excitement was palpable, the tension filling the room.\n\nAs the dice were thrown, the room held its collective breath. The clatter of the dice echoed, as if marking the culmination of weeks of anticipation and challenges. Alice, Bob, and David watched intently, the outcome beyond their control now.\n\nAnd just as the suspense reached its zenith, the story came to an end, leaving the friends and readers alike pondering the very same question that had captivated their imagination from the beginning:\n\nWhat is the expected amount that the winner, whether it be Charlie or Eve, will receive in this intense game of \"The Chase\" with 500 players?\n\nAs the story concludes, the readers are left with this mathematical enigma, urging them to find the elusive answer and embark on their own thrilling journey through the realms of Probability and Chance."}, {"id": 691, "euler_id": 691, "title": "Long substring with many repetitions", "problem": "Given a character string s, we define L(k,s) to be the length of the longest substring of s which appears at least k times in s, or 0 if such a substring does not exist. For example, L(3,\u201cbbabcabcabcacba\u201d)=4 because of the three occurrences of the substring \u201cabca\u201d, and L(2,\u201cbbabcabcabcacba\u201d)=7 because of the repeated substring \u201cabcabca\u201d. Note that the occurrences can overlap.\nLet an, bn and cn be the 0/1 sequences defined by:\na0=0\na2n=an\na2n+1=1\u2212an\nbn=\u230an+1\u03c6\u230b\u2212\u230an\u03c6\u230b (where \u03c6 is the golden ratio)\ncn=an+bn\u22122anbn\nand Sn the character string c0\u2026cn\u22121. You are given that L(2,S10)=5, L(3,S10)=2, L(2,S100)=14, L(4,S100)=6, L(2,S1000)=86, L(3,S1000)=45, L(5,S1000)=31, and that the sum of non-zero L(k,S1000) for k\u22651 is 2460.\nFind the sum of non-zero L(k,S5000000) for k\u22651.", "solution": "11570761", "difficulty": 40, "story": "The Enigma of the Sunflower Fields\n\nOnce upon a time, in a quaint little town nestled between rolling hills and sunflower fields, there lived a young girl named Emma. She was known for her curiosity and penchant for solving puzzles, often spending her free time unraveling riddles and mysteries. One sunny afternoon, as Emma walked through the picturesque sunflower fields, she stumbled upon a hidden treasure\u2014a weathered and tattered journal lying amidst the golden petals.\n\nIntrigued, Emma opened the journal and discovered delicate, handwritten pages full of complex equations and peculiar sequences. One particular mathematical problem caught her eye\u2014a puzzle that seemed to be the key to understanding the journal's secrets. It read:\n\n\"Given a character string s, we define L(k,s) to be the length of the longest substring of s which appears at least k times in s, or 0 if such a substring does not exist...\"\n\nEmma's eyes were fixated on the problem, her mind racing, trying to comprehend its significance. It seemed as though the journal held a mathematical enigma, waiting to be unraveled. \n\nDetermined to solve the puzzle, Emma studied the equations in the journal, slowly piecing together their meaning. She discovered the sequences an, bn, and cn\u2014a complex network of zeroes and ones that seemed to hold a deeper secret. Guided by her intuition, Emma realized that every term of the sequence Sn was constructed by combining and manipulating the previous terms, based on the equations' rules.\n\nAs Emma delved deeper into the journal's pages, she noticed a pattern emerging. Hidden within the cryptic sequences were clues\u2014hints leading her to the solution. She had to find the sum of non-zero L(k,S5000000) for k\u22651. It was a daunting challenge, but Emma couldn't resist the allure.\n\nDays turned into weeks, and weeks into months, as Emma tirelessly worked to decipher the journal's intricate puzzle. She explored every possible avenue, manipulating the equations, and analyzing the sequences. The sunflower fields became her refuge, a canvas where she envisioned solutions blooming among the vibrant blooms.\n\nFinally, on a cool autumn afternoon, as the sun gently cast its orange hues upon the endless fields, Emma had an epiphany. The solution to the puzzle began to unravel before her eyes, like petals delicately opening to greet the morning sun. The answer was within reach, but she hadn't yet reached it.\n\nHer heart pounding with excitement and anticipation, Emma knew she was on the verge of solving the enigma. But it was not for her to finish the journey. Just as she was about to grasp the answer, the wind whispered a question in her ear\u2014a question that echoed across the sunflower fields, demanding an answer.\n\nEmma's eyes sparkled with newfound determination as she realized the immensity of the challenge before her. She turned to the reader, her voice tinged with curiosity and excitement.\n\n\"Can you find the sum of non-zero L(k,S5000000) for k\u22651?\""}, {"id": 693, "euler_id": 693, "title": "Finite Sequence Generator", "problem": "Two positive integers x and y (x>y) can generate a sequence in the following manner:\nax=y is the first term,\naz+1=az2modz for z=x,x+1,x+2,\u2026 and\nthe generation stops when a term becomes 0 or 1.\nThe number of terms in this sequence is denoted l(x,y).\nFor example, with x=5 and y=3, we get a5=3, a6=32mod5=4, a7=42mod6=4, etc. Giving the sequence of 29 terms:\n3,4,4,2,4,7,9,4,4,3,9,6,4,16,4,16,16,4,16,3,9,6,10,19,25,16,16,8,0\nHence l(5,3)=29.\ng(x) is defined  to be the maximum value of l(x,y) for y<x. For example, g(5)=29.\nFurther, define f(n) to be the maximum value of g(x) for x\u2264n. For example, f(100)=145 and f(10000)=8824.\nFind f(3000000).", "solution": "699161", "difficulty": 40, "story": "Once upon a time, in a small village nestled amongst rolling green hills, there lived a young shepherd named Ethan. He was known for his kind heart and love for his flock, but deep down, he yearned for a greater purpose. As he watched over his sheep, he often pondered the mysteries of numbers and patterns. Little did he know that his mathematical pursuits would soon lead him on an incredible adventure.\n\nOne sunny day, as Ethan was guiding his sheep through the meadows, a peculiar old man appeared before him. The man had a long white beard that flowed down to his knees, and his eyes twinkled with wisdom.\n\n\"Greetings, young shepherd,\" the old man said, his voice echoing with a hint of mystery. \"I hear you possess a keen mind and a fascination for numbers. I have a mathematical puzzle for you, one that may unravel the secrets of the universe.\"\n\nEthan's eyes lit up with excitement. He had always loved solving puzzles and riddles, and this seemed like just the kind of challenge he had been waiting for. He eagerly accepted the old man's proposition.\n\nThe old man handed Ethan a worn parchment, its edges yellowed with age. On it was inscribed the mathematical problem that had confounded scholars for generations. Ethan read the problem aloud and marveled at its complexity.\n\nAs the young shepherd delved into the intricacies of the mathematical conundrum, he realized that it held the key to unlocking an ancient power. Deep within the problem lay a hidden formula that could reshape the world as they knew it. Eager to uncover its mysteries, Ethan set off on a quest to gather the unique ingredients needed to solve the problem.\n\nHis journey took him to far-off lands, where he encountered wise sages and enigmatic scholars. Each one possessed a fragment of the solution, hidden within puzzles and riddles of their own. With each successful answer, Ethan inched closer to unraveling the secret.\n\nOne misty morning, after months of tireless pursuit, Ethan arrived at the Temple of Numbers. The ancient walls hummed with an energy that drew him in. Inside, he found a weary mathematician, burdened by the weight of the world's timeless enigmas.\n\n\"Ethan,\" the mathematician whispered, his voice filled with a mix of desperation and hope, \"you hold the fate of our world within your grasp. You alone can solve the magnificent puzzle and unleash the power it holds.\"\n\nEthan peered at the mathematician, a mixture of determination and trepidation swirling within him. He knew that solving the mathematical problem would bring about great change, but he also understood the responsibility it entailed.\n\nAs he sat in the hallowed chamber, surrounded by ancient scrolls and dusty tomes, Ethan mulled over the problem. Every piece fell into place, numbers danced before his eyes, and the formula came alive in his mind. He had found the key to unlock this ancient power.\n\nYet, as he reached his hand out to fulfill destiny's call, a doubt clouded Ethan's mind. What would the consequences be? How would this newfound power shape the world he loved? Was it his place to wield such influence?\n\nIn that moment, Ethan made a choice - a choice to protect the sanctity of the world and the beauty of its natural order. He decided to keep the solution hidden, locked away in the depths of his mind, never to be used.\n\nReturning to his village, Ethan resumed his life as a shepherd, tending to his sheep and finding solace in the simplicity of their existence. But the burning question that had led him on this extraordinary journey still lingered in his heart.\n\nAs the years passed, Ethan grew old, yet his passion for numbers never waned. On his deathbed, surrounded by loved ones, he shared the story of his quest and the mathematical problem that had captivated him. His final words were a plea, spoken in a hushed and fragile voice.\n\n\"My dear friends,\" Ethan implored, his eyes filled with both a sense of wonder and resignation, \"can any of you solve the riddle that has perplexed me all these years? Can any of you find f(3000000), the maximum value of g(x) for x less than or equal to three million?\"\n\nHis loved ones, overcome with grief and awe, were left to ponder his question. And so, the mathematical problem passed from one generation to the next, carrying with it the timeless tale of a shepherd's journey and his decision to safeguard the mysteries of the universe.\n\nAs you read this tale, dear reader, I leave you with the same question that haunted Ethan until his final breath. Can you solve the riddle that once consumed a shepherd's soul? Can you find f(3000000) and uncover the secrets that lie within?"}, {"id": 701, "euler_id": 701, "title": "Random connected area", "problem": "\nConsider a rectangle made up of W\u00d7H square cells each with area 1. Each cell is independently coloured black with probability 0.5 otherwise white. Black cells sharing an edge are assumed to be connected.Consider the maximum area of connected cells.\n\nDefine E(W,H) to be the expected value of this maximum area.\nFor example, E(2,2)=1.875, as illustrated below.\n\n\n\n\nYou are also given E(4,4)=5.76487732, rounded to 8 decimal places.\n\n\nFind E(7,7), rounded to 8 decimal places.\n", "solution": "13.51099836", "difficulty": 40, "story": "Once upon a time in the peaceful town of Numeria, there lived a young girl named Lily. Lily was bright and curious, always seeking knowledge and practicing her mathematical skills. She would often spend her free time exploring the local library, searching for new puzzles and problems to solve.\n\nOne sunny afternoon, as Lily sat among towers of books, she stumbled upon an ancient tome filled with intriguing riddles. Among them was a problem that immediately piqued her interest. The problem involved a rectangle made up of square cells, with each cell either colored black or white. The objective was to find the maximum area of connected black cells and calculate its expected value.\n\nIntrigued by the challenge, Lily began working furiously on the problem. She drew countless diagrams, developing theories and testing different possibilities. Days turned into weeks, and still, she couldn't crack the enigma. Though initially frustrated, Lily's determination only grew stronger.\n\nAs she stared at the blank pages of her notebook one evening, she had an idea. What if she could visualize the problem differently? What if it was not just about numbers and probabilities, but about something deeper?\n\nWith renewed hope, Lily closed her books and embarked on a journey through the forest surrounding Numeria. She wandered aimlessly, guided only by her intuition. Eventually, she stumbled upon an abandoned cottage, its timeworn walls covered in moss. Curiosity drove her to venture inside.\n\nOnce inside, Lily discovered a hidden room with a large, ornate mirror standing in the center. She stared at her reflection, feeling a strange connection, as if the mirror held answers to her mathematical problem. As she reached out to touch the glass, something incredible happened.\n\nLily found herself transported into a world unlike any she had ever seen. It was a place where numbers lived and danced, each one telling a story through their unique shapes and colors. The rectangle from her problem came to life, with each cell forming a vibrant square, pulsating with energy.\n\nAs she observed the living rectangle, Lily noticed that the black cells were interconnected, forming intricate patterns that seemed to flow like rivers. The larger clusters of black cells stood out, seemingly more significant than the others. She marveled at the sight, realizing that the maximum area of connected black cells was not simply a mathematical concept but a representation of unity and strength.\n\nWith newfound clarity, Lily returned to her world, determined to solve the problem. Armed with both her analytical mind and a deeper understanding, she worked tirelessly, coming up with innovative strategies and calculations.\n\nWeeks turned into months, and finally, the day arrived when Lily cracked the code. She eagerly recorded her findings and calculated the expected value of the maximum area of connected cells for the given dimensions. She could almost hear the cheers of the numbers and see the joyous dance of the colored squares.\n\nFilled with satisfaction, Lily leaned back in her chair, knowing that she had accomplished something remarkable. But she couldn't help wonder: if the maximum area of connected cells in a 4x4 rectangle was 5.76487732, what would it be for a 7x7 rectangle? What secrets did this new dimension hold?\n\nAnd so, dear reader, the question remains in your hands. Can you find E(7,7), rounded to 8 decimal places? Dive into the mathematical realm, let your imagination guide you, and uncover the truth behind the beautiful connections of the colored squares. The challenge awaits you."}, {"id": 728, "euler_id": 728, "title": "Circle of Coins", "problem": "Consider n coins arranged in a circle where each coin shows heads or tails. A move consists of turning over k consecutive coins: tail-head or head-tail. Using a sequence of these moves the objective is to get all the coins showing heads.\nConsider the example, shown below, where n=8 and k=3 and the initial state is one coin showing tails (black). The example shows a solution for this state.\n\n\nFor given values of n and k not all states are solvable.  Let F(n,k) be the number of states that are solvable. You are given that F(3,2)=4, F(8,3)=256 and F(9,3)=128.\nFurther define:\n\nS(N)=\u2211n=1N\u2211k=1nF(n,k)\nYou are also given that S(3)=22, S(10)=10444 and S(103)\u2261853837042(mod1000000007)\nFind S(107). Give your answer modulo 1000000007", "solution": "709874991", "difficulty": 40, "story": "Once upon a time, in the small town of Mathland, there was a young boy named Oliver who had a unique talent for numbers. Oliver loved everything about mathematics and spent most of his time exploring the mysteries of this captivating subject.\n\nOne sunny day, as Oliver was walking in the park, he noticed an old man sitting on a bench. The man had a stack of coins in his hands, flipping them back and forth as if deep in thought. Curiosity sparked within Oliver, who couldn't resist approaching the man to satisfy his insatiable hunger for knowledge.\n\n\"Excuse me, sir,\" Oliver said politely, \"I couldn't help but notice you flipping those coins. Is there a specific reason or problem you are trying to solve?\"\n\nThe old man smiled and beckoned Oliver to sit beside him. \"Ah, young lad, you have a keen eye indeed. I am pondering a mathematical problem that has puzzled many great minds throughout history.\"\n\nIntrigued, Oliver's eyes widened with excitement. \"Please, tell me more! I am eager to learn.\"\n\nThe old man explained how he had n coins arranged in a circle, with each coin showing either heads or tails. He further explained that a move could consist of turning over k consecutive coins, either from tails to heads or from heads to tails. The objective was to get all the coins showing heads.\n\nOliver's brain whirred with possibilities as he visualized the problem in his mind. He imagined the coins in different configurations, considering different values of n and k. He realized that not all states were solvable, and the number of solvable states intrigued him.\n\nAs the sun dipped below the horizon, Oliver's mind was consumed with the challenge presented by the old man. He knew he had to solve it, not only for the joy of discovery but also to help the old man, who seemed burdened by this unsolved puzzle.\n\nDays turned into weeks, and weeks into months, but Oliver remained undeterred. He poured over countless mathematical proofs, exploring the intricacies of n and k. Slowly but surely, he began to uncover patterns and formulas that allowed him to calculate the number of solvable states for various values of n and k.\n\nFinally, the day came when Oliver felt confident enough to seek out the old man once again. With a heart filled with excitement, he approached the bench in the park. The old man looked up and smiled at him, knowing that Oliver had cracked the code.\n\n\"I have found it, sir,\" Oliver exclaimed, hardly able to contain his enthusiasm. \"I have discovered the number of solvable states for different configurations of the coins. It is a fascinating mathematical journey indeed.\"\n\nThe old man's eyes sparkled, and he nodded approvingly. \"Oh, young prodigy, the world needs minds like yours. Your persistence and dedication have led you to a profound understanding of a mathematical problem that has defied many. But tell me, what is the sum of all these solvable states?\"\n\nOliver's mind whirred with the calculations he had made. He knew that the sum of all the solvable states, denoted as S(N), was defined as the summation of F(n,k) for all n and k up to N.\n\nClosing his eyes, Oliver recited the values he had derived over the course of his arduous exploration. \"S(3) is 22, S(10) is 10,444, and S(103) is congruent to 853,837,042 modulo 1000000007.\"\n\nThe old man nodded, appearing pleased. \"Well done, young Oliver. You have proven yourself to be a true mathematician. Now, I challenge you with one final question. What is S(107) modulo 1000000007?\"\n\nOliver stared at the old man, his mind racing with calculations. He knew that he had come so far, and it was up to him to unlock this final mystery. The fate of all the solvable states rested on his ability to find the answer.\n\nAnd so, dear reader, I invite you to join Oliver in his quest to find the value of S(107) modulo 1000000007. Can you solve the final puzzle that has stumped even the brightest minds? The fate of Mathland's solvable states lies in your hands."}, {"id": 732, "euler_id": 732, "title": "Standing on the shoulders of trolls", "problem": "\nN trolls are in a hole that is DN cm deep. The n-th troll is characterized by:\n\nthe distance from his feet to his shoulders in cm, hn\nthe length of his arms in cm, ln\nhis IQ (Irascibility Quotient), qn.\n\nTrolls can pile up on top of each other, with each troll standing on the shoulders of the one below him. A troll can climb out of the hole and escape if his hands can reach to the surface. Once a troll escapes he cannot participate any further in the escaping effort.\n\n\nThe trolls execute an optimal strategy for maximizing the total IQ of the escaping trolls, defined as Q(N).\n\n\nLet\nrn=[(5nmod(109+7))mod101]+50\n\nhn=r3n\n\nln=r3n+1\n\nqn=r3n+2\n\nDN=12\u2211n=0N\u22121hn.\n\n\nFor example, the first troll (n=0) is 51cm tall to his shoulders, has 55cm long arms, and has an IQ of 75.\n\n\nYou are given that Q(5)=401 and Q(15)=941.\n\n\nFind Q(1000).", "solution": "45609", "difficulty": 40, "story": "Once upon a time, in the mystical land of Numeria, there was a deep, dark hole - a hole that seemed to have no bottom. In this hole, N trolls lived, confined by its merciless depths. The trolls were an interesting bunch, each possessing unique characteristics that set them apart. They desired nothing more than to escape from the hole that held them captive, to taste freedom and embark on new adventures.\n\nThe trolls were not evenly matched, as some were taller, had longer arms, or possessed greater intellectual prowess. The trolls understood that by working together, they could find a way to collectively escape and maximize their chances of success.\n\nHowever, the trolls needed a strategy - an optimal one that would allow them to escape while maximizing the total IQ of the escaping trolls. IQ, or Irascibility Quotient, was a measure of a troll's intelligence and irascibility. The higher the IQ, the more likely they were to make rational decisions and maintain composure in stressful situations.\n\nOne by one, the trolls devised a plan based on their unique characteristics. The first troll, known as Troll Zero, had a distance of 51 centimeters from his feet to his shoulders, arms that measured 55 centimeters in length, and an impressive IQ of 75.\n\nTroll Zero's plan involved a mathematical equation that determined the height, arm length, and IQ of each troll subsequently. He shared his strategy with the other trolls, who marveled at his intelligence and appreciated his efforts.\n\nAs the trolls began to pile up on each other's shoulders, they realized that their success was directly linked to their combined intelligence. The equation guided their decisions, ensuring that each troll added to the overall intelligence and strength of the group.\n\nTime passed, and the trolls executed their plan flawlessly. One by one, they escaped from the hole, leaving their comrades behind once they reached the surface. Troll Zero, filled with pride as he escaped, understood the power of working together and using their unique strengths to overcome challenges.\n\nFurther down the line, the trolls faced their own set of obstacles, but they overcame them with combined intelligence, strength, and the bond they had developed in the hole. The trolls knew that only by working as a team could they achieve their ultimate goal.\n\nAs they reached higher levels of the hole, the trolls' IQs increased, improving their problem-solving abilities and increasing their chances of success. They adapted their strategy as they went along, constantly adjusting their positions to maximize the total IQ of the escaping trolls.\n\nFinally, after enduring countless challenges and supporting each other every step of the way, the trolls made it to the surface. Joy overwhelmed them as they stood together, embracing the freedom they had longed for.\n\nBut as they celebrated their victory, they couldn't help but wonder what their total IQ would have been had there been 1000 trolls in the hole. What heights, arm lengths, and IQs would each troll possess, and how would their optimal strategy differ?\n\nThe trolls pondered this question, realizing that it was yet another mathematical puzzle that they needed to solve. And so, with newfound determination, they set out on a new adventure, eager to discover the answer and triumph once again.\n\nNow, dear reader, it is your turn to solve the riddle that the trolls faced. What is Q(1000)? Can you calculate the total IQ of the escaping trolls? Join them in their journey and unravel the mathematical mystery that lies within."}, {"id": 748, "euler_id": 748, "title": "Upside down Diophantine equation", "problem": "\nUpside Down is a modification of the famous Pythagorean equation:\n1x2+1y2=13z2\n\n\nA solution (x,y,z)  to this equation with x,y and z positive integers is a primitive solution if gcd(x,y,z)=1.\n\n\nLet S(N) be the sum of x+y+z over primitive Upside Down solutions such that 1\u2264x,y,z\u2264N and x\u2264y. \nFor N=100 the primitive solutions are (2,3,6) and (5,90,18), thus S(102)=124.\nIt can be checked that S(103)=1470 and S(105)=2340084.\n\n\nFind S(1016) and give the last 9 digits as your answer.\n", "solution": "276402862", "difficulty": 40, "story": "Once upon a time, in the city of Numeria, there lived a young mathematician named Amelia. She had always been fascinated by numbers and spent most of her days scribbling equations and solving complex mathematical problems. Amelia had a reputation for her unparalleled problem-solving skills, and even the renowned mathematicians sought her guidance.\n\nOne sunny day, as Amelia strolled through the bustling streets of Numeria, she happened upon an ancient library. Curiosity fluttered in her heart as she pushed open the creaky doors, revealing shelves upon shelves of dusty books.\n\nHer eyes gleamed with excitement as she inspected each book, searching for a hidden gem that would challenge her intellect. Then, she stumbled upon a forgotten tome, titled \"The Upside Down Equations: A Mathematical Enigma.\"\n\nIntrigued, Amelia blew off the dust and cracked open the old book. The words danced before her eyes as she read about the peculiar Upside Down equation - a modification of the renowned Pythagorean equation.\n\nAs she delved deeper into the pages, Amelia's mind grew more engrossed in the Upside Down equation. It presented a challenge like no other, both in solving the equation and exploring the intricate beauty it possessed. But what fascinated her most was the concept of primitive solutions.\n\nA solution that was not only simply correct but also possessed a quality of primality - a simplicity that made it stand out among its peers. Amelia yearned to unlock the secrets behind these primitive solutions, and this newfound puzzle became her obsession.\n\nDays turned into nights as Amelia immersed herself in deciphering the nature of the Upside Down equation. She tirelessly studied its patterns, crafted intricate algorithms, and tested countless combinations. Sweat dripped down her temple, but her determination never wavered.\n\nFinally, after weeks of relentless effort, Amelia discovered something remarkable. She unraveled a hidden path that led her to an array of primitive solutions, each more elegant than the last. It felt like she had stumbled upon a hidden treasure trove of mathematical wonders.\n\nWith each new solution she discovered, Amelia's excitement grew exponentially. She felt as if she were navigating through a labyrinth of numbers, unraveling the mysteries they held. She reveled in the beauty of mathematics and reveled even more in her success.\n\nAs she carefully documented her findings and solved the Upside Down equation for multiple values of N, Amelia marveled at the incredible growth in the sum of x, y, and z. The numbers seemed to spiral out of control, each value surpassing the previous one by leaps and bounds.\n\nLost in the magic of numbers, Amelia embarked on a quest through the mathematical realm, seeking answers to the great unsolved problem: What would be the sum of x, y, and z for N equal to 1016?\n\nHer mind filled with anticipation, Amelia wondered what marvels of mathematics she would uncover this time. How far would the sum of x, y, and z stretch? And perhaps most importantly, what secrets would the last nine digits of her answer hold?\n\nThe tale of Amelia's journey through the Upside Down equation had only just begun. Will you join her in unraveling this mathematical enigma and finding the elusive sum of x, y, and z for N equal to 1016?"}, {"id": 753, "euler_id": 753, "title": "Fermat Equation", "problem": "Fermat's Last Theorem states that no three positive integers a, b, c satisfy the equation \nan+bn=cn\nfor any integer value of n greater than 2.\nFor this problem we are only considering the case n=3. For certain values of p, it is possible to solve the congruence equation:\na3+b3\u2261c3(modp)\nFor a prime p, we define F(p) as the number of integer solutions to this equation for 1\u2264a,b,c<p.\nYou are given F(5)=12 and F(7)=0.\nFind the sum of F(p) over all primes p less than 6000000.", "solution": "4714126766770661630", "difficulty": 40, "story": "Once upon a time in a small village named Arithmetica, there lived a young prodigy named Ethan. From a very early age, he had a natural fascination with numbers and a remarkable ability to solve complex mathematical problems. His parent's distant relative, Mathilda, recognized Ethan's talent and often shared intriguing mathematical puzzles with him.\n\nOne sunny morning, Mathilda arrived at the village square clutching a worn-out manuscript. Excitedly, she called out to Ethan, \"Ethan! I have a remarkable puzzle for you today. It involves a mathematical problem called Fermat's Last Theorem.\"\n\nIntrigued, Ethan joined Mathilda on a comfortable wooden bench in the square, where she began to explain Fermat's Last Theorem. As he listened, Ethan's eyes lit up with curiosity.\n\n\"The theorem states that there are no positive integer solutions for the equation an+bn=cn for any integer value of n greater than 2,\" Mathilda explained.\n\nEthan nodded, his growing obsession with the puzzle shining through. \"But the real puzzle is involving the case when n is equal to 3, isn't it, Mathilda?\"\n\nImpressed with Ethan's quick understanding, Mathilda smiled. \"You're right, Ethan! There's more to it. For certain prime numbers, we can actually solve a congruence equation related to that. We define F(p) as the number of integer solutions for a3+b3\u2261c3(modp) for a prime number p. Fascinating, isn't it?\"\n\nEthan's mind began to race, and he delved deeper into the mathematics behind Fermat's Last Theorem and F(p). Mathilda continued, \"I have some valuable information for you. F(5) equals 12, while F(7) is equal to 0.\"\n\nThe village became Ethan's personal laboratory as he dove headfirst into solving this intricate problem. Days turned into weeks, and weeks turned into months. The more Ethan explored, the more captivated he became by the puzzle's enigma.\n\nMonths later, after countless sleepless nights and endless scribblings on parchment, Ethan stumbled upon a revelation. He felt on the verge of unraveling the mystery that Fermat had left behind centuries ago.\n\nBut then, doubt crept in. What if his calculations were incorrect? What if he had taken a wrong turn somewhere along the way? Ethan knew one thing for certain \u2013 he needed more data points to verify his theory.\n\nWith newfound determination, Ethan embarked on the most challenging quest of his life \u2013 to find the sum of F(p) over all primes p less than 6,000,000. He traveled far and wide, visiting libraries, speaking to mathematicians, and finding clues in ancient texts.\n\nMeanwhile, the village of Arithmetica buzzed with curiosity. People whispered about Ethan's pursuit of an unsolvable mathematical riddle. Some believed he would conquer the mystery, while others doubted his chances.\n\nMonths turned into years, and years stretched into decades. Ethan's once youthful face was now covered with wrinkles, and his once vibrant hair turned gray. The weight of time bore heavily upon him, and he wondered if his life's work would ever be complete.\n\nOne day, while sitting in his study surrounded by stacks of dusty books, Ethan stumbled upon a realization. He understood that although he had made progress, he needed a fresh perspective. With a trembling hand, he scribbled a question on a piece of parchment.\n\n\"Can you find the sum of F(p) over all primes p less than 6,000,000?\"\n\nEthan looked at the question, his heart filled with anticipation. He knew that somewhere out there, someone had the key to unlock the secret he had sought his entire life. Excitedly, he folded the parchment and sent it off, hoping that his enigma would find its way into the hands of a relentless mathematical mind, ready to complete his journey.\n\nAnd so, dear reader, the question remains. Are you the one who will solve the mathematical problem that has eluded countless scholars for centuries? Can you find the sum of F(p) over all primes p less than 6,000,000?"}, {"id": 764, "euler_id": 764, "title": "Asymmetric Diophantine Equation", "problem": "\nConsider the following Diophantine equation:\n16x2+y4=z2\nwhere x, y and z are positive integers.\n\n\nLet S(N)=\u2211(x+y+z) where the sum is over all solutions (x,y,z) such that 1\u2264x,y,z\u2264N and gcd(x,y,z)=1. \n\n\nFor N=100, there are only two such solutions: (3,4,20) and (10,3,41). So S(102)=81.\n\n\nYou are also given that S(104)=112851 (with 26 solutions), and S(107)\u2261248876211(mod109).\n\n\nFind S(1016). Give your answer modulo 109.\n", "solution": "255228881", "difficulty": 40, "story": "Once upon a time, in the small village of Numeria, lived a brilliant mathematician named Felix. He was known throughout the land for his love of numbers and his ability to solve even the most complex mathematical problems. The villagers often sought his wisdom, and he was always ready to assist them.\n\nOne bright morning, as Felix sipped his tea outside his humble cottage, a young girl named Lily approached him. With a puzzled expression on her face, she handed Felix a slip of paper containing a mathematical problem she had come across during her studies.\n\nCurious, Felix unfolded the paper and began to read. The problem intrigued him, for it involved a Diophantine equation, a mathematical challenge that had been baffling him for some time. As he absorbed the problem, his eyes widened with excitement.\n\nLily watched Felix intently, wondering if he would be able to solve the equation. She knew of his prowess, but this particular problem had proven to be quite elusive. Deep down, she hoped that Felix would finally find a solution.\n\nAs Felix delved into his thoughts, the village bustled with the usual activities. Merchants exchanged goods, children played in the meadows, and the air was filled with laughter. But for Felix, the world around him faded away, and his focus was solely on the elusive Diophantine equation.\n\nDays turned into weeks, and Felix became consumed by the problem. He locked himself in his study, surrounded by mountains of parchment filled with scribbles and equations. His eyes sparkled with determination, and his passion for solving the puzzle refused to wane.\n\nNews of Felix's endeavor spread throughout the village, and soon, the villagers were just as invested in the equation as he was. They eagerly awaited the day when Felix would emerge from his study and present the solution. The air buzzed with excitement and anticipation.\n\nOne evening, as the sun kissed the horizon, casting a warm golden glow over the village, Felix emerged from his study. His face was etched with a mixture of exhaustion and triumph. The villagers gathered around him, their eyes filled with hope.\n\nWith a deep breath, Felix addressed the crowd. \"My dear friends,\" he began, his voice filled with a sense of accomplishment, \"I am pleased to inform you that I have, at long last, found a breakthrough in the Diophantine equation.\"\n\nA wave of applause and cheers filled the air. The villagers rejoiced, for they knew that Felix's discovery would not only shed light on this particular problem but also push the boundaries of mathematics itself.\n\nHowever, just as the celebration began, Felix's face grew serious. The crowd fell silent, sensing that something was amiss.\n\n\"I am afraid,\" Felix continued, his voice laced with urgency, \"that this newfound solution is only the tip of the iceberg. This equation holds many more secrets that await our discovery. The journey has just begun.\"\n\nThe villagers exchanged puzzled glances, unsure of what Felix meant. But deep down, they understood that their journey alongside Felix was far from over. Together, they would explore the intricacies of the Diophantine equation and uncover the hidden treasures it held.\n\nAnd so, a new chapter unfolded in Numeria. Felix, Lily, and the curious villagers embarked on an adventure into the world of mathematics, seeking answers to questions that seemed impossible.\n\nAnd now, dear reader, you too are invited to join their quest. Can you unravel the mysteries of the Diophantine equation? What lies beyond the solutions discovered so far? How do we find S(10^16)? The villagers of Numeria await your wisdom and insight.\n\nWhat is your answer, modulo 10^9?"}, {"id": 775, "euler_id": 775, "title": "Saving Paper", "problem": "When wrapping several cubes in paper, it is more efficient to wrap them all together than to wrap each one individually. For example, with 10 cubes of unit edge length, it would take 30 units of paper to wrap them in the arrangement shown below, but 60 units to wrap them separately.\n\n\nDefine g(n) to be the maximum amount of paper that can be saved by wrapping n identical 1\u00d71\u00d71 cubes in a compact arrangement, compared with wrapping them individually. We insist that the wrapping paper is in contact with the cubes at all points, without leaving a void.\nWith 10 cubes, the arrangement illustrated above is optimal, so g(10)=60\u221230=30. With 18 cubes, it can be shown that the optimal arrangement is as a 3\u00d73\u00d72, using 42 units of paper, whereas wrapping individually would use 108 units of paper; hence g(18)=66.\nDefine\nG(N)=\u2211n=1Ng(n)\nYou are given that G(18)=530, and G(106)\u2261951640919(mod1000000007).\nFind G(1016). Give your answer modulo 1000000007.", "solution": "946791106", "difficulty": 40, "story": "Once upon a time in a peaceful village by the sea, there was a talented young mathematician named Lily. She had a unique gift for solving complex equations and finding beauty in the world of numbers. The villagers often sought her advice, and she was always there to help.\n\nOne day, as Lily was strolling along the shoreline, she noticed a group of children playing with colorful cubes on the sandy beach. She smiled as their laughter filled the air, lifting her spirits. Curiosity sparked within her as she watched them stack the cubes in different patterns.\n\nLily sat down beside them, intrigued by the mathematical possibilities in front of her. She joined their game and began experimenting with different arrangements of the cubes. As the children scattered the cubes across the sand, she discovered something fascinating.\n\n\"When wrapping several cubes in paper,\" Lily thought aloud, \"it is more efficient to wrap them all together than to wrap each one individually.\"\n\nThe children looked at her with puzzled expressions, unsure of what she meant.\n\nLily picked up ten cubes and formed a rectangular prism. She carefully placed a sheet of paper around them, covering all sides of the shape. Counting the units of paper used, she found it took only 30 units to wrap the ten cubes together in this arrangement.\n\nShe then took another ten cubes and meticulously wrapped each one individually, counting 60 units of paper used. The children gasped at the stark difference in the amount of paper required.\n\n\"Wow! You saved 30 units of paper by wrapping them together!\" one of the children exclaimed.\n\nLily nodded, impressed by the children's observation. \"Exactly! That's what I'm trying to explain. The more compactly objects are arranged, the less paper is needed to wrap them individually.\"\n\nAs word of Lily's discovery spread through the village, the villagers grew excited about the impact this could have on their lives. The mayor of the village requested Lily's assistance in finding the most efficient arrangements for different numbers of cubes.\n\nLily threw herself into the challenge, tirelessly seeking the arrangements that saved the most paper when wrapping cubes. Every day, she would sit by the beach, stacking and rearranging the cubes until she found an optimal arrangement.\n\nEventually, she came across the number 18. After many trials, she discovered that by arranging the cubes in a 3\u00d73\u00d72 formation, she could wrap them with only 42 units of paper. Wrapping them individually would have required a staggering 108 units.\n\nThe villagers were amazed by the transformation Lily's arrangements brought. With this newfound knowledge, they were able to save large amounts of paper, which in turn reduced waste and helped to preserve their beautiful village.\n\nLily's efforts didn't stop there. She continued her calculations and made even more astonishing discoveries. The villagers, grateful for her help, sought to quantify the impact she had made. They defined G(N) as the sum of g(n) for all numbers up to N.\n\nThe villagers were eager to know the value of G(1016), but the answer eluded them. It became an enigmatic quest, a puzzle begging to be solved. They realized that finding G(1016) would require immense mathematical prowess.\n\nAnd so, dear reader, the question falls upon you now. Can you determine the value of G(1016)? Can you solve this perplexing mathematical riddle that has captivated an entire village?\n\nAs the villagers eagerly await your response, they trust in the power of numbers and the brilliance of your mind."}, {"id": 787, "euler_id": 787, "title": "B\u00e9zout's Game", "problem": "Two players play a game with two piles of stones. They take alternating turns. If there are currently a stones in the first pile and b stones in the second, a turn consists of removing c\u22650 stones from the first pile and d\u22650 from the second in such a way that ad\u2212bc=\u00b11. The winner is the player who first empties one of the piles.\nNote that the game is only playable if the sizes of the two piles are coprime.\nA game state (a,b) is a winning position if the next player can guarantee a win with optimal play. Define H(N) to be the number of winning positions (a,b) with gcd(a,b)=1, a>0, b>0 and a+b\u2264N. Note the order matters, so for example (2,1) and (1,2) are distinct positions.\nYou are given H(4)=5 and H(100)=2043.\nFind H(109).", "solution": "202642367520564145", "difficulty": 40, "story": "Once upon a time in the kingdom of Arithmos, there lived two young princes named Lucas and Felix. They were known throughout the land for their love of numbers and their competitive nature. One sunny afternoon, as they sat by a bubbling brook, they stumbled upon an ancient scroll hidden beneath a moss-covered rock.\n\nCuriosity piqued, Lucas and Felix unrolled the scroll to unveil a captivating challenge. It was a game that revolved around two piles of stones. The game required alternating turns, and the goal was to empty one of the piles first. What intrigued the princes the most was the condition: the number of stones taken from each pile had to satisfy a mathematical equation, ad\u2212bc=\u00b11, where a, b, c, and d were the sizes of the respective piles.\n\nEager to embark on this intriguing mathematical adventure, Lucas and Felix set out to master the game. They quickly discovered that the game was only playable if the sizes of the two piles were coprime, meaning they had no common factors aside from 1. As they pondered the significance of this condition, they realized that it was crucial in determining the outcome of the game.\n\nThe princes spent countless nights huddled in the palace library, engrossed in solving the puzzle. Through tireless calculations, they realized that a game state (a, b) could only be considered a winning position if the next player could guarantee a win with optimal play. They coined the term \"H(N)\" to represent the number of winning positions (a, b) with gcd(a, b) = 1, a > 0, b > 0, and a + b \u2264 N.\n\nWith their newfound knowledge, Lucas and Felix passionately dove into the world of H(N). They analyzed various scenarios and discovered that H(4) equalled 5, while H(100) amounted to 2043. These results fueled their determination to solve the ultimate problem. The princes wondered how many winning positions, H(109), awaited their strategic exploration.\n\nTheir journey through the world of mathematics brought them extraordinary insights. They discovered intricate patterns, hidden symmetries, and the interconnectedness of numbers. As Lucas and Felix expanded their knowledge, the game transformed into something more profound than a mere pastime; it became a symbol of their ceaseless thirst for understanding.\n\nAs the seasons changed, so did the young princes. They grew wiser, more profound, and even more driven to unravel the mysteries of H(109). The kingdom of Arithmos thrived with their intellectual discoveries, and scholars from far and wide flocked to learn from the esteemed princes.\n\nNow, standing before the precipice of discovery, the kingdom held its breath. The princes, fueled by determination and love for their subjects, sought to find the answer to the elusive H(109). The question remained, begging to be solved, beckoning the brilliance of mind and the depth of curiosity:\n\nWhat is the value of H(109)?\n\nAnd thus, the final chapter remained unwritten, awaiting discovery by an erudite soul who could uncover the hidden answers buried in the realm of numbers."}, {"id": 811, "euler_id": 811, "title": "Bitwise Recursion", "problem": "\nLet b(n) be the largest power of 2 that divides n. For example b(24)=8.\n\nDefine the recursive function:\nA(0)=1A(2n)=3A(n)+5A(2n\u2212b(n))n>0A(2n+1)=A(n)\nand let H(t,r)=A((2t+1)r).\n\nYou are given H(3,2)=A(81)=636056.\n\nFind H(1014+31,62). Give your answer modulo 1000062031. ", "solution": "327287526", "difficulty": 40, "story": "Once upon a time in the kingdom of Mathiland, there lived a young and curious princess named Amelia. From a tender age, she had always been enamored by numbers and patterns, and she spent her days poring over mathematical problems, much to the amusement of her parents and the courtiers.\n\nOne sunny day, as Amelia strolled through the castle gardens, she stumbled upon an old tome hidden amongst the blooming flowers. Intrigued, she dusted off the ancient book and opened it to find a mathematical problem that caught her attention. The problem went like this:\n\n\"Let b(n) be the largest power of 2 that divides n. For example, b(24) = 8. Define the recursive function: A(0) = 1, A(2n) = 3A(n) + 5A(2n\u2212b(n)), A(2n+1) = A(n), and let H(t,r) = A((2t+1)r). You are given H(3,2) = A(81) = 636056. Find H(1014+31,62). Give your answer modulo 1000062031.\"\n\nAmelia's eyes sparkled with excitement. She had never encountered such a perplexing problem before, and she knew that solving it could unravel the mysteries hidden within the intricate world of mathematics.\n\nDetermined to solve the problem, Princess Amelia sought advice from the wisest mathematicians and scholars in the kingdom. Each day, she would gather them in the royal hall, where they would eagerly discuss the problem, pondering over various approaches and formulas.\n\nAs the days turned into weeks, Amelia's life became intricately entwined with the mathematical conundrum. The people of Mathiland began to perceive her not only as a princess but also as their beacon of knowledge and intellect. Amelia embraced her new role with pride, inspiring others to unravel the beauty of numbers.\n\nFinally, after countless hours of exploration and collaboration, Princess Amelia and her beloved scholars made a breakthrough. With jubilant hearts and a renewed sense of purpose, they discovered the solution to H(1014+31,62), however, unknown to the readers of this short story.\n\nBut alas, dear reader, I must disappoint you, for I have spent this tale revealing only the journey of Princess Amelia, and not the answers she sought. It is in your hands, dear reader, to think deeply, embrace the twists, ponder the path, and find the solution to the enigmatic H(1014+31,62).\n\nThus, I leave you with the question begged: Can you, in your wisdom and love for numbers, find the value of H(1014+31,62) modulo 1000062031?"}]