[{"id": 289, "euler_id": 289, "title": "Eulerian Cycles", "problem": "Let C(x,y) be a circle passing through the points (x,\u2009y), (x,\u2009y+1), (x+1,\u2009y) and (x+1,\u2009y+1).\nFor positive integers m and n, let E(m,n) be a configuration which consists of the m\u00b7n circles:\n{ C(x,y): 0\u2009\u2264\u2009x\u2009<\u2009m, 0\u2009\u2264\u2009y\u2009<\u2009n, x and y are integers }\nAn Eulerian cycle on E(m,n) is a closed path that passes through each arc exactly once.\nMany such paths are possible on E(m,n), but we are only interested in those which are not self-crossing: \nA non-crossing path just touches itself at lattice points, but it never crosses itself.\nThe image below shows E(3,3) and an example of an Eulerian non-crossing path.\nLet L(m,n) be the number of Eulerian non-crossing paths on E(m,n).\nFor example, L(1,2)\u2009=\u20092, L(2,2)\u2009=\u200937 and L(3,3)\u2009=\u2009104290.\nFind L(6,10) mod 1010.", "solution": "6567944538", "difficulty": 90, "story": "Once upon a time, in a quiet little village called Mathland, lived two best friends named Alice and Bob. Alice was a curious girl who loved to solve puzzles and riddles, while Bob was a creative thinker who enjoyed painting colorful landscapes. Together, they embarked on enchanting adventures, exploring the depths of their imaginations.\n\nOne sunny day, Alice and Bob stumbled upon an old, dusty book in the village library. As they blew off the layers of dust, a glowing page caught their attention. The page depicted a magical land filled with vibrant circles intersecting with one another. It was the illustration for the mathematical problem: L(m,n).\n\nIntrigued, Alice and Bob read the mathematical problem aloud. Suddenly, the room shimmered with magic, and they found themselves transported into the very world they were marveling at. The circles surrounded them, and they realized they had become a part of the problem themselves.\n\nAs they explored their new mathematical world, Alice and Bob encountered fascinating creatures and landscapes. They witnessed arcs weaving in and out of each circle, forming intricate patterns. However, something wasn't quite right.\n\nThey soon discovered that some paths crossed each other, creating chaotic confusion. Alice and Bob quickly realized the significance of the non-crossing paths mentioned in the problem. Those paths were the key to finding their way back home!\n\nDriven by their desire to return, Alice and Bob embarked on a brave quest to find the Eulerian non-crossing path that connected all the arcs without any crossings.\n\nAlong their journey, they met the wise sage of Mathland, who bestowed upon them valuable knowledge and guidance. The sage explained the concept of Eulerian non-crossing paths in detail, teaching them that such paths just touch themselves at lattice points but never cross.\n\nWith newfound knowledge, Alice and Bob navigated their way through the enchanting land, carefully avoiding crossings at every step. They took meticulous notes, creating their own maps, and tried various combinations of arcs and circles.\n\nAs they delved deeper into the problem, Alice and Bob's friendship grew stronger. Their teamwork and determination pushed them through challenges and setbacks. By working together, they discovered the beauty of patterns, symmetry, and logic hidden within the circles.\n\nIn their quest, Alice and Bob encountered countless obstacles, yet they remained undeterred. They painted breathtaking landscapes, each stroke representing an arc they had overcome. And with every passing day, their maps grew more intricate, capturing the essence of the mathematical problem.\n\nEventually, after days filled with excitement and determination, Alice and Bob emerged victorious. Their minds were brimming with knowledge and their hearts filled with accomplishment. They had found the elusive Eulerian non-crossing path that connected all the arcs flawlessly.\n\nExhausted but satisfied, Alice and Bob returned to their world, carrying with them the memories of Mathland and the exhilaration of their triumph. But before they could move on with their lives, a thought lingered in their minds, a question that echoed through their hearts.\n\nAs they closed the old, dusty book, Alice looked at Bob and asked, \"Does every configuration in E(m,n) have a non-crossing Eulerian path? And can we find the value of L(6,10) mod 1010, the number of such paths? Shall we embark on another adventure to solve this intriguing mystery?\"\n\nAnd so, the friends pondered once more, ready to embark on their next adventure, solving yet another mathematical conundrum that lay at their feet.\n\nWill you join Alice and Bob on their quest to solve L(6,10) mod 1010?"}, {"id": 319, "euler_id": 319, "title": "Bounded Sequences", "problem": "\nLet x1, x2,..., xn be a sequence of length n such that:\nx1 = 2\nfor all 1 < i \u2264 n : xi-1 < xi\nfor all i and j with 1 \u2264 i, j \u2264 n : (xi) j < (xj + 1)i\n\nThere are only five such sequences of length 2, namely:\n{2,4}, {2,5}, {2,6}, {2,7} and {2,8}.\nThere are 293 such sequences of length 5; three examples are given below:\n{2,5,11,25,55}, {2,6,14,36,88}, {2,8,22,64,181}.\n\n\nLet t(n) denote the number of such sequences of length n.\nYou are given that t(10) = 86195 and t(20) = 5227991891.\n\n\nFind t(1010) and give your answer modulo 109.\n", "solution": "268457129", "difficulty": 90, "story": "Once upon a time, in the village of Mathematica, there lived a young mathematician named Aaron. Aaron had always been fascinated by numbers and patterns since he was a child. He spent hours in his room, surrounded by countless papers covered in complex equations and diagrams. His passion for mathematics was unparalleled, and he was determined to make significant contributions to the field.\n\nOne day, while Aaron was studying a particularly intriguing mathematical problem, he stumbled upon a mysterious book in the dusty archives of the village library. The book was old, its pages yellowed with age, and its title, \"The Secrets of Sequences,\" stood out in elegant golden calligraphy. It seemed as if fate had led Aaron to this book \u2013 the answer to his mathematical quest was within his grasp.\n\nCuriosity getting the better of him, Aaron opened the book and discovered a seemingly impossible mathematical problem. The book described a sequence of numbers, starting with 2, and laid out specific conditions that each number in the sequence had to fulfill. Aaron's mind buzzed with excitement; he knew he had stumbled upon something truly extraordinary.\n\nAs he delved into solving the problem, Aaron realized the challenge before him. The sequence had to be in ascending order, with each subsequent number greater than the one before. Additionally, a unique inequality between any two numbers had to be maintained. It was daunting, but Aaron's determination fueled his journey into the world of sequences.\n\nDays flowed seamlessly into weeks as Aaron immersed himself in the conundrum. He spent countless sleepless nights, scribbling away feverishly, trying to unravel the secrets of the sequence. Finally, after many failed attempts, he made a breakthrough. The numbers began to align, and a beautiful pattern emerged.\n\nAaron found the first few sequences that met the specified conditions, and he marveled at their elegance. The book had mentioned that there were only five such sequences of length 2, and he discovered them to be {2,4}, {2,5}, {2,6}, {2,7}, and {2,8}. Excitement coursed through him as he realized he was unraveling the hidden secrets of the sequence.\n\nWeeks turned into months, and Aaron's dedication remained unwavering. The reward for his perseverance came in the form of a staggering revelation. He discovered that there were precisely 293 sequences that adhered to the given conditions for length 5. A few examples from his calculations were {2,5,11,25,55}, {2,6,14,36,88}, and {2,8,22,64,181}. Each sequence was a masterpiece, a testament to Aaron's brilliance.\n\nHis heart raced with anticipation as he approached the final stretch. Now armed with his newfound knowledge, Aaron aimed to calculate the number of sequences for n equals 10 and 20. Through meticulous calculations, he derived that t(10) equaled 86195 and t(20) equaled 5227991891. These numbers loomed large in his mind, hinting at the unfathomable possibilities within the realm of mathematics.\n\nHowever, just as Aaron reached the edge of discovery, the pages of the book abruptly ended, leaving him dangling in the midst of an infinite mystery. He longed to know the answer to t(1010), but the book remained silent, its ancient secrets locked away.\n\nAs Aaron closed the book and returned it to its rightful place on the library shelf, he couldn't help but yearn for the answer. What could t(1010) be? And how could the solution be achieved, limited only by a return value modulo 109?\n\nInspired by the enigmatic sequence, Aaron embarked on a quest to unlock the answer. Determined to leave his mark on the field of mathematics, he dedicated his life to solving the unanswered question waiting silently within the pages of the ancient book. For in the hidden truths of numbers lay the power to shape the world and unravel the mysteries of the universe.\n\nAnd so, dear reader, I ask you now: What is the value of t(1010) modulo 109?"}, {"id": 361, "euler_id": 361, "title": "Subsequence of Thue-Morse sequence", "problem": "The Thue-Morse sequence {Tn} is a binary sequence satisfying:\nT0 = 0\nT2n = Tn\nT2n+1 = 1 - Tn\n\nThe first several terms of {Tn} are given as follows:\n01101001100101101001011001101001....\n\n\nWe define {An} as the sorted sequence of integers such that the binary expression of each element appears as a subsequence in {Tn}.\nFor example, the decimal number 18 is expressed as 10010 in binary. 10010 appears in {Tn} (T8 to T12), so 18 is an element of {An}.\nThe decimal number 14 is expressed as 1110 in binary. 1110 never appears in {Tn}, so 14 is not an element of {An}.\n\n\nThe first several terms of An are given as follows:\nn0123456789101112\u2026An012345691011121318\u2026\n\nWe can also verify that A100 = 3251 and A1000 = 80852364498.\n\n\nFind the last 9 digits of \u2211k=118A10k.\n", "solution": "178476944", "difficulty": 90, "story": "Once upon a time in the mystical land of Mathmania, there lived a gifted mathematician named Professor Arithmetica. She was renowned for her ability to see numbers in everything around her, and her latest obsession was the Thue-Morse sequence.\n\nEvery day, Professor Arithmetica would immerse herself in decoding the intricate patterns of the Thue-Morse sequence, trying to decipher its many secrets. One evening, as she was sipping her favorite tea and studying the sequence's behavior, she stumbled upon a remarkable discovery.\n\n\"It seems that this enigmatic sequence not only holds binary strings but also a treasure trove of sorted integers,\" she whispered to herself.\n\nEager to explore further, Professor Arithmetica spent countless sleepless nights analyzing the connection between the Thue-Morse sequence {Tn} and the sorted sequence of integers {An}. She made a groundbreaking observation - the binary expression of each element in {An} appeared as a subsequence in {Tn}.\n\nWith her heart racing, she decided to harness the power of this newfound knowledge. Guided by the Thue-Morse sequence, Professor Arithmetica embarked on an adventure to locate hidden treasures buried deep within Mathmania.\n\nArmed with a map that hinted at the first several terms of {An}, she set off towards her first destination, a mysterious forest. Deep within the woods, she found herself standing in front of a massive Oak tree, its bark adorned with cryptic symbols.\n\nThrough careful analysis, Professor Arithmetica deciphered the hidden message carved into the tree trunk. It revealed that the decimal number 18 was encoded as the binary string 10010. When she checked her notes, she found that this binary string indeed appeared as a subsequence in the Thue-Morse sequence, thereby confirming that 18 was an element of {An}.\n\nFilled with a sense of triumph, she marked the Oak tree as the location of her first treasure and moved on to the next challenge. A treacherous mountain awaited her, and she had to solve the enigma of decimal number 14.\n\nProfessor Arithmetica spent days analyzing binary strings and cross-referencing them with the Thue-Morse sequence to find any trace of 14. However, her efforts proved fruitless. The binary string 1110 never appeared in {Tn}, leading her to conclude that 14 was not an element of {An}.\n\nUndeterred, Professor Arithmetica continued her adventurous quest, visiting ancient ruins, exploring forgotten caves, and decoding intricate riddles to uncover hidden treasures. Each successful encounter amplified her curiosity, urging her to unearth the remaining secrets lurking within the numerical constructs of the Thue-Morse sequence.\n\nAnd now, dear reader, the question that lies before you is this: can you find the last 9 digits of \u2211k=118A10k? Can you solve the mystery that Professor Arithmetica cherished till her last breath? In a world where numbers hold the key to hidden wonders, it is up to you to unlock the secret and bring closure to this captivating mathematical tale."}, {"id": 428, "euler_id": 428, "title": "Necklace of circles", "problem": "Let a, b and c be positive numbers.\nLet W, X, Y, Z be four collinear points where |WX| = a, |XY| = b, |YZ| = c and |WZ| = a + b + c.\nLet Cin be the circle having the diameter XY.\nLet Cout be the circle having the diameter WZ.\n\nThe triplet (a, b, c) is called a necklace triplet if you can place k \u2265 3 distinct circles C1, C2, ..., Ck such that:\nCi has no common interior points with any Cj for 1 \u2264 i, j \u2264 k and i \u2260 j,\nCi is tangent to both Cin and Cout for 1 \u2264 i \u2264 k,\nCi is tangent to Ci+1 for 1 \u2264 i < k, and\nCk is tangent to C1.\n\nFor example, (5, 5, 5) and (4, 3, 21) are necklace triplets, while it can be shown that (2, 2, 5) is not.\n\n\n\nLet T(n) be the number of necklace triplets (a, b, c) such that a, b and c are positive integers, and b \u2264 n.\nFor example, T(1)\u00a0=\u00a09, T(20)\u00a0=\u00a0732 and T(3000)\u00a0=\u00a0438106.\n\n\nFind T(1\u00a0000\u00a0000\u00a0000).\n", "solution": "747215561862", "difficulty": 90, "story": "Once upon a time in the quaint town of Numerville, a young girl named Lily had a unique talent for making beautiful jewelry. She would spend her days crafting exquisite necklaces using precious gems and delicate beads. Nobody understood her love for jewelry like her grandmother, who had taught her everything she knew about the art.\n\nOne sunny afternoon, Lily's grandmother called her into the garden. As they sat on the swing, her grandmother handed Lily an intriguing piece of paper. It had an intricate mathematical problem scribbled on it.\n\n\"Darling, I have a challenge for you,\" her grandmother said with a twinkle in her eyes. \"I want you to solve this problem and create a necklace inspired by its solution.\"\n\nLily's curiosity was piqued. She read the problem carefully, letting the abstract numbers and shapes sink in. A hazy idea began to form in her mind. She realized that if she could crack this code, she could create a necklace that would be unlike anything she had ever made before.\n\nDays turned into weeks as Lily tirelessly worked on solving the complex mathematical problem. She delved into geometric theories and experimented with various combinations of gemstones and beads. But no matter how many times she rearranged them, it never felt right.\n\nOne evening, as the sun painted the sky in hues of orange and purple, Lily found herself sitting by the river. Her mind had grown weary, and she was about to give up on her quest. Suddenly, a flock of birds flew overhead, forming a perfect V-shape formation. Lily's eyes widened with realization\u2014the answer was right in front of her.\n\nShe rushed back to her workshop, her heart pounding with excitement. Guided by newfound inspiration, she carefully selected different-sized gemstones and beads, allowing her inner artist to take the lead. The result was a magnificent necklace, each stone nestled against the other in perfect harmony.\n\nWhen Lily presented her creation to her grandmother, she saw the pride and joy in her eyes. The necklace was not only a testament to her grandmother's love but also a celebration of Lily's perseverance and ingenuity.\n\nWord of Lily's remarkable necklace spread far and wide. People from distant lands traveled to Numerville, hoping to witness her incredible talent firsthand. They marveled at the intricate designs and delicate craftsmanship of her jewelry. Everybody wanted to know her secret, to understand the story behind her creations.\n\nAs Lily's fame grew, she began to wonder how many unique necklace triplets she could come up with using the mathematical problem her grandmother had given her. She pondered different combinations, exhausted all possibilities, and experimented with a myriad of gemstones and beads.\n\nBut no matter how hard she tried, she couldn't reach a definitive answer. The question remained elusive, teasing her like a distant melody she could almost grasp but never fully comprehend. As Lily stared at her workbench, filled with unfinished creations, she couldn't help but wonder:\n\n\"Could there ever be an end to the possibilities? Will I ever find the solution that will unlock the infinite beauty of necklace triplets?\"\n\nAnd so, the story of Lily and her extraordinary talent continues, leaving all who encounter her creations with one lingering question:\n\n\"Can you find T(1,000,000,000)? Can you find the value that will unravel the mystery of necklace triplets and bring their enchanting allure to life?\"\n\nOnly time will tell."}, {"id": 505, "euler_id": 505, "title": "Bidirectional Recurrence", "problem": "Let:\nx(0)=0x(1)=1x(2k)=(3x(k)+2x(\u230ak2\u230b))\u00a0mod\u00a0260\u00a0for\u00a0k\u22651, where\u00a0\u230a\u00a0\u230b\u00a0is the floor functionx(2k+1)=(2x(k)+3x(\u230ak2\u230b))\u00a0mod\u00a0260\u00a0for\u00a0k\u22651yn(k)={x(k)if\u00a0k\u2265n260\u22121\u2212max(yn(2k),yn(2k+1))if\u00a0k<nA(n)=yn(1)\nYou are given:\nx(2)=3x(3)=2x(4)=11y4(4)=11y4(3)=260\u22129y4(2)=260\u221212y4(1)=A(4)=8A(10)=260\u221234A(103)=101881\nFind A(1012).", "solution": "714591308667615832", "difficulty": 90, "story": "Once upon a time, in the bustling city of Numeropolis, there lived a young girl named Alice. Alice was an inquisitive child, always seeking answers to life's mysteries. One day, while exploring the dusty shelves of the city's ancient library, she stumbled upon an old, leather-bound book covered in cobwebs. When Alice blew away the dust, she discovered that the pages were filled with mathematical riddles and enigmatic problems.\n\nIntrigued, Alice eagerly flipped through the book until she came across an unusual problem. It was unlike anything she had ever seen before. The problem was accompanied by a note that read, \"Legend has it there's a hidden world beyond Numeropolis, and only those who can solve this problem can gain access. Will you be the one?\"\n\nDetermined to uncover the secrets locked within the hidden world, Alice began to immerse herself in the problem. She copied down the equations, filling page after page with her calculations and thoughts. As she continued to delve into the depths of the mathematical mystery, Alice noticed peculiar patterns emerging.\n\nIn her numerous calculations, Alice realized that the values she derived were always limited to a range of 0 to 259. Curiously, this limiting range seemed to be related to a mod(260), a mathematical concept she had briefly studied in her school.\n\nAs Alice poured over the problem, she couldn't help but wonder about the significance of the numbers she had encountered. The mathematical equations seemed to be interconnected, each step building upon the one before it. But for what purpose? Alice's mind raced with questions, and she felt as if she were on the brink of a profound discovery.\n\nDays turned into weeks, and weeks into months as Alice tirelessly attempted to crack the enigma of the hidden world. She often found herself immersed in deep thought, scribbling away at her calculations. As the nights grew longer, fueled by her determination, Alice gained a newfound understanding of the problem.\n\nThe solution she sought was contingent upon the values of yn(k), representing the calculated numbers at each step. The elusive A(n) was Alice's ultimate goal, the key to unlocking the hidden world. A world that promised secrets and wonders beyond her wildest dreams.\n\nAs she tried to comprehend the intricate workings of the problem, Alice found herself questioning the purpose of it all. Why had this mathematical oddity been hidden away for so long? What secrets lay beyond the borders of Numeropolis? And most importantly, what could she hope to find in the hidden world if she could decipher the elusive A(n)?\n\nThe siren call of knowledge echoed in Alice's ears, urging her to unravel the final mystery. With every iteration of the equations, Alice grew more determined to find A(1012). She yearned to discover what lay on the other side of the mathematical threshold that had eluded so many before her.\n\nBut as Alice's eyes met the long string of digits that represented A(1012), she couldn't help but feel a mix of anticipation and trepidation. The hidden world awaited her, and only with the solution to the problem could she step through its invisible doorway. Would she be able to find the key that unlocked the mystery? Would she be the one to enter the hidden world, paving the way for others to follow?\n\nNow, dear reader, it is your turn to join Alice in her quest. Will you be the one to solve the elusive mystery and uncover the hidden world of Numeropolis? What lies beyond its boundaries, and what wonders await those who dare to venture forth?"}, {"id": 507, "euler_id": 507, "title": "Shortest Lattice Vector", "problem": "\nLet tn be the tribonacci numbers defined as:\nt0=t1=0;\nt2=1;\ntn=tn\u22121+tn\u22122+tn\u22123 for n\u22653\nand let rn=tn\u00a0mod\u00a0107.\n\n\nFor each pair of Vectors Vn=(v1,v2,v3) and Wn=(w1,w2,w3) with v1=r12n\u221211\u2212r12n\u221210,v2=r12n\u22129+r12n\u22128,v3=r12n\u22127\u22c5r12n\u22126  and  w1=r12n\u22125\u2212r12n\u22124,w2=r12n\u22123+r12n\u22122,w3=r12n\u22121\u22c5r12n\n\n\nwe define S(n) as the minimal value of the manhattan length of the vector D=k\u22c5Vn+l\u22c5Wn measured as |k\u22c5v1+l\u22c5w1|+|k\u22c5v2+l\u22c5w2|+|k\u22c5v3+l\u22c5w3|\n for any integers k and l with (k,l)\u2260(0,0).\n\nThe first vector pair  is (-1, 3, 28), (-11, 125, 40826).\nYou are given that S(1)=32 and \u2211n=110S(n)=130762273722.\n\n\nFind \u2211n=120000000S(n).\n", "solution": "316558047002627270", "difficulty": 90, "story": "Once upon a time, in a small village nestled near the foot of a magnificent mountain, lived a young girl named Amelia. Amelia was known for her curiosity and love for adventure. Every day, she would explore the vast landscapes surrounding her village, seeking new discoveries and experiences.\n\nOne sunny morning, as Amelia was hiking up the mountain, she stumbled upon an old, dusty chest hidden beneath a moss-covered rock. With trembling excitement, she opened the chest and found a collection of ancient scrolls. As she unrolled one of them, her eyes widened with intrigue.\n\nThe scroll contained a complex mathematical problem, one that seemed to challenge the very limits of Amelia's problem-solving abilities. Determined to understand its significance, Amelia sat beneath a towering oak tree and began deciphering the problem.\n\nThe problem introduced the concept of \"Tribonacci numbers,\" a sequence similar to the well-known Fibonacci sequence but with a twist. It went on to define the \"Tribonacci modulus\" and explained how to calculate the remainder of dividing any tribonacci number by 107.\n\nAmelia's mind swirled with numbers and formulas, but she could not fathom their purpose. Little did she know that this mathematical problem held the key to unlocking incredible powers hidden deep within the mountain.\n\nDays turned into weeks as Amelia tirelessly grappled with the problem. She became so engrossed in her quest that she neglected her usual explorations and neglected to visit her friends in the village. Finally, after countless sleepless nights and tireless efforts, she made a breakthrough.\n\nAmelia discovered that the Tribonacci numbers formed a pattern when represented as vectors. Each pair of vectors, Vn and Wn, had their components defined by the Tribonacci modulus results. The problem introduced the concept of calculating the manhattan length of the vector D, measured by the sum of the absolute values of its components.\n\nThough she had made progress in deciphering the mathematical problem, Amelia still struggled to understand its purpose. She couldn't comprehend how these equations and calculations related to anything real or significant.\n\nBut as fate would have it, Amelia's moment of revelation was just around the corner. One afternoon, as she was exploring a hidden cave at the base of the mountain, she stumbled upon an ancient, stone altar. The moment she placed her hand on its cold surface, an intense surge of energy coursed through her veins.\n\nWith her newfound understanding of the mathematical problem, Amelia realized that the altar's power was somehow connected to the Tribonacci numbers. In a moment of daring, she applied the principles she had learned to harness the energy.\n\nAs she channeled the energy, the vibrant blue glow enveloped her entire body. The ground trembled beneath her, and the air crackled with electricity. The power of the Tribonacci sequence flowed through her, amplifying her strength and granting her abilities beyond her wildest dreams.\n\nAmelia had become a living embodiment of the mathematical problem. She could manipulate the energy, change its form, and endure its force. But even with her newfound powers, she still pondered the purpose behind it all.\n\nNow, standing atop the mountain, Amelia looks out into the horizon, her eyes filled with wonder and curiosity. As she gazes at the vast world before her, a question arises within her mind - a question that demands an answer only the reader can provide.\n\nWhat is the sum of S(n) from n = 1 to 120,000,000?"}, {"id": 514, "euler_id": 514, "title": "Geoboard Shapes", "problem": "A geoboard (of order N) is a square board with equally-spaced pins protruding from the surface, representing an integer point lattice for coordinates 0 \u2264 x,y \u2264 N.\nJohn begins with a pinless geoboard. Each position on the board is a hole that can be filled with a pin. John decides to generate a random integer between 1 and N+1 (inclusive) for each hole in the geoboard. If the random integer is equal to 1 for a given hole, then a pin is placed in that hole.\nAfter John is finished generating numbers for all (N+1)2 holes and placing any/all corresponding pins, he wraps a tight rubberband around the entire group of pins protruding from the board. Let S represent the shape that is formed. S can also be defined as the smallest convex shape that contains all the pins.\n\nThe above image depicts a sample layout for N = 4. The green markers indicate positions where pins have been placed, and the blue lines collectively represent the rubberband. For this particular arrangement, S has an area of 6. If there are fewer than three pins on the board (or if all pins are collinear), S can be assumed to have zero area.\nLet E(N) be the expected area of S given a geoboard of order N. For example, E(1) = 0.18750, E(2) = 0.94335, and E(10) = 55.03013 when rounded to five decimal places each.\nCalculate E(100) rounded to five decimal places.", "solution": "8986.86698", "difficulty": 90, "story": "Once upon a time in the small town of Numeria, there lived a curious young boy named John. John had always been fascinated by numbers and patterns, and he loved spending his days exploring the possibilities that mathematics had to offer.\n\nOne sunny afternoon, John stumbled upon an old dusty book in the town's library. As he blew off the dust and opened it, a page caught his eye. It depicted a geoboard, a square board with evenly spaced pins protruding from its surface, forming an integer point lattice. John's eyes widened with excitement as he read about the interesting concept of these pin-filled boards.\n\nDetermined to try it out for himself, John gathered some materials and created his own geoboard of order N, where N was equal to 4. He spent hours placing and arranging pins, each hole representing a random number between 1 and N+1. As he finished inserting the last pin and stepped back to admire his creation, a whimsical idea struck him.\n\nJohn reached into his bag and pulled out a long, tight rubber band. Carefully, he wrapped the rubber band around all the pins, creating a shape that snuggly enclosed them. It was fascinating to see how the rubber band effortlessly embraced the pins, forming the smallest convex shape that contained them all. John called this shape S.\n\nAs the afternoon turned into evening, John's mind wandered and he began to wonder about the properties of this peculiar shape he had created. Probing deeper into the mathematical problem, he discovered that the area of the shape S could be defined as the expected value, E(N), given a geoboard of order N.\n\nThe young boy's face lit up with excitement as he realized the significance of his discovery. But as night fell, he couldn't help but wonder what the expected area of his geoboard with N = 100 would be.\n\nEnthralled by this mathematical puzzle, John stayed up late into the night, contemplating the possibilities of what E(100) could be. He imagined all the potential shapes S that could emerge from such a large board, each with its own unique area. And as the hours ticked away, John found himself pondering the answer to his question:\n\nWhat would be the expected area of his geoboard of order N = 100 when rounded to five decimal places?\n\nAnd so, dear reader, with the story of John's geoboard and his burning question, I leave it to you to explore the depths of mathematical reasoning and solve this intriguing puzzle. Can you determine E(100)?"}, {"id": 541, "euler_id": 541, "title": "Divisibility of Harmonic Number Denominators", "problem": "The nthharmonic number Hn is defined as the sum of the multiplicative inverses of the first n positive integers, and can be written as a reduced fraction an/bn.\nHn=\u2211k=1n1k=anbn, with gcd(an,bn)=1.\nLet M(p) be the largest value of n such that bn is not divisible by p.\nFor example, M(3) = 68 because H68=a68b68=140940183219078279239542016112933773379069966367528193600, b68=2933773379069966367528193600 is not divisible by 3, but all larger harmonic numbers have denominators divisible by 3.\nYou are given M(7) = 719102.\nFind M(137).", "solution": "4580726482872451", "difficulty": 90, "story": "Once upon a time in the bustling town of Mathlandia, there lived a young and curious mathematician named Ethan. He had always been enamored by the mysterious beauty of numbers and was known for his insatiable thirst for mathematical challenges. Ethan spent his days wandering through the vibrant streets, occasionally getting lost in the enchanting depths of his mind, where numbers danced and equations twirled.\n\nOne sunny day, as Ethan was strolling past a bustling marketplace, he stumbled upon an old bookstore tucked away between two towering buildings. Intrigued by the aroma of ancient pages that wafted through the air, he felt an irresistible urge to explore. As he ventured inside, the creaking floors whispered stories of wisdom and the shelves were adorned with countless tomes.\n\nAmongst the dusty volumes, Ethan chanced upon a book with an intriguing title: \"The Enigma of Harmonic Numbers.\" He gently pulled the worn-out book from its resting place and gingerly blew away years of accumulated dust. Opening the yellowed pages, he discovered the enigmatic mathematical problem that would soon consume his every thought.\n\nThe problem described a sequence called the harmonic numbers, a sum of the multiplicative inverses of positive integers. Ethan was captivated by their peculiar nature and tried to comprehend the elaborate equations beautifully illustrated in the book. The puzzled mathematician read on as the problem revealed a function known as M(p), which defined the largest value of n such that the denominator of the corresponding harmonic number, bn, was not divisible by a prime number, p.\n\nEthan's eyes twinkled with excitement. His heart raced with the challenge, and he couldn't resist the urge to unravel the mystery. He understood that M(7) was equal to 719102, meaning that the largest value of n, where the denominator of the corresponding harmonic number was not divisible by 7, was 719102.\n\nAs the days turned into nights, Ethan immersed himself in studying the harmonic numbers. He jotted down ideas and strategies, relentlessly searching for a pattern that would help him solve the puzzle at hand. He consulted various mathematical texts, seeking guidance from the scholars who had come before him. But as the moon waxed and waned in the night sky, he discovered that the problem was more elusive than he ever imagined.\n\nEthan's obsession grew, and he couldn't bear the weight of the unsolved problem. It consumed his every waking moment, clouding his thoughts and causing him to lose sleep. His friends and family noticed a change in him, seeing his once-beaming smile replaced with a furrowed brow of worry.\n\nOne fateful evening, as Ethan wandered through Mathlandia's picturesque gardens, he stumbled upon an old mathematician. The elderly man had a wise and kind aura, as if he held the secrets of the universe in his wrinkled hands.\n\nIntrigued by Ethan's air of desperation, the old mathematician approached him, his eyes twinkling with curiosity. Ethan poured out his tale, his voice trembling with longing. He shared the details of the mathematical problem that had captured his spirit, yearning for a solution to detach him from the grip of uncertainty.\n\nThe old mathematician listened intently, his face a mask of serenity. After a moment of silence, he gazed deeply into Ethan's eyes and posed a question that encapsulated the essence of his struggle.\n\n\"Do you believe in the infinite possibilities numbers hold, young scholar? Do you believe that with patience and perseverance, you can defeat the enigma of M(137)?\"\n\nEthan felt a surge of hope resurge within him, ignited by the wise words of the old mathematician. With newfound determination, he embarked on a journey through the ever-expanding landscape of numbers, searching for the elusive solution that would pave the way to unraveling the mystery of M(137).\n\nAs the sun kissed the horizon, painting the sky in vibrant hues of oranges and purples, Ethan harnessed the strength he had gained. And with every step he took, he wondered, \"What is the value of M(137)? Can I find it? Can you?\""}, {"id": 544, "euler_id": 544, "title": "Chromatic Conundrum", "problem": "Let F(r,c,n) be the number of ways to colour a rectangular grid with r rows and c columns using at most n colours such that no two adjacent cells share the same colour. Cells that are diagonal to each other are not considered adjacent.\nFor example, F(2,2,3) = 18, F(2,2,20) = 130340, and F(3,4,6) = 102923670.\nLet S(r,c,n) = \u2211k=1n F(r,c,k).\nFor example, S(4,4,15) mod 109+7 = 325951319.\nFind S(9,10,1112131415) mod 109+7.", "solution": "640432376", "difficulty": 90, "story": "Once upon a time, in the peaceful kingdom of Arithmetopia, there was a young princess named Penelope. Penelope was known throughout the land for her adventurous spirit and love for all things mathematical. She would spend her days exploring the castle library, absorbed in books about numbers and formulas.\n\nOne bright morning, as Penelope was engrossed in a book titled \"The Colorful Chronicles of Arithmetopia,\" she stumbled upon a fascinating problem. It was a mathematical conundrum that intrigued her curious mind and captured her imagination. The problem was called \"The Enchanted Grid.\"\n\nAccording to the book, the Enchanted Grid was a rectangular pattern with various rows and columns. The challenge was to color this grid using a limited number of colors. However, there was a catch - no two adjacent cells could be the same color. The book even provided some examples and formulas to find the number of ways to color the grid under different conditions.\n\nPenelope's eyes sparkled with excitement as she realized that she held the key to unlocking the mystery of the Enchanted Grid. She knew that this mathematical problem could be the greatest adventure of her young life. The kingdom of Arithmetopia had encountered its fair share of problems, but this one had the potential to bring harmony and joy.\n\nDetermined to solve the Enchanted Grid problem, Penelope raced to her father's study. King Frederick was as wise as he was kind, and he was known for his ability to tackle life's most perplexing puzzles. Penelope explained the problem to her father, who listened intently.\n\n\"My dear Penelope, this is indeed a fascinating challenge,\" King Frederick said, his eyes twinkling with excitement. \"If we can find a solution, it could bring great prosperity to our kingdom.\"\n\nThe young princess and her father spent countless days and nights working side by side, unraveling the intricacies of the Enchanted Grid. They scribbled equations, delved deep into the realm of combinatorics, and explored various connections between the number of colors, the size of the grid, and the myriad of possibilities that lay within.\n\nAs they delved deeper into the problem, Penelope and King Frederick discovered the concept of S(r, c, n), the sum of all possible color combinations for a given grid size and maximum number of colors. They began to grasp the magnitude of this problem and its potential impact on their beloved kingdom.\n\nAs their research progressed, word of their quest spread like wildfire throughout Arithmetopia. People from far and wide came to offer assistance and marvel at the sheer brilliance of the mathematical problem at hand. Scholars, mathematicians, and even the local townsfolk joined forces, each bringing their unique perspective and expertise to the puzzle.\n\nMonths turned into years, and yet the solution to the Enchanted Grid remained elusive. Penelope and King Frederick found themselves on the brink of despair. The weight of expectation and the pressure to find a solution began to take its toll on their spirits.\n\nBut one fateful evening, as Penelope was gazing at the stars from her bedroom window, a glimmer of hope stirred within her heart. She realized that the Enchanted Grid was not just a mathematical problem; it mirrored the challenges of everyday life. It represented the interconnectedness of people, the need for harmony, and the beauty of diversity.\n\nWith newfound determination, Penelope gathered the people of Arithmetopia and made an important announcement. \"My friends,\" she said with conviction, \"We may not have found the solution to the Enchanted Grid, but in our quest, we have discovered something greater. We have learned the power of unity, the strength in collaboration, and the importance of embracing our differences.\"\n\nThe announcement touched the hearts of every person present. There was a renewed sense of purpose and a shared belief that their efforts were not in vain. People from all walks of life came forward, determined to ensure that the kingdom of Arithmetopia thrived, regardless of the unsolved mathematical problem.\n\nAnd so, my dear reader, I pose a question to you. Can you solve the Enchanted Grid and reveal the mythical number, S(9, 10, 1112131415) mod 109+7? Can you uncover the secrets of the mathematical kingdom of Arithmetopia and bring solace to the princess and her people?"}, {"id": 636, "euler_id": 636, "title": "Restricted Factorisations", "problem": "Consider writing a natural number as product of powers of natural numbers with given exponents, additionally requiring different base numbers for each power.\nFor example, 256 can be written as a product of a square and a fourth power in three ways such that the base numbers are different.\nThat is, 256=12\u00d744=42\u00d724=162\u00d714\nThough 42 and 24 are both equal, we are concerned only about the base numbers in this problem. Note that permutations are not considered distinct, for example 162\u00d714 and 14\u00d7162 are considered to be the same.\nSimilarly, 10! can be written as a product of one natural number, two squares and three cubes in two ways (10!=42\u00d752\u00d742\u00d733\u00d723\u00d713=21\u00d752\u00d722\u00d743\u00d733\u00d713) whereas 20! can be given the same representation in 41680 ways.\nLet F(n) denote the number of ways in which n can be written as a product of one natural number, two squares, three cubes and four fourth powers.\nYou are given that F(25!)=4933, F(100!)mod1000000007=693952493,\nand F(1000!)mod1000000007=6364496.\nFind F(1000000!)mod1000000007.", "solution": "888316", "difficulty": 90, "story": "Once upon a time, in the vibrant kingdom of Arithmagia, there lived a young prince named Leon. Leon was a bright and curious lad, always seeking the answers to life's mysteries. His father, the wise King Albus, knew of his son's insatiable appetite for knowledge and often sent him on quests to explore the world beyond the kingdom's borders.\n\nOne sunny morning, as Leon sat in the royal library perusing ancient tomes, he stumbled upon an intriguing mathematical problem. It was a conundrum that fascinated him - a quest for the number of ways in which a natural number could be expressed as a product of different base numbers and exponents. Eager to solve the enigma, Leon embarked on a journey to seek answers from the wisest mathematicians across the land.\n\nHis first stop was the renowned Mathematician's Guild, where scholars discussed complex equations and theories. Leon eagerly approached an elderly mathematician named Professor Archimedes and laid out the problem before him. Professor Archimedes listened intently, stroking his long, gray beard in thought.\n\n\"My dear Prince,\" the professor began, \"this is no ordinary problem. It requires great skill and a deep understanding of number theory. The solutions lie hidden within the realms of factorials and exponentiation.\"\n\nCuriosity piqued, Leon pressed further, \"But how does one approach such a problem, Professor?\"\n\nThe wise professor smiled, his eyes twinkling with knowledge. \"Consider the factorial - the product of all positive integers up to a given number. We can express it as a product of one natural number, two squares, three cubes, and four fourth powers. The challenge lies in finding the number of distinct ways to do so.\"\n\nLeon's mind buzzed with possibilities as he absorbed the professor's explanation. The problem was intricate, and he knew that finding the solution would not be easy. But he was determined to try.\n\nDays turned into weeks, and weeks into months as Leon traversed the kingdom, seeking wisdom from every corner. He visited ancient monasteries, where sages meditated on the mysteries of numbers. He ventured into bustling marketplaces, consulting with passionate merchants who saw patterns in equations. And he even sought advice from magical creatures who dwelled in the enchanted forests, for they too held ancient wisdom.\n\nAfter years of tireless pursuit, Leon returned to the kingdom of Arithmagia, his heart filled with newfound knowledge. He sat down with King Albus in the grand chamber and shared his discoveries.\n\n\"Father, I have learned so much on my quest,\" Leon said, excitement lacing his voice. \"I have counted, calculated, and pondered endlessly. The answer to our mathematical problem is a triumph of numbers.\"\n\nKing Albus listened intently, his eyes filled with pride for his son's tenacity and determination.\n\nLeon took a deep breath, ready to reveal the fruits of his labor. \"Father, I have discovered that F(25!) is equal to 4933. Furthermore, F(100!) mod 1000000007 is 693952493, and F(1000!) mod 1000000007 is 6364496.\"\n\nKing Albus, a man of wisdom and knowledge himself, nodded, acknowledging his son's accomplishment. \"You have done well, my son. But tell me, the most crucial part of this journey lies ahead - the final piece of the puzzle. What, pray tell, is F(1000000!) mod 1000000007?\"\n\nAs the question hung in the air, the room fell silent. Both father and son knew that the answer to this question would bring the ultimate revelation - the culmination of Leon's quest.\n\nAnd so, the story pauses, leaving us with the same question - what is F(1000000!) mod 1000000007? A mathematical puzzle awaits to be solved, with the hopes that someday, a worthy soul would discover the elusive answer.\n\nCan you, dear reader, unlock the mystery and find F(1000000!) mod 1000000007?"}, {"id": 644, "euler_id": 644, "title": "Squares on the line", "problem": "Sam and Tom are trying a game of (partially) covering a given line segment of length L by taking turns in placing unit squares onto the line segment. \nAs illustrated below, the squares may be positioned in two different ways, either \"straight\" by placing the midpoints of two opposite sides on the line segment, or \"diagonal\" by placing two opposite corners on the line segment. Newly placed squares may touch other squares, but are not allowed to overlap any other square laid down before.\nThe player who is able to place the last unit square onto the line segment wins.\n\n\n\nWith Sam starting each game by placing the first square, they quickly realise that Sam can easily win every time by placing the first square in the middle of the line segment, making the game boring. \n\nTherefore they decide to randomise Sam's first move, by first tossing a fair coin to determine whether the square will be placed straight or diagonal onto the line segment and then choosing the actual position on the line segment randomly with all possible positions being equally likely. Sam's gain of the game is defined to be 0 if he loses the game and L if he wins. Assuming optimal play of both players after Sam's initial move, you can see that Sam's expected gain, called e(L), is only dependent on the length of the line segment.\n\nFor example, if L=2, Sam will win with a probability of 1, so e(2)=2. \nChoosing L=4, the winning probability will be 0.33333333 for the straight case and 0.22654092 for the diagonal case, leading to e(4)=1.11974851 (rounded to 8 digits after the decimal point each). \n\nBeing interested in the optimal value of L for Sam, let's define f(a,b) to be the maximum of e(L) for some L\u2208[a,b]. \nYou are given f(2,10)=2.61969775, being reached for L=7.82842712, and f(10,20)=5.99374121 (rounded to 8 digits each).\n\nFind f(200,500), rounded to 8 digits after the decimal point.", "solution": "20.11208767", "difficulty": 90, "story": "Once upon a time, in the quaint village of Numeria, two young friends named Sam and Tom had an insatiable appetite for games and puzzles. Their favorite game was one that they had invented themselves, which involved placing unit squares on a line segment. It was a race to see who could place the last square on the line segment, and the winner would be crowned the ultimate champion.\n\nHowever, as much as Sam and Tom enjoyed their game, they quickly realized that it was becoming a bit predictable. Sam always won because he had discovered a foolproof strategy \u2013 he would start by placing the first square in the middle of the line segment. This made it nearly impossible for Tom to win.\n\nDetermined to make the game more exciting, Sam and Tom decided to introduce an element of randomness. They devised a plan to flip a coin to determine whether the square would be placed straight or diagonally on the line segment. Then, they would randomly choose the actual position from the available options. This added a level of unpredictability to the game, making it more challenging for both players.\n\nBut Sam's curious mind couldn't help but ponder the outcome of each game. He wondered, if they played this modified version of the game many times, what would be his average gain? Would it be different from when he placed the first square in the middle of the line segment every time?\n\nTo satisfy his curiosity, Sam set out on a quest to calculate his expected gain, which he denoted as e(L), with L being the length of the line segment. He realized that his expected gain depended solely on the length of the line segment and not his strategy.\n\nSam sat in his room, surrounded by piles of paper filled with equations and calculations. He spent countless hours analyzing the probabilities and outcomes, trying to find a pattern. He found that for smaller values of L, his winning probability was higher, whereas for larger values, it decreased.\n\nHowever, he wondered, what would be the maximum expected gain for a range of line segment lengths? He decided to define f(a,b) as the maximum expected gain for some L within the range of [a,b]. It was an optimization problem that intrigued him. Sam knew that finding the solution to this problem would uncover the optimal value of L for him to strive for.\n\nAs he delved deeper into his calculations, Sam discovered that f(2,10) was equal to 2.61969775, achieved when L was approximately 7.82842712. This insight thrilled him, as it proved that his modified strategy could indeed yield a higher expected gain.\n\nBut Sam was not satisfied. His quest for knowledge pushed him further. He went on to discover that f(10,20) was 5.99374121, rounded to 8 decimal places. The optimal value of L within this range was around 16.59794325.\n\nNow, Sam's curiosity knew no bounds. He had unlocked the secrets of these smaller ranges, but his hunger for knowledge grew. He set his sights on a bigger challenge \u2013 finding f(200,500). He was determined to determine the maximum expected gain for a line segment length within this range.\n\nAnd so, Sam continued his mathematical exploration, diving deeper into the realm of probabilities and optimizations. He sought to understand the intricacies of the game, to unravel its hidden patterns, and to unlock the answer that lay within the vastness of numbers.\n\nBut as Sam immersed himself in his calculations, he couldn't help but wonder if he was missing something. Perhaps there was a different approach, a shortcut that would lead him to the solution he sought. With every passing day, his determination grew stronger, and his mind buzzed with questions.\n\nCan you help Sam in his quest for the optimal value of f(200,500)? Can you uncover the maximum expected gain, rounded to 8 decimal places, for a line segment length within this range?\n\nAs Sam's journey continues, the answers await, hidden within the realm of numbers. Will you be the one to solve the mathematical problem and guide Sam to his ultimate victory?"}, {"id": 677, "euler_id": 677, "title": "Coloured Graphs", "problem": "Let g(n) be the number of undirected graphs with n nodes satisfying the following properties:\nThe graph is connected and has no cycles or multiple edges.\nEach node is either red, blue, or yellow.\nA red node may have no more than 4 edges connected to it.\nA blue or yellow node may have no more than 3 edges connected to it.\nAn edge may not directly connect a yellow node to a yellow node.\nFor example, g(2)=5, g(3)=15, and g(4)=57.\nYou are also given that g(10)=710249 and g(100)\u2261919747298(mod1000000007).\nFind g(10000)mod1000000007.", "solution": "984183023", "difficulty": 90, "story": "Once upon a time, in a quaint little town called Graphville, there lived three neighbors - Mr. Red, Mrs. Blue, and Mr. Yellow. Each neighbor had their unique way of looking at the world, and their paths only intersected within the realm of numbers and colors. Little did they know that their lives were about to take an unexpected turn when they stumbled upon a fascinating mathematical problem.\n\nMr. Red was a passionate mathematician who admired orderly patterns in life. He spent most of his time in his cozy study, surrounded by countless books and equations. One gloomy evening, while deep into his latest mathematical endeavor, he discovered an intriguing problem written in an old journal \u2013 it involved graphs and colors.\n\nAs Mr. Red mulled over the problem, he realized that it perfectly mirrored the dynamics of his neighborhood. The graphs represented the connections between houses, with nodes symbolizing the neighbors, and the colors depicting their unique identities. He couldn't help but find himself at the mercy of curiosity and started to wonder, \"How many ways can these properties align?\"\n\nMeanwhile, just a stone's throw away, lived Mrs. Blue, an artist who saw beauty in everything around her. She painted vibrant landscapes and drew inspiration from the kaleidoscope of colors that adorned the town. One sunny morning, as she picked up her paintbrush and looked out her window, she noticed an odd pattern. There were exactly three neighboring houses, each painted in different shades of blue, yellow, and red. The peculiarities of these homes filled her with inspiration, and she thought, \"How many variations of these connections exist?\"\n\nOn the other end of Graphville, resided Mr. Yellow, an adventurous spirit who loved exploring the mysteries of the world. He spent endless hours hiking through the lush green hills surrounding the town, taking in the beauty of nature. One serene afternoon, while perched on a hilltop overlooking Graphville, he spotted several paths twisting and turning, sometimes intersecting, leading to different homes. His inquisitive mind immediately sparked with curiosity, and he pondered, \"How many ways can these paths intertwine without forming a cycle?\"\n\nAs the days turned into weeks, Mr. Red, Mrs. Blue, and Mr. Yellow couldn't escape the mysterious mathematical problem that encapsulated their world. They found themselves compelled to find the answer together, as if their unique perspectives could draw them closer to the solution.\n\nUnited by their shared curiosity, they embarked on a journey, exploring the vast world of connected graphs and colors, finding solace in numbers and visualizing all the possible combinations. Their lives became intertwined with this captivating problem as they unraveled its intricacies, eagerly awaiting the moment when everything would come together.\n\nAnd so, as their journey continues, dear reader, we leave you with one crucial question \u2013 \"Can you calculate g(10000)mod1000000007?\""}, {"id": 761, "euler_id": 761, "title": "Runner and Swimmer", "problem": "Two friends, a runner and a swimmer, are playing a sporting game: The swimmer is swimming within a circular pool while the runner moves along the pool edge.\nWhile the runner tries to catch the swimmer at the very moment that the swimmer leaves the pool, the swimmer tries to reach the edge before the runner arrives there. They start the game with the swimmer located in the middle of the pool, while the runner is located anywhere at the edge of the pool.\nWe assume that the swimmer can move with any velocity up to 1 in any direction and the runner can move with any velocity up to v in either direction around the edge of the pool. Moreover we assume that both players can react immediately to any change of movement of their opponent.\nAssuming optimal strategy of both players, it can be shown that the swimmer can always win by escaping the pool at some point at the edge before the runner gets there, if v is less than the critical speed VCircle\u22484.60333885 and can never win if v>VCircle.\nNow the two players play the game in a perfectly square pool. Again the swimmer starts in the middle of the pool, while the runner starts at the midpoint of one of the edges of the pool. It can be shown that the critical maximal speed of the runner below which the swimmer can always escape and above which the runner can always catch the swimmer when trying to leave the pool is VSquare\u22485.78859314.\nAt last, both players decide to play the game in a pool in the form of regular hexagon. Giving the same conditions as above, with the swimmer starting in the middle of the pool and the runner at the midpoint of one of the edges of the pool, find the critical maximal speed VHexagon of the runner, below which the swimmer can always escape and above which the runner can always catch the swimmer.\nGive your answer rounded to 8 digits after the decimal point.", "solution": "5.05505046", "difficulty": 90, "story": "Once upon a time, there were two friends named Lily and Sam. Lily was a talented runner, while Sam excelled in swimming. They were both passionate about sports and loved challenging each other to friendly competitions.\n\nOne sunny day, Lily and Sam decided to play a special sporting game. They found themselves in a beautiful park that had a circular pool in the middle. The pool was filled with crystal-clear water, sparkling under the warm sunlight.\n\nLily, being the swift runner that she was, chose to chase Sam, the skilled swimmer. They agreed to start the game with Sam in the middle of the pool, while Lily could position herself anywhere along the edge of the circular pool.\n\nLily knew that to catch Sam, she needed to be at the edge of the pool at the exact moment he left the water. Sam, on the other hand, aimed to reach the edge of the pool before Lily could arrive there.\n\nThey pondered over their optimal strategies. Sam knew that he could swim with a velocity of up to 1 in any direction, while Lily could move with any velocity up to v around the pool edge. They were both quick thinkers and could react instantly to their opponent's movements.\n\nWith their strategies in mind, they began the game. Sam plunged into the water, slicing through the surface with precision and grace. Meanwhile, Lily darted around the circular pool, her feet hardly making a sound as she raced against time.\n\nLily had to consider the critical speed, VCircle, which determined her chances of catching Sam. If her chosen velocity, v, was less than VCircle, she had a chance to emerge victorious. On the other hand, if v was greater than VCircle, Sam would inevitably outmaneuver her.\n\nThe game continued for hours as Lily and Sam pushed themselves to their limits. Their bodies moved in perfect synchrony, each calculating their next move based on the other's actions. Lily could sense the water ripples behind her, an indication of Sam's proximity.\n\nBut there was more to this game than mere competition. As they raced against each other, their friendship grew stronger. They marveled at each other's skills and were inspired by their unwavering determination. It was a battle of wits and strength, but it was also a testament to the power of camaraderie.\n\nAfter several exhilarating rounds, they decided to take their game to the next level. They found themselves in another part of the park, this time facing a perfectly square pool. Again, Sam positioned himself in the middle, while Lily stood at the midpoint of one of the edges of the pool.\n\nIn this new setting, they discovered a different critical speed, VSquare. This determined whether Lily could escape or be caught by Sam as she tried to leave the pool. Her victory depended on Lily's velocity, v, compared to the critical speed VSquare.\n\nThe game intensified as they sprinted around the square pool, their efforts amplified by the challenge they faced. Lily's determination to win burned brighter than ever, and Sam's competitive spirit soared. Though they knew they were opponents in the game, their bond only grew stronger.\n\nWith each victory and defeat, Lily and Sam expanded their horizons, both in sports and in life. They had shared countless adventures, but there was still one challenge left to conquer\u2014the final test in the form of a regular hexagon pool.\n\nAs they stood once more at the starting positions, Lily in the middle and Sam at the midpoint of an edge, their minds buzzed with anticipation. What would the critical maximal speed, VHexagon, be in this new and intricate shape?\n\nCuriosity blended with excitement as they set their sights on this last game. The question now hung in the air, begging to be answered. What was VHexagon? Which one of them would emerge victorious, breaking the boundaries of what seemed possible?\n\nAnd so, with anticipation flickering in their eyes, Lily and Sam prepared to embark on their most remarkable challenge yet. Only one question remained:\n\nCan you find the critical maximal speed, VHexagon, and determine who will come out on top in this final battle of speed and strategy?"}, {"id": 769, "euler_id": 769, "title": "Binary Quadratic Form II", "problem": "Consider the following binary quadratic form:\nf(x,y)=x2+5xy+3y2\nA positive integer q has a primitive representation if there exist positive integers x and y such that q=f(x,y) and gcd(x,y)=1.\nWe are interested in primitive representations of perfect squares. For example:\n172=f(1,9)\n872=f(13,40)=f(46,19)\nDefine C(N) as the total number of primitive representations of z2 for 0<z\u2264N. \nMultiple representations are counted separately, so for example z=87 is counted twice.\nYou are given C(103)=142 and C(106)=142463 \nFind C(1014).", "solution": "14246712611506", "difficulty": 90, "story": "Once upon a time, in the land of Numerica, there lived a young mathematician named Emma. Emma had a deep love for numbers, patterns, and the magical world of mathematics. Her days were spent exploring the mysteries of algebra, geometry, and calculus, always seeking to unravel their secrets.\n\nOne sunny afternoon, Emma received a letter from the Grand Mathemagician, a venerable old man known for his vast knowledge and mystical abilities. The letter contained a perplexing mathematical problem that piqued Emma's curiosity.\n\n\"The Grand Mathemagician wants me to find the total number of primitive representations of perfect squares,\" Emma said aloud, scratching her head. \"I suppose it's time to put my skills to the test.\"\n\nWith keen determination, Emma began to study the problem, diving deep into the realm of binary quadratic forms. She saw the equation f(x,y) = x\u00b2 + 5xy + 3y\u00b2 and marveled at its complexity. The presence of the gcd(x,y) = 1 condition intrigued her, knowing that this criterion was crucial for the representations to be considered primitive.\n\nAs Emma delved further into her research, she unearthed various examples. One perfect square, 172, had a primitive representation as f(1,9), and another, 872, had two primitive representations as f(13,40) and f(46,19). Each time she discovered a new primitive representation, her fascination grew.\n\nDays turned into weeks, and weeks into months, but Emma's determination remained unwavering. She tirelessly searched for more primitive representations, tirelessly counting each unique instance. Her efforts paid off, as she successfully determined that C(103) equaled 142 and C(106) amounted to 142,463. But just as she thought she had conquered the problem, a new challenge presented itself before her: find C(1014).\n\nEmma could not fathom the sheer magnitude of this task. How many more primitive representations did she need to uncover to solve this puzzle? It seemed impossible, unfathomable even for a mathematician as skilled as herself.\n\nAs Emma pondered the problem, a spark of inspiration ignited within her. She realized that this was not merely an exercise in number theory but a real-world application. The quest to find C(1014) held immense importance beyond its mathematical intrigue.\n\nWith renewed determination, Emma embarked on her quest, determined to solve the riddle. But that remains the question: Can you find a way to calculate C(1014)? Can you discover the total number of primitive representations of perfect squares between 1 and 1014?\n\nAs the curtains close on Emma's story, her journey becomes your own. The fate of Numerica rests in your hands. Will you unveil the answer and unlock the secrets of binary quadratic forms?"}, {"id": 774, "euler_id": 774, "title": "Conjunctive Sequences", "problem": "Let '&' denote the bitwise AND operation.\nFor example, 10&12=10102&11002=10002=8.\nWe shall call a finite sequence of non-negative integers (a1,a2,\u2026,an) conjunctive if ai&ai+1\u22600 for all i=1\u2026n\u22121.\nDefine c(n,b) to be the number of conjunctive sequences of length n in which all terms are \u2264b.\nYou are given that c(3,4)=18, c(10,6)=2496120, and c(100,200)\u2261268159379(mod998244353).\nFind c(123,123456789). Give your answer modulo 998244353.", "solution": "459155763", "difficulty": 90, "story": "In a quaint village nestled deep within the forest, lived a young orphan named Milo. Milo had always been fascinated by the mysterious power of numbers, even if they were difficult to grasp at times. He would spend countless hours at the library, poring over ancient texts on mathematics, seeking solace in the complexity of equations and formulas.\n\nOne fateful afternoon, while deep in his studies, Milo stumbled upon a faded parchment hidden beneath a stack of dusty tomes. The parchment bore a peculiar inscription that he had never seen before. It read:\n\n\"Let '&' denote the bitwise AND operation. For example, 10&12=10. We shall call a finite sequence of non-negative integers (a1, a2, ... , an) conjunctive if ai&ai+1\u22600 for all i=1...n\u22121. Define c(n, b) to be the number of conjunctive sequences of length n in which all terms are \u2264 b. You are given that c(3,4)=18, c(10,6)=2496120, and c(100,200) (mod 998244353). Find c(123,123456789). Give your answer modulo 998244353.\"\n\nMilo was both puzzled and intrigued. Although the meaning behind those symbols and equations eluded him, he recognized the signs of something significant. With a renewed sense of purpose, he embarked on a quest to uncover the enigma hidden within the mathematical problem.\n\nAs Milo delved deeper into the world of numbers and bitwise operations, he discovered an ancient artifact that held the key to unlocking the secrets of conjunctive sequences. The artifact, known as the Crystal of Conjunctions, was said to possess unimaginable power. Legends whispered that whoever solved the mathematical problem inscribed upon it would become the master of all numbers, able to reshape reality itself.\n\nDriven by both curiosity and a desire for answers, Milo journeyed to the distant Tower of Equations, where the Crystal was said to reside. It was a perilous path, fraught with obstacles and challenges. But Milo's determination was unwavering, and he pressed on, solving riddles and equations along the way.\n\nFinally, after weeks of arduous travel, Milo stood before the towering gates of the Tower. The air crackled with an electric current, and he could sense the presence of the Crystal within. But the gates were sealed shut, seemingly impenetrable.\n\nThinking back to the mathematical problem that had set him on this extraordinary journey, Milo realized its significance. The solution held the key to opening the gates, allowing him to access the Crystal of Conjunctions. Determined to prove his worth, Milo furrowed his brow and began calculating.\n\nHours turned into days as Milo feverishly attempted to crack the code. The numbers danced before his weary eyes, and the magnitude of the task threatened to overwhelm him. But within the depths of his exhaustion, a spark of inspiration ignited.\n\nPiece by piece, Milo formed the puzzle, his mind racing with countless calculations and iterations. With every answer he obtained, a glimmer of hope shone brighter. Finally, as dawn broke on the last day, a eureka moment struck him like lightning.\n\nThe gates of the Tower groaned and creaked as Milo's solution reverberated through the air. Slowly but surely, the formidable barriers yielded, allowing him access to the Crystal of Conjunctions.\n\nAs he stepped into the chamber, Milo's eyes widened in awe. The Crystal hovered in the center, emanating an ethereal glow. Its power pulsed through the room, whispering melodies of infinite possibilities.\n\nBut as Milo reached out to touch it, a voice echoed within his mind, challenging him with a final test. \"Can you solve c(123,123456789) modulo 998244353? Can you decipher the essence of conjunctive sequences and comprehend their boundless nature?\"\n\nThe question hung in the air, filling Milo's heart with both trepidation and excitement. The answer held the secrets to the Crystal's true power, the key to unlocking its limitless potential. And so, with determination burning in his eyes, Milo took a deep breath and began to calculate, his fingers tracing the invisible pathways of numbers.\n\n___\n\nCan you solve c(123,123456789) modulo 998244353, and unravel the mysteries of the Crystal of Conjunctions? The fate of Milo and the world of numbers lies in your hands."}, {"id": 807, "euler_id": 807, "title": "Loops of Ropes", "problem": "Given a circle C and an integer n>1, we perform the following operations.\nIn step 0, we choose two uniformly random points R0 and B0 on C.\nIn step i (1\u2264i<n), we first choose a uniformly random point Ri on C and connect the points Ri\u22121 and Ri with a red rope; then choose a uniformly random point Bi on C and connect the points Bi\u22121 and Bi with a blue rope.\nIn step n, we first connect the points Rn\u22121 and R0 with a red rope; then connect the points Bn\u22121 and B0 with a blue rope.\nEach rope is straight between its two end points, and lies above all previous ropes.\nAfter step n, we get a loop of red ropes, and a loop of blue ropes.\nSometimes the two loops can be separated, as in the left figure below; sometimes they are \"linked\", hence cannot be separated, as in the middle and right figures below.\n\n\n\nLet P(n) be the probability that the two loops can be separated.\nFor example, P(3)=1120 and P(5)\u22480.4304177690.\nFind P(80), rounded to 10 digits after decimal point.", "solution": "0.1091523673", "difficulty": 90, "story": "Once upon a time in a quaint town, there lived a young girl named Lily. Lily was known for her voracious appetite for knowledge, constantly seeking answers to the mysteries of the world. Mathematics was her favorite subject, and she found solace in the complexities of numbers and shapes.\n\nOne sunny day, as Lily sat on the porch of her house, a gentle breeze rustled through her hair, carrying with it a delicate envelope. Curiosity ignited in her eyes as she glanced around, seeing no one nearby. She picked up the envelope and carefully opened it to find an intriguing mathematical problem written on a piece of parchment.\n\nThe problem, as outlined in the letter, promised an alluring enigma. It spoke of a circle, which Lily visualized as a never-ending loop, and a mysterious pattern that involved connecting points on this circle with ropes. These ropes, she learned, could sometimes intertwine in a way that separated the loop, while at other times, they became linked, unable to be untangled.\n\nIntrigued by the puzzle, Lily's mind raced with possibilities. She began to ponder the significance of loops and separations, seeking to make sense of the mathematical problem while she continued reading on.\n\nAs she intently followed the instructions, her mind began to wander, imagining a grand adventure unfolding before her very eyes. In her vivid daydream, she was transported to a magical land, where circles dotted the landscape, each holding its own secrets and mysteries.\n\nLily found herself in the heart of this enchanting realm, facing a colossal circle. It stood tall, imposing yet inviting. Determined to unravel this mathematical conundrum, she reached into her bag, pulling out a red rope and a blue rope. With each step she took, the ropes unfurled behind her, leaving behind a colorful trail.\n\nAs Lily moved around the circumference of the circle, she made sure to take precise measurements, ensuring each point she chose was truly random. She marveled at the way the ropes formed arcs and lines, tracing a mesmerizing pattern on the canvas of the circle.\n\nSoon, she completed her final connection, joining the last point of the red rope to where she had begun, followed by the final connection of the blue rope. The vibrant loops were finally formed, their colors intertwining and dancing in the light.\n\nLily stepped back and took in the sight before her. The loops gleamed, suspended perfectly above the ground, as if the ropes possessed a magnetic force. With bated breath, she tried to find a way to separate the loops, testing the limits of her mathematical knowledge.\n\nHer heart sank as she realized that the loops were undeniably linked, one rope intertwining with the other in an intricate embrace. The more she tugged and pulled, the tighter they became, like an unbreakable bond that defied her efforts.\n\nHer mind puzzled over how the probability of the loops separating could be calculated. She understood the potential complexities involved but was determined to find the solution. She knew that finding P(80) would hold the key to unlocking the secrets of this mesmerizing loop.\n\nTorn from her daydream, Lily snapped back to reality, still clutching the letter in her hand. She glanced at the nuances of the problem, pondering the path she should take. Determined to unveil the answer to P(80) but armed with only her wits and imagination, she embarked on a mathematical journey that would test the boundaries of her knowledge.\n\nAs Lily delved deeper into her calculations, the world around her seemed to blur, slowly fading into a realm where numbers and shapes danced together. The outcome of the story remained uncertain, hanging in the balance like the intertwining ropes. Only time and Lily's mathematical prowess would dictate what fate awaited her.\n\nThe question now lay before you, dear reader: Can you find P(80), rounded to 10 digits after the decimal point? Can you crack the code that eluded even Lily, the young prodigy? As the story ends and the numbers await your scrutiny, the puzzle is yours to solve. The answer lies at the intersection of imagination and logic, waiting to be discovered. Can you be the one to unlock the enigma of the linked loops?"}]