[{"id": 51, "euler_id": 51, "title": "Prime digit replacements", "problem": "By replacing the 1st digit of the 2-digit number *3, it turns out that six of the nine possible values: 13, 23, 43, 53, 73, and 83, are all prime.\nBy replacing the 3rd and 4th digits of 56**3 with the same digit, this 5-digit number is the first example having seven primes among the ten generated numbers, yielding the family: 56003, 56113, 56333, 56443, 56663, 56773, and 56993. Consequently 56003, being the first member of this family, is the smallest prime with this property.\nFind the smallest prime which, by replacing part of the number (not necessarily adjacent digits) with the same digit, is part of an eight prime value family.", "solution": "121313", "difficulty": 15, "story": "In a small, sleepy town named Numeria, lived a brilliant and curious mathematician named Alice. Her days were spent poring over complex equations and challenging mathematical problems. One day, while she was engrossed in her work, an enigmatic letter arrived at her door.\n\nEagerly, Alice tore open the envelope, revealing a cryptic message inside. It read, \"Dear Alice, the key to unlocking the greatest mathematical mystery lies within your grasp. Solve this puzzle, and you shall uncover the secret of a prime family.\"\n\nIntrigued, Alice carefully read the mathematical problem enclosed in the letter. Her eyes lit up with excitement as she delved into its complexities. She could already envision herself solving the intricate puzzle and unearthing the hidden truth.\n\nAs days turned into nights, Alice tirelessly worked to crack the mathematical problem. She scribbled countless calculations, tested various combinations, and sometimes even dreamed about the elusive solution. The townsfolk wondered what had captured her fascination, but they couldn't comprehend the allure of numbers like Alice did.\n\nOne afternoon, as Alice sat cross-legged in her study, surrounded by stacks of papers, she experienced a breakthrough. The pieces fell into place, and the answer to the first part of the problem revealed itself. She realized that by replacing the first digit of a two-digit number with a specific value, certain primes emerged.\n\nAlice's discovery set her imagination ablaze. She envisioned a world where numbers danced and revealed secrets to those who dared to listen. This newfound knowledge, she thought, might have profound implications for cryptographers, number theorists, and even in the broader field of mathematics as a whole.\n\nDespite her excitement, Alice faced another challenge - the second part of the mathematical problem. She had to find a five-digit number that, by replacing the third and fourth digits, formed a prime value family. Seven out of ten generated numbers had to be prime, making it a rare occurrence indeed.\n\nDays turned into weeks, and Alice toiled, determined to solve this ultimate mystery. She meticulously examined every digit, every prime number, and every possible combination. The townsfolk kept their distance; captivated by her unwavering pursuit, they anxiously awaited her triumphant moment.\n\nLate one evening, as Alice was on the brink of giving up, she stumbled upon a sequence that seemed promising. She replaced the third and fourth digits of a five-digit number with the same value. To her surprise, this led to seven prime numbers in the ten generated values. A surge of adrenaline coursed through her veins as she realized she might be on the verge of unlocking the grand secret.\n\nAs she pondered her breakthrough, Alice felt her heart pound against her chest. A question burned within her: Why did the number 56003, the first member of the prime family, possess such unique properties? Was there a pattern to uncover? Could this be the key to revealing a larger, eight prime value family?\n\nCuriosity and determination propelled Alice forward. With the power of numbers and her unwavering intellect, she believed that she could conquer even the most enigmatic riddles. She knew the journey would be arduous, but as she stared at her papers covered in equations, she couldn't help but wonder: What is the smallest prime number that, by replacing part of its digits, would be part of an eight prime value family?\n\nThe answer to this inquiry lingered in the air, awaiting the next chapter of Alice's mathematical odyssey. The townsfolk, too, were captivated by this tantalizing mystery, eagerly watching as Alice embarked on the hunt for the solution to the grand mathematical problem.\n\nAnd so, dear reader, the question remains: Can you find the smallest prime which, by replacing part of the number, becomes part of an eight prime value family?"}, {"id": 62, "euler_id": 62, "title": "Cubic permutations", "problem": "The cube, 41063625 (3453), can be permuted to produce two other cubes: 56623104 (3843) and 66430125 (4053). In fact, 41063625 is the smallest cube which has exactly three permutations of its digits which are also cube.\nFind the smallest cube for which exactly five permutations of its digits are cube.", "solution": "127035954683", "difficulty": 15, "story": "Once upon a time in the picturesque town of Numerville, there lived a brilliant mathematician named Professor Ethan Mathison. Known for his uncanny ability to unravel the mysteries of numbers, Professor Mathison spent his days immersed in equations and mathematical conundrums.\n\nOne fine summer day, as Professor Mathison was strolling through the local park, he stumbled upon a peculiar puzzle inscribed on an old piece of parchment. The puzzle intrigued him, for it promised to challenge even the greatest mathematical minds. The puzzle read:\n\n\"The cube, 41063625 (3453), can be permuted to produce two other cubes: 56623104 (3843) and 66430125 (4053). In fact, 41063625 is the smallest cube which has exactly three permutations of its digits that are also cubes. Find the smallest cube for which exactly five permutations of its digits are cube.\"\n\nEager to unravel the secrets hidden within this cryptic message, Professor Mathison decided to investigate the puzzling case. He retreated to his cozy study, filled with shelves upon shelves of books on number theory.\n\nAs he delved deeper into the problem, his mind reveled in the possibilities and complexities that awaited him. Professor Mathison recognized the significance of the cubes, the rare phenomenon of permutations, and the extraordinary challenge that lay ahead.\n\nWhile the townsfolk spent their evenings immersed in day-to-day trivialities, Professor Mathison ventured into the depths of mathematics, desperately seeking enlightenment. He spent hours hunched over dusty manuscripts, focused on cracking the enigma before him.\n\nDays turned into weeks, and weeks turned into months. The challenge consumed Professor Mathison, yet he refused to give in to frustration. The townsfolk began to notice his solitary existence, whispering rumors among themselves. Some believed he had gone mad, while others were convinced he had discovered a groundbreaking mathematical theorem.\n\nOne fateful evening, as the sun began its descent, casting an orange hue across the sky, Professor Mathison entered a deep state of contemplation. His heart raced, and a spark of inspiration ignited within him. With trembling hands, he began scribbling furiously on a piece of parchment.\n\nNight turned to day, and Professor Mathison emerged from his study, eyes gleaming with newfound purpose. Word of his discovery spread like wildfire throughout Numerville. The townsfolk gathered around him, eager to hear his revelation.\n\n\"For months,\" Professor Mathison declared, \"I have been consumed by a puzzle of extraordinary proportions. The smallest cube, 41063625, possesses three permutations of its digits that are also cubes. But now, I invite you to immerse yourselves in an even greater challenge! Can you find the smallest cube for which exactly five permutations of its digits are cubes?\"\n\nThe townspeople marveled at the complexity of the problem and, inspired by Professor Mathison's unwavering determination, they too set out on a quest to solve this mathematical mystery. From young students to seasoned scholars, the whole town brimmed with excitement and a renewed love for numbers.\n\nAnd so, dear reader, the story turns to you. Can you embark on this mathematical journey and find the smallest cube, the elusive answer that has captivated both Professor Mathison and the inhabitants of Numerville? Will you be the one to unlock the hidden secrets of permutations in the world of cubes?\n\nNow it is your time to shine \u2013 the question is in your hands. Can you solve the mathematical problem?"}, {"id": 65, "euler_id": 65, "title": "Convergents of e", "problem": "The square root of 2 can be written as an infinite continued fraction.\n2=1+12+12+12+12+...\nThe infinite continued fraction can be written, 2=[1;(2)], (2) indicates that 2 repeats ad infinitum. In a similar way, 23=[4;(1,3,1,8)].\nIt turns out that the sequence of partial values of continued fractions for square roots provide the best rational approximations. Let us consider the convergents for 2.\n1+12=321+12+12=751+12+12+12=17121+12+12+12+12=4129\nHence the sequence of the first ten convergents for 2 are:\n1,32,75,1712,4129,9970,239169,577408,1393985,33632378,...\nWhat is most surprising is that the important mathematical constant,e=[2;1,2,1,1,4,1,1,6,1,...,1,2k,1,...].\nThe first ten terms in the sequence of convergents for e are:\n2,3,83,114,197,8732,10639,19371,1264465,1457536,...\nThe sum of digits in the numerator of the 10th convergent is 1+4+5+7=17.\nFind the sum of digits in the numerator of the 100th convergent of the continued fraction for e.", "solution": "272", "difficulty": 15, "story": "Once upon a time in the bustling city of Mathavia, a young girl named Eliza lived with her family. Eliza was a curious and inquisitive child who loved exploring the world around her. However, she found solace and joy in the world of numbers and mathematics. Her fascination with patterns and equations seemed to know no bounds. \n\nOne day, as Eliza strolled through the streets of Mathavia, she came across a mysterious old bookshop tucked away in a quiet corner. Determined to find something intriguing and challenging, she stepped inside and found herself surrounded by shelves filled with ancient books on mathematics.\n\nAmong the dusty tomes, her eyes fell upon a worn-out book with a faded cover that read \"Mathematics Secrets Unveiled.\" She reached out and gently opened it, her heart racing with anticipation. To her surprise, hidden within its pages, she discovered a mathematical problem that would change her life forever.\n\nThe problem revolved around a number called the square root of 2. Eliza read about how it could be expressed as an infinite continued fraction, with the number 1 repeating infinitely. As she delved deeper into the problem, her mind began to buzz with excitement. The book explained that the continued fractions for square roots provide the best rational approximations.\n\nCurious about this fascinating concept, Eliza decided to find the sequence of convergents for the square root of 2. She followed the step-by-step process mentioned in the book and calculated the convergents:\n\n1, 3/2, 7/5, 17/12, 41/29, 99/70, 239/169, 577/408, 1393/985, 3363/2378...\n\nAs she continued to discover more about these convergents, she came across another amazing revelation. The mystical book claimed that a mathematical constant, known as 'e,' also had a continued fraction sequence. Eliza's mind raced as she read about the partial values of the convergents for 'e.'\n\nThe book enlightened her on the first ten convergents for 'e':\n\n2, 3, 8/3, 11/4, 19/7, 87/32, 106/39, 193/71, 12646/4651, 14575/5364...\n\nEliza felt a burst of energy within her as she computed the sum of the numerator's digits for the tenth convergent of 'e.'\n\n1 + 4 + 5 + 7 = 17\n\nThis newfound knowledge left Eliza in awe of the intriguing patterns hidden within mathematics. Her mind swam with questions, wondering if these mathematical relationships held the answer to the secrets of the universe. How could concatenating numbers in a specific pattern yield such extraordinary results?\n\nAs she closed the book, Eliza's mathematical journey had only just begun. She yearned to uncover more numerical puzzles, to dive deeper into the enigmatic world of figures. Armed with her newfound knowledge, she wondered what the sum of digits in the numerator of the 100th convergent of the continued fraction for 'e' would be.\n\nWith her curious spirit aflame, Eliza left the bookshop, ready to embark on her next mathematical quest. What was the sum of digits in the numerator of the 100th convergent of the continued fraction for 'e'? The answer waited eagerly to be revealed, and Eliza was determined to find it."}, {"id": 73, "euler_id": 73, "title": "Counting fractions in a range", "problem": "Consider the fraction, n/d, where n and d are positive integers. If n<d and HCF(n,d)=1, it is called a reduced proper fraction.\nIf we list the set of reduced proper fractions for d \u2264 8 in ascending order of size, we get:\n1/8, 1/7, 1/6, 1/5, 1/4, 2/7, 1/3, 3/8, 2/5, 3/7, 1/2, 4/7, 3/5, 5/8, 2/3, 5/7, 3/4, 4/5, 5/6, 6/7, 7/8\nIt can be seen that there are 3 fractions between 1/3 and 1/2.\nHow many fractions lie between 1/3 and 1/2 in the sorted set of reduced proper fractions for d \u2264 12,000?", "solution": "7295372", "difficulty": 15, "story": "Once upon a time, in a small village by the edge of a picturesque lake, lived a young girl named Lily. Lily possessed a curious mind and a penchant for adventure. Her days were filled with exploration, traversing the forest and collecting trinkets adorning the woodland floor.\n\nOne sunny afternoon, Lily stumbled upon an old, weathered book hidden beneath a towering oak tree. As her nimble fingers brushed over its faded pages, she discovered a captivating tale that would forever change her perception of the world.\n\nThe book chronicled the enchanting journey of a young mathematician named Theodore. Theodore possessed a remarkable talent for solving puzzles and investigating the wonders of numbers. He traveled the world, seeking to unlock the secrets embedded within the beauty of mathematics.\n\nAs Lily delved deeper into Theodore's story, she came across an extraordinary mathematical problem. It spoke of fractions, reduced proper fractions to be precise, and the intriguing patterns they formed on a number line. Eager to solve it, she pondered its significance.\n\nIntrigued by the problem's mystery, Lily sought the guidance of the village elder, an elderly woman known for her profound wisdom and knowledge. She found her sitting beneath the shade of a weeping willow, her silver hair cascading like a waterfall.\n\n\"Dear elder,\" Lily began, her voice filled with curiosity, \"I have stumbled upon a question about fractions in a mysterious book. It speaks of reduced proper fractions and their arrangement in ascending order. Do you know its significance?\"\n\nThe elder smiled tenderly and motioned for Lily to sit beside her. \"Ah, my dear child, fractions may seem abstract, but they hold great meaning in the tapestry of mathematics. A reduced proper fraction is one where the numerator, n, is less than the denominator, d, and their highest common factor, or HCF, is 1.\"\n\nLily's eyes sparkled with wonder as the elder continued, \"The problem's marvel lies in listing the set of reduced proper fractions for d \u2264 8 in ascending order. As you witness this beautifully ordered sequence, you shall find the answer to a particular query.\"\n\nEagerly, Lily listened as the elder illustrated the sequence in her mind. \"1/8, 1/7, 1/6, 1/5, 1/4, 2/7, 1/3, 3/8, 2/5, 3/7, 1/2, 4/7, 3/5, 5/8, 2/3, 5/7, 3/4, 4/5, 5/6, 6/7, 7/8.\"\n\nWith wide-eyed amazement, Lily absorbed the patterns that embraced this beautiful world of numbers and fractions. \"But elder,\" she asked, her voice filled with anticipation, \"why does the problem desire to know the number of fractions lying between 1/3 and 1/2 in the sorted set of reduced proper fractions for d \u2264 12,000?\"\n\nThe elder's eyes gleamed with a mixture of joy and mystery. \"Ah, my dear Lily, that is for you to discover. In mathematics, the answers we seek often reveal themselves through the journey of exploration and understanding. Venture forth, my child, and seek the answer to this captivating inquiry.\"\n\nDetermined and invigorated by the elder's wisdom, Lily embarked on her own mathematical adventure. Armed with the knowledge of reduced proper fractions, she began meticulously exploring the patterns and intricacies of numbers. With each new day, her understanding grew deeper, and the allure of the mathematical problem consumed her thoughts.\n\nAnd so, dear reader, I pose the same question to you. How many fractions lie between 1/3 and 1/2 in the sorted set of reduced proper fractions for d \u2264 12,000? Will you embark on this journey of numbers and explore the beauty that awaits, as Lily did? In the realm of mathematics, the answers are infinite, and the journey is everlasting."}, {"id": 74, "euler_id": 74, "title": "Digit factorial chains", "problem": "The number 145 is well known for the property that the sum of the factorial of its digits is equal to 145:\n1! + 4! + 5! = 1 + 24 + 120 = 145\nPerhaps less well known is 169, in that it produces the longest chain of numbers that link back to 169; it turns out that there are only three such loops that exist:\n169 \u2192 363601 \u2192 1454 \u2192 169\n871 \u2192 45361 \u2192 871\n872 \u2192 45362 \u2192 872\nIt is not difficult to prove that EVERY starting number will eventually get stuck in a loop. For example,\n69 \u2192 363600 \u2192 1454 \u2192 169 \u2192 363601 (\u2192 1454)\n78 \u2192 45360 \u2192 871 \u2192 45361 (\u2192 871)\n540 \u2192 145 (\u2192 145)\nStarting with 69 produces a chain of five non-repeating terms, but the longest non-repeating chain with a starting number below one million is sixty terms.\nHow many chains, with a starting number below one million, contain exactly sixty non-repeating terms?", "solution": "402", "difficulty": 15, "story": "Once upon a time, in the small town of Numeria, there lived a young girl named Alice. Alice was incredibly curious and had an insatiable appetite for puzzles and riddles. She spent her days solving math problems, decoding secret messages, and unraveling the mysteries of the world.\n\nOne sunny afternoon, Alice stumbled upon a dusty old book in her grandfather's attic. As she blew off the layers of grime, she discovered that it was a book filled with ancient mathematical problems. Excitedly, she began flipping through the pages until she reached a particularly intriguing puzzle.\n\n\"The number 145 is well known for the property that the sum of the factorial of its digits is equal to 145,\" Alice read aloud. She furrowed her brow, her mind racing with numbers. \"How fascinating! I wonder if there are other numbers with similar properties.\"\n\nDetermined to solve the puzzle, Alice spent days and nights researching and experimenting. She became engrossed in the beauty of numbers and patterns, losing herself in a world where equations danced across the pages of her notebook.\n\nOne day, as Alice was sitting in the town library, she stumbled upon an ancient manuscript that mentioned a mysterious place called the \"Realm of Loops.\" According to the manuscript, the realm was said to be a puzzling dimension where numbers roamed freely, forever entangled in loops. Alice's heart raced with excitement, for she believed that the realm held the answers she sought.\n\nDriven by curiosity, Alice made her way to the outskirts of Numeria, where she found an old well. She clutched the manuscript tightly and whispered the words inscribed on its worn-out pages. To her astonishment, the well began to shimmer, and a portal emerged before her.\n\nWithout hesitation, Alice stepped into the portal, feeling a rush of exhilaration as she entered the enchanting Realm of Loops. The dimension was unlike anything she had ever seen. Numbers floated around her, forming intricate patterns in the air. Alice realized that these numbers were trapped in loops, forever repeating their steps.\n\nAs she explored the realm, Alice encountered various numbers and observed their repetitive behavior. She discovered the loops of 169, 871, and 872, amazed that there were only three such loops. Diving deeper into the realm, she noticed that every starting number she encountered eventually got stuck in a loop.\n\nAlice's mind whirred with thoughts and ideas as she tried to comprehend the endless possibilities before her. The realm was a magical opportunity to understand the patterns of numbers, a playground for her mathematical curiosity.\n\nDays turned into weeks, and weeks turned into months as Alice delved deeper into the mysteries of the realm. Every new loop she discovered became a puzzle waiting to be solved. She noticed that some numbers had short loops, while others had longer ones.\n\nOne day, a particularly fascinating observation caught Alice's attention. She found a chain of numbers that contained sixty non-repeating terms. It was the longest chain she had discovered in the realm thus far, and it fascinated her. The number was so large that it stretched her comprehension, but she was determined to understand its significance.\n\nAs Alice continued her exploration, she couldn't help but wonder how many other chains, starting with numbers below one million, contained exactly sixty non-repeating terms. It became the ultimate puzzle that consumed her thoughts, the question that drove her forward.\n\nSo, dear reader, as you immerse yourself in Alice's journey through the Realm of Loops, I leave you with this question: How many chains, with a starting number below one million, contain exactly sixty non-repeating terms? Can you unravel the secrets held within the mesmerizing realm and find the answer that eluded Alice?"}, {"id": 85, "euler_id": 85, "title": "Counting rectangles", "problem": "By counting carefully it can be seen that a rectangular grid measuring 3 by 2 contains eighteen rectangles:\n\n\nAlthough there exists no rectangular grid that contains exactly two million rectangles, find the area of the grid with the nearest solution.", "solution": "2772", "difficulty": 15, "story": "Once upon a time, in the small town of Numeria, there lived a brilliant mathematician named Professor Lucas. People from far and wide sought his guidance on various mathematical conundrums. His reputation spread like wildfire, and soon he became a figure of admiration and respect in the academic community.\n\nOne sunny morning, a young girl named Lily stumbled upon the quaint town of Numeria. She had heard rumors of Professor Lucas and was curious to meet the renowned mathematician. Lily ventured through the cobblestone streets, asking locals for directions, until she finally arrived at the magnificent tower where the professor resided.\n\nWearing her favorite mathematician's badge, Lily nervously knocked on the door. The professor, a tall man with spectacles perched upon his nose, opened the door and greeted her warmly.\n\n\"Greetings, young mathematician. What brings you to Numeria today?\" Professor Lucas asked with a smile, his gray hair shimmering in the sunlight.\n\nLily took a deep breath before replying, \"Professor Lucas, I have a puzzle that has been haunting me. It's a mathematical problem I came across in a book, and I just can't seem to solve it.\"\n\nThe professor beckoned Lily inside and led her to a cozy study lined with shelves filled with books, papers, and mathematical artifacts. He sat her down at a desk adorned with an ancient globe and listened attentively as she explained the conundrum.\n\n\"I read that a rectangular grid measuring 3 by 2 contains eighteen rectangles. But what intrigued me most was the part where it said there exists no rectangular grid that contains exactly two million rectangles. Professor, why is this so?\"\n\nProfessor Lucas scratched his chin, deep in thought. \"Ah, the bewitching beauty of mathematics. You see, Lily, each rectangle grid can be seen as a collection of smaller rectangles. For a grid measuring 3 by 2, we can count each of the 18 rectangles carefully. However, when it comes to two million rectangles, the calculations become quite complex.\"\n\nLily's eyes widened. \"Complex? But Professor, isn't there a simple way to find out the solution?\"\n\nThe professor chuckled. \"My dear Lily, mathematics has always challenged even the brightest minds. Here's a riddle for you. Imagine you have a rectangular grid with unknown dimensions that contains the nearest solution to two million rectangles. What would be the area of that grid? Can you solve this little puzzle?\"\n\nLily's mind swirled with numbers and patterns. She knew the answer lay within the question the professor posed. Determined, she looked at Professor Lucas and said, \"Professor, with your guidance, I will find the answer. May I stay here and work on this problem with you?\"\n\nThe professor smiled, pleased with Lily's enthusiasm. \"Of course, my dear. We will work together until we unlock the secrets of this mathematical enigma.\"\n\nAnd so, Lily and Professor Lucas embarked on an enthralling journey, diving deep into the world of mathematics, tirelessly exploring grids of various sizes, calculating, and experimenting. Days turned into weeks, and weeks turned into months.\n\nThrough their collaboration and insatiable curiosity, they uncovered multiple solutions, yet none matched the exact requirement of two million rectangles. Lily began to understand the complexity of the problem and the beauty inherent in mathematics.\n\nAs their research continued, they marveled at the intricate patterns and connections that emerged from each grid they explored. Lily couldn't help but wonder if there was a hidden message within the countless rectangles\u2014something only mathematics could reveal.\n\nOne morning, as the sun poured through the study's window, illuminating their tired but determined faces, Lily turned to Professor Lucas and asked, \"Professor, what is the purpose of finding this grid? What will it teach us?\"\n\nThe professor smiled and replied, \"Lily, the pursuit of knowledge is a rewarding one. Sometimes, the value lies not in finding an answer but in the process of searching for it. Mathematics teaches us discipline, patience, and the joy of discovery. So, my dear Lily, let us continue our journey. Who knows what mysteries we may uncover?\"\n\nAnd with renewed vigor, Lily and Professor Lucas delved even deeper into the mathematical puzzle, knowing that the true treasure lay not in the destination but in the journey itself.\n\nNow, dear reader, I pose a question to you. Can you solve the mathematical problem that eluded Lily and Professor Lucas? What is the area of the rectangular grid that contains the nearest solution to two million rectangles? The answer, like the beauty of numbers itself, awaits your exploration."}, {"id": 112, "euler_id": 112, "title": "Bouncy numbers", "problem": "Working from left-to-right if no digit is exceeded by the digit to its left it is called an increasing number; for example, 134468.\nSimilarly if no digit is exceeded by the digit to its right it is called a decreasing number; for example, 66420.\nWe shall call a positive integer that is neither increasing nor decreasing a \"bouncy\" number; for example, 155349.\nClearly there cannot be any bouncy numbers below one-hundred, but just over half of the numbers below one-thousand (525) are bouncy. In fact, the least number for which the proportion of bouncy numbers first reaches 50% is 538.\nSurprisingly, bouncy numbers become more and more common and by the time we reach 21780 the proportion of bouncy numbers is equal to 90%.\nFind the least number for which the proportion of bouncy numbers is exactly 99%.", "solution": "1587000", "difficulty": 15, "story": "Once upon a time in the enchanting land of Numeria, there lived a young mathematician named Sophia. Sophia had an insatiable curiosity for everything mathematical - from the numinous patterns in nature to the enigmatic puzzles that seemed to possess a life of their own. She possessed an astute mind and a deep fascination for numbers that drove her to unravel even the most perplexing mathematical secrets.\n\nOne day, while strolling through her favorite meadow, Sophia stumbled upon an old, tattered book nestled beneath a gnarled oak tree. The book emanated an aura of mystery, as if it held within its pages an enigma waiting to be deciphered. Sophia's heart raced with excitement as she dusted off the brittle pages, revealing the story of the bouncy numbers.\n\nAs Sophia read about the increasing and decreasing numbers, she marveled at their elegance. It was a concept that captivated her imagination, and she couldn't help but wonder if it held a deeper meaning. The more she delved into the intricacies of the bouncy numbers, the more she longed to experience their magic for herself.\n\nWith renewed determination, Sophia abandoned her everyday tasks and devoted herself to the study of bouncy numbers. From dawn till dusk, she pored over countless calculations, trying to unlock the secrets hidden within the perplexing pattern. Days turned into weeks, and weeks turned into months, but her sharp mind refused to rest.\n\nOne evening, as the setting sun painted the sky with vivid hues of orange and pink, Sophia had a breakthrough. She discovered that bouncy numbers, once a rarity, were gradually becoming more common. The proportion of bouncy numbers increased as the numbers grew larger. It was a revelation that both astounded and intrigued her.\n\nWith laser-like focus, Sophia worked tirelessly, crunching numbers with unwavering determination. And finally, she reached a pivotal moment. The book told her that the least number for which the proportion of bouncy numbers first reached 50% was 538. A tiny spark of excitement ignited within her. The bouncy numbers were offering her a challenge, and she was determined to conquer it.\n\nAs Sophia's journey continued, she discovered that the proportion of bouncy numbers grew exponentially. By the time she reached the number 21780, the proportion of bouncy numbers in relation to all numbers stood at 90%. The phenomenon fascinated her, and she yearned to reach the pinnacle of this mesmerizing pattern.\n\nBut there was one question that consumed Sophia's thoughts - the question that she rested all her hopes and dreams upon: What was the least number for which the proportion of bouncy numbers was exactly 99%?\n\nHer mind buzzed with anticipation as she cradled the old book, her eyes sparkling with determination. Sophia knew that the answer lay hidden within the never-ending tapestry of numbers, waiting for her to uncover it. And so, she embarked on a quest, striving to seize the answer from the clutches of the elusive bouncy numbers.\n\nAs the story unfolds, Sophia's journey will take her to the farthest corners of Numeria. She will encounter mathematical wonders, encounter wise mentors, and face unexpected challenges. Along the way, she will learn the true power of perseverance and the profound importance of pursuing one's dreams.\n\nBut for now, dear reader, I leave you with this question: What is the least number for which the proportion of bouncy numbers becomes exactly 99%?"}, {"id": 205, "euler_id": 205, "title": "Dice Game", "problem": "Peter has nine four-sided (pyramidal) dice, each with faces numbered 1, 2, 3, 4.\nColin has six six-sided (cubic) dice, each with faces numbered 1, 2, 3, 4, 5, 6.\nPeter and Colin roll their dice and compare totals: the highest total wins. The result is a draw if the totals are equal.\nWhat is the probability that Pyramidal Pete beats Cubic Colin? Give your answer rounded to seven decimal places in the form 0.abcdefg", "solution": "0.5731441", "difficulty": 15, "story": "Once upon a time, in the idyllic village of Numeria, there lived two best friends named Peter and Colin. Peter, known as Pyramidal Pete due to his love for pyramidal dice, was a young magician with a heart of gold. Colin, on the other hand, was a mischievous troublemaker who adored his cubic dice, earning him the nickname Cubic Colin.\n\nEvery year, the villagers of Numeria gathered for the Great Dice Tournament, a thrilling event where dice enthusiasts from far and wide showcased their skills. This year, Pyramidal Pete and Cubic Colin decided to participate, hoping to prove their dice-rolling prowess to the world.\n\nThe day of the tournament arrived, and the air was filled with anticipation and excitement. As the villagers cheered on, Pyramidal Pete and Cubic Colin prepared for their first match against each other. Peter's golden pyramidal dice shimmered in the sunlight, while Colin's vibrant cubic dice clinked together in his pocket.\n\nThe rules were simple: each player would roll their respective dice, and the one with the highest total would emerge victorious. If their totals happened to be equal, the match would result in a draw.\n\nPyramidal Pete and Cubic Colin stared at each other, determination in their eyes, as they took their positions. The crowd fell silent, eager to witness the outcome of this unique battle between pyramids and cubes.\n\nWith a flick of his wrist, Pyramidal Pete sent his dice soaring through the air. The dice spun mid-flight, landing with a soft thud and revealing the numbers 2, 4, 3, 1, 3, 2, 4, 1, and 3 on their respective faces.\n\nCubic Colin, fueled by both skill and mischief, grinned mischievously and unleashed his own set of dice. The audience held their breath as the six individual cubes clattered to a stop, showing the numbers 5, 3, 2, 1, 4, and 6.\n\nThe two friends locked eyes, realizing that the fate of their match rested solely on those numbers. The crowd erupted into cheers as they quickly added up their totals. Peter's dice had a sum of sixteen, while Colin's totaled twenty-one.\n\nA sense of disappointment washed over Pyramidal Pete as he accepted his defeat gracefully, congratulating Cubic Colin with a warm smile. However, the spark of curiosity was ignited within him. He knew his pyramidal dice had their own uniqueness, and he wondered about their likelihood of winning against Colin's cubic dice.\n\nAs the tournament unfolded, Peter couldn't help but ponder the probabilities behind his dice. Throughout the day, he witnessed a myriad of exhilarating matches, each filled with suspense and surprise. While he cheered for his friends and marveled at the talents displayed, a single question lingered in his mind: What is the probability that Pyramidal Pete beats Cubic Colin?\n\nCan you solve this puzzling probability question? What might be the chances of Peter's pyramidal dice surpassing Colin's cubic dice?"}, {"id": 301, "euler_id": 301, "title": "Nim", "problem": "Nim is a game played with heaps of stones, where two players take it in turn to remove any number of stones from any heap until no stones remain.\nWe'll consider the three-heap normal-play version of Nim, which works as follows:\nAt the start of the game there are three heaps of stones.\nOn each player's turn, the player may remove any positive number of stones from any single heap.\nThe first player unable to move (because no stones remain) loses.\nIf (n1,n2,n3) indicates a Nim position consisting of heaps of size n1, n2, and n3, then there is a simple function, which you may look up or attempt to deduce for yourself, X(n1,n2,n3) that returns:\nzero if, with perfect strategy, the player about to move will eventually lose; or\nnon-zero if, with perfect strategy, the player about to move will eventually win.\nFor example X(1,2,3)=0 because, no matter what the current player does, the opponent can respond with a move that leaves two heaps of equal size, at which point every move by the current player can be mirrored by the opponent until no stones remain; so the current player loses. To illustrate:\ncurrent player moves to (1,2,1)\nopponent moves to (1,0,1)\ncurrent player moves to (0,0,1)\nopponent moves to (0,0,0), and so wins.\nFor how many positive integers n\u2009\u2264\u2009230 does X(n,2n,3n)=0 ?", "solution": "2178309", "difficulty": 15, "story": "Once upon a time, in the quaint town of Numerica, there lived two friends, Alex and Ben, who shared a deep passion for mathematics. They spent countless hours exploring different puzzles and problems, challenging each other's intellect at every turn. One sunny afternoon, as they sat under the shade of their favorite oak tree, they stumbled upon an intriguing mathematical problem known as Nim.\n\n\"Ben, have you ever heard of Nim?\" asked Alex, his eyes sparkling with curiosity.\n\n\"No, I can't say that I have. What's it all about?\" replied Ben, his interest piqued.\n\nAlex proceeded to explain the rules of the game: \"Nim is a game played with heaps of stones, where two players take turns removing any number of stones from any heap until no stones remain. We'll consider the three-heap normal-play version, and there's a function called X(n1, n2, n3) which tells us whether the player about to move will ultimately win or lose. Sounds fascinating, doesn't it?\"\n\nBen nodded, his mind already captivated by the possibilities. Together, they delved deeper into the intricacies of Nim, analyzing various Nim positions and trying to determine possible strategies for winning.\n\nDays turned into weeks, and weeks into months, yet Alex and Ben remained engrossed in their quest to comprehend the secrets of Nim. Their dedication never wavered, as they tirelessly explored every variation and scenario the game had to offer.\n\nAs the duo delved into their research, they discovered that the game of Nim had a direct connection to different areas of mathematics, including combinatorics, sequences, and even game theory. The more they learned, the more enthralled they became, realizing that Nim was not just a game but a glimpse into the fascinating world of mathematical strategy.\n\nOne evening, while poring over their notes at the local library, Alex's eyes gleamed with excitement. \"Ben, I think we've stumbled upon something remarkable! Look here, X(n, 2n, 3n) is zero for certain values of n. If we can find out how many positive integers satisfy this condition up to 230, it could be a groundbreaking discovery!\"\n\nBen's eyes widened with anticipation as he grasped the significance of their findings. They had embarked on a journey that could potentially unravel hidden mathematical patterns, leading to new theorems and insights.\n\nEager to solve the problem, the friends spent sleepless nights, exchanging ideas, and working through various equations. They were determined to uncover the secret behind X(n, 2n, 3n) and find the number of positive integers that satisfied the condition.\n\nDays turned into weeks, and soon the deadline for their research project loomed nearer. Alex and Ben realized they had exhausted all their resources and needed a breakthrough. Undeterred by the looming pressure, they dived back into their research, leaving no stone unturned.\n\nFinally, the day arrived for the mathematical convention. Nervously, Alex and Ben stood before a room full of esteemed mathematicians, ready to present their findings. The audience listened attentively as they explained their journey through the fascinating world of Nim.\n\n\"And so, our question to you all is this: For how many positive integers n \u2264 230 does X(n, 2n, 3n) = 0? We leave this challenge to you, dear mathematicians, to solve this puzzle and uncover its hidden secrets,\" concluded Ben, his voice filled with a mix of anticipation and excitement.\n\nAs the room buzzed with animated discussions, the mathematical community delved into the problem, inspired by Alex and Ben's resolve to unravel the mystery of Nim.\n\nMonths passed, and mathematicians all over the world took up the challenge. They poured over calculations, revisited classical theorems, and explored cutting-edge techniques. The common goal of solving the puzzle united these brilliant minds, sparking a global collaboration.\n\nAs for Alex and Ben, they continued their quest for knowledge, indulging in more mathematical wonders. The world eagerly awaited their next discovery, knowing that whatever they unearthed would undoubtedly ignite a new wave of excitement in the vast realm of mathematics.\n\nAnd so, the question lingers, waiting patiently for someone to unveil its answer: For how many positive integers n \u2264 230 does X(n, 2n, 3n) = 0? Will you be the one to solve the mystery of Nim?"}, {"id": 345, "euler_id": 345, "title": "Matrix Sum", "problem": "We define the Matrix Sum of a matrix as the maximum possible sum of matrix elements such that none of the selected elements share the same row or column.\nFor example, the Matrix Sum of the matrix below equals 3315 ( = 863 + 383 + 343 + 959 + 767):\n\n\u00a0\u00a07 \u00a053 183 439 863\n497 383 563 \u00a079 973\n287 \u00a063 343 169 583\n627 343 773 959 943767 473 103 699 303\n\nFind the Matrix Sum of:\n\n\u00a0\u00a07 \u00a053 183 439 863 497 383 563 \u00a079 973 287 \u00a063 343 169 583\n627 343 773 959 943 767 473 103 699 303 957 703 583 639 913\n447 283 463 \u00a029 \u00a023 487 463 993 119 883 327 493 423 159 743\n217 623 \u00a0\u00a03 399 853 407 103 983 \u00a089 463 290 516 212 462 350\n960 376 682 962 300 780 486 502 912 800 250 346 172 812 350\n870 456 192 162 593 473 915 \u00a045 989 873 823 965 425 329 803\n973 965 905 919 133 673 665 235 509 613 673 815 165 992 326\n322 148 972 962 286 255 941 541 265 323 925 281 601 \u00a095 973\n445 721 \u00a011 525 473 \u00a065 511 164 138 672 \u00a018 428 154 448 848\n414 456 310 312 798 104 566 520 302 248 694 976 430 392 198\n184 829 373 181 631 101 969 613 840 740 778 458 284 760 390\n821 461 843 513 \u00a017 901 711 993 293 157 274 \u00a094 192 156 574\n\u00a034 124 \u00a0\u00a04 878 450 476 712 914 838 669 875 299 823 329 699\n815 559 813 459 522 788 168 586 966 232 308 833 251 631 107\n813 883 451 509 615 \u00a077 281 613 459 205 380 274 302 \u00a035 805", "solution": "13938", "difficulty": 15, "story": "Once upon a time, in the quiet town of Numeria, there lived a brilliant mathematician named Professor Marcus. Every day, the professor would immerse himself in complex mathematical problems, seeking to unravel the mysteries of the universe through numbers and formulas. He was particularly fascinated by a problem known as the Matrix Sum.\n\nProfessor Marcus had recently stumbled upon a peculiar puzzle that had left him quite perplexed. It was a matrix filled with numbers, and the task was to find the Matrix Sum. His curiosity piqued, the professor decided to dedicate all his time and energy to solving this mathematical enigma.\n\nDays turned into weeks, and weeks into months as Professor Marcus delved deeper into the intricacies of the matrix. He poured over various algorithms and devised clever strategies, attempting to uncover the maximum possible sum of matrix elements while ensuring none of them shared the same row or column. Each night, he would fall into a fitful sleep, dreaming of numbers and equations merging into a beautiful tapestry.\n\nAs the professor's obsession grew, the townsfolk of Numeria began to notice his eccentric behavior. Some whispered behind closed doors, questioning his sanity. Others simply marveled at his unwavering determination. Yet, Professor Marcus paid no attention to their whispers, consumed entirely by the perplexing matrix.\n\nOne day, a young girl named Lily chanced upon the professor's study while exploring the outskirts of town. Intrigued, she peered through the dusty windows, her eyes widening as she took in the countless papers covered in numbers and calculations. Something about the professor's fervor captivated her, and she knew she had to uncover the puzzle that had ensnared his mind.\n\nWith the professor's permission, Lily began her own investigation into the matrix. She poured over his notes and studied his meticulous calculations, determined to understand this enigma herself. Gradually, Lily began to grasp the rules of the Matrix Sum, recognizing patterns and connections that had eluded the professor.\n\nAs Lily's confidence grew, she presented her findings to the professor. He was astounded by her insights, realizing that her fresh perspective had opened up new possibilities. Together, they delved back into the world of numbers, working side by side to unravel the final secrets of the matrix.\n\nThe townsfolk of Numeria watched in awe as Professor Marcus and Lily spent countless hours in the professor's study, their heads buried in calculations. The once skeptical townsfolk now held a newfound respect for the professor's dedication and Lily's brilliance.\n\nBut as the days turned into weeks, and weeks into months, the riddle of the matrix still eluded them. Their efforts, as valiant as they were, fell short of the elusive answer they sought. Frustration began to creep into their hearts, and doubts plagued their minds. Had they reached the limits of their capabilities? Was it possible that the matrix held a solution they simply could not grasp?\n\nAs the weight of disappointment pressed upon them, Professor Marcus and Lily stared at the matrix one last time, their eyes filled with a mixture of exhaustion and determination. They both knew that the answer was just within their reach, but it remained tantalizingly out of grasp.\n\nAnd so, dear reader, I present to you the very same question that haunted the brilliant minds of Professor Marcus and Lily:\n\nWhat is the Matrix Sum of the following matrix?\n\n\u00a0\u00a07 \u00a053 183 439 863 497 383 563 \u00a079 973 287 \u00a063 343 169 583\n627 343 773 959 943 767 473 103 699 303 957 703 583 639 913\n447 283 463 \u00a029 \u00a023 487 463 993 119 883 327 493 423 159 743\n217 623 \u00a0\u00a03 399 853 407 103 983 \u00a089 463 290 516 212 462 350\n960 376 682 962 300 780 486 502 912 800 250 346 172 812 350\n870 456 192 162 593 473 915 \u00a045 989 873 823 965 425 329 803\n973 965 905 919 133 673 665 235 509 613 673 815 165 992 326\n322 148 972 962 286 255 941 541 265 323 925 281 601 \u00a095 973\n445 721 \u00a011 525 473 \u00a065 511 164 138 672 \u00a018 428 154 448 848\n414 456 310 312 798 104 566 520 302 248 694 976 430 392 198\n184 829 373 181 631 101 969 613 840 740 778 458 284 760 390\n821 461 843 513 \u00a017 901 711 993 293 157 274 \u00a094 192 156 574\n\u00a034 124 \u00a0\u00a04 878 450 476 712 914 838 669 875 299 823 329 699\n815 559 813 459 522 788 168 586 966 232 308 833 251 631 107\n813 883 451 509 615 \u00a077 281 613 459 205 380 274 302 \u00a035 805\n\nCan you solve this mathematical conundrum that eluded the brilliant minds of Numeria?"}, {"id": 346, "euler_id": 346, "title": "Strong Repunits", "problem": "\nThe number 7 is special, because 7 is 111 written in base 2, and 11 written in base 6 (i.e. 710 = 116 = 1112). In other words, 7 is a repunit in at least two bases b > 1. \n\n\nWe shall call a positive integer with this property a strong repunit. It can be verified that there are 8 strong repunits below 50:  {1,7,13,15,21,31,40,43}. Furthermore, the sum of all strong repunits below 1000 equals 15864.\n\nFind the sum of all strong repunits below 1012.\n\n\n", "solution": "336108797689259276", "difficulty": 15, "story": "Once upon a time, in the quaint village of Mathlandia, there lived a young boy named Otto. Otto had always shown an aptitude for numbers, and he spent most of his days tinkering with mathematical puzzles and exploring the endless possibilities that numbers held. His favorite pastime was unraveling the enigmatic nature of repunits - numbers that consisted only of repeating ones.\n\nOne day, a mysterious traveler arrived in Mathlandia. He was old and wise, his eyes filled with intrigue and knowledge. As the villagers gathered around him, he began to share a captivating tale.\n\n\"Dear people of Mathlandia,\" the traveler began, \"I come from a distant land where numbers tell stories and hold immense power. In my travels, I have discovered a specific kind of repunit that is incredibly fascinating. I call them strong repunits.\"\n\nHe continued, \"A strong repunit is a positive integer that can be written as a sequence of repeating ones in different numerical bases. It is an extraordinary rarity, for only a few numbers possess this property. Take, for example, the number 7. In base 2, it is written as 111, and in base 6, it is 11. Remarkably, 7 is a strong repunit in two bases, creating a beautiful connection between different number systems.\"\n\nOtto's face lit up with excitement as he listened to the traveler's tale. He had always been captivated by the mystery of numbers, and the concept of strong repunits intrigued him immensely.\n\nDetermined to explore this mathematical wonder, Otto dedicated himself to finding all the strong repunits below a certain limit. After much rigorous calculation, he discovered that there were eight such numbers below 50: 1, 7, 13, 15, 21, 31, 40, and 43.\n\nHe then pondered the significance of this finding. Why were these numbers so special? What purpose did they serve? It became clear to Otto that understanding strong repunits was crucial in unraveling the mysteries of mathematics, and he felt a deep calling to unravel this enigma further.\n\nAs the years passed, Otto's fascination with strong repunits grew stronger. He dedicated his life to studying these mystical numbers, their properties, and their potential applications in various branches of mathematics. Otto became a renowned mathematician, cloaked in a world of numbers, and his work paved the way for future discoveries and breakthroughs in the field.\n\nBut there was one question that continued to elude him, one question that remained unsolved and burned within his heart. It haunted his dreams and whispered to him in the depths of his solitude.\n\nCan anyone in this vast universe determine the sum of all strong repunits below 1012?\n\nAnd so, dear reader, the time has come for you to follow in Otto's footsteps. Can you unlock the secret of the sum? Can you discover the hidden treasures that lie within the world of strong repunits?\n\nThe answer awaits, encoded in the infinite possibilities of numbers, beckoning you to embark on a journey of discovery. Will you be the one to find the sum of all strong repunits below 1012?"}, {"id": 347, "euler_id": 347, "title": "Largest integer divisible by two primes", "problem": "\nThe largest integer \u2264 100 that is only divisible by both the primes 2 and 3 is 96, as 96=32*3=25*3.\nFor two distinct primes p and q let M(p,q,N) be the largest positive integer \u2264N only divisible\nby both p and q and M(p,q,N)=0 if such a positive integer does not exist.\n\n\nE.g. M(2,3,100)=96. \nM(3,5,100)=75 and not 90 because 90 is divisible by 2 ,3 and 5.\nAlso M(2,73,100)=0 because there does not exist a positive integer \u2264 100 that is divisible by both 2 and 73.\n\n\nLet S(N) be the sum of all distinct M(p,q,N).\nS(100)=2262.\n\n\nFind S(10 000 000).\n", "solution": "11109800204052", "difficulty": 15, "story": "Once upon a time in the small village of Numeria, lived a young girl named Lily. Lily had always been curious about the world around her, constantly seeking knowledge and finding joy in solving puzzles and riddles. Her love for mathematics was unmatched, and the villagers often sought her help with their numerical conundrums. \n\nOne day, a message arrived in Numeria. It was a proclamation from the kingdom's royal mathematician, inviting the brightest minds in the land to solve a mysterious problem. The problem dealt with two distinct primes, and Lily's heart leaped with excitement. Could this be her chance to showcase her skills and make a difference?\n\nAs Lily began to dissect the problem, she realized its significance. It involved finding the largest positive integer that was divisible by two specified primes, p and q, but also less than or equal to a given value, N. If such an integer did not exist, the result would be zero. This mathematical challenge intrigued Lily, and she knew that solving it would require both logic and creativity.\n\nAs the days turned into nights, Lily immersed herself in solving the problem. She could feel the answer eluding her at every turn. The villagers became restless, eagerly waiting for her to crack the code. Many of them had their hopes pinned on Lily, trusting her abilities to find a solution.\n\nLily spent hours concocting theories, scribbling equations, and erasing her mistakes. She would often wander through the village, lost in her thoughts, staring up at the night sky. The stars, filled with countless possibilities, seemed to whisper secrets only the universe knew. And it was in one of those starry nights that inspiration struck.\n\nSuddenly, the solution became clear in Lily's mind. The largest integer divisible by both p and q would be the product of the highest powers of p and q, less than or equal to N. It was as if the stars had led her to the answer she had been seeking all along.\n\nFilled with hope and determination, Lily rushed back to her tiny room and continued her calculations. The numbers danced before her eyes, and she rejoiced with each correct computation. Finally, she had solved the problem, her heart alight with pride.\n\nNews of Lily's triumph spread like wildfire throughout Numeria. Villagers gathered in the town square, eager to learn the outcome of her hard work. With a sense of accomplishment, Lily addressed the crowd, \"My dear friends, I have solved the mathematical problem presented to us. The sum of all distinct solutions, denoted as S(N), is a staggering number. But this is just the beginning of our journey...\"\n\nEvery villager listened intently, their eyes filled with anticipation. Lily's voice filled the air, carrying her message. \"I present to you, S(10,000,000)! Can you solve it?\"\n\nThe crowd erupted into a buzzing murmur, discussions breaking out amongst neighbors and friends. The challenge had been set, and Numeria brimmed with excitement.\n\nAnd so, the question hangs in the air, waiting for someone to find the solution. Can you solve S(10,000,000)?"}, {"id": 381, "euler_id": 381, "title": "(prime-k) factorial", "problem": "\nFor a prime p let S(p) = (\u2211\u2009(p-k)!) mod(p) for 1 \u2264 k \u2264 5.\n\n\nFor example, if p=7,\n(7-1)! + (7-2)! + (7-3)! + (7-4)! + (7-5)! = 6! + 5! + 4! + 3! + 2! = 720+120+24+6+2 = 872. \nAs 872 mod(7) = 4, S(7) = 4.\n\n\nIt can be verified that \u2211\u2009S(p) = 480 for 5 \u2264 p < 100.\n\n\nFind \u2211\u2009S(p) for 5 \u2264 p < 108.\n", "solution": "139602943319822", "difficulty": 15, "story": "Once upon a time, in the bustling city of Veridian, lived a young prodigy named Catherine. Catherine had always been known for her exceptional mathematical abilities, often outshining her peers and leaving her teachers in awe. Her brilliance was evident from a very young age, and she had always dreamed of using her skills to solve real-world problems and make a difference in the lives of others.\n\nOne sunny afternoon, while Catherine was engrossed in her mathematics textbook, a peculiar note slipped through her window. Curiosity piqued, she picked up the note and unfolded it. To her surprise, it was from a mysterious mathematician known only as \"The Enigma.\" The note contained a perplexing mathematical problem, and the question etched itself into Catherine's mind.\n\nIntrigued and determined to solve the puzzle, Catherine delved deep into the enigma's challenge. The problem presented was as follows: Find \u2211\u2009S(p) for 5 \u2264 p < 108, where S(p) was defined as (\u2211\u2009(p-k)!) mod(p) for 1 \u2264 k \u2264 5. The note mentioned that it was essential to unravel this mystery, as it held the potential to unlock an incredible secret.\n\nDays turned into weeks, and weeks into months, as Catherine immersed herself in the world of numbers. She fervently studied the properties of primes and the cyclic patterns they created. Countless notebooks were filled with calculations, theories, and ideas. The city around her bustled with life, but Catherine remained secluded, dedicated to solving the intricate puzzle before her.\n\nOne evening, as silver moonlight spilled into her room, Catherine had a breakthrough. A flicker of inspiration ignited within her, and she raced to her desk, feverishly scribbling equations. Mathematical patterns unfolded like ribbons before her eyes, weaving strands of knowledge and understanding.\n\nAs the months passed by, Catherine's understanding of the problem deepened. The sum S(p) became more than just a mathematical expression; it represented the essence of her pursuit - the pursuit of knowledge, the pursuit of enlightenment. The answer to this equation held within it a hidden power, the potential for change that had driven her to this point.\n\nOne summer morning, as the city awoke to the songs of birds, Catherine found herself standing at the precipice of the solution. All her hard work, sleepless nights, and endless calculations seemed poised to bear fruit. But as she was about to make her final move, a realization struck her\u2014a realization that changed her perspective.\n\nShe understood that mathematics, though capable of unlocking mysteries and solving problems, could sometimes be even more profound. It was not just a tool to be used but an art to be appreciated. The pursuit of this problem had transformed her, revealing the beauty and wonder that lay within the realm of numbers.\n\nWith this newfound understanding, Catherine paused. She gazed out of her window, a smile tugging at the corners of her lips. In her heart, she knew that she had already achieved what she set out to do\u2014the journey itself had been the reward. Equations and answers held no power over her anymore. What truly mattered was the passion that burned within her and the knowledge she had acquired along the way.\n\nNow, dear reader, I leave you with the same question that captivated Catherine. Can you find \u2211\u2009S(p) for 5 \u2264 p < 108? As you embark on this mathematical adventure, remember that true wisdom can sometimes be found not in the destination but in the journey itself."}, {"id": 500, "euler_id": 500, "title": "Problem 500!!!", "problem": "The number of divisors of 120 is 16.\nIn fact 120 is the smallest number having 16 divisors.\n\n\nFind the smallest number with 2500500 divisors.\nGive your answer modulo 500500507.\n", "solution": "35407281", "difficulty": 15, "story": "Once upon a time in the enchanting land of Numeria, there lived a young mathematician named Addison. Addie had always possessed a burning curiosity for numbers and a deep fascination with the mysteries of the mathematical universe. She spent her days exploring the hidden patterns and solving complex equations in her cozy little cottage nestled at the edge of the village.\n\nOne sunny morning, as Addie sat at her desk surrounded by stacks of papers and equations, she stumbled upon an intriguing mathematical problem. It was a riddle given by the renowned sorcerer, Professor Arithmetica, who resided in a grand tower on the highest peak of Numeria.\n\n\"The number of divisors of 120 is 16,\" the problem began. Addie's eyes twinkled with excitement as she pondered the enigma. She knew that divisors were the numbers that evenly divide another number. In this case, 120 had 16 distinct divisors.\n\n\"In fact,\" the riddle continued, \"120 is the smallest number having 16 divisors.\"\n\nAddie's heart raced. The smallest number with 16 divisors was quite a feat, but she could not help but wonder what lay beyond that challenge. She yearned to take on the quest presented by Professor Arithmetica, fueled by her insatiable thirst for knowledge and discovery.\n\nDetermined to solve the riddle, Addie embarked on a journey to the heart of Numeria. She trekked through lush forests, crossed sparkling creeks, and ascended towering mountains, until she reached the base of Professor Arithmetica's magnificent tower.\n\nWith bated breath, Addie climbed the spiraling staircase that led to the sorcerer's study. The room was adorned with ancient books, extravagant scrolls, and mysterious artifacts, all whispering tales of forgotten numerical wonders. At the center of the room, Professor Arithmetica waited patiently with an enigmatic smile.\n\n\"Greetings, young mathematician,\" the sorcerer greeted Addie. \"I see you have come seeking answers. The riddle of divisors has captivated you, hasn't it?\"\n\nAddie nodded eagerly, her eyes gleaming. Profesor Arithmetica continued, \"Now, my dear, I have a new question for you. Can you find the smallest number with 2,500,500 divisors?\"\n\nThe question hung in the air, charging the room with excitement and anticipation. Addie's mind whirled as she internalized the magnitude of the challenge. The concept of a number having millions of divisors was mind-boggling, yet she felt a pull deep inside her, as if her soul was entwined with the quest.\n\nAnd so, dear reader, the story unfolds. Will Addie defy the odds and uncover the secret of the number with 2,500,500 divisors? Will she find the solution and return to the quaint village of Numeria as a hero, her name etched in the annals of mathemagical history? Only you hold the key to unlock the infinite possibilities. So I ask you, can you find the smallest number with 2,500,500 divisors?\n\nThe answer awaits..."}, {"id": 504, "euler_id": 504, "title": "Square on the Inside", "problem": "Let ABCD be a quadrilateral whose vertices are lattice points lying on the coordinate axes as follows:\nA(a, 0), B(0, b), C(\u2212c, 0), D(0, \u2212d), where 1 \u2264 a, b, c, d \u2264 m and a, b, c, d, m are integers.\nIt can be shown that for m = 4 there are exactly 256 valid ways to construct ABCD. Of these 256 quadrilaterals, 42 of them strictly contain a square number of lattice points.\nHow many quadrilaterals ABCD strictly contain a square number of lattice points for m = 100?", "solution": "694687", "difficulty": 15, "story": "Once upon a time, in a small village nestled in the mountains, there lived a clever young girl named Olivia. Olivia was known for her sharp mind and her unwavering curiosity, always seeking answers to the mysteries of life. One day, while exploring the attic of her old victorian home, she stumbled upon an ancient parchment covered in intricate symbols and equations. Intrigued, she carefully unraveled the mystery of the parchment, discovering a fascinating mathematical problem that would ignite her imagination.\n\nAs she studied the problem, Olivia marveled at the beauty of its complexity. It was like a puzzle waiting to be solved, a challenge that beckoned her to unravel its secrets. The problem described a quadrilateral, whose vertices were lattice points lying on the coordinate axes. Olivia visualized it in her mind, each point A, B, C, and D forming a perfect shape.\n\nShe was captivated by the coordinates - A(a, 0), B(0, b), C(\u2212c, 0), D(0, \u2212d) - it felt like a bridge between the abstract realm of mathematics and the concrete world of reality. As she continued to delve into the problem, Olivia discovered a fascinating twist.\n\nThe problem stated that for a special value of m, specifically m = 4, there were exactly 256 valid ways to construct quadrilateral ABCD. But what caught Olivia's attention the most was the fact that out of these 256 quadrilaterals, 42 of them strictly contained a square number of lattice points. It intrigued her beyond measure.\n\nJust as the sun began to set over the village, Olivia took her parchment and headed to the town square. There, she found a circle of adults engaging in animated discussions about crops, weather, and village affairs. Her eyes sparkled with an excitement that radiated as she cleared her throat and caught everyone's attention.\n\n\"Ladies, gentlemen, and dear friends,\" Olivia began, enthused. \"I have discovered a remarkable mathematical problem that I believe can unlock a hidden secret in our village.\"\n\nCuriosity sparked in their eyes, and the once buzzing crowd fell silent, eager to hear what Olivia had to share.\n\nShe continued, \"This problem involves constructing a quadrilateral, a shape with four corners, using lattice points lying on the coordinate axes. The problem states that for m = 4, there are exactly 256 valid ways to construct the quadrilateral. But what truly astounds me is that out of these 256 quadrilaterals, 42 strictly contain a square number of lattice points.\"\n\nOlivia's voice grew more impassioned with each word, and the excitement spread through the crowd like wildfire.\n\n\"Now, here is my question to all of you,\" Olivia exclaimed, her eyes shining with a mix of anticipation and hope. \"For m = 100, how many quadrilaterals ABCD strictly contain a square number of lattice points?\"\n\nThe people in the crowd exchanged glances, their minds stirring with calculations and possibilities. They marveled at the connection between mathematics and the shapes that surrounded them, the points that made up their world.\n\nWith that question hanging in the air, the villagers dispersed, heading back to their homes with newfound eagerness. Olivia's discovery had opened their minds to a new world of possibilities, merging the beauty of mathematics with the intricacies of their everyday lives.\n\nAnd so, the village remained captivated by the ancient mathematical problem, passing it down from generation to generation. The people solved complex equations while tending to their gardens, woven seamlessly into their daily routines. The quest for knowledge and understanding continued to guide them, bringing the village closer together as they strived to find the solution.\n\nAnd now, dear reader, I pose the same question to you. For m = 100, how many quadrilaterals ABCD strictly contain a square number of lattice points? Ready to let your mind wander into the realm of numbers?"}, {"id": 549, "euler_id": 549, "title": "Divisibility of factorials", "problem": "\nThe smallest number m such that 10 divides m! is m=5.\nThe smallest number m such that 25 divides m! is m=10.\n\nLet s(n) be the smallest number m such that n divides m!.\nSo s(10)=5 and s(25)=10.\nLet S(n) be \u2211s(i) for 2 \u2264 i \u2264 n.\nS(100)=2012.\n\n\nFind S(108).\n", "solution": "476001479068717", "difficulty": 15, "story": "Once upon a time in the bustling town of Mathville, there lived a brilliant young mathematician named Ethan. From a very young age, Ethan had a burning passion for numbers and patterns. His greatest joy was unraveling the mysteries of mathematics and solving complex mathematical problems.\n\nOne sunny morning, as Ethan strolled through the town center, he stumbled across a small but intriguing puzzle scrawled on the notice board of the local library. The puzzle stated:\n\n\"The smallest number m such that 10 divides m! is m=5.\nThe smallest number m such that 25 divides m! is m=10.\n\nLet s(n) be the smallest number m such that n divides m!.\nSo s(10)=5 and s(25)=10.\nLet S(n) be \u2211s(i) for 2 \u2264 i \u2264 n.\nS(100)=2012.\n\nFind S(108).\"\n\nEthan's eyes sparkled with excitement. He was captivated by the mysterious problem and instantly felt the urge to solve it. But little did he know that this mathematical riddle would take him on an extraordinary adventure that would challenge not only his intellect but also his courage.\n\nDetermined to find the solution, Ethan delved deep into his studies and spent countless hours examining the properties of divisors and factorials. He scribbled equations and diagrams on his blackboard, losing himself in a world of numbers. As the days turned into weeks and the weeks into months, his determination remained unwavering.\n\nOne chilly evening, Ethan was engrossed in his investigations when he was interrupted by the arrival of an old man named Professor Archibald, an eminent mathematician renowned for his wisdom. The professor had heard of Ethan's relentless pursuit and came to offer his guidance.\n\n\"Ethan, my young friend,\" the professor said gently, \"I see the fire in your eyes. The quest you are on is perilous, for it ventures into uncharted territory. But fear not, for I can teach you the secrets of mathematical sorcery that lie within the depths of these enigmatic numbers.\"\n\nEthan's heart soared with gratitude, feeling both humbled and honored by the professor's offer. Under Professor Archibald's guidance, Ethan's understanding of the problem deepened, and he gained new insights into the intricacies of mathematical patterns and logic.\n\nThrough their discussions, Ethan discovered that the smallest number m that satisfies the condition n divides m! could be calculated by finding the highest power of n that divides m!. That knowledge became crucial as he worked through multiple examples and identified a striking pattern emerging from the data.\n\nAs he reached S(100) equalling 2012, Ethan marveled at the power of mathematical reasoning and the beauty hidden within numbers. He knew he was on the right track and newfound confidence surged through his veins.\n\nBut as Ethan stood at the precipice of a grand triumph, he realized the daunting challenge that lay ahead. S(108) demanded his attention, and the enigmatic answer lurked just beyond his reach. Would he be able to solve this final, elusive count?\n\nWith determination etched across his face, Ethan's mind raced with calculations and possibilities. He searched for an elegant solution, one that would tie together all he had learned and observed. Every day, he delved deeper into the mathematical abyss, tirelessly seeking the answer that would complete his journey.\n\nAnd so the question remains: Can you, dear reader, find S(108), and uncover the culmination of Ethan's quest? Which sequence of numbers will unlock the mysteries of divisibility and factorial, leading to the elusive sum?\n\nThe adventure awaits, and the numbers beckon. Are you ready to embark on a journey through the fascinating world of mathematics and discover what lies at the heart of this mathematical puzzle?"}, {"id": 622, "euler_id": 622, "title": "Riffle Shuffles", "problem": "\nA riffle shuffle is executed as follows: a deck of cards is split into two equal halves, with the top half taken in the left hand and the bottom half taken in the right hand. Next, the cards are interleaved exactly, with the top card in the right half inserted just after the top card in the left half, the 2nd card in the right half just after the 2nd card in the left half, etc. (Note that this process preserves the location of the top and bottom card of the deck)\n\n\nLet s(n) be the minimum number of consecutive riffle shuffles needed to restore a deck of size n to its original configuration, where n is a positive even number.\n\nAmazingly, a standard deck of 52 cards will first return to its original configuration after only 8 perfect shuffles, so s(52)=8. It can be verified that a deck of 86 cards will also return to its original configuration after exactly 8 shuffles, and the sum of all values of n that satisfy s(n)=8 is 412.\n\n\nFind the sum of all values of n that satisfy s(n)=60.\n", "solution": "3010983666182123972", "difficulty": 15, "story": "Once upon a time in the small town of Cardville, there lived a young magician named Max. Max had been practicing magic for as long as he could remember, and he had mastered many incredible tricks. But there was one trick that had always eluded him, and it involved a deck of cards.\n\nMax had heard about a special type of shuffle called a riffle shuffle. It was said that if you performed this shuffle a certain number of times, the deck of cards would magically return to its original configuration. Intrigued by this idea, Max decided to test it out for himself.\n\nHe took a standard deck of 52 cards and split it into two equal halves. Max carefully interleaved the cards, following the instructions he had learned. After completing the shuffle, he couldn't believe his eyes. The deck had indeed returned to its original configuration!\n\nWith a sense of wonderment, Max wondered how many times he would need to perform this riffle shuffle to return a deck of 52 cards to its original configuration. He started experimenting, trying different numbers of shuffles. After several attempts, he finally found the answer. It took exactly 8 perfect shuffles to restore the deck to its original order.\n\nExcited by his discovery, Max decided to try it with a deck of 86 cards. To his surprise, it also took exactly 8 shuffles for the deck to return to its original configuration. Max couldn't help but wonder if there were other deck sizes that would require the same number of shuffles.\n\nHe spent countless hours shuffling and counting, searching for patterns and clues. After much effort, he realized that the sum of all the values of n that satisfy s(n) = 8 was 412 \u2013 the sum of the sizes of the decks that required exactly 8 shuffles to return to their original order.\n\nBut Max's journey didn't end there. He became obsessed with solving the next challenge \u2013 finding the sum of all values of n that satisfy s(n) = 60. He knew it would require an enormous amount of calculations, but he was determined to find the answer.\n\nAs Max dived deeper into his mathematical quest, his magic performances suffered. He lost the charm and creativity that had once captivated his audience. Instead, he became engulfed by numbers and equations, consumed by the elusive sum he sought.\n\nBut here lies the question: Can you solve the mathematical problem that Max became obsessed with? What is the sum of all values of n that satisfy s(n) = 60? The answer may just unlock the magic in Max's heart and bring him back to the world of enchantment and wonder."}, {"id": 694, "euler_id": 694, "title": "Cube-full Divisors", "problem": "\nA positive integer n is considered cube-full, if for every prime p that divides n, so does p3. Note that 1 is considered cube-full.\n\n\nLet s(n) be the function that counts the number of cube-full divisors of n. For example, 1, 8 and 16 are the three cube-full divisors of 16. Therefore, s(16)=3.\n\n\nLet S(n) represent the summatory function of s(n), that is S(n)=\u2211i=1ns(i).\n\n\nYou are given S(16)=19, S(100)=126 and S(10000)=13344.\n\n\nFind S(1018).\n", "solution": "1339784153569958487", "difficulty": 15, "story": "The small village of Numerica was always full of mysteries. It was said that numbers held the key to unlocking the secrets of the universe. And the villagers, armed with their love for mathematical puzzles and conundrums, believed in this wholeheartedly.\n\nIn the heart of Numerica, there lived a solitary mathematician named Professor Euler. He was a reclusive man, known for his eccentricity and his passion for numbers. Professor Euler spent his days surrounded by stacks of books and piles of papers, seeking the answers to the most perplexing mathematical problems.\n\nOne gloomy afternoon, as the rain poured down outside, Professor Euler received a letter from a secret admirer. The letter, hastily written and barely legible, contained a cryptic message. \"Seek the solution within the essence of cube-full divisors,\" it read. \"Only then shall you find the path to enlightenment.\"\n\nIntrigued by the mysterious message, Professor Euler immediately set about unraveling the enigma. He delved deep into the world of cube-full divisors, immersing himself in their properties and intricacies. After countless hours of diligent work, he discovered a pattern within the summatory function. The numbers S(16), S(100), and S(10000) formed a sequence, and his keen mathematical mind discerned the pattern hidden within.\n\nExcitement coursed through him as his discoveries led him closer to the ultimate answer. He wondered what secrets the elusive S(1018) held. How would this number change the world of mathematics?\n\nAs Professor Euler pondered these questions, a knock echoed through his door. Curiosity piqued, he answered it to find his young neighbor, Emma, standing on his doorstep. She was a lively girl with a curious nature, always seeking knowledge and adventure.\n\n\"Professor Euler!\" Emma exclaimed, her eyes shining with excitement. \"I heard you've made a breakthrough with the cube-full divisors!\"\n\nProfessor Euler smiled warmly at the eager girl. \"Yes, Emma, I've made some discoveries,\" he replied. \"But the final piece of the puzzle still eludes me.\"\n\nEmma's face fell slightly, but she quickly regained her enthusiasm. \"I can help!\" she exclaimed. \"I love solving puzzles, and maybe my fresh perspective can assist you.\"\n\nIntrigued by her enthusiasm, Professor Euler invited Emma inside. Together, they immersed themselves in the world of cube-full divisors, discussing ideas and theories. Emma's excitement and unique insights breathed new life into the professor's research.\n\nDays turned into weeks as they scrutinized the intricacies of cube-full divisors. They unearthed forgotten theorems and sought connections between obscure mathematical concepts. Their pursuit of knowledge was unyielding, driven by the burning desire to solve the mystery hidden within S(1018).\n\nBut as they dove deeper into the problem, more questions arose. The village of Numerica buzzed with excitement and anticipation, aware that a great revelation was imminent. The villagers wondered if Professor Euler and Emma would indeed unveil the secret within S(1018).\n\nAnd so, the question remains: Can Professor Euler and Emma crack the code of S(1018)? Will they uncover the secret that lies at the heart of cube-full divisors?"}, {"id": 709, "euler_id": 709, "title": "Even Stevens", "problem": "Every day for the past n days Even Stevens brings home his groceries in a plastic bag. He stores these plastic bags in a cupboard. He either puts the plastic bag into the cupboard with the rest, or else he takes an even number of the existing bags (which may either be empty or previously filled with other bags themselves) and places these into the current bag.\nAfter 4 days there are 5 possible packings and if the bags are numbered 1 (oldest), 2, 3, 4, they are:\nFour empty bags,\n1 and 2 inside 3, 4 empty,\n1 and 3 inside 4, 2 empty,\n1 and 2 inside 4, 3 empty,\n2 and 3 inside 4, 1 empty.\nNote that 1, 2, 3 inside 4 is invalid because every bag must contain an even number of bags.\nDefine f(n) to be the number of possible packings of n bags. Hence f(4)=5. You are also given f(8)=1385.\nFind f(24680) giving your answer modulo 1020202009.", "solution": "773479144", "difficulty": 15, "story": "Once upon a time in the quaint town of Numeria, there lived a peculiar man named Even Stevens. Even had a unique habit that intrigued everyone in the town. Every day for the past n days, he brought home his groceries in a plastic bag and stored them in a little cupboard in his musty old cottage.\n\nNow, this cupboard wasn't just any ordinary storage space. Even had his own quirky way of organizing his bags. Whenever he brought a bag home, he had a choice - either place it directly inside the cupboard with the others or take an even number of the existing bags and tuck them neatly into the current bag. These existing bags could either be empty or previously filled with other bags themselves.\n\nAs days turned into weeks and weeks turned into months, the townspeople began to wonder how many different ways Even could arrange his bags. They yearned for a puzzle to solve, and so they approached Even with this mathematical curiosity.\n\nAfter an unassuming visit to the town's library, Even discovered that after four days, there were precisely five possible packings for his bags. Each arrangement was distinct, yet a stroke of the magical uniqueness that Even himself possessed. The bags were numbered: 1, 2, 3, and 4.\n\nThe five possible packings of four bags were as follows:\n\n1. Four empty bags, neatly stacked upon each other, waiting patiently for a purpose.\n2. Bag 1 and Bag 2 snuggled into Bag 3, while Bags 4 remained empty, waiting for a companion.\n3. Bag 1 and Bag 3 found refuge inside Bag 4, while Bag 2 sat idle, longing for a friend.\n4. Bag 1 found companionship with Bag 2, both shared the comfort of Bag 4, while Bag 3 pouted with emptiness beside them.\n5. Bag 2 and Bag 3 nestled inside Bag 4, while Bag 1 spent the lonely hours without company.\n\nThe townspeople marveled at the patterns within Even's peculiar world. They soon realized that every bag had to contain an even number of bags, preventing any deviation from that rule.\n\nWith the newfound understanding of Even's bag arrangements, the townspeople continued their exploration of this mathematical curiosity. They found that f(8), or the number of possible packings of eight bags, was an astonishing 1385.\n\nNumbers spun around in their minds as they imagined the countless ways Even's bags could be organized. But their curiosity knew no bounds, and they thirsted for an even greater challenge.\n\nTheir attention turned to a truly titanic task \u2013 to find f(24680). How many different packings could be achieved with a staggering twenty-four thousand, six hundred, and eighty bags? The townspeople yearned to witness the grandeur hidden within this mammoth number.\n\nAs they delved deeper into their quest, the townspeople were filled with determination. They were ready to embrace the magnitude of this puzzling endeavor. But now, dear reader, it is your turn to embark on a journey through the intricacies of Even Stevens' magical cupboard.\n\nSo, tell me, can you find f(24680) and solve this mathematical marvel hidden in the depths of Numeria? What magic lies within Even's cupboard?"}, {"id": 749, "euler_id": 749, "title": "Near Power Sums", "problem": "\nA positive integer, n, is a near power sum if there exists a positive integer, k, such that the sum of the kth powers of the digits in its decimal representation is equal to either n+1 or n\u22121. For example 35 is a near power sum number because 32+52=34.\n\n\nDefine S(d) to be the sum of all near power sum numbers of d digits or less. \nThen S(2)=110 and S(6)=2562701.\n\n\nFind S(16).\n", "solution": "13459471903176422", "difficulty": 15, "story": "Once upon a time in the vibrant town of Arithmia, lived a young girl named Lily. Lily's love for mathematics was matched only by her curiosity for the mysterious and the unexplained. As the daughter of a renowned mathematician, she spent her days exploring numbers, patterns, and theories, always seeking logical solutions to life's enigmas.\n\nOne sunny afternoon, Lily received a cryptic letter in her mailbox. It was neatly sealed with wax, displaying an elegant insignia of intertwined digits and symbols. Her heart raced with excitement as she recognized the handwriting of her father, Professor Fibonacci.\n\n\"Eureka!\" shouted Lily as she rushed inside her house and tore open the letter. Her father's message was brief but filled with intrigue. It read, \"My dear Lily, I present to you a perplexing mathematical problem that holds the key to an extraordinary discovery. In the quest to uncover a hidden code, you must find the sum of all near power sum numbers up to sixteen digits. Let numerals guide your path and imagine the wonders they shall unveil. Solve it, my precious daughter, and illuminate the world with your brilliance.\"\n\nLily's eyes sparkled with a gleam of excitement and determination. She had always respected her father's passion for the unknown, and this challenge was no different. She realized that her father's request went beyond mere numbers; it was an invitation to embark on an intellectual adventure.\n\nWeeks turned into months as Lily fervently delved into the depths of her mathematical pursuit. She gathered books from the town's library, consulted with esteemed academicians, and pored over every detail she could find about near power sum numbers. Her dedication paid off, and she slowly unraveled the captivating secrets hidden within the numerical realm.\n\nIn her search, Lily discovered countless intriguing near power sum numbers. For instance, she marveled at the number 35, the product of 3 raised to the power of 2 plus 5 raised to the power of 2, which equaled 34. The enigmatic elegance of such numbers fascinated her.\n\nAs she navigated the intricate labyrinth of mathematical possibilities, Lily saw a mysterious pattern emerge. The sum of these near power sum numbers formed a sequence that she named S(d), where d represented the maximum number of digits. Lily's heart raced as she uncovered the sum of all near power sum numbers with only two digits, resulting in 110. The richness of the problem unfolded as she went further and unlocked the sum for numbers with six digits, a staggering 2,562,701.\n\nEach new revelation intensified Lily's drive to solve the ultimate puzzle. The power of imagination enchanted her as she envisioned the profound implications that awaited her once she arrived at S(16). The urge to comprehend the entirety of this mathematical phenomenon consumed her thoughts, fueling her curiosity and pushing her into uncharted territories.\n\nNow, dear reader, the path lies before you. Can you solve the enigma? Can you find the sum of all near power sum numbers of up to sixteen digits? As Lily's journey continues, she implores you to discover the truth concealed within the language of numbers. Are you ready to embrace the adventure and unlock the possibilities that await?"}, {"id": 755, "euler_id": 755, "title": "Not Zeckendorf", "problem": "\nConsider the Fibonacci sequence {1,2,3,5,8,13,21,\u2026}.\n\n\nWe let f(n) be the number of ways of representing an integer n\u22650 as the sum of different Fibonacci numbers.\nFor example, 16=3+13=1+2+13=3+5+8=1+2+5+8 and hence f(16)=4. \nBy convention f(0)=1.\n\n\nFurther we define\nS(n)=\u2211k=0nf(k)\nYou are given S(100)=415 and S(104)=312807.\n\n\nFind S(1013).\n", "solution": "2877071595975576960", "difficulty": 15, "story": "Once upon a time, in the enchanting land of Mathoria, there lived a young girl named Lila. Lila possessed a unique gift \u2013 a love for mathematics. Famous for her quick wit and problem-solving skills, she was regarded as the prodigy of Mathoria.\n\nOne fine day, while exploring the depths of her favorite library, Lila stumbled upon a dusty, ancient tome titled \"The Mystery of Fibonacci.\" Intrigued by this discovery, she carefully opened the book and began pouring over its pages. As she read, she found herself encountering a mathematical problem that piqued her interest.\n\nIn the book, Lila learned about the Fibonacci sequence \u2013 a sequence of numbers formed by adding the two previous numbers together to get the next number. She discovered the Fibonacci numbers: 1, 2, 3, 5, 8, 13, 21, and so on.\n\nBut what truly fascinated Lila was a formula called f(n). It was described as the number of ways to represent an integer n as the sum of different Fibonacci numbers. The book provided an example: 16 could be represented as 3 + 13, 1 + 2 + 13, 3 + 5 + 8, or 1 + 2 + 5 + 8. Therefore, f(16) equaled 4. The book also stated that, by convention, f(0) was 1.\n\nUnable to resist the allure of this mysterious puzzle, Lila decided to investigate further. The book introduced another formula, S(n), which represented the summation of all f(k) values from k = 0 to n. Intriguingly, it stated that S(100) equals 415 and S(104) equals 312807. \n\nThis revelation compelled Lila to embark on a quest to uncover the secret of S(1013). She realized that solving this mathematical problem could unlock unimaginable knowledge hidden within the vast realms of Mathoria.\n\nWith determination in her eyes, Lila set off on an adventurous journey across Mathoria, encountering various mathematical challenges along the way. She solved problems of angles and equations, braved treacherous geometry mazes, and even proved theorems utilizing her knowledge of Fibonacci numbers.\n\nAs Lila's quest progressed, her understanding of the Fibonacci sequence deepened. She marveled at the patterns and symmetries hidden within the sequences, feeling as though she were unravelling the fabric of the world itself through her mathematical exploration.\n\nFinally, after countless trials and tribulations, Lila reached the pinnacle of her journey. Before her stood a magnificent door, adorned with carvings depicting the Fibonacci sequence. She knew that solving S(1013) would unlock the door, granting her unparalleled wisdom and enlightenment.\n\nBut the question loomed in front of her. How could she find the value of S(1013)? Lila stood there, pondering every aspect she had learned throughout her arduous journey. The answer seemed within reach, yet shrouded in the mist of mathematical intricacy.\n\nAnd so, dear reader, the question remains for you to ponder: What is the value of S(1013)? Can you crack the code and solve this mathematical enigma?\n\nWith your brilliant mind and Lila's tenacity, the secrets of Mathoria are waiting to be unlocked."}, {"id": 822, "euler_id": 822, "title": "Square the Smallest", "problem": "\nA list initially contains the numbers 2,3,\u2026,n.\nAt each round, the smallest number in the list is replaced by its square. If there is more than one such number, then only one of them is replaced.\n\n\nFor example, below are the first three rounds for n=5:\n[2,3,4,5]\u2192(1)[4,3,4,5]\u2192(2)[4,9,4,5]\u2192(3)[16,9,4,5].\n\n\nLet S(n,m) be the sum of all numbers in the list after m rounds.\nFor example, S(5,3)=16+9+4+5=34. Also S(10,100)\u2261845339386(mod1234567891).\n\n\nFind S(104,1016). Give your answer modulo 1234567891.\n", "solution": "950591530", "difficulty": 15, "story": "In the quaint village of Numeria, nestled amidst rolling hills and meandering streams, lived a young girl named Lily. Lily was a curious and precocious child, always seeking new adventures and knowledge. Her favorite pastime was exploring the overgrown forest that bordered the village, where she would lose herself in the wonders of nature.\n\nOne sunny afternoon, as Lily ventured deeper into the forest than she had ever been before, she stumbled upon an old, dilapidated cottage. The cottage seemed to exhale a sense of mystery, beckoning her to unravel its secrets. Lily cautiously pushed open the creaking door and found herself inside a room filled with dusty old books stacked to the ceiling.\n\nIntrigued, Lily pulled out a particularly worn-out book titled \"The Enigma of Numbers.\" Excitement coursed through her veins as she flipped through the pages, revealing an intricate tale about a mathematical problem.\n\nIn this problem, a list initially contained the numbers from 2 to n. With each passing round, the smallest number in the list would be replaced by its square. But only one of them, even if there were multiple instances of the smallest number. The book described the process in great detail.\n\nLily became completely engrossed in the story, her imagination whisking her away to a fantastical world where numbers danced and intertwined. She saw herself helping a group of brave adventurers as they navigated through a labyrinth, their only hope of escape tied to solving the mathematical problem.\n\nAs the tale progressed, Lily realized that the problem was no ordinary numerical conundrum. It held an unparalleled power, affecting the very fabric of the adventurers' journey. The sum of the numbers in the list after each round, denoted as S(n, m), determined their fate.\n\nLily's heart pounded with anticipation as she read about their astonishing encounters. Each time they advanced through a round, the adventurers would witness mesmerizing displays of mathematical transformations, watching the list evolve and change in extraordinary ways.\n\nShe reveled in their triumphs and shared their frustration in their defeats, feeling their resilience in the face of adversity. The mathematical problem became enigmatic, wonderfully mysterious yet remarkably intertwined with the story's narrative.\n\nAs day turned into night, her eyes burning with exhaustion, Lily reluctantly closed the book. The moon cast a glow through the cracks in the cottage's walls, the story still echoing in her ears.\n\nNow, standing at the crossroads between fiction and reality, Lily couldn't help but wonder, was there more to this story than just words on a page? Could she discover the answer to S(104, 1016), escaping into the enigmatic world of numbers and equations?\n\nA spark ignited within Lily's mind as she gazed at the night sky, twinkling with endless possibilities. She couldn't shake the feeling that this mathematical problem held a significance greater than she could fathom.\n\nAnd so, with the weight of uncertainty on her young shoulders, Lily finds herself standing at the precipice of a thrilling quest. Will you join her in the search for answers? What will you discover? Solve the riddle of S(104, 1016), and unlock the secrets that lie within the wondrous realm of Numeria. The journey awaits."}]