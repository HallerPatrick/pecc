[{"id": 78, "euler_id": 78, "title": "Coin partitions", "problem": "Let p(n) represent the number of different ways in which n coins can be separated into piles. For example, five coins can be separated into piles in exactly seven different ways, so p(5)=7.\n\nOOOOO\nOOOO\u00a0 \u00a0O\nOOO\u00a0 \u00a0OO\nOOO\u00a0 \u00a0O\u00a0 \u00a0O\nOO\u00a0 \u00a0OO\u00a0 \u00a0O\nOO\u00a0 \u00a0O\u00a0 \u00a0O\u00a0 \u00a0O\nO\u00a0 \u00a0O\u00a0 \u00a0O\u00a0 \u00a0O\u00a0 \u00a0O\n\nFind the least value of n for which p(n) is divisible by one million.", "solution": "55374", "difficulty": 30, "story": "Once upon a time in the small village of Algebraville, lived a young girl named Lily. Lily was not your ordinary girl; she had a love for mathematics that was unparalleled. Her days were spent solving complex equations and pondering over mathematical problems. One sunny day, as she sat beneath the old oak tree, a wise old man approached her.\n\n\"Young Lily,\" the old man said with a kind smile, \"I have a problem that I believe only a brilliant mind like yours can solve.\" He handed her a piece of paper with the mathematical problem written on it.\n\nLily's eyes glimmered with excitement as she read the problem aloud, \"Let p(n) represent the number of different ways in which n coins can be separated into piles. Find the least value of n for which p(n) is divisible by one million.\"\n\nThe problem intrigued Lily, and she set off on a journey to unravel its secrets. She wandered through the village, visiting the local library, seeking inspiration in ancient texts and mathematical treatises. Days turned into weeks, weeks into months, but Lily refused to give up. She dedicated all her time and energy to finding a solution, staying up late into the night, poring over her calculations.\n\nAs Lily continued her quest, the village of Algebraville faced its own trials. The village was known for its annual Trading Festival, where merchants from far and wide came to trade their wares. This festival brought prosperity to the villagers, and they eagerly awaited its arrival each year.\n\nBut this year, disaster struck. The festival committee was faced with a grave problem \u2013 they needed to find the perfect way to distribute the shiny gold coins used for trading. They wanted to ensure that every merchant received their fair share of coins. Desperate for a solution, the committee sought Lily's help.\n\nWith determination in her eyes, Lily took up the challenge. She realized that the festival committee's problem was similar to the one she had been trying to solve for months. The coins represented the piles, and the number of ways they could be separated determined how fairly they could be distributed.\n\nUsing her mathematical prowess, Lily calculated the number of different ways in which the coins could be separated. She devised an algorithm that would ensure a fair distribution of coins to all the merchants. The committee was amazed by her ingenuity and thanked her profusely.\n\nAs the Trading Festival approached, excitement filled the air. Merchants from distant lands gathered in Algebraville, eager to participate in the grand event. The day arrived, and the village was buzzing with activity. The sound of laughter, music, and the clinking of coins filled the streets.\n\nLily watched the joyous celebrations, her heart filled with pride for what she had accomplished. But amidst the revelry, a thought niggled in the back of her mind. She realized that if she could find the least value of n for which p(n) is divisible by one million, she could potentially solve bigger problems in the future.\n\nAnd so, as the sun began to set on the Trading Festival, the question remained hovering over Lily's mind. The villagers danced to the sound of music while eager merchants traded their goods, but Lily's thoughts were consumed by the mathematical problem she had yet to solve.\n\nAs the stars twinkled above Algebraville, Lily pondered over the problem. She knew that the answer lay just beyond her reach, like a distant star waiting to be discovered.\n\nAnd so, dear reader, I pose the same question to you. What is the least value of n for which p(n) is divisible by one million? Will you be the one to unlock the secret that has eluded Lily and countless others?"}, {"id": 95, "euler_id": 95, "title": "Amicable chains", "problem": "The proper divisors of a number are all the divisors excluding the number itself. For example, the proper divisors of 28 are 1, 2, 4, 7, and 14. As the sum of these divisors is equal to 28, we call it a perfect number.\nInterestingly the sum of the proper divisors of 220 is 284 and the sum of the proper divisors of 284 is 220, forming a chain of two numbers. For this reason, 220 and 284 are called an amicable pair.\nPerhaps less well known are longer chains. For example, starting with 12496, we form a chain of five numbers:\n12496 \u2192 14288 \u2192 15472 \u2192 14536 \u2192 14264 (\u2192 12496 \u2192 ...)\nSince this chain returns to its starting point, it is called an amicable chain.\nFind the smallest member of the longest amicable chain with no element exceeding one million.", "solution": "14316", "difficulty": 30, "story": "Once upon a time, in the quiet town of Mathville, lived a young girl named Emily. Emily was known throughout the town for her exceptional aptitude for mathematics. Her love for numbers took her on countless adventures in the world of problem-solving.\n\nOne sunny day, as Emily was wandering through the bustling marketplace, she stumbled upon an unusual sight. A worn-out book rested on a vendor's table, its pages yellowed with age. Something about the book called to her, drawing her closer until she found herself holding it in her hands.\n\nCuriosity got the better of Emily, and she opened the book to discover a hidden note addressed to her. It read, \"Dear Emily, the world of mathematics needs your help. Use your keen mind to unlock the secrets within these pages and bring harmony back to Mathville. Solve the puzzle of the amicable chain, and the town will forever be grateful.\"\n\nIntrigued by the mysterious message, Emily quickly realized that the worn-out book contained a collection of ancient mathematical problems. She flipped through the pages until her eyes fell upon the page detailing the puzzle of the amicable chain.\n\n\"The smallest member of the longest amicable chain,\" Emily repeated to herself, her mind racing with possibilities. Determined to crack the code, she embarked on a thrilling mathematical journey.\n\nDays turned into weeks, and weeks turned into months, as Emily delved deep into the fascinating world of numbers. She studied the properties of perfect numbers and the enchanting amicable pairs, working tirelessly to unveil their secrets.\n\nAlong the way, Emily encountered many obstacles. Decimal fractions mocked her at every turn, and complex equations seemed determined to hold her back. Doubt crept into her mind, but she refused to give up. The town's hope rested on her young shoulders, and she couldn't let them down.\n\nAs the months went by, Emily's dedication finally paid off. In the early hours of the morning, she discovered a breakthrough. She had found the smallest member of the longest amicable chain with no element exceeding one million. Her heart swelled with triumph, and she knew that Mathville would forever be in her debt.\n\nBut the note that accompanied the puzzle had stated, \"Bring harmony back to Mathville.\" Emily realized that her mathematical achievement alone wasn't enough. The town needed more than just solutions; they needed to reignite their love for mathematics.\n\nSo, Emily organized a grand celebration in the center of Mathville. She invited residents of all ages and backgrounds, hoping to inspire them with her newfound knowledge and reignite their passion for numbers. She showcased the beauty and intricacies of mathematical patterns, proving that math wasn't just about calculations but also an expression of creativity and imagination.\n\nThe townspeople were captivated by Emily's presentation, feeling a renewed sense of wonder and excitement for the world of numbers. They cheered and applauded her efforts, grateful for the ways in which she had brought the town together through mathematics.\n\nAs the celebration came to an end, Emily stood before the crowd, a twinkle in her eyes, and a smile on her face.\n\n\"And now, my friends,\" she began, her voice resounding with the joy of discovery, \"I present to you a puzzle, a mathematical riddle that will take your minds on a journey just as it did mine.\"\n\nThe crowd listened attentively, their curiosity piqued.\n\n\"What is the smallest member of the longest amicable chain with no element exceeding one million?\" Emily asked, her voice ringing out across Mathville.\n\nThe townspeople pondered her question, their minds whirling with possibilities. And as they set off on their own mathematical quests, Emily knew that she had sparked a new love for numbers within their hearts.\n\n-------------------------------------------------------------------------------------\n\nSo, what is the smallest member of the longest amicable chain with no element exceeding one million?"}, {"id": 100, "euler_id": 100, "title": "Arranged probability", "problem": "If a box contains twenty-one coloured discs, composed of fifteen blue discs and six red discs, and two discs were taken at random, it can be seen that the probability of taking two blue discs, P(BB) = (15/21)\u00d7(14/20) = 1/2.\nThe next such arrangement, for which there is exactly 50% chance of taking two blue discs at random, is a box containing eighty-five blue discs and thirty-five red discs.\nBy finding the first arrangement to contain over 1012 = 1,000,000,000,000 discs in total, determine the number of blue discs that the box would contain.", "solution": "756872327473", "difficulty": 30, "story": "Once upon a time in the idyllic village of Numeria, there lived a young girl named Lily. Her curiosity knew no bounds, and she spent her days exploring every nook and cranny of the village, always searching for intriguing puzzles and hidden mysteries.\n\nOne sunny afternoon, while Lily was wandering through the local market, she stumbled upon a dusty old book tucked away in a forgotten corner of a vendor's stall. The book's cover was tattered and worn, but curiosity got the better of her, and she couldn't resist delving into its pages.\n\nAs she thumbed through the book, her eyes widened with excitement when she came across an enchanting mathematical problem. It spoke of boxes filled with colored discs and the probabilities associated with choosing them at random. The story captivated her, and she couldn't help but wonder how it would affect her own life.\n\nThe problem read, \"If a box contains twenty-one colored discs, composed of fifteen blue discs and six red discs, and two discs were taken at random, it can be seen that the probability of taking two blue discs, P(BB) = (15/21)\u00d7(14/20) = 1/2. The next such arrangement, for which there is exactly a 50% chance of taking two blue discs at random, is a box containing eighty-five blue discs and thirty-five red discs.\"\n\nLily's mind whirled with excitement. She couldn't help but wonder if the mathematical problem held a bigger secret. What if this problem was the key to unlocking a hidden treasure or revealing a long-lost secret of Numeria?\n\nDetermined to explore this possibility, Lily embarked on a quest to discover the first arrangement of colored discs that contained over one trillion discs. After all, the mathematical problem had stated that the number of blue discs would change in each arrangement. So, the number of blue discs in the box holding one trillion discs might hold the key she sought.\n\nShe delved into libraries, sought advice from wise elders, and spent countless nights pouring over mathematical formulas and calculations. Days turned into months, and months into years, but she persevered, fueled by her insatiable thirst for knowledge.\n\nFinally, after tirelessly searching, studying, and calculating, Lily found the answer. A box containing over one trillion discs in total would have a number of blue discs that shocked her to the core. But she couldn't reveal the secret just yet. She knew that others must embark on their own journey to discover the truth, just as she had.\n\nSo here's the question for you, dear reader: By finding the first arrangement to contain over one trillion discs in total, can you determine the number of blue discs that the box would contain? Are you ready to embark on your own quest for knowledge and uncover the secret that Lily brought to light?\n\nPonder this question, embrace the challenge, and let the mathematical problem guide you on your journey. The answer lies within the numbers, waiting patiently to be discovered. Will you be the one who unravels the secret of Numeria?"}, {"id": 108, "euler_id": 108, "title": "Diophantine reciprocals I", "problem": "In the following equation x, y, and n are positive integers.\n1x+1y=1n\nFor n = 4 there are exactly three distinct solutions:\n15+120=1416+112=1418+18=14\nWhat is the least value of n for which the number of distinct solutions exceeds one-thousand?\nNOTE: This problem is an easier version of Problem 110; it is strongly advised that you solve this one first.", "solution": "180180", "difficulty": 30, "story": "Once upon a time, in a small village nestled among rolling hills, there lived a young boy named Ethan. Ethan possessed an insatiable curiosity and had a knack for numbers. He could often be found engrossed in mathematics, eagerly solving equations and tackling logic puzzles. Unlike the other children in the village, who spent their days frolicking in the fields, Ethan found solace in the world of numbers.\n\nOne sunny afternoon, as Ethan sat beneath a towering oak tree, a piece of parchment fluttered out of the sky and landed gently at his feet. Intrigued, he picked it up and saw that it contained a mathematical problem. His eyes widened with excitement as he delved into the puzzle.\n\n\"In the following equation x, y, and n are positive integers.\n1x+1y=1n\nFor n = 4 there are exactly three distinct solutions:\n15+120=14\n16+112=14\n18+18=14\nWhat is the least value of n for which the number of distinct solutions exceeds one-thousand?\nNOTE: This problem is an easier version of Problem 110; it is strongly advised that you solve this one first.\"\n\nEthan's mind whirred with possibilities as he mulled over the problem. Every fiber of his being tingled with excitement, and he knew that this was a puzzle he couldn't resist solving. With newfound determination, he embarked on a journey to unravel the intricate mystery hidden within the equation.\n\nAs Ethan ventured from town to town, seeking answers and insights, he encountered many intellectuals and scholars who were equally intrigued by the challenge. They gathered in libraries and cafes, exchanging ideas and theories, their eyes sparkling with anticipation. The air around them crackled with the energy of their shared fascination for numbers.\n\nMonths turned into years, but Ethan never wavered in his pursuit. He dug deeper into the mathematical realm, exploring various approaches and techniques. His resolve was unwavering, for he knew that the answer to this tantalizing problem lay just within his grasp.\n\nOne evening, as dusk painted the sky in resplendent hues, Ethan stumbled upon an ancient text hidden within a dusty old bookshop. Its pages whispered secrets of ancient civilizations, their quest for knowledge, and their fascination with numbers. With trembling hands, Ethan carefully studied the faded script until he stumbled upon a revelation that could change everything.\n\nThe text spoke of a hidden formula, a cryptic code inscribed in the very fabric of the universe. It hinted at a connection between the number of distinct solutions in the equation and the prime factors of the variable n. Ethan's heart raced with excitement as he deciphered each line, piecing together the puzzle he had been yearning to solve.\n\nArmed with this newfound knowledge, Ethan returned to his village. He gathered the villagers, young and old, leading them to the village square where he stood on a makeshift stage. The anticipation in the air was palpable as Ethan held up the old parchment and revealed the question that had consumed him for years.\n\n\"What is the least value of n for which the number of distinct solutions exceeds one-thousand?\"\n\nSilence descended upon the crowd as they absorbed the weight of the question. Ethan's voice echoed through the village, filling every heart with the essence of their shared curiosity.\n\nAnd as the villagers pondered the question, their eyes shining with excitement, Ethan knew that he had changed their lives forever, igniting a spark of curiosity and wonder within their souls.\n\nNow, dear reader, it is your turn. Can you unlock the secrets buried within this equation? What is the least value of n for which the number of distinct solutions exceeds one-thousand?"}, {"id": 113, "euler_id": 113, "title": "Non-bouncy numbers", "problem": "Working from left-to-right if no digit is exceeded by the digit to its left it is called an increasing number; for example, 134468.\nSimilarly if no digit is exceeded by the digit to its right it is called a decreasing number; for example, 66420.\nWe shall call a positive integer that is neither increasing nor decreasing a \"bouncy\" number; for example, 155349.\nAs n increases, the proportion of bouncy numbers below n increases such that there are only 12951 numbers below one-million that are not bouncy and only 277032 non-bouncy numbers below 1010.\nHow many numbers below a googol (10100) are not bouncy?", "solution": "51161058134250", "difficulty": 30, "story": "Once upon a time, in the charming little town of Mathematica, there lived a young timber merchant named Ethan. His days were filled with the rhythmic sound of chopping wood, as he worked hard to provide for his family. Despite being content with his simple life, Ethan always had a curious mind, yearning to explore the mysteries hidden in numbers.\n\nOne sunny afternoon, as Ethan was taking a break from his laborious routine, he stumbled across an old mathematics book that had been forgotten in a dusty corner of the library. His eyes lit up with excitement as he opened it, and he was instantly captivated by a particular problem.\n\nThe problem asked him to determine the number of positive integers below a googol (10^100) that were not bouncy. It defined an increasing number as one where each digit was not exceeded by the digit to its left, and a decreasing number as one where each digit was not exceeded by the digit to its right. Anything that did not fit into either category was called a \"bouncy\" number.\n\nAs Ethan delved further into the book, he discovered that bouncy numbers had a certain allure. Not only were they intriguing to solve, but they also mirrored the unpredictability of life itself. It dawned on him that these numbers were much like the unpredictable twists and turns that fate often throws at us.\n\nDeeply absorbed in his newfound learning, Ethan's once simple life began to change. He found himself pondering the concept of bouncy numbers by observing everything around him. The restless river that flowed near his home, the trees swaying in the gentle breeze, and the laughter of his children bouncing off the walls of his cozy cottage -- all of these seemed to be reflections of the enigmatic bouncy numbers.\n\nAs days turned into weeks, and weeks into months, Ethan's obsession with bouncy numbers grew. He would spend hours lost in thought, scribbling calculations, and pondering the mysterious relationship between numbers and the world around him. His passion for mathematics became unstoppable, and it permeated every aspect of his life.\n\nThen, one fateful evening, Ethan stumbled upon a breakthrough while watching the mesmerizing dance of fireflies in his backyard. A thought flashed through his mind\u2014a revelation that could unlock the secrets of the mathematical problem that had consumed him for so long.\n\nBut here lies the crossroads of our story. Will Ethan choose to continue on his mathematical journey, pushing the boundaries of knowledge, or will he realize that life's true beauty lies in embracing the mysterious and focusing on the simple joys it has to offer?\n\nCan you solve the mathematical problem that has entranced young Ethan's mind? How many numbers below a googol (10^100) are not bouncy?"}, {"id": 116, "euler_id": 116, "title": "Red, green or blue tiles", "problem": "A row of five grey square tiles is to have a number of its tiles replaced with coloured oblong tiles chosen from red (length two), green (length three), or blue (length four).\nIf red tiles are chosen there are exactly seven ways this can be done.\n\n\nIf green tiles are chosen there are three ways.\n\n\nAnd if blue tiles are chosen there are two ways.\n\n\nAssuming that colours cannot be mixed there are 7 + 3 + 2 = 12 ways of replacing the grey tiles in a row measuring five units in length.\nHow many different ways can the grey tiles in a row measuring fifty units in length be replaced if colours cannot be mixed and at least one coloured tile must be used?\nNOTE: This is related to Problem 117.", "solution": "20492570929", "difficulty": 30, "story": "Once upon a time, in the vibrant village of Numeria, there lived a young and talented artist named Mia. Mia had a unique gift for creating beautiful mosaics using various colored square tiles. The villagers adored her work, and she was often sought after for intricate commissions. \n\nOne sunny morning, as Mia strolled along the cobblestone streets, she came across a peculiar notice pinned to a tree. It was a challenge, issued by the wise but mischievous mathematician, Professor Arithmara. The notice posed a question, enticing Mia's curiosity and artistic intellect.\n\nIntrigued by the challenge, Mia took a deep breath and began to read the notice aloud. \"A row of five grey square tiles is to have a number of its tiles replaced with colored oblong tiles chosen from red, green, or blue.\"\n\nHesitating for a moment, Mia continued reading, \"If red tiles are chosen, there are exactly seven ways this can be done. If green tiles are chosen, there are three ways. And if blue tiles are chosen, there are two ways.\"\n\nMia's eyes widened with excitement. The challenge intrigued her artistic mind, and she decided to seek out the professor to learn more. After asking around, Mia discovered the hiding place of Professor Arithmara\u2014a hidden library nestled deep within a nearby forest.\n\nAs Mia entered the library, she was mesmerized by the shelves filled with countless books on mathematics, art, and history. Finally, she found the old professor sitting at a wooden table, engrossed in a book, his eyes twinkling with a sense of mischief.\n\n\"Ah, young artist,\" the professor greeted Mia. \"I see you've accepted my challenge. Have you come seeking answers, or perhaps, have you found a path towards a greater understanding?\"\n\n\"Well, both actually,\" Mia replied, her voice filled with excitement. \"I wish to solve the problem and create something remarkable with my artistic skills.\"\n\nThe professor smiled, his wrinkled face lit up with delight. He began explaining that choosing colored tiles was much like selecting brushstrokes of different colors and lengths. \"Each arrangement yields a unique aesthetic, a mosaic that tells a story,\" he said.\n\nEager to explore the possibilities, Mia studied the professor's mathematical formulas and elegant demonstrations. She quickly realized that the number of ways to replace the grey tiles in a row of five units was indeed 7 + 3 + 2 = 12.\n\n\"But, Professor,\" Mia asked as she pondered over the problem, \"How many different ways can the grey tiles in a row measuring fifty units in length be replaced if colors cannot be mixed, and at least one colored tile must be used?\"\n\nThe professor gazed at Mia, his eyes sparkling with intrigue. \"Ah, that is a question that will truly test your artistic prowess and mathematical acumen,\" he replied. \"Perhaps the answer lies within the patterns that emerge when the tiles align. Just like a kaleidoscope, the possibilities are endless.\"\n\nWith those enigmatic words, Professor Arithmara gestured toward the library's shelves, urging Mia to explore further. Filled with determination, Mia began to immerse herself in the fascinating world of mathematical patterns and artistic possibilities.\n\nNow, dear reader, we challenge you. Can you solve the riddle that eluded Mia? How many different ways can the grey tiles in a row measuring fifty units in length be replaced if colors cannot be mixed, and at least one colored tile must be used?"}, {"id": 119, "euler_id": 119, "title": "Digit power sum", "problem": "The number 512 is interesting because it is equal to the sum of its digits raised to some power: 5 + 1 + 2 = 8, and 83 = 512. Another example of a number with this property is 614656 = 284.\nWe shall define an to be the nth term of this sequence and insist that a number must contain at least two digits to have a sum.\nYou are given that a2 = 512 and a10 = 614656.\nFind a30.", "solution": "248155780267521", "difficulty": 30, "story": "Once upon a time in the quaint town of Numeroville, there lived a brilliant yet eccentric mathematician named Professor Albert. Known for his unmatched genius and passion for numbers, Professor Albert spent his days pondering over the mysteries and wonders hidden within mathematics.\n\nOne sunny morning, Professor Albert received a mysterious letter from an anonymous source. Intrigued, he carefully opened the envelope and found a perplexing mathematical problem written inside. The problem stated that the number 512 was unique because it could be represented as the sum of its digits raised to some power. Fascinated by this enigma, the professor decided to investigate further.\n\nHe began diligently crunching numbers, experimenting with different combinations and powers, but the solutions remained elusive. Weeks turned into months, and Professor Albert grew more determined than ever to unlock the answers hidden within these curious sequences. As he delved into his research, he discovered a startling pattern - a sequence of numbers that followed the same intriguing property.\n\nThe professor christened this sequence \"The Powers of Digits.\" He found that each term in the sequence was the result of summing its digits raised to a particular power. For example, the second term, a2, was 512, with 5 + 1 + 2 = 8, and 8\u00b3 = 512. Similarly, the tenth term, a10, was 614656, with 6 + 1 + 4 + 6 + 5 + 6 = 28, and 28\u2074 = 614656.\n\nAs the months turned into years, Professor Albert's obsession with the sequence consumed his life. He built a wall filled with countless equations, number combinations, and charts, seeking to understand the underlying logic. The townsfolk whispered about the eccentric professor, wondering why he dedicated his entire existence to these peculiar digits.\n\nLittle did they know that the answer to the puzzle held far greater significance than anyone could imagine. Hidden within the enigma of these numbers was the key to unlocking an unimaginable power, capable of shaping the world around them. Professor Albert had sensed it, and his relentless pursuit was driven by a fear of the consequences if such power fell into the wrong hands.\n\nNow, as Professor Albert stood at the precipice of his lifelong quest, he realized that he was closing in on the thirtieth term of the sequence, a30. The answer to this question would determine whether he possessed the power to protect humanity or if he should seal away the secrets forever.\n\nThe sun dipped below the horizon as the professor gazed intently at his calculations, his mind buzzing with anticipation. Hours turned into days as he retreated into his study, the world outside fading away as he wrestled with this final piece of the puzzle. As he neared an answer, the weight of the numerical responsibility overwhelmed him.\n\nAt last, Professor Albert emerged from his study, his face etched with exhaustion and triumph. But he was not yet ready to reveal the solution. He had spent too long on this journey, for it was more than a mere mathematical problem. It was an enigma he had woven into the tapestry of his life, and the resolution held the power to change everything.\n\nSo, dear reader, I pose this question to you: Can you solve the riddle of a30? Can you decipher the code that hides within these powerful digits? The fate of Numeroville, and perhaps the entire world, depends on your answer."}, {"id": 123, "euler_id": 123, "title": "Prime square remainders", "problem": "Let pn be the nth prime: 2, 3, 5, 7, 11, ..., and let r be the remainder when (pn\u22121)n + (pn+1)n is divided by pn2.\nFor example, when n = 3, p3 = 5, and 43 + 63 = 280 \u2261 5 mod 25.\nThe least value of n for which the remainder first exceeds 109 is 7037.\nFind the least value of n for which the remainder first exceeds 1010.", "solution": "21035", "difficulty": 30, "story": "Once upon a time, in the picturesque town of Numeria, lived a curious young girl named Lily. Lily had always been fascinated by numbers, with their patterns and hidden secrets. She spent her days poring over her father's old mathematics books, delving into the world of prime numbers, and solving intricate mathematical problems.\n\nOne sunny afternoon, Lily stumbled upon a particularly captivating problem in one of the books. It was about primes and remainders, but what caught her attention was the notion that there existed a specific value of \"n\" for which the remainder would first exceed a baffling number - 10 to the power of 10!\n\nEager to solve this riddle that captivated her mind, Lily set off on a mathematical adventure. She went to the heart of town to seek the wisdom of Professor Euler, reputed to be the most knowledgeable mathematician in all the land.\n\nProf. Euler greeted Lily warmly and listened intently as she described her newfound mathematical problem. Wrinkling his brow in deep thought, he asked her, \"Have you ever considered how much power rests in the hands of the primes, my dear Lily?\"\n\nLily shook her head, her eyes wide with curiosity. \"I haven't, Professor. But can you show me, please?\"\n\nSmiling, Prof. Euler brought out a small blackboard and began to write equations and numbers, filling the air with a sense of enchantment. \"Let's take a prime number, say 'p,' and its corresponding index 'n'. Now, we'll raise 'p' minus one to the power of 'n' and add 'p' plus one raised to the power of 'n.' Finally, we'll divide this sum by 'p' squared. The remainder we obtain will be our key.\"\n\nLily watched eagerly as the professor wrote down the equation:\n(pn\u22121)n + (pn+1)n mod pn2\n\n\"By calculating this remainder for different values of 'n,' we gradually unlock the hidden patterns hidden within primes,\" Prof. Euler explained. \"Now, my clever Lily, you mentioned that the least value of 'n' for which the remainder first exceeds 10 to the power of 9 is 7037. How fascinating! But the real question is: what is the least value of 'n' for which the remainder will first exceed 10 to the power of 10? Can you find this for us?\"\n\nLily's eyes sparkled with determination. She thanked the professor for his guidance and left, excited to embark on her mathematical quest. She knew that this time, she needed to immerse herself in deeper layers of the enigmatic world of primes.\n\nAs Lily delved further into her studies, she became more captivated by the elegant dance of numbers. She spent countless nights scribbling equations and cracking codes, venturing closer to the elusive answer. More than solving the problem, she yearned to understand the true nature of primes and how they formed the bedrock of the mathematical universe.\n\nWeeks turned into months, and months into years, yet Lily never lost hope. Her mind was filled with dreams of unlocking the next layer of the puzzle, of finding the hidden pattern that would guide her closer to the solution. The more she dug into the depths of the mathematical problem, the more she realized that it wasn't just about numbers; it was about solving the mysteries of life itself.\n\nAnd now, dear reader, as you follow Lily on her journey, we ask you: What is the least value of 'n' for which the remainder first exceeds 10 to the power of 10? Can you help unlock this numerical secret that has entranced our young protagonist?\n\nThe answer lies within the realm of numbers, waiting to be discovered by a curious mind. So, will you take up the challenge and solve the mathematical problem that has entranced Lily's world of Numeria?"}, {"id": 173, "euler_id": 173, "title": "Using up to one million tiles how many different \"hollow\" square laminae can be formed?", "problem": "We shall define a square lamina to be a square outline with a square \"hole\" so that the shape possesses vertical and horizontal symmetry. For example, using exactly thirty-two square tiles we can form two different square laminae:\n\n\nWith one-hundred tiles, and not necessarily using all of the tiles at one time, it is possible to form forty-one different square laminae.\nUsing up to one million tiles how many different square laminae can be formed?", "solution": "1572729", "difficulty": 30, "story": "Once upon a time in the land of Equazia, there lived a legendary couple named Ada and Alan. Ada was a master mathematician, renowned for her ability to find beauty and patterns in even the most complex equations. Alan, on the other hand, was an architect known for his stunning designs and innovative creations. Their love story was as legendary as their skills, and their shared passion for mathematics and art knew no bounds.\n\nOne sunny morning, Ada was sitting in her study, engrossed in her research. She stumbled upon an intriguing problem - the concept of square laminae. As she delved deeper into the subject, she discovered the fascinating possibility of creating various square outlines with square \"holes\" using a given number of tiles.\n\nExcited to share her discovery with Alan, Ada headed to his workshop. When she arrived, she found Alan inspecting an intricate blueprint for a new building. The sight of Alan using mathematics to bring his architectural visions to life never ceased to amaze her.\n\n\"Alan, my love,\" Ada said, unable to hide her enthusiasm, \"I've stumbled upon something truly fascinating today. It's a mathematical problem called square laminae.\"\n\nIntrigued, Alan put down his blueprint and turned his full attention to Ada. \"Tell me more.\"\n\nAda eagerly explained the concept to Alan, how it involved forming square outlines with square \"holes\" using a specific number of tiles. She showed him the examples she had discovered.\n\nAs they sat side by side, Alan's eyes illuminated with excitement. \"These formations are truly captivating, Ada. Imagine the endless possibilities we could explore in our designs.\"\n\nFor days and nights, Ada and Alan immersed themselves in this newfound mathematical realm. They realized that creating these intricate patterns could unlock a new level of beauty in their architectural endeavors. Together, they spent countless hours experimenting, tirelessly working to find more and more combinations of square laminae.\n\nAs the months passed, Ada and Alan's passion for square laminae grew stronger. They couldn't help but wonder how many different square laminae could be formed using up to one million tiles.\n\nTheir thoughts consumed by this mathematical enigma, Ada and Alan knew that their journey was far from over. They yearned to find the answer, to uncover the mysteries hidden within these square laminae.\n\nAnd so, dear reader, we invite you to join Ada and Alan on their quest. Can you solve the puzzle that has enchanted their minds and captivated their souls? Using up to one million tiles, how many different square laminae can be formed?"}, {"id": 204, "euler_id": 204, "title": "Generalised Hamming Numbers", "problem": "A Hamming number is a positive number which has no prime factor larger than 5.\nSo the first few Hamming numbers are 1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15.\nThere are 1105 Hamming numbers not exceeding 108.\nWe will call a positive number a generalised Hamming number of type n, if it has no prime factor larger than n.\nHence the Hamming numbers are the generalised Hamming numbers of type 5.\nHow many generalised Hamming numbers of type 100 are there which don't exceed 109?", "solution": "2944730", "difficulty": 30, "story": "Once upon a time in the mystical land of Arithmos, there lived a young girl named Eve. Despite her tender age, Eve possessed an insatiable curiosity for numbers and mathematics. Her days were spent exploring the vast library of knowledge, seeking answers to the countless questions that danced in her bright eyes.\n\nHer favorite place in the library was a secluded corner where ancient scrolls were stacked high. Among the dusty tomes, Eve discovered a weathered parchment that piqued her interest. It spoke of a peculiar class of numbers called Hamming numbers, which fascinated her young mind. Determined to understand their secrets, Eve delved into the essence of these enigmatic integers.\n\nEve learned that a Hamming number was a positive number that had no prime factor larger than 5. The parchment continued, listing the first few Hamming numbers: 1, 2, 3, 4, 5, 6, 8, 9, 10, 12, and 15. Fascinated, Eve craved to explore further and see how these numbers intertwined with the world around her.\n\nAs she read on, her eyes fell upon a remarkable piece of information. There were precisely 1105 Hamming numbers not exceeding 108. However, Eve's relentless curiosity demanded more. She yearned to understand the nature of these Hamming numbers in greater depth.\n\nThe scroll introduced a concept called \"generalized Hamming numbers.\" These were positive numbers that had no prime factor larger than a given value, which was denoted as n. The previous Hamming numbers were merely a subset of the generalized Hamming numbers of type 5.\n\nDriven by the desire to unlock the secrets of these magical numbers, Eve pondered what other possibilities lay waiting to be discovered. She wondered how many generalized Hamming numbers of type 100 existed, which did not exceed a staggering 109. The inhabitants of Arithmos needed to know, for it would unravel the very fabric of their numerical existence.\n\nEve's heart raced with excitement. She realized that she had stumbled upon something extraordinary. The discovery of the generalization of Hamming numbers could reshape the way her people understood and interacted with numbers. Determined to find the answer, Eve embarked on a quest, carried forward by her boundless inquisitiveness.\n\nShe traveled far and wide, consulting with sages and mathematicians who were amazed by her profound understanding of numbers at such a tender age. Their guidance provided her with valuable insights and equations to solve. Armed with newfound knowledge, Eve utilized every tool she had honed in the ancient libraries to methodically calculate the answer.\n\nAs the sun set on the horizon, casting a golden glow over the land of Arithmos, Eve arrived at the precipice of her quest. Tired but resolute, she knew she had uncovered something extraordinary. The answer to the problem was within her grasp, poised to intertwine with the story that had brought her here.\n\nAnd thus, dear reader, the tale reaches its pivotal point. The question now rests in your hands. Do you have the mathematical prowess to solve the enigma Eve uncovered? How many generalized Hamming numbers of type 100 are there that don't exceed the mighty number 109?\n\nWith these inspiring words, the story closes, leaving you to ponder the mystery exposed within. Take up the mantle, embrace Eve's insatiable curiosity, and unravel the mathematical secret she discovered. The answers, as well as the wonders of Arithmos, await your enlightened mind."}, {"id": 293, "euler_id": 293, "title": "Pseudo-Fortunate Numbers", "problem": "\nAn even positive integer N will be called admissible, if it is a power of 2 or its distinct prime factors are consecutive primes.\nThe first twelve admissible numbers are 2,4,6,8,12,16,18,24,30,32,36,48.\n\n\nIf N is admissible, the smallest integer M > 1 such that N+M is prime, will be called the pseudo-Fortunate number for N.\n\n\nFor example, N=630 is admissible since it is even and its distinct prime factors are the consecutive primes 2,3,5 and 7. \nThe next prime number after 631 is 641; hence, the pseudo-Fortunate number for 630 is M=11.\nIt can also be seen that the pseudo-Fortunate number for 16 is 3.\n\n\nFind the sum of all distinct pseudo-Fortunate numbers for admissible numbers N less than 109.\n", "solution": "2209", "difficulty": 30, "story": "Once upon a time in a small village named Arithmania, there lived a young girl named Alice. Alice was known for her love of numbers, often spending her days exploring mathematical concepts with her father, who was a renowned mathematician. One day, as Alice was going through her father's dusty old books in search of a new problem to solve, she stumbled upon a puzzling question that caught her attention.\n\nLost in the pages of ancient scrolls, Alice discovered a mathematical problem that seemed like a riddle. It described a special type of number called an admissible number. An admissible number is defined as an even positive integer that either is a power of 2 or has distinct prime factors that are consecutive primes. Alice was intrigued by this concept, as she had never encountered such a classification before.\n\nTo better understand the problem, Alice read the example it provided. It described how a number, 630, was admissible because it was even and had distinct prime factors that were consecutive primes. The problem further stated that the smallest integer, M, greater than one, which, when added to N, resulted in a prime number, is called the pseudo-Fortunate number for N. In this case, the pseudo-Fortunate number for 630 was found to be 11.\n\nAs Alice delved deeper into the problem, she realized that the pseudo-Fortunate number for a given admissible number was a unique concept. Each admissible number possessed its own pseudo-Fortunate number based on its distinct prime factors and their arrangement. This revelation sparked an idea in Alice's curious mind.\n\nEager to explore this fascinating mathematical problem, Alice decided to embark on a journey to find all the admissible numbers and their corresponding pseudo-Fortunate numbers less than 109. Armed with her newfound knowledge, she knew that she had to search for even numbers that were powers of 2 or had prime factors arranged consecutively.\n\nWith an unwavering determination and a heart full of excitement, Alice began her quest. She visited libraries, studied historical records, and consulted mathematicians from far and wide. Along her journey, she encountered perplexing mathematical puzzles and crossed paths with fascinating characters who shared her passion for numbers.\n\nAs the days turned into weeks, and the weeks into months, Alice diligently searched for admissible numbers. She meticulously calculated their pseudo-Fortunate numbers, recording each discovery in her trusty notebook. The numbers seemed to dance off the pages, forming a beautiful pattern that delighted both her mind and soul.\n\nThrough her tireless efforts, Alice began piecing together the puzzle of admissible numbers and their pseudo-Fortunate companions. She marveled at the elegance of mathematics, how a seemingly simple problem grew into a labyrinth of numbers with infinite possibilities.\n\nBut as Alice delved deeper into her exploration, she couldn't help but wonder about the sum of all distinct pseudo-Fortunate numbers for admissible numbers less than 109. Would there be a pattern or an overarching mathematical formula that could help her find the answer? Or would she need to rely on her own perseverance and intuition to solve this mathematical mystery?\n\nWith a glimmer of excitement in her eyes, Alice finished her journey, returning to Arithmania. As she sat in her study, surrounded by her notebooks and calculations, she pondered the question that had consumed her thoughts for so long. The sum of all distinct pseudo-Fortunate numbers for admissible numbers less than 109 eluded her, but she knew that the answer lay hidden within the intricate web of numbers and patterns she had uncovered.\n\nAnd so, dear reader, I leave you with Alice's question: Can you find the sum of all distinct pseudo-Fortunate numbers for admissible numbers less than 109? Venture into the realm of numbers, unravel the secrets of admissible numbers and their pseudo-Fortunate companions, and perhaps you will uncover the answer that Alice seeks. May the beauty of mathematics guide you on this quest."}, {"id": 313, "euler_id": 313, "title": "Sliding game", "problem": "In a sliding game a counter may slide horizontally or vertically into an empty space. The objective of the game is to move the red counter from the top left corner of a grid to the bottom right corner; the space always starts in the bottom right corner. For example, the following sequence of pictures show how the game can be completed in five moves on a 2 by 2 grid.\n\nLet S(m,n) represent the minimum number of moves to complete the game on an m by n grid. For example, it can be verified that S(5,4) = 25.\n\nThere are exactly 5482 grids for which S(m,n) = p2, where p < 100 is prime.\nHow many grids does S(m,n) = p2, where p < 106 is prime?", "solution": "2057774861813004", "difficulty": 30, "story": "Once upon a time, in a land far away, there existed a magical kingdom called Numeria. In this kingdom, numbers held immense power and were revered by all its inhabitants. The people of Numeria were not only known for their love of numbers but also for their passion for games. One such game was the sliding game, which brought both joy and challenge to the residents of the kingdom.\n\nIn Numeria, there lived a young mathematician named Lila who had an extraordinary talent for numbers. Lila was not only known for her mathematical prowess but also for her curious and adventurous nature. One day, while wandering through an old bookshop, Lila stumbled upon a worn-out diary, its pages filled with intriguing puzzles and riddles.\n\nAs she perused through the pages, one particular puzzle caught her eye. It was a sliding game that involved moving a red counter from the top left corner of a grid to the bottom right corner. The challenge lay in finding the minimum number of moves required to complete the game. Lila was instantly captivated by the problem and couldn't help but wonder about the possible solutions.\n\nUnable to resist the lure of the puzzle, Lila embarked on a journey through Numeria to seek the answers she sought. She travelled to distant towns and villages, seeking the wisdom of the great mathematicians and scholars who resided there. Along the way, she encountered a kind old sage named Thaddeus, renowned for his mathematical genius.\n\nThaddeus greeted Lila with a warm smile and listened intently as she explained the sliding game puzzle she had come across. He nodded, deep in thought, and began to offer his insights. Thaddeus explained that the grid size mattered in determining the minimum number of moves required to complete the game.\n\n\"In this case, the challenge lies in finding the grids where the solution, denoted as S(m,n), is equal to p^2,\" Thaddeus explained, his eyes sparkling with excitement. \"Here, p represents a prime number below 100, creating a range of possibilities.\"\n\nLila marveled at the mathematical complexity underlying such a simple game. She understood that finding the number of grids where S(m,n) equaled a prime squared number could hold the key to unlocking the wonders of Numeria. Thaddeus urged her to explore further, promising that the answer she sought would lead to a discovery beyond her wildest dreams.\n\nEmboldened by Thaddeus' words, Lila delved even deeper into the world of numbers. She spent hours studying the patterns and intricacies of the sliding game, determined to uncover the secrets hidden within. As day turned to night, her excitement grew. The path to the answer seemed within her grasp, and she yearned to solve the puzzle that had consumed her thoughts.\n\nBut as Lila came closer to her goal, she began to ponder an important question. How many grids would she find where S(m,n) equaled a prime squared number, given that p was less than 10^6 and prime? The magnitude of the inquiry weighed heavily on her, for it held the potential to revolutionize the entire field of mathematics.\n\nAnd so, dear reader, the question remains, waiting to be solved. How many grids in Numeria possess this remarkable property, where S(m,n) equals a prime squared value? Can you, with all your mathematical acumen, unlock the secrets that have eluded even the brightest minds in Numeria? The answer lies within your grasp."}, {"id": 321, "euler_id": 321, "title": "Swapping Counters", "problem": "A horizontal row comprising of 2n + 1 squares has n red counters placed at one end and n blue counters at the other end, being separated by a single empty square in the centre. For example, when n = 3.\n\nA counter can move from one square to the next (slide) or can jump over another counter (hop) as long as the square next to that counter is unoccupied.\n\nLet M(n) represent the minimum number of moves/actions to completely reverse the positions of the coloured counters; that is, move all the red counters to the right and all the blue counters to the left.\nIt can be verified M(3) = 15, which also happens to be a triangle number.\nIf we create a sequence based on the values of n for which M(n) is a triangle number then the first five terms would be:\n1, 3, 10, 22, and 63, and their sum would be 99.\nFind the sum of the first forty terms of this sequence.", "solution": "2470433131948040", "difficulty": 30, "story": "Once upon a time in a humble village nestled in the heart of a vast kingdom, there lived two rival families - the Reds and the Blues. For generations, these two families had been locked in a bitter feud, each believing that their own color was the superior one. Despite the animosity that tainted their relationship, they lived side by side on a long, horizontal street lined with houses.\n\nIn one particular house, lived a young boy named Simon. Simon was a peculiar child with a curious mind and a penchant for puzzles. Every day after school, he would rush home, eager to challenge himself with a new mathematical problem. His favorite book was filled with intriguing puzzles, equations, and riddles that fueled his imagination.\n\nOne fateful day, Simon stumbled upon a peculiar problem that caught his attention. It involved a row of squares, with a specific configuration of red and blue counters. The objective was to reverse the positions of all the counters, moving the red ones to the right and the blue ones to the left. Simon found himself instantly captivated by it.\n\nSitting at his desk, Simon contemplated the problem, deeply engrossed in the puzzle. He visualized the row of squares in his mind, imagining every move and action possible. \"How can I rearrange the counters to achieve the desired result?\" he pondered.\n\nDriven by his insatiable curiosity, Simon dedicated his days and nights to exploring the intricacies of the problem. He experimented with various strategies, tirelessly moving counters from one square to another, either sliding them or hopping over others. With each attempt, he counted the number of moves required to achieve the solution.\n\nGradually, Simon began to grasp the underlying rules and patterns of the puzzle. He marveled at the elegance of mathematics, uncovering the secrets hidden within the problem's simple structure. The idea of finding the minimum number of moves to reverse the positions of the counters fascinated him deeply, as it combined logic, strategy, and calculation.\n\nAs Simon's prowess in solving the problem grew, he eventually realized a striking pattern. The number of moves required to solve the puzzle in each configuration formed a sequence. Intrigued, he continued to explore this sequence, discovering that some of the values represented triangular numbers.\n\nIn his excitement, Simon scribbled down the values he had found \u2013 1, 3, 10, 22, and 63. He pondered over their significance, amazed at how a geometric shape like a triangle could be so closely connected to a seemingly unrelated problem of moving counters. He understood that these numbers were the smallest values required to complete the reversal in various scenarios.\n\nDriven by his insatiable thirst for knowledge, Simon wondered if there was a way to find the sum of the first forty terms of this sequence. How would the triangular numbers be related to the red and blue counters? What deeper truth lay hidden within the numbers?\n\nWith an excited spark in his eyes, Simon knew he had stumbled upon something profound. The pursuit of the answer would undoubtedly lead him on yet another magnificent mathematical adventure. And so, he embarked on a new quest, unleashing the full force of his mathematical prowess to solve this tantalizing puzzle.\n\nNow it is your turn. Can you uncover the hidden truth behind the sequence of triangular numbers? What is the sum of the first forty terms?"}, {"id": 340, "euler_id": 340, "title": "Crazy Function", "problem": "\nFor fixed integers a, b, c, define the crazy function F(n) as follows:\nF(n) = n - c for all n > b \nF(n) = F(a + F(a + F(a + F(a + n)))) for all n \u2264 b.\n\nAlso, define S(a,b,c)=\u2211n=0bF(n).\n\nFor example, if a = 50, b = 2000 and c = 40, then F(0) = 3240 and F(2000) = 2040.\nAlso, S(50, 2000, 40) = 5204240.\n\n\nFind the last 9 digits of S(217, 721, 127).\n", "solution": "291504964", "difficulty": 30, "story": "Once upon a time in a small village nestled at the foot of a majestic mountain range, there lived a young boy named Noah. Noah was a curious and imaginative child who loved to spend his days exploring the surrounding forests, questioning everything he saw.\n\nOne sunny afternoon, as Noah was venturing deeper into the woods, he stumbled upon a mysterious old book tucked beneath the roots of a gnarled oak tree. Intrigued, he carefully dusted off the cover and opened it to find a collection of mathematical riddles and puzzles.\n\nHis eyes widened as he read the first entry:\n\n\"For fixed integers a, b, c, define the crazy function F(n) as follows:\nF(n) = n - c for all n > b \nF(n) = F(a + F(a + F(a + F(a + n)))) for all n \u2264 b.\n\nAlso, define S(a,b,c)=\u2211n=0bF(n).\n\nFind the last 9 digits of S(217, 721, 127).\"\n\nNoah's mind was consumed with thoughts of this intricate mathematical problem. He could feel the weight of its importance, sensing that it held more than just numerical significance. As the days went by, he couldn't help but wonder what secrets lay within those ancient pages.\n\nNight after night, Noah huddled beneath his blanket, desperately trying to unravel the enigma that had captivated his thoughts. On many occasions, he found himself drifting off to sleep, dreaming of numbers cascading through his mind like a mesmerizing dance.\n\nOne evening, as the sun painted the sky with hues of orange and pink, Noah stumbled across an extraordinary discovery. Hidden within a forgotten corner of his village library, Noah found an ancient map that depicted the mountain range that surrounded their humble abode.\n\nWith hopeful eyes, Noah traced the lines of the map, searching for any clue that could lead him closer to the answers he sought. And then, he found it\u2014a narrow path winding its way up the tallest peak, marked with symbols that mirrored the ones from his mysterious book.\n\nHeart pounding with excitement and anticipation, Noah made up his mind. He would embark on a journey to the summit, guided by the whispers of the ancient riddle. Each step he took brought him closer to enlightenment, as if the answers resonated within the very core of the mountain.\n\nAs he finally reached the pinnacle, a burst of radiant sunlight pierced through the clouds, enveloping Noah in an ethereal glow. The wind whispered secrets in his ears, and the ground beneath him seemed to vibrate with hidden knowledge.\n\nImmersed in the mystical atmosphere, Noah closed his eyes, allowing his mind to soar through the complexities of the mathematical problem. The solution seemed just within his grasp, a shimmering mirage he yearned to seize. But before he could make sense of it all, he felt a gentle tug, pulling him back to reality.\n\nOpening his eyes, Noah found himself standing before a simple wooden plaque engraved with a question:\n\n\"Find the last 9 digits of S(217, 721, 127).\"\n\nAnd so, dear reader, I leave you with this question. Can you solve the mathematical puzzle that captivated Noah's imagination? Can you decipher the ancient riddle and unveil the secrets hidden within? The journey awaits, and the answer lies in the mysterious depths of numbers. Can you find it?"}, {"id": 371, "euler_id": 371, "title": "Licence plates", "problem": "\nOregon licence plates consist of three letters followed by a three digit number (each digit can be from [0..9]).\nWhile driving to work Seth plays the following game:\nWhenever the numbers of two licence plates seen on his trip add to 1000 that's a win.\n\n\nE.g. MIC-012 and HAN-988 is a win and RYU-500 and SET-500 too (as long as he sees them in the same trip). \n\n\nFind the expected number of plates he needs to see for a win.\nGive your answer rounded to 8 decimal places behind the decimal point.\n\n\nNote: We assume that each licence plate seen is equally likely to have any three digit number on it.\n", "solution": "40.66368097", "difficulty": 30, "story": "Once upon a time in the small town of Brooksville, there lived a man named Seth who had a very peculiar, yet entertaining habit. Every morning on his way to work, he played a game of numbers with the passing cars' license plates. Seth loved numbers, and there was always a touch of excitement in his eyes as he embarked on his daily game.\n\nThe rules were simple but challenging. Driving around town, Seth looked closely at each license plate that crossed his path, hoping to find a particular combination. Oregon license plates consisted of three letters followed by a three-digit number. If the sum of the two license plates he saw on his trip added up to 1000, it was considered a win.\n\nAs the early sun painted the sky with hues of pink and orange, Seth set off on his journey to work. He eased into his car, fastened his seatbelt, and cruised through the streets, keeping a keen eye on the license plates of passing vehicles. He paid no mind to the bustling rush hour traffic or the impatient honks around him. Seth had his eyes set solely on the numbers and letters that whizzed by.\n\nFrom time to time, Seth would nod his head in satisfaction as he stumbled upon license plates like \"MIC-012\" or \"HAN-988.\" Those were wins, and they made the long and arduous drive more worthwhile. However, what Seth truly yearned for, deep in his mathematical soul, was the feeling of a big win. The kind where both license plates shared the exact same three-digit number.\n\nHe dreamed of encountering a pair like \"RYU-500\" and \"SET-500\" on his daily journey. In his mind, such a victory would transcend the constraints of mere coincidence and elevate him to a realm where numbers presided with ethereal intent. It was a longing that fueled his game, a desire to find that perfect symphony of chance.\n\nDays turned into weeks, and weeks transformed into months, but Seth's pursuit continued unabated. Every morning and evening, like a dedicated hunter tracking his elusive prey, he would weave through the roads of Brooksville, his eyes sharp and unwavering. Yet, no matter how hard he tried, the combination he sought remained elusive.\n\nHis friends, amused by Seth's peculiar obsession, joined him for a drink one evening at the local pub. They listened intently as he recounted his game, laughing and joking about his relentless pursuit. One friend, a logical thinker named Emma, interjected with a question that struck a chord within Seth's determined heart.\n\n\"Seth,\" Emma said, her eyes twinkling with curiosity, \"I believe you have an insatiable quest for that perfect win. But have you ever wondered, on average, how many license plates you need to see before you stumble upon your jackpot?\"\n\nSeth furrowed his brow, his mind instantly consumed by this captivating query. Emma's question sparked a flame within him, beckoning him to unravel the mathematical mysteries hidden beneath his game. The more he contemplated, the clearer it became - the expected number of plates he must see before a win. It was a mathematical conundrum that demanded his attention and ignited a longing for the answer.\n\nAnd so, as the night progressed, Seth and his friends deepened their discussion, sipping on their drinks and peppering the air with numbers and calculations. But even as they engaged in spirited debate, the answer remained elusive. Seth's insatiable need to know grew stronger, intertwined with his unwavering determination.\n\nNow, dear reader, the story is yours to continue. Can you solve the mathematical problem that has ignited Seth's passion? How many license plates does Seth need to see, on average, before he finally achieves his dream win?"}, {"id": 389, "euler_id": 389, "title": "Platonic Dice", "problem": "\nAn unbiased single 4-sided die is thrown and its value, T, is noted.T unbiased 6-sided dice are thrown and their scores are added together. The sum, C, is noted.C unbiased 8-sided dice are thrown and their scores are added together. The sum, O, is noted.O unbiased 12-sided dice are thrown and their scores are added together. The sum, D, is noted.D unbiased 20-sided dice are thrown and their scores are added together. The sum, I, is noted.\nFind the variance of I, and give your answer rounded to 4 decimal places.\n", "solution": "2406376.3623", "difficulty": 30, "story": "Once upon a time in the small village of Numeralia, there lived a young girl named Lily. Lily was clever beyond her years, possessing a mind that was as sharp as a mathematician's pencil. She had an insatiable thirst for knowledge, and it was said that numbers flowed through her veins.\n\nOne day, as Lily strolled through the village market, she stumbled upon a peculiar stall run by an even more peculiar man. The man, dressed in a cloak adorned with symbols and equations, had a twinkle in his eye that immediately caught Lily's attention.\n\nIntrigued, Lily approached the stall and discovered that it was filled with all sorts of unusual artifacts. But what caught her eye the most was a small wooden box, intricately carved with numbers of all shapes and sizes.\n\n\"What is this?\" Lily asked, her eyes widening with curiosity.\n\nThe man smiled knowingly. \"Ah, little one, that is no ordinary box. It contains a secret, a mathematical problem that only the most skilled minds can solve.\"\n\nLily's heart raced with excitement. She had always loved a good challenge, and this seemed to be the perfect opportunity to put her mathematical prowess to the test.\n\n\"What must I do?\" Lily asked, her voice filled with determination.\n\nThe man reached into the folds of his cloak and pulled out a piece of parchment, on which he had written the mathematical problem that lay hidden within the wooden box.\n\n\"An unbiased single 4-sided die is thrown and its value, T, is noted. T unbiased 6-sided dice are thrown, and their scores are added together. The sum, C, is noted. C unbiased 8-sided dice are thrown, and their scores are added together. The sum, O, is noted. O unbiased 12-sided dice are thrown, and their scores are added together. The sum, D, is noted. D unbiased 20-sided dice are thrown, and their scores are added together. The sum, I, is noted. Find the variance of I, and give your answer rounded to 4 decimal places.\"\n\nLily took a moment to digest the problem. It was certainly a complex one, but she was determined to unravel its secrets.\n\nAs days turned into weeks, Lily delved deep into the world of dice rolls, probabilities, and variances. Her mind was filled with numbers, as she spent hours upon hours crunching calculations, searching for patterns, and exploring the realm of probabilities.\n\nMeanwhile, the village of Numeralia began to change. Word of Lily's quest had spread far and wide, and people from all over came to witness the young girl's brilliance. Merchants, scholars, and even kings sought her advice, eagerly hoping to learn the secrets of the wooden box.\n\nYet for all the fame and recognition, Lily remained focused on her goal. She was determined to solve the mathematical problem and unlock the knowledge that lay within.\n\nAnd so, as Lily sat alone in her study, pouring over endless sheets of calculations, she couldn't help but wonder: what would be the variance of I? What was the answer that lay hidden within the wooden box?\n\nThe people of Numeralia waited with bated breath, eager to hear the news. Would Lily succeed in her quest? Would she emerge victorious, armed with the knowledge that had eluded so many before her?\n\nNow, dear reader, the question is passed on to you. Can you solve the mathematical problem that consumed Lily's thoughts and captivated the world of Numeralia? What is the variance of I, rounded to four decimal places?\n\nThe answer lies within the wooden box, waiting to be discovered. Can you unlock its secrets and continue the legacy of Lily, the girl with numbers flowing through her veins?"}, {"id": 435, "euler_id": 435, "title": "Polynomials of Fibonacci numbers", "problem": "The Fibonacci numbers {fn,n\u22650} are defined recursively as fn=fn\u22121+fn\u22122 with base cases f0=0 and f1=1.\nDefine the polynomials {Fn,n\u22650} as Fn(x)=\u2211i=0nfixi.\nFor example, F7(x)=x+x2+2x3+3x4+5x5+8x6+13x7, and F7(11)=268357683.\nLet n=1015. Find the sum \u2211x=0100Fn(x) and give your answer modulo 1307674368000\u00a0(=15!).", "solution": "252541322550", "difficulty": 30, "story": "Once upon a time in the enchanted kingdom of Numeria, there lived a brilliant mathematician named Professor Fibonacci. He had spent his entire life exploring the fascinating world of numbers and patterns. Professor Fibonacci had always been fascinated by the mysterious Fibonacci numbers and had spent countless hours trying to uncover their secrets. And now, he believed he had stumbled upon something truly magnificent.\n\nOne sunny morning, as Professor Fibonacci made his way to the royal library, he couldn't help but notice a peculiar glow emanating from a dusty old bookshelf that hadn't been touched in years. Curiosity getting the better of him, he approached the shelf and pulled out an ancient leather-bound book.\n\nAs he dusted off the cover, an inscription appeared, \"The Magical Polynomial Formulas of Fibonacci.\" Eyes widening with excitement, Professor Fibonacci knew he had struck gold. Eagerly flipping through the yellowed pages, he discovered a collection of polynomials known as the \"Fn(x)\" \u2014 a special sequence derived from the famous Fibonacci numbers.\n\nDiving deep into the book, Professor Fibonacci unraveled the mystery behind these polynomials. He learned that Fn(x) represented the sum of various powers of x, where each term's coefficient corresponded to a Fibonacci number. The more he read, the more enchanted he became with the elegance of these polynomials.\n\nBut the true marvel lay hidden within a single page of the book. Professor Fibonacci discovered a remarkable formula that allowed him to calculate the sum of these polynomials for a given range of x values. The thought of unlocking this extraordinary secret overwhelmed him. He had to know- could the sum of these polynomials hold the answers to the universe's hidden numerical secrets?\n\nWith newfound determination, Professor Fibonacci dedicated himself to solving the mathematical riddle held within the magical polynomials. Every waking hour was spent poring over formulas, cross-referencing ancient texts, and experimenting with different approaches. He knew that deciphering the secrets of the polynomials could unlock the door to infinite possibilities.\n\nDays turned into weeks, weeks into months, and months into years. The kingdom's people marveled at Professor Fibonacci's dedication and the passion he exhibited for unraveling this mysterious mathematical tapestry. But with time, the people's questions grew. Why did he spend countless hours working on this puzzle? What did he hope to find? And more importantly, what could this mean for the kingdom of Numeria?\n\nAnd now, the question still lingers. The answer waits for a worthy seeker to discover it. Can you solve the mathematical problem the brilliant Professor Fibonacci dedicated his life to? Can you find the sum of the polynomials \u2211x=0^100 Fn(x) modulo 1307674368000?\n\nAs the sun sets over Numeria, the legacy of Professor Fibonacci lives on, waiting for the curious minds brave enough to unravel the secrets of the Fibonacci polynomials. Will you be the one to unlock the hidden wonders they hold?"}, {"id": 443, "euler_id": 443, "title": "GCD sequence", "problem": "Let g(n) be a sequence defined as follows:\ng(4) = 13,\ng(n) = g(n-1) + gcd(n, g(n-1)) for n > 4.\nThe first few values are:\n\nn4567891011121314151617181920...\ng(n)1314161718272829303132333451545560...\n\nYou are given that g(1\u00a0000) = 2524 and g(1\u00a0000\u00a0000) = 2624152.\nFind g(1015).", "solution": "2744233049300770", "difficulty": 30, "story": "Once upon a time in the bustling city of Numeria, there lived a young artist named Luna. With her vibrant strokes and visionary mind, Luna had the ability to bring her artwork to life. Her paintings adorned the walls of galleries and captivated the hearts of all who laid eyes upon them.\n\nOne fateful evening, as Luna was preparing for an upcoming exhibition, she found herself lost in a world of numbers and equations. Numbers had always fascinated her, and she often found solace in the rhythmic patterns they created. As if guided by an invisible hand, her mind began to wander into the realm of mathematics.\n\nLost in thought, Luna stumbled upon a mathematical problem that seemed to hold a mysterious allure. It was a sequence, encapsulated in the function g(n). As she delved deeper into its intricacies, she uncovered the enigma hidden within its numbers.\n\nThe sequence began innocently enough, with g(4) being equal to 13. However, it swiftly intensified, with each subsequent term dependent on the previous one. Luna marveled at how g(n) was defined as the sum of g(n-1) and the greatest common divisor between n and g(n-1). She realized that she had stumbled upon an unsolved mathematical puzzle, one that would challenge even the brightest minds.\n\nAs Luna immersed herself in solving the problem, she became obsessed. The strokes of her brush transformed, with her artwork now reflecting her growing curiosity. Each canvas became a template for her mathematical musings, as she infused her art with the intricate web of numbers she was unraveling.\n\nDays turned into weeks, and weeks turned into months, but Luna did not give up. She poured every ounce of her creativity into the quest for the solution. As the equations danced across her mind, her brush danced upon the canvas, creating a masterpiece that embodied both art and mathematics.\n\nFinally, Luna emerged from her cocoon of solitude, her heart full of hope and anticipation. Her friends, fellow artists, and mathematicians gathered eagerly at the gallery, eager to witness the unveiling of her creation. The room buzzed with excitement as Luna made her way to the center of the pristine white room.\n\nWith a single, dramatic gesture, she revealed her artwork to the world. Gasps of awe filled the air as the painting came alive, capturing the essence of the mathematical problem Luna had been grappling with. The vibrant colors and intricate patterns blended seamlessly, mirroring the beauty hidden within the g(n) sequence.\n\nYet, as the crowd marveled at the mystical nature of her art, Luna's eyes gleamed with a newfound determination. The painting was inspired by the journey of g(n), but it did not contain the key to unlocking the solution. It was merely a testament to Luna's unyielding spirit.\n\nWith a knowing smile, Luna turned to face the gathering and posed a question that echoed in the silent room. \"My friends,\" she began, her voice filled with anticipation. \"Can you uncover the secrets that lie within the fabric of g(n)? Can you find the value of g(10^15)?\"\n\nAnd so, the challenge was laid before all who gazed upon Luna's masterpiece. The mathematicians, artists, and puzzle enthusiasts, enchanted by her passion, sought to dive into the mathematical abyss and unravel the enigma hidden within. As they embarked on their own quest for answers, Luna watched with bated breath, hopeful that the beauty she created would inspire others as it had inspired her.\n\nAnd now, it is up to you, dear reader. Can you solve the puzzle that Luna so passionately brought to life? Can you find the value of g(10^15)? Take up the challenge and embark on this mathematical journey. The answer awaits, hidden within the labyrinth of numbers and reasoning. Are you ready?"}, {"id": 451, "euler_id": 451, "title": "Modular inverses", "problem": "\nConsider the number 15.\nThere are eight positive numbers less than 15 which are coprime to 15: 1, 2, 4, 7, 8, 11, 13, 14.\nThe modular inverses of these numbers modulo 15 are: 1, 8, 4, 13, 2, 11, 7, 14  \nbecause\n1\u2009\u00b7\u20091 mod 15=1\n2\u2009\u00b7\u20098=16 mod 15=1\n4\u2009\u00b7\u20094=16 mod 15=1\n7\u2009\u00b7\u200913=91 mod 15=1\n11\u2009\u00b7\u200911=121 mod 15=1\n14\u2009\u00b7\u200914=196 mod 15=1\n\nLet I(n) be the largest positive number m smaller than n-1 such that the modular inverse of m modulo n equals m itself.\nSo I(15)=11.\nAlso I(100)=51 and I(7)=1.\n\nFind \u2211\u2009I(n) for 3\u2264n\u22642\u00d7107", "solution": "153651073760956", "difficulty": 30, "story": "Once upon a time in the quaint village of Numeria, lived a young mathematician named Sebastian. With stacks of papers and a mind full of numbers, he was always seen scribbling away at his calculations, searching for patterns, and solving mathematical problems that perplexed even the elders of the village.\n\nOne sunny morning, as Sebastian was sitting in the village square, he overheard whispers of an ancient treasure buried deep within the nearby MathematiCave. Legends said that the treasure held incredible power and wisdom, and the only way to access it was by solving a series of complex mathematical problems.\n\nCuriosity consumed Sebastian, and the thought of uncovering such a treasure intrigued him immensely. Determined to test his skills and discover the secrets hidden in the MathematiCave, he ventured forth into the unknown.\n\nDeep within the dimly lit cavern, Sebastian stumbled upon a series of inscriptions carved into the walls. He squinted his eyes and deciphered the cryptic text.\n\n\"Consider the number 15,\" the inscription began. Sebastian's heart skipped a beat. It was the start of a mathematical problem, and he knew that whatever lay ahead in the cave was connected to it.\n\nWith bated breath, Sebastian continued reading the inscription. It spoke of the modular inverses of certain numbers modulo 15 and mentioned a function called I(n), which puzzled him. The inscription challenged Sebastian to find the sum of I(n) for a range of numbers, and his mind started racing to solve the problem.\n\nAs he delved deeper into the MathematiCave, Sebastian's excitement grew. The more he understood this mathematical problem, the closer he felt to unlocking the fabled treasure. It became clear to him that the knowledge required to solve the challenge was instrumental in overcoming the trials of the cave.\n\nThroughout his journey, Sebastian encountered obstacles that tested his mathematical acumen. He solved number sequences, calculated Fibonacci-like series, and identified prime factors in order to proceed. Along the way, he discovered the beauty of mathematics and the incredible power it holds in unraveling the mysteries of the world.\n\nFinally, after hours of calculations and a seemingly endless maze of mathematical enigmas, Sebastian reached the heart of the MathematiCave. Before him stood a shimmering, jewel-encrusted chest, a testament to his perseverance and analytical prowess.\n\nWith hands trembling, Sebastian unlocked the chest, revealing its gleaming contents. But as he prepared to touch the treasure, a sudden realization struck him. Was the treasure truly the solution to this intricate mathematical problem?\n\nLost in thought, Sebastian found himself facing a pivotal decision. Should he claim the treasure and bring his mathematical journey to an end, or should he leave it untouched and continue his quest for deeper understanding?\n\nAs Sebastian stared at the treasure, the final question etched its way into his mind. It echoed through the chambers of the MathematiCave, demanding an answer.\n\nThe short story reaches its peak here, and with the reader's imagination ignited, it poses a question that can only be answered with mathematical prowess: What is the sum of I(n) for 3\u2264n\u22642\u00d7107?\n\nAnd so, dear reader, I leave that question to you. Will you be the one to solve this mathematical problem and uncover the secrets of the treasure within the MathematiCave?"}, {"id": 458, "euler_id": 458, "title": "Permutations of Project", "problem": "\nConsider the alphabet A made out of the letters of the word \"project\": A={c,e,j,o,p,r,t}.\nLet T(n) be the number of strings of length n consisting of letters from A that do not have a substring that is one of the 5040 permutations of \"project\".\n\nT(7)=77-7!=818503.\n\n\nFind T(1012). Give the last 9 digits of your answer.\n", "solution": "423341841", "difficulty": 30, "story": "Once upon a time in the small village of Digitland, there lived a young mathematician named Emily. She had always been fascinated by numbers and patterns, spending hours immersed in solving intricate puzzles. Her mind seemed to dance with mathematical equations, and she cherished every opportunity to solve a new problem.\n\nOne sunny morning, Emily was strolling through the village square when she stumbled upon a peculiar book lying on a wooden bench. The cover was adorned with intricate symbols and equations, creating an air of mystery around it. Intrigued, Emily picked up the book and opened it to a random page.\n\nHer eyes widened as she read the mathematical problem in front of her. It posed a question about a mythical alphabet created from the letters of the word \"project\": A={c,e,j,o,p,r,t}. The problem involved finding the number of strings of various lengths that could be formed using these letters, but with the crucial condition that none of the strings could have a substring that matched any of the 5040 permutations of \"project.\"\n\nEmily's heart raced with excitement. The problem seemed challenging yet captivating. She knew she had to solve it. With the book clutched tightly in her hands, she rushed back to her cozy cottage, eagerly delving into her research.\n\nDays merged into nights as Emily lost herself in the realms of permutations and combinations. She scribbled countless equations, filling her cottage with a cloud of consequence. In her pursuit to solve the problem, her mind became a battlefield of frustration and exhilaration.\n\nWeeks turned into months, and still, the answer eluded her. Yet, Emily refused to give up. She knew that the solution held secrets within itself, an insight she was determined to unravel.\n\nAs winter drenched the village in a blanket of snow, Emily spent lonely nights pondering the mathematical enigma. On one such cold night, as she sat near the fireplace, she had a breakthrough.\n\nHer eyes sparkled with newfound realization as she understood the underlying pattern. She scribbled furiously on a piece of parchment, filling it with numbers and calculations. The numbers danced in harmony, each revealing a part of the solution.\n\nWith trembling excitement, Emily discovered the value of T(1012), the number of strings of length 1012 that conformed to the conditions defined in the mathematical problem. She cautiously reached for her pen, ready to pen down the answer from her calculations.\n\nBut then, a sudden thought crossed her mind. Should she reveal the solution so easily? What if someone else found the book and stumbled upon this page? Surely, it was a significant mathematical discovery, and she didn't want to diminish its value.\n\nWith thoughtful determination, Emily placed down her pen and gazed at the flickering flames of the fireplace. She knew she had to come up with a way to share her discovery, without merely giving away the solution. The beauty of mathematics deserved to be experienced and understood, not merely handed out on a silver platter.\n\nAnd so, dear reader, I ask you:\n\nCan you find the last nine digits of T(1012), the number of strings of length 1012 that conform to the conditions defined in the mathematical problem?\n\nEmbrace the challenge, traverse the intricate web of permutations and combinations, and uncover the secrets that lie hidden within this mathematical conundrum. Discover the beauty of numbers and their profound impact on our world.\n\nThe answer awaits you, eager to be found."}, {"id": 461, "euler_id": 461, "title": "Almost Pi", "problem": "Let fn(k)\u00a0=\u00a0ek/n\u00a0-\u00a01, for all non-negative integers k.\nRemarkably, f200(6)\u00a0+\u00a0f200(75)\u00a0+\u00a0f200(89)\u00a0+\u00a0f200(226)\u00a0= 3.141592644529\u2026\u00a0\u2248\u00a0\u03c0.\nIn fact, it is the best approximation of \u03c0 of the form fn(a)\u00a0+\u00a0fn(b)\u00a0+\u00a0fn(c)\u00a0+\u00a0fn(d) for n\u00a0=\u00a0200.\nLet g(n)\u00a0=\u00a0a2\u00a0+\u00a0b2\u00a0+\u00a0c2\u00a0+\u00a0d\u20092 for a, b, c, d that minimize the error: |\u00a0fn(a)\u00a0+\u00a0fn(b)\u00a0+\u00a0fn(c)\u00a0+\u00a0fn(d)\u00a0-\u00a0\u03c0|\n(where |x| denotes the absolute value of x).\nYou are given g(200)\u00a0=\u00a062\u00a0+\u00a0752\u00a0+\u00a0892\u00a0+\u00a02262\u00a0=\u00a064658.\nFind g(10000).", "solution": "159820276", "difficulty": 30, "story": "Once upon a time in the sleepy town of Mathsville, there lived a young girl named Lila. Lila was notorious for her love of all things mathematical. She could spend hours lost in the world of numbers and formulas, fascinated by the beauty and intricacy they held. \n\nOne sunny day, Lila stumbled upon an old dusty book hidden away in the library. Its worn-out pages seemed to whisper secrets of untold wonders. As she perused its contents, her eyes widened at the sight of a mesmerizing mathematical problem. It was like finding a hidden treasure, waiting to be unraveled.\n\nThe problem that had captured Lila's attention was no ordinary riddle. It involved a peculiar function, fn(k), and its remarkable relationship with the number \u03c0. To her delight, she discovered that the sum of fn(k) for specific values of k resulted in an approximation of \u03c0. Lila's heart danced with excitement as she realized the significance of this discovery.\n\nDetermined to explore the depths of this mathematical mystery, Lila knew she needed to understand how this approximation came to be. She delved into the book, devouring every page, every theorem, and every proof, until her mind was brimming with possibilities.\n\nDays turned into weeks as Lila tirelessly worked on formulating her own solutions. She scribbled equations and diagrams in her notebook, her pencil racing across the paper. The rest of the world seemed to fade away as she immersed herself in this pursuit.\n\nIn her quest to understand the intricacies of the problem, Lila discovered a function named g(n). It involved finding the values of a, b, c, and d that minimized the error between the sum of fn(a), fn(b), fn(c), and fn(d) and the mythical number, \u03c0. The function g(n) was the key to minimizing the discrepancy, and hence, maximizing the accuracy of the approximation.\n\nAs Lila continued her mathematical journey, her mind began to wander into a realm of conjectures and infinite possibilities. She wondered if there were any patterns or algorithms hidden within the problem, waiting to be unraveled. The more she peeled back the layers, the more she realized the profound nature of this enigma.\n\nEventually, Lila stumbled upon a solution for g(200). It involved finding the squares of a, b, c, and d that summed up to a particular value. In this case, the value turned out to be 64658. It felt like a triumph, a small triumph in the grand scheme of things.\n\nBut Lila was not one to rest on her laurels. Armed with her newfound knowledge and determination, she set her sights on even greater heights. She set herself the audacious challenge of finding g(10000), which held the answers to mysteries she dared not imagine.\n\nAnd now, dear reader, I pose this question to you. Can you solve the mathematical problem that Lila is striving to crack? Can you uncover the values of a, b, c, and d that minimize the error between their squares and the elusive \u03c0?\n\nThe end of this story marks the beginning of your own mathematical journey\u2014one that holds the key to unveiling the secrets woven within the numbers. Can you find g(10000)?"}, {"id": 485, "euler_id": 485, "title": "Maximum number of divisors", "problem": "\nLet d(n) be the number of divisors of n.\nLet M(n,k) be the maximum value of d(j) for n \u2264 j \u2264 n+k-1.\nLet S(u,k) be the sum of M(n,k) for 1 \u2264 n \u2264 u-k+1.\n\n\nYou are given that S(1000,10)=17176.\n\n\nFind S(100 000 000,100 000).\n", "solution": "51281274340", "difficulty": 30, "story": "Lily always had a fascination with numbers. From a young age, she found solace in solving complex mathematical equations, as if they held the key to some hidden world. She loved how numbers could unlock all kinds of secrets and mysteries. \n\nYears passed, and Lily grew into a brilliant mathematician, working at a prestigious university. Her expertise in number theory was renowned, and she was constantly seeking new challenges. One day, while browsing through an old bookshop, she stumbled upon a dusty tome titled \"Mathematical Marvels.\"\n\nIntrigued, Lily wasted no time in opening the book and diving into its pages. And there, in the middle of a chapter filled with equations and mathematical formulas, she discovered a problem that piqued her interest. It was a problem so profound it sent a thrill through her veins.\n\nAs she read the problem aloud, her voice resonated through the cramped bookstore. \n\n\"Let d(n) be the number of divisors of n. Let M(n,k) be the maximum value of d(j) for n \u2264 j \u2264 n+k-1. Let S(u,k) be the sum of M(n,k) for 1 \u2264 n \u2264 u-k+1. You are given that S(1000,10) equals 17176.\"\n\nLily's heart skipped a beat. This was unlike any problem she had ever encountered before. It required a complex understanding of divisors and maximum values\u2014exactly the kind of challenge she craved.\n\nUnable to contain her excitement, she rushed back to her office and began pouring over the problem, unraveling its intricacies. Days turned into weeks, and Lily immersed herself in the world of divisors, patterns, and sequences. The problem consumed her every waking moment.\n\nAs Lily examined the numbers and their relationships, she began to see a pattern emerge. She could almost visualize the divisors intertwining, their paths converging and diverging in an intricate dance. She worked tirelessly, scribbling notes, forming hypotheses, and testing her ideas.\n\nFinally, after what felt like an eternity, Lily uncovered a beautiful theorem, a key that unlocked a hidden door in the world of numbers. Eyes brimming with triumph, she marveled at the elegance of her solution. But just as she was about to rejoice, an idea struck her. This couldn't be it. This couldn't be the end of the story.\n\nWith newfound determination, Lily took a step back and considered the bigger picture. The problem had become so much more than a mere theorem to her. It had become a thread that connected her to the countless mathematicians who had come before her, each contributing to the vast tapestry of knowledge.\n\nHow could she keep this journey to herself? How could she deny others the joy of solving this problem? No, it was time to share it with the world, to extend the torch of inquiry and discovery.\n\nLily leaned back in her chair and began drafting a letter to all math enthusiasts and scholars. She laid out the problem, explained her insights, and ended with a final question that would echo through the ages.\n\nAnd so, the letter was sent, carrying with it the tale of Lily's discovery. Mathematicians around the world delved into the problem, their pens dancing across countless sheets of paper. The hunt for the unknown continued, with each new mind bringing its unique perspective.\n\nBut what was the outcome? Did anyone succeed in finding S(100 000 000,100 000)? The answer lay in the hands of those still enveloped in the mystery, those who dared to venture where others faltered.\n\nAnd so, dear reader, the question is yours to answer. Can you solve the riddle of S(100 000 000,100 000)?"}, {"id": 506, "euler_id": 506, "title": "Clock sequence", "problem": "Consider the infinite repeating sequence of digits:\n1234321234321234321...\nAmazingly, you can break this sequence of digits into a sequence of integers such that the sum of the digits in the n'th value is n.\nThe sequence goes as follows:\n1, 2, 3, 4, 32, 123, 43, 2123, 432, 1234, 32123, ...\nLet vn be the n'th value in this sequence. For example, v2\u00a0=\u00a02, v5\u00a0=\u00a032 and v11\u00a0=\u00a032123.\nLet S(n) be v1\u00a0+\u00a0v2\u00a0+\u00a0...\u00a0+\u00a0vn. For example, S(11)\u00a0=\u00a036120, and S(1000)\u00a0mod\u00a0123454321\u00a0=\u00a018232686.\nFind S(1014)\u00a0mod\u00a0123454321.", "solution": "18934502", "difficulty": 30, "story": "Once upon a time, in a small town called Numerica, there lived a young girl named Lily. Lily had always been drawn to numbers; they fascinated her like colorful puzzles waiting to be solved. Every day, she would spend hours in her room, flipping through her math books, mesmerized by the patterns and sequences concealed within the pages.\n\nOne sunny afternoon, while Lily was engrossed in her studies, a magical glowing book appeared before her. Curiosity sparking within her, she touched the book, and to her amazement, the pages came to life with a single mathematical problem.\n\nA repeating sequence of digits danced on the pages: 1234321234321234321. It seemed destined to take her on a journey through the mysterious kingdom of Numerica. Eagerly, Lily began to read further, discovering that the sequence could be split into a series of integers, each having a remarkable quality. The sum of the digits in the \"n\"th integer equalled \"n\" itself.\n\nAs Lily dived deeper into the enchanted book's pages, she uncovered a hidden realm. It was a place where logic dwelled harmoniously with imagination and numbers held the key to a magical world only few had ever seen. Lily suddenly found herself standing in a bustling marketplace, surrounded by mathematical wonders.\n\nMerchants peddled prime numbers, Fibonacci sequences, and exponential equations, each trying to entice Lily to buy their unique numerical piece. She marveled at the infinite possibilities that lay before her. The air was thick with excitement as the townsfolk chattered about the marvelous sequence Lily had stumbled upon.\n\nNews of her discovery reached the great wizard, Archimedes, who resided atop Mount Calculus. Intrigued by the sequence, Archimedes summoned Lily to his chambers, hoping she could unravel its mysteries.\n\nThe arduous journey up the winding path of Mount Calculus exhausted Lily. But she knew it was only the beginning of an extraordinary adventure. As she reached the grand doors of the wizard's chamber, a hush fell upon the room, and all eyes turned to her.\n\nArchimedes, an ancient figure draped in long robes and a luminous mathematical symbol etched on his head, greeted Lily with a wise smile. He revealed that the sequence she had uncovered held tremendous power, capable of unveiling secrets long forgotten. But to unlock its full potential, she had to undertake a perilous quest.\n\nLily had to traverse the treacherous Math Maze, a labyrinth teeming with baffling equations and geometric obstacles that defied logic. Hidden within its depths lay the key to solving the infinite sequence once and for all.\n\nWithout hesitation, Lily embarked on her journey, armed with magical compasses and her unwavering passion for numbers. The maze tested her ability to manipulate numbers, solve equations, and think outside the confines of traditional arithmetic. With each solved challenge, she grew stronger and wiser, closer to her ultimate goal.\n\nDays turned into weeks, and weeks into months. The Math Maze seemed endless, but Lily refused to give up. She braved through the rigorous mental challenges, overcoming every hurdle that stood in her way. The more she advanced, the clearer the sequence's importance became.\n\nFinally, after months of tireless determination, Lily reached the heart of the Math Maze. There, standing majestically upon a pristine pedestal, was the solution to the infinite sequence. It was a revelation that could change the realm of Numerica forever.\n\nBut before she could gather the knowledge, the ground beneath her began to tremble. The ancient guardian of the Math Maze, a fearsome creature known as the Calculus Dragon, awakened from its millennium-long slumber, sensing a threat to the balance of Numerica.\n\nWith fiery eyes fixed upon Lily, the dragon unleashed a powerful roar, sending shockwaves through every corner of the Math Maze. As Lily stood face-to-face with her greatest challenge, she couldn't help but wonder, was the solution worth the danger she now faced?\n\nAnd as the story unfolds, it is up to you, dear reader, to determine Lily's destiny. Will she find a way to subdue the fearsome Calculus Dragon and claim the solution to the infinite sequence? Or will the realm of Numerica forever be shrouded in mystery, its secrets hidden behind the formidable creature's flames?\n\nNow, it is your turn to unravel the enigma of the infinite sequence. Can you find S(1014) mod 123454321 and help Lily restore balance to Numerica?"}, {"id": 510, "euler_id": 510, "title": "Tangent Circles", "problem": "Circles A and B are tangent to each other and to line L at three distinct points.\nCircle C is inside the space between A, B and L, and tangent to all three.\nLet rA, rB and rC be the radii of A, B and C respectively.\nLet S(n)\u00a0=\u00a0\u2211\u2009rA\u00a0+\u00a0rB\u00a0+\u00a0rC, for 0\u00a0<\u00a0rA\u00a0\u2264\u00a0rB\u00a0\u2264\u00a0n where rA, rB and rC are integers.\nThe only solution for 0\u00a0<\u00a0rA\u00a0\u2264\u00a0rB\u00a0\u2264\u00a05 is rA\u00a0=\u00a04, rB\u00a0=\u00a04 and rC\u00a0=\u00a01, so S(5)\u00a0=\u00a04\u00a0+\u00a04\u00a0+\u00a01\u00a0=\u00a09.\nYou are also given S(100)\u00a0=\u00a03072.\nFind S(109).", "solution": "315306518862563689", "difficulty": 30, "story": "Once upon a time in the land of Mathematica, there lived a skilled mathematician named Ethan. He was revered by his fellow villagers for his ability to solve the most complex mathematical problems. One day, a mysterious visitor arrived in Mathematica and sought Ethan's help. The visitor carried with him an ancient scroll, containing an unsolved mathematical problem.\n\nThe scroll revealed a peculiar situation involving circles. Ethan read through the problem carefully: \"Circles A and B are tangent to each other and to line L at three distinct points. Circle C is inside the space between A, B, and L, and tangent to all three. Let rA, rB, and rC be the radii of A, B, and C respectively. Let S(n) = \u2211 rA + rB + rC, for 0 < rA \u2264 rB \u2264 n where rA, rB, and rC are integers.\"\n\nAs Ethan pondered over the problem, he realized the significance of the circles and their tangency. He knew that the solution to this mathematical enigma lied within the precise relations between their radii. This problem intrigued him like no other, for it required him to think creatively and use his knowledge of geometry.\n\nDays turned into weeks, weeks into months, and Ethan dived deep into his exploration of these circles. He sketched countless diagrams, conducted various experiments, and even consulted the great mathematical minds of Mathematica. Yet, the solution to the problem eluded him. However, Ethan's determination remained unshaken.\n\nOne evening, as Ethan was poring over the problem once again, a sudden realization struck him. He remembered a remarkable theorem he had learned during his early years as a mathematician. Excitedly, he started making connections between the theorem and the mysterious circles. Finally, the answer began to unfold before his eyes.\n\nWith a newfound resolve, Ethan started working with newfound energy. He carefully wrote down the values of rA, rB, and rC, and began calculating their sum, S(n). His mind was focused, and his hands moved swiftly across the paper. When Ethan finally arrived at a solution for n = 100, he couldn't contain his joy. S(100) was equal to 3072.\n\nDays turned into nights, and nights into days once more, as Ethan became consumed by his pursuit of the ultimate solution. His obsession with the circles and their radii made him yearn for a solution that would unravel the mystery behind S(n). With every calculation, he grew more determined to find the final answer.\n\nMonths turned into years, and years into decades, as Ethan's hair turned gray from the relentless pursuit of his mathematical quest. While the rest of the world outside Mathematica continued to evolve, Ethan remained focused solely on the conundrum of circles A, B, and C.\n\nAnd now, dear reader, the question remains, can you solve the ancient mathematical problem that has perplexed Ethan for so long? Can you find S(1,000,000,000)?"}, {"id": 523, "euler_id": 523, "title": "First Sort I", "problem": "Consider the following algorithm for sorting a list:\n1. Starting from the beginning of the list, check each pair of adjacent elements in turn.\n2. If the elements are out of order:\na. Move the smallest element of the pair at the beginning of the list.\nb. Restart the process from step 1.\n3. If all pairs are in order, stop.For example, the list { 4 1 3 2 } is sorted as follows:\n4 1 3 2  (4 and 1 are out of order so move 1 to the front of the list)\n1 4 3 2  (4 and 3 are out of order so move 3 to the front of the list)\n3 1 4 2  (3 and 1 are out of order so move 1 to the front of the list)\n1 3 4 2  (4 and 2 are out of order so move 2 to the front of the list)\n2 1 3 4  (2 and 1 are out of order so move 1 to the front of the list)\n1 2 3 4  (The list is now sorted)Let F(L) be the number of times step 2a is executed to sort list L. For example, F({ 4 1 3 2 }) = 5.\nLet E(n) be the expected value of F(P) over all permutations P of the integers {1, 2, ..., n}.\nYou are given E(4) = 3.25 and E(10) = 115.725.\nFind E(30). Give your answer rounded to two digits after the decimal point.", "solution": "37125450.44", "difficulty": 30, "story": "Once upon a time in the bustling city of Digitopolis, there was a young and ambitious mathematician named Amelia. She had an insatiable curiosity for puzzles and enigmas, constantly seeking new challenges to conquer. Her latest obsession was unraveling the secrets hidden within the world of sorting algorithms.\n\nAmelia spent countless hours in her small study, scribbling away at her notebook and immersing herself in the intricacies of sorting. One day, while reading a particularly captivating mathematics journal, she stumbled upon a peculiar problem that piqued her interest.\n\nThe problem described an algorithm for sorting a list by comparing adjacent elements and rearranging them if they were out of order. It fascinated Amelia how such a simple process could elegantly sort any given list. The real catch, however, lay in calculating the number of swaps required, denoted by the function F(L).\n\nWith great determination, Amelia resolved to master this algorithm and discover the true essence of sorting. She assembled a list of her own, randomly choosing numbers at whim - 4, 1, 3, and 2. Amelia knew if she followed the prescribed steps, she would uncover the magic behind this sorting dance.\n\nAs she progressed through each iteration, moving elements back and forth, a pattern began to emerge. The numbers danced around as if they had a life of their own, eagerly rearranging themselves to reach their rightful positions. It was like witnessing a symphony of numbers, orchestrated by this remarkable algorithm.\n\nEventually, after the fifth swap, the list settled into its sorted form: 1, 2, 3, and 4. Amelia marveled at the simplicity of the algorithm, which led her to contemplate its broader implications. She wondered how this algorithm could be applied to larger lists, containing more numbers.\n\nIn her quest for knowledge, Amelia delved deeper into the mathematical problem. The journal had revealed that the expected value of F(P) (the number of swaps required) over all permutations P of the integers {1, 2, ..., n}, was represented by E(n). Intriguingly, the journal provided values for E(4) and E(10) - 3.25 and 115.725, respectively.\n\nWith her ever-growing curiosity, Amelia's mind began to wander. She wondered what lay on the horizon for E(30), and how this grand eureka could be calculated. The vastness of the possibilities intrigued her, and she yearned to solve this enigma.\n\nBut alas, that part of the story remains untold. Will you be the one to solve the puzzle Amelia has encountered? Can you find the value for E(30), rounding your answer to two decimal places? The answer is hidden within the intricate dance of sorting, and only through your mathematical prowess can it be unveiled."}, {"id": 527, "euler_id": 527, "title": "Randomized Binary Search", "problem": "A secret integer t is selected at random within the range 1 \u2264 t \u2264 n. \nThe goal is to guess the value of t by making repeated guesses, via integer g. After a guess is made, there are three possible outcomes, in which it will be revealed that either g < t, g = t, or g > t. Then the process can repeat as necessary.\nNormally, the number of guesses required on average can be minimized with a binary search: Given a lower bound L and upper bound H (initialized to L = 1 and H = n), let g = \u230a(L+H)/2\u230b where \u230a\u22c5\u230b is the integer floor function. If g = t, the process ends. Otherwise, if g < t, set L = g+1, but if g > t instead, set H = g\u22121. After setting the new bounds, the search process repeats, and ultimately ends once t is found. Even if t can be deduced without searching, assume that a search will be required anyway to confirm the value.\nYour friend Bob believes that the standard binary search is not that much better than his randomized variant: Instead of setting g = \u230a(L+H)/2\u230b, simply let g be a random integer between L and H, inclusive. The rest of the algorithm is the same as the standard binary search. This new search routine will be referred to as a random binary search.\nGiven that 1 \u2264 t \u2264 n for random t, let B(n) be the expected number of guesses needed to find t using the standard binary search, and let R(n) be the expected number of guesses needed to find t using the random binary search. For example, B(6) = 2.33333333 and R(6) = 2.71666667 when rounded to 8 decimal places.\nFind R(1010) \u2212 B(1010) rounded to 8 decimal places.", "solution": "11.92412011", "difficulty": 30, "story": "Once upon a time, in the quaint village of Mathematica, there lived a young mathematician named Alice. Alice was known for her love of numbers and her unparalleled ability to solve complex problems. She spent her days immersed in the world of mathematics, exploring its intricacies with passion and curiosity.\n\nOne sunny afternoon, as Alice was strolling through the village, she stumbled upon her friend Bob. Bob, too, had a fascination with numbers, although his approach to problem-solving was vastly different from Alice's. While Alice believed in the power of logic and careful analysis, Bob had a penchant for randomness and unpredictability.\n\n\"Ah, Alice! Just the person I was hoping to see,\" Bob exclaimed, a mischievous twinkle in his eyes. \"I've been working on a new problem, a mathematical conundrum that challenges the traditional methods of solving.\"\n\nIntrigued, Alice raised an eyebrow. \"Tell me more, Bob. I'm always up for a mathematical adventure.\"\n\nBob explained the problem to Alice, delving into the world of secret integers and binary searches. He described the standard binary search method and its efficiency at narrowing down the possible values of the secret integer. But then he introduced his own twist - the random binary search.\n\n\"Instead of calculating the value of g using the traditional floor function, I propose choosing g randomly between the lower and upper bounds. I call it the random binary search,\" Bob explained excitedly.\n\nAlice was captivated by the challenge before her. She had always believed that mathematical problems had a definitive solution, a foolproof method of finding answers. But here was Bob, presenting an alternate approach that challenged the status quo.\n\nThe days turned into weeks, and Alice and Bob dove into their respective methods, tirelessly exploring the depths of the mathematical problem. Bob would try out his random binary search repeatedly, calculating the expected number of guesses needed to find the secret integer.\n\nAs Alice observed her friend's experiments, a spark of inspiration ignited within her. She realized that the traditional binary search had its own elegance, its own symmetry. By dividing the search space in half with each guess, it meticulously eliminated half of the possibilities, leading to the secret integer efficiently.\n\nAlice's mind raced with possibilities, algorithms, and equations. She crafted formulas, calculated probabilities, and pondered the intricacies of the problem at hand. Sleepless nights turned into fervent days, as Alice worked tirelessly to uncover the truth.\n\nFinally, a breakthrough came to her in a moment of revelation. Alice found a way to express the expected number of guesses needed to find the secret integer using the standard binary search - B(n). She also devised a formula for the expected number of guesses needed using Bob's random binary search method - R(n).\n\nAs Alice organized her findings, she marveled at the mathematical problem that had consumed her. It was a testament to the beauty and complexity of numbers, a puzzle that had led her down a path she never could have imagined.\n\nBut as Alice pondered her discoveries, a question filled her mind, a question that she wanted to share with the world. She needed someone to solve it, someone who could unravel the mystery that had captivated her and Bob for so long.\n\nAnd so, dear reader, I pose the question to you: What is the difference, rounded to 8 decimal places, between R(1010) and B(1010)? Can you fathom the answer, unlock the secret held within the mathematical problem, and reveal the truth that Alice and Bob sought so passionately?"}, {"id": 540, "euler_id": 540, "title": "Counting primitive Pythagorean triples", "problem": "\nA Pythagorean triple consists of three positive integers a,b and c satisfying a2+b2=c2.\nThe triple is called primitive if a,b and c are relatively prime.\nLet P(n) be the number of primitive Pythagorean triples with a<b<c\u2264n.\nFor example P(20) = 3, since there are three triples: (3,4,5), (5,12,13) and (8,15,17).\n\n\nYou are given that P(106) = 159139.\nFind P(3141592653589793).\n", "solution": "500000000002845", "difficulty": 30, "story": "Once upon a time in the Kingdom of Mathalia, there lived a young princess named Evelyn. She was known for her brilliance and curiosity, always searching for knowledge and challenging herself with complex problems. Among her many interests, mathematics held a special place in her heart.\n\nOne day, while exploring the royal library, Evelyn stumbled upon an ancient scroll. The scroll contained a mathematical problem that intrigued her immensely. It was a Pythagorean triple conundrum that called upon her knowledge of number theory.\n\nAs she delved deeper into the problem, Evelyn discovered that a Pythagorean triple consisted of three positive integers, a, b, and c, which satisfied the equation a\u00b2 + b\u00b2 = c\u00b2. These triples were called primitive if the three integers, a, b, and c, were relatively prime, meaning they did not share any common factors other than 1. Fascinated, Princess Evelyn decided to investigate.\n\nWeeks turned into months as Evelyn tirelessly worked on the problem, her mind immersed in numbers and calculations. With every step closer to the solution, her excitement grew, and she poured over countless parchments, searching for patterns and clues to decipher the enigma.\n\nMeanwhile, the news of the princess's mathematical quest spread throughout the kingdom. Scholars, mathematicians, and even curious townsfolk began to share their own observations and theories on Pythagorean triples and primitive sequences. The entire kingdom was captivated by the journey of Princess Evelyn, and everyone eagerly awaited her next discovery.\n\nAs days turned into years, Evelyn's dedication paid off. Through relentless perseverance, she managed to solve the Pythagorean triple mystery up to an astonishing number, P(106), which equaled 159139. The satisfaction coursing through her veins was unparalleled, but her journey was far from over.\n\nWith this newfound knowledge, Princess Evelyn now faced an even greater challenge. The world-renowned mathematician, Professor Isaac, sent her a letter, posing a final question that pushed the boundaries of her intellect. He asked her to find P(3141592653589793).\n\nEvelyn apprehensively looked at the seemingly impossible problem. The number was mind-bogglingly enormous, unfathomable even to the most astute mathematicians. But Evelyn knew no bounds when it came to her passion for numbers.\n\nDriven by her thirst for knowledge and the desire to unravel the unknown, Princess Evelyn embarked on yet another mathematical quest\u2014to solve the seemingly unconquerable P(3141592653589793).\n\nAs we bid farewell to Princess Evelyn, we are left with the lingering question: Can she unravel the secrets hidden within this mammoth numerical puzzle? Will she find the solution to P(3141592653589793)?\n\nNow, dear reader, the challenge is yours. Can you solve what the brilliant Princess Evelyn could not? Can you find P(3141592653589793)?"}, {"id": 543, "euler_id": 543, "title": "Prime-Sum Numbers", "problem": "Define function P(n,k) = 1 if n can be written as the sum of k prime numbers (with repetitions allowed), and P(n,k) = 0 otherwise.\nFor example, P(10,2) = 1 because 10 can be written as either 3 + 7 or 5 + 5, but P(11,2) = 0 because no two primes can sum to 11.\nLet S(n) be the sum of all P(i,k) over 1 \u2264 i,k \u2264 n.\nFor example, S(10) = 20, S(100) = 2402, and S(1000) = 248838.\nLet F(k) be the kth Fibonacci number (with F(0) = 0 and F(1) = 1).\nFind the sum of all S(F(k)) over 3 \u2264 k \u2264 44", "solution": "199007746081234640", "difficulty": 30, "story": "Once upon a time in a small, vibrant village, there lived a young girl named Lily. Lily had always been fascinated by numbers and patterns. She spent most of her days exploring the nearby forest, her mind filled with mathematical wonders.\n\nOne sunny day, as Lily wandered deeper into the forest, she stumbled upon an ancient book hidden beneath a cluster of wildflowers. Its tattered pages were filled with cryptic symbols and peculiar equations. As she leafed through the worn parchment, her eyes fell upon a particularly intriguing question.\n\n\"Define function P(n,k) = 1 if n can be written as the sum of k prime numbers (with repetitions allowed), and P(n,k) = 0 otherwise. Let S(n) be the sum of all P(i,k) over 1 \u2264 i,k \u2264 n.\"\n\nIntrigued, Lily set out on a quest to unravel the enigma. She soon discovered that P(n,k) was a way to determine if a number, n, could be written as the sum of k prime numbers. It fascinated her to think that such a simple function could hold the key to unlocking the secrets of numbers.\n\nDays turned into weeks, and weeks turned into months as Lily's obsession grew. She dedicated herself fully to understanding the function and its implications. Her passion even began to shape her daily interactions. Whether she was counting the petals on a flower or solving complex equations, numbers consumed her every thought.\n\nLily's grandmother, wise and perceptive, noticed the change in her granddaughter. She worried that Lily's mathematical obsession was isolating her from the joys of life. One evening, as Lily sat at her desk, lost in thought, her grandmother approached her.\n\n\"Lily, my dear, I've watched you immerse yourself in this curious mathematical problem,\" her grandmother said gently. \"While your mind is a treasure trove of numbers, remember that life lies beyond equations. Don't let this one puzzle consume you entirely.\"\n\nLily pondered her grandmother's words. She realized that she had been missing out on the simple joys of laughter and camaraderie. With a heavy heart, she set the ancient book aside, deciding to balance her passion with the wonders of the world outside her windows.\n\nWeeks turned into years, and Lily blossomed into a kind-hearted and vibrant young woman. She continued to cherish her love for mathematics, but she now understood the importance of balance.\n\nOne day, while she was browsing through a local bookstore, Lily stumbled upon a familiar cover. It was the same ancient book she had discovered as a child. With a nostalgic smile, Lily opened it, only to find the inscription she had highlighted all those years ago.\n\n\"Find the sum of all S(F(k)) over 3 \u2264 k \u2264 44\"\n\nAs memories of her past quest flooded her mind, Lily realized that she had unknowingly discovered the meaning of S(n) while on her journey of self-discovery. S(n) represented the sum of all P(i,k) from 1 to n. It was a beautiful expression of how prime numbers could be combined to create a greater whole.\n\nBut as Lily's fingertips traced the faded words on the page, a sudden question formed in her mind. It was a question she couldn't answer herself, one that she now posed to the readers of her story.\n\n\"What is the sum of all S(F(k)) over 3 \u2264 k \u2264 44?\"\n\nAnd with that question, Lily closed the ancient book, leaving the mystery to be unraveled by those who dared to delve into the enchanting world of numbers. For numbers, like stories, held secrets that only those with curious minds could unveil."}, {"id": 555, "euler_id": 555, "title": "McCarthy 91 function", "problem": "\nThe McCarthy 91 function is defined as follows:\nM91(n)={n\u221210if\u00a0n>100M91(M91(n+11))if\u00a00\u2264n\u2264100\n\n\nWe can generalize this definition by abstracting away the constants into new variables:\n\nMm,k,s(n)={n\u2212sif\u00a0n>mMm,k,s(Mm,k,s(n+k))if\u00a00\u2264n\u2264m\n\n\nThis way, we have M91=M100,11,10.\n\n\nLet Fm,k,s be the set of fixed points of Mm,k,s. That is, \n\nFm,k,s={n\u2208N|Mm,k,s(n)=n}\n\n\nFor example, the only fixed point of M91 is n=91. In other words, F100,11,10={91}.\n\n\nNow, define SF(m,k,s) as the sum of the elements in Fm,k,s and let S(p,m)=\u22111\u2264s<k\u2264pSF(m,k,s).\n\n\nFor example, S(10,10)=225 and S(1000,1000)=208724467.\n\n\nFind S(106,106).\n", "solution": "208517717451208352", "difficulty": 30, "story": "Once upon a time in the small village of Numeria, there lived a young and exceptionally curious boy named Max. Max had a burning passion for mathematics and spent his days solving puzzles and exploring intricate mathematical concepts. He always yearned for a real-life problem to solve, something that would challenge his skills and engage his mind.\n\nOne sunny day, as Max was walking home from the village library, a peculiar scroll slipped out from between the pages of his worn-out math book. It was an ancient manuscript with the title \"The Mysterious Function\" written in gold letters across the cover. Intrigued, Max opened the scroll and started reading.\n\nAs he delved deeper into the text, Max's eyes widened with excitement. The manuscript revealed the secret of the McCarthy 91 function, a perplexing mathematical riddle that had stumped many scholars throughout history. For the first time in his life, Max felt like he had found the challenge he had been searching for.\n\nThe McCarthy 91 function was captivating in its complexity, with its countless variables and abstract definitions. Max's mind began to race, connecting dots and formulating his own ideas. He thought of the generalization of the function, the concept of fixed points, and the sum of these points known as SF(m,k,s). It was as if his thoughts had transcended the mere lines on the parchment, and he could almost see the mathematical equations dancing in front of him.\n\nIn the following days, Max devoted himself entirely to unraveling the secrets of this baffling concept. He spent hours scribbling equations on his chalkboard, his eyes gleaming with determination. Max's family soon noticed his fervor, but they understood the importance of his quest and kindly let him immerse himself in his studies.\n\nThe people in the village grew curious as well. The once-quiet streets of Numeria now buzzed with whispers about the young prodigy and his quest to solve the enigmatic McCarthy 91 function. Some were fascinated by his pursuit, while others dismissed it as just another number puzzle.\n\nAs Max's reputation spread, the village elders approached him with a proposition. They had heard about Max's remarkable progress and knew that he was on the verge of unlocking a great mathematical truth. They offered him the opportunity to visit the prestigious Institute of Mathematics in the distant city of Arithmetica. There, he could present his findings to the most brilliant mathematicians in the land.\n\nThrilled by the offer, Max embarked on a grueling journey to Arithmetica, with his mind occupied by equations and the realization that his discovery could revolutionize the world of mathematics. The trip was long and tiring, but Max was undeterred. He knew that his devotion to the McCarthy 91 function was leading him towards something extraordinary.\n\nMonths later, Max arrived at the grand hall of the Institute of Mathematics. The room was filled with the brightest minds from every corner of the realm. Max took a deep breath and stepped onto the stage, ready to share his groundbreaking research.\n\nAs he began explaining the intricacies of the McCarthy 91 function, the audience listened attentively, enthralled by the depth of his knowledge. Max displayed his calculations and diagrams on a massive projector screen, using every resource available to convey his passion and understanding.\n\nWith every word, Max painted a vivid picture of the intertwined nature of numbers and the mystery that lay at the core of the function. His audience marveled at the elegance of his work, unable to tear their eyes away from the screen.\n\nWhen Max finally finished his presentation, the room erupted in applause. Mathematicians and scholars from all disciplines rushed to congratulate him, praising his ingenuity and the profound impact his findings would have on the field of mathematics.\n\nBut as Max joined celebrations and basked in his newfound fame, one question lingered in his mind. That question, the ultimate challenge he had yet to conquer, still eluded him. It burned brighter than ever before, pushing him to explore further and seek a definitive answer.\n\nNow, dear reader, I ask you: Can you solve the mathematical problem Max had dedicated his life to? Can you find S(106,106)?"}, {"id": 561, "euler_id": 561, "title": "Divisor Pairs", "problem": "\nLet S(n) be the number of pairs (a,b) of distinct divisors of n such that a divides b.\nFor n=6 we get the following pairs: (1,2),(1,3),(1,6),(2,6) and (3,6). So S(6)=5.\nLet pm# be the product of the first m prime numbers,  so p2#=2\u22173=6.\nLet E(m,n) be the highest integer k such that 2k divides S((pm#)n).\nE(2,1)=0 since 20 is the highest power of 2 that divides S(6)=5.\nLet Q(n)=\u2211i=1nE(904961,i)\nQ(8)=2714886.\n\n\nEvaluate Q(1012). \n", "solution": "452480999988235494", "difficulty": 30, "story": "Once upon a time, in the bustling city of Mathville, there lived an extraordinary mathematician named Professor Euler. He was renowned for his brilliant mind and his ability to solve complex mathematical problems.\n\nOne sunny morning in Mathville, Professor Euler received a mysterious letter. The letter came from an ancient society known as the Mathemagicians, who were seeking his assistance. They had discovered an elusive mathematical problem and believed Professor Euler was the only one who could solve it.\n\nIntrigued, Professor Euler opened the letter and his eyes widened as he read the challenge they presented. The problem involved a function called S(n), which calculated the number of pairs of distinct divisors of a given number n. The Mathemagicians had a particular interest in the highest power of 2 that divided the sum of these pairs. They called this value E(m, n).\n\nDetermined to crack the code, Professor Euler retreated to his study. He dedicated every waking moment to understanding the intricacies of S(n) and E(m, n). As he delved deeper into the problem, he realized the function's remarkable patterns and correlations.\n\nDays turned into weeks, and weeks turned into months. Professor Euler's hair grew disheveled, and his eyes were bloodshot from countless sleepless nights. Yet, he remained resolute in his pursuit of an answer. The mathematical problem had become an obsession, a puzzle that had consumed him entirely.\n\nFinally, after months of tireless calculations and countless sheets of paper covered in scribbled equations, Professor Euler felt a breakthrough was within his grasp. His mind raced with possibilities as he discovered a connection between prime numbers and the function S(n).\n\nEnlightened by his newfound knowledge, Professor Euler embarked on a quest to harness the power of prime numbers. His goal was to determine the highest power of 2 that divided S((pm#)n), where pm# represented the product of the first m prime numbers. By solving for E(904961, i) for different values of n, he hoped to unravel the mysteries of the Mathemagicians' problem.\n\nAs Professor Euler toiled away, his journey took him to the far corners of Mathville, seeking answers from renowned mathematicians and consulting ancient texts. He traversed treacherous landscapes, waded through murky waters, and climbed towering mountains in his relentless pursuit of knowledge.\n\nFinally, after years of devotion, Professor Euler arrived at the peak of Mount Mathus. There, in a secluded cave, he made his breakthrough. The solution to the Mathemagicians' problem began to crystallize in his mind. But as he processed the implications, a tantalizing question formed on his lips.\n\nExhilarated yet still perplexed, Professor Euler wondered aloud, \"Can you evaluate Q(1012)?\"\n\nAnd that, dear reader, is where the story ends. What is the answer? How would you solve the problem presented by the Mathemagicians? The fate of Mathville's mystery rests in your capable hands."}, {"id": 581, "euler_id": 581, "title": "47-smooth triangular numbers", "problem": "\nA number is p-smooth if it has no prime factors larger than p.\nLet T be the sequence of triangular numbers, ie T(n)=n(n+1)/2.\nFind the sum of all indices n such that T(n) is 47-smooth.\n", "solution": "2227616372734", "difficulty": 30, "story": "Once upon a time, in a small village nestled at the foot of a majestic mountain range, lived a young boy named Ethan. He was known for his insatiable curiosity and sharp intellect, always seeking out new puzzles to solve. One day, as Ethan strolled through the village square, a peculiar wooden box caught his eye.\n\nIntrigued, Ethan approached the box and discovered an engraving on its surface. It read: \"Solve the mystery of the p-smooth treasure.\" Without hesitation, Ethan opened the box to find a scrap of parchment, neatly folded and tucked away.\n\nUnfolding the parchment, Ethan's eyes widened with excitement when he realized it contained a puzzling mathematical problem. It started with the definition: \"A number is p-smooth if it has no prime factors larger than p.\" Curiosity piqued, Ethan's mind began to race as he delved into the challenge set before him.\n\nUnbeknownst to Ethan, a group of treasure hunters had arrived in the village, determined to uncover the secrets concealed within the box. Led by the cunning Captain Morgan, the treasure hunters had one goal in mind \u2014 to claim the p-smooth treasure for themselves.\n\nAs Ethan immersed himself in the problem, he couldn't help but wonder about the significance of the p-smooth treasure. What made it so valuable? And why did it require a mathematical problem to unlock its mysteries?\n\nDays turned into weeks, and Ethan's obsession with the mathematical problem grew. He found himself poring over textbooks, consulting with wise villagers, and even dreaming about the solution. Everywhere he turned, the sequence of triangular numbers, marked as T(n), haunted him.\n\nIn his quest for knowledge, Ethan stumbled upon an ancient legend passed down through generations in the village. The legend spoke of a mighty dragon that had once roamed the mountain range, guarding a treasure of unimaginable riches. It was said that this treasure possessed a peculiar property \u2014 it was only accessible to individuals capable of mastering mathematical challenges.\n\nRealizing the connection between the legend and the p-smooth treasure, Ethan's determination skyrocketed. He understood that finding the answer to the mathematical problem was the only way to gain access to the treasure. The thought of uncovering its secrets and unraveling the mysteries that lay within fueled his resolve.\n\nWith newfound determination, Ethan embarked on a journey to solve the problem. He traveled through treacherous terrains, faced countless obstacles, and encountered creatures that seemed straight out of ancient tales. But all the while, his mind remained fixated on finding the sum of all indices n for which T(n) would be 47-smooth.\n\nAs Ethan ventured deeper into the heart of the mountains, he began to understand the true significance of the mathematical problem. It was not simply a test of his intellect but a rite of passage, a way for the p-smooth treasure to separate the worthy from the unworthy.\n\nFinally, after months of relentless pursuit, Ethan emerged from the labyrinthine caves and stood before a towering door, adorned with intricate patterns. He knew that behind it lay the p-smooth treasure, awaiting its champion.\n\nBut as Ethan prepared to unlock the door, he paused. A question formed in his mind, and he realized it was the final piece of the puzzle. How would he sum all the indices n such that T(n) was 47-smooth?\n\nWith his heart pounding, Ethan turned to the reader and asked, \"Can you solve this mathematical challenge and unlock the secrets of the p-smooth treasure? What is the sum of all indices n for which T(n) is 47-smooth?\" And as he posed the question, a glimmer of hope sparkled in his eyes, for he knew that the journey had only just begun."}, {"id": 612, "euler_id": 612, "title": "Friend numbers", "problem": "\nLet's call two numbers  friend numbers if their representation in base 10 has at least one common digit. E.g. 1123 and 3981 are friend numbers. \n\n\nLet f(n) be the number of pairs (p,q) with 1\u2264p<q<n such that p and q are friend numbers.\nf(100)=1539.\n\n\nFind f(1018) mod 1000267129.\n", "solution": "819963842", "difficulty": 30, "story": "Once upon a time in a small village called Numeria, there lived a young mathematician named Ethan. He was known throughout the village for his brilliance and uncanny ability to solve complex problems effortlessly. Ethan's mind was like a well-oiled machine, always hungry for new challenges to feed its insatiable curiosity.\n\nOne beautiful morning, as the sun painted the sky with vibrant orange hues, Ethan received an anonymous letter. The letter contained a mathematical problem that intrigued him. It was from a mysterious person who called themselves \"The Math Master,\" and it read:\n\n\"Dear Ethan,\n\nLet's call two numbers friend numbers if their representation in base 10 has at least one common digit. E.g. 1123 and 3981 are friend numbers.\n\nLet f(n) be the number of pairs (p,q) with 1\u2264p<q<n such that p and q are friend numbers.\n\nf(100)=1539.\n\nFind f(1018) mod 1000267129.\n\nYours sincerely,\nThe Math Master\"\n\nEthan's eyes lit up with excitement. He had never encountered such a captivating problem before. As he read the problem over and over again, his mind started to spin, searching for patterns and connections. His village friends and even his parents noticed his distraction, but Ethan couldn't tear himself away from this intriguing conundrum.\n\nDays turned into weeks, and weeks into months. Ethan spent every waking moment absorbed in the mystery of the friend numbers. He poured over countless notebooks, scribbling and erasing, twisting and turning numbers in his quest to solve the problem. The village started buzzing with rumors of Ethan's obsession, yet no one knew the true extent of his determination.\n\nMonths turned into years, but to Ethan, it felt like an eternity. The weight of the unsolved problem bore down on him, taking a toll on his once-cheerful spirit. His friends, who had grown worried about him, staged an intervention. They surrounded him one day, pleading with him to step away from the problem and give himself a break. But Ethan, with a fire burning in his eyes, refused to relent.\n\nIt was on a rainy afternoon, after years of tireless effort, that Ethan had a sudden epiphany. His eyes widened, and he knew, he just knew, that he was on the cusp of unraveling the mystery that had consumed his life for so long.\n\nWith renewed vigor, Ethan hurriedly started writing down his calculations, his hand barely able to keep up with the speed of his thoughts. Numbers danced and twirled in his mind as he began to see the intricate relationship between the friend numbers. It was as if the numbers had come alive, whispering their secrets to him.\n\nHowever, just as Ethan was about to complete his calculations and find the elusive solution, a catastrophic accident occurred. A storm had swept over Numeria, causing a lightning bolt to strike Ethan's home. The once-vibrant village was now shrouded in darkness, and Ethan's painstakingly filled notebooks were reduced to ashes.\n\nDevastated, Ethan collapsed onto his knees, the rain mingling with his tears. \"Why?\" he cried out to the heavens, feeling defeated. \"Why was the answer snatched away from me at the very last moment?\"\n\nBut even in his darkest hour, Ethan's determination remained unshakeable. He realized that the solution to the mathematical problem might have been lost, but his spirit remained strong. With newfound resolve, he decided to share his story with the world, hoping that someone, somewhere, could unlock the mysteries of the friend numbers.\n\nAnd so, dear reader, the question remains: Can you solve the mathematical problem that consumed Ethan's life? Can you find f(1018) mod 1000267129?"}, {"id": 624, "euler_id": 624, "title": "Two heads are better than one", "problem": "\nAn unbiased coin is tossed repeatedly until two consecutive heads are obtained. Suppose these occur on the (M\u22121)th and Mth toss.\nLet P(n) be the probability that M is divisible by n. For example, the outcomes HH, HTHH, and THTTHH all count towards P(2), but THH and HTTHH do not.\n\nYou are given that P(2)=35 and P(3)=931. Indeed, it can be shown that P(n) is always a rational number.\n\nFor a prime p and a fully reduced fraction ab, define Q(ab,p) to be the smallest positive q for which a\u2261bq(modp).\nFor example Q(P(2),109)=Q(35,109)=66, because 5\u22c566=330\u22613(mod109) and 66 is the smallest positive such number.\nSimilarly Q(P(3),109)=46.\n\nFind Q(P(1018),1000000009).", "solution": "984524441", "difficulty": 30, "story": "Once upon a time in a small village, there lived a young shepherd named Marcus. Marcus was known for his curiosity and love for mathematics. Every day, he would lead his sheep up the green hills, using various mathematical methods to guide them safely.\n\nOne sunny morning, as Marcus set out with his flock, he noticed a peculiar coin lying in the grass. It was unlike any he had ever seen before, with intricate mathematical symbols engraved upon it. Intrigued, he picked it up and examined it closely. Little did he know that this coin would lead him on an unexpected mathematical adventure.\n\nThat very evening, as Marcus settled down by the campfire, he absentmindedly tossed the coin into the air. To his surprise, it landed on heads not just once but twice, in rapid succession. His mathematical mind sparked with curiosity. How often does this happen? How can I determine the probability?\n\nUnable to resist, Marcus decided to explore this problem. He pondered, \"Let's call the number of times I have to toss the coin until I get two consecutive heads 'M.' What are the chances that M is divisible by 2? And by 3?\"\n\nNight after night, Marcus meticulously recorded his findings in his notebook, gradually uncovering the secrets of the coin's behavior. He discovered that if M was divisible by 2, then the probability of that happening was 35 out of a hundred.\n\nFurthermore, if M was divisible by 3, the probability increased to 931 out of a thousand. This fascinated Marcus\u2014he couldn't help but wonder why P(3) was so much larger than P(2).\n\nAs the days turned into weeks, Marcus's mind swirled with possibilities. He pondered on prime numbers, fully reduced fractions, and the significance of modular arithmetic. A question haunted him: What would happen if he applied this newfound knowledge to even greater values of M, such as 1018?\n\nOne evening, as Marcus sat beneath the starry sky, contemplating his mathematical journey, a great sense of determination washed over him. He realized that finding Q(P(1018),1000000009) could be the greatest mathematical puzzle he had ever attempted. But he couldn't do it alone; he needed help.\n\nMarcus decided to embark on a quest to find fellow mathematicians who could aid him in his pursuit. He knew that each person's unique perspective and mathematical prowess would be crucial in unraveling the final answer. Little did he know that along this journey, he would make new friends, encounter unforeseen obstacles, and gain a deeper understanding of the power of collaboration.\n\nAnd so, dear reader, the tale of Marcus, the shepherd turned mathematician, begins. Will his journey lead to the discovery of Q(P(1018),1000000009)? How will he navigate the challenges that lie ahead? Who will join him on this mathematical adventure?\n\nNow, it is your turn, dear reader, to solve the problem that Marcus poses. What will you find? What is Q(P(1018),1000000009)? Do you have what it takes to unlock the final piece of this mathematical enigma?\n\nThe story awaits your mathematical prowess and curiosity."}, {"id": 628, "euler_id": 628, "title": "Open chess positions", "problem": "\nA position in chess is an (orientated) arrangement of chess pieces placed on a chessboard of given size. In the following, we consider all positions in which n pawns are placed on a  n\u00d7n  \nboard in such a way, that there is a single pawn in every row and every column.\n\n\n\nWe call such a position an open position, if a rook, starting at the (empty) lower left corner and using only moves towards the right or upwards, can reach the upper right corner without moving onto any field occupied by a pawn. \n\nLet f(n) be the number of open positions for a n\u00d7n chessboard.\nFor example, f(3)=2, illustrated by the two open positions for a 3\u00d73 chessboard below.\n\n\n\n\nYou are also given f(5)=70.\nFind f(108) modulo 1008691207.", "solution": "210286684", "difficulty": 30, "story": "Once upon a time in the peaceful kingdom of Mathematica, there was a young girl named Ada. Ada was known for her remarkable abilities in solving complex mathematical problems. Her intelligence was renowned throughout the entire kingdom, and people would often seek her out for advice.\n\nOne sunny day, as Ada was strolling through the bustling streets of her village, she noticed a commotion near the town square. Curiosity piqued, she hastened her steps and found herself at the center of a crowd. In the midst of the chaos stood the king, holding a beautifully crafted chessboard.\n\n\"My dear citizens,\" the king's booming voice echoed, \"I present to you a challenge, a feat of logic and strategy. Solve this mathematical problem, and the victor shall receive a grand reward.\"\n\nThe crowd hushed, eager to hear the details of the challenge. Ada pushed her way through and caught a glimpse of the chessboard, its squares filled with intricately carved pawns. The king continued, \"This chessboard measures n\u00d7n, and it contains n pawns. Arrange them in such a way that there is a single pawn in every row and every column. The challenge lies in creating an 'open position,' which allows a rook to travel from the lower left corner to the upper right corner without crossing any occupied squares.\"\n\nDelighted by the mathematical problem, Ada's eyes lit up with excitement. Her mind raced with possibilities and strategies, as she envisioned the countless arrangements that could fulfill the king's challenge. She approached the king with a confident smile and presented him a solution for the 3\u00d73 chessboard.\n\nImpressed by Ada's quick thinking, the king congratulated her, \"Well done, my dear Ada! Indeed, there are two open positions for a 3\u00d73 chessboard. Your intelligence truly knows no bounds.\" The crowd erupted in applause, and Ada felt a surge of pride.\n\nDays turned into weeks as Ada delved deeper into the problem at hand. She pondered over the various ways pawns could be placed on the larger chessboards, never faltering in her determination to find the number of open positions. Her world became a whirlwind of calculations, visions of chessboards, and desperate attempts to tame the wild numbers.\n\nFinally, after countless sleepless nights and feverish scribblings, Ada found her answer. The elusive f(108) was unraveled before her eyes. She discovered the number of open positions for the colossal 108\u00d7108 chessboard, the largest the kingdom had ever seen. It was an extraordinary number, one that could only be tamed by the most formidable of mathematical minds.\n\nAda's heart swelled with triumph as she realized the magnitude of her discovery. But a question plagued her thoughts \u2014 what was f(108) modulo 1008691207? The answer to this puzzle would truly test the limits of her problem-solving prowess.\n\nAda craved the satisfaction of finding the final piece of the mathematical puzzle. She yearned to uncover the hidden secrets locked within f(108) modulo 1008691207, but she also knew that she couldn't hold all the answers herself. The power of mathematical discovery belonged to the curious minds of the kingdom.\n\nAnd so the question remains: Can you solve f(108) modulo 1008691207, my dear reader? The kingdom of Mathematica awaits your solution, as its fate, and the reward it holds, lies in your mathematical prowess."}, {"id": 647, "euler_id": 647, "title": "Linear Transformations of Polygonal Numbers", "problem": "\nIt is possible to find positive integers A and B such that given any triangular number, Tn, then ATn+B is always a triangular number. We define F3(N) to be the sum of (A+B) over all such possible pairs (A,B) with max(A,B)\u2264N. For example F3(100)=184.\n\n\nPolygonal numbers are generalisations of triangular numbers. Polygonal numbers with parameter k we call k-gonal numbers. The formula for the nth k-gonal number is 12n(n(k\u22122)+4\u2212k) where n\u22651. For example when k=3 we get 12n(n+1) the formula for triangular numbers.\n\n\nThe statement above is true for pentagonal, heptagonal and in fact any k-gonal number with k odd. For example when k=5 we get the pentagonal numbers and we can find positive integers A and B such that given any pentagonal number, Pn, then APn+B is always a pentagonal number. We define F5(N) to be the sum of (A+B) over all such possible pairs (A,B) with max(A,B)\u2264N.\n\n\nSimilarly we define Fk(N) for odd k. You are given \u2211kFk(103)=14993 where the sum is over all odd k=3,5,7,\u2026.\n\n\nFind \u2211kFk(1012) where the sum is over all odd k=3,5,7,\u2026\n", "solution": "563132994232918611", "difficulty": 30, "story": "Once upon a time, in the small town of Numeria, there lived a curious young girl named Maya. Maya had always been fascinated by numbers and patterns. She would spend hours solving math puzzles and exploring the world of mathematics. Her favorite pastime was to create stories that incorporated her mathematical knowledge, taking her friends and family on wonderful adventures through the realms of numbers.\n\nOne sunny day, as Maya was playing in the park, she saw a group of children huddled around a peculiar puzzle. Curiosity getting the better of her, she approached the children, eager to see what had captured their attention.\n\n\"What are you all looking at?\" Maya asked, peering over their shoulders.\n\nOne of the kids turned to her and said, \"We found this math problem, and it's really intriguing! It involves triangular and polygonal numbers, and we're trying to solve it.\"\n\nIntrigued, Maya studied the problem the children were working on. It talked about positive integers A and B such that when you multiply the triangular numbers by A and add B, the result will always be a triangular number. The statement held true for k-gonal numbers, with k being odd.\n\nMaya's eyes lit up with excitement. She couldn't believe her luck. This was a problem made for her. She had always loved triangular and polygonal numbers, and here was an opportunity to apply her skills. The children excitedly invited her to join them in finding the solution.\n\nFor days, Maya and the kids worked tirelessly, exploring various patterns and equations. They found that by substituting triangular numbers, specifically Tn, into the given formula, they could easily obtain the desired results. The same applied to other k-gonal numbers when k was an odd number.\n\nMaya's heart swelled with pride as they made significant progress. Eventually, they discovered a formula that helped them find the sum of (A + B) for different values of N. They called it Fk(N), where k referred to the odd k-gonal numbers.\n\nThe children, including Maya, were overwhelmed by the depth and beauty of mathematics. They realized that numbers didn't just exist as abstract concepts but had real-world applications and connections. As they delved deeper, they couldn't help but wonder about the larger implications of their findings.\n\nFinally, after countless hours of exploration and collaboration, the children witnessed something truly remarkable. The sum \u2211kFk(103) was revealed to be 14993. It was a unique moment of triumph and awe.\n\nBreathless from their breakthrough, the curious young minds couldn't help but ponder the next step. If they could find \u2211kFk(103), what could they deduce about \u2211kFk(1012)? The question hung in the air, igniting a sense of excitement and determination.\n\nMaya knew that this was a challenge that required all her mathematical prowess. She couldn't help but wonder about the implications of solving this problem. What hidden mysteries would it unveil? What new mathematical connections would she uncover?\n\nAs the sun set over Numeria, Maya looked to the stars, her mind buzzing with numbers and possibilities. She knew that finding the answer to \u2211kFk(1012) would open doors to new realms of understanding. With her heart filled with determination, Maya quietly asked herself, \"Can you solve this mathematical puzzle? What lies at the end of this numeric journey?\"\n\nAnd with that lingering question, the story continues, inviting you, dear reader, to embark on your own adventure through the wonderful world of numbers and grasp the solution to \u2211kFk(1012). Will you rise up to the challenge and unveil the hidden secrets within?"}, {"id": 649, "euler_id": 649, "title": "Low-Prime Chessboard Nim", "problem": "Alice and Bob are taking turns playing a game consisting of c different coins on a chessboard of size n by n.\n\nThe game may start with any arrangement of c coins in squares on the board. It is possible at any time for more than one coin to occupy the same square on the board at the same time. The coins are distinguishable, so swapping two coins gives a different arrangement if (and only if) they are on different squares.\nOn a given turn, the player must choose a coin and move it either left or up 2, 3, 5, or 7 spaces in a single direction. The only restriction is that the coin cannot move off the edge of the board.\nThe game ends when a player is unable to make a valid move, thereby granting the other player the victory.\nAssuming that Alice goes first and that both players are playing optimally, let M(n,c) be the number of possible starting arrangements for which Alice can ensure her victory, given a board of size n by n with c distinct coins.\nFor example, M(3,1)=4, M(3,2)=40, and M(9,3)=450304.\nWhat are the last 9 digits of M(10000019,100)?", "solution": "924668016", "difficulty": 30, "story": "Once upon a time in the vibrant kingdom of Numeria, there lived two young neighbors named Alice and Bob. They were not just ordinary children, for they possessed an insatiable curiosity for mathematics and a knack for strategic thinking.\n\nOne sunny afternoon, Alice received a strange package with a golden seal. Inside, she found an ancient chessboard along with a letter detailing an extraordinary challenge. The game involved a mysterious mathematical problem, and Alice couldn't resist its allure. She dashed next door to share the news with Bob, who was equally intrigued.\n\nAs they read the letter together, they discovered that the game required them to arrange \"c\" different coins on the chessboard of size \"n\" by \"n.\" The rules were intricate, as they could only move the coins left or up by distances of 2, 3, 5, or 7 spaces. The ultimate goal was to triumph over their opponent by making strategic moves until their adversary had no more valid turns.\n\nThe challenge fascinated both Alice and Bob, and they resolved to solve it together. They spent their days studying the problem, devising strategies, and experimenting with various coin arrangements on the chessboard. Alice, being the analytical thinker, was determined to find a way for herself to emerge victorious.\n\nOne evening, a breakthrough came to Alice. She realized that by meticulously observing past arrangements and employing mathematical principles, she could predict her chances of winning based on the initial setup of the coins. Alice begun keeping count of all the different winning arrangements she discovered, tirelessly noting down the numbers.\n\nDays turned into weeks, and weeks turned into months, as Alice and Bob immersed themselves in the game. They couldn't bear the thought of giving up, even when the challenges seemed insurmountable. Through their relentless efforts, they solved the puzzle for various board sizes and coin quantities, eagerly unraveling the secrets hidden within the mathematical problem.\n\nFinally, after months of trial and error, Alice and Bob found themselves confronted with a formidable task. The last challenge beckoned, as the mathematical problem presented itself in its most complex form yet. The board size \"n\" was a staggering 10,000,019, and the coins totaled 100. The numbers alone overwhelmed them, but they refused to let that deter their spirits.\n\nTogether, they unleashed their mathematical prowess on the colossal chessboard, prodding at the numbers, and testing countless possibilities. As the days and nights blended into a blur of calculations, Alice grew more confident that a solution lingered just beyond their reach. She had become unequivocally determined to show her undeniable competence in this complex contest.\n\nThe memory of the golden seal on that mysterious package fueled Alice's determination. With each move she made, she felt herself inching closer to victory. But as she delved deeper into the calculations, it became clear that the question at hand was extraordinary \u2013 it demanded an answer far beyond the scope of their marveled kingdom.\n\nAs the clock ticked away, and the sun set behind the horizon, Alice couldn't shake off her desire for the solution. With a heavy sigh, she turned to Bob, their eyes reflecting both exhaustion and exhilaration.\n\n\"Bob,\" Alice said, her voice filled with a blend of wonder and yearning, \"tell me, what are the last 9 digits of M(10,000,019,100)?\"\n\nAnd so, dear reader, the perplexing question hangs in the air, waiting for someone like you to solve the enigma that captivated Alice and Bob. Will you take on the challenge and uncover the mystery that transcends time and numbers?"}, {"id": 655, "euler_id": 655, "title": "Divisible Palindromes", "problem": "The numbers 545, 5995 and 15151 are the three smallest palindromes divisible by 109. There are nine palindromes less than 100000 which are divisible by 109.\nHow many palindromes less than 1032 are divisible by 10000019 ?", "solution": "2000008332", "difficulty": 30, "story": "Once upon a time, in the quaint town of Ampleville, there lived a brilliant mathematician named Professor Ethan. He had a reputation for solving the most challenging problems, and his profound knowledge of numbers and patterns was legendary.\n\nOne sunny morning, as Professor Ethan strolled through the park, he noticed a young girl named Lily sitting on a bench, looking frustrated. Curiosity getting the best of him, he approached her and asked, \"Excuse me, young lady. Is something troubling you?\"\n\nLily looked up at the professor with tearful eyes and nodded. \"Yes, Professor Ethan. I love numbers, but I'm stuck on a particularly difficult puzzle. I've been trying to solve a problem involving palindromes, but it's proving to be quite challenging.\"\n\nIntrigued, Professor Ethan sat next to Lily on the bench. \"Palindromes? I happen to enjoy exploring the beauty of numbers as well. What seems to be the issue?\"\n\nLily handed him a piece of paper, her hand-drawn scribbles showcasing her efforts to understand the problem. The professor's eyes twinkled with excitement as he analyzed it. After a few moments of thoughtful consideration, he looked up at Lily with a smile.\n\n\"Lily, my dear, these palindromes you have here remind me of a fascinating mathematical problem I encountered once. The numbers 545, 5995, and 15151 are the three smallest palindromes divisible by 109. However, this leads to a more intriguing question. How many palindromes less than 1032 are divisible by 10000019?\"\n\nLily's eyes widened in awe. \"That's incredible, Professor Ethan! How could I tackle such a complex problem?\"\n\nProfessor Ethan chuckled. \"Well, palindromes possess a certain symmetry, much like our own lives. To solve this puzzle, we must unravel the hidden patterns within these palindromic numbers, their divisibility, and the magical relationship they share with each other.\"\n\nAs the professor explained the intricacies of the problem, Lily's excitement grew, and they spent the entire day engrossed in their discussion. The park was their sanctuary of curiosity as they interwove the mathematical problem into the narrative of the town's old library, forgotten secrets, and hidden treasures.\n\nDays turned into weeks, and Lily and Professor Ethan dove deeper into their exploration of palindromes. Along the way, they discovered the significance of prime numbers and their unique relationship to these palindromes. The problem became more than just an intellectual challenge; it encapsulated the essence of their shared passion for knowledge.\n\nFinally, after weeks of tireless effort, their journey arrived at a crossroads. Lily and Professor Ethan reached a point where they could delve no further without the input of others. As the sun set on their last day in the park, they looked at each other with a mix of accomplishment and anticipation.\n\nNow, dear reader, we leave you with this question: How many palindromes less than 1032 are divisible by 10000019? Will you take up the journey alongside Lily and Professor Ethan and unlock the mystery of these enchanting numbers?"}, {"id": 657, "euler_id": 657, "title": "Incomplete words", "problem": "In the context of formal languages, any finite sequence of letters of a given alphabet \u03a3 is called a word over \u03a3. We call a word incomplete if it does not contain every letter of \u03a3.\n\nFor example, using the alphabet \u03a3={a,b,c}, 'ab', 'abab' and '' (the empty word) are incomplete words over \u03a3, while 'abac' is a complete word over \u03a3.\n\nGiven an alphabet \u03a3 of \u03b1 letters, we define I(\u03b1,n) to be the number of incomplete words over \u03a3 with a length not exceeding n. \nFor example, I(3,0)=1, I(3,2)=13 and I(3,4)=79.\n\nFind I(107,1012). Give your answer modulo 1000000007.", "solution": "219493139", "difficulty": 30, "story": "Once upon a time in the Kingdom of Alphaland, there lived a young princess named Isabella. She was known throughout the kingdom for her insatiable curiosity, particularly when it came to the mysteries of language and mathematics. Isabella was always seeking new adventures that would challenge her intellect and broaden her horizons.\n\nOne sunny morning, as Isabella strolled through the palace gardens, she stumbled upon a tattered old book hidden beneath a blossoming rose bush. Curious as ever, she picked it up and discovered that it contained a wealth of knowledge about formal languages and words.\n\nIntrigued by this newfound treasure trove of information, Isabella spent days and nights studying the concepts described within the pages of the book. She marveled at the idea of incomplete words - those peculiar word sequences that did not contain every letter of the alphabet. As she delved deeper into the subject, she felt a connection forming between her newfound knowledge and something yet undiscovered.\n\nOne evening, while the kingdom was immersed in the beauty of a lunar eclipse, a thought struck Isabella like a bolt of lightning. She realized that these incomplete words held a profound secret, one that could change the very fabric of her world. She realized that by understanding the principles behind the incomplete words, she could unlock a power previously unknown.\n\nUnable to contain her excitement, Isabella sought the guidance of the kingdom's wisest mathematician, Harold. She explained to him the concept of incomplete words and their significance. Harold listened eagerly, his eyes widening with each revelation. As he pondered the implications of Isabella's discovery, a spark of hope ignited within him.\n\nDays turned into weeks as Isabella and Harold collaborated on deciphering the mystery hidden within the incomplete words. Their conversations echoed through the vast halls of the palace, accompanied by the sound of turning pages and scratching quills. They worked tirelessly, driven by the belief that this newfound knowledge could shape the future of Alphaland.\n\nFinally, after countless sleepless nights and endless calculations, the breakthrough they had longed for arrived. With trembling hands and elation in their voices, they realized they had solved the mathematical problem. Their solution revealed the true power of incomplete words, an extraordinary ability to alter the course of events through language itself.\n\nBut before they could put their newfound power to the test, a question loomed before them. A question that had the potential to change everything for Isabella, Harold, and the entire kingdom. Isabella turned to Harold, her eyes shining with determination.\n\n\"What is I(107,1012)? Can we unlock the secret hidden within this number as we did with the incomplete words?\" she asked, her voice filled with a mix of anticipation and curiosity.\n\nAnd so, dear reader, I pose the same question to you. Can you solve the mystery of I(107,1012), and uncover the power hidden within these incomplete words?"}, {"id": 697, "euler_id": 697, "title": "Randomly Decaying Sequence", "problem": "Given a fixed real number c, define a random sequence (Xn)n\u22650 by the following random process:\nX0=c (with probability 1).\nFor n>0, Xn=UnXn\u22121 where Un is a real number chosen at random between zero and one, uniformly, and independently of all previous choices (Um)m<n.\nIf we desire there to be precisely a 25% probability that X100<1, then this can be arranged by fixing c such that log10\u2061c\u224846.27.\nSuppose now that c is set to a different value, so that there is precisely a 25% probability that X10000000<1.\nFind log10\u2061c and give your answer rounded to two places after the decimal point.", "solution": "4343871.06", "difficulty": 30, "story": "Once upon a time in the beautiful village of Numeria, there lived a renowned mathematician named Professor Epsilon. He was a wise and eccentric old man, known for his ability to solve the most complex mathematical problems. Professor Epsilon's quaint little house nestled within a picturesque garden, where he spent most of his time pondering over numbers and equations.\n\nOne sunny morning, a young girl named Lily stumbled upon Professor Epsilon's house. She was curious and eager to learn about the mysteries of mathematics, so she decided to seek the professor's guidance. With a hopeful heart, she knocked on his door.\n\nTo Lily's surprise, the door was opened by a robot with gears and wires, named Delta. Delta stood at attention, programmed to assist Professor Epsilon in his calculations. The little robot invited Lily inside and informed the professor of her arrival.\n\nProfessor Epsilon, an old man with a long white beard, emerged from his study, where the walls were covered in intricate formulas. His eyes twinkled with excitement at the sight of a young mind willing to learn. He welcomed Lily with open arms and expressed his delight in sharing the wonders of mathematics.\n\nWith the curiosity sparking in Lily's eyes, Professor Epsilon decided to tell her a tale that would reveal a mystical mathematical problem.\n\n\"Lily,\" he began, \"Imagine a world where numbers hold the power to shape our destiny. In this realm, there exists a magical sequence, known as the Mathemagica Sequence. It is created by following a specific process.\"\n\nIntrigued, Lily leaned closer, hanging onto Professor Epsilon's every word.\n\n\"The Mathemagica Sequence starts with a fixed real number, c. Let's say that at the very beginning, c is set to a value that lies somewhere between a 25% chance of the sequence reaching a particular point, let's say X100, being less than 1.\"\n\nLily furrowed her brows, trying to grasp the concept. \"Professor Epsilon, what does that mean?\"\n\nThe professor smiled, appreciating her curiosity. \"Dear Lily, it means that if we start with a certain value for c, there will be a one in four chance, precisely a 25% probability, that when we reach the 100th step of the Mathemagica Sequence, X100, it will be less than 1.\"\n\n\"But how does one determine this value for c?\" asked Lily with genuine interest.\n\nProfessor Epsilon chuckled softly. \"It's all in the power of logarithms, my dear. You see, in order to achieve the desired probability, we must fix c such that log10\u2061c is approximately 46.27.\"\n\nLily's eyes widened with amazement. She was beginning to understand the intricate relationship between numbers and the enchanting world of mathematics. Professor Epsilon's storytelling had transported her into a magical realm of possibilities.\n\nAs the sun began to set, painting the sky with vibrant hues, Professor Epsilon looked at Lily and posed a question that would challenge her newfound knowledge.\n\n\"Tell me, Lily, what if we wanted the probability of X10000000, the 10-millionth step of the Mathemagica Sequence, to be precisely 25%? What value should logarithm base 10 of c be?\"\n\nLily's mind started racing, contemplating the problem before her. She realized the significance of this puzzle and how it held the key to unlock the secrets of the Mathemagica Sequence. Determined to prove herself, she pondered over the question as the garden filled with the mystical glow of twilight.\n\nAnd so, we turn to you, dear reader. Can you solve the riddle Professor Epsilon posed to Lily? What should the logarithm base 10 of c be to achieve a 25% probability at X10000000?\n\nThe answer lies in the magical unity of numbers, waiting to be unraveled by an inquisitive mind."}, {"id": 698, "euler_id": 698, "title": "123 Numbers", "problem": "\nWe define 123-numbers as follows:\n\n1 is the smallest 123-number.\nWhen written in base 10 the only digits that can be present are \"1\", \"2\" and \"3\" and if present the number of times they each occur is also a 123-number.\n\nSo 2 is a 123-number, since it consists of one  digit \"2\" and 1 is a 123-number. Therefore, 33 is a 123-number as well since it consists of two digits \"3\" and 2 is a 123-number.\nOn the other hand, 1111 is not a 123-number, since it contains 4 digits \"1\" and 4 is not a 123-number.\n\n\nIn ascending order, the first 123-numbers are:\n1,2,3,11,12,13,21,22,23,31,32,33,111,112,113,121,122,123,131,\u2026\n\n\nLet F(n) be the n-th 123-number. For example F(4)=11, F(10)=31, F(40)=1112, F(1000)=1223321 and F(6000)=2333333333323.\n\n\nFind F(111111111111222333). Give your answer modulo 123123123.\n", "solution": "57808202", "difficulty": 30, "story": "Once upon a time in the whimsical village of Numeria, the inhabitants lived completely immersed in the world of numbers. Mathematics wasn't just a subject they studied; it was the very essence of their daily lives. And in this village, there was a young girl named Ava, who had a unique connection with numbers.\n\nAva possessed a rare gift, an innate ability to see the magical properties hidden within the numerical realm. She saw patterns, equations, and formulas that others simply couldn't fathom. As she grew older, the village elders recognized her extraordinary talent and allowed her to delve deeper into the mysteries of mathematics.\n\nOne day, while Ava was exploring the vast archives of Numeria, she stumbled upon an ancient scroll containing an intriguing problem. It was a puzzle involving the esoteric world of \"123-numbers.\" Captivated by the challenge, Ava began to immerse herself in the problem, determined to decipher its secrets.\n\nAs Ava dived deeper into the puzzle, she discovered the enchanting nature of 123-numbers. Throughout their universe, numbers were bound by strict rules. A 123-number could only contain the digits 1, 2, and 3. And beyond that, the number of times each digit appeared had to be a valid 123-number itself.\n\nIn her pursuit of understanding, Ava uncovered that 2 was the smallest 123-number, as it consisted of a single digit \"2,\" while 1 was a 123-number on its own. She realized that this pattern extended further. For instance, 33 was also a 123-number because it contained two \"3's,\" and 2 was a 123-number in itself.\n\nHowever, Ava discovered that not all numbers conformed to this extraordinary sequence. In fact, even though 1111 seemed like it could be a 123-number, it miserably failed to meet the criteria. It contained four \"1's,\" which made it unfit for the 123-world.\n\nEager to explore this intriguing series of numbers, Ava started to generate the sequence. She jotted down the first few 123-numbers: 1, 2, 3, 11, 12, 13, 21, 22, 23, 31, 32, 33, and the list went on. The numbers appeared both familiar and mysterious, holding infinite possibilities.\n\nBut there was one 123-number that captivated Ava\u2014F(111111111111222333). It stood as an elusive challenge, daring her to seek its answer. As she continued her research, Ava became more and more consumed by this particular mathematical quest.\n\nAva's mind raced as she contemplated the enormity of the task before her. What could F(111111111111222333) possibly be? And how could she find the solution in a village where time was irrelevant, yet every second mattered?\n\nIt was clear to Ava that this mathematical problem held immense significance, not only for her but for the village of Numeria itself. The knowledge hidden within F(111111111111222333) had the power to unlock secrets, reveal undiscovered truths, and reshape the very fabric of their number-centric universe.\n\nWith a sparkle in her eyes, Ava embarked on a remarkable journey. Armed with her passion for numbers and an unyielding determination, she set out to unravel the enigma of F(111111111111222333). Along the way, she would encounter unexpected challenges, face daunting puzzles, and uncover the true extent of her own abilities.\n\nThe adventure beckoned to Ava, inviting her to dive even deeper into the realm of 123-numbers. The question whispered in her mind as she ventured forth: What was F(111111111111222333)?\n\nAnd now, dear reader, the question is passed on to you. Can you solve this cryptic puzzle? Can you uncover the elusive F(111111111111222333)? And if so, how will the world of Numeria change with the unraveling of this mathematical mystery?"}, {"id": 721, "euler_id": 721, "title": "High powers of irrational numbers", "problem": "\nGiven is the function f(a,n)=\u230a(\u2308a\u2309+a)n\u230b.\n\u230a.\u230b denotes the floor function and \u2308.\u2309 denotes the ceiling function.\nf(5,2)=27 and f(5,5)=3935.\n\n\nG(n)=\u2211a=1nf(a,a2).\nG(1000)\u00a0mod\u00a0999999937=163861845.\nFind G(5000000). Give your answer modulo 999999937.\n", "solution": "700792959", "difficulty": 30, "story": "Emily was a young girl with a passion for adventure and a curious mind. She loved exploring the woods near her home, always seeking to unravel the mysteries hidden within. One sunny afternoon, as she ventured deeper into the forest, she stumbled upon an old oak tree with a curious inscription carved into its trunk.\n\nIntrigued, Emily leaned closer to read the words etched into the bark, \"Solve my riddle to unlock nature's secret.\" Below the inscription, a series of perplexing symbols followed:\n\nf(a,n) = \u230a (\u2308a\u2309 + a)n \u230b\n\nConfused yet intrigued, Emily pondered over the enigmatic message. She knew that \u230a.\u230b signified the floor function and \u2308.\u2309 represented the ceiling function. The riddle seemed to demand a numerical solution, but to what end?\n\nAs she contemplated, Emily's eyes wandered to the twigs and leaves littered at the foot of the old oak tree. Barely visible, she spotted an almost invisible trail of footsteps leading deeper into the forest. Driven by her love for adventure, Emily decided to follow the trail.\n\nAfter trekking through the dense forest for hours, Emily arrived at a hidden clearing bathed in golden sunlight. In the center stood a majestic statue, tall and imposing. Across its stone pedestal, another inscription caught Emily's attention.\n\n\"G(n) = \u2211a=1n f(a, a^2)\n\nG(1000) mod 999999937 = 163861845\n\nFind G(5000000). Give your answer modulo 999999937.\"\n\nEmily's mind buzzed with excitement and a rush of anticipation. What could this all mean? The mathematical problem now seemed intertwined with her adventure, guiding her steps deeper into the forest. But why?\n\nAs she pondered, a gentle breeze whispered through the trees, urging Emily onward. She continued her exploration, determined to unravel the mystery behind the statues and their cryptic messages.\n\nDays turned into weeks, as Emily searched high and low, delving into books and studying complex mathematical concepts. She understood that the function f(a,n) demanded careful calculation, that G(n) required her to sum up the values of f() over a range of a. But what did it all signify?\n\nThen, one fateful afternoon, as Emily trekked deeper into the forest, her eyes widened with awe. She stumbled upon a hidden grove, filled with countless statues just like the one she had discovered earlier. They stood tall and proud, each bearing a unique inscription and a mathematical problem waiting to be solved.\n\nThe realization hit Emily like a lightning bolt\u2014the forest was a gateway to ancient knowledge. The statues held secrets, and solving their mathematical problems offered glimpses into the mysteries of nature.\n\nBut as she stood among those age-old sculptures, Emily couldn't shake the lingering question: What would finding the answer to G(5000000) modulo 999999937 reveal? Was it a thread connected to untold wonders waiting to be unraveled? Or was it the key to unlocking something far greater than she could ever fathom?\n\nDetermined and filled with a thirst for knowledge, Emily turned to face the forest, her eyes shining with a newfound purpose. And so, dear reader, I ask you this: What is the answer to G(5000000) modulo 999999937? Will you be the one to uncover nature's secret and join Emily on her extraordinary journey?"}, {"id": 724, "euler_id": 724, "title": "Drone Delivery", "problem": "A depot uses n drones to disperse packages containing essential supplies along a long straight road.\nInitially all drones are stationary, loaded with a supply package.\nEvery second, the depot selects a drone at random and sends it this instruction:\nIf you are stationary, start moving at one centimetre per second along the road.\nIf you are moving, increase your speed by one centimetre per second along the road without changing direction.\nThe road is wide enough that drones can overtake one another without risk of collision.\nEventually, there will only be one drone left at the depot waiting to receive its first instruction. As soon as that drone has flown one centimetre along the road, all drones drop their packages and return to the depot.\nLet E(n) be the expected distance in centimetres from the depot that the supply packages land.\nFor example, E(2)=72, E(5)=12019720, and E(100)\u22481427.193470.\nFind E(108). Give your answer rounded to the nearest integer.", "solution": "18128250110", "difficulty": 30, "story": "Once upon a time, in a small countryside town, there existed a small depot that played a vital role in supplying essential goods to the community. This depot was unlike any other, as it utilized a fleet of drones to disperse packages containing supplies along a long, straight road that connected all the neighboring towns.\n\nAt the heart of the depot, there was a young and enthusiastic mathematician named Alice. She had always admired the elegance and precision of mathematics, and as fate would have it, her passion for numbers soon became crucial to the smooth functioning of the depot.\n\nAlice spent countless hours pondering the best way to deploy the drones efficiently. She knew that their movements could be defined by a mathematical problem, which seemed quite intriguing to her. The problem stated that the depot initially loaded all the drones with supply packages and kept them stationary. Then, every second, the depot would randomly select a drone and send it an instruction, either to start moving at a speed of one centimeter per second or to increase its speed by one centimeter per second while maintaining its direction.\n\nWith this problem in mind, Alice had to determine the expected distance, in centimeters, from the depot that the supply packages would land. It fascinated her how the speed and timing of the drones would influence the final result. As she delved into the depths of the mathematical problem, she felt a sense of purpose and excitement.\n\nIn her pursuit of the solution, Alice observed the drones' behavior. She noticed that they could overtake each other along the wide road without any risk of collision. As each drone surpassed another, its speed increased, propelling it forward with even greater velocity. This phenomenon intrigued Alice even more as it added complexity to her calculations.\n\nDay after day, Alice sat at her desk, studying various mathematical theories and simulations. She spent sleepless nights lost in her calculations, trying to understand the intricate relationship between the drones' movements and the expected distance of the packages' landing. The community relied on her, and with every passing day, her sense of duty grew stronger.\n\nAs weeks turned into months, Alice felt like she was getting closer to unraveling the mysteries of the mathematical problem. She filled countless notebooks with formulas, equations, and complex notations, her determination unwavering.\n\nFinally, after what felt like an eternity, Alice arrived at a breakthrough. She discovered that the expected distance, denoted as E(n), could be found by applying a series of calculations and simulations. Eager to share her findings with her colleagues, Alice prepared a presentation to demonstrate her solution.\n\nAt the weekly depot meeting, Alice stood before the curious eyes of her fellow workers, ready to present her solution to the problem that had consumed her for so long. With enthusiasm and a touch of nervousness, she explained the intricacies of the mathematical problem and shared her methodology.\n\nThe room was filled with a mix of awe and admiration as her colleagues witnessed the elegance of her solution. They realized that Alice had not only unlocked the secret to streamlining the drone operations but had also paved the way for the depot to serve the community even more efficiently.\n\nThe success of Alice's solution was soon evident. The drone deliveries were faster, more accurate, and the packages landed closer to their intended destinations. The townspeople marveled at these advanced operations and admired the collaboration between technology and mathematics.\n\nHowever, amidst the joy and celebration, Alice couldn't help but wonder about the possibilities. She now faced a more significant challenge: finding E(108), the expected distance from the depot that the package would land with 108 drones. It was an ambitious endeavor, one that she couldn't solve without further exploration and calculation.\n\nAs day turned into night, Alice, determined as ever, continued her quest. She refined her algorithm, tweaked her formulas, and tirelessly simulated different scenarios. The more she worked, the more the mathematical problem fascinated her.\n\nAnd now, dear reader, it is your turn to solve this complex mathematical problem. Can you deduce E(108), the expected distance that the supply packages will land from the depot? As Alice dives deeper into her calculations, she eagerly awaits your answer, knowing that together, you can uncover the solution that has eluded her so far."}, {"id": 737, "euler_id": 737, "title": "Coin Loops", "problem": "\nA game is played with many identical, round coins on a flat table.\n\n\nConsider a line perpendicular to the table.\nThe first coin is placed on the table touching the line.\nThen, one by one, the coins are placed horizontally on top of the previous coin and touching the line.\nThe complete stack of coins must be balanced after every placement.\n\n\nThe diagram below [not to scale] shows a possible placement of 8 coins where point P represents the line.\n\n\n\n\nIt is found that a minimum of 31 coins are needed to form a coin loop around the line, i.e. if in the projection of the coins on the table the centre of the nth coin is rotated \u03b8n, about the line, from the centre of the (n\u22121)th coin then the sum of \u2211k=2n\u03b8k is first larger than 360\u2218 when n=31. In general, to loop k times, n is the smallest number for which the sum is greater than 360\u2218k.\n\n\nAlso, 154 coins are needed to loop two times around the line, and 6947 coins to loop ten times.\n\n\nCalculate the number of coins needed to loop 2020 times around the line.\n", "solution": "757794899", "difficulty": 30, "story": "Once upon a time in a small village, there lived a mathematician named Leo. He was a curious individual with a love for numbers and patterns. Leo was always on the lookout for unique mathematical phenomena in everyday life. One day, as he strolled through the village square, he noticed a group of children playing a peculiar game.\n\nThe game involved stacking round coins on a flat table, ensuring that the stack remained perfectly balanced after each placement. Leo's mathematical instincts kicked in, and he couldn't help but observe the children attentively.\n\nConsider a line perpendicular to the table, Leo remembered reading about a similar scenario in a mathematical problem. As the children placed the coins horizontally on top of each other, maintaining balance all the while, Leo marveled at their precision and dedication.\n\nIntrigued, Leo decided to join the game the following day. He implored the children to teach him the rules and their techniques. They happily obliged, excited to have the esteemed mathematician participate.\n\nAs the coins kept piling up, Leo's mind started to wander towards the mathematical problem he had read about. He recalled the diagram illustrating the need for a minimum of 31 coins to form a loop around the line. The sum of rotational angles had to exceed 360 degrees to complete the loop. This sparked his interest further, and he wondered how many coins would be needed to loop a certain number of times.\n\nLeo decided to test his findings by meticulously stacking more coins than the children had ever seen. With each careful placement, he calculated the rotational angle in his mind, following the patterns he had observed earlier. \n\nTo his amazement, his calculations were accurate. It took 154 coins to loop the line twice, and even more astonishingly, 6947 coins to loop it ten times. The children were astounded by Leo's mathematical prowess and the secrets he had unlocked about their beloved game.\n\nThe village soon buzzed with excitement about Leo's amazing feat. People flocked to watch the mathematician in action. Some cheered him on, while others marveled silently at the beauty of mathematics manifesting in such a simple game.\n\nAnd now, dear reader, the question remains: How many coins are needed to loop the line 2020 times? As Leo continues his mathematical journey, he poses this challenge for you to solve. Can you decipher the pattern and unlock this mathematical mystery?\n\nThe answer awaits, hidden within the intricacies of numbers and geometrical precision. Take a moment to ponder, for within this challenge lies the essence of mathematics, waiting to be unravelled."}, {"id": 756, "euler_id": 756, "title": "Approximating a Sum", "problem": "Consider a function f(k) defined for all positive integers k>0. Let S be the sum of the first n values of f. That is,\nS=f(1)+f(2)+f(3)+\u22ef+f(n)=\u2211k=1nf(k)\nIn this problem, we employ randomness to approximate this sum. That is, we choose a random, uniformly distributed, m-tuple of positive integers (X1,X2,X3,\u22ef,Xm) such that 0=X0<X1<X2<\u22ef<Xm\u2264n and calculate a modified sum S\u2217 as follows.\n\nS\u2217=\u2211i=1mf(Xi)(Xi\u2212Xi\u22121)\nWe now define the error of this approximation to be \u0394=S\u2212S\u2217.\nLet E(\u0394|f(k),n,m) be the expected value of the error given the function f(k), the number of terms n in the sum and the length of random sample m.\nFor example, E(\u0394|k,100,50)=2525/1326\u22481.904223 and E(\u0394|\u03c6(k),104,102)\u22485842.849907, where \u03c6(k) is Euler's totient function.\nFind E(\u0394|\u03c6(k),12345678,12345) rounded to six places after the decimal point.", "solution": "607238.610661", "difficulty": 30, "story": "Once upon a time, in the mystical land of Numeria, there lived a wise old wizard named Magnus. Magnus was renowned for his extraordinary ability to unravel the secrets of the universe using mathematics. His wisdom was sought by kings and sorcerers alike, and tales of his enchanting powers filled the air.\n\nOne sunny morning, as the birds chirped and the flowers bloomed, a young wanderer by the name of Ava arrived at the doorstep of Magnus' humble abode. With a glimmer of hope in her eyes, she sought the wizard's guidance.\n\n\"Great Magnus,\" she said, bowing respectfully, \"I am on a quest to unlock the hidden powers of the universe. I am told that this lies in the realm of mathematics. Will you teach me?\"\n\nMagnus peered at Ava with his wise, twinkling eyes and smiled knowingly. \"Dear Ava, the secrets you seek are not easily unraveled. They require the delicate balance between numbers and intuition, logic and creativity. But fear not, for I am here to guide you on your journey.\"\n\nIntrigued, Ava sat cross-legged on the floor, ready to absorb every magical word that would pour forth from Magnus' lips.\n\n\"Consider a function,\" Magnus began, a sparkle in his eyes, \"f(k). This function holds within it the power to shape the universe, but only if we understand its true nature. It is defined for all positive integers k>0. Let S be the sum of the first n values of f. That is, S=f(1)+f(2)+f(3)+\u22ef+f(n)=\u2211k=1nf(k).\"\n\nAs Magnus delved deeper into the mathematical problem, he explained to Ava how they could employ randomness to approximate this sum, using a random, uniformly distributed, m-tuple of positive integers (X1, X2, X3, \u22ef, Xm). Each of these numbers would be greater than the previous, ensuring a sense of order in the chaos.\n\nAva's mind whirled with the possibilities. The intersection of mathematics and randomness fascinated her. She saw the infinite potential, the ability to harness the power of the unknown.\n\nMagnus continued, \"We shall calculate a modified sum, S\u2217, which incorporates the random tuples we have chosen. S\u2217=\u2211i=1mf(Xi)(Xi\u2212Xi\u22121). This modified sum helps us gauge the accuracy of our approximation, for we define the error of this approximation to be \u0394=S\u2212S\u2217.\"\n\nIntrigued by the concept, Ava pondered how this mathematical problem could be pivotal to her own quest. She imagined harnessing the power of randomness, using it as a tool to uncover the hidden mysteries of the universe.\n\nMagnus looked at Ava, his kind eyes filled with anticipation. \"Now my dear, I present you with a challenge. Can you find E(\u0394|\u03c6(k),12345678,12345), rounded to six places after the decimal point? In this case, \u03c6(k) represents Euler's totient function, a force of nature in its own right.\"\n\nAva's heart raced with excitement. The wizard's challenge resonated deep within her soul. She realized that this mathematical problem held the key to unlocking the hidden powers of the universe, to revealing the secrets that lay hidden within the vast expanse of Numeria.\n\nAs she embarked on her journey, Ava knew she had to apply her newfound knowledge and unravel the complexity of \u03c6(k). But what answers would she find? Could she discover the true nature of E(\u0394|\u03c6(k),12345678,12345)? Would her quest lead her to the ultimate revelation of the universe's intricate design?\n\nAnd so, dear reader, I leave you with this question: Can you solve the riddle that now rests in Ava's hands? Can you find E(\u0394|\u03c6(k),12345678,12345), rounded to six places after the decimal point?"}, {"id": 770, "euler_id": 770, "title": "Delphi Flip", "problem": "\nA and B play a game. A has originally 1 gram of gold and B has an unlimited amount.\nEach round goes as follows:\n\n\n\nA chooses and displays, x, a nonnegative real number no larger than the amount of gold that A has.\n\nEither B chooses to TAKE. Then A gives B x grams of gold.\n\nOr B chooses to GIVE. Then B gives A x grams of gold.\n\n\nB TAKEs n times and GIVEs n times after which the game finishes.\n\nDefine g(X) to be the smallest value of n so that A can guarantee to have at least X grams of gold at the end of the game. You are given g(1.7)=10.\n\n\nFind g(1.9999).\n", "solution": "127311223", "difficulty": 30, "story": "Once upon a time in a mysterious land, there lived two friends named Alice and Bob. They enjoyed spending their days engaged in fun and challenging activities, but it was their love for games that truly brought them the most joy.\n\nOne sunny day, Alice came across an ancient scroll in the depths of a hidden library. The scroll contained instructions for a unique game that piqued her curiosity. She rushed to share the discovery with Bob, and together they embarked on a thrilling adventure.\n\nThe game required Alice and Bob to play rounds, each round involving a strategic decision. It was simple yet unpredictable, leaving them excited to uncover the secrets it held. A started with 1 gram of gold, while Bob had an infinite supply at his disposal.\n\nIn each round, Alice would choose a nonnegative real number, no more significant than the amount of gold she possessed. Then, Bob would decide to either take the gold Alice displayed or give her the same amount, depending on his strategy.\n\nTheir game continued with a pattern of action and reaction. Bob took gold from Alice for n rounds and then gave it back for another n rounds. This cycle repeated until the game reached its conclusion.\n\nThe question that intrigued them the most was defining the smallest number, 'g(X)', that ensured Alice would possess at least X grams of gold by the game's end. It intrigued them to calculate and analyze the optimal strategy for Alice to achieve the desired outcome. \n\nAs they delved deeper into the calculations, they discovered a vital equation: g(1.7) equaled 10. This revelation encouraged Alice and Bob to push their limits further and explore the possibilities within the game.\n\nTheir adventure continued, intertwining the mathematical problem with their every move. At each milestone, the concept of g(X) played a pivotal role in shaping their strategies and determining their next steps.\n\nDespite facing numerous challenges and setbacks along the way, Alice and Bob never lost hope. They were determined to find an answer to their burning question.\n\nNow, dear reader, it is your turn to embrace this intriguing mathematical puzzle. Can you shed light on the mystery that lies concealed within the game? What is the value of g(1.9999), the smallest number of rounds necessary for Alice to secure at least 1.9999 grams of gold?\n\nAs Alice and Bob await your answer, remember that their fate depends on your mathematical prowess. Can you solve the puzzle and uncover the secret hidden within the game?"}, {"id": 778, "euler_id": 778, "title": "Freshman's Product", "problem": "\nIf a,b are two nonnegative integers with decimal representations a=(\u2026a2a1a0) and b=(\u2026b2b1b0) respectively, then the freshman's product of a and b, denoted a\u22a0b, is the integer c with decimal representation c=(\u2026c2c1c0) such that ci is the last digit of ai\u22c5bi.\nFor example, 234\u22a0765=480.\n\n\nLet F(R,M) be the sum of x1\u22a0\u22ef\u22a0xR for all sequences of integers (x1,\u2026,xR) with 0\u2264xi\u2264M.\nFor example, F(2,7)=204, and F(23,76)\u22615870548(mod1000000009).\n\n\nFind F(234567,765432), give your answer modulo 1000000009\n", "solution": "146133880", "difficulty": 30, "story": "Once upon a time, in the small town of Mathematica, lived a young boy named Leo. Leo was a curious and intelligent kid who had a knack for solving puzzles and riddles. He loved spending his time with numbers, exploring their patterns and unraveling their secrets. But little did he know that one day, his passion for mathematics would lead him on a thrilling adventure.\n\nOne sunny morning, as Leo was exploring the attic of his grandfather's house, he stumbled upon a dusty old book. The book had a peculiar title, \"The Mysteries of Mathland,\" and it caught Leo's attention instantly. He carefully blew away the dust and started flipping through its pages, expecting to find intriguing puzzles and mind-bending equations.\n\nAs he turned the pages, Leo's eyes widened with excitement when he came across a chapter titled \"The Freshman's Product.\" Intrigued, he read about the concept of a\u22a0b and how it represented the last digit of the product of two nonnegative integers a and b. The book went on to describe how this concept formed the basis of a mathematical problem known as F(R,M).\n\nLeo was amazed by this newfound information. He began pondering over how the freshman's product could be used to solve complex mathematical equations. His mind raced with possibilities, and he felt an urge to apply this knowledge to a real-life scenario.\n\nDays turned into weeks, and Leo dedicated himself to understanding the intricacies of F(R,M). He spent countless hours scribbling formulas and experimenting with different sequences of integers. His determination grew stronger with each passing day as the answer to F(234567,765432) eluded him.\n\nOne fateful evening, Leo's parents received an unexpected invitation to visit Mathland, a realm where mathematics reigned supreme. The invitation, sealed with a golden insignia, claimed that Mathland was in desperate need of someone capable of solving a critical problem.\n\nLeo's parents, aware of their son's talent and love for math, decided to take him along. They embarked on an exhilarating journey, crossing vast, mystical landscapes until they arrived in the heart of Mathland.\n\nUpon their welcome to Mathland, Leo learned that the problem threatening the realm was none other than F(234567,765432). The situation was dire, as countless lives and the very existence of Mathland hung in the balance.\n\nFilled with a mix of excitement and nervousness, Leo immersed himself in Mathland's enchanting atmosphere. He met fellow mathematicians and consulted ancient tomes to gather insights that could help him solve the puzzle. As the days passed, Leo's understanding of F(R,M) deepened, and so did his determination to find the answer.\n\nBut it wasn't until one chilly evening, while gazing at the starry sky, that Leo had an epiphany. He remembered a pattern he had noticed during his research - a pattern that connected the freshman's product to the concept of remainders and modulo arithmetic.\n\nExcitedly, Leo retraced his steps and started applying this newfound understanding to the problem at hand. The answers started to fall into place, one after another, as he skillfully calculated F(234567,765432) modulo 1000000009. Leo's heart raced as he realized the significance of the number he had obtained. Mathland's destiny now rested on his answer.\n\nAnd now, dear reader, the question falls to you. Can you solve F(234567,765432) modulo 1000000009? Will your mathematical prowess be enough to save Mathland from its impending doom?"}, {"id": 784, "euler_id": 784, "title": "Reciprocal Pairs", "problem": "\nLet's call a pair of positive integers p, q (p<q) reciprocal, if there is a positive integer r<p such that r equals both the inverse of p modulo q and the inverse of q modulo p.\n\nFor example, (3,5) is one reciprocal pair for r=2.\nLet F(N) be the total sum of p+q for all reciprocal pairs (p,q) where p\u2264N.\n\nF(5)=59 due to these four reciprocal pairs (3,5), (4,11), (5,7) and (5,19).\nYou are also given F(102)=697317.\n\nFind F(2\u22c5106).", "solution": "5833303012576429231", "difficulty": 30, "story": "Once upon a time in the magical kingdom of Numeria, there lived a talented young math enthusiast named Liam. Liam spent his days studying complex equations and solving mind-boggling puzzles, always yearning for new mathematical challenges.\n\nOne sunny afternoon, as Liam sat under the shade of an ancient oak tree, a flash of inspiration struck him. He remembered a peculiar mathematical problem he had recently come across: the concept of reciprocal pairs. The idea fascinated him, and he wondered if he could use it to unlock the secrets of Numeria's enchanting world.\n\nEager to put his newfound curiosity to the test, Liam embarked on a grand adventure. He journeyed across mountains and valleys, consulting wise old sages and delving into ancient scrolls to uncover the mysteries of reciprocal pairs. Along the way, he encountered numerous mathematical conundrums, each one fueling his determination.\n\nFinally, after months of relentless searching, Liam stumbled upon a hidden library deep within Numeria's dense forests. It was said that this secret repository held the key to ancient mathematical knowledge, and Liam's heart soared with anticipation.\n\nInside the library, he discovered a dusty book called \"The Saga of Reciprocal Pairs.\" With trembling hands, he carefully flipped through its pages, amazed by the wealth of information it contained. The book seemed to breathe with the mathematical marvels of ages past.\n\nLiam's eyes widened as he read about the importance of reciprocal pairs. Countless examples danced before his eyes, showing the elegant interplay between numbers and their reciprocals. He marveled at the beauty and complexity of the mathematical relationships revealed.\n\nWith newfound determination, Liam began exploring the concept of reciprocal pairs in Numeria's everyday life. He analyzed the patterns of the kingdom's population, the relationships between magic spells, and even the intricacies of enchanted artifacts. Everywhere he looked, he discovered the subtle presence of reciprocal pairs.\n\nAs months turned into years, Liam became a renowned mathematician, respected for his wisdom and insight into the mysteries of numbers. Numeria flourished under his guidance, and the kingdom reveled in the magic of reciprocal pairs.\n\nYet, despite all his achievements, Liam couldn't shake the burning question that had ignited his passion so long ago. The elusive solution to F(2\u22c5106) weighed heavily on his mind.\n\nLate one evening, as Liam stood gazing at the starry sky, he whispered to the nighttime heavens, \"Oh, magical universe, I have journeyed far and wide, unlocking the wonders of reciprocal pairs. But this final riddle eludes me still. Tell me, I beseech you, what is F(2\u22c5106)?\"\n\nAnd so, dear reader, as Liam's question lingered in the air, I leave you with one final query: Can you solve the mathematical problem that captivated a mighty mathematician's heart and mind?"}, {"id": 795, "euler_id": 795, "title": "Alternating GCD Sum", "problem": "\nFor a positive integer n, the function g(n) is defined as\n\ng(n)=\u2211i=1n(\u22121)igcd(n,i2)\n\nFor example, g(4)=\u2212gcd(4,12)+gcd(4,22)\u2212gcd(4,32)+gcd(4,42)=\u22121+4\u22121+4=6.\nYou are also given g(1234)=1233.\n\n\nLet G(N)=\u2211n=1Ng(n). You are given G(1234)=2194708.\n\n\nFind G(12345678).\n", "solution": "955892601606483", "difficulty": 30, "story": "Once upon a time, in the faraway kingdom of Mathlandia, there lived a young and curious mathematician named Lily. Fascinated by numbers from an early age, Lily had a knack for solving complex mathematical problems. She spent her days exploring the vast kingdoms of algebra and calculus, always on the lookout for new puzzles to solve.\n\nOne sunny day, as she was strolling through the royal gardens, Lily stumbled upon an ancient scroll buried beneath a bed of blooming roses. Intrigued, she unrolled the scroll to find a mathematical problem that fascinated her. It was none other than the function g(n) and its sum, G(N), just like the one she had studied recently.\n\nThe scroll spoke of the incredible powers that the function g(n) held over the kingdom. It was believed that the person who could solve g(n) would possess the ability to change the fabric of reality itself. Lured by the promises of this newfound knowledge, Lily decided to dedicate herself to unlocking the mysteries hidden within the scroll.\n\nDays turned into weeks, and weeks turned into months as Lily tirelessly delved into the problem. She calculated the function g(n) repeatedly, never losing hope that an answer would unfold before her eyes. With each computation, Lily could feel herself growing closer to unraveling the secret held within the numbers.\n\nOne fateful night, as the moon bathed the kingdom in a silvery glow, Lily finally cracked the code. She was exhilarated to find that the value of G(12345678) was an astonishingly large number. The sum total of g(n) for all the numbers leading up to 12,345,678 was a staggering G(12345678)=2194708.\n\nLily's mind raced with excitement, realizing that she held the key to immense power. Should she share her discovery with the world? Or would it be best kept a secret, for fear that the wrong person might misuse it? As the weight of her revelation pressed down upon her, Lily knew that she needed time to ponder her next move.\n\nAnd so, dear reader, I pose the question to you. Can you find G(12345678) as Lily did? Can you unlock the secrets hidden within the numbers? Take a moment to reflect and, when you are ready, embrace the challenge that awaits. What is the value of G(12345678)?\n\nThe answer holds the power to shape destinies, but remember, with great power comes great responsibility. Use it wisely."}]