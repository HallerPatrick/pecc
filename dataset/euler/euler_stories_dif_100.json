[{"id": 331, "euler_id": 331, "title": "Cross flips", "problem": "N\u00d7N disks are placed on a square game board. Each disk has a black side and white side.\nAt each turn, you may choose a disk and flip all the disks in the same row and the same column as this disk: thus 2\u00d7N-1 disks are flipped. The game ends when all disks show their white side. The following example shows a game on a 5\u00d75 board.\n\nIt can be proven that 3 is the minimal number of turns to finish this game.\nThe bottom left disk on the N\u00d7N board has coordinates (0,0);\nthe bottom right disk has coordinates (N-1,0) and the top left disk has coordinates (0,N-1). \nLet CN be the following configuration of a board with N\u00d7N disks:\nA disk at (x,y) satisfying N\u22121\u2264x2+y2<N, shows its black side; otherwise, it shows its white side. C5 is shown above.\nLet T(N) be the minimal number of turns to finish a game starting from configuration CN or 0 if configuration CN is unsolvable.\nWe have shown that T(5)=3. You are also given that T(10)=29 and T(1 000)=395253.\nFind \u2211i=331T(2i\u2212i).", "solution": "467178235146843549", "difficulty": 100, "story": "Once upon a time in the quiet town of Numerville, there lived a young girl named Lila. Lila was known for her exceptional intelligence and problem-solving skills. She loved to explore the mysteries of the world, especially those involving numbers.\n\nOne sunny afternoon, Lila's grandmother invited her over for a special treat. As Lila entered her grandmother's cozy cottage, she noticed an intriguing old game board placed on the table. With her eyes full of curiosity, she asked her grandmother about it.\n\n\"Oh, my dear Lila,\" her grandmother smiled warmly. \"This game board holds a fascinating mathematical puzzle. It involves N\u00d7N disks, each with a black and white side. The goal is to flip the disks until all of them show their white side.\"\n\nLila's eyes sparkled with excitement. She could already sense the possibilities for challenging her mathematical prowess. Her grandmother continued, \"The interesting part is, at each turn, you can select a disk and flip all the disks in the same row and column as it. But here's the catch: you must complete the game in the minimum number of turns possible.\"\n\nLila's mind started racing as she imagined the intricate patterns and calculations required to solve this puzzle. She knew that at every stage, her choices would determine the outcome and determine how quickly all the disks would show their white side.\n\nDays turned into weeks, and Lila immersed herself in the mathematical mysteries of the game board. She discovered a pattern in the positions of the black and white disks. Her grandmother had taught her that the disks at (x, y), satisfying N\u22121\u2264x^2+y^2<N, would display their black side.\n\nWith the newfound knowledge of this configuration, Lila tirelessly analyzed the possibilities, testing the limits of her understanding. Each new game board, each new configuration, fuelled her determination to find the solution.\n\nAs Lila progressed, her excitement grew. Her calculations were becoming more complex, but she was confident in her ability to find the shortest path to victory. She required only 3 turns to complete the game on the 5\u00d75 board, which boosted her confidence even more.\n\nOne day, while pouring over the 10\u00d710 board, Lila finally cracked the code. She discovered that it would take precisely 29 turns to finish the game. She celebrated this accomplishment, knowing that her hard work had paid off.\n\nBut Lila wasn't content with just one victory. She had her sights set on a greater challenge. Determined as ever, she decided to take on the monumental task of solving the game on a 1,000\u00d71,000 board.\n\nMonths passed, and Lila's relentless pursuit continued. Her calculations had become her closest companions. Finally, the day arrived when she completed the game on the massive 1,000\u00d71,000 board, achieving the remarkable feat in 395253 turns.\n\nAs Lila sat enthralled by her achievement, a question formed in her mind. In all her efforts, she had unlocked the secrets of T(N) for various values of N. But there was one final query that remained unanswered.\n\nShe pondered, \"What could be the sum of T(2i\u2212i) when i is equal to or greater than 331?\" The answer held an elusive charm, one that Lila yearned to uncover.\n\nAnd so, with her head filled with numbers and equations, Lila embarked on her next journey, eagerly seeking the sum that would reveal the hidden depths of the game board puzzle. A question hung in the air, daring her, and the reader, to solve the mathematical problem that held the promise of an enigmatic resolution."}, {"id": 344, "euler_id": 344, "title": "Silver dollar game", "problem": "One variant of N.G. de Bruijn's silver dollar game can be described as follows:\nOn a strip of squares a number of coins are placed, at most one coin per square. Only one coin, called the silver dollar, has any value. Two players take turns making moves. At each turn a player must make either a regular or a special move.\nA regular move consists of selecting one coin and moving it one or more squares to the left. The coin cannot move out of the strip or jump on or over another coin.\nAlternatively, the player can choose to make the special move of pocketing the leftmost coin rather than making a regular move. If no regular moves are possible, the player is forced to pocket the leftmost coin.\nThe winner is the player who pockets the silver dollar.\n\n\nA winning configuration is an arrangement of coins on the strip where the first player can force a win no matter what the second player does.\nLet W(n,c) be the number of winning configurations for a strip of n squares, c worthless coins and one silver dollar.\nYou are given that W(10,2) = 324 and W(100,10) = 1514704946113500.\nFind W(1 000 000, 100) modulo the semiprime 1000 036 000 099 (= 1 000 003 \u00b7 1 000 033).\n", "solution": "65579304332", "difficulty": 100, "story": "Once upon a time, in the magical land of Numeria, there were two best friends named Alice and Bob. They were known throughout the kingdom for their love of games and puzzles. One day, they stumbled upon a mysterious old man who claimed to have a game that would challenge their wits like never before.\n\nThe old man beckoned them closer and revealed a long strip of squares, each containing a coin. \"This,\" he said with a twinkle in his eye, \"is the silver dollar game, created by the legendary mathematician N.G. de Bruijn.\"\n\nAlice and Bob gasped in awe, their curiosity piqued. The old man continued, \"In this game, you must navigate through the strip of coins and find the silver dollar. But beware, for only one coin holds any value. You must make moves, either regular or special, to reach the silver dollar.\"\n\nThe friends eagerly agreed to play the game, excited for the challenge that lay ahead. They took turns, carefully selecting coins and moving them to the left, following the rules set by the old man. As they played, they realized it was a game of strategy and cunning.\n\nAfter many intense rounds, Alice and Bob found themselves deeply engrossed in the game. They couldn't help but wonder if there was a secret to winning every time.\n\n\"Is there a way to guarantee a win in this game?\" Alice asked the old man, her eyes filled with determination.\n\nThe old man nodded, a spark of admiration in his eyes. \"Indeed, my dear Alice,\" he began, \"a winning configuration is possible, where the first player can force a win no matter what the second player does.\"\n\nAlice and Bob exchanged glances, realizing that there was a mathematical challenge within the game. They wanted to uncover the secret behind the winning configurations.\n\nWith renewed vigor, they continued to play, experimenting with different strategies and observing the outcomes. They discovered that the number of winning configurations depended on the number of squares and coins on the strip. The old man confirmed their findings, sharing some examples.\n\n\"W(10,2) equals 324 winning configurations,\" he stated, \"while W(100,10) equals a staggering 1,514,704,946,113,500.\"\n\nAlice and Bob couldn't believe their ears. The complexity of the game multiplied with the increase in squares and coins. But they were undeterred. They knew they had to solve the ultimate challenge presented to them.\n\nDays turned into nights, and the friends tirelessly explored different strategies and combinations of coins. They delved deep into the world of numerical possibilities, seeking to crack the code hidden within the silver dollar game.\n\nNight after night, they analyzed the game, recording their findings meticulously. They wanted to solve the puzzle the old man had introduced them to. But as they journeyed deeper into the game's intricate nature, one question remained unanswered.\n\n\"What is W(1,000,000, 100)? And how can we calculate it modulo the semiprime 1,000,036,000,099?\" Bob asked, his voice filled with determination.\n\nAlice glanced at him, a smile tugging at the corners of her lips. \"Indeed, my dear Bob,\" she replied, \"that is the question that will lead us to the heart of this mathematical challenge. Let us devote ourselves even further and find the answer to this intricate puzzle.\"\n\nAnd so, Alice and Bob continued their quest, embarking on a journey to solve the enigma of the silver dollar game. Will they crack the code and find the elusive W(1,000,000, 100)? Only time will tell.\n\nCan you solve the mathematical problem at the heart of Alice and Bob's quest and find W(1,000,000, 100) modulo the semiprime 1,000,036,000,099? The answer lies within the depths of the silver dollar game."}, {"id": 415, "euler_id": 415, "title": "Titanic sets", "problem": "A set of lattice points S is called a titanic set if there exists a line passing through exactly two points in S.\nAn example of a titanic set is S = {(0, 0), (0, 1), (0, 2), (1, 1), (2, 0), (1, 0)}, where the line passing through (0, 1) and (2, 0) does not pass through any other point in S.\nOn the other hand, the set {(0, 0), (1, 1), (2, 2), (4, 4)} is not a titanic set since the line passing through any two points in the set also passes through the other two.\nFor any positive integer N, let T(N) be the number of titanic sets S whose every point (x, y) satisfies 0 \u2264 x, y \u2264 N.\nIt can be verified that T(1) = 11, T(2) = 494, T(4) = 33554178, T(111) mod 108 = 13500401 and T(105)\u00a0mod\u00a0108 = 63259062.\nFind T(1011)\u00a0mod\u00a0108.", "solution": "55859742", "difficulty": 100, "story": "Once upon a time, in a small village by the sea, there lived a young boy named Oliver. Oliver was known for his inquisitive nature and love for numbers. He spent most of his days exploring the beautiful landscapes that surrounded his village, searching for patterns and solving mathematical puzzles.\n\nOne sunny morning, as Oliver ventured deep into the thick forest nearby, he stumbled upon an ancient scroll hidden beneath a pile of colorful leaves. His curiosity peaked, he carefully unrolled the delicate parchment and discovered a mathematical problem that intrigued him.\n\nThe scroll spoke of titanic sets, a unique arrangement of lattice points where a line passed through exactly two points, excluding all others. Oliver's eyes widened with excitement as he read further, realizing the importance of this problem. The scroll revealed the number of such titanic sets for various values of N, but it posed the ultimate challenge - find T(1011) mod 108.\n\nUnable to resist the allure of the problem, Oliver began searching for titanic sets in the real world, hoping they might hold the key to the answer. Armed with a notebook and a compass, he traversed the landscape, meticulously plotting points and connecting them to form potential lines.\n\nDays turned into weeks, and weeks into months, but Oliver's determination did not falter. He poured over countless calculations, drawing lines from one point to another, excited by every new titanic set he discovered. Through his exploration, he encountered countless fascinating stories hidden within the patterns of the numbers.\n\nOn one occasion, Oliver stumbled upon a magnificent waterfall cascading down the mountainside. The rushing water created a symphony of sound that echoed throughout the valley. Inspired by the beauty around him, Oliver marveled at the infinite possibilities hidden within the problem.\n\nAs he continued his journey, Oliver's mind expanded with every new discovery. He realized that this mathematical problem was more than just numbers; it was a gateway into a realm where imagination and precision merged. It was like unraveling the secrets of the universe, one titanic set at a time.\n\nOliver's quest eventually led him back to his village, where he shared his findings with the villagers. Together, they embarked on a mission to uncover the magic that lay within the titanic sets. In each discovery, they found not only mathematical beauty but also stories of love, dreams, and triumph.\n\nAnd so, the village became a hub of creativity and knowledge, with people from all walks of life contributing their ideas and exploring the marvels hidden within these sets. The streets were filled with laughter, as young and old alike gathered in cafes and shared their visions of the infinite patterns of the universe.\n\nNow, as you read this story, I pose a question to you. Can you, like Oliver, unlock the secrets of the titanic sets? Can you find T(1011) mod 108, and delve into the mysteries that lie within?"}, {"id": 439, "euler_id": 439, "title": "Sum of sum of divisors", "problem": "Let d(k) be the sum of all divisors of k.\nWe define the function S(N) = \u2211i=1N\u2211j=1Nd(i\u22c5j).\nFor example, S(3) = d(1) + d(2) + d(3) + d(2) + d(4) + d(6) + d(3) + d(6) + d(9) = 59.\nYou are given that S(103) = 563576517282 and S(105) mod 109 = 215766508.\nFind S(1011) mod 109.", "solution": "968697378", "difficulty": 100, "story": "Once upon a time, in the mystical land of Arithmos, there lived a curious young mathematician named Oliver. Oliver was unlike any other child in Arithmos; he possessed a deep fascination for numbers and patterns. His days were spent immersed in his studies, seeking to uncover the secrets of the universe through the language of mathematics.\n\nOne sunny morning, Oliver stumbled upon an ancient tome hidden in the depths of the royal library. Its worn pages were filled with cryptic symbols and equations that promised untold knowledge. Eagerly, he began deciphering the text, his eyes widening with each revelation.\n\nAs he delved deeper into the tome, Oliver came across a mathematical problem that seemed to possess a certain enchantment. Letting his fingers trace the lines before him, he read aloud, \"Let d(k) be the sum of all divisors of k.\"\n\nCuriosity piqued, Oliver's mind whirred with possibilities. He envisioned numbers dancing before him, their divisors intertwining like partners in a sublime ballet. Each number had a distinct role to play, summing its divisors, which, in turn, created a series of sums within the sums.\n\nDesperate to uncover the truth hidden within the enigma, Oliver pressed on. \"We define the function S(N)...\" he murmured, absorbed by the words before him. The language of mathematics became a symphony, its notes harmoniously blending in his mind.\n\nDays turned into weeks, and weeks turned into months as Oliver tirelessly worked to crack this mathematical riddle. His once youthful face was now marked by lines of determination, and his usually vivacious eyes were now filled with a hint of weariness.\n\nAt long last, a breakthrough came. The pieces of the puzzle fell into place, and Oliver understood the purpose of his endeavor. \"So, S(103) equals 563576517282, and S(105) mod 109 equals 215766508,\" he whispered, the numbers dancing on his tongue like a miraculous incantation.\n\nOliver's heart raced; he knew he was on the cusp of something extraordinary. His thoughts turned to the future, to the limitless potential that awaited him if he could unravel the secrets locked away within the mathematical problem.\n\nBut before he could bask in the glory of his discovery, Oliver's gaze fell upon a final, unanswered question. \"Find S(1011) mod 109,\" he read aloud, his voice trembling with anticipation.\n\nThe young mathematician's journey had just begun. The answer to this final enigma held the key to unlock secrets yet unknown, hidden within the fabric of the universe. The fate of Arithmos rested upon his ability to decipher this ultimate mathematical conundrum.\n\nAnd so, dear reader, I ask you, can you solve this puzzle that has intrigued the brilliant young Oliver? Can you find S(1011) mod 109, and with it, unearth the hidden wonders that await?"}, {"id": 450, "euler_id": 450, "title": "Hypocycloid and Lattice points", "problem": "A hypocycloid is the curve drawn by a point on a small circle rolling inside a larger circle. The parametric equations of a hypocycloid centered at the origin, and starting at the right most point is given by:\nx(t)=(R\u2212r)cos\u2061(t)+rcos\u2061(R\u2212rrt)\ny(t)=(R\u2212r)sin\u2061(t)\u2212rsin\u2061(R\u2212rrt)\nWhere R is the radius of the large circle and r the radius of the small circle.\nLet C(R,r) be the set of distinct points with integer coordinates on the hypocycloid with radius R and r and for which there is a corresponding value of t such that sin\u2061(t) and cos\u2061(t) are rational numbers.\n\nLet S(R,r)=\u2211(x,y)\u2208C(R,r)|x|+|y| be the sum of the absolute values of the x and y coordinates of the points in C(R,r).\nLet T(N)=\u2211R=3N\u2211r=1\u230aR\u221212\u230bS(R,r) be the sum of S(R,r) for R and r positive integers, R\u2264N  and 2r<R.\nYou are given:\nC(3,1)={(3,0),(\u22121,2),(\u22121,0),(\u22121,\u22122)}\nC(2500,1000)={(2500,0),(772,2376),(772,\u22122376),(516,1792),(516,\u22121792),(500,0),(68,504),(68,\u2212504),\n\u00a0(\u22121356,1088),(\u22121356,\u22121088),(\u22121500,1000),(\u22121500,\u22121000)}\nNote: (\u2212625,0) is not an element of C(2500,1000) because sin\u2061(t) is not a rational number for the corresponding values of t.\nS(3,1)=(|3|+|0|)+(|\u22121|+|2|)+(|\u22121|+|0|)+(|\u22121|+|\u22122|)=10\nT(3)=10;T(10)=524;T(100)=580442;T(103)=583108600.\nFind T(106).", "solution": "583333163984220940", "difficulty": 100, "story": "Once upon a time in the quaint town of Mathlandia, there lived a young girl named Lily who had a deep passion for mathematics. Lily had always been fascinated by the mysteries and intricacies of numbers, and she spent most of her free time exploring the mathematical wonders around her. \n\nOne fine day, while perusing through an old mathematics textbook, Lily stumbled upon a peculiar problem involving hypocycloids. She was immediately captivated by the elegant curves formed by the rolling circles, and she couldn't help but ponder the question posed before her.\n\nThe problem described C(R, r), the set of distinct points with integer coordinates on a hypocycloid with radius R and r. It became clear to Lily that such points could only exist when the sine and cosine functions yielded rational numbers. She was intrigued by the sheer possibilities contained within these sets and couldn't resist the urge to explore the sum of the absolute values of the x and y coordinates, denoted by S(R, r).\n\nAs Lily delved further into the problem, she discovered the function T(N), which summed up S(R, r) for various combinations of R and r, satisfying certain conditions. The function allowed her to compute the sum of these absolute values for a defined range of positive integers, and she found herself pondering the implications of T(N).\n\nHer mind began to wander, weaving intricate patterns of numbers and curves in her imagination. Lily imagined a world where mathematical wonders were tangible and real. She envisioned a land filled with hypocycloids, where the rolling circles created magical paths imbued with hidden mathematical secrets.\n\nIn this magical land, every citizen had a distinct point on the hypocycloid, representing their unique place in the mathematical tapestry of the universe. Their coordinates were determined by the values of R and r, intertwined with their individual stories and experiences.\n\nAs Lily explored the land of the hypocycloids, she encountered fascinating characters who embodied the essence of mathematical concepts. There was Piara, a wise old mathematician who had dedicated his life to unraveling the mysteries of circles and curves. Then there was Tess, an outgoing and adventurous girl who reveled in the symmetry and patterns of geometric shapes.\n\nTogether, they embarked on a quest to understand the true significance of T(N). They traveled far and wide, encountering mystical creatures and solving intricate mathematical puzzles along the way. Each solution brought them closer to unraveling the enigma of the sum of absolute values contained within T(N).\n\nIn their adventures, Lily and her companions traversed the most magnificent hypocycloids, marveling at the beauty and complexity of the curves. They discovered that the points on these curves were not merely coordinates but representations of mathematical harmony in the world.\n\nAs the story progressed, they realized that T(N) held the key to unlocking a hidden treasure \u2014 a secret that would unlock the true potential of the magical land of hypocycloids. But what could this secret be? What hidden wonders lay beyond the intricate calculations and sums?\n\nAnd so, as the sun set on their journey, Lily and her friends returned to Mathlandia, their minds filled with wonder and excitement. They wondered, with hearts racing and minds swirling, what could T(106) hold? What hidden treasures would it reveal? Lily turned to her friends, a mischievous sparkle in her eyes, and posed the question that lingered on her lips.\n\n\"Can you solve this mathematical mystery? What could T(106) possibly be?\"\n\nWith that, they embarked on a new adventure that would challenge their knowledge and test the limits of their mathematical prowess. As the story continued, they relied on their intuition, critical thinking, and a deep love for numbers to crack the enigma concealed within T(106).\n\nAnd so, dear reader, the question is now posed to you: Can you solve the mathematical mystery of T(106)? Embark on this mathematical journey, navigate through the hypnotic curves of hypocycloids, and unlock the hidden wonders that lie beyond. The answer awaits you, concealed within the intricate patterns of numbers and curves. Are you ready to accept the challenge?"}, {"id": 459, "euler_id": 459, "title": "Flipping game", "problem": "The flipping game is a two player game played on a N by N square board.\nEach square contains a disk with one side white and one side black.\nThe game starts with all disks showing their white side.\nA turn consists of flipping all disks in a rectangle with the following properties:\nthe upper right corner of the rectangle contains a white disk\nthe rectangle width is a perfect square (1, 4, 9, 16, ...)\nthe rectangle height is a triangular number (1, 3, 6, 10, ...)\n\nPlayers alternate turns. A player wins by turning the grid all black.\nLet W(N) be the number of winning moves for the first player on a N by N board with all disks white, assuming perfect play.\nW(1) = 1, W(2) = 0, W(5) = 8 and W(102) = 31395.\nFor N=5, the first player's eight winning first moves are:\n\nFind W(106).", "solution": "3996390106631", "difficulty": 100, "story": "Once upon a time in a small village, there lived two young siblings named Emma and Ethan. They were known throughout the village for their keen intelligence and their love for puzzles and games. They would spend hours together, challenging each other with various brain teasers and strategy games. \n\nOne day, while rummaging through their grandfather's old books, they stumbled upon a dusty old tome filled with intriguing mathematical problems. As they flipped through the pages, their eyes landed on an interesting game called \"The Flipping Game.\" The siblings were instantly fascinated by the game's rules and decided to give it a try. \n\nThey set up a 5x5 grid on the floor using small square disks. Each disk had a white side and a black side, all initially showing white. Emma and Ethan eagerly took turns, trying to outsmart each other and figure out the optimal moves. After several game sessions, they noticed a pattern \u2013 Emma seemed to win more often, and her winning moves had a distinct pattern. \n\nCuriosity piqued, they started examining the game more closely. They realized that the upper right corner of each winning move's rectangle was always occupied by a white disk. Furthermore, the width of the rectangle was always a perfect square, while the height was always a triangular number. \n\nAs they continued to play, Emma and Ethan quickly learned how to identify the winning moves, given the dimensions of the board. They were thrilled to discover that each board size had a distinct number of winning moves for the first player, assuming perfect play. \n\nWith each passing day, their enthusiasm for the Flipping Game grew. They started to play it with their friends in the village, spreading the joy of the game and the thrill of discovering winning strategies. As the village kids joined in, the game became more popular, with everyone eagerly solving the puzzles and challenging each other.\n\nEmma and Ethan's reputation as the masterminds of the game continued to grow, and one day, an unfamiliar face appeared in their village. It was a mathematician named Dr. Victor, intrigued by the children's knowledge of the Flipping Game. \n\nDr. Victor recognized that the siblings had stumbled upon a mathematical problem hiding within the game. He explained that the winning moves for different board sizes, as Emma and Ethan had been discovering, had a direct correlation with the number of winning moves, denoted as W(N), for the first player. \n\nHe shared some known values, such as W(1) = 1, W(2) = 0, and W(5) = 8. Then, with a twinkle in his eye, Dr. Victor posed the ultimate challenge to the siblings \u2013 \"Can you find W(106), the number of winning moves for a 106x106 board?\"\n\nEmma and Ethan's eyes widened with excitement and determination. They knew that solving such a large-scale mathematical problem would be incredibly difficult, but they were ready to take on the challenge. \n\nAs the story unfolds, the siblings embark on a thrilling journey of mathematical exploration, using their exceptional problem-solving skills to devise strategies and algorithms. With the support of their friends and the guidance of Dr. Victor, they dive deep into the world of mathematics, determined to find the elusive solution.\n\nWill Emma and Ethan be able to crack the code and discover W(106)? Will their journey uncover new insights into the magical world of the Flipping Game? The answers lie in their determination, resilience, and unwavering belief in the power of mathematics.\n\nAnd so, dear reader, I pose this question to you: Can you find W(106), the number of winning moves for a 106x106 board? Take a moment to ponder, solve, and perhaps embark on your own journey of mathematical discovery."}, {"id": 478, "euler_id": 478, "title": "Mixtures", "problem": "Let us consider mixtures of three substances: A, B and C. A mixture can be described by a ratio of the amounts of A, B, and C in it, i.e., (a\u00a0:\u00a0b\u00a0:\u00a0c). For example, a mixture described by the ratio (2\u00a0:\u00a03\u00a0:\u00a05) contains 20% A, 30% B and 50% C.\nFor the purposes of this problem, we cannot separate the individual components from a mixture. However, we can combine different amounts of different mixtures to form mixtures with new ratios.\nFor example, say we have three mixtures with ratios (3\u00a0:\u00a00\u00a0:\u00a02), (3\u00a0:\u00a06\u00a0:\u00a011) and (3\u00a0:\u00a03\u00a0:\u00a04). By mixing 10 units of the first, 20 units of the second and 30 units of the third, we get a new mixture with ratio (6\u00a0:\u00a05\u00a0:\u00a09), since:\n(10\u00b73/5\u00a0+\u00a020\u00b73/20\u00a0+\u00a030\u00b73/10\u00a0:\u00a010\u00b70/5\u00a0+\u00a020\u00b76/20\u00a0+\u00a030\u00b73/10\u00a0:\u00a010\u00b72/5\u00a0+\u00a020\u00b711/20\u00a0+\u00a030\u00b74/10)\n= (18\u00a0:\u00a015\u00a0:\u00a027) = (6\u00a0:\u00a05\u00a0:\u00a09)\nHowever, with the same three mixtures, it is impossible to form the ratio (3\u00a0:\u00a02\u00a0:\u00a01), since the amount of B is always less than the amount of C.\nLet n be a positive integer. Suppose that for every triple of integers (a, b, c) with 0 \u2264 a, b, c \u2264 n and gcd(a, b, c) = 1, we have a mixture with ratio (a\u00a0:\u00a0b\u00a0:\u00a0c). Let M(n) be the set of all such mixtures.\nFor example, M(2) contains the 19 mixtures with the following ratios:\n{(0\u00a0:\u00a00\u00a0:\u00a01), (0\u00a0:\u00a01\u00a0:\u00a00), (0\u00a0:\u00a01\u00a0:\u00a01), (0\u00a0:\u00a01\u00a0:\u00a02), (0\u00a0:\u00a02\u00a0:\u00a01), \n(1\u00a0:\u00a00\u00a0:\u00a00), (1\u00a0:\u00a00\u00a0:\u00a01), (1\u00a0:\u00a00\u00a0:\u00a02), (1\u00a0:\u00a01\u00a0:\u00a00), (1\u00a0:\u00a01\u00a0:\u00a01), \n(1\u00a0:\u00a01\u00a0:\u00a02), (1\u00a0:\u00a02\u00a0:\u00a00), (1\u00a0:\u00a02\u00a0:\u00a01), (1\u00a0:\u00a02\u00a0:\u00a02), (2\u00a0:\u00a00\u00a0:\u00a01), \n(2\u00a0:\u00a01\u00a0:\u00a00), (2\u00a0:\u00a01\u00a0:\u00a01), (2\u00a0:\u00a01\u00a0:\u00a02), (2\u00a0:\u00a02\u00a0:\u00a01)}.\nLet E(n) be the number of subsets of M(n) which can produce the mixture with ratio (1 : 1 : 1), i.e., the mixture with equal parts A, B and C. \nWe can verify that E(1) = 103, E(2) = 520447, E(10)\u00a0mod\u00a0118 = 82608406 and E(500)\u00a0mod\u00a0118 = 13801403.\nFind E(10\u00a0000\u00a0000)\u00a0mod\u00a0118.", "solution": "59510340", "difficulty": 100, "story": "Once upon a time in a faraway kingdom, there lived a talented alchemist named Tristan. He was renowned for his ability to create miraculous potions that could heal the sick, grant strength to the weak, and even transform mere mortals into powerful beings. Tristan's potions were always in high demand, and people from near and far sought his expertise.\n\nTristan's secret to creating such potent potions lay in the precise mixture of three rare substances: A, B, and C. The kingdom was blessed with an abundance of these substances, and many alchemists tried to replicate Tristan's success. However, none could ever come close to matching his concoctions. What set Tristan apart was the unique way in which he combined different amounts of the three substances to form mixtures with extraordinary properties.\n\nWord spread throughout the kingdom about Tristan's magnum opus, a potion with a ratio of (1 : 1 : 1) - a potion that could bring about perfect balance and harmony within oneself. The demand for this coveted potion grew exponentially, and people flocked to Tristan's laboratory, hoping to obtain it.\n\nHowever, every alchemist who attempted to replicate Tristan's recipe failed. No matter how much they mixed, the ratio they achieved was always off, infested with an excess of one substance and a deficiency of another. It seemed impossible to create the elusive (1 : 1 : 1) potion, and the alchemists grew frustrated.\n\nMeanwhile, Tristan watched the commotion from his laboratory window, amused by their futile attempts. He knew that replicating his recipe required a deep understanding of the mathematical problem that governed the mixture ratio. His knowledge of mathematics was the key to his success, and he had always loved the intersection of numbers and potions.\n\nOne day, as Tristan was walking through the bustling marketplace, an elderly man stopped him in his tracks. \"Young man, I've heard tales of your miraculous potions,\" the man said, his eyes twinkling with hope. \"Please, can you create the (1 : 1 : 1) potion for me? I seek balance and harmony in my life.\"\n\nTristan studied the old man for a moment, contemplating his request. He saw a reflection of himself, someone yearning for equilibrium amidst a world of chaos. With a warm smile, Tristan agreed to help. He led the old man back to his laboratory, where vials of A, B, and C stood neatly arranged on shelves.\n\nTristan explained the mathematical problem to the old man and its significance in achieving the desired ratio. \"For every triple of integers (a, b, c) with 0 \u2264 a, b, c \u2264 n and gcd(a, b, c) = 1, there exists a unique mixture with ratio (a : b : c),\" he said.\n\nThe old man listened attentively, his eyes filled with determination. He wanted to understand, to truly grasp the essence of this mathematical problem. Tristan patiently explained further, showcasing how different mixtures of A, B, and C could be combined to create entirely new mixtures. He demonstrated how to obtain the desired ratio by skillfully manipulating the amounts of the three substances.\n\nTheir journey to create the (1 : 1 : 1) potion had just begun. The old man studied, researched, and practiced every day, seeking to solve the mathematical problem that had eluded so many. He lost himself in a labyrinth of calculations, trying to find the formula that would bring balance to his life.\n\nWeeks turned into months, and as the old man delved deeper into his pursuit, Tristan watched with anticipation. The kingdom grew curious about the mysterious old man and his quest for the (1 : 1 : 1) potion. Whispers filled the air, and soon everyone was eagerly awaiting the results.\n\nFinally, the day arrived when the old man returned to Tristan's laboratory, a glimmer of excitement in his eyes. \"Tristan, my friend, I have found it! I have discovered the way to create the (1 : 1 : 1) potion!\" he exclaimed.\n\nTristan's heart swelled with joy and pride for his student. The old man had unlocked the secrets of the mathematical problem and solved it. Together, they prepared the formula, carefully measuring and mixing the substances. The old man followed Tristan's guidance, painstakingly adding the precise amounts to achieve the (1 : 1 : 1) ratio.\n\nAs the final drops merged, a mysterious glow enveloped the laboratory. The (1 : 1 : 1) potion formed before their eyes, radiating an aura of tranquility and serenity. The old man's joy knew no bounds as he held the vial, his hands trembling with anticipation of the transformation it would bring.\n\n\"Tristan, my dear friend,\" the old man said, turning to face him. \"Tell me, what is the meaning of this mathematical problem? What does it signify and why is it so crucial to achieving the (1 : 1 : 1) ratio?\"\n\nWith a twinkle in his eyes, Tristan smiled knowingly. His entire life had revolved around this mathematical problem, for it held the key to creation itself. And yet, in that moment, he realized that the problem was not meant to be solved solely by him. It was meant to be pondered, explored, and embraced by others. The true magic lay not in the solution but in the journey of discovery.\n\nAnd so, Tristan turned to the old man, his voice carrying a promise of wisdom. \"My friend, the answer lies within you. The mathematical problem is a puzzle to be solved by every alchemist, every seeker of balance and harmony. It represents the intricate dance of life, the delicate balance we all strive to achieve. Now, my dear friend, it is your turn to share this wisdom with the world.\"\n\nWith that, the old man left Tristan's laboratory, carrying the (1 : 1 : 1) potion that held the power to bring about balance and harmony. As he stepped into the sunlight, a radiant smile stretched across his face. He had found his purpose, his calling.\n\nAnd so, dear reader, the question remains: Can you solve the mathematical problem? Can you unlock the secret to the (1 : 1 : 1) ratio that brings perfect balance and harmony? Venture forth and seek the truth, for the answer lies within you.\n\nWhat is E(10,000,000) mod 118?"}, {"id": 483, "euler_id": 483, "title": "Repeated permutation", "problem": "\nWe define a permutation as an operation that rearranges the order of the elements {1, 2, 3, ..., n}.\nThere are n! such permutations, one of which leaves the elements in their initial order.\nFor n = 3 we have 3! = 6 permutations:\n- P1 = keep the initial order\n- P2 = exchange the 1st and 2nd elements\n- P3 = exchange the 1st and 3rd elements\n- P4 = exchange the 2nd and 3rd elements\n- P5 = rotate the elements to the right\n- P6 = rotate the elements to the left\n\n\nIf we select one of these permutations, and we re-apply the same permutation repeatedly, we eventually restore the initial order.For a permutation Pi, let f(Pi) be the number of steps required to restore the initial order by applying the permutation Pi repeatedly.For n = 3, we obtain:- f(P1) = 1 : (1,2,3) \u2192 (1,2,3)- f(P2) = 2 : (1,2,3) \u2192 (2,1,3) \u2192 (1,2,3)- f(P3) = 2 : (1,2,3) \u2192 (3,2,1) \u2192 (1,2,3)- f(P4) = 2 : (1,2,3) \u2192 (1,3,2) \u2192 (1,2,3)- f(P5) = 3 : (1,2,3) \u2192 (3,1,2) \u2192 (2,3,1) \u2192 (1,2,3)- f(P6) = 3 : (1,2,3) \u2192 (2,3,1) \u2192 (3,1,2) \u2192 (1,2,3)\n\n\nLet g(n) be the average value of f2(Pi) over all permutations Pi of length n.g(3) = (12 + 22 + 22 + 22 + 32 + 32)/3! = 31/6 \u2248 5.166666667e0g(5) = 2081/120 \u2248 1.734166667e1g(20) = 12422728886023769167301/2432902008176640000 \u2248 5.106136147e3\n\n\nFind g(350) and write the answer in scientific notation rounded to 10 significant digits, using a lowercase e to separate mantissa and exponent, as in the examples above.\n", "solution": "4.993401567e22", "difficulty": 100, "story": "Once upon a time in the land of Arithmosia, there lived three mischievous fairies named Primrose, Delta, and Gamma. These fairies possessed the power to rearrange the order of any given set of elements. Their playful nature often led to chaos, as they would rearrange the world around them just for fun.\n\nOne sunny day, the fairies decided to play a game with the residents of Arithmosia. They approached the wise old mathematician, Professor Euler, with a challenge. \"Professor,\" Primrose said with a twinkle in her eye, \"we have discovered a fascinating mathematical problem that we want to test the people's minds with. Do you think they can solve it?\"\n\nThe professor, intrigued by the fairies' proposition, replied, \"I'm sure the people of Arithmosia would love a good challenge. Tell me, what is this problem you have discovered?\"\n\nGamma explained, \"We have found that for any given set of elements in Arithmosia, if we select one of the permutations and repeatedly apply it, we can eventually restore the initial order. We want to know the average number of steps it takes to do so.\"\n\nProfessor Euler stroked his long white beard, deep in thought. He understood the significance of this problem and its connection to the powerful concept of permutations. \"This is indeed a fascinating problem,\" he said. \"It holds the key to understanding the nature of order and chaos. But how can we determine the average value of the number of steps without knowing the specific permutations?\"\n\nDelta, the most mischievous of the fairies, giggled and said, \"Ah, that's where the challenge lies! We will let the people of Arithmosia calculate it for themselves. We'll provide them with a few examples and challenge them to find g(350).\"\n\nWith a wave of their wands, the fairies created six magical portals in front of the professor, each leading to a different permutation. As they stepped through the portals, Primrose, Delta, and Gamma demonstrated the power of their rearrangement magic.\n\nProfessor Euler, along with the curious residents of Arithmosia, watched in awe as the fairies performed their magical permutations. With each step, the professor could sense the growing excitement and anticipation in the crowd.\n\nAfter the last demonstration, the fairies returned to the professor's side. \"Now it's up to you, Professor Euler, and the people of Arithmosia, to find g(350),\" said Primrose.\n\nThe professor turned to the crowd, his voice filled with excitement. \"Arithmosians! This is not just a mathematical problem; it is a window into the mysteries of order and chaos. Let us pool our collective knowledge and find the average number of steps required to restore the initial order for a set of 350 elements. Who among you will join me in this grand adventure of discovery?\"\n\nThe crowd erupted in applause and cheers as the residents of Arithmosia prepared to embark on their journey of mathematical exploration. Doors open, minds curious, they were ready to unravel the secrets hidden within the realm of permutations and find the elusive g(350).\n\nAnd so the people of Arithmosia set forth, filled with determination and a thirst for knowledge, ready to solve one of the greatest mathematical challenges their land had ever encountered.\n\nArithmosians, are you ready to embrace the mysteries of permutations and uncover the solution to g(350)? Will you find the average number of steps required to restore the initial order? The answer awaits you."}, {"id": 484, "euler_id": 484, "title": "Arithmetic Derivative", "problem": "The arithmetic derivative is defined by\np' = 1 for any prime p\n(ab)' = a'b + ab' for all integers a, b (Leibniz rule)\nFor example, 20' = 24.\nFind \u2211\u2009gcd(k,k') for 1 < k \u2264 5\u00d71015.\nNote: gcd(x,y) denotes the greatest common divisor of x and y.", "solution": "8907904768686152599", "difficulty": 100, "story": "Once upon a time, in a quaint little village, there lived a young girl named Lily. Lily was quite an inquisitive child, always seeking knowledge and looking for answers to the many questions that filled her curious mind.\n\nOne sunny morning, as Lily was sitting under the shade of a large oak tree, she noticed a peculiar old man walking towards her. Intrigued, she watched as he approached, a gentle smile illuminating his wrinkled face. The old man introduced himself as Mr. Johnson, a retired mathematician who had devoted his life to exploring the mysteries of numbers.\n\nIntrigued by Mr. Johnson's occupation, Lily eagerly asked him to share a mathematical problem with her. Mr. Johnson, happy to find such a passionate young listener, started explaining the concept of the arithmetic derivative.\n\n\"The arithmetic derivative is a function that provides fascinating insights into the relationship between numbers,\" Mr. Johnson began. \"For primes, the derivative is always one. But for any other number, it's calculated by using the Leibniz rule.\"\n\nAs Mr. Johnson carried on explaining, Lily's eyes widened with wonder. She realized that this mathematical concept had the potential to unveil secret patterns hidden within the fabric of numbers. She felt a magnetic pull towards this problem, as if solving it would unlock a treasure trove of knowledge.\n\nDays turned into weeks, and Lily became engrossed in her study of the arithmetic derivative. She spent countless hours scribbling equations and painstakingly calculating the derivatives of various numbers. Lily was determined to find a relationship between the original numbers and their derivatives.\n\nShe began to notice fascinating patterns emerging. The greatest common divisor, or gcd, of a number and its derivative seemed to be connected in a profound way. Sometimes the gcd was equal to one, indicating that the two numbers shared no prime factors. At other times, the gcd was larger, showing a deeper connection between the original number and its derivative.\n\nIn her quest for understanding, Lily kept experimenting with different numbers. She would often find herself absorbed in the beauty of mathematics, engrossed in the elegant dance of numbers and their derivatives.\n\nThen, one day, as the sun set and bathed the village in a golden glow, Mr. Johnson returned to see Lily. He could see the spark of excitement in her eyes and the eagerness in her voice. She couldn't wait to share her findings and discuss her journey through the realm of numbers.\n\nHowever, upon arriving at the oak tree, Mr. Johnson found only an empty space. The village was empty. It was as if everyone had disappeared, leaving no trace behind.\n\nIn the stillness of the empty village, Mr. Johnson noticed a small note left behind. It read, \"Find \u2211\u2009gcd(k,k') for 1 < k \u2264 5\u00d71015.\" Lily's handwriting was unmistakable, but where had she gone?\n\nIn that moment, Mr. Johnson realized that Lily had left this note for him. She had dug deep into the mathematical problem, pursued its secrets with relentless curiosity, and now she was challenging him to find the answer.\n\nAnd so, the old mathematician began his own journey. He searched for Lily, retraced her steps, and explored the vast realm of numbers. Days turned into weeks, and weeks turned into months, but Mr. Johnson remained undeterred.\n\nAs he delved into the intricate world of mathematics, Mr. Johnson pondered Lily's question. What could the sum of gcd(k,k') reveal? What hidden patterns and profound connections were yet to be discovered?\n\nNow, dear reader, I must pass on the torch to you. Can you solve the mathematical problem that Lily was so captivated by? Can you find \u2211\u2009gcd(k,k') for 1 < k \u2264 5\u00d71015?\n\nAs you delve into the realm of numbers and let curiosity guide your path, may you uncover the secrets of the arithmetic derivative and reveal the profound beauty hidden within the digits."}, {"id": 489, "euler_id": 489, "title": "Common factors between two sequences", "problem": "Let G(a, b) be the smallest non-negative integer n for which gcd(n3 + b, (n + a)3 + b) is maximized.\nFor example, G(1, 1) = 5 because gcd(n3 + 1, (n + 1)3 + 1) reaches its maximum value of 7 for n = 5, and is smaller for 0 \u2264 n < 5.\nLet H(m, n) = \u2211\u2009G(a, b) for 1 \u2264 a \u2264 m, 1 \u2264 b \u2264 n.\nYou are given H(5, 5) = 128878 and H(10, 10) = 32936544.\nFind H(18, 1900).", "solution": "1791954757162", "difficulty": 100, "story": "In the heart of a quaint little town, nestled between the rolling hills and the babbling brook, there stood a mysterious old bookstore. Its weathered sign, adorned with fading gold letters, read \"The Enigma Book Emporium.\" This bookstore held a secret - within its dusty shelves lay books that were not just stories, but gateways to adventure and discovery.\n\nA young girl named Amelia lived in the town and was a regular visitor to the bookstore. She loved to lose herself in the fascinating tales and explore the treasure trove of knowledge hidden within. One day, as she perused the dusty aisles, she stumbled upon a worn, leather-bound book titled \"The Secrets of Numbers: Unraveling the Mysteries of Mathematics.\"\n\nIntrigued, Amelia opened the book and found herself captivated by the rich history and enchanting puzzles contained within. She was drawn to one particular section that whispered of a magical equation, capable of unlocking the deepest secrets of the universe. The words on the page danced before her eyes, and the numbers seemed to come alive.\n\nIt was here that she discovered the mathematical problem that would forever change her life. The problem was G(a, b), a quest to find the smallest non-negative integer n for which the greatest common divisor or GCD of (n3 + b) and ((n + a)3 + b) was maximized. The journey to find this elusive number was treacherous and riddled with obstacles, but the rewards were immeasurable.\n\nAmelia became obsessed with G(a, b), spending her days marveling at its complex beauty and pondering its significance. The problem consumed her thoughts, weaving itself into her dreams and making her question the very fabric of reality. She saw patterns emerge from the numbers, and slowly, they started to form a connection with her own life.\n\nAs Amelia delved deeper into the secrets of numbers, she began to see a profound correlation between the mathematical problem and the very essence of existence. The GCD represented a bond, a unity that transcended boundaries, mirrored in the relationships she formed with the people around her.\n\nShe found herself ensnared in a web of mathematical intrigue, unable to break free. Amelia embarked on a quest to solve G(a, b) herself, but the complexities and intricacies of the problem eluded her. The pages of the book became worn and dog-eared as she poured over them night after night, desperate for an answer.\n\nWith every passing day, Amelia's fascination with G(a, b) grew. She saw the problem as a key, a doorway to a higher understanding of the universe. The bookstore owner, Mr. Benedict, noticed Amelia's relentless pursuit of knowledge and shared her passion for numbers. He became her mentor, guiding her through the realms of mathematics and encouraging her to never give up.\n\nOne stormy evening, as the thunder roared and rain poured down in sheets, Amelia found herself standing before a massive chalkboard covered in elaborate equations. She had dedicated countless hours to G(a, b), and although the path had been filled with frustration and dead ends, she felt closer to a breakthrough than ever before.\n\nAmelia's eyes scanned the chalkboard, willing the numbers to reveal themselves, to disclose their secrets. She traced the familiar shapes and patterns, her heart racing with anticipation. In that moment, it seemed as though time itself held its breath, awaiting the conclusion of Amelia's mathematical odyssey.\n\nAnd then, just as she reached the precipice of revelation, the chalk slipped from her fingers and clattered to the ground. The stories of the numbers, the enigma she had been chasing, felt just out of reach. Like a mirage in the desert, the solution shimmered tantalizingly close, yet unattainable.\n\nBut as Amelia stared at the chalkboard, her eyes filled with determination. She knew that even if she couldn't solve G(a, b) herself, her quest had not been in vain. The journey itself had transformed her, broadening her horizons and fueling her curiosity.\n\nAnd so, dear reader, the question now falls to you: Can you solve G(18, 1900)? Within your mind lies the power to unlock the secret, to unravel the enigma that has captivated Amelia's heart. Will you step into her shoes and embark on this mathematical adventure?"}, {"id": 494, "euler_id": 494, "title": "Collatz prefix families", "problem": "\nThe Collatz sequence is defined as:\nai+1={ai23ai+1if\u00a0ai\u00a0is evenif\u00a0ai\u00a0is odd.\n\n\nThe Collatz conjecture states that starting from any positive integer, the sequence eventually reaches the cycle 1,4,2,1....\nWe shall define the sequence prefix p(n) for the Collatz sequence starting with a1 = n as the sub-sequence of all numbers not a power of 2 (20=1 is considered a power of 2 for this problem). For example:p(13) = {13, 40, 20, 10, 5} p(8) = {}\nAny number invalidating the conjecture would have an infinite length sequence prefix.\n\n\nLet Sm be the set of all sequence prefixes of length m. Two sequences {a1, a2, ..., am} and {b1, b2, ..., bm} in Sm are said to belong to the same prefix family if ai < aj if and only if bi < bj for all 1 \u2264 i,j \u2264 m.\n\n\nFor example, in S4, {6, 3, 10, 5} is in the same family as {454, 227, 682, 341}, but not {113, 340, 170, 85}.\nLet f(m) be the number of distinct prefix families in Sm.\nYou are given f(5) = 5, f(10) = 55, f(20) = 6771.\n\n\nFind f(90).\n", "solution": "2880067194446832666", "difficulty": 100, "story": "Once upon a time, in the quiet town of Mathania, there lived a young and curious girl named Alice. Alice had a passion for numbers and patterns, always finding delight in solving mathematical problems. One sunny afternoon, as she was strolling through the town square, she overheard two elderly gentlemen talking about a perplexing mathematical conundrum called the Collatz sequence.\n\nIntrigued by their conversation, Alice decided to find out more about this fascinating problem. She visited the local library and spent hours pouring over books and articles. Finally, she came across the definition of the Collatz sequence and the famous Collatz conjecture. The notion that any positive integer eventually leads to the cycle 1, 4, 2, 1 mesmerized her completely.\n\nUnable to contain her excitement, Alice thought of a way to weave this mathematical problem into her life. She was an active member of her school's Math Club, where she spent most of her time with her friends, Eric and Lily. The three of them loved challenging each other with puzzles and brain teasers, and Alice saw an opportunity to introduce the Collatz sequence as their next mystery to unravel.\n\nThe following week, during one of their club meetings, Alice surprised Eric and Lily with a mysterious envelope. Inside was a sheet of paper with a series of numbers, each accompanied by the corresponding prefix from the Collatz sequence. The challenge was for them to decipher the underlying pattern and determine the number of distinct prefix families in the 90th sequence prefix, f(90).\n\nAs the days turned into weeks, Alice and her friends eagerly explored and discussed different strategies. They created charts, tested hypotheses, and exchanged countless ideas. It wasn't an easy puzzle to crack, but their enthusiasm and determination kept them going.\n\nIn the meantime, the townsfolk of Mathania noticed the trio's dedication to this mathematical riddle. News spread, and soon, the entire community was buzzing with anticipation. People from all walks of life rallied around Alice, Eric, and Lily, offering their support and encouragement.\n\nThe town held a grand festival to celebrate the young mathematicians' efforts. There were games, puzzles, and even a Collatz-themed parade. As Alice walked through the streets adorned with colorful decorations, she couldn't help but feel overwhelmed by the love and support radiating from her community.\n\nFinally, the day of the big reveal arrived. Alice and her friends stood on stage, facing a crowd of expectant faces. The townsfolk eagerly waited for the answer to the mathematical puzzle that had captured their attention for weeks.\n\nBut just as Alice was about to reveal the solution, she paused. She realized that this moment was about more than just finding an answer to a mathematical problem. It was about the journey, the community that had come together, and the joy that numbers and patterns could bring to their lives.\n\nWith a smile, Alice turned towards the crowd and asked, \"Now, my dear friends, can you help me solve this mathematical mystery? What is f(90)?\"\n\nAnd so, the story of Alice and her friends continues, leaving the townsfolk of Mathania pondering over the Collatz sequence and the never-ending pursuit of mathematical knowledge.\n\nWhat is f(90)?"}, {"id": 495, "euler_id": 495, "title": "Writing n as the product of k distinct positive integers", "problem": "Let W(n,k) be the number of ways in which n can be written as the product of k distinct positive integers.\nFor example, W(144,4) = 7. There are 7 ways in which 144 can be written as a product of 4 distinct positive integers:\n144 = 1\u00d72\u00d74\u00d718\n144 = 1\u00d72\u00d78\u00d79\n144 = 1\u00d72\u00d73\u00d724\n144 = 1\u00d72\u00d76\u00d712\n144 = 1\u00d73\u00d74\u00d712\n144 = 1\u00d73\u00d76\u00d78\n144 = 2\u00d73\u00d74\u00d76\nNote that permutations of the integers themselves are not considered distinct.\nFurthermore, W(100!,10) modulo 1\u00a0000\u00a0000\u00a0007 = 287549200.\nFind W(10000!,30) modulo 1\u00a0000\u00a0000\u00a0007.", "solution": "789107601", "difficulty": 100, "story": "Once upon a time in the enchanting kingdom of Numeria, there lived a young and curious mathematician named Oliver. Oliver had always been fascinated by numbers and their intricate relationships. His heart thrived on the joy of solving complex mathematical problems.\n\nOne sunny morning, while strolling through Numeria's bustling marketplace, Oliver stumbled upon an old parchment that seemed to have been abandoned by its previous owner. As he gingerly picked it up, he realized that it held a mathematical problem, delicately inscribed in elegant calligraphy.\n\nIntrigued, Oliver's eyes widened with excitement as he read the problem:\n\n\"Let W(n,k) be the number of ways in which n can be written as the product of k distinct positive integers.\"\n\nWith every word, his mind raced with endless possibilities. His imagination began to weave magical scenarios of numbers dancing across the parchment, forming intricate patterns and symmetries.\n\nOliver's fascination deepened as he read further. The parchment provided an example, W(144,4) = 7, and explained the distinguished ways in which 144 could be written as a product of four distinct positive integers.\n\nHis mind filled with wonder as he pondered over the possibilities. He envisioned the numbers harmoniously intertwining to form beautiful sequences. The combination of factors fascinated him\u2014their various arrangements yielding different outcomes.\n\nSuddenly, a thought struck Oliver\u2014he wondered how the mathematical problem could be solved for much larger numbers. How many ways could a factorial number be written as the product of a specific count of distinct positive integers?\n\nThe parchment provided an answer: W(100!,10) modulo 1,000,000,007 = 287,549,200. Oliver's heart raced with excitement at the sheer magnitude of this number.\n\nHis curiosity piqued, Oliver couldn't help but ponder an even greater mystery. If W(100!,10) rendered such an incredible solution, what would W(10,000!,30) modulo 1,000,000,007 be? The possibilities were infinite.\n\nAs Oliver folded the parchment and placed it safely in his pocket, he realized that he had been chosen to unravel the enigma hidden within the numbers. Determined to find the answer, he embarked on a thrilling adventure, seeking knowledge and guidance.\n\nWill Oliver uncover the answer to the mysterious mathematical problem? Can he overcome the obstacles that lie ahead? Is it even possible to solve such an intricate puzzle?\n\nAs the story concludes, we leave Oliver standing on the precipice of a mathematical expedition, his heart filled with determination and a question on his lips: \"What is W(10,000!,30) modulo 1,000,000,007?\""}, {"id": 499, "euler_id": 499, "title": "St. Petersburg Lottery", "problem": "A gambler decides to participate in a special lottery. In this lottery the gambler plays a series of one or more games.\nEach game costs m pounds to play and starts with an initial pot of 1 pound. The gambler flips an unbiased coin. Every time a head appears, the pot is doubled and the gambler continues. When a tail appears, the game ends and the gambler collects the current value of the pot. The gambler is certain to win at least 1 pound, the starting value of the pot, at the cost of m pounds, the initial fee.\nThe game ends if the gambler's fortune falls below m pounds.\nLet pm(s) denote the probability that the gambler will never run out of money in this lottery given an initial fortune s and the cost per game m.\nFor example p2(2)\u00a0\u2248\u00a00.2522, p2(5)\u00a0\u2248\u00a00.6873 and p6(10\u00a0000)\u00a0\u2248\u00a00.9952 (note: pm(s)\u00a0=\u00a00 for s\u00a0<\u00a0m).\nFind p15(109) and give your answer rounded to 7 decimal places behind the decimal point in the form 0.abcdefg.", "solution": "0.8660312", "difficulty": 100, "story": "Once upon a time in the bustling city of Numeria, there lived a young woman named Emma. Emma was known far and wide for her cleverness and quick wit, always looking for an exciting challenge. One day, she stumbled upon a flyer for a special lottery that promised great riches and an adrenaline rush like no other. The flyer detailed the rules of the game, which enticed Emma's curious mind.\n\nIntrigued by the prospect of testing her luck and mathematical prowess, Emma decided to participate in the lottery. However, before she could embark on this adventure, she needed to solve a complex mathematical problem. With all her dedication and cunning, she set to work.\n\nAs the days turned into weeks, Emma immersed herself in calculations and equations, her mind spinning like a roulette wheel. She strived to understand the probabilities, uncertain risks, and potential rewards involved in this lottery game. Each night, she would pour over the theory, manipulating variables and considering the possible outcomes.\n\nOne evening, as the sun painted the sky with shades of orange and pink, an epiphany struck Emma. After countless sleepless nights and countless cups of coffee, she had found the answer to her mathematical conundrum. Satisfied with her solution, Emma had a newfound confidence in facing the lottery's challenge.\n\nArmed with her knowledge and a heart filled with excitement, Emma made her way to the grand venue where the lottery would take place. People from all walks of life had gathered, buzzing with anticipation. Emma took her place among them, clutching her ticket in anxious anticipation.\n\nAs the lottery began, the crowd fell silent, eyes locked on the stage where the mysterious game would unfold. Emma was amongst the first to be called, and she approached the stage with measured steps. The host of the lottery, a charismatic man with a twinkle in his eye, welcomed her with a warm smile.\n\n\"Welcome, brave contestant! Are you ready to test your luck?\" he asked, his voice echoing through the hall.\n\nEmma nodded, determination glowing in her eyes. The host continued, \"Remember, at stake is not just money, but the thrill of pushing the boundaries of probability itself. Are you prepared for risk and reward?\"\n\nWith a confident smile, Emma replied, \"I have studied the probabilities intensively, and I am ready for whatever challenges this game may present.\"\n\nAnd so, the game began. Emma paid the initial fee, known as the cost per game, and the pot started with a humble 1 pound. She flipped the coin, praying for it to land on heads, for the pot to grow and her chances to increase. Her heart raced as the coin leaped up into the air, twirling under the spotlight.\n\nThe crowd held their breath as the coin descended, finally landing with a soft clink. It was a head. The pot doubled, and Emma's enthusiasm soared. With each flip, the pot grew, creating a crescendo of anticipation within the auditorium.\n\nBut alas, the fickle nature of probability decided to make its presence known. After a string of heads that seemed never-ending, the coin finally betrayed Emma, landing on a tail. The game ended there, and Emma, though disappointed, was still victorious - she had collected the current value of the pot.\n\nAs she walked off the stage, a sense of wonder filled her being. She had experienced the thrill of taking calculated risks, relying on numbers and probabilities alone. Emma couldn't help but wonder about the possibilities that lay beyond that stage, beyond that game.\n\nWith a new determination in her stride, Emma turned to face you, dear reader. A spark of curiosity danced in her eyes as she asked, \"Can you solve the mathematical problem that fueled my journey? Can you find p15(109) and give your answer rounded to 7 decimal places behind the decimal point in the form 0.abcdefg?\""}, {"id": 502, "euler_id": 502, "title": "Counting Castles", "problem": "We define a block to be a rectangle with a height of 1 and an integer-valued length. Let a castle be a configuration of stacked blocks.\nGiven a game grid that is w units wide and h units tall, a castle is generated according to the following rules:\nBlocks can be placed on top of other blocks as long as nothing sticks out past the edges or hangs out over open space.\nAll blocks are aligned/snapped to the grid.\nAny two neighboring blocks on the same row have at least one unit of space between them.\nThe bottom row is occupied by a block of length w.\nThe maximum achieved height of the entire castle is exactly h.\nThe castle is made from an even number of blocks.\nThe following is a sample castle for w=8 and h=5:\n\nLet F(w,h) represent the number of valid castles, given grid parameters w and h.\nFor example, F(4,2) = 10, F(13,10) = 3729050610636, F(10,13) = 37959702514, and F(100,100) mod 1 000 000 007 = 841913936.\nFind (F(1012,100) + F(10000,10000) + F(100,1012)) mod 1 000 000 007.", "solution": "749485217", "difficulty": 100, "story": "Once upon a time, in the magical Kingdom of Mathos, there lived a young girl named Emma. Emma had always been fascinated by numbers and patterns. She spent her days exploring the vast library in her village, looking for challenging math problems to solve. One day, as she was flipping through the pages of an ancient book, she stumbled upon a problem that intrigued her like no other.\n\nThe problem described a castle made up of stacked blocks. Emma read the rules carefully, her eyes widening with excitement. She imagined the blocks and the castle taking shape in her mind, their lengths and heights forming a beautiful symphony of numbers. The problem required finding the number of valid castles given the width and height of the game grid.\n\nUnable to resist the allure of the problem, Emma decided to put her mathematical skills to the test. She spent countless hours sketching and calculating, trying to find the patterns within the castle configurations. She knew that each castle had to be aligned to the grid, and every block had to fit without overhanging the edges or hanging over open space. The blocks on the same row also needed to have at least one unit of space between them. The bottom row was occupied by a block of length equal to the width of the grid. And most importantly, the maximum height of the entire castle had to be exactly equal to the given height.\n\nAs Emma immersed herself in solving the problem, she realized that the number of valid castles depended on the number of even-length blocks that could fit within the constraints. She found herself lost in a world of calculations, drawing diagrams and scribbling equations on her parchment. Emma's determination grew stronger with every passing day, even as she encountered more and more complex test cases.\n\nThe people of Mathos began to notice Emma's dedication and passion for her task. They admired her determination and sought her guidance for their own mathematical conundrums. Emma found solace in their appreciation, but her heart yearned for a castle that would amaze even the most skeptical minds.\n\nMonths turned into years, and Emma's reputation as a mathematical prodigy continued to grow. The villagers were in awe of her ability to solve complex problems effortlessly. But Emma knew that the ultimate test of her skills lay in finding the number of valid castles given the largest grid dimensions.\n\nHer mind abuzz with possibilities, Emma set out on a quest to solve the problem that had become both her passion and her nemesis. She sought the wisdom of scholars, perused dusty tomes, and consulted with renowned mathematicians from distant lands. Yet, the solution to the problem remained as elusive as ever.\n\nAs years turned into decades, Emma grew old, but her determination never wavered. She spent her remaining days pondering the problem that had consumed her life. And on her final day, as the sun set over Mathos, Emma left behind a question for future generations:\n\n\"What is the value of (F(1012, 100) + F(10000, 10000) + F(100, 1012)) mod 1 000 000 007?\"\n\nAnd so, the tale of Emma, the girl who dedicated her life to a mathematical problem, lives on. Will you be the one to solve the castle conundrum that captivated her until her last breath?"}, {"id": 559, "euler_id": 559, "title": "Permuted Matrices", "problem": "An ascent of a column j in a matrix occurs if the value of column j is smaller than the value of column j+1 in all rows.\n\nLet P(k, r, n) be the number of r x n matrices with the following properties:\nThe rows are permutations of {1, 2, 3, ... , n}.\n Numbering the first column as 1, a column ascent occurs at column j<n if and only if j is not a multiple of k.\nFor example, P(1, 2, 3) = 19, P(2, 4, 6) = 65508751 and  P(7, 5, 30) mod 1000000123 = 161858102.\n\nLet Q(n) =\u2211k=1n P(k, n, n).\nFor example, Q(5) = 21879393751 and Q(50) mod 1000000123 = 819573537.\n\nFind Q(50000) mod 1000000123.", "solution": "684724920", "difficulty": 100, "story": "Once upon a time, in the enchanting land of Numeria, there lived a young mathematician named Ethan. With a brilliant mind and a passion for numbers, Ethan would spend most of his days exploring complex mathematical problems. However, there was one particular problem that fascinated him\u2014the mystery of matrices and columns ascent.\n\nIn the heart of Numeria stood a magnificent tower called the Tower of Permutations. It was said that inside the tower resided a magical artifact that held unimaginable powers\u2014the Crystal of Possibilities. Legends whispered that it had the ability to unlock the secrets of permutations and combinations.\n\nEthan's curiosity grew day by day, and he couldn't resist the allure of the Tower of Permutations any longer. Determined to uncover the truth behind the Crystal of Possibilities, he embarked on an epic journey.\n\nAfter months of treacherous travels and countless calculations, Ethan finally arrived at the base of the tower. The structure towered above him, its gleaming walls stretching towards the heavens itself. To his surprise, he found a small, aged man named Elias guarding the entrance.\n\n\"Elias,\" Ethan began, stepping closer. \"I have heard tales of the Crystal of Possibilities within these walls. I wish to solve the mystery of matrices and column ascent. Can you help me gain entry?\"\n\nElias studied Ethan carefully, his ancient eyes twinkling with both skepticism and wisdom. \"Young one,\" he said, his voice carrying the weight of centuries. \"I shall grant you passage but only if you prove your worthiness. Answer me this: How many r x n matrices exist where the first column is numbered as 1, and a column ascent occurs at column j < n if and only if j is not a multiple of k?\"\n\nEthan's heart raced with excitement. This was the very problem he had pondered for months. He took a deep breath and explained the concept of column ascent to Elias. The old man listened attentively, nodding as Ethan spoke.\n\nImpressed by Ethan's knowledge and enthusiasm, Elias signaled for the gates to open. \"You may proceed, young mathematician,\" he said. \"But be warned, the path ahead is fraught with challenges, both physical and numerical.\"\n\nWith gratitude in his heart, Ethan stepped into the tower's dimly lit corridors. The walls were adorned with intricate symbols and equations, hinting at the wonders that lay beyond. As he explored deeper into the tower, he encountered mathematical guardians\u2014equations come to life, challenging him constantly.\n\nUsing his mathematical prowess, Ethan solved each obstacle with grace, his mind humming with numbers and patterns. Each triumph brought him closer to the Crystal of Possibilities, his excitement growing exponentially.\n\nFinally, after what seemed like an eternity, Ethan arrived in a grand chamber. At its center, perched majestically on a pedestal, was the Crystal of Possibilities. Its radiance lit up the room, casting a kaleidoscope of colors on the walls.\n\nAs Ethan approached, he felt a surge of energy. The Crystal hummed softly, responding to his presence. But just as he was about to touch it, a deep voice echoed through the chamber.\n\n\"Young mathematician,\" the voice rumbled. \"You have braved the challenges, but your journey is not complete. Tell me this\u2014what is the value of Q(50000) mod 1000000123?\"\n\nEthan's heart skipped a beat. He had studied the problem, but to solve it here, in the presence of the Crystal of Possibilities, was beyond his wildest dreams. His mind raced, calculating the countless possibilities, but the answer eluded him.\n\nWith a mixture of awe and frustration, Ethan raised his eyes to the Crystal and spoke softly, \"Crystal of Possibilities, show me the way. Guide me towards the solution, for the mysteries of Q(50000) mod 1000000123 have brought me to this moment.\"\n\nAs the last words left Ethan's lips, the Crystal shimmered, illuminating the chamber with a blinding light. In that instant, Ethan realized that the journey itself mattered more than the destination.\n\nAnd so, dear reader, as the tale unfolds, the question remains: What is the value of Q(50000) mod 1000000123? Can you find the solution that eluded Ethan in the Chamber of Possibilities?"}, {"id": 566, "euler_id": 566, "title": "Cake Icing Puzzle", "problem": "Adam plays the following game with his birthday cake.\nHe cuts a piece forming a circular sector of 60 degrees and flips the piece upside down, with the icing on the bottom.\nHe then rotates the cake by 60 degrees counterclockwise, cuts an adjacent 60 degree piece and flips it upside down.\nHe keeps repeating this, until after a total of twelve steps, all the icing is back on top.\nAmazingly, this works for any piece size, even if the cutting angle is an irrational number: all the icing will be back on top after a finite number of steps.\nNow, Adam tries something different: he alternates cutting pieces of size x=3609 degrees, y=36010 degrees and z=36011 degrees. The first piece he cuts has size x and he flips it. The second has size y and he flips it. The third has size z and he flips it. He repeats this with pieces of size x, y and z in that order until all the icing is back on top, and discovers he needs 60 flips altogether.\n\nLet F(a, b, c) be the minimum number of piece flips needed to get all the icing back on top for pieces of size x=360a degrees, y=360b degrees and z=360c degrees.\nLet G(n)=\u22119\u2264a<b<c\u2264nF(a,b,c), for integers a, b and c.\nYou are given that F(9,\u00a010,\u00a011)\u00a0=\u00a060, F(10,\u00a014,\u00a016)\u00a0=\u00a0506, F(15,\u00a016,\u00a017)\u00a0=\u00a0785232.\nYou are also given G(11)\u00a0=\u00a060, G(14)\u00a0=\u00a058020 and G(17)\u00a0=\u00a01269260.\nFind G(53).", "solution": "329569369413585", "difficulty": 100, "story": "Once upon a time in a small village, there lived a curious and intelligent young boy named Adam. Adam had always been fascinated by numbers and puzzles. He would spend hours trying to solve mathematical problems and find patterns in everything he could find.\n\nOne day, Adam's parents surprised him with a grand birthday cake. It was a glorious creation, adorned with colorful icing and enticing decorations. As everyone gathered around, Adam's eyes sparkled with excitement.\n\nAs tradition dictated, Adam was given the honor of cutting the first piece of his birthday cake. He carefully cut out a circular sector spanning 60 degrees. But instead of taking a bite out of it, he decided to give it a twist. Adam carefully flipped the piece upside down so that the icing was now on the bottom.\n\nEveryone watched in awe as Adam rotated the cake 60 degrees counterclockwise and cut an adjacent sector of 60 degrees. Once again, he flipped the piece upside down. He repeated this process over and over, each time cutting a 60-degree sector and flipping it, until, remarkably, all the icing was back on top.\n\nThe villagers cheered and clapped, amazed by Adam's magic-like cake flipping abilities. But Adam couldn't help but wonder why this worked. How was it possible that regardless of the piece size or even if the cutting angle was an irrational number, the icing would always end up back on top after a finite number of steps?\n\nDetermined to solve this mathematical puzzle, Adam embarked on a journey of exploration. He spent hours experimenting with different cake sizes, cutting angles, and flipping techniques. His passion for numbers led him to discover that the secret lay in the repeated rotation of the cake and the precise cutting angles.\n\nExcited by his discovery, Adam decided to take it a step further. He wondered if the same principle would apply if he alternated cutting pieces of different sizes\u2014x degrees, y degrees, and z degrees. He assigned x=3609 degrees, y=36010 degrees, and z=36011 degrees. Carefully cutting and flipping each piece in that order, Adam repeated this process until all the icing was back on top.\n\nTo his surprise, he found that this time, he needed exactly 60 flips to reach his goal. The number 60 seemed to hold a special significance in the world of cake flipping. But why?\n\nAs Adam pondered over this puzzling question, he realized that the answers might lie within the possibilities of F(a, b, c), the minimum number of piece flips needed to restore the icing for different cake piece sizes. His discoveries so far, F(9, 10, 11) = 60, F(10, 14, 16) = 506, and F(15, 16, 17) = 785232, had strengthened his belief that there was a hidden pattern waiting to be unraveled.\n\nEver the curious mathematician, Adam continued to explore the depths of this fascinating problem. He stumbled upon G(n), a summation of F(a, b, c) for various combinations of a, b, and c, as n increased. The sums fascinated him. G(11) = 60, G(14) = 58020, and G(17) = 1269260.\n\nAs Adam's journey of discovery continued, he sought answers to greater challenges, such as G(53). What mysteries would G(53) unlock? How would the numbers intertwine to reveal the hidden patterns in this swirling vortex of mathematical possibilities?\n\nAnd so, the tale of Adam and his cake continued, intertwining mathematics and curiosity in a never-ending quest for understanding. As you delve into the enchanting world of numbers, can you decipher the secrets hidden within G(53)? Can you uncover the missing piece of the puzzle and restore the icing to the top of Adam's cake?"}, {"id": 579, "euler_id": 579, "title": "Lattice points in lattice cubes", "problem": "A lattice cube is a cube in which all vertices have integer coordinates. Let C(n) be the number of different lattice cubes in which the coordinates of all vertices range between (and including) 0 and n. Two cubes are hereby considered different if any of their vertices have different coordinates.\nFor example, C(1)=1, C(2)=9, C(4)=100, C(5)=229, C(10)=4469 and C(50)=8154671.\n\nDifferent cubes may contain different numbers of lattice points.\n\nFor example, the cube with the vertices\n(0, 0, 0), (3, 0, 0), (0, 3, 0), (0, 0, 3), (0, 3, 3), (3, 0, 3), (3, 3, 0), (3, 3, 3) contains 64 lattice points (56 lattice points on the surface including the 8 vertices and 8 points within the cube). \nIn contrast, the cube with the vertices\n(0, 2, 2), (1, 4, 4), (2, 0, 3), (2, 3, 0), (3, 2, 5), (3, 5, 2), (4, 1, 1), (5, 3, 3) contains only 40 lattice points (20 points on the surface and 20 points within the cube), although both cubes have the same side length 3.\n\n\nLet S(n) be the sum of the lattice points contained in the different lattice cubes in which the coordinates of all vertices range between (and including) 0 and n.\nFor example, S(1)=8, S(2)=91, S(4)=1878, S(5)=5832, S(10)=387003 and S(50)=29948928129.\nFind S(5000) mod 109.", "solution": "3805524", "difficulty": 100, "story": "Once upon a time, in the quaint village of Numeria, there lived a young girl named Lily. Lily was a curious and adventurous soul, always seeking new knowledge and excitement. But she had an insatiable appetite for puzzles and problems that intrigued her mind.\n\nOne sunny afternoon, Lily was strolling through the village square, lost in thought, when a tattered piece of parchment caught her eye. Picking it up, she saw a peculiar problem inscribed on it. It was a mathematical question involving lattice cubes. Lily's eyes widened with curiosity, and she could feel the excitement bubbling up within her.\n\nDetermined to find the solution, Lily spent days and nights studying the problem. She delved deep into her books and sought advice from the wisest minds in Numeria. Finally, one evening, as the full moon illuminated the night sky, a spark of inspiration struck Lily.\n\nShe realized that this mathematical problem could be applied to a practical challenge she faced. In the heart of Numeria, there stood an ancient tower, rumored to hold incredible treasures within its walls. However, the tower was known to be a labyrinth of puzzles and illusions, and only those who could solve them could claim the treasures.\n\nLily realized that the treasures in the tower were the different lattice cubes, and the number of lattice points within each cube would lead her to the next clue.\n\nWith renewed enthusiasm, Lily embarked on her journey towards the tower. She braced herself for the challenges that lay ahead and entered the tower's grand entrance hall. The walls were adorned with intricate patterns and dazzling mosaics that seemed to whisper forgotten secrets.\n\nAs she ventured deeper into the tower, each room presented her with a new lattice cube. Lily had to count the lattice points within each cube to determine the correct path to follow. Some cubes were small and contained only a handful of points, while others were larger and more complex.\n\nGuided by her knowledge of the mathematical problem, Lily solved the puzzles set within each room. She counted the lattice points within each cube, deciphered hidden messages, and navigated through illusions that tried to deceive her. Step by step, she made her way through the tower, fueled by her curiosity and determination.\n\nDays turned into weeks, and weeks into months as Lily progressed further within the tower. Each room brought new challenges and unexpected twists. She faced cubes with irregular shapes, some with protruding edges and others with hidden compartments. But the more difficult the puzzle, the more exhilarated Lily became. She could feel herself growing wiser and more confident with every obstacle overcome.\n\nFinally, after countless trials and tribulations, Lily reached the summit of the tower. Before her stood the grand chamber, filled with shimmering jewels, ancient artifacts, and boundless riches. It was a sight to behold, the dream of every treasure hunter come true.\n\nYet, as Lily stood in awe, she pondered the question that had led her to this extraordinary journey. The mathematical problem of the lattice cubes had taken her on an unforgettable adventure, and she had found her answer along the way. Still, she wondered, could you solve it too?\n\nAnd so, dear reader, I leave you with a question. Can you find S(5000) mod 109, just like young Lily?"}, {"id": 584, "euler_id": 584, "title": "Birthday Problem Revisited", "problem": "A long long time ago in a galaxy far far away, the Wimwians, inhabitants of planet WimWi, discovered an unmanned drone that had landed on their planet. On examining the drone, they uncovered a device that sought the answer for the so called \"Birthday Problem\". The description of the problem was as follows:\nIf people on your planet were to enter a very large room one by one, what will be the expected number of people in the room when you first find 3 people with Birthdays within 1 day from each other.\nThe description further instructed them to enter the answer into the device and send the drone into space again. Startled by this turn of events, the Wimwians consulted their best mathematicians. Each year on Wimwi has 10 days and the mathematicians assumed equally likely birthdays and ignored leap years (leap years in Wimwi have 11 days), and found 5.78688636 to be the required answer. As such, the Wimwians entered this answer and sent the drone back into space.\nAfter traveling light years away, the drone then landed on planet Joka. The same events ensued except this time, the numbers in the device had changed due to some unknown technical issues. The description read:\nIf people on your planet were to enter a very large room one by one, what will be the expected number of people in the room when you first find 3 people with Birthdays within 7 days from each other.\nWith a 100-day year on the planet, the Jokars (inhabitants of Joka) found the answer to be 8.48967364 (rounded to 8 decimal places because the device allowed only 8 places after the decimal point) assuming equally likely birthdays. They too entered the answer into the device and launched the drone into space again.\nThis time the drone landed on planet Earth. As before the numbers in the problem description had changed. It read:\nIf people on your planet were to enter a very large room one by one, what will be the expected number of people in the room when you first find 4 people with Birthdays within 7 days from each other.\nWhat would be the answer (rounded to eight places after the decimal point) the people of Earth have to enter into the device for a year with 365 days? Ignore leap years. Also assume that all birthdays are equally likely and independent of each other.", "solution": "32.83822408", "difficulty": 100, "story": "Once upon a time, in a small village on planet Earth, there lived a young boy named Alex. Alex was a curious child who loved exploring the mysteries of the world around him. Every day, he would go on adventures, searching for answers to the questions that filled his curious mind.\n\nOne sunny afternoon, as Alex was exploring the forests near his village, he stumbled upon a peculiar object hidden amongst the trees. It was a drone, emitting a soft, otherworldly glow. Intrigued, Alex picked it up, and to his surprise, it sprang to life, displaying a mysterious message on its screen.\n\nThe message described a mathematical problem called the \"Birthday Problem.\" Alex's eyes widened with excitement as he read the description, his mind racing to comprehend the meaning behind the words. He marveled at the notion of encountering people with birthdays close to each other and wondered about the patterns that might emerge.\n\nEager to solve the problem, Alex rushed home, carrying the drone all the while. He knew he needed the help of someone wiser, someone who could guide him through the intricate world of mathematics. And who better to ask for assistance than his wise old neighbor, Mr. Edgewater.\n\nMr. Edgewater was known throughout the village for his exceptional mathematical prowess. His gray hair, spectacles, and kind smile welcomed Alex as he entered the old man's study, his eyes fixed on the mysterious drone.\n\nAlex recounted the tale of his discovery and quickly shared the problem displayed on the device. Mr. Edgewater's eyes sparkled with excitement as his mind began to unravel the complexity of the situation.\n\nThey sat together, poring over calculations, theories, and equations. Days turned into weeks as they delved deeper into the mathematics that lay behind the problem. They considered probabilities and the intricacies of days within a year and pondered the chances of finding people with birthdays close together.\n\nFinally, the day arrived when they uncovered the answer. With bated breath, they prepared for the moment of truth. They entered their calculated solution into the drone and watched as it hummed and whirred, confirming their input.\n\nAlex and Mr. Edgewater sent the drone back into space, filled with excitement and anticipation. They hoped that their solution would provide answers to someone in need, somewhere out there in the vastness of space.\n\nMonths passed, and life in the village returned to normal. Alex continued his adventures, his mind still buzzing with the wonders of mathematics. But deep down, a burning question tugged at his curiosity.\n\nAs he gazed at the stars on a clear, moonlit night, a thought struck him. What if there were more people out there, seeking the answer to the same problem? What if, just like him, they stumbled upon this mysterious drone, searching for guidance?\n\nAnd so, dear reader, I ask you this: If people on Earth were to enter a vast room, one by one, what would be the expected number of people in the room when you first find four people with birthdays within seven days from each other? Rounded to eight decimal places, what answer must the people of Earth enter into the device?\n\nAs the night sky filled Alex's mind with wonder and endless possibilities, he couldn't help but wonder who else might be out there, yearning for answers. And he hoped, with all his heart, that they too would find solace in the complexities of mathematics, just as he did.\n\nSo, dear reader, can you unlock the secrets behind this mathematical riddle?"}, {"id": 585, "euler_id": 585, "title": "Nested square roots", "problem": "Consider the term x+y+z that is representing a nested square root. x, y and z are positive integers and y and z are not allowed to be perfect squares, so the number below the outer square root is irrational. Still it can be shown that for some combinations of x, y and z the given term can be simplified into a sum and/or difference of simple square roots of integers, actually denesting the square roots in the initial expression. \nHere are some examples of this denesting:\n3+2+2=2+1=2+1\n8+15+15=5+3\n20+96+12=9+6+3\u22122=3+6+3\u22122\n28+160+108=15+6+5\u22122\nAs you can see the integers used in the denested expression may also be perfect squares resulting in further simplification.\nLet F(n) be the number of different terms x+y+z, that can be denested into the sum and/or difference of a finite number of square roots, given the additional condition that 0<x\u2264n. That is,\nx+y+z=\u2211i=1ksiai\nwith k, x, y, z and all ai being positive integers, all si=\u00b11 and x\u2264n. Furthermore y and z  are not allowed to be perfect squares.\nNested roots with the same value are not considered different, for example 7+3+27, 7+12+12 and 7+27+3, that can all three be denested into 2+3, would only be counted once.\nYou are given that F(10)=17, F(15)=46, F(20)=86, F(30)=213 and F(100)=2918 and F(5000)=11134074.\nFind F(5000000).", "solution": "17714439395932", "difficulty": 100, "story": "Once upon a time, in the quiet village of Mathlandia, there lived a curious young girl named Alice. Alice had always been fascinated by numbers and often spent her days dreaming up mathematical puzzles and problems. Her favorite spot was a cozy nook in the village library, surrounded by books filled with the wonders of mathematics.\n\nOne sunny afternoon, as Alice ventured deeper into the library stacks, she stumbled upon an old leather-bound book that seemed to emit a subtle glow. Curiosity sparked in her eyes, she carefully dusted off the cover and began to read.\n\nTo her amazement, the book contained a collection of ancient mathematical riddles and challenges, written by the legendary Mathemagician. One problem in particular caught Alice's attention. It spoke of a special term, x+y+z, that could be simplified by denesting nested square roots. The book provided examples and a formula, but the true solution to the problem remained unknown.\n\nEager to unravel this mathematical mystery, Alice spent countless nights poring over the book's pages, studying the patterns, and attempting different combinations of x, y, and z. The answer seemed just out of reach, but she refused to give up.\n\nAs days turned into weeks, and weeks into months, Alice's obsession with the denesting problem grew. She began losing track of time and neglected her other responsibilities. The villagers, puzzled by her sudden withdrawal, grew concerned for their beloved young mathematician.\n\nOne day, a worried villager named Thomas approached Alice as she sat in her usual nook, surrounded by stacks of papers covered in intricate calculations. He gently tapped her on the shoulder, drawing her attention away from her mathematical musings.\n\n\"Alice, my dear, you've been locked away in this library for far too long,\" Thomas said kindly. \"We miss your enthusiasm, your laughter. What is it that has captivated you so?\"\n\nAlice took a deep breath and mustered a smile. \"Thomas, I've stumbled upon a mathematical problem unlike any other,\" she confessed. \"It has consumed my every thought, but I fear I've lost my way. I can't seem to find the solution.\"\n\nConcern replaced Thomas' friendly demeanor. \"Alice, my dear friend, remember the beauty of mathematics lies not only in the journey but also in the sharing of knowledge. Perhaps seeking help from others might offer new perspectives.\"\n\nAlice pondered Thomas' words. She realized that no problem was meant to be solved alone. Gathering her courage, she decided to share her predicament with the villagers, hoping that their collective wisdom might hold the key to the denesting problem.\n\nDays turned into weeks once again, but this time, Alice wasn't alone. The villagers rallied behind her, brainstorming ideas, participating in discussions, and even offering their own insights. Their collective effort reminded Alice that sometimes, the solution to a problem lies not in isolation but in collaboration.\n\nAs their discussions intensified, Alice's mind began to race with new possibilities. The villagers' input sparked new connections and inspired fresh approaches. The denesting problem was no longer an obsession for Alice alone; it had become a shared passion that united the entire village.\n\nAnd so, with every passing day, Alice and the villagers worked tirelessly. They filled blackboards with equations, scribbled in notebooks long into the night, and exchanged ideas over countless cups of steaming tea. Their dedication and determination knew no bounds.\n\nFinally, one evening, as Alice walked home, her mind buzzing with newfound clarity, she stopped in her tracks. A profound sense of achievement washed over her, as if she had glimpsed the solution to the denesting problem. Excitement filled her heart, the thrill of discovery tingling in every fiber of her being.\n\nAlice couldn't wait to share her revelation with the villagers, to witness their joy and astonishment. But even more, she longed to pose a final question, one that would ignite their curiosity and challenge their mathematical prowess.\n\nHer steps quickened until she reached the village square, where she gathered everyone around under the warm glow of the streetlights. With a beaming smile, Alice took a deep breath and stood before them.\n\n\"My dear friends,\" she began, her voice filled with heartfelt gratitude, \"we have embarked on a mathematical journey together, solving the denesting problem step by step. And now, standing here before you, I hold in my hands the key to unlock the answer. But before us lies one final riddle, one final challenge.\"\n\nThe villagers leaned in, their faces a mix of anticipation and excitement.\n\n\"What is F(5,000,000)?\" Alice asked, her voice ringing with mystery and anticipation. \"How many different terms x+y+z can be denested into the sum and/or difference of square roots, with all the given conditions?\"\n\nSilence fell over the village square as the villagers processed Alice's question. Their eyes gleamed with determination, their minds already racing with possibilities.\n\nAnd so, the villagers of Mathlandia, inspired by their young prodigy Alice, dove back into the realms of numbers and mathematics. Armed with tenacity, ingenuity, and the spirit of collaboration, they set forth on a new journey, ready to unveil the grand solution to the denesting problem.\n\nOnly time would tell if their efforts would yield the answer they sought or if they would need to dig even deeper, exploring the boundless depths of mathematics. But what if they succeeded? What if they discovered the answer to F(5,000,000) and all its extraordinary intricacies?\n\nReader, I leave you with a question. Can you solve the denesting problem and find F(5,000,000)?"}, {"id": 597, "euler_id": 597, "title": "Torpids", "problem": "The Torpids are rowing races held annually in Oxford, following some curious rules:\n\n\nA division consists of n boats (typically 13), placed in order based on past performance.\n\nAll boats within a division start at 40 metre intervals along the river, in order with the highest-placed boat starting furthest upstream.\n\nThe boats all start rowing simultaneously, upstream, trying to catch the boat in front while avoiding being caught by boats behind.\n\nEach boat continues rowing until either it reaches the finish line or it catches up with (\"bumps\") a boat in front.\n\nThe finish line is a distance L metres (the course length, in reality about 1800 metres) upstream from the starting position of the lowest-placed boat. (Because of the staggered starting positions, higher-placed boats row a slightly shorter course than lower-placed boats.)\n\nWhen a \"bump\" occurs, the \"bumping\" boat takes no further part in the race. The \"bumped\" boat must continue, however, and may even be \"bumped\" again by boats that started two or more places behind it.\n\nAfter the race, boats are assigned new places within the division, based on the bumps that occurred. Specifically, for any boat A that started in a lower place than B, then A will be placed higher than B in the new order if and only if one of the following occurred:\n   A bumped B directly \n A bumped another boat that went on to bump B \n A bumped another boat, that bumped yet another boat, that bumped B \n etc NOTE: For the purposes of this problem you may disregard the boats' lengths, and assume that a bump occurs precisely when the two boats draw level. (In reality, a bump is awarded as soon as physical contact is made, which usually occurs when there is much less than a full boat length's overlap.)\n\n\nSuppose that, in a particular race, each boat Bj rows at a steady speed vj=\u2212logXj metres per second, where the Xj are chosen randomly (with uniform distribution) between 0 and 1, independently from one another. These speeds are relative to the riverbank: you may disregard the flow of the river.\n\n\nLet p(n,L) be the probability that the new order is an even permutation of the starting order, when there are n boats in the division and L is the course length.\n\n\nFor example, with n=3 and L=160, labelling the boats as A,B,C in starting order with C highest, the different possible outcomes of the race are as follows:\n\n Bumps occurring \n New order \n Permutation \n Probability \n none \n A, B, C \n even \n 4/15 \n B bumps C \n A, C, B \n odd \n 8/45 \n A bumps B \n B, A, C \n odd \n 1/3 \n \u00a0 \u00a0 B bumps C, then A bumps C \u00a0 \u00a0 \n C, A, B \n even \n 4/27 \n \u00a0 \u00a0 A bumps B, then B bumps C \u00a0 \u00a0 \n C, B, A \n odd \n 2/27 \n\nTherefore, p(3,160)=4/15+4/27=56/135.\n\n\nYou are also given that p(4,400)=0.5107843137, rounded to 10 digits after the decimal point.\n\n\nFind p(13,1800) rounded to 10 digits after the decimal point.\n", "solution": "0.5001817828", "difficulty": 100, "story": "Once upon a time, in the quaint town of Oxford, there existed an annual event that captivated both locals and visitors. The Torpids, a series of rowing races, took place on the serene river that flowed through the heart of the town. Every year, the Torpids drew in a crowd eager to witness the immense strength and competitive spirit of the rowers.\n\nThis year was no different. The excitement hung in the air as thirteen boats were lined up along the riverbank, their positions determined by past performance. The boats, each named after the prestigious colleges they represented, eagerly awaited the start of the race. The tension was palpable.\n\nAs the race commenced, the rowers synchronized their oars, their collective efforts propelling the slender boats upstream. The coxswains barked commands, urging their teams to reach greater speeds. The river bore witness to their determination.\n\nAmong the boats was Christ Church, a formidable presence known for its impeccable rowing record. Led by their talented coxswain, Alice, Christ Church had always been a contender for the top spot. This year, Alice had a plan - a daring strategy that required careful calculation.\n\nUnknown to her teammates, Alice possessed a deep understanding of mathematics, having studied the subject alongside her rowing commitments. She reveled in the challenges presented by the Torpids, where strategy and calculations were just as important as physical strength.\n\nAlice had come across a mathematical conundrum known as the probability of the new order being an even permutation of the starting order. She had always been intrigued by its implications but had never found a practical application for it. Until now.\n\nThe length of the course, L, was an essential factor in determining the probability. Alice's mind whirred with calculations as she rowed, desperately trying to solve the problem in real-time. She knew that obtaining the solution would require analyzing the bumps and their consequences meticulously.\n\nAs the race progressed, Alice's heart pounded with a mix of anticipation and nervousness. The other boats were closing in, and she needed to execute her plan flawlessly. She had identified two boats ahead of Christ Church as hurdles, their positions crucial in determining the possibility of an even permutation of the starting order.\n\nWith each passing stroke, Alice pushed her team onwards, never wavering in her resolve. She knew that if she bumped into one of the targeted boats, a chain reaction might occur, setting off a series of events that could land Christ Church in a favorable position.\n\nAs they approached the halfway point, Alice's eyes locked onto the first boat on her list. She willed her teammates to give their all, their strength and determination pouring into each stroke. The gap between the boats closed, and in a final burst of energy, they collided, drawing level.\n\nThe other boat, unable to continue, floated downstream while Christ Church surged forward. The chain reaction Alice had envisioned had begun. The ripple effect might yet determine their fate.\n\nWith grit and determination, Alice steered her boat, influencing the trajectory of the race. The second targeted boat was within reach, and Alice summoned her remaining strength, hoping to position Christ Church for an advantageous outcome.\n\nAs the race drew to a close, exhaustion seeped into the rowers' bones. The finishing line, L meters upstream, seemed further away than ever before. Yet, Alice's calculations fueled her determination, urging her team onward.\n\nWith the last ounce of strength, Christ Church crossed the finish line, having successfully bumped into the targeted boat. The race was over, leaving an air of exhilaration and anticipation lingering.\n\nAs the boats docked, Alice reveled in their success but couldn't help pondering the probability she had grappled with for so long. What would be the likelihood of the new order being an even permutation of the starting order? She yearned for the answer, for a way to measure their accomplishment beyond the cheers of the crowd.\n\nAlice turned to her teammates, a knowing smile lighting up her face. The question remained unsolved, a lingering challenge that brought an added layer of mystery and intrigue to their triumph.\n\nAs the rowers celebrated their victory, Alice couldn't help but wonder - what would be the rounded probability, p(13, 1800), of the new order being an even permutation of the starting order?\n\nAnd so, dear reader, I pose the same question to you. Can you solve this mathematical puzzle, one that holds the key to the triumph of Christ Church and the countless other rowing teams that compete in the Torpids?"}, {"id": 696, "euler_id": 696, "title": "Mahjong", "problem": "The game of Mahjong is played with tiles belonging to s suits. Each tile also has a number in the range 1\u2026n, and for each suit/number combination there are exactly four indistinguishable tiles with that suit and number. (The real Mahjong game also contains other bonus tiles, but those will not feature in this problem.)\nA winning hand is a collection of 3t+2 Tiles (where t is a fixed integer) that can be arranged as t Triples and one Pair, where:\nA Triple is either a Chow or a Pung\nA Chow is three tiles of the same suit and consecutive numbers\nA Pung is three identical tiles (same suit and same number)\nA Pair is two identical tiles (same suit and same number)\nFor example, here is a winning hand with n=9, s=3, t=4, consisting in this case of two Chows, two Pungs, and one Pair:\n\n\nNote that sometimes the same collection of tiles can be represented as t Triples and one Pair in more than one way. This only counts as one winning hand. For example, this is considered to be the same winning hand as above, because it consists of the same tiles:\n\n\nLet w(n,s,t) be the number of distinct winning hands formed of t Triples and one Pair, where there are s suits available and tiles are numbered up to n.\nFor example, with a single suit and tiles numbered up to 4, we have w(4,1,1)=20: there are 12 winning hands consisting of a Pung and a Pair, and another 8 containing a Chow and a Pair. You are also given that w(9,1,4)=13259, w(9,3,4)=5237550, and w(1000,1000,5)\u2261107662178(mod1000000007).\nFind w(108,108,30). Give your answer modulo 1000000007.", "solution": "436944244", "difficulty": 100, "story": "Once upon a time in the mystical land of Mahjong, there lived a talented young wizard named Lily. Lily possessed incredible magical abilities and had dedicated her life to mastering the art of Mahjong. She had traveled far and wide, learning from the best Mahjong players, and had become renowned for her extraordinary skills.\n\nOne day, Lily stumbled upon an ancient scroll that contained a mathematical problem related to the game of Mahjong. As she read the problem, her curiosity grew, and she couldn't help but be intrigued. The problem stated that a winning hand in Mahjong consisted of t Triples and one Pair, with each tile having a specific suit, number, and four identical copies.\n\nIntrigued by the challenge, Lily pondered over the problem. She realized that the number of distinct winning hands varied with the number of suits available and the range of numbers on the tiles. It fascinated her how even a slight change in variables could lead to a completely different outcome.\n\nAs she delved deeper into the problem, Lily began to understand its significance. The problem held clues to unlocking the hidden secrets of Mahjong. If she could find the solution, it would enhance her ability to decipher the complex patterns and strategies of the game.\n\nDetermined to unravel the mysteries of Mahjong, Lily embarked on a grand adventure through the vibrant landscapes of the land. She journeyed through dense forests, treacherous mountains, and serene valleys, encountering various challenges and obstacles along the way.\n\nWith every step, Lily's understanding of the mathematical problem grew. She realized that it wasn't just a mere puzzle but a key to enhancing her magical abilities. The more she unraveled the complexities of the problem, the stronger her connection became with the energy flowing through the Mahjong tiles.\n\nFinally, after months of arduous exploration, Lily reached the peak of the highest mountain in Mahjong. She stood at the edge, overlooking the vast kingdom beneath her. The wind whispered as she opened the ancient scroll one more time.\n\nThe problem posed one final question, \"Find w(108,108,30). Give your answer modulo 1000000007.\"\n\nLily's heart raced with excitement and anticipation. She knew that finding the solution to this complex problem would unlock unimaginable powers for her as a Mahjong wizard. With renewed determination, she set off on her next quest: to solve the mathematical puzzle and harness the true potential of Mahjong.\n\nAnd so, dear reader, I leave you with this question: Can you help Lily find the answer to the mathematical problem and unlock the secrets of Mahjong? Will you be able to determine w(108,108,30) modulo 1000000007? The destiny of Mahjong's magical realm is in your hands."}, {"id": 763, "euler_id": 763, "title": "Amoebas in a 3D grid", "problem": "\nConsider a three dimensional grid of cubes. An amoeba in cube (x,y,z) can divide itself into three amoebas to occupy the cubes (x+1,y,z), (x,y+1,z) and (x,y,z+1), provided these cubes are empty.\n\n\nOriginally there is only one amoeba in the cube (0,0,0). After N divisions there will be 2N+1 amoebas arranged in the grid. An arrangement may be reached in several different ways but it is only counted once. Let D(N) be the number of different possible arrangements after N divisions.\n\n\nFor example, D(2)=3, D(10)=44499, D(20)=9204559704 and the last nine digits of D(100) are 780166455.\n\n\nFind D(10000), enter the last nine digits as your answer.\n", "solution": "798443574", "difficulty": 100, "story": "Once upon a time, in a land far, far away, there existed a magical forest called Cubatrix. Deep within the heart of this enchanted forest, a peculiar creature known as the Amoeba resided. This peculiar creature possessed the unique ability to multiply itself through a process known as division.\n\nIn Cubatrix, there was a three-dimensional grid of cubes, each representing a potential dwelling place for an Amoeba. The coordinates of each cube in this magical grid were denoted by (x, y, z), with x, y, and z representing integers. The Amoeba had the incredible capability to divide itself into three smaller Amoebas, which could then occupy the adjacent cubes\u2014specifically, the cubes (x+1, y, z), (x, y+1, z), and (x, y, z+1)\u2014provided they were empty.\n\nWithin this mystical realm lived a diligent young Amoeba named Ana. Ana was an adventurer at heart who had always felt a yearning to explore the vastness of Cubatrix. She dreamt of discovering new lands, encountering fascinating creatures, and experiencing the wonders of the forest firsthand.\n\nOne sunny morning, as the early rays of sunlight pierced through the Canopy of Giants, Ana set off on her grand adventure. Her journey started at the very origin of the grid, the cube (0, 0, 0), which was home to a single Amoeba\u2014Ana herself. However, she was not content with simply remaining within the confines of her starting position. She longed to expand her reach and leave a lasting mark on the wondrous forest.\n\nAs Ana ventured deeper into Cubatrix, she performed her unique feat of division numerous times, multiplying herself and extending her reach across all corners of the grid. Each time Ana divided, she would populate the three adjacent empty cubes with her offspring, bringing forth new life to the forest.\n\nAna's divisions became progressively more incredible and complex as she plunged deeper into Cubatrix. The number of different possible arrangements multiplied exponentially with each division she performed. Mathematicians would later ponder the precise number of arrangements, represented as D(N), where N symbolized the number of divisions made by the courageous Amoeba.\n\nIntriguingly, D(N) denoted the total number of distinct arrangements attainable after N divisions. These arrangements could be reached through various paths and approaches. For instance, D(2) was determined to be 3, D(10) equaled 44499, and D(20) stood at an astonishing 9204559704. The last nine digits of D(100) were unveiled to be 780166455, leaving mathematicians and inquisitive minds in awe of Cubatrix's wonders.\n\nNow, as you delve into this tale, dear reader, I pose a question for your agile mind to unravel. I leave you with the ultimate journey\u2014the astounding expedition of D(10000). Can you find the last nine digits of the countless arrangements that shall emerge from the courageous Ana? Can you decipher the mystical code that lies within the breathtaking Cubatrix?"}, {"id": 780, "euler_id": 780, "title": "Toriangulations", "problem": "For positive real numbers a,b, an a\u00d7b torus is a rectangle of width a and height b, with left and right sides identified, as well as top and bottom sides identified. In other words, when tracing a path on the rectangle, reaching an edge results in \"wrapping round\" to the corresponding point on the opposite edge.\nA tiling of a torus is a way to dissect it into equilateral triangles of edge length 1. For example, the following three diagrams illustrate respectively a 1\u00d732 torus with two triangles, a 3\u00d71 torus with four triangles, and an approximately 2.8432\u00d72.1322 torus with fourteen triangles:\n\n\n\n\n\nTwo tilings of an a\u00d7b torus are called equivalent if it is possible to obtain one from the other by continuously moving all triangles so that no gaps appear and no triangles overlap at any stage during the movement. For example, the animation below shows an equivalence between two tilings:\n\n\n\nLet F(n) be the total number of non-equivalent tilings of all possible tori with exactly n triangles. For example, F(6)=8, with the eight non-equivalent tilings with six triangles listed below:\n\n\n\nLet G(N)=\u2211n=1NF(n). You are given that G(6)=14, G(100)=8090, and G(105)\u2261645124048(mod1000000007).\nFind G(109). Give your answer modulo 1000000007.", "solution": "613979935", "difficulty": 100, "story": "Once upon a time in the small village of Torusville, there lived a young girl named Lily. Lily was known for her exceptional intelligence, particularly her love for mathematics. She would spend hours poring over equations and formulas, finding joy in unraveling the mysteries of numbers.\n\nOne sunny afternoon, as Lily was walking through the village, she stumbled upon a peculiar sight. A group of villagers were gathered around a man holding up a large piece of paper with intricate designs on it. Curiosity piqued, she made her way over to see what was going on.\n\nThe man, whose name was Professor Matheson, noticed Lily's enthusiasm for mathematics and beamed at her. \"Ah, my dear, you have arrived just in time,\" he exclaimed, beckoning her closer. \"I have discovered a fascinating mathematical problem, and I believe you are the perfect person to help solve it.\"\n\nIntrigued, Lily listened as Professor Matheson explained the concept of tori and their tiling. He showed her countless examples, explaining how the triangles fit perfectly within the torus, creating patterns that were both stunning and mathematically intricate.\n\nLily's eyes lit up with excitement. She immediately understood the essence of the problem, realizing that it involved not only the beauty of mathematics but also the creativity of visualizing different shapes and patterns. Professor Matheson handed her a notebook and pen, urging her to explore the problem further and discover its secrets.\n\nOver the next few weeks, Lily dedicated herself to the study of tori and their tilings. She spent countless hours sketching and experimenting, trying to find patterns within the shapes. The villagers marveled at her determination and talent, admiring how she effortlessly weaved intricate mathematical solutions into the tapestry of their lives.\n\nAs Lily delved deeper into the problem, she began to uncover connections between the number of triangles and the possibilities for tiling the torus. She realized that each tiling was unique in its own way, offering a different perspective on the torus's infinite possibilities.\n\nThe village soon became a hub of mathematical exploration. People from far and wide came to witness Lily's discoveries and learn from her expertise. Torusville became known as the land where mathematics came alive, where the enigmatic relationship between shapes and patterns danced joyously.\n\nAs the years passed, Lily continued to push the boundaries of mathematical knowledge. She published papers, won awards, and became a renowned mathematician. But even in her success, her heart longed for the fulfillment that solving the tori tiling problem had once brought her.\n\nOne day, as Lily was enjoying a quiet walk through the village, she stumbled upon an old, forgotten piece of parchment. The edges were worn, and the ink had faded over time. Curiosity awakened, she picked it up and unfolded it gently.\n\nTo her surprise, the parchment contained an incomplete equation, one that seemed to be the missing piece of her tori tiling problem. Elation filled her heart as she realized that the puzzle she had longed to solve for years might finally come to an end. But there was a catch\u2014the equation lacked the solution.\n\nLily's mind raced with excitement and determination. It was as if the universe had presented her with a final challenge, one that could only be conquered by unlocking the power of numbers. She knew what she had to do. With a renewed zeal, she gathered her notebooks and returned to her studies.\n\nMonths turned into years as Lily dove deeper and deeper into the equation's mysteries. She formed hypotheses, tested theories, and calculated endlessly, desperate to complete her life's work. The villagers watched in awe, supporting her every step of the way.\n\nNow, dear reader, I leave you with this question: Can you help Lily complete the equation and solve the tori tiling problem once and for all? In your hands lies the power to unlock the secrets of the torus and forever change the landscape of mathematics. Are you ready to embrace this challenge?"}, {"id": 792, "euler_id": 792, "title": "Too Many Twos", "problem": "\nWe define \u03bd2(n) to be the largest integer r such that 2r divides n. For example, \u03bd2(24)=3.\n\n\nDefine S(n)=\u2211k=1n(\u22122)k(2kk) and u(n)=\u03bd2(3S(n)+4).\n\n\nFor example, when n=4 then S(4)=980 and 3S(4)+4=2944=27\u22c523, hence u(4)=7.\nYou are also given u(20)=24.\n\n\nAlso define U(N)=\u2211n=1Nu(n3). You are given U(5)=241.\n\n\nFind U(104).\n", "solution": "2500500025183626", "difficulty": 100, "story": "Once upon a time in the magical kingdom of Numeria, there lived a young sorcerer named Atlas. Atlas was not like your ordinary sorcerer; he had a deep passion for mathematics and loved solving complex problems. His greatest dream was to unlock the secrets of the universe through the power of numbers.\n\nAtlas spent his days poring over ancient scrolls and textbooks, seeking out hidden mathematical truths. One day, he stumbled upon a perplexing problem that instantly captivated his attention. The problem went as follows:\n\n\"We define \u03bd2(n) to be the largest integer r such that 2r divides n. For example, \u03bd2(24)=3.\n\nDefine S(n)=\u2211k=1n(\u22122)k(2kk) and u(n)=\u03bd2(3S(n)+4).\n\nFor example, when n=4, then S(4)=980 and 3S(4)+4=2944=27\u22c523, hence u(4)=7.\n\nYou are also given u(20)=24.\n\nAlso define U(N)=\u2211n=1Nu(n3). You are given U(5)=241.\n\nFind U(104).\"\n\nAtlas knew that this problem held the key to unraveling a grand mystery. As he delved deeper into the problem, he discovered that S(n) represented the sum of a unique series where each subsequent term decreased in magnitude but still maintained a pattern. He was astounded by the intricacy of this mathematical marvel.\n\n\"Just a single mathematical problem, but it holds so much power,\" Atlas murmured to himself. His mind raced with the possibilities of what this problem could unveil about their world.\n\nIn the kingdom of Numeria, the harmony and balance of everything were governed by the divine equation known as the Prime Formula. Atlas believed that solving the problem would grant him unprecedented knowledge about the Prime Formula and bring him one step closer to his ultimate aspiration of uncovering the secrets of the universe.\n\nDriven by his insatiable curiosity, Atlas embarked on a quest to solve this problem. He travelled to the Great Library of Numeria, where he sought the guidance of the wise mathematicians who had come before him. Together, they deciphered the intricacies of S(n) and u(n), poring over countless ancient manuscripts and sharing their insights.\n\nDays blurred into nights, and nights into days as Atlas and his fellow mathematicians worked tirelessly to crack the enigma. They devised new techniques, applied mathematical concepts from various disciplines, and pushed the boundaries of their understanding.\n\nFinally, after weeks of relentless effort, Atlas found a breakthrough. Extending his arm excitedly towards the heavens, he shouted, \"Eureka! I have unlocked the path to U(104)!\"\n\nHis discovery shook the academic world of Numeria to its core. The revelation had the power to reshape the kingdom's understanding of mathematics and unlock new possibilities for the sorcerers. It became the talk of the kingdom, buzzing with anticipation and curiosity.\n\nBut as Atlas prepared to present his findings to the kingdom, a seed of doubt took root within him. What if his solution was incorrect? What if he had made an error in his calculations? The weight of responsibility bore down on him, and he feared his mistake might lead countless others astray.\n\nIn the quiet of his study, with stacks of books surrounding him, Atlas hesitated. He knew his solution could change the course of history, yet the fear of error paralyzed him.\n\nAnd so, dear reader, we come to the end of our tale. Will Atlas overcome his doubts and present his solution to the kingdom? Or will he linger in the shadow of uncertainty, forever unsure of his mathematical prowess?\n\nThe question looms larger than ever before: What is the value of U(104)?"}, {"id": 798, "euler_id": 798, "title": "Card Stacking Game", "problem": "\nTwo players play a game with a deck of cards which contains s suits with each suit containing n cards numbered from 1 to n.\n\nBefore the game starts, a set of cards (which may be empty) is picked from the deck and placed face-up on the table, with no overlap. These are called the visible cards.\n\nThe players then make moves in turn.\nA move consists of choosing a card X from the rest of the deck and placing it face-up on top of a visible card Y, subject to the following restrictions:\n\nX and Y must be the same suit;\nthe value of X must be larger than the value of Y.\n\n\nThe card X then covers the card Y and replaces Y as a visible card.\nThe player unable to make a valid move loses and play stops.\n\nLet C(n,s) be the number of different initial sets of cards for which the first player will lose given best play for both players.\n\nFor example, C(3,2)=26 and C(13,4)\u2261540318329(mod1000000007).\n\nFind C(107,107). Give your answer modulo 1000000007.", "solution": "132996198", "difficulty": 100, "story": "Once upon a time, in the mystical Kingdom of Numeria, there lived two young adventurers named Lily and Max. They were avid card players and loved to engage in games that challenged their minds. One day, while exploring the enchanted forests of Numeria, they stumbled upon a hidden treasure\u2014a deck of cards unlike any they had ever seen before.\n\nThis magical deck had an intriguing twist. It contained various suits, but instead of the usual numbers, each suit had a set of cards numbered from 1 to n. The cards were beautifully adorned with intricate designs, reflecting the wonders of the kingdom. Curiosity brimming within them, Lily and Max decided to play a game with these unique cards.\n\nBefore they began, they carefully spread the entire deck on the table, face-up, allowing the vibrant cards to captivate their attention. Lily, with her sharp mind, observed the intricate patterns and realized that the game involved choosing cards to cover and replace the face-up cards based on certain rules.\n\nAs they meticulously examined the deck, Lily explained that they had to find a card from the remaining deck that belonged to the same suit as a face-up card and had a higher value. It meant that only cards with larger numbers could replace those visible on the table. This fascinating twist piqued their interest, and they eagerly began their game.\n\nThey took turns seamlessly, placing cards from the deck onto the table. Each move required careful consideration\u2014a strategic balance of suit and value. As their hands danced across the table, Lily and Max's excitement grew. It was not merely about winning, but about the challenge, the thrill of outsmarting each other at their own game.\n\nAs their game progressed, they discovered that Lily's analytical skills greatly influenced the outcome of their battles. She calculated the possible moves, considering different initial sets of cards, visualizing the outcomes, and making decisions that maximized her chances of winning. Max admired her abilities and respected her as a worthy opponent.\n\nTheir game continued for hours. The deck grew smaller as the number of visible cards increased. Both players pondered their moves deeply, their eyes fixed on the vibrant array splayed before them. They could feel the energy of Numeria resonating through their fingertips.\n\nAlas, the time came when Lily had exhausted all possible moves. She was unable to find any card that fulfilled both the suit and value conditions simultaneously. In that moment, while disappointment tinged her expression, a smile danced on Max's face\u2014he had won the game.\n\nAs the sun began to set, casting hues of orange and purple upon the tabletop, Lily and Max contemplated the game they had just played. They realized that the outcome had relied heavily on the number of different initial sets of cards that led to victory or defeat. Their minds swirled with curiosity, longing to comprehend the vastness of the possibilities, of the mathematical beauty hidden within their game.\n\nWith a gleam in her eyes, Lily turned to Max and asked, \"What do you think, dear friend? How many different initial sets of cards exist that would ensure your victory against me, given the same rules and best play by both of us?\"\n\nMax's gaze fixed on the horizon as he pondered her question. The mystical world of Numeria had shown them wonders beyond their wildest dreams, and now, they were poised to reveal the secrets that lie within this magical deck."}]