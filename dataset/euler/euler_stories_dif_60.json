[{"id": 141, "euler_id": 141, "title": "Investigating progressive numbers, n, which are also square", "problem": "A positive integer, n, is divided by d and the quotient and remainder are q and r respectively. In addition d, q, and r are consecutive positive integer terms in a geometric sequence, but not necessarily in that order.\nFor example, 58 divided by 6 has quotient 9 and remainder 4. It can also be seen that 4, 6, 9 are consecutive terms in a geometric sequence (common ratio 3/2).\nWe will call such numbers, n, progressive.\nSome progressive numbers, such as 9 and 10404 = 1022, happen to also be perfect squares. The sum of all progressive perfect squares below one hundred thousand is 124657.\nFind the sum of all progressive perfect squares below one trillion (1012).", "solution": "878454337159", "difficulty": 60, "story": "Once upon a time in the quaint village of Mathlandia, there lived a young girl named Juniper. Juniper had always been fascinated by numbers and patterns, spending countless hours exploring algebraic equations and solving complex mathematical problems. One sunny afternoon, as she walked through the village, she stumbled upon an old, dusty book in a forgotten corner of the local library.\n\nCurious and filled with excitement, Juniper blew away the layer of dust that had settled on the book's cover. In beautifully engraved letters, she read, \"The Mystery of Progressive Perfect Squares.\" With a twinkle in her eyes, she knew she had uncovered something special.\n\nShe rushed back home and eagerly delved into the book's contents. There, she discovered a mathematical problem that would change her life forever. It read, \"A positive integer, n, is divided by d, and the quotient and remainder are q and r respectively. In addition, d, q, and r are consecutive positive integer terms in a geometric sequence, but not necessarily in that order.\"\n\nAs Juniper read the example provided in the book, she couldn't help but visualize the numbers in her mind. She pictured the division of 58 by 6, resulting in the quotient 9 and the remainder 4. Juniper marveled at how 4, 6, and 9 were indeed consecutive terms in a geometric sequence with a common ratio of 3/2. These numbers were progressive!\n\nThe book continued, stating that some progressive numbers, like 9 and 10404, were perfect squares. Juniper's eyes widened as she glanced at the sum of all progressive perfect squares below one hundred thousand \u2013 124657.\n\nThe discovery filled her with an insatiable curiosity. She wondered if there were more progressive perfect squares out there, and if so, what their collective sum might be. Juniper knew that if she could find the answer, she would uncover the secrets of mathematics that lay hidden within the pages of the book.\n\nDetermined to embark on this mathematical adventure, Juniper spent days and nights engrossed in numbers and sequences. Armed with her pen, paper, and an unwavering spirit for discovery, she calculated the sums of progressive perfect squares using every method she knew.\n\nDays turned into weeks, and weeks turned into months. Juniper found herself consumed by numbers, exploring countless possibilities and testing various hypotheses. The village of Mathlandia buzzed with stories of the young girl's quest, and the villagers marveled at her unwavering dedication.\n\nEventually, Juniper's hard work paid off. With one trillion listed as her final target in the book, she found herself on the precipice of a monumental breakthrough. As the sun dipped below the horizon, she leaned back in her chair, pondering the sum of all progressive perfect squares below one trillion.\n\nIt was at this moment that Juniper realized the significance of her quest. Not only had she discovered the beauty of mathematical patterns, but she also recognized the importance of perseverance and determination in pursuit of knowledge. The sum she sought was not just of numbers; it represented the endless possibilities that lay within the realm of mathematics.\n\nHer heart swelling with excitement, Juniper made a vow to continue her endeavor until she had found the elusive answer. And so, dear reader, I leave you with this question: Can you find the sum of all progressive perfect squares below one trillion?\n\nAs Juniper continued her journey into the world of mathematics, she knew that the answer lay within reach, waiting to be unveiled. Will you join her in this pursuit, unlocking the secrets of progressive perfect squares, and unraveling the enigmatic beauty of numbers?"}, {"id": 155, "euler_id": 155, "title": "Counting Capacitor Circuits", "problem": "An electric circuit uses exclusively identical capacitors of the same value C.\n\nThe capacitors can be connected in series or in parallel to form sub-units, which can then be connected in series or in parallel with other capacitors or other sub-units to form larger sub-units, and so on up to a final circuit.\nUsing this simple procedure and up to n identical capacitors, we can make circuits having a range of different total capacitances. For example, using up to n=3 capacitors of 60 \u03bc F each, we can obtain the following 7 distinct total capacitance values: \n\nIf we denote by D(n) the number of distinct total capacitance values we can obtain when using up to n equal-valued capacitors and the simple procedure described above, we have: D(1)=1, D(2)=3, D(3)=7 ...\nFind D(18).\nReminder : When connecting capacitors C1, C2 etc in parallel, the total capacitance is CT\u00a0=\u00a0C1\u00a0+\u00a0C2\u00a0+...,\n\nwhereas when connecting them in series, the overall capacitance is given by: 1CT=1C1+1C2+...", "solution": "3857447", "difficulty": 60, "story": "Once upon a time in a small town nestled in the hills, there lived a curious young girl named Lily. Lily had a passion for science and a keen interest in how things worked. Her favorite subject was electricity, especially circuits. She loved learning about all the different components that made up an electrical circuit and the intricate ways in which they interacted.\n\nOne day, while attending a science fair in the neighboring city, Lily came across a peculiar exhibit. There, in the midst of a sea of contraptions, stood a man with a white lab coat and a mischievous twinkle in his eye. His name was Professor Albert, a renowned electrical engineer.\n\nLily was instantly drawn to Professor Albert's exhibit. It was a display of various complex circuits, each with a multitude of capacitors connected in different ways. The professor explained that capacitors, like the ones on display, store electrical energy and are an essential component of many electrical systems.\n\nIntrigued, Lily asked, \"Professor Albert, can you tell me how capacitors can be connected to form different circuits?\"\n\n\"Of course, my young friend,\" the professor replied with a smile. \"Capacitors can be connected in two ways \u2013 in series or in parallel. When connected in parallel, the total capacitance equals the sum of the individual capacitor values. And when connected in series, the overall capacitance is given by the reciprocal of the sum of the reciprocals of each capacitor value.\"\n\nLily's eyes sparkled with excitement as she tried to wrap her head around the concept. She knew she had to experiment with it herself.\n\nBack in her humble attic laboratory, Lily started gathering capacitors of the same value, C. She was eager to discover how many distinct total capacitance values she could achieve by connecting them in various ways. Lily embarked on a journey of exploration, connecting capacitors in series and parallel, forming sub-units, and joining them together to create larger sub-units.\n\nAs days turned into weeks and weeks into months, Lily's attic laboratory was filled with intricate circuits and a sense of wonder. She was astounded by the patterns she observed. With just one capacitor, she could only create one distinct total capacitance value. With two capacitors, she could now achieve three distinct values. And with three capacitors, she discovered seven unique total capacitance values.\n\nDriven with a thirst for knowledge, Lily continued her experimentation. She connected four capacitors and found fifteen different values. Five capacitors led to thirty-one, and six capacitors resulted in sixty-three distinctive values.\n\nLily couldn't help but wonder, \"If I keep going, how many distinct total capacitance values can I achieve with eighteen capacitors?\"\n\nHer mind spun with the possibilities, as she imagined the intricate circuit she could create. Lily knew that the answer to this question held the essence of her entire experiment. It was the climax of her journey and the mystery that fueled her curiosity.\n\nAnd so, with a determined glint in her eye, Lily embarked on her most ambitious project yet. She would connect eighteen identical capacitors in various ways, exploring every permutation and combination, hoping to unravel the secrets of her curiosity.\n\nAs she soldered wires and twisted knobs, a sense of anticipation filled the air. Each connection she made added to the complexity of the circuit, bringing her closer to the answer she desired. Lily's heart raced with excitement, and her mind buzzed with anticipation.\n\nFinally, the circuit was complete. Eighteen capacitors were intertwined in a mesmerizing pattern, stretching across her attic laboratory. They formed a beautiful web of potential and possibility. The distinct total capacitance values that lay within this circuit danced in Lily's imagination, waiting to be discovered.\n\nBut as Lily stared at her creation, her eyes gleaming with joy, she couldn't help but pause. Her mind whispered a question that would shape her future, \"What is the value of D(18)? How many distinct total capacitance values can I achieve with eighteen equal-valued capacitors?\"\n\nThe answer to this question would not only satisfy Lily's curiosity but would unlock a world of new possibilities in the field of electrical engineering. It was a mathematical problem that would challenge the brightest minds and inspire generations to come.\n\nAs Lily sat surrounded by her creation, she basked in the warm glow of her ambition and the infinite potential of her circuit. And she knew, deep in her heart, that the answer to her question held the key to unlocking the wonders of the universe.\n\nAnd so, dear reader, I leave you with this question \u2013 What is the value of D(18)? How many distinct total capacitance values can Lily achieve with eighteen equal-valued capacitors?\n\nMay your thoughts spark with curiosity, and your imagination soar with the possibilities. The answer lies within the realm of mathematics, waiting to be discovered by an inquisitive mind."}, {"id": 159, "euler_id": 159, "title": "Digital root sums of factorisations", "problem": "A composite number can be factored many different ways.  \nFor instance, not including multiplication by one, 24 can be factored in 7 distinct ways:\n\n24 = 2x2x2x3\n24 = 2x3x4\n24 = 2x2x6\n24 = 4x6\n24 = 3x8\n24 = 2x12\n24 = 24\n\nRecall that the digital root of a number, in base 10, is found by adding together the digits of that number, \nand repeating that process until a number is arrived at that is less than 10.  \nThus the digital root of 467 is 8.\nWe shall call a Digital Root Sum (DRS) the sum of the digital roots of the individual factors of our number.\n The chart below demonstrates all of the DRS values for 24.\nFactorisationDigital Root Sum2x2x2x392x3x492x2x6104x6103x8112x125246The maximum Digital Root Sum  of 24 is 11.\nThe function mdrs(n) gives the maximum Digital Root Sum of n. So  mdrs(24)=11.\nFind \u2211\u2009mdrs(n) for 1 < n < 1,000,000.", "solution": "14489159", "difficulty": 60, "story": "Once upon a time in the small village of Numeria, lived a young girl named Lila. Lila had always been fascinated by numbers and mathematical puzzles. Her favorite spot in the village was a beautiful garden filled with fragrant flowers of all colors, and a sparkling pond in the center. It was here, amidst the blooming petals and gentle breeze, that Lila would immerse herself in the enchanting world of numbers.\n\nOne sunny afternoon, as the golden rays of sunlight kissed the flowers and Lila's cheeks, a gentle old woman named Mrs. Grace approached her. Mrs. Grace was renowned for her wisdom and had a twinkle in her eye that drew people near.\n\n\"Lila, my dear,\" Mrs. Grace said, \"I see the spark of curiosity in your eyes. Would you like to hear an intriguing mathematical puzzle?\"\n\nLila's face lit up with excitement as she nodded eagerly. Mrs. Grace began to share the mystery of the Digital Root Sum.\n\n\"Imagine, Lila, that numbers hold secrets within themselves,\" Mrs. Grace explained. \"Each number has a digital root, found by repeatedly adding its digits until you get a number less than 10. Now, let's see how this concept intertwines with composites.\"\n\nLila listened intently as Mrs. Grace further explained. \"A composite number can be factored in various ways, and for each factorization, we find the digital roots of the individual factors and sum them up. This sum is called the Digital Root Sum (DRS).\"\n\nLila's inquisitive mind absorbed this newfound knowledge, and she couldn't wait to explore the enchantment of DRS herself. With Mrs. Grace's guidance, she set out to solve numerous puzzles. Every day, Lila would factorize different composite numbers and calculate their DRS. She discovered the hidden pattern and delightfully plotted the DRS values for each factorization.\n\nWord of Lila's remarkable skills soon spread throughout Numeria, captivating the whole village. People from far and wide would visit the garden, seeking Lila's expertise in unraveling the mysteries of the Digital Root Sum. Lila became known as the Numeria's \"DRS Prodigy.\"\n\nOne lazy summer day, as Lila enjoyed the gentle chirping of birds and the subtle fragrance of roses, a messenger arrived, bearing an urgent letter. The letter was an invitation from the prestigious Kingdom of Algebrica, requesting Lila's presence to solve an unsolvable mathematical conundrum. The problem perplexed the kingdom's scholars, and they hoped that Lila's brilliance in DRS could unlock the solution.\n\nExcitement bubbled within Lila's heart as she accepted the royal invitation and prepared for her journey. Little did Lila know that this adventure would not only test her mathematical prowess but also help save the kingdom from an ancient curse.\n\nAs Lila embarked on her quest, she faced daunting challenges and encountered fellow mathematicians along the way. They shared tales of their own mathematical discoveries, each adding a new layer of understanding to the magical world of numbers.\n\nFinally, arriving at the grand palace, Lila met the King and his advisors. They described their predicament\u2014a curse that had befallen the kingdom, causing their crops to wither and their people to suffer. Legends foretold that only by unraveling the mystery of the Digital Root Sum could the curse be broken.\n\nLila, now determined, pondered over the mathematical problem that haunted the kingdom. She knew that solving it would restore prosperity and happiness. The fate of an entire kingdom now rested on her shoulders.\n\nBut before Lila could attempt the arduous task, she needed to delve deeper into the world of DRS. She spent nights poring over ancient texts and engaging in deep meditations near the flickering candlelight, searching for the answer that eluded her.\n\nWeeks turned into months, and still, Lila wrestled with the intricate puzzles, unyielding in her determination. Exhaustion threatened to consume her, but her passion for mathematics kept her going.\n\nAnd now, dear reader, you find Lila on the brink of discovery. Can you join hands with her and embark on this journey yourself? Can you find the sum of the maximum Digital Root Sums for numbers between 1 and 1,000,000?\n\nThe answer lies hidden within the magical world of numbers, waiting to be unveiled.\n\nWill you take up the challenge?"}, {"id": 160, "euler_id": 160, "title": "Factorial trailing digits", "problem": "For any N, let f(N) be the last five digits before the trailing zeroes in N!.\nFor example,\n9! = 362880 so f(9)=36288\n10! = 3628800 so f(10)=36288\n20! = 2432902008176640000 so f(20)=17664\nFind f(1,000,000,000,000)", "solution": "16576", "difficulty": 60, "story": "Once upon a time in the mystical land of Numeria, there lived a young sorceress named Elara. With her prodigious talent for magic, Elara had always been intrigued by the secrets hidden within numbers. She spent countless hours studying the complexities of mathematical puzzles, eager to uncover their mysteries.\n\nOne day, as Elara delved deeper into her studies, she stumbled upon a peculiar problem. It was said that for any given number N, there existed a function called f(N). This function would reveal the last five digits before the trailing zeroes in the factorial of N. The possibilities seemed endless, and Elara's mind began to race with curiosity.\n\nDeep in the royal library, Elara found an ancient book, its pages filled with enchanting tales of times long past. She read about the power of factorial calculations and how they echoed through the vastness of Numeria. Fascinated, she decided to embark on a magical journey to discover the answer to f(1,000,000,000,000).\n\nWith her trusty wand in hand, Elara set out on a quest to glean wisdom from the ancient sages of Numeria. Along her journey, she encountered many obstacles and faced numerous challenges, all requiring her to utilize her mathematical knowledge. Time and again, she found herself relying on the art of numbers to decipher riddles and overcome obstacles.\n\nAmidst her adventures, Elara learned of a lost city shrouded in mystery, said to contain the answers she sought. The city's name was Quintricia, derived from the ancient word \"quint,\" representing the number five. It was rumored that within the depths of Quintricia's ruins lay the key to unlocking the secrets of f(N).\n\nUndeterred by the dangers that awaited her, Elara ventured forth to find Quintricia. Along her treacherous path, she confronted fearsome creatures, encountered enigmatic puzzles, and solved mathematical riddles that bent the very fabric of reality.\n\nFinally, after days of travel, Elara arrived at the gates of Quintricia. The ancient city stood before her, its grandeur hidden behind a veil of time. As she stepped through the gateway, the whispers of the past seemed to echo in her ears, guiding her towards the heart of the forgotten realm.\n\nElara explored the crumbled corridors, her eyes scanning the writings etched into the walls. At last, she discovered a chamber bathed in an ethereal light\u2014a room that held the final piece of her puzzle. On a stone pedestal stood a shimmering crystal orb, radiating an incomprehensible power.\n\nAs her fingers grazed the crystal's surface, Elara's mind filled with images and symbols. Visions of the factorial calculations danced before her eyes, weaving intricate patterns through the digits. Each calculation held the answer she sought\u2014f(1,000,000,000,000).\n\nBut as the visions reached their peak, the story abruptly paused, leaving Elara in limbo. To her dismay, the crystal revealed a question that bewitched her senses and begged her to solve it. The end of the tale was withheld, leaving Elara in a state of both anticipation and frustration.\n\nWith the knowledge locked within her heart, Elara returned to her homeland, determined to unveil the answer. She worked tirelessly, pouring over ancient texts and consulting with fellow mathematicians, mystics, and scholars. But still, the last five digits before the trailing zeroes of f(1,000,000,000,000) eluded her grasp.\n\nAnd so, dear reader, the question remains: What are the last five digits before the trailing zeroes of f(1,000,000,000,000)? Can you decipher the riddle that eluded even the brilliant mind of Elara?"}, {"id": 182, "euler_id": 182, "title": "RSA encryption", "problem": "The RSA encryption is based on the following procedure:\nGenerate two distinct primes p and q.Compute n=pq and \u03c6=(p-1)(q-1).\nFind an integer e, 1<e<\u03c6, such that gcd(e,\u03c6)=1.\nA message in this system is a number in the interval [0,n-1].\nA text to be encrypted is then somehow converted to messages (numbers in the interval [0,n-1]).\nTo encrypt the text,  for each message, m, c=me mod n is calculated.\nTo decrypt the text, the following procedure is needed: calculate d such that ed=1 mod \u03c6, then for each encrypted message, c, calculate m=cd mod n.\nThere exist values of e and m  such that me mod n=m.We call messages m for which me mod n=m unconcealed messages.\nAn issue when choosing e is that there should not be too many unconcealed messages.  For instance, let p=19 and q=37.\nThen n=19*37=703 and \u03c6=18*36=648.\nIf we choose e=181, then, although gcd(181,648)=1 it turns out that all possible messagesm (0\u2264m\u2264n-1) are unconcealed when calculating me mod n.\nFor any valid choice of e there exist some unconcealed messages.\nIt's important that the number of unconcealed messages is at a minimum.\nChoose p=1009 and q=3643.\nFind the sum of all values of e, 1<e<\u03c6(1009,3643) and gcd(e,\u03c6)=1, so that the number of unconcealed messages for this value of e is at a minimum.", "solution": "399788195976", "difficulty": 60, "story": "Once upon a time in the bustling kingdom of Mathlandia, there lived a young and curious mathematician named Alice. Alice had always been fascinated by the magical world of numbers, patterns, and encryption. She had spent countless hours studying the ancient art of cryptography, intrigued by the ability to turn ordinary messages into secret codes.\n\nOne day, as Alice was poring over her books in the Royal Library, she stumbled upon an old and tattered scroll. It contained a peculiar problem that caught her attention. It was the famous RSA encryption, a puzzle that had perplexed many mathematicians before her.\n\nIntrigued by the challenge, Alice dove headfirst into deciphering the problem. She understood that the RSA encryption relied on the calculation of primes and an integer e, creating encrypted messages that could only be decrypted using a specific key. However, there was a twist. The problem stated that there should not be too many \"unconcealed\" messages. Alice realized that this meant she needed to find the perfect value of e that minimized the number of unconcealed messages.\n\nAs Alice immersed herself in the world of p's, q's, and mod's, her mind raced with possibilities. She knew that she had to choose two distinct primes, p and q, and then compute n and \u03c6 according to the given rules. Excitement filled her as she began the quest to find the best values for p and q.\n\nAfter hours of calculations, she narrowed her search down to two potential pairs - p=19 and q=37 or p=1009 and q=3643. Both had their merits, but Alice had to make a decision that would minimize the number of unconcealed messages. Little did she know, her choice would have far-reaching consequences.\n\nAmidst the sunlit corridors of Mathlandia's grand castle, Alice pondered her options and weighed the odds. The thought of all possible messages, from 0 to n-1, being unconcealed haunted her. She remembered the first pair - p=19 and q=37 - where she had encountered that very problem. Determined not to repeat her past mistakes, she began analyzing the second option - p=1009 and q=3643.\n\nAlice was not one to shy away from challenges, and she knew this decision was crucial. Her heart raced as she delved into the complexities once again. She carefully calculated the values of n and \u03c6, being meticulous to avoid any errors. And then, the moment of truth arrived - choosing e.\n\nAs Alice stared at the two potential values of e, she realized that the fate of countless messages rested in her hands. To minimize the number of unconcealed messages, she needed to align her choice with \u03c6, ensuring the greatest level of encryption. It was the key to protecting secrets and preserving the integrity of the encryption system.\n\nHours turned into days, and days turned into weeks as Alice tirelessly crunched numbers and explored various scenarios. She found herself lost in a labyrinth of possibilities, seeking the elusive path to success. The pressure mounted, but Alice refused to back down. She was determined to uncover the solution that would lead to the fewest unconcealed messages.\n\nFinally, with her mind exhausted and her eyes weary, Alice arrived at a crossroads. The moment had come to make her decision. Should she choose p=19 and q=37, or would p=1009 and q=3643 be the winning pair? Holding her breath, she arrived at the answer that would shape the course of her endeavors.\n\nAs she wrote down her findings, Alice couldn't help but wonder - would this choice finally lead her to the solution she sought? Was her hypothesis correct, or was there an even better combination she had overlooked? Would this sum of all values of e, 1<e<\u03c6(1009,3643), truly minimize the number of unconcealed messages?\n\nWith a mixture of anticipation and trepidation, Alice penned her findings and concluded her short story with the question only a mathematician could ask.\n\nAnd so, dear reader, I present to you the fruits of my labor, the story of Alice's quest. But I leave you with the challenge she faced, the question that lingers in the air - Can you find the sum of all values of e, 1<e<\u03c6(1009,3643), and gcd(e,\u03c6)=1, so that the number of unconcealed messages for this value of e is at a minimum? The solution lies in your hands."}, {"id": 186, "euler_id": 186, "title": "Connectedness of a network", "problem": "Here are the records from a busy telephone system with one million users:\n\nRecNrCallerCalled120000710005326001835004393600863701497.........\nThe telephone number of the caller and the called number in record n are Caller(n) = S2n-1 and Called(n) = S2n where S1,2,3,... come from the \"Lagged Fibonacci Generator\":\nFor 1 \u2264 k \u2264 55, Sk = [100003 - 200003k + 300007k3] (modulo 1000000)\nFor 56 \u2264 k, Sk = [Sk-24 + Sk-55] (modulo 1000000)\nIf Caller(n) = Called(n) then the user is assumed to have misdialled and the call fails; otherwise the call is successful.\nFrom the start of the records, we say that any pair of users X and Y are friends if X calls Y or vice-versa. Similarly, X is a friend of a friend of Z if X is a friend of Y and Y is a friend of Z; and so on for longer chains.\nThe Prime Minister's phone number is 524287. After how many successful calls, not counting misdials, will 99% of the users (including the PM) be a friend, or a friend of a friend etc., of the Prime Minister?", "solution": "2325629", "difficulty": 60, "story": "Once upon a time, in the bustling town of Digiton, lived an ordinary boy named Max. Max was intrigued by numbers and patterns, and he spent much of his time exploring the depths of mathematical mysteries. His dedication to understanding the intricacies of numbers was unmatched by anyone in the town.\n\nOne day, Max stumbled upon an ancient scroll hidden deep within the town's library. The scroll contained a mathematical problem that had plagued the minds of countless individuals for centuries. Unable to resist the allure of such a tantalizing enigma, Max began to read the problem aloud.\n\nAs the words spilled from Max's lips, the atmosphere in the room seemed to shift. Suddenly, he found himself transported to a parallel world\u2014the world of the telephone system with one million users. Each user was represented by a unique number, and their calling patterns were dictated by a mysterious sequence known as the \"Lagged Fibonacci Generator.\"\n\nThe problem stated that if a caller's number was the same as the number they called, it was considered a misdial and the call failed. Otherwise, the call was considered successful. Max's mission was to determine, after how many successful calls\u2014discounting misdials\u2014would 99% of the users, including the Prime Minister, be connected to each other as friends, friends of friends, and so on.\n\nMax was no stranger to challenges, and this mathematical puzzle intrigued him like no other. He knew he had to tackle it head-on to bring order to the chaotic world of telephone connections. With unwavering determination, he began examining the records provided.\n\nAs Max delved deeper into the intricate web of connections, he discovered that the Prime Minister's phone number was none other than 524287. This newfound knowledge fueled Max's relentless pursuit of solving the problem. He realized that their world depended on the bonds of friendship, and it was up to him to bring unity to the entire telephone system.\n\nDays turned into weeks, and weeks turned into months as Max tirelessly analyzed the records, piecing together the puzzle bit by bit. He formed graphs, tested algorithms, and unraveled the secrets hidden within the sequence of numbers. The more he discovered, the clearer the path to the solution became.\n\nMax's determination reverberated through the entire town of Digiton. His passion for problem-solving inspired others to dive into the world of mathematics and unravel its mysteries for themselves. Everywhere Max went, he found people seeking his guidance, attempting to understand the nature of the interconnections themselves.\n\nFinally, after years of relentless pursuit, Max reached a breakthrough. The pieces fell into place, and the solution was within his grasp. But just as he was about to eradicate the chaos from the telephone system, Max hesitated.\n\nHe realized that while solving the problem would bring clarity to the mathematical realm, the answer would remain meaningless if it didn't serve a purpose in the real world. Max wondered if embracing chaos and uncertainty was an integral part of life, the catalyst for growth and change.\n\nWith a heavy heart, Max made his decision. He refused to solve the mathematical problem. Instead, he emerged from the world of the telephone system and returned to the town of Digiton, ready to share his newfound wisdom.\n\nThe townspeople gathered around Max, eager to hear of his adventures. Max drew a breath and began to speak, \"My friends, the answer to this mathematical problem lies within each one of us. It's not solely about solving the puzzle but understanding the significance of our interconnections. The true magic lies in the journey, the growth that arises from embracing uncertainty.\"\n\nHis words resonated with the crowd, and a sense of acceptance and unity swept through the town. Max's decision not to solve the problem became a symbol of embracing life's challenges, learning from the journey, and forging connections with one another.\n\nAs the sun set on another day in Digiton, Max posed a question to the eager crowd, leaving them with a puzzle of their own. \"After how many successful calls, not counting misdials, will 99% of the users, including the Prime Minister, be a friend, or a friend of a friend etc., of the Prime Minister? Can you solve this mystery?\"\n\nAnd with that, Max left the townspeople to ponder the question, knowing that the answer they sought would not be found solely in numbers, but in the connections they shared, the bonds they formed, and the love and unity they embraced."}, {"id": 202, "euler_id": 202, "title": "Laserbeam", "problem": "Three mirrors are arranged in the shape of an equilateral triangle, with their reflective surfaces pointing inwards. There is an infinitesimal gap at each vertex of the triangle through which a laser beam may pass.\nLabel the vertices A, B and C. There are 2 ways in which a laser beam may enter vertex C, bounce off 11 surfaces, then exit through the same vertex: one way is shown below; the other is the reverse of that.\n\n\nThere are 80840 ways in which a laser beam may enter vertex C, bounce off 1000001 surfaces, then exit through the same vertex.\nIn how many ways can a laser beam enter at vertex C, bounce off 12017639147 surfaces, then exit through the same vertex?", "solution": "1209002624", "difficulty": 60, "story": "Once upon a time, in a small village tucked away in the mountains, there lived a young girl named Maya. Maya possessed an insatiable curiosity and an eagerness to explore the world around her. Her favorite spot was a hidden grove that housed an ancient, mystical tree known as the Mirror Tree.\n\nLegend had it that the Mirror Tree possessed magical properties. Its sprawling branches, adorned with veined leaves, hosted an array of mirrors. Each mirror, carefully positioned, was said to grant a unique wish to anyone who solved the riddles they held within their reflective depths.\n\nOne sunny day, as Maya sat beneath the shade of the Mirror Tree, captivated by its ethereal beauty, she noticed three peculiar mirrors nearby. To her astonishment, they were arranged in the shape of an equilateral triangle, with their reflective surfaces pointed inwards.\n\nCuriosity piqued, Maya cautiously approached the mirrors and noticed three distinct vertices labeled A, B, and C. As she approached vertex C, she felt a gentle breeze, and a soft voice whispered in her ear, \"Solve the riddle of the mirrors, dear Maya, and great wisdom shall be yours.\"\n\nIntrigued by the challenge, Maya studied the mirrors intently. Suddenly, a beam of light shot through the infinitesimal gap at vertex C. The beam bounced off eleven mirrored surfaces, weaving a mesmerizing path before finally finding its way back through the same vertex. An incredible solution lay before her eyes.\n\nDays and nights melted into one as Maya tirelessly navigated the labyrinth of reflective surfaces. Guided by her love for numbers and patterns, she discovered that there were precisely 80840 ways for a laser beam to enter vertex C, bounce off 1000001 surfaces, and exit through the same vertex.\n\nOverwhelmed by her achievement, Maya questioned the purpose of this extraordinary ability. How could such intricate mathematical calculations tie to the magical properties of the Mirror Tree? Pondering this mystery, Maya decided to seek guidance from the wise village elder, known for unraveling the secrets of the universe.\n\nBut as she approached the elder's dwelling, she noticed an unfamiliar figure lurking in the shadows. It was an enigmatic traveler named Nevin, his eyes gleaming with a mischievous glint. Nevin, too, had heard stories about the mysterious Mirror Tree and sought the wisdom it held.\n\nCuriosity sparked between the two, and they joined forces, committed to unveil the secrets of the Mirror Tree. Together, they embarked on a remarkable journey, fueled by their unyielding determination to solve the puzzle that perplexed Maya.\n\nThrough treacherous landscapes and ancient ruins, they encountered adversities and overcame challenges. Maya and Nevin delved deep into their mathematical prowess as they bounced ideas off each other, continuously striving to unlock the unknown.\n\nDays turned into weeks, weeks into months, and months into years. Still, the duo refused to succumb to frustration, relentlessly pursuing their answers. Guided by the whispers of the Mirror Tree, they remained steadfast in their belief that their efforts would bear fruit.\n\nFinally, after what felt like an eternity, a revelation struck them like lightning. With their combined intellect and unbreakable determination, Maya and Nevin discovered that there were exactly 12017639147 ways a laser beam could enter vertex C, bounce off the astounding number of 12017639147 surfaces, and exit through the same vertex.\n\nToday, dear reader, I pose the same question to you. Can you uncover the secrets of the mysterious mirrors that continue to guard the wisdom of the Mirror Tree? How many ways can a laser beam enter at vertex C, bounce off 12017639147 surfaces, and exit through the same vertex?"}, {"id": 209, "euler_id": 209, "title": "Circular Logic", "problem": "A k-input binary truth table is a map from k input bits\n(binary digits, 0 [false] or 1 [true]) to 1 output bit. For example, the 2-input binary truth tables for the logical AND and XOR functions are:\n\nx\ny\nx AND y000010100111\n\nx\ny\nx XOR y000011101110\nHow many 6-input binary truth tables, \u03c4, satisfy the formula\n\n\u03c4(a, b, c, d, e, f) AND \u03c4(b, c, d, e, f, a XOR (b AND c)) = 0\nfor all 6-bit inputs (a, b, c, d, e, f)?\n", "solution": "15964587728784", "difficulty": 60, "story": "Once upon a time, in a distant land known as Numera, there was a young mathematician named Alice. She had a brilliant mind and a passion for solving complex problems. Alice spent her days exploring the depths of mathematical mysteries, continuously seeking out new challenges to conquer.\n\nOne sunny afternoon, Alice stumbled upon a peculiar book tucked away in the corner of her favorite library. Its pages were filled with fascinating mathematical problems that piqued her curiosity. As she delved into its contents, one particular puzzle caught her attention.\n\nThis problem involved binary truth tables, a topic that Alice had a firm grasp on. However, it was the equation written alongside the problem that intrigued her the most:\n\n\"\u03c4(a, b, c, d, e, f) AND \u03c4(b, c, d, e, f, a XOR (b AND c)) = 0\"\n\nAlice was fascinated by the complexity of the equation and the challenge it posed. The book didn't provide any hints, instead urging its readers to unravel the mystery themselves.\n\nIntrigued and determined, Alice set out on a quest to find a solution. She spent countless nights contemplating the problem, her mind swirling with possibilities. She started by drawing numerous truth tables, searching for patterns and connections between variables. Day after day, Alice lost herself in the enigma, her desire to unravel its secrets growing stronger with each passing moment.\n\nIn the midst of her exploration, Alice came across an ancient scroll hidden within the depths of the library's archives. To her astonishment, the scroll contained an illustration of a professor she had long admired: Professor Archimedes. Known for his unparalleled knowledge of mathematics, Archimedes had tackled numerous problems throughout history.\n\nAlice's heart raced with excitement as she discovered a detailed explanation from the professor himself. His words described a systematic approach to solving the problem, shedding light on the intricate connections hiding within the equation.\n\nHowever, just as Alice thought she had found a solution, her world turned upside down. The scroll vanished from her grasp, leaving only a cryptic message etched in its place:\n\n\"The true solution lies within, young mathematician. Seek not the answer, but the journey of discovery.\"\n\nPerplexed, Alice realized that this was no ordinary mathematical problem; it was a test of her dedication and perseverance. She understood that the story's narrative and the problem were entwined, emphasizing the importance of the journey rather than merely reaching a destination.\n\nWith newfound motivation, Alice resumed her quest. Days turned into weeks, weeks into months, and still, she sought the elusive solution. The mathematical problem had become a part of her life, a driving force that compelled her forward.\n\nAs the years flew by, Alice's understanding of the problem deepened. She discovered unique properties of binary truth tables and their connections to logical operations. Each revelation brought her closer to comprehending the equation's intricacies.\n\nNow, many years later, Alice finds herself standing at the culmination of her journey. She raises her gaze from the worn-out pages of her notebook, a mixture of excitement and trepidation in her eyes. A single question lingers within her mind:\n\nHow many 6-input binary truth tables, \u03c4, satisfy the formula?\n\nHer pursuit of this mathematical problem has transformed her life, teaching her lessons that only an arduous journey could convey. The adventure may have shaped her as a mathematician, but will it lead her to the solution?\n\nAs Alice closes her notebook and glances up at the vast universe of numbers, she poses the question to you, dear reader:\n\nCan you solve this intriguing puzzle and uncover the true nature of those mesmerizing 6-input binary truth tables?"}, {"id": 213, "euler_id": 213, "title": "Flea Circus", "problem": "A 30\u00d730 grid of squares contains 900 fleas, initially one flea per square.\nWhen a bell is rung, each flea jumps to an adjacent square at random (usually 4 possibilities, except for fleas on the edge of the grid or at the corners).\nWhat is the expected number of unoccupied squares after 50 rings of the bell? Give your answer rounded to six decimal places.", "solution": "330.721154", "difficulty": 60, "story": "Once upon a time, in a small village nestled deep within the forest, there lived a brilliant and curious mathematician named Arthur. Arthur spent his days lost in thought, pondering the mysteries of numbers and patterns. One day, while strolling through the village square, he noticed a peculiar but captivating bell hanging from a towering oak tree.\n\nIntrigued, Arthur approached the bell and read the inscription engraved upon its gleaming surface: \"Ring me, and witness the magic of chance.\" Unable to resist the allure of the unknown, he reached up and gave the bell a gentle shake.\n\nAs the ringing echoed through the village, something astonishing began to unfold. Suddenly, fleas emerged from every nook and cranny, bustling about in a flurry of excitement. Arthur's jaw dropped as he observed a 30\u00d730 grid materializing before his very eyes\u2014a grid composed of individual squares inhabited by these tiny, swift creatures.\n\nIt became apparent that there were exactly 900 fleas, occupying each square in perfect harmony. At first, they appeared content within their tiny territories, hopping from square to square, their movements governed by the whims of chance.\n\nArthur was captivated by this marvel of probability. He observed how each flea had four possibilities when choosing its new abode, except those situated on the edges of the grid or in the corners, who had fewer. It was a complex web of interconnected choices, each flea an agent of chaos dancing to the tune of probability.\n\nBut Arthur's fascination did not end there. He watched in rapt attention as the bell was rung repeatedly, shaping the fate of these ethereal creatures. After each ring, the fleas would obey the beckoning call, leaping through the air to alight upon a new square\u2014a square chosen at random, where they would once again ponder their next move.\n\nThe villagers, too, were drawn to the bell's magical allure. They watched from a distance, their eyes filled with wonder, as Arthur and the fleas embarked upon this extraordinary journey of chance. With each subsequent ring, the grid transformed\u2014a sprawling tapestry of motion, choices, and unforeseen paths.\n\nFifty times the bell was rung, enthralling both Arthur and the villagers, who reckoned the consequences of this ever-changing dance of fleas. As the final ring resounded, silence fell upon the village square. The fleas had settled, their allotted spaces occupied, and a hush of anticipation hung in the air.\n\nIt was at this moment that Arthur, his heart aflutter with excitement, turned to the villagers with a twinkle in his eye. He knew that within this intricate tapestry of leaps and bounds, there was a riddle\u2014a mathematical enigma\u2014that begged to be solved.\n\nAnd so, with his trusted villagers gathered around, Arthur posed a question that echoed through the square. \"Tell me, my friends, what is the expected number of unoccupied squares after these fifty rings of the bell, when chaos and chance have woven their intricate dance?\"\n\nAs the villagers stared at Arthur, their gaze filled with bewilderment and intrigue, the challenge lay before them. Could they unlock the secrets of probability and discern the path of these fledgling fleas? Could they unravel the puzzle and determine the expected number of unoccupied squares, leaving their minds filled with the wonder of numbers?\n\nAnd with a mischievous smile, Arthur concluded, \"The answer awaits, my friends. Seek it, and the world of chance shall reveal its secrets.\"\n\nAnd so, dear reader, we turn the riddle over to you: What is the expected number of unoccupied squares after fifty rings of the bell? Can you uncover the answer and reveal the marvelous mathematics hidden within this story of fleas and chance?"}, {"id": 222, "euler_id": 222, "title": "Sphere Packing", "problem": "What is the length of the shortest pipe, of internal radius 50mm, that can fully contain 21 balls of radii 30mm, 31mm, ..., 50mm?\nGive your answer in micrometres (10-6 m) rounded to the nearest integer.", "solution": "1590933", "difficulty": 60, "story": "Once upon a time, in a small village nestled on the outskirts of a thick forest, there lived a young and curious blacksmith named Owen. Owen was not your ordinary blacksmith. He had a keen mind and loved exploring the depths of mathematics. His workshop was filled with books on everything from geometry to algebra.\n\nOne sunny morning, as Owen was stoking the fire and preparing to fashion a new set of horseshoes, a man named Cedric, the village scholar, approached him with great excitement. \"Owen, my friend!\" Cedric exclaimed. \"I have come across the most fascinating mathematical problem, and I can't seem to find a solution. Perhaps you can help me?\"\n\nIntrigued, Owen put down his tools and gave Cedric his full attention. \"Of course, Cedric. I would be honored to assist you. What seems to be the problem?\"\n\nCedric cleared his throat and began to explain. \"You see, Owen, I have been tasked with designing a container for a collection of balls. These balls have varying radii, starting from 30mm and increasing by 1mm for each subsequent ball up to 50mm. The challenge is to determine the length of the shortest pipe, with an internal radius of 50mm, that can fully contain all these balls.\"\n\nOwen's eyes lit up with excitement. The problem intrigued him immediately. \"This is indeed a fascinating problem, Cedric. Let me think about it for a moment.\"\n\nAs Cedric eagerly watched Owen's brow furrow with concentration, an idea struck the young blacksmith. His eyes gleamed as he realized that he could apply his mathematical knowledge to craft a unique solution.\n\nBut before Owen could express his newfound revelation, the village bell chimed, signaling the arrival of the royal entourage. The King himself was visiting the village, and both Cedric and Owen were obligated to attend the grand gathering and showcase their skills.\n\nLater that evening, as the jubilant atmosphere dwindled down and the cool night settled, Owen could not forget about the unresolved mathematical problem. He longed to find the answer and prove himself worthy of the challenging task.\n\nThe next day, Owen set out for the forest, carrying a notebook filled with intricate calculations and sketches. He ventured deep into the woods, searching for peace and solitude to contemplate the problem at hand. The sunlight streamed through the leaves, casting a warm glow on Owen's determined face.\n\nAs he wandered deeper into the forest, Owen stumbled upon an abandoned gazebo. The structure, covered in creeping vines and moss, beckoned him forth. Intrigued, he stepped inside, and to his astonishment, he discovered an old book hidden beneath a wooden bench.\n\nRealizing it might hold the key to his problem, Owen eagerly opened the book, his eyes scanning the yellowed pages. And there it was, an ancient technique of calculating the solution to his mathematical conundrum.\n\nAs Owen delved deeper into the wisdom of the book, he realized that the length of the pipe could be found by calculating the lengths of various arcs, representing the size of each ball when it was stacked together. From there, he could determine the minimum length required for the pipe to fully contain all the balls.\n\nExcitement filled Owen's heart as he held the key to Cedric's problem in his hands. With newfound determination, he rushed back to the village, eager to share his revelation.\n\nBut before Owen could reach Cedric, a sudden thought struck him. What if there was another way, another route to solve the problem? What if the length of the pipe could be determined using some other mathematical technique or principle?\n\nContemplating his own revelation, Owen realized that he must not rush to Cedric's side with the immediate solution. Instead, he wanted to challenge those who dared to delve into the world of mathematics.\n\nSo, dear reader, I leave you with this question:\n\nWhat is the length of the shortest pipe, of an internal radius of 50mm, that can fully contain 21 balls with radii ranging from 30mm to 50mm?\n\nTake this mathematical challenge, and let your mind embark on a journey of discovery. The answer awaits you."}, {"id": 240, "euler_id": 240, "title": "Top Dice", "problem": "There are 1111 ways in which five 6-sided dice (sides numbered 1 to 6) can be rolled so that the top three sum to 15. Some examples are:\n\n\nD1,D2,D3,D4,D5 = 4,3,6,3,5\n\nD1,D2,D3,D4,D5 = 4,3,3,5,6\n\nD1,D2,D3,D4,D5 = 3,3,3,6,6\n\nD1,D2,D3,D4,D5 = 6,6,3,3,3\n\nIn how many ways can twenty 12-sided dice (sides numbered 1 to 12) be rolled so that the top ten sum to 70?", "solution": "7448717393364181966", "difficulty": 60, "story": "Once upon a time in a quaint little village nestled at the foot of a towering mountain, there lived an inquisitive young lad named Ethan. Ethan had always possessed a deep fascination for numbers and patterns, spending countless hours exploring the secrets hidden within their silent realms. His favorite pastime was attempting to solve complex puzzles and unravel the mysteries of mathematics.\n\nOne sunny morning, as the village awoke to the songs of the birds, Ethan stumbled upon an intriguing problem etched onto a weathered parchment hanging from the town's notice board. His curiosity piqued, he read the mathematical enigma aloud \u2013 the same one that had captivated many others in the village.\n\n\"There are 1111 ways in which five 6-sided dice can be rolled so that the top three sum to 15,\" Ethan recited, his eyes sparkling with excitement. \"But now, I wonder, in how many ways can twenty 12-sided dice be rolled so that the top ten sum to 70?\"\n\nDetermined to solve this enigmatic riddle, Ethan immersed himself into a world of calculations and permutations. It consumed his thoughts, making it hard for him to concentrate on mundane daily tasks. The problem, however, was not merely a mathematical curiosity for Ethan. It beckoned to him with a hidden purpose, as if it held the key to something greater.\n\nDays turned into weeks, and weeks turned into months. Ethan's passion for numbers was like a wildfire, growing brighter with each ounce of determination he poured into the problem. Rummaging through stacks of dusty books, he studied the complexities of dice rolling, probabilities, and combinations.\n\nAs he delved deeper into the mathematical labyrinth, Ethan began to notice a familiar pattern. Just like the villagers of his quaint little village, he discovered that the answer was not a mere number itself but rather a doorway to a world of infinite possibilities. It was an opportunity to explore the boundaries of both mathematics and his own understanding.\n\nOne fateful evening, as the embers of the day dimmed the skies, Ethan's journey reached a crossroad. He stood at the edge of a precipice, where all the pieces of the puzzle seemed to converge. Every calculation, every hypothesis, and every solution rested on the next step he would take.\n\nHis heart racing, Ethan turned his gaze to the distant mountain that loomed over the village. Its peak was obscured by a dense mist, promising the secrets and answers Ethan so desperately sought. And within that mist, he realized, lay a profound connection between the mathematical problem and his own destiny.\n\nWith a resolute determination, Ethan made up his mind. He set forth on a journey \u2013 a pilgrimage to the ancient sanctuary atop the mountain. For it was rumored that the sanctuary held the answers to the deepest questions, where the divine and the mathematical intersected.\n\nAs Ethan trudged up the treacherous path, he couldn't help but wonder what the connection between the enigma and his destiny truly meant. Would the answer to the problem reveal a path he was destined to follow? Would it lead him to his purpose in life, or would it merely be another piece in the grand tapestry of his mathematical journey?\n\nWith each step he took, the questions in Ethan's mind multiplied. And as the peak of the mountain drew close, the answers seemed to elude him just as readily. But still, he pressed on, his will unwavering.\n\nFinally, standing before the sanctuary's ancient doors, Ethan surrended himself to the unknown. His journey, be it marked by numbers or destiny, had led him to this moment. He raised his hand and pushed open the doors, stepping into a vast chamber filled with an ethereal light.\n\nAnd so, dear reader, I leave you with a question. In how many ways can twenty 12-sided dice be rolled so that the top ten sum to 70? Will you, like Ethan, embark on a journey of discovery and exploration, unraveling the secrets bound within the realm of numbers?"}, {"id": 249, "euler_id": 249, "title": "Prime Subset Sums", "problem": "Let S = {2, 3, 5, ..., 4999} be the set of prime numbers less than 5000.\nFind the number of subsets of S, the sum of whose elements is a prime number.\nEnter the rightmost 16 digits as your answer.", "solution": "9275262564250418", "difficulty": 60, "story": "Once upon a time in the village of Numerica, there lived a young and curious mathematician named Emma. She was known throughout the land for her quick thinking and love of numbers. Every day, Emma could be found poring over ancient texts and solving complex equations. One sunny afternoon, as Emma sat beneath a large oak tree engrossed in her studies, she stumbled upon a riddle that piqued her interest.\n\nHidden within the dusty pages of an old book written by a renowned mathematician was a problem that seemed to possess a mystical quality. The challenge read, \"Let S = {2, 3, 5, ..., 4999} be the set of prime numbers less than 5000. Find the number of subsets of S, the sum of whose elements is a prime number. Enter the rightmost 16 digits as your answer.\"\n\nEmma's eyes widened with excitement as she realized the potential significance of this problem. Countless possibilities and mysteries seemed to swirl in her mind. She knew that uncovering the answer to this riddle could change the way people viewed mathematics forever. Determined to solve the problem, Emma embarked on a quest to uncover the secrets of prime numbers.\n\nDays turned into weeks, and weeks into months, as Emma delved deeper into the world of mathematics. She analyzed patterns, devised intricate equations, and poured over ancient manuscripts, all in an effort to unlock the answer to the riddle. Her dedication and passion fueled her relentless pursuit of knowledge.\n\nAs the years passed, Emma's reputation as a brilliant mathematician grew. The villagers marveled at her ability to unravel the complexities of numbers and eagerly sought her guidance whenever they faced mathematical challenges. Emma cherished these moments, for she knew that her journey was not just about finding answers but also inspiring others to embrace the beauty of mathematics.\n\nOne day, as Emma sat in her study contemplating the elusive solution, she noticed a stray ray of sunlight streaming through her window. The sunlight illuminated her desk, highlighting a particular pattern that seemed to hold great significance. Emma's heart raced as she began connecting the dots, linking fragments of knowledge she had acquired over the years.\n\nSuddenly, it all became clear to Emma. She had solved the riddle! The number of subsets of S, whose sum of elements was a prime number, would undoubtedly shape the mathematical landscape. Emma felt a mixture of excitement, achievement, and undying curiosity. But as she looked out her window, she realized an even more profound truth.\n\nThe true significance of this riddle lay not in its solution, but in the innumerable possibilities and unanswered questions it presented. Emma's quest had not come to an end; it had only just begun. The adventure laid not in simply finding the solution, but in exploring the endless paths this riddle could open up.\n\nWith a newfound sense of purpose, Emma closed her eyes and pondered what her next step would be. She understood that the journey of a mathematician was never truly complete. Each problem solved led to new questions, new challenges, and new horizons waiting to be explored.\n\nShe opened her eyes, a glint of determination shining brightly. \"Dear reader,\" Emma began, \"the riddle has been presented to you, and now it is your turn to walk this path. How many subsets of S, whose sum of elements is a prime number, can you discover? What worlds will unravel before your eyes as you delve into the secrets of mathematics?\"\n\nAnd with that, Emma, the inquisitive mathematician, left her study, ready to embrace the unknown and inspire others to embark on their own mathematical adventures.\n\nNow, dear reader, the question remains with you. Can you solve the riddle and unlock the potential that lies within the numbers? How many subsets of S, with the sum of elements being a prime number, can you uncover?"}, {"id": 271, "euler_id": 271, "title": "Modular Cubes, part 1", "problem": "\nFor a positive number n, define S(n) as the sum of the integers x, for which 1<x<n andx3\u22611 mod n.\n\n\nWhen n=91, there are 8 possible values for x, namely : 9, 16, 22, 29, 53, 74, 79, 81.\nThus, S(91)=9+16+22+29+53+74+79+81=363.\n\nFind S(13082761331670030).\n", "solution": "4617456485273129588", "difficulty": 60, "story": "Once upon a time in the bustling city of Numeria, a brilliant and imaginative mathematician named Dr. Sophia Stone lived. Known for her eccentricity and insatiable curiosity, Dr. Stone spent her days and nights exploring the mysteries of numbers. One sunny morning, while sipping her steaming cup of tea, Dr. Stone stumbled upon an ancient scroll containing a perplexing mathematical problem. Little did she know that this seemingly innocent problem would change the course of her life forever.\n\nAs Dr. Stone delved deeper into the problem, a series of peculiar coincidences began to unfold. One by one, each clue led her to various corners of Numeria. From dusty libraries to hidden archives, she followed the path paved by numbers, unravelling the secrets that lay within. As she deciphered the arcane language of the scroll, Dr. Stone discovered that the problem was more than just a mathematical conundrum - it held a hidden message, a map to a long-lost treasure.\n\nThe message in the scroll presented Dr. Stone with an intriguing formula, one that fascinated her mind. It was a method to find the sum of certain integers, a concept she found both challenging and exciting. The formula, known as S(n), gave her the sum of numbers that satisfied a unique condition - x cubed, modulo n, was congruent to one. Eager to apply this formula to uncover the hidden treasure, Dr. Stone dove into her research, desperately seeking for a value of n that would unlock the path to untold riches.\n\nWeeks turned into months as Dr. Stone devoted every waking hour to her investigation. She dug through dusty archives, consulted ancient scholars, and even traveled to distant lands in pursuit of her goal. Though the search was arduous, Dr. Stone's determination never wavered. Finally, after countless failed attempts, she found it - the value of n that would lead her to the treasure.\n\nDr. Stone's heart raced with anticipation as she entered the final set of numbers: 13082761331670030. It was a colossal number, so magnificent that it nearly took her breath away. She inputted these digits into her calculations, waiting anxiously to see the result. With bated breath, she pressed the enter key, hoping for a breakthrough.\n\nDays and nights slipped by, turning into weeks, then months. Dr. Stone tirelessly repeated her calculations, analyzing every detail, determined not to make any mistakes. As she scrutinized the formula, she pondered the vastness of numbers and the mysteries hidden within. Triumphing over countless obstacles was second nature to her, but this enigma tested her to her very limits.\n\nThe moon waxed and waned, and the seasons changed as Dr. Stone's quest continued. She knew that the treasure awaited her, just beyond the realm of her calculations. And yet, despite her brilliance, she couldn't help but wonder if she would ever find the sum S(13082761331670030). Would she be forever captivated by the allure of numbers, or would she uncover the ultimate truth?\n\nFinally, as Dr. Stone neared the end of her calculations, her eyes grew wide with excitement. The sum was within her reach; she could almost taste victory. But before she could complete her journey, a burst of realization hit her like lightning. The numbers, the formulas, they were mere vessels for deeper mysteries - mysteries that connected her to something far greater than wealth or fame.\n\nWith newfound purpose, Dr. Stone closed her calculations, returning to her original question. She wondered, what did this mathematical problem truly mean? What hidden patterns lay beneath the surface? In her quest for treasure, she had discovered something far more priceless - the beauty and interconnectedness of the world through numbers.\n\nAs the story draws to an end, I leave you with a question that Dr. Sophia Stone herself pondered: Can you find the sum S(13082761331670030)? What secrets will the sum unlock?"}, {"id": 279, "euler_id": 279, "title": "Triangles with integral sides and an integral angle ", "problem": "\nHow many triangles are there with integral sides, at least one integral angle (measured in degrees), and a perimeter that does not exceed 108?\n", "solution": "416577688", "difficulty": 60, "story": "Once upon a time in the small village of Mathlandia, a young boy named Ethan possessed an unmatched passion for mathematics. While his friends spent their time playing outdoors, Ethan would often be found immersed in mathematical puzzles, seeking solace in the intricacies of numbers and shapes.\n\nOne day, as Ethan sat by the village fountain sketching geometric figures on a piece of parchment, he overheard a group of villagers discussing an upcoming festival. The festival was to celebrate the annual competition where the villagers would showcase their mathematical skills.\n\nIntrigued, Ethan eagerly joined the conversation and soon learned of the captivating mystery that lay at the heart of the festival. The villagers were tasked with finding the number of triangles that could be formed within certain constraints: integral sides, at least one integral angle measured in degrees, and a perimeter not exceeding 108.\n\nThe challenge fascinated Ethan, stirring his curiosity to its deepest core. Determined to explore this mathematical enigma further, he decided to seek inspiration in the legends of ancient Mathlandia. \n\nAfter hours of research and countless tales consumed, Ethan discovered a hidden scroll buried deep within the village's ancient library. The scroll, as if waiting for him to unveil its secrets, revealed a story from centuries ago \u2013 the Legend of the Trigonometric Gem.\n\nAccording to the legend, the Trigonometric Gem was an ancient artifact believed to possess limitless mathematical wisdom. It was said that whosoever could solve the mystery of the mathematical triangle conundrum would be granted the power to unlock the Trigonometric Gem's true potential.\n\nDriven by ambition, Ethan embarked on a journey to find the Trigonometric Gem. He traversed lush meadows, treacherous mountains, and crossed turbulent rivers, all in search of the hidden gem that held the key to his dream.\n\nFinally, after days of relentless pursuit, Ethan reached an ancient temple perched on the peak of a towering cliff. As he stepped inside, he was greeted by a magnificent chamber adorned with countless intricate geometrical patterns etched on the walls.\n\nAt the center of the chamber stood a pedestal, on which sat a dazzling gemstone, reflecting prisms of light in all directions. This was it\u2014the Trigonometric Gem.\n\nWith trembling hands, Ethan carefully picked up the gem, feeling a surge of untapped mathematical power coursing through his veins. As soon as the gem touched his fingertips, a voice echoed in his mind, emanating from the very essence of math itself.\n\n\"Ethan, the time has come for you to harness the power of the Trigonometric Gem. Use its knowledge to calculate the number of triangles with integral sides, at least one integral angle measured in degrees, and a perimeter not exceeding 108. But remember, this power is not for you alone; it is for all those who seek wisdom through mathematics.\"\n\nFilled with both excitement and trepidation, Ethan pondered over the enigmatic problem. The weight of the mathematical challenge felt both thrilling and overwhelming. He knew that the discovery of the number of triangles would unlock endless possibilities for his village and its people.\n\nWith determination burning in his eyes, Ethan asked himself, \"How many triangles can be formed with integral sides, at least one integral angle measured in degrees, and a perimeter not exceeding 108?\"\n\nAnd the story for the villagers of Mathlandia continues, awaiting the mathematical prowess of both Ethan and the readers to unravel the mysteries of triangles and embrace the infinite wonders hidden within the realm of numbers and shapes."}, {"id": 296, "euler_id": 296, "title": "Angular Bisector and Tangent", "problem": "\nGiven is an integer sided triangle ABC with BC \u2264 AC \u2264 AB.k is the angular bisector of angle ACB.m is the tangent at C to the circumscribed circle of ABC.n is a line parallel to m through B.\nThe intersection of n and k is called E.\n\n\n\nHow many triangles ABC with a perimeter not exceeding 100 000 exist such that BE has integral length?\n", "solution": "1137208419", "difficulty": 60, "story": "Once upon a time, in the beautiful kingdom of Mathlandia, there lived a clever young princess named Aurora. She had an insatiable love for all things mathematical and was known throughout the kingdom for her intellectual prowess. Aurora had a kind heart and was always finding ways to help others through her mathematical knowledge.\n\nOne fine day, a mysterious visitor arrived at the palace. He introduced himself as Professor Albert, a renowned mathematician from a faraway land. He presented Princess Aurora with an intriguing mathematical problem and sought her help in finding a solution.\n\n\"Princess Aurora, I have a fascinating problem for you,\" Professor Albert began. \"Consider an integer-sided triangle ABC, where the length of side BC is less than or equal to the length of side AC, and the length of side AC is less than or equal to the length of side AB.\"\n\nThe princess listened intently, her curiosity piqued.\n\nProfessor Albert continued, \"Let k be the angular bisector of angle ACB. Next, let m be the tangent at point C to the circumscribed circle of triangle ABC. Lastly, consider a line n that is parallel to m and passes through point B. The intersection of lines n and k is called point E.\"\n\nAurora's mind began to whirl with excitement as she visualized the geometric relationships described by Professor Albert. She pondered the problem, trying to comprehend the significance of point E. \n\n\"You see, Princess,\" Professor Albert explained, \"we need to determine how many triangles ABC, with a perimeter not exceeding 100,000, exist such that the length of segment BE is an integer.\"\n\nAurora's eyes sparkled with both wonder and determination. She knew that the solution required a combination of geometric reasoning and numerical analysis. This problem was unlike any she had encountered before, and the challenge thrilled her to the core.\n\nAs the days went by, Princess Aurora diligently devoted herself to solving the mathematical problem. She immersed herself in a world of angles, tangents, and circumscribed circles. She drew countless triangles, explored various permutations of lengths, and experimented with different angles.\n\nThroughout her journey, Aurora encountered many obstacles and setbacks. She spent hours deep in thought, scribbling calculations on fragile pieces of parchment, her brow furrowed with great intensity. The answer eluded her, but she refused to give up. She was determined to unveil the secrets hidden within the mathematical problem.\n\nAt last, the day arrived when the princess felt as if the puzzle's pieces were beginning to fall into place. She could see the faint outline of a solution forming before her, like a masterpiece waiting to be unveiled.\n\nAs dusk settled in, Princess Aurora invited Professor Albert to the palace once again. She eagerly shared her insights, her voice filled with excitement.\n\n\"Professor Albert, after extensive exploration and analysis, I have made a fascinating discovery,\" she declared. \"But before I reveal it, let me ask you, How many triangles ABC with a perimeter not exceeding 100,000 exist such that the length of segment BE is an integer?\"\n\nExcitement danced within Aurora's eyes as she awaited the esteemed mathematician's answer. She knew that she had come so close to unraveling the mystery, but she was equally aware that the final piece of the puzzle lay just beyond her reach.\n\nMystery and anticipation hung thick in the air as Princess Aurora's question echoed throughout the palace. The once-still night seemed to hold its breath, yearning for the resolution to a mathematical enigma.\n\nAnd now, dear reader, it is your turn. Can you find the solution to the problem Princess Aurora and Professor Albert set forth? Can you determine the number of triangles ABC that exist with a perimeter not exceeding 100,000, such that the length of segment BE is an integer?\n\nAs the stars twinkled above, Princess Aurora and Professor Albert eagerly awaited your answer. And so, the question lingers. Will you be the one to arrive at the solution?"}, {"id": 298, "euler_id": 298, "title": "Selective Amnesia", "problem": "Larry and Robin play a memory game involving a sequence of random numbers between 1 and 10, inclusive, that are called out one at a time. Each player can remember up to 5 previous numbers. When the called number is in a player's memory, that player is awarded a point. If it's not, the player adds the called number to his memory, removing another number if his memory is full.\nBoth players start with empty memories. Both players always add new missed numbers to their memory but use a different strategy in deciding which number to remove:\nLarry's strategy is to remove the number that hasn't been called in the longest time.\nRobin's strategy is to remove the number that's been in the memory the longest time.\nExample game:\nTurn\nCallednumber\nLarry'smemory\nLarry'sscore\nRobin'smemory\nRobin'sscore\n1\n1\n1\n0\n1\n0\n2\n2\n1,2\n0\n1,2\n0\n3\n4\n1,2,4\n0\n1,2,4\n0\n4\n6\n1,2,4,6\n0\n1,2,4,6\n0\n5\n1\n1,2,4,6\n1\n1,2,4,6\n1\n6\n8\n1,2,4,6,8\n1\n1,2,4,6,8\n1\n7\n10\n1,4,6,8,10\n1\n2,4,6,8,10\n1\n8\n2\n1,2,6,8,10\n1\n2,4,6,8,10\n2\n9\n4\n1,2,4,8,10\n1\n2,4,6,8,10\n3\n10\n1\n1,2,4,8,10\n2\n1,4,6,8,10\n3\nDenoting Larry's score by L and Robin's score by R, what is the expected value of |L-R| after 50 turns? Give your answer rounded to eight decimal places using the format x.xxxxxxxx .", "solution": "1.76882294", "difficulty": 60, "story": "Once upon a time in the magical kingdom of Numeria, there lived two best friends named Larry and Robin. They were both incredibly talented math wizards, captivating the kingdom with their numerical prowess. Larry was known for his amazing memory, while Robin had a knack for strategic planning.\n\nOne sunny afternoon, Larry and Robin decided to entertain the kingdom with a memory game. They gathered the townspeople in the town square, invoking their curiosity. The rules were simple: Larry and Robin would take turns calling out random numbers between 1 and 10, inclusively. Each player would be awarded a point if the called number matched one in their memory, but if their memory was full, they would have to choose which number to remove.\n\nThe town square buzzed with anticipation as the game began. Larry and Robin, both starting with empty memories, were given notebooks to jot down the numbers they had memorized. Larry, always the analytical one, decided to remove the number that hadn't been called in the longest time whenever his memory reached its limit. Meanwhile, Robin, the strategic thinker, chose to remove the number that had been in his memory the longest, regardless of when it was last called.\n\nAs the game progressed, the crowd watched in awe as Larry and Robin exhibited their mathematical prowess. Both players diligently added missed numbers to their memories, applying their distinct strategies to decide which number to remove. The game became a fierce battle of memory, strategy, and quick thinking.\n\nThe townspeople were captivated by the spectacle unfolding before their eyes. The number-calling echoed through the square, with Larry and Robin racking up points as they remembered the called numbers. The game enthralled everyone, from the youngest child to the oldest elder, each eagerly awaiting the next number to be called.\n\nBut amidst all the excitement and anticipation, the townspeople couldn't help but wonder about the final outcome. As the 50th turn approached, the crowd hushed, awaiting the crucial moment. The suspense was palpable as Larry called out the final number and jotted it down. The game had come to an end.\n\nLarry had a clever trick up his sleeve. He walked to a small podium at the center of the square and conjured a question for the townspeople. \"Denoting my score by L and Robin's score by R, what is the expected value of |L-R| after 50 turns? Give your answer rounded to eight decimal places using the format x.xxxxxxxx.\"\n\nThe crowd gasped in surprise. They marveled at how Larry cleverly integrated this fascinating mathematical problem into their enchanting memory game. For once, the citizens of Numeria had been thoroughly entertained and intellectually challenged.\n\nNow, dear reader, I pose the same question to you. Can you solve the mystical puzzle and determine the expected value of |L-R|? The answer lies within the realm of numbers, waiting to be discovered."}, {"id": 299, "euler_id": 299, "title": "Three similar triangles", "problem": "Four points with integer coordinates are selected:A(a,\u00a00), B(b,\u00a00), C(0,\u00a0c) and D(0,\u00a0d), \nwith 0\u00a0<\u00a0a\u00a0<\u00a0b and 0\u00a0<\u00a0c\u00a0<\u00a0d.\nPoint P, also with integer coordinates, is chosen on the line AC so that the three triangles ABP, CDP and BDP are all similar.\n\nIt is easy to prove that the three triangles can be similar, only if a=c.\nSo, given that a=c, we are looking for triplets (a,b,d) such that at least one point P (with integer coordinates) exists on AC, making the three triangles ABP, CDP and BDP all similar.\nFor example, if (a,b,d)=(2,3,4), it can be easily verified that point P(1,1) satisfies the above condition. \nNote that the triplets (2,3,4) and (2,4,3) are considered as distinct, although point P(1,1) is common for both.\nIf b+d\u00a0<\u00a0100, there are 92 distinct triplets (a,b,d) such that point P exists.\nIf b+d\u00a0<\u00a0100 000, there are 320471 distinct triplets (a,b,d) such that point P exists.\nIf b+d\u00a0<\u00a0100 000 000, how many distinct triplets (a,b,d) are there such that point P exists?", "solution": "549936643", "difficulty": 60, "story": "Once upon a time in the small town of Numeria, there lived a young and curious girl named Alyssa. She had an insatiable appetite for all things mathematical. Every day, she would explore the library and immerse herself in the wonders of numbers and equations. But one day, as she was flipping through the pages of an ancient book, she stumbled upon a problem that piqued her interest like never before.\n\nThe problem spoke of four points with integer coordinates - A(a, 0), B(b, 0), C(0, c), and D(0, d), where a, b, c, and d were greater than zero. The book then revealed an intriguing secret: if a and c were equal, the three triangles formed by connecting these points - ABP, CDP, and BDP - would all be similar. Alyssa's curious mind was instantly captivated.\n\nDeep in thought, Alyssa wondered why this was the case. Why would these specific conditions lead to the triangles being similar? She knew she had to find an answer, for her love of mathematics compelled her to unravel this mystery. Without wasting a moment, she quickly gathered her notebooks and pencils and put her enchanted mind to work.\n\nDays turned into weeks, and weeks into months, as Alyssa tirelessly worked on this captivating problem. She immersed herself in the world of geometric shapes and coordinates, meticulously analyzing the potential outcomes. To her delight, she discovered that there were triplets (a, b, d) such that point P existed on the line AC. However, what baffled Alyssa the most was the sheer number of distinct triplets.\n\n\"If b + d is less than 100, there are 92 distinct triplets (a, b, d) that satisfy the conditions,\" she murmured. \"And if it is less than 100,000, then there are 320,471 distinct triplets (a, b, d)... But what about when b + d is less than 100,000,000? How many distinct triplets will there be?\"\n\nAlyssa's excitement mounted. This was the ultimate question that would test her mathematical prowess and stretch the limits of her imagination. Determined to find the answer, she delved deeper into her studies, researching countless mathematical principles and drawing diagram after diagram.\n\nBut as Alyssa inched closer to her goal, another thought crept into her mind. She wondered if her journey to find the solution could be shared with others \u2013 those who, like her, found solace and inspiration in the realm of numbers. She imagined a world where people could join her, embarking on a thrilling expedition of mathematical discovery. And so, she decided to put her knowledge to the test.\n\nWith a heart full of hope, Alyssa began to write the fantastic tale of her mathematical journey. She painted vivid images with her words, transporting readers to the enchanting realm of Numeria. She wove the mathematical problem seamlessly into the narrative, making it integral to the plot.\n\nAs she neared the end of her story, Alyssa couldn't help but feel a mix of satisfaction and anticipation. She knew that her readers would be captivated by the mystery and inspired to embark on their own mathematical quests. And now, all that remained was the final touch \u2013 a question that would nudge her readers' minds toward a captivating solution.\n\n\"When b + d is less than 100,000,000,\" Alyssa wrote, \"how many distinct triplets (a, b, d) are there such that point P exists?\"\n\nAnd so, dear readers, it is now your turn. The journey through the story of Alyssa's mathematical exploration has brought you to this moment. Can you solve the riddle that has fascinated her for so long? How many distinct triplets exist? Join Alyssa on this adventure and let your imagination soar. The world of mathematics awaits your discovery."}, {"id": 302, "euler_id": 302, "title": "Strong Achilles Numbers", "problem": "\nA positive integer n is powerful if p2 is a divisor of n for every prime factor p in n.\n\n\nA positive integer n is a perfect power if n can be expressed as a power of another positive integer.\n\n\nA positive integer n is an Achilles number if n is powerful but not a perfect power. For example, 864 and 1800 are Achilles numbers: 864 = 25\u00b733 and 1800 = 23\u00b732\u00b752.\n\n\nWe shall call a positive integer S a Strong Achilles number if both S and \u03c6(S) are Achilles numbers.1\nFor example, 864 is a Strong Achilles number: \u03c6(864) = 288 = 25\u00b732. However, 1800 isn't a Strong Achilles number because: \u03c6(1800) = 480 = 25\u00b731\u00b751.\n\nThere are 7 Strong Achilles numbers below 104 and 656 below 108.\n\n\nHow many Strong Achilles numbers are there below 1018?\n\n\n1 \u03c6 denotes Euler's totient function.\n", "solution": "1170060", "difficulty": 60, "story": "Once upon a time in the mystical land of Mathis, there lived a young apprentice named Ethan. He was passionate about numbers and spent his days studying and solving mathematical problems. One day, as Ethan delved deeper into his studies, he stumbled upon a mysterious old book hidden beneath a pile of dusty tomes.\n\nIntrigued, Ethan blew off the layers of dust and opened the book. It contained a wealth of mathematical knowledge, filled with intriguing problems and riddles. As his eyes scanned the pages, he came across a particularly captivating problem - the enigma of the Strong Achilles numbers.\n\nDeeply fascinated, Ethan couldn't help but immerse himself in the problem. The concept of powerful numbers, perfect powers, and the intricacies of the totient function fascinated him beyond measure. While he initially thought it was just a mathematical exploration, he soon realized the importance of understanding these numbers.\n\nAs Ethan delved further into the book's pages, he discovered a hidden secret within the land of Mathis. Legend had it that the Strong Achilles numbers held immense power, capable of shaping the destiny of the kingdom. It was believed that these numbers possessed mystical properties and could unlock hidden treasures buried deep within the earth, or even grant unimaginable wisdom.\n\nEthan's heart raced with excitement. He could not resist the pull of the mystery that lay before him. If mastering the Strong Achilles numbers could unveil these hidden treasures, then he was determined to find them.\n\nWith a quill in one hand and a parchment in the other, Ethan began tirelessly working through countless calculations, seeking patterns and connections. He immersed himself in formulas, prime numbers, and the intricacies of divisors. The days turned into weeks, and the weeks into months, yet Ethan's determination never wavered.\n\nAs his knowledge grew, Ethan uncovered the secret behind the seven Strong Achilles numbers below 10^4. He reveled in his discoveries, eagerly sharing his newfound wisdom with his mentors and fellow math enthusiasts. The Kingdom of Mathis was astounded by his knowledge and began to recognize his profound abilities.\n\nHowever, as the days turned into years, Ethan faced an all-consuming question: How many Strong Achilles numbers were there below 10^18?\n\nEthan's eyebrows furrowed with determination as he continued his pursuit of the answer. He considered every possible approach, analyzing the properties of powerful numbers, perfect powers, and the totient function. He conducted experiments, formulated theorems, and embarked on a grand mathematical adventure.\n\nWill Ethan's quest yield an answer to this perplexing question? Will he unlock the secrets hidden within the Strong Achilles numbers and restore prosperity to the Kingdom of Mathis? Only you, dear reader, can help Ethan unveil the mystery by finding the answer to this tantalizing problem.\n\nSo, tell me, math enthusiast, how many Strong Achilles numbers are there below 10^18?"}, {"id": 305, "euler_id": 305, "title": "Reflexive Position", "problem": "\nLet's call S the (infinite) string that is made by concatenating the consecutive positive integers (starting from 1)  written down in base 10. \nThus, S = 1234567891011121314151617181920212223242...\n\n\nIt's easy to see that any number will show up an infinite number of times in S.\n\n\nLet's call f(n) the starting position of the nth occurrence of n in S. \nFor example, f(1)=1, f(5)=81, f(12)=271 and f(7780)=111111365.\n\n\nFind \u2211\u2009f(3k) for 1\u2264k\u226413.\n", "solution": "18174995535140", "difficulty": 60, "story": "Once upon a time in the small town of Numeria, there lived a brilliant mathematician named Professor Euler. He possessed an extraordinary talent for numbers and spent his days exploring the beautiful intricacies of mathematics. Professor Euler had a special place in his heart for sequences and patterns, always searching for hidden treasures within the vast realm of numbers.\n\nOne sunny day, Professor Euler stumbled upon a peculiar book in the dusty corners of the town library. The book, titled \"The Enigma of S,\" described a mathematical problem that immediately piqued his interest. Intrigued, he delved into the problem and found himself captivated by its enigmatic nature.\n\nThe problem revolved around a string called 'S,' which was formed by concatenating consecutive positive integers written in base 10. Essentially, this infinite string began with '1,' continued with '2,' '3,' and so on. Professor Euler could almost visualize the string unfolding before his eyes.\n\nIn this infinite string, he discovered a mesmerizing pattern. Every number, no matter how large or small, appeared an infinite number of times in 'S.' This revelation sent shivers down his spine, for it meant he had stumbled upon something truly remarkable.\n\nLost in thought, the professor pondered on this newfound discovery. What fascinated him the most was a function called 'f(n).' This function determined the starting position of the nth occurrence of n in the string 'S.' In simpler words, it determined where each number first appeared in the infinite sequence.\n\nAs Professor Euler dived deeper into the problem, his mind wandered into a fictional realm where numbers came alive. He imagined the characters within 'S' interacting with one another, forming their own communities and adventures. It was as though a whole world of numbers had opened up before him.\n\nIn this magical world of numbers, he stumbled upon the story of Franklin, a curious and mischievous number. Franklin was deeply fascinated with the concept of f(n) and made it his life's purpose to understand and explore it.\n\nFranklin's adventures took him on a whirlwind journey through the sequence 'S.' He traveled far and wide, searching for the nth occurrence of n, starting from 1 and onwards. Each time he discovered a new occurrence, he would record the starting position and marvel at the beauty of the pattern.\n\nHe encountered various challenges and obstacles along the way, which tested his determination and cunning. Every new experience enriched his understanding of the mathematical problem that had become the centerpiece of his existence.\n\nAs Franklin's journey unfolded, his discoveries began to reshape the world within 'S.' The characters he encountered grew wiser and more aware of their place in the infinite string. They started to question their own existence and pondered the significance of their starting positions.\n\nThe closer Franklin got to f(3k), the more questions he had about Professor Euler's mathematical problem. He became intrigued by the sum of these starting positions. What was the value of \u2211\u2009f(3k) for 1 \u2264 k \u2264 13? It was a tantalizing mystery that became his ultimate quest.\n\nAs the tale of Franklin and the world of numbers drew to a close, Professor Euler found himself yearning for answers. He wondered if anyone, perhaps even himself, could solve the mathematical problem that had captivated his thoughts and fired his imagination.\n\nAnd so, dear reader, I pose this question to you. Can you reach into the depths of your own mathematical prowess and solve the enigma that lies within the sum \u2211\u2009f(3k) for 1 \u2264 k \u2264 13?"}, {"id": 308, "euler_id": 308, "title": "An amazing Prime-generating Automaton", "problem": "A program written in the programming language Fractran consists of a list of fractions.\nThe internal state of the Fractran Virtual Machine is a positive integer, which is initially set to a seed value. Each iteration of a Fractran program multiplies the state integer by the first fraction in the list which will leave it an integer.\nFor example, one of the Fractran programs that John Horton Conway wrote for prime-generation consists of the following 14 fractions:\n1791,7885,1951,2338,2933,7729,9523,7719,117,1113,1311,152,17,551\nStarting with the seed integer 2, successive iterations of the program produce the sequence:\n15, 825, 725, 1925, 2275, 425, ..., 68, 4, 30, ..., 136, 8, 60, ..., 544, 32, 240, ...\nThe powers of 2 that appear in this sequence are 22, 23, 25, ...\nIt can be shown that all the powers of 2 in this sequence have prime exponents and that all the primes appear as exponents of powers of 2, in proper order!\nIf someone uses the above Fractran program to solve Project Euler Problem 7 (find the 10001st prime), how many iterations would be needed until the program produces 210001st prime ?", "solution": "1539669807660924", "difficulty": 60, "story": "Once upon a time, in a forgotten village tucked away in the mountains, there lived a young and curious boy named Ethan. Ethan possessed an extraordinary talent for mathematics. He could add, subtract, and multiply numbers in his head faster than anyone in the village. However, his true passion lay in unraveling the mysteries of the universe through numbers.\n\nAs Ethan grew older, his fascination with numbers only intensified. He would spend hours engrossed in books and equations, searching for patterns and connections. One day, he stumbled upon a cryptic message etched on an old parchment he found in the attic. It spoke of a mythical programming language called Fractran capable of generating prime numbers.\n\nIntrigued, Ethan delved deeper into the world of Fractran. He discovered that a Fractran program could be written as a list of fractions. Each fraction, when multiplied by an internal state integer, would either leave it an integer or produce a fractional result. This process could continue for an infinite number of iterations, creating a sequence of numbers.\n\nThe parchment revealed the secret to one of John Horton Conway's Fractran programs, which was said to generate primes. It contained a list of fourteen mysterious fractions: 1791, 7885, 1951, 2338, 2933, 7729, 9523, 7719, 117, 1113, 1311, 152, 17, 551.\n\nDetermined to uncover the power of this ancient programming language, Ethan set about deciphering the puzzle. He spent countless nights, tirelessly experimenting with different seed values and observing the resulting sequences of numbers. Slowly but surely, patterns began to emerge.\n\nOne night, as the moon cast its silvery glow through his bedroom window, Ethan stumbled upon a revelation. The sequence produced by the Fractran program contained powers of 2, and these powers always had prime exponents. Furthermore, all the primes appeared as exponents of powers of 2 in proper order! It was an awe-inspiring realization, connecting the world of prime numbers with the elegant structure of Fractran.\n\nWith excitement coursing through his veins, Ethan yearned to unlock the true potential of the Fractran program. He wondered, could this remarkable language help him solve one of the most challenging mathematical problems of all time, Project Euler Problem 7? The problem tasked the solver with finding the 10001st prime, an elusive number rumored to hold the key to unimaginable treasures.\n\nEthan pondered over the question, considering the powers of 2 that appeared in the Fractran sequence. If he were to embark on this remarkable journey, how many iterations would he need until the program produced the 210001st prime? In his mind, a roadmap of numbers began to take shape, the path to the ultimate revelation.\n\nBut before diving headfirst into the world of primes and programming languages, Ethan paused for a moment. He wondered if his pursuit of mathematical enlightenment would come at the cost of the simple joys of life. Would his passion for numbers create a distance between him and the people he held dear?\n\nAs the moon reached its zenith in the night sky, Ethan made a decision. He would tread carefully, navigating the realm of Fractran with a sense of purpose and balance. He would embrace the magic of numbers while cherishing the human connections that made life meaningful.\n\nAnd so, dear reader, I pose this question to you: How many iterations would be needed until the Fractran program produces the 210001st prime? Will you embark on this mathematical odyssey and join Ethan on his quest for knowledge and harmony?"}, {"id": 350, "euler_id": 350, "title": "Constraining the least greatest and the greatest least", "problem": "A list of size n is a sequence of n natural numbers. Examples are (2,4,6), (2,6,4), (10,6,15,6), and (11).\n\nThe greatest common divisor, or gcd, of a list is the largest natural number that divides all entries of the list. Examples: gcd(2,6,4) = 2, gcd(10,6,15,6) = 1 and gcd(11) = 11.\n\nThe least common multiple, or lcm, of a list is the smallest natural number divisible by each entry of the list. Examples: lcm(2,6,4) = 12, lcm(10,6,15,6) = 30 and lcm(11) = 11.\n\nLet f(G, L, N) be the number of lists of size N with gcd \u2265 G and lcm \u2264 L. For example:\n\nf(10, 100, 1) = 91.\nf(10, 100, 2) = 327.\nf(10, 100, 3) = 1135.\nf(10, 100, 1000) mod 1014 = 3286053.\n\nFind f(106, 1012, 1018) mod 1014.\n", "solution": "84664213", "difficulty": 60, "story": "Once upon a time in a small village nestled at the foot of a tall mountain, there lived a curious young girl named Lily. She had always been drawn to numbers and patterns, finding beauty in the orderly nature of mathematics. Lily spent her days exploring the world around her, seeking out any opportunity to put her mathematical knowledge to use.\n\nOne sunny day, as she meandered along a peaceful stream, Lily stumbled upon a peculiar sight. Nestled among the rocks, she found an ancient scroll adorned with intricate symbols and equations. Intrigued, she gently unrolled the delicate parchment, revealing a mathematical problem unlike any she had ever seen before. Her eyes sparkled with excitement as she delved into its mysteries.\n\nThe problem spoke of lists, sequences of natural numbers, and their greatest common divisors and least common multiples. It fascinated Lily, for she knew that understanding the properties of these lists could unlock a world of knowledge. With newfound vigor, she decided to find out more.\n\nLily poured over books and consulted wise villagers, eager to understand the intricacies of this mathematical problem. The deeper she delved, the clearer it became that this problem held great significance. She discovered that the number of lists with specific criteria could be calculated using a function named f(G, L, N). Lily was astounded by the possibilities.\n\nA ray of realization dawned upon Lily's face as she connected the dots. This mathematical problem held the key to unraveling secrets hidden within the very fabric of the universe. It wasn't just a random puzzle; it was a riddle left behind by the ancients to guide future generations.\n\nBut what could Lily do with this newfound knowledge? She pondered the significance of f(G, L, N) and its applications. It occurred to her that in the vast cosmic tapestry, the answer to this mathematical problem might hold the secret to unlocking doors unimaginable. If she could solve it, she might uncover untold wonders.\n\nWith a determined glint in her eye, Lily set forth on a journey. She traveled far and wide, seeking out scholars and sages known for their profound understanding of mathematics. She trekked through scorching deserts, braved tempestuous storms, and scaled treacherous mountains, never losing sight of her quest.\n\nAs word of her pursuit spread, fellow enthusiasts of mathematics joined her, eager to assist in solving the enigma. Together, they brainstormed, cracked their brains, and tested countless theories. The village buzzed with fervor as everyone joined hands in this intellectual endeavor.\n\nNow, dear reader, we must pause the story and pose a question. Can you solve this perplexing problem that has captured Lily's heart and mind? Can you find f(106, 1012, 1018) mod 1014? As the villagers eagerly await your answer, the fate of discovery hangs in the balance.\n\nMay you find solace in the beauty of numbers and the thrill of unraveling their secrets. For Lily, her quest continues, fueled by the passion that only a true mathematician possesses. And so, dear reader, the question now rests in your hands. Can you solve this mystery?"}, {"id": 356, "euler_id": 356, "title": "Largest roots of cubic polynomials", "problem": "\nLet an be the largest real root of a polynomial g(x) = x3 - 2n\u00b7x2 + n.\nFor example, a2 = 3.86619826...\n\nFind the last eight digits of \u2211i=130\u230aai987654321\u230b.\n\nNote: \u230aa\u230b represents the floor function.", "solution": "28010159", "difficulty": 60, "story": "It was a dull, rainy afternoon in the sleepy town of Mathersville. The local library was nearly empty, save for a few diligent students and the librarian, Mr. Thompson. He sat at his desk, shuffling through papers, looking for something interesting to occupy his mind. It had been years since he had encountered a truly challenging mathematical problem, and today seemed like the perfect day for one.\n\nJust as Mr. Thompson was about to give up his search, he stumbled upon an old, dusty book tucked away in the corner. Its faded cover read, \"The Enigma of Equations.\" Intrigued, he opened the book and began to read. As time slipped away, he found himself completely absorbed in the captivating tale that unfolded within the pages.\n\nThe story revolved around a brilliant mathematician named Dr. Amelia Green, who had made a groundbreaking discovery. She had derived a polynomial equation, g(x) = x^3 - 2nx^2 + n, that had garnered attention from the entire mathematical community.\n\nDr. Green's equation held a secret. She found that if the largest real root of her polynomial equation at a particular value of n, denoted as 'an,' was plugged into a unique formula, it would yield fascinating results. The formula was \u2211i=130\u230aai987654321\u230b, and it promised to unlock hidden numbers of immense significance.\n\nOne could only imagine the profound implications of such a discovery. Mr. Thompson's heart raced with excitement as he delved deeper into the book. He could almost feel the weight of the puzzle pressing against his fingertips.\n\nAs Mr. Thompson lost himself in the absorbing narrative, he began to wonder about the character's journey. What choices would Dr. Green make? How would she use her newfound knowledge to reshape the world of mathematics?\n\nThe story painted an image of Dr. Green tirelessly crunching numbers in her small, cluttered office. Night after night, she poured over endless calculations and equations, determined to test her theory to its limits. The moment of truth arrived when she finally found an integer value of n that yielded a fascinating result.\n\nDr. Green's excitement filled every corner of her office as she uncovered the last eight digits of the formula. The numbers seemed to shimmer and dance before her eyes, a secret code that held immense power and possibility.\n\nBut how would Dr. Green use this newfound knowledge, Mr. Thompson wondered? Would she unveil her discovery to the world, inviting fellow mathematicians to help decipher its message? Or would she keep it hidden, fearing that it might be misused or misunderstood?\n\nAs Mr. Thompson reached the final page of the book, he found himself yearning for answers. He closed it with a soft thud, a question looming in his mind. What were the last eight digits of \u2211i=130\u230aai987654321\u230b?\n\nThe ticking of the clock echoed through the library, but Mr. Thompson remained undeterred. His mind raced, contemplating the mathematical problem that had revealed itself through the alluring narrative. How could he find the elusive solution? Would it lead to an astonishing revelation or simply deepened the mystery further?\n\nLost in thought, Mr. Thompson turned to the final page once more, seeking solace in the unknown, and whispered the question that lingered in his heart, \"Can you solve this enigma?\""}, {"id": 369, "euler_id": 369, "title": "Badugi", "problem": "In a standard 52 card deck of playing cards, a set of 4 cards is a Badugi if it contains 4 cards with no pairs and no two cards of the same suit.\nLet f(n) be the number of ways to choose n cards with a 4 card subset that is a Badugi.  For example, there are 2598960 ways to choose five cards from a standard 52 card deck, of which 514800 contain a 4 card subset that is a Badugi, so f(5) = 514800.\nFind \u2211\u2009f(n)  for 4 \u2264 n \u2264 13.", "solution": "862400558448", "difficulty": 60, "story": "Once upon a time, in the small town of Mathlandia, there lived a young girl named Lily. Lily was a math enthusiast with a fondness for puzzles and a wild imagination. Her room was filled with thick books on various mathematical concepts, and her walls were adorned with colorful equation diagrams. She saw numbers come alive in her mind, and patterns danced off the pages.\n\nOne sunny afternoon, Lily received a special invitation to visit the mystical Mathematician's Manor. The manor was an enchanting place, nestled at the edge of town. Curiosity bubbled within Lily as she wondered what kind of mathematical wonders awaited her there.\n\nAs she entered the manor, Lily found herself in a grand hall filled with intriguing puzzles and brain teasers. It was here that she met an eccentric but genial old man known as Professor Fibonacci. With a white beard flowing down to his knees and eyes sparkling with wisdom, the professor welcomed Lily with open arms.\n\n\"My dear Lily, I have a challenge for you,\" the professor said, his voice full of excitement. \"Hidden within this manor is a secret knowledge, a mathematical problem waiting to be unlocked. Solve it, and you shall receive a reward that will astound you.\"\n\nLily couldn't resist such a tempting proposition. With eager eyes, she listened intently as the Professor explained the problem.\n\n\"In a standard 52-card deck of playing cards,\" he began, \"there exists a unique set of cards known as Badugi. A Badugi set contains four cards with no pairs and no two cards of the same suit. Your task is to find the number of ways to choose n cards from the deck, such that a four-card subset forms a Badugi.\"\n\nLily's mind whirled with the possibilities. She understood the implications of the problem. It was like an intricate maze waiting to be solved, and the answer lay in the patterns and symmetries of the cards.\n\nAs days turned into weeks, Lily immersed herself in her quest to find the solution. She scoured the halls of the manor, studied countless card combinations, and thought of different strategies. The professor was always at hand, offering guidance and encouragement. Lily could see the obsession growing within her, as if a fire had been ignited in her belly.\n\nTime flew by, but Lily's determination never faltered. Finally, one sunny afternoon, she stumbled upon a breakthrough. As she furiously scribbled calculations and filled pages with her findings, the beads of sweat on her forehead proved the intensity of her concentration.\n\nOnce she was satisfied with her conclusion, Lily made her way to the grand hall to face the professor. She knew she had found something extraordinary, something that would make the professor proud.\n\nWith a hint of a smile playing on his lips, Professor Fibonacci examined Lily's work. He nodded, applauding her tenacity and mathematical prowess.\n\n\"Well done, Lily!\" he exclaimed. \"You have unraveled the mystery of the Badugi card sets. Your answer will forever be etched in the annals of Mathlandia.\"\n\nLily's heart swelled with pride, but her journey was far from over. The answer she had discovered was only part of a larger puzzle. Professor Fibonacci presented Lily with a final challenge.\n\n\"Now, dear Lily,\" he said, excitement evident in his voice, \"I want you to find the sum of f(n) for 4 \u2264 n \u2264 13. Can you accomplish this final task?\"\n\nEyes shining with determination, Lily accepted the challenge. She knew that the answer lay hidden in the depths of mathematical precision, waiting to be unlocked by her mind.\n\nAnd so, the question now remains for you, dear reader. Can you solve the professor's final challenge? What is the sum of f(n) for 4 \u2264 n \u2264 13?"}, {"id": 372, "euler_id": 372, "title": "Pencils of rays", "problem": "\nLet R(M,N) be the number of lattice points (x,y) which satisfy M<x\u2264N, M<y\u2264N and \u230ay2x2\u230b is odd.\nWe can verify that R(0,100)=3019 and R(100,10000)=29750422.\nFind R(2\u22c5106,109).\n\n\nNote: \u230ax\u230b represents the floor function.", "solution": "301450082318807027", "difficulty": 60, "story": "Once upon a time, in a quaint village nestled in the rolling hills, there lived a curious young girl named Lily. Lily possessed a natural affinity for numbers and had a mind that was constantly captivated by the mysteries of mathematics.\n\nOne day, as Lily strolled through the village marketplace, she discovered an enchanting old book tugged between a stack of vintage novels. The book, bound in weathered leather and filled with intricate equations etched upon delicate pages, seemed to call out to her. Eagerly, Lily brought the book home and delved into its depths.\n\nShe turned page after page, engrossed in the timeless knowledge it held. But as she continued reading, Lily stumbled upon a peculiar mathematical problem that piqued her curiosity. The problem was as follows:\n\n\"Let R(M,N) be the number of lattice points (x,y) which satisfy M<x\u2264N, M<y\u2264N, and \u230ay^2/x^2\u230b is odd. We can verify that R(0,100)=3019 and R(100,10000)=29750422. Find R(2\u22c510^6,10^9).\"\n\nIntrigued by the challenge, Lily's eyes sparkled with the twinkle of determination. She ruminated over the problem, her mind racing with possibilities. The mathematical conundrum consumed her thoughts, intertwining with her everyday life.\n\nAs the days passed, Lily observed the people in her village carrying out their daily activities. She could not help but wonder how the mathematical problem permeated the world around her. Were the numbers hiding within the weaves of the village's tapestries or the sweet melodies the musicians played?\n\nDriven by her curiosity, Lily's once harmonious routine turned into a whirlpool of calculations and deductions. She eagerly counted the windows in every house, the petals on every flower, and even the steps of every passerby. Through her meticulous observations, she began to notice a pattern.\n\nThe curious young girl realized that the magical equation in the mysterious book was indeed a reflection of the world unfolding around her. The problem encapsulated the oddities and symmetries that interconnected all things. And she understood that the answer lay hidden within these intricate connections.\n\nOne evening, as the sun dipped below the horizon, casting the skies into a crimson hue, Lily found herself wondering about the vastness of the universe. She stood on the outskirts of the village, gazing up at the stars shimmering in the velvety darkness. And a question began to form within her, a question that would lead her closer to the solution.\n\n\"Are these celestial formations scattered across the skies, hidden within the vastness of space, somehow connected to the numbers that occupy my thoughts?\" Lily whispered to the night, her voice filled with hope and wonder.\n\nWith newfound determination, she delved back into her mathematical quest. Lily scoured the ancient book, analyzing every equation, until she unearthed the key that would unlock the answer to the enigmatic problem. And at long last, her journey reached its crescendo.\n\nBut as I share Lily's story with you, dear reader, I leave you with the same question that weighs heavily upon her curious mind: Can you find R(2\u22c510^6,10^9)? Can you piece together the pattern that encompasses the seemingly disparate elements of this mathematical conundrum?"}, {"id": 380, "euler_id": 380, "title": "Amazing Mazes!", "problem": "\nAn m\u00d7n maze is an m\u00d7n rectangular grid with walls placed between grid cells such that there is exactly one path from the top-left square to any other square. The following are examples of a 9\u00d712 maze and a 15\u00d720 maze:\n\n\n\n\nLet C(m,n) be the number of distinct m\u00d7n mazes. Mazes which can be formed by rotation and reflection from another maze are considered distinct.\n\n\nIt can be verified that C(1,1) = 1, C(2,2) = 4, C(3,4) = 2415, and C(9,12) = 2.5720e46 (in scientific notation rounded to 5 significant digits).\nFind C(100,500) and write your answer in scientific notation rounded to 5 significant digits.\n\n\nWhen giving your answer, use a lowercase e to separate mantissa and exponent.\nE.g. if the answer is 1234567891011 then the answer format would be 1.2346e12.\n\n", "solution": "6.3202e25093", "difficulty": 60, "story": "Once upon a time, in the mysterious land of Numbria, there existed a great maze unlike any other. This maze, known as the Labyrinth of Enigmas, was said to possess magical properties that could only be unlocked by solving its complex paths. Many brave adventurers had tried, but none had ever successfully reached the heart of the maze and unlocked its hidden secrets.\n\nIn the nearby village of Numeria, where the inhabitants lived harmoniously and revered mathematics, a young girl named Elara dreamed of solving the Labyrinth of Enigmas. From an early age, Elara had shown a remarkable affinity for numbers, and she spent countless hours poring over mathematical problems and puzzles.\n\nOne day, as she walked through the village square, a piece of parchment caught her eye. It was a notice posted by the king, seeking a mathematician capable of solving the Labyrinth of Enigmas. Elara's heart skipped a beat, and she knew her time had come.\n\nDetermined to prove her worth, Elara approached the king and presented her plan. She proposed to use the power of mathematics to navigate the labyrinth's intricate pathways and find the solution. The king, impressed by her confidence and persistence, agreed to let her embark on the perilous journey.\n\nEquipped with a map of the Labyrinth of Enigmas, Elara set off, accompanied by her loyal companions: a wise old gnome named Calculus and a mischievous sprite named Fibonacci. As they ventured deeper into the maze, they encountered numerous obstacles and mind-boggling puzzles.\n\nEach time they encountered a wall or a fork in the pathway, Elara used her knowledge of mathematics to analyze the possible routes. She carefully calculated the probabilities and considered countless permutations and combinations. With each step, she was closer to unlocking the maze's hidden secrets.\n\nDays turned into weeks, and weeks turned into months as Elara and her companions tirelessly navigated the maze. Along the way, they discovered that the Labyrinth of Enigmas was not just a physical maze, but a representation of a mathematical problem\u2014an m\u00d7n maze with distinct routes.\n\nElara's eyes sparkled with excitement as she realized the significance of this revelation. She had stumbled upon a mathematical conundrum that had baffled the minds of mathematicians for centuries. She knew that solving this problem would not only unlock the maze but also reveal revolutionary knowledge.\n\nAs the adventurers reached the heart of the Labyrinth of Enigmas, they found a pedestal with engravings of the mathematical problem they had encountered. It was the equation for calculating the number of distinct m\u00d7n mazes, C(m,n).\n\nElara's mind raced as she contemplated the possibilities. What secrets would be unveiled if she could find the solution to this mathematical puzzle? How many unique mazes could be created with varying dimensions?\n\nAs the sun set, Elara turned to her companions and asked, \"Can we truly find the solution to C(100,500) and uncover the secrets hidden within the Labyrinth of Enigmas?\"\n\nWith bated breath, the adventurers pondered the question. Their journey had led them to the precipice of knowledge, but only through the answers to the Labyrinth's mysteries could they truly unveil the depth of their understanding.\n\nAnd so, dear reader, I ask you: Can you find the solution to C(100,500) and unravel the enigmas that lie within?"}, {"id": 382, "euler_id": 382, "title": "Generating polygons", "problem": "\nA polygon is a flat shape consisting of straight line segments that are joined to form a closed chain or circuit. A polygon consists of at least three sides and does not self-intersect.\n\n\nA set S of positive numbers is said to generate a polygon P if: no two sides of P are the same length,\n the length of every side of P is in S, and\n S contains no other value.\n\nFor example:\nThe set {3, 4, 5} generates a polygon with sides 3, 4, and 5 (a triangle).\nThe set {6, 9, 11, 24} generates a polygon with sides 6, 9, 11, and 24 (a quadrilateral).\nThe sets {1, 2, 3} and {2, 3, 4, 9} do not generate any polygon at all.\n\nConsider the sequence s, defined as follows:s1 = 1, s2 = 2, s3 = 3\nsn = sn-1 + sn-3 for n > 3.\n\nLet Un be the set {s1, s2, ..., sn}. For example, U10 = {1, 2, 3, 4, 6, 9, 13, 19, 28, 41}.\nLet f(n) be the number of subsets of Un which generate at least one polygon.\nFor example, f(5) = 7, f(10) = 501 and f(25) = 18635853.\n\n\nFind the last 9 digits of f(1018).\n", "solution": "697003956", "difficulty": 60, "story": "Once upon a time in the mystical land of Numperia, there lived a young mathematician named Amelia. Amelia had always been fascinated by numbers and the secrets they held. She spent her days exploring the hidden connections between mathematics and the world around her.\n\nOne sunny morning, as Amelia was walking through the lush fields of Numperia, she stumbled upon an ancient tome lying under a gnarled oak tree. Curiosity sparked within her, and she eagerly picked up the book. To her surprise, it contained a series of mathematical problems and their corresponding solutions.\n\nAmelia's attention was immediately drawn to a peculiar problem about polygons and sets of numbers. The problem stated that a set of positive numbers can generate a polygon if certain conditions are met. Intrigued, Amelia delved deeper into the problem and discovered a sequence, labeled s, that would define the sets of numbers.\n\nAs she read on, Amelia's mind raced with possibilities. She wondered if she could crack the code and unveil the secrets hidden within the sequence. The mathematical challenge consumed her thoughts, and she spent countless nights experimenting and calculating.\n\nDays turned into weeks, and weeks turned into months, but Amelia remained determined. She meticulously analyzed the relationship between the sequence and the generation of polygons. She discovered that the sequence followed a pattern where each number was the sum of the previous two, except for the initial three values.\n\nAmelia's excitement grew as she realized that the sequence held the key to unlocking the mystery of the polygon sets. She could see the pieces of the puzzle coming together, inspiring her to push forward relentlessly.\n\nThe more Amelia studied, the more she understood the significance of the sets. Each subset of the sequence had the potential to generate at least one polygon. The number of these subsets, denoted by f(n), became Amelia's obsession. She dedicated herself to finding the value of f(1018), an astronomical task that would require all her ingenuity and perseverance.\n\nThe story of Amelia's quest spread throughout Numperia, captivating the townspeople. They marveled at her relentless pursuit of knowledge and admired her unwavering dedication. Crowds gathered every day, waiting eagerly for Amelia's breakthrough, hoping to witness a glimpse of the mysterious mathematical realm.\n\nAs Amelia's journey neared its climax, her mind brimmed with ideas and conjectures. She knew that unraveling the last 9 digits of f(1018) would solidify her place in mathematical history. Every night, she scanned the night sky for inspiration, searching for that final piece of the puzzle.\n\nAnd so, dear reader, the question remains: Can you find the last 9 digits of f(1018)? Will you delve into the depths of mathematical wonders with Amelia and rediscover the hidden treasures of the polygon sets? The answer lies within you, waiting to be discovered."}, {"id": 390, "euler_id": 390, "title": "Triangles with non rational sides and integral area", "problem": "Consider the triangle with sides 5, 65 and 68.\nIt can be shown that this triangle has area 9.\nS(n) is the sum of the areas of  all triangles with sides 1+b2, 1+c2 and b2+c2 (for positive integers b and c) that have an integral area not exceeding n.\nThe example triangle has b=2 and c=8.\nS(106)=18018206.\nFind S(1010).", "solution": "2919133642971", "difficulty": 60, "story": "Once upon a time, in a small village nestled in the foothills of a great mountain, there lived a young shepherd named Lucas. Lucas's life revolved around tending to his flock of sheep, day in and day out. But despite the monotonous routine, Lucas had a gift that set him apart from his fellow villagers\u2014he possessed an insatiable thirst for knowledge and a deep passion for mathematics.\n\nOne sunny morning, as Lucas was guiding his sheep to a lush meadow, he stumbled upon an old forgotten, book amidst a cluster of wildflowers. Intrigued by its weathered pages, he wiped away the dust and started to read. To Lucas's amazement, the book revealed the secret depths of the mathematical world, solving problems and posing new ones. But there was one particular problem that captured his attention like no other.\n\n\"Consider the triangle with sides 5, 65, and 68. It can be shown that this triangle has an area of 9.\" Lucas repeated the words aloud, mesmerized by the enigma before him. The problem continued, \"S(n) is the sum of the areas of all triangles with sides 1+b^2, 1+c^2, and b^2+c^2 (for positive integers b and c) that have an integral area not exceeding n.\"\n\nLucas's eyes widened as he imagined the vast array of triangles and their hidden areas, concealed within the realm of numbers. The book's authors provided an example with the triangle b=2 and c=8, stating that S(106)=18018206. This newfound knowledge fueled a yearning within Lucas to unravel the secrets that penetrated every corner of the mathematical universe.\n\nFrom that moment on, Lucas became consumed by the puzzle, day and night. He found himself constantly contemplating the possibilities, sitting beneath a moonlit sky while his flock peacefully grazed. The problem became the singular focus of his thoughts, guiding him on an endless quest for answers.\n\nAs Lucas delved deeper into the problem, he discovered mathematical symphonies hidden in the simplest of equations. Under the stars, he reveled in the beauty of prime numbers and the infinite richness of the triangular numbers. As days turned into weeks, and weeks into months, Lucas's passion for this problem grew exponentially.\n\nNews of Lucas and his insatiable thirst for knowledge spread throughout the village, reaching the ears of a renowned mathematician, Professor Amelia. Hearing of Lucas's captivating journey with the mysterious problem, Professor Amelia decided to pay him a visit. Lucas's heart skipped a beat when he saw the professor approaching his humble abode.\n\nWith a warm smile, Professor Amelia greeted Lucas and observed the worn book that lay open on the shepherd's table. \"Ah, S(n) and its elusive treasures,\" she remarked, acknowledging the problem that had taken over Lucas's life.\n\nLucas eagerly shared his discoveries and insights with the professor, recounting the wonders he had unraveled within the mathematical realm. Professor Amelia listened attentively, her eyes sparkling with joy as they discussed various proofs and conjectures related to S(n).\n\n\"But now, young shepherd,\" Professor Amelia mused, \"here lies the true test of your knowledge and determination. Find S(10^10).\" Her voice held a mix of excitement and challenge.\n\nThe question lingered in the air like an unsolved equation. Lucas pondered the magnitude of the task at hand, feeling the weight of a thousand possibilities resting upon his shoulders. But his passion burned brightly, illuminating the darkness of uncertainty.\n\nAnd so, as the moon rose high in the night sky, Lucas immersed himself in the numbers, fervently seeking the uncharted treasures that lay before him. The journey to solve S(10^10) had begun, and only time would reveal the outcome of his tireless quest.\n\nAnd now, my friend, I pose the very same question to you: Can you solve S(10^10)?"}, {"id": 404, "euler_id": 404, "title": "Crisscross Ellipses", "problem": "\nEa is an ellipse with an equation of the form x2 + 4y2 = 4a2.\nEa' is the rotated image of Ea by \u03b8 degrees counterclockwise around the origin O(0, 0) for 0\u00b0 < \u03b8 < 90\u00b0.\n\n\n\n\nb is the distance to the origin of the two intersection points closest to the origin and c is the distance of the two other intersection points.\nWe call an ordered triplet (a, b, c) a canonical ellipsoidal triplet if a, b and c are positive integers.\nFor example, (209, 247, 286) is a canonical ellipsoidal triplet.\n\n\nLet C(N) be the number of distinct canonical ellipsoidal triplets (a, b, c) for a \u2264 N.\nIt can be verified that C(103) = 7, C(104) = 106 and C(106) = 11845.\n\n\nFind C(1017).\n", "solution": "1199215615081353", "difficulty": 60, "story": "Once upon a time, in the mystical land of Elliptria, there lived a young and curious mathematician named Amelia. Amelia was known far and wide for her love of numbers and her ability to solve the most complex mathematical puzzles. People from distant lands would seek her help, and she would never disappoint them.\n\nOne day, while Amelia was reading a book on geometry, she stumbled upon an intriguing problem that piqued her interest. It was about ellipses and their rotations. In this problem, she was required to find the number of distinct canonical ellipsoidal triplets (a, b, c) for a given value of N.\n\nAmelia's mind began to race with excitement. She imagined the beautiful elliptical shapes floating in the air, rotating gracefully around an imaginary axis. She knew that the key to understanding the problem lay in visualizing the ellipses and their rotations.\n\nDetermined to solve the problem, Amelia embarked on a journey to find a legendary mathematician named Professor Euler, who was rumored to possess vast knowledge about ellipses and their transformations. After traveling through forests, mountains, and traversing treacherous rivers, Amelia found herself standing at the door of the Professor's residence.\n\nThe Professor greeted Amelia warmly and invited her inside his study. He listened intently as Amelia explained the problem and her desire to find the solution. Professor Euler smiled, his eyes gleaming with excitement\u2014it had been a long time since he had met someone so passionate about mathematics.\n\nAmelia and the Professor spent days and nights working tirelessly, devising formulas, sketching diagrams, and performing various experiments. They discovered that the problem could be solved by understanding the properties of ellipses and their rotations.\n\nEach time Amelia and the Professor made progress, they would celebrate with a cup of tea and a slice of Professor Euler's famous mathematical cake. The aroma of warm tea and the sweet taste of cake fueled their determination, pushing them closer to the answer.\n\nAs they delved deeper into the problem, they uncovered the relationship between the distance to the origin, denoted as b, and the distances of the intersection points, denoted as c. Through careful calculations and experimental analysis, they realized that the values of b and c were intricately connected to the ellipse's equation, x\u00b2 + 4y\u00b2 = 4a\u00b2.\n\nOne sunny afternoon, while taking a break from their relentless pursuit of the solution, Amelia and the Professor found themselves sitting in the Professor's lush garden. The vibrant colors of flowers surrounding them mirrored the kaleidoscope of ideas swirling in their minds.\n\nAmelia looked at the Professor and asked, \"Professor Euler, do you think we are getting closer to finding the number of distinct canonical ellipsoidal triplets (a, b, c) for C(1017)?\"\n\nThe Professor sighed, a wistful smile playing on his lips. \"Amelia, my dear, mathematics is a journey, not just a destination. We have come so far, unraveling the secrets of ellipses and rotations. But the final answer eludes us. The path to enlightenment lies before us, waiting for us to unlock its mystery.\"\n\nAmelia nodded, her eyes filled with a blend of inspiration and determination. She realized that mathematics wasn't merely about finding solutions\u2014it was about the quest for knowledge, the satisfaction of discovering new truths, and the excitement of pushing the boundaries of human understanding.\n\nAs the sun set on the horizon, casting a golden glow over the garden, Amelia and Professor Euler made a silent promise to continue their search for the answer. They knew that it would take countless more calculations, numerous experiments, and a dash of intuition to uncover the elusive number of distinct canonical ellipsoidal triplets.\n\nAnd so, dear reader, I ask you: Can you solve the mathematical problem that had Amelia and Professor Euler captivated for so long? Can you find the number of distinct canonical ellipsoidal triplets C(1017)?"}, {"id": 414, "euler_id": 414, "title": "Kaprekar constant", "problem": "\n6174 is a remarkable number; if we sort its digits in increasing order and subtract that number from the number you get when you sort the digits in decreasing order, we get 7641-1467=6174.\nEven more remarkable is that if we start from any 4 digit number and repeat this process of sorting and subtracting, we'll eventually end up with 6174 or immediately with 0 if all digits are equal. \nThis also works with numbers that have less than 4 digits if we pad the number with leading zeroes until we have 4 digits.\nE.g. let's start with the number 0837:\n8730-0378=8352\n8532-2358=6174\n\n\n6174 is called the Kaprekar constant. The process of sorting and subtracting and repeating this until either 0 or the Kaprekar constant is reached is called the Kaprekar routine.\n\n\nWe can consider the Kaprekar routine for other bases and number of digits. \nUnfortunately, it is not guaranteed a Kaprekar constant exists in all cases; either the routine can end up in a cycle for some input numbers or the constant the routine arrives at can be different for different input numbers.\nHowever, it can be shown that for 5 digits and a base b = 6t+3\u22609, a Kaprekar constant exists.\nE.g. base 15: (10,4,14,9,5)15\nbase 21: (14,6,20,13,7)21\n\nDefine Cb to be the Kaprekar constant in base b for 5 digits.\nDefine the function sb(i) to be\n 0 if i = Cb or if i written in base b consists of 5 identical digits\n the number of iterations it takes the Kaprekar routine in base b to arrive at Cb, otherwise\n\nNote that we can define sb(i) for all integers i < b5. If i written in base b takes less than 5 digits, the number is padded with leading zero digits until we have 5 digits before applying the Kaprekar routine.\n\n\nDefine S(b) as the sum of sb(i) for 0 < i < b5.\nE.g. S(15) = 5274369 \nS(111) = 400668930299\n\n\nFind the sum of S(6k+3) for 2 \u2264 k \u2264 300.\nGive the last 18 digits as your answer.\n", "solution": "552506775824935461", "difficulty": 60, "story": "Once upon a time in the peaceful village of Numeria, a young girl named Clara had a knack for patterns and numbers. Clara had always loved numbers, and she found solace in the order and logic they provided. Her favorite pastime was exploring the hidden patterns within the world around her.\n\nOne sunny afternoon, while enjoying a picnic under a large oak tree, Clara stumbled upon an old dusty book in the village library. The book's pages were filled with ancient mathematical marvels that intrigued her. As she leafed through the pages, a particular problem caught her eye - the Kaprekar routine.\n\nClara became captivated by the concept, how a number could transform through a series of calculations. She began to develop a deep curiosity about the Kaprekar constant and the patterns it created. The possibility of unlocking the secrets of this routine gave Clara a sense of purpose.\n\nDetermined to understand the Kaprekar routine, Clara spent days and nights poring over the book's worn pages. She discovered that the Kaprekar routine could be applied to various bases and number systems, but it wasn't always guaranteed to have a constant.\n\nOne evening, Clara gathered her courage and approached the wise village mathematician, Professor Archimedes. Impressed by her enthusiasm, he agreed to guide her through the world of numbers and help her uncover the secrets of the Kaprekar routine.\n\nProfessor Archimedes shared that the routine could be used to decipher and analyze patterns in various domains. From unlocking the hidden symmetries in nature to unraveling the mysteries of the universe, the Kaprekar routine held tremendous potential.\n\nEager to learn more, Clara immersed herself in the professor's teachings, grasping the complexities of the routine and its applications. They spent countless hours together, discussing different number systems and running simulations of the Kaprekar routine on large blackboards.\n\nAs Clara delved deeper, she realized that the Kaprekar routine required a keen eye for patterns and an understanding of the complexity of numbers. She also discovered a unique calculation called sb(i) that determined the number of iterations it took for the routine to reach the Kaprekar constant (Cb) for a specific base (b) and 5 digits. It was a powerful tool that unlocked the mysteries behind the routine.\n\nEnergized by her newfound knowledge, Clara and Professor Archimedes embarked on a journey to explore different bases and number systems. Together, they crisscrossed the neighboring villages, armed with their mathematical arsenal, uncovering the secrets of the Kaprekar routine.\n\nThroughout their adventures, Clara observed how the Kaprekar routine uncovered hidden symmetries in the petals of a flower, the swirls of a seashell, and the arrangement of the stars. The harmony between mathematics and nature enchanted her, fueling her determination to continue her quest for knowledge.\n\nAs their journey continued, Clara and Professor Archimedes encountered countless challenges. They encountered bases where the routine led to an unending cycle of calculations, frustrating their efforts. Yet, they remained undeterred, learning from each failure and growing ever closer to unraveling the mysteries of the Kaprekar routine.\n\nOne fateful evening, as they gazed at the night sky, Clara posed a question to Professor Archimedes. \"What if we apply the Kaprekar routine to bases that are divisible by 6, plus 3, and exclude base 9? Would it lead us to a unique Kaprekar constant?\" she asked, her voice filled with anticipation.\n\nProfessor Archimedes pondered the question, his eyes fixed on the twinkling stars above. \"Clara, my young apprentice, your question is truly fascinating. Perhaps, by narrowing our search to these specific bases, we might unlock a new and extraordinary constant.\"\n\nThe light of excitement ignited in Clara's eyes. She knew that the answer to this question held the key to a deeper understanding of the Kaprekar routine and its impact on the world.\n\nSo now, dear reader, I pose this question to you: Can you find the sum of S(6k+3) for 2 \u2264 k \u2264 300? What are the last 18 digits of this fascinating number?"}, {"id": 420, "euler_id": 420, "title": "2x2 positive integer matrix", "problem": "A positive integer matrix is a matrix whose elements are all positive integers.\nSome positive integer matrices can be expressed as a square of a positive integer matrix in two different ways. Here is an example:\n(40124840)=(23122)2=(6146)2\n\nWe define F(N) as the number of the 2x2 positive integer matrices which have a trace less than N and which can be expressed as a square of a positive integer matrix in two different ways.\nWe can verify that F(50) = 7 and F(1000) = 1019.\n\n\nFind F(107).\n", "solution": "145159332", "difficulty": 60, "story": "Once upon a time, in the small kingdom of Matheson, lived a young and curious princess named Lily. Unlike other princesses, she didn't long for a prince on a white horse to whisk her away. Instead, she had a deep love for numbers and a voracious appetite for solving mathematical puzzles.\n\nIn the heart of the kingdom stood the Matheson Academy, a renowned institution where scholars from all over the land gathered to uncover the mysteries of mathematics. Princess Lily, eager to nurture her passion, spent most of her time there, learning from the brilliant minds of the kingdom.\n\nOne sunny afternoon, while attending a lecture on number theory, Princess Lily's attention was caught by a peculiar problem presented by Professor Blake, the wisest mathematician in the realm. The problem intrigued her with its enchanting mystery.\n\nProfessor Blake revealed the problem of positive integer matrices, tracing their paths through squares and into the realm of possibilities. He showcased examples that effortlessly transcended logic and practicality by demonstrating how a positive integer matrix could be expressed in two different ways as a perfect square.\n\nPrincess Lily's mind fired with relentless curiosity. The idea of multiple interpretations fascinated her. She imagined herself tracing the intricate patterns formed by each matrix's elements, like a puzzle that revealed hidden secrets.\n\nAs the princess delved deeper into the problem, it began to consume her thoughts. She realized that the number of these perplexing 2x2 positive integer matrices could be described by F(N), where N represented the limit of the matrix's trace. Professor Blake had challenged the scholars to find F(N) for various values of N.\n\nFrom that moment on, Princess Lily's days revolved around this mystical problem. She spent countless hours poring over dusty manuscripts, unraveling the secrets of the matrices, and understanding their behavior. The princess even consulted ancient texts, hoping to find clues that would crack the enigma.\n\nEach day, as the sun dwindled on the horizon, Princess Lily wandered through the courtyards of the academy, lost in contemplation. She traced patterns in the air, whispered numbers under her breath, and visualized possibilities in her mind's eye.\n\nWeeks turned into months, and months turned into years. Princess Lily devoted herself tirelessly to the problem, determined to decipher its solution. But each step forward merely revealed further depths, pulling her deeper into the vortex of numbers.\n\nThe kingdom of Matheson heard tales of Princess Lily's unwavering dedication. People marveled at her perseverance and the passion she possessed for mathematics. She became famous throughout the land as the \"Mathematical Princess.\"\n\nAnd so, we find ourselves at the precipice of Princess Lily's journey, with the question lingering in our minds: Can she uncover the value of F(107)? Will she be the one to solve this perplexing riddle that has confounded the greatest minds?\n\nAs the final rays of the sun disappear behind the horizon, leaving the princess alone with her thoughts, we must ask ourselves if we, too, have the knowledge to unravel the mysteries of these positive integer matrices. Can we solve F(107)?"}, {"id": 440, "euler_id": 440, "title": "GCD and Tiling", "problem": "We want to tile a board of length n and height 1 completely, with either 1 \u00d7 2 blocks or 1 \u00d7 1 blocks with a single decimal digit on top:\n\n\nFor example, here are some of the ways to tile a board of length n = 8:\n\n\nLet T(n) be the number of ways to tile a board of length n as described above.\nFor example, T(1) = 10 and T(2) = 101.\nLet S(L) be the triple sum \u2211a,b,c\u2009gcd(T(ca), T(cb)) for 1 \u2264 a, b, c \u2264 L.\nFor example:\nS(2) = 10444\nS(3) = 1292115238446807016106539989\nS(4) mod 987\u00a0898\u00a0789 = 670616280.\nFind S(2000) mod 987\u00a0898\u00a0789.", "solution": "970746056", "difficulty": 60, "story": "Once upon a time, in the kingdom of Mathlandia, there was a brilliant mathematician named Professor Euler. He spent his days in his cozy study, surrounded by countless books and papers, delving into the mysteries of numbers and patterns. In his research, he stumbled upon a peculiar mathematical problem that intrigued him greatly.\n\nProfessor Euler's discovery centered around a special kind of tiling. He envisioned a rectangular board, a single unit in height, with varying lengths. This board could be tiled completely using either 1 \u00d7 2 blocks or 1 \u00d7 1 blocks, the latter of which had a single decimal digit on top. Fascinated by this puzzling problem, Euler decided to investigate further.\n\nAs he began his quest, the professor encountered a mischievous character named Lily, a young girl who possessed an inexplicable connection to the world of numbers. She had a knack for unraveling mathematical puzzles and was particularly skilled at visualizing patterns.\n\nOne sunny morning, while lost in thought, Professor Euler received a letter from Lily. In her message, she claimed to have discovered a remarkable relationship between the tiling configurations. Not wasting any time, the professor, with his curiosity piqued, summoned Lily to join him in Mathlandia.\n\nWhen Lily arrived at the professor's study, she quickly assessed the situation. She shared her findings with Professor Euler, explaining that the number of ways to tile a board of length n could be denoted as T(n). And as an example, she presented T(1) = 10 and T(2) = 101.\n\n\"Isn't it fascinating?\" Lily exclaimed, her eyes sparkling with excitement. \"The challenge lies in finding the triple sum S(L), where a, b, and c are each greater than or equal to one but not exceeding L, and we sum up the greatest common divisor (gcd) of the tiled configurations.\"\n\nProfessor Euler marveled at the complexity of the problem. Together, they pondered over the significance of this triple sum, wondering if it held any secret or revelation. The professor and Lily poured over equations, charts, and diagrams, searching for patterns and connections.\n\nDays turned into weeks, and weeks into months, as their pursuit of understanding took them on a captivating journey. They visited libraries, corresponded with renowned mathematicians, and explored the furthest corners of Mathlandia, in search of clues that would unlock the secrets hidden within T(n).\n\nAs their friendship grew stronger, Professor Euler and Lily encountered numerous challenges along the way. There were times when the patterns seemed elusive, when the numbers danced just beyond their grasp. But they persevered, driven by their shared passion for unraveling this enigma.\n\nFinally, one day, after much trial and error, they stumbled upon a breakthrough. A glimmer of realization struck Lily's mind, and without a moment's hesitation, she shared her revelation with the professor. Excitement filled the air as they marveled at the intricate connections they had unraveled.\n\nHowever, their triumph was short-lived, as Professor Euler realized that they had only scratched the surface. Their discovery begged the question: what was the value of S(2000) mod 987,898,789? It was a seemingly insurmountable task, but one that would redefine their understanding of mathematics and potentially unlock a new realm of possibilities.\n\nSo, dear reader, as the story of Professor Euler and Lily comes to a close, I invite you into their world. Can you solve the mathematical problem that has captivated their hearts and minds? What is the value of S(2000) mod 987,898,789? The answer awaits your mathematical prowess and imagination."}, {"id": 442, "euler_id": 442, "title": "Eleven-free integers", "problem": "An integer is called eleven-free if its decimal expansion does not contain any substring representing a power of 11 except 1.\nFor example, 2404 and 13431 are eleven-free, while 911 and 4121331 are not.\nLet E(n) be the nth positive eleven-free integer. For example, E(3) = 3, E(200) = 213 and E(500\u00a0000) = 531563.\nFind E(1018).", "solution": "1295552661530920149", "difficulty": 60, "story": "Once upon a time, in the quaint village of Numeria, lived a young girl named Ada. Ada was a curious and intelligent girl, who possessed a deep fascination for numbers and patterns. Her greatest joy was to spend hours poring over math puzzles and riddles, seeking solutions that would tickle her mind and satisfy her hunger for knowledge.\n\nOne sunny day, as Ada was strolling through the village market, she stumbled upon an old, dusty book tucked away amidst a collection of forgotten novelties. Intrigued, she opened the book to find a peculiar problem neatly written on the first page.\n\n\"An integer is called eleven-free if its decimal expansion does not contain any substring representing a power of 11 except 1,\" Ada murmured, her brows furrowing in concentration. She read further to discover the question that piqued her curiosity. \"Find E(10^18).\"\n\nExcitement washed over Ada as the challenge beckoned to her like a siren's call. She knew this mathematical problem would require all her wit and prowess to solve. With the book clasped tightly to her chest, Ada hurried home, her mind already brewing with ideas.\n\nDeep into the night, Ada delved into the intricate world of eleven-free integers, immersing herself in a sea of numerical possibilities. She calculated and deduced, her fingers dancing nimbly across the pages of her notebook. Slowly, patterns emerged, shedding light on the enigmatic nature of eleven-free integers.\n\nDays turned to weeks, and weeks turned to months, but Ada was undeterred. She worked tirelessly, fueled by her unyielding passion for the subject. As she delved deeper into her research, Ada realized that the hunt for E(10^18) was much more than just a quest for a solution. It was an exploration of the mathematical universe and a search for the essence of numbers.\n\nAs Ada's understanding grew, so did her appreciation for the beauty hidden within the realms of mathematics. The numbers told a story, painting a tapestry of logic and mystery. Each integer unfolded like a delicate bloom, revealing its secrets and leading her towards new discoveries.\n\nEventually, Ada's relentless pursuit bore fruit. She had derived a formula, a marvelous equation that unraveled the complexities of eleven-free numbers. Excitement coursed through her veins as she realized that she held the key to unlocking the solution she had sought for months.\n\nBut just a step away from the answer, doubt crept into Ada's mind. She pondered the weight of her discovery, the significance of solving the centuries-old puzzle. What would await her at the end of this mathematical odyssey? Would she discover something profound? Would her achievement change the world?\n\nLost in her thoughts, Ada hesitated. She pondered the meaning of her quest and the immense power contained within a seemingly simple mathematical problem. Would the answer bring enlightenment? Or would it shatter the delicate balance of the universe itself?\n\nAs the winds of uncertainty whispered around her, Ada realized that E(10^18) was not just a numerical enigma but a gateway to infinite possibilities. And so, she came to a decision.\n\nWith a flick of her pen, Ada wrote the final line of her equation. But instead of simply closing the book on her discovery, she took a deep breath and made a choice.\n\nAda tore out the page containing the solution to E(10^18), crumpling it into a ball. Gently, she placed the paper into a small wooden box, carved with ancient symbols symbolizing knowledge and wisdom. She locked the box and buried it in the depths of a nearby forest, ensuring that the answers to her mathematical journey remained hidden.\n\nThat night, as Ada rested her head on her pillow, she couldn't help but wonder about the nature of mathematical puzzles. The village of Numeria slept soundly, oblivious to the treasures concealed within their midst.\n\nAnd so, dear reader, I pose this question to you: Can you now solve the mathematical problem Ada stumbled upon? What is E(10^18)?"}, {"id": 444, "euler_id": 444, "title": "The Roundtable Lottery", "problem": "A group of p people decide to sit down at a round table and play a lottery-ticket trading game. Each person starts off with a randomly-assigned, unscratched lottery ticket. Each ticket, when scratched, reveals a whole-pound prize ranging anywhere from \u00a31 to \u00a3p, with no two tickets alike. The goal of the game is for all of the players to maximize the winnings of the ticket they hold upon leaving the game.\nAn arbitrary person is chosen to be the first player. Going around the table, each player has only one of two options:\nThe player can choose to scratch the ticket and reveal its worth to everyone at the table.\nIf the player's ticket is unscratched, then the player may trade it with a previous player's scratched ticket, and then leaves the game with that ticket. The previous player then scratches the newly-acquired ticket and reveals its worth to everyone at the table.\nThe game ends once all tickets have been scratched. All players still remaining at the table must leave with their currently-held tickets.\nAssume that players will use the optimal strategy for maximizing the expected value of their ticket winnings.\nLet E(p) represent the expected number of players left at the table when the game ends in a game consisting of p players.\nE.g. E(111)=5.2912 when rounded to 5 significant digits.\nLet S1(N)=\u2211p=1NE(p).\nLet Sk(N)=\u2211p=1NSk\u22121(p) for k>1.\nFind S20(1014) and write the answer in scientific notation rounded to 10 significant digits. Use a lowercase e to separate mantissa and exponent. For example, the answer for S3(100) would be 5.983679014e5.", "solution": "1.200856722e263", "difficulty": 60, "story": "Once upon a time, in a small village nestled in the rolling hills, there lived a group of friends who loved to play games. Every Sunday afternoon, they would gather at the village square and play games that tested their skill, wit, and luck. One Sunday, a special game was introduced that would forever change their lives and push the limits of their friendship.\n\nThe game was called the Lottery-Ticket Trading Game, and it involved a round table, some unscratched lottery tickets, and a whole lot of anticipation. The villagers were captivated by the idea, eager to try their luck and make a grand fortune.\n\nThe rules were simple, yet challenging. Each player would start with a randomly-assigned lottery ticket. These tickets had a vast range of prizes, from a lowly \u00a31 to a staggering \u00a3p, where p represented the number of players in the game. The objective was to maximize the value of your ticket by the time the game ended.\n\nAs the villagers gathered around the round table, they marveled at the colorful tickets in front of them. The excitement permeated the air as whispers of strategies and probabilities filled their minds. An arbitrary person was chosen to be the first player, and the game began.\n\nThe first player, a young woman named Amelia, faced a difficult decision. She could scratch her ticket and reveal its worth to everyone at the table or exchange it with a previously scratched ticket. As she pondered her options, a wave of calculations rushed through her mind.\n\nAmelia had always been fascinated by mathematics, and she understood the importance of maximizing the expected value of her winnings. She analyzed the probabilities of getting a higher prize by trading her ticket, considering the number of players and the values already revealed. She knew that every decision would have a significant impact on her final outcome.\n\nTaking a deep breath, Amelia decided to trade her unscratched ticket with the person sitting across from her. With bated breath, she watched as the previous ticket holder scratched the ticket and revealed its worth to everyone. It was a tense moment, filled with hopes and dreams.\n\nAs the game progressed, each player faced the same dilemma. Scratch or trade? The villagers wrestled with their strategies, adjusting their moves based on the probabilities they had calculated in their heads. The tension rose as the table emptied, and the villagers' hearts beat faster with each choice.\n\nHours turned into a blur as the game neared its end. Some players had left the table with significant winnings, while others had simply left empty-handed. It was a game of chance, strategy, and risk, intertwined in a most remarkable way.\n\nFinally, the last ticket was scratched, and the game came to an end. The remaining players surveyed their hard-earned winnings, some rejoicing while others looked on with disappointment. But there was a sense of achievement and camaraderie in the air, knowing that they had all played their best and given it their all.\n\nAs the villagers sat there, basking in their combined fortune, they couldn't help but wonder about the mathematics behind their choices. How had they reached those decisions? What were the optimal strategies for maximizing their expected value? And most importantly, what was the answer to the mathematical problem posed by the game?\n\nThey pondered those questions, knowing that the answers held an incredible wealth of knowledge. And so, as they left the village square that evening, they carried both their winnings and the burning desire to uncover the secrets hidden within the mathematical problem.\n\nAs you read this story, dear reader, do you find yourself captivated by the tale of the Lottery-Ticket Trading Game? Does the challenge of maximizing the expected value of the players' winnings enthrall your mind? Are you drawn to the mysteries of mathematics, eager to solve the intricate puzzle that lies at the heart of this story?\n\nIf so, my question to you is this: Can you find the answer to the mathematical problem presented by the game? Can you calculate S20(1014) and provide the answer in scientific notation, rounded to 10 significant digits? The villagers await your solution, eager to uncover the hidden truths that lie within the realm of numbers."}, {"id": 446, "euler_id": 446, "title": "Retractions B", "problem": "\nFor every integer n>1, the family of functions fn,a,b is defined \nby  \nfn,a,b(x)\u2261ax+bmodn for a,b,x integer and  0<a<n,0\u2264b<n,0\u2264x<n. \n\nWe will call fn,a,b a retraction if fn,a,b(fn,a,b(x))\u2261fn,a,b(x)modn for every 0\u2264x<n.\nLet R(n) be the number of retractions for n.\n\n\nF(N)=\u2211n=1NR(n4+4). \nF(1024)=77532377300600.\n\nFind F(107).\nGive your answer modulo 1000000007.\n", "solution": "907803852", "difficulty": 60, "story": "Once upon a time in the land of Numeria, there lived a young mathematics prodigy named Ethan. His love for numbers was unmatched, and he spent most of his days solving intricate mathematical problems. However, his abilities were often overlooked by his peers, who failed to understand the beauty of the world he saw through equations and decimals.\n\nOne day, while Ethan was studying in the library, he stumbled upon an ancient book of mathematical secrets. Intrigued, he opened it and discovered a problem that seemed to have never been solved before. The problem was called \"The Mystery of Retractions,\" and it challenged Ethan's skills in a way he had never experienced before.\n\nAccording to the problem, there existed a family of functions called fn,a,b, defined by fn,a,b(x)\u2261ax+bmodn. These functions were called retractions if fn,a,b(fn,a,b(x))\u2261fn,a,b(x)modn for every 0\u2264x<n. The number of retractions for each value of n was denoted as R(n). Ethan was captivated by this mysterious world of retractions and began his quest to solve the problem.\n\nDays turned into weeks, and weeks turned into months as Ethan delved deeper into the mathematical mystery. He worked tirelessly, testing different values of a, b, and x to find the patterns within the family of functions. With each step, he uncovered new insights and developed his own understanding of this mathematical realm.\n\nAs Ethan made progress, he realized that the solution to the problem was not merely numbers but rather a gateway to a greater understanding of the universe. He saw the retractions as echoes, reverberating through the mathematical fabric, connecting different realms of possibilities.\n\nThe people of Numeria soon caught wind of Ethan's pursuit and became fascinated by his mathematical journey. They could sense the significance these retractions held, and their lives began to revolve around the mystery now known as \"Ethan's Conundrum.\"\n\nEthan's dedication to solving the problem did not waiver even as time passed. He could see the parallel between the retractions and the harmonious rhythm of his own heartbeat. The numbers danced before his eyes, revealing secrets that only he could decipher.\n\nFinally, after years of relentless pursuit, Ethan stumbled upon a breakthrough\u2014a formula that could determine the number of retractions for any given value of n. Filled with excitement and a sense of accomplishment, he wrote down the formula and tucked it carefully in his pocket, afraid that revealing it prematurely would halt his journey of understanding.\n\nNow, standing on the brink of uncovering the deep truth that had evaded the greatest minds before him, Ethan faced a choice. Should he share his findings with the world, altering the course of history? Or should he continue his solitary quest, savoring the knowledge that he alone possessed?\n\nAs the sun set on Numeria, Ethan looked out at the twinkling stars, each representing a possible retraction within the vast realm of numbers. His heart swelled with pride and curiosity as he pondered his next move. The answer seemed so close, yet so far away.\n\nAnd so, dear reader, I pose this question to you: Can you solve Ethan's Conundrum? Can you find F(107) and give your answer modulo 1000000007? The future of Numeria lies in your hands."}, {"id": 460, "euler_id": 460, "title": "An ant on the move", "problem": "\nOn the Euclidean plane, an ant travels from point A(0, 1) to point B(d, 1) for an integer d.\n\n\nIn each step, the ant at point (x0, y0) chooses one of the lattice points (x1, y1) which satisfy x1 \u2265 0 and y1 \u2265 1 and goes straight to (x1, y1) at a constant velocity v. The value of v depends on y0 and y1 as follows:\n If y0 = y1, the value of v equals y0.\n If y0 \u2260 y1, the value of v equals (y1 - y0) / (ln(y1) - ln(y0)).\n\nThe left image is one of the possible paths for d = 4. First the ant goes from A(0, 1) to P1(1, 3) at velocity (3 - 1) / (ln(3) - ln(1)) \u2248 1.8205. Then the required time is sqrt(5) / 1.8205 \u2248 1.2283.\nFrom P1(1, 3) to P2(3, 3) the ant travels at velocity 3 so the required time is 2 / 3 \u2248 0.6667. From P2(3, 3) to B(4, 1) the ant travels at velocity (1 - 3) / (ln(1) - ln(3)) \u2248 1.8205 so the required time is sqrt(5) / 1.8205 \u2248 1.2283.\nThus the total required time is 1.2283 + 0.6667 + 1.2283 = 3.1233.\n\n\nThe right image is another path. The total required time is calculated as 0.98026 + 1 + 0.98026 = 2.96052. It can be shown that this is the quickest path for d = 4.\n\n\n\nLet F(d) be the total required time if the ant chooses the quickest path. For example, F(4) \u2248 2.960516287.\nWe can verify that F(10) \u2248 4.668187834 and F(100) \u2248 9.217221972.\n\n\nFind F(10000). Give your answer rounded to nine decimal places.\n", "solution": "18.420738199", "difficulty": 60, "story": "Once upon a time, in a bustling city filled with towering buildings and winding streets, there lived a young girl named Amelia. Amelia had always been fascinated by the world of mathematics. She saw numbers as magical entities that held the key to uncovering hidden truths and solving life's mysteries.\n\nOne sunny afternoon, as Amelia was walking through the city park, she stumbled upon a peculiar sight. A tiny ant, no bigger than her little finger, scurried across the ground with determination. Amelia couldn't help but be intrigued by the ant's purposeful movements.\n\nCuriosity piqued, Amelia followed the ant as it weaved through the grass, dodging blades and pebbles. The ant seemed to have a clear destination in mind. Amelia decided to embark on a mini-adventure, following the ant's path. It was as if the ant was leading her towards something extraordinary.\n\nThe ant journeyed through the park, zigzagging and changing directions at calculated intervals. Amelia marveled at its acute sense of direction, unable to fathom how such a tiny creature possessed such remarkable navigation skills.\n\nThe ant's path eventually led them to the entrance of the city's grand library. Intrigued and with a sense of anticipation, Amelia stepped inside the magnificent building. As she explored the shelves filled with ancient tomes and scholarly works, she stumbled upon a peculiar book titled \"The Ant's Journey: A Mathematical Odyssey.\"\n\nIntrigued by the title, Amelia picked up the book and flipped through the pages. She came across an enchanting illustration of the ant's journey, accompanied by a mathematical problem. It detailed the ant's chosen path from point A(0, 1) to point B(d, 1) on an imaginary grid, with each step dependent on various y-coordinate and velocity calculations.\n\nAmelia's eyes lit up with excitement. The intricate relationship between the ant's movements and mathematics fascinated her. She couldn't help but wonder how these calculations were crucial to the ant's journey and whether they played a vital role in determining its overall efficiency.\n\nAs Amelia delved further into the book, she discovered that these mathematical calculations dictated the time it took the ant to reach its destination. The ant's velocity, varying depending on its y-coordinate, affected the total required time. Curiosity consumed Amelia as she read about the nuances and intricacies of the ant's journey.\n\nDetermined to understand the full scope of the mathematical problem, Amelia devoured every piece of information available. It became clear to her that the ant's chosen path was more than just a simple route; it was a masterpiece of mathematical optimization.\n\nWith each turn, each change in velocity, the ant found the quickest possible way to reach its destination. Amelia marveled at the ant's ingenuity. It seemed to have solved an ancient puzzle, weaving its path through the mathematical fabric of space and time.\n\nAs Amelia closed the book, she couldn't help but wonder about the significance of this mathematical problem. Could it hold the key to optimizing efficiency in our own lives? Would solving it help humanity uncover hidden truths about navigation and the concept of time? What kind of remarkable insights lay dormant beneath the surface of this mesmerizing problem?\n\nLeaving the library, Amelia's mind buzzed with questions and possibilities. The ant's journey had left an indelible mark on her young, curious mind. She realized that understanding the mathematical problem held immense potential. It was no longer just about the ant's journey; it was about unlocking the mysteries that lay within the realm of mathematics.\n\nAs Amelia walked through the city streets, surrounded by the hustle and bustle, she knew that the question burned within her. It had become her personal quest, one she was determined to explore and solve.\n\nSo, dear reader, can you solve this mathematical problem? Can you find F(10000) and unravel the secrets hidden within the ant's journey? The answer awaits, like a shimmering gem, to be discovered by those who dare to venture into the depths of numbers and equations."}, {"id": 462, "euler_id": 462, "title": "Permutation of 3-smooth numbers", "problem": "\nA 3-smooth number is an integer which has no prime factor larger than 3. For an integer N, we define S(N) as the set of 3-smooth numbers less than or equal to N . For example, S(20) = { 1, 2, 3, 4, 6, 8, 9, 12, 16, 18 }.\n\n\nWe define F(N) as the number of permutations of S(N) in which each element comes after all of its proper divisors.\n\n\nThis is one of the possible permutations for N = 20.\n- 1, 2, 4, 3, 9, 8, 16, 6, 18, 12.\nThis is not a valid permutation because 12 comes before its divisor 6.\n- 1, 2, 4, 3, 9, 8, 12, 16, 6, 18.\n\n\nWe can verify that F(6) = 5, F(8) = 9, F(20) = 450 and F(1000) \u2248 8.8521816557e21.\nFind F(1018). Give as your answer its scientific notation rounded to ten digits after the decimal point.\nWhen giving your answer, use a lowercase e to separate mantissa and exponent. E.g. if the answer is 112,233,445,566,778,899 then the answer format would be 1.1223344557e17.\n", "solution": "5.5350769703e1512", "difficulty": 60, "story": "Once upon a time, in the bustling city of Mathematica, there lived a young girl named Lily. Lily was known for her insatiable curiosity and knack for solving puzzles. Her favorite pastime was exploring the enchanted forest that surrounded the city. This enchanted forest was rumored to hold many secrets and was known to bestow magical powers upon those who dared to unlock its mysteries.\n\nOne sunny morning, Lily ventured into the forest, armed with her trusty notebook and pen. As she delved deeper into the forest, she stumbled upon an ancient, overgrown path. Intrigued, she followed it, her curiosity piqued by what lay ahead.\n\nAs Lily walked along the path, she noticed intricate patterns etched on the tree trunks. The patterns seemed to form a code, a puzzle waiting to be solved. Her heart raced with excitement as she realized that this could be the key to unlocking the forest's secrets.\n\nDeep in concentration, she deciphered the code. It was a mathematical problem \u2013 a challenge that required her analytical skills. The problem described a concept called 3-smooth numbers, integers with no prime factors larger than 3. Lily was familiar with prime numbers, but this was a new concept for her.\n\nShe read further, discovering the function S(N) that represented the set of 3-smooth numbers less than or equal to a given input N. Additionally, F(N) was introduced, a function that counted the number of permutations of S(N) where each element came after all of its proper divisors.\n\nFascinated, Lily delved deeper into the problem. She explored the provided examples, understanding how permutations could be valid or invalid. The problem required her to find the value of F(1018), expressed in scientific notation and rounded to ten digits after the decimal point.\n\nAs the sun began to set, Lily emerged from the enchanted forest, reeling with excitement. She raced home, eager to solve the mathematical problem that had captivated her. The solution eluded her for hours, as she scribbled calculations and tested various permutations.\n\nFinally, when the moon was high in the sky, Lily reached a breakthrough. She found an ingenious approach that seemed to hint at the solution, but it required more than just mathematical prowess. In order to fully understand the problem's intricacies and reach a correct solution, she needed to uncover more of the enchanted forest's secrets.\n\nWith determination in her eyes, Lily decided to embark on a journey to uncover the hidden wisdom of the forest. She sought guidance from an ancient oracle, who revealed that the key to solving the mathematical problem lay in the magic of the forest itself.\n\nBut as Lily ventured deeper into the forest, she faced challenging riddles, daunting obstacles, and even encountered magical creatures. With each step, she gained more knowledge, her understanding of the forest's secrets growing exponentially.\n\nAs her knowledge expanded, Lily's determination grew stronger. She was closer than ever to unveiling the mysterious solution that eluded her. However, she knew that her journey was not yet complete.\n\nAnd so, dear reader, the question remains: Can you solve the mathematical problem that has captivated Lily's heart? The answer lies deep within the enchanted forest of Mathematica, waiting to be discovered. Will you join Lily on her journey, decipher the secrets of the forest, and uncover the value of F(1018)?"}, {"id": 464, "euler_id": 464, "title": "M\u00f6bius function and intervals", "problem": "\nThe M\u00f6bius function, denoted \u03bc(n), is defined as:\n\u03bc(n) = (-1)\u03c9(n) if n is squarefree (where \u03c9(n) is the number of distinct prime factors of n)\n\u03bc(n) = 0 if n is not squarefree.\n\nLet P(a,b) be the number of integers n in the interval [a,b] such that \u03bc(n) = 1.\nLet N(a,b) be the number of integers n in the interval [a,b] such that \u03bc(n) = -1.\nFor example, P(2,10) = 2 and N(2,10) = 4.\n\n\nLet C(n) be the number of integer pairs (a,b) such that:\n 1\u00a0\u2264\u00a0a\u00a0\u2264\u00a0b\u00a0\u2264\u00a0n,\n 99\u00b7N(a,b)\u00a0\u2264\u00a0100\u00b7P(a,b), and\n 99\u00b7P(a,b)\u00a0\u2264\u00a0100\u00b7N(a,b).\n\nFor example, C(10)\u00a0=\u00a013, C(500)\u00a0=\u00a016676 and C(10\u00a0000)\u00a0=\u00a020155319.\n\n\nFind C(20\u00a0000\u00a0000).\n", "solution": "198775297232878", "difficulty": 60, "story": "Once upon a time, in a small, ordinary village nestled at the foot of a magnificent mountain range, there lived a young girl named Lila. Despite being surrounded by the wonders of nature, Lila had a great thirst for knowledge and a love for mathematics that was unmatched by anyone else in the village.\n\nOne sunny morning, as Lila sat beneath a towering oak tree, her eyes fixated on a particularly difficult math problem in her textbook. Determined to solve it, she read the problem aloud to herself. \"Find C(20,000,000)...\" she murmured, trying to make sense of the complex equation in front of her.\n\nAs she delved deeper into the problem, Lila realized that the M\u00f6bius function played a central role in finding C(n), the number of integer pairs (a,b) that satisfied the given conditions. With each prime factor, the equation seemed to expand, challenging her logical reasoning. The mathematical problem, she realized, was beyond the scope of any normal village, even hers.\n\nHowever, Lila's desire to prove herself and her ardor for mathematics pushed her forward. She spent days and nights pouring over the equations, finding patterns and analyzing every tiny detail she could.\n\nWord of Lila's dedication and talent began to spread throughout the village, reaching the ears of an old, wise man known as Master Chen. Intrigued by this young prodigy, Master Chen sought out Lila beneath the oak tree where she spent most of her waking hours.\n\n\"Lila,\" he said, his voice rich with wisdom, \"I have heard word of your endeavor to solve the great C(n) problem. It is a formidable challenge, indeed. But I believe you possess the courage and intellect to unlock its secrets.\"\n\nLila's heart swelled with gratitude and excitement. Master Chen became her mentor, guiding her through the intricate world of number theory and the M\u00f6bius function. He shared tales of famous mathematicians who had dedicated their lives to unraveling the mysteries of these equations, inspiring Lila to keep pushing forward.\n\nAs weeks turned into months, Lila and Master Chen became inseparable. They discussed mathematical problems over countless cups of tea and pored over ancient manuscripts in search of enlightenment. Lila's village marveled at her passion and dedication, recognizing her as a true prodigy.\n\nFinally, after months of perseverance and tireless effort, Lila stumbled upon an intricate pattern hidden within the M\u00f6bius function. Her eyes widened with astonishment as she connected the dots, realizing how the numbers aligned in such a meticulous way. The equation, once a jumbled mess of digits, now appeared before her like a clear pathway through the labyrinth.\n\nEcstatic with her breakthrough, Lila rushed to find Master Chen, eager to share her discovery with him. Together, they reveled in the beauty of their findings, knowing that with this knowledge, they were on the brink of solving the formidable C(20,000,000) question.\n\nAnd so, dear reader, I ask you this: Can you continue where Lila left off? Can you find C(20,000,000)? Can you discover the number of integer pairs (a,b) that satisfy the given conditions? The answer awaits, hidden within the labyrinth of numbers, where the melodies of mathematics and the solace of logic intertwine."}, {"id": 472, "euler_id": 472, "title": "Comfortable Distance II", "problem": "There are N seats in a row. N people come one after another to fill the seats according to the following rules:\nNo person sits beside another.\nThe first person chooses any seat.\nEach subsequent person chooses the seat furthest from anyone else already seated, as long as it does not violate rule 1. If there is more than one choice satisfying this condition, then the person chooses the leftmost choice.\nNote that due to rule 1, some seats will surely be left unoccupied, and the maximum number of people that can be seated is less than N (for N > 1).\nHere are the possible seating arrangements for N = 15:\n\nWe see that if the first person chooses correctly, the 15 seats can seat up to 7 people.\nWe can also see that the first person has 9 choices to maximize the number of people that may be seated.\nLet f(N) be the number of choices the first person has to maximize the number of occupants for N seats in a row. Thus, f(1)\u00a0=\u00a01, f(15)\u00a0=\u00a09, f(20)\u00a0=\u00a06, and f(500)\u00a0=\u00a016.\nAlso, \u2211\u2009f(N) = 83 for 1\u00a0\u2264\u00a0N\u00a0\u2264\u00a020 and  \u2211\u2009f(N) = 13343 for 1\u00a0\u2264\u00a0N\u00a0\u2264\u00a0500.\nFind \u2211\u2009f(N) for 1\u00a0\u2264\u00a0N\u00a0\u2264\u00a01012. Give the last 8 digits of your answer.", "solution": "73811586", "difficulty": 60, "story": "Once upon a time in the bustling city of Numeria, there existed an enchanting theater called the Grand Equation. The Grand Equation was renowned for its intricate productions that drew in crowds from far and wide. The theater boasted a single row of seats - a seemingly mundane detail in the grand scheme of things, but little did anyone know the mathematical marvel that lay hidden within its confines.\n\nThe theater could accommodate any number of patrons, but there was a catch. Each seat was unique, crafted to adhere to a strict set of rules. No person could sit beside another, creating an atmosphere of solitude and allowing the audience members to immerse themselves fully in the performance. It was a peculiar challenge, but one that added a touch of intrigue to the Grand Equation's allure.\n\nOn a summer's eve, a young mathematician named Amelia arrived in Numeria, driven by her insatiable curiosity and passion for unraveling the secrets of numbers. As fate would have it, she stumbled upon the Grand Equation during her exploration of the city and found herself irresistibly drawn to its enigmatic charm.\n\nAmelia sought to understand the intricacies of the theater's seating arrangement, and with great determination, she embarked on a mission to uncover the true essence of the mathematical problem that lay hidden within those seats.\n\nAs she began her investigation, Amelia learned of f(N), the number of choices that the first person had to maximize the number of occupants for N seats in a row. Fascinated by this concept, she delved further into the patterns and possibilities that f(N) represented.\n\nNumbers danced before Amelia's eyes as she toiled away, poring over countless calculations and scribbling equations on parchment. She observed that if the first person chose correctly, a maximum of seven people could be seated in the row of fifteen seats. The first person possessed nine choices to maximize the number of occupants, providing ample room for exploration and strategic decision-making.\n\nWith each passing day, Amelia's wonder for the mathematical problem grew. She marveled at how the seating arrangement challenged the participants to think critically and seek the optimal solution. It was not merely a matter of filling seats but a test of ingenuity, an opportunity for the human mind to flex its mathematical muscles.\n\nFueled by her desire to unearth the secrets of f(N), Amelia persisted. She expanded her research to include larger values of N, unraveling the mysteries behind the Grand Equation's complex calculations. For N = 20, she discovered that the first person had six choices to maximize the number of occupants, while for N = 500, the number of choices increased to sixteen - a staggering achievement.\n\nTime slipped away, seasons changed, and the city of Numeria evolved around Amelia. The fruits of her labor began to bear witness as she calculated the cumulative sum of f(N). For N ranging from 1 to 20, the sum of f(N) equaled 83, a testament to the elegance and symmetry of numbers. Further still, she computed the sum for 1 to 500, reaching the astonishing tally of 13,343.\n\nYet, Amelia yearned for more. The insatiable hunger for mathematical discovery gnawed at her, pushing her to explore uncharted territories. It was then, when the sun dipped below the horizon, casting a blanket of stars over Numeria, that the mathematician asked herself the question that had eluded her throughout her journey.\n\nShe pondered the ultimate challenge - the summation of f(N) for 1 \u2264 N \u2264 1012. The scale of the problem was mind-boggling, leaving her both exhilarated and apprehensive. Amelia knew the answer lay hidden within the realm of numbers, waiting to be unveiled by an eager mind.\n\nAnd so, dear reader, I present to you the same question Amelia faced in her quest for knowledge. Can you solve the mathematical problem and unveil the sum of f(N) for 1 \u2264 N \u2264 1012? The final eight digits hold the key to unlocking a world of fascination and numerical wonder."}, {"id": 492, "euler_id": 492, "title": "Exploding sequence", "problem": "Define the sequence a1, a2, a3, ... as:\na1 = 1\nan+1 = 6an2 + 10an + 3 for n \u2265 1.\n\nExamples:\na3 = 2359\na6 = 269221280981320216750489044576319\na6 mod 1\u00a0000\u00a0000\u00a0007 = 203064689\na100 mod 1\u00a0000\u00a0000\u00a0007 = 456482974\n\n\nDefine B(x,y,n) as \u2211 (an mod p) for every prime p such that x \u2264 p \u2264 x+y.\n\n\nExamples:\nB(109, 103, 103) = 23674718882\nB(109, 103, 1015) = 20731563854\n\nFind B(109, 107, 1015).", "solution": "242586962923928", "difficulty": 60, "story": "Once upon a time in the small village of Numeria, there lived a young boy named Alex. Alex was fascinated by numbers and had an insatiable thirst for knowledge. He would spend countless hours sitting by the village's lone library, pouring over books of mathematics and solving intricate problems.\n\nOne sunny afternoon, as Alex sat engrossed in his studies, he stumbled upon a mathematical problem that piqued his curiosity. It had to do with a mysterious sequence of numbers and a function called B(x, y, n). As he delved deeper into the problem, he realized that this function calculated the sum of the remainders when certain numbers in the sequence were divided by prime numbers in a given range.\n\nDriven by his passion for numbers and the sheer challenge of solving the problem, Alex set out on a journey to crack the mysterious sequence. He traveled far and wide, seeking the guidance of renowned mathematicians and scholars, hoping they could shed some light on this perplexing puzzle.\n\nIn one of the grandest cities of mathematics, Alex met an elderly professor named Dr. Eureka. The professor had dedicated his life to unlocking the secrets of mathematics and was renowned for his profound knowledge. Excited by the opportunity to learn from the best, Alex presented the problem to Dr. Eureka and eagerly awaited his response.\n\nAs the professor listened intently, his eyes sparkled with recognition. He had encountered this problem before and had spent years trying to solve it. Dr. Eureka revealed that the sequence a1, a2, a3, ... could be derived using a recursive formula, and the function B(x, y, n) helped analyze the remainders of the sequence when divided by prime numbers.\n\nThe professor shared some examples he had discovered during his years of research, showcasing the complexity of the problem. Alex was in awe of the enormous numbers and the intricate patterns they formed. The more he listened, the more captivated he became.\n\nBut just as Dr. Eureka was about to reveal the solution to the problem, he paused and looked at Alex intently. \"My young friend,\" he said, \"this problem has fascinated generations of mathematicians. Its solution holds immense power and can unlock unimaginable possibilities. However, solving it requires ingenuity and an unrelenting pursuit of knowledge. Are you willing to embark on this challenging journey?\"\n\nAlex pondered for a moment, his heart pulsating with excitement and determination. He realized that this problem was not merely an intellectual exercise but a test of his resilience and passion for mathematics. There was no doubt in his mind that this was the opportunity of a lifetime.\n\nWith a resolute nod, Alex turned to Dr. Eureka and asked the question that burned in his mind, \"Professor, what is the value of B(109, 107, 1015)?\"\n\nAnd so began Alex's incredible quest to solve the enigmatic mathematical problem. As he ventured further into the realms of numbers and primes, he encountered new challenges, made breathtaking discoveries, and met remarkable individuals who shared his burning passion.\n\nBut what lies at the end of his journey? What is the value of B(109, 107, 1015)? Are you willing to join him on this incredible expedition, my dear reader, and unlock the secrets of this fascinating mathematical problem?"}, {"id": 503, "euler_id": 503, "title": "Compromise or persist", "problem": "Alice is playing a game with n cards numbered 1 to n.\nA game consists of iterations of the following steps.\n(1) Alice picks one of the cards at random.\n(2) Alice cannot see the number on it. Instead, Bob, one of her friends, sees the number and tells Alice how many previously-seen numbers are bigger than the number which he is seeing.\n(3) Alice can end or continue the game. If she decides to end, the number becomes her score. If she decides to continue, the card is removed from the game and she returns to (1). If there is no card left, she is forced to end the game.\nLet F(n) be the Alice's expected score if she takes the optimized strategy to minimize her score.\nFor example, F(3) = 5/3. At the first iteration, she should continue the game. At the second iteration, she should end the game if Bob says that one previously-seen number is bigger than the number which he is seeing, otherwise she should continue the game.\nWe can also verify that F(4) = 15/8 and F(10) \u2248 2.5579365079.\nFind F(106). Give your answer rounded to 10 decimal places behind the decimal point.", "solution": "3.8694550145", "difficulty": 60, "story": "Once upon a time in the peaceful town of Mathville, there lived a brilliant young girl named Alice. Alice had always been known for her exceptional intelligence and her love for all things mathematical. She was fascinated by puzzles, riddles, and brain teasers, constantly seeking new challenges to exercise her analytical mind.\n\nOne sunny afternoon, Alice received an intriguing invitation from her best friend, Bob. The letter read: \"Dear Alice, I have discovered a fascinating game that will put your mathematical prowess to the ultimate test. Meet me at the old oak tree by the riverbank tomorrow, and prepare to be amazed.\"\n\nIntrigued by the mysterious invitation, Alice eagerly counted down the minutes until the next day. As soon as the sun reached its peak, she raced to the rendezvous point, heart pounding with anticipation. As she arrived, she found Bob waiting patiently beneath the old oak tree.\n\n\"Bob, what is this game you've discovered? I can hardly wait to find out!\" Alice exclaimed, her eyes gleaming with excitement.\n\nBob, wearing a mischievous grin, held up a deck of cards. Each card was numbered, from 1 to n, though Alice couldn't quite make out the values from her vantage point.\n\n\"I call this game 'Alice's Challenge,'\" Bob declared, his voice filled with enthusiasm. \"You see, Alice, your goal is to calculate your expected score while following a strategic approach.\"\n\nAlice's curiosity was piqued as Bob explained the rules of the game. She listened intently, her mathematical brain instantly searching for the optimal strategy.\n\n\"Here's how it works,\" Bob continued. \"In each round, I will choose a card at random, but you won't know the number on it. Instead, I will tell you how many previously-seen cards have had a higher value. Based on that information, you must decide whether to continue or end the game. If you choose to end, the number on the card becomes your score. If you continue, the card is removed from the deck, and we proceed to the next round.\"\n\nAlice's mind raced with possibilities. She quickly realized that maximizing her score meant minimizing the number of cards she drew, though she couldn't help but wonder how the order of Bob's choices would affect her expected score.\n\nAs Bob shuffled the deck, Alice's mind whirled with calculations, trying to devise the optimal strategy and the way to determine her expected score for any given n.\n\n\"And now, my dear Alice, let the game commence!\" Bob declared, his eyes sparkling with anticipation.\n\nAnd so, the game began. Round after round, Bob presented Alice with new cards, and she made calculated decisions based on the information provided. Each time she chose to end the game, she curiously wrote down both her score and the number of cards remaining in the deck. The strategy behind each decision consumed her thoughts, as she toyed with the optimal path to the highest expected score.\n\nDays turned into weeks, and Alice's obsession with the game grew. She slept, ate, and breathed the strategies, tirelessly striving to conquer this mathematical conundrum.\n\nFinally, after countless iterations and exhaustive calculations, Alice stood triumphantly before Bob, her eyes shining with determination.\n\n\"Bob, I believe I have found it. I have unlocked the secret behind this game,\" Alice announced, her voice resolute. \"I can now determine the expected score, F(n), with utmost precision.\"\n\nBob's eyes widened with astonishment and pride as he listened to Alice's revelations. He had always known that Alice was one of a kind, but to see her analytical mind conquer this seemingly insurmountable problem was nothing short of extraordinary.\n\nBut just as Alice prepared to reveal her groundbreaking solution, she paused, a mischievous twinkle entering her eyes.\n\n\"Bob, my dear friend, I have a proposition for you,\" Alice said, her voice now full of mischief. \"Instead of telling you the exact value of F(n), I will pose a question to you. Can you, my brilliant Bob, solve this mathematical mystery and find F(10^6)?\"\n\nBob grinned, accepting Alice's challenge. \"Consider it done,\" he declared confidently.\n\nAnd so, dear reader, the question now falls to you. Can you uncover the secret behind Alice's Challenge and find F(10^6)? The fate of this mathematical tale rests in your hands."}, {"id": 513, "euler_id": 513, "title": "Integral median", "problem": "\nABC is an integral sided triangle with sides a\u2264b\u2264c.\nmc is the median connecting C and the midpoint of AB. \nF(n) is the number of such triangles with  c\u2264n for which mc has integral length as well.\nF(10)=3 and F(50)=165.\n\nFind F(100000).\n", "solution": "2925619196", "difficulty": 60, "story": "Once upon a time, in the peaceful village of Mathlandia, there lived a young boy named Alex. Alex was known throughout the village for his keen intellect and love for numbers. His curiosity often led him to explore the mysteries of mathematics, which frequently confused and intrigued the villagers.\n\nOne sunny day, as Alex was walking through a lush meadow near the village, he stumbled upon a dusty old book hidden within the tall grass. Excitedly brushing off the dirt, he discovered that it contained a collection of ancient mathematical problems and puzzles.\n\nFascinated, Alex flipped through the pages until he came across a problem that caught his attention. It was titled \"Triangle Medians.\"\n\nThe problem stated: \"ABC is an integral sided triangle with sides a\u2264b\u2264c. mc is the median connecting C and the midpoint of AB. F(n) is the number of such triangles with c\u2264n for which mc has an integral length as well. F(10)=3 and F(50)=165. Find F(100000).\"\n\nIntrigued by the challenge, Alex's mind began to race with possibilities. He imagined himself as a brave explorer, delving into the depths of the mathematical world, seeking answers to unravel the mysteries of the triangle medians.\n\nWith newfound determination, Alex decided to embark on a journey to solve the problem. He sought the guidance of his wise mentor, Professor Euler, who was renowned for his remarkable understanding of mathematics.\n\nProfessor Euler greeted Alex with a warm smile, sensing the young boy's enthusiasm for the problem at hand. Together, they poured over countless mathematical theories and formulas, their hands scribbling furiously across sheets of paper.\n\nAs days turned into weeks, and weeks into months, the duo delved deeper into the task at hand. They tirelessly examined various triangle configurations, exploring the relationship between the sides and medians. One by one, they checked if the triangles satisfied the condition where the median had an integral length.\n\nDespite facing numerous obstacles and dead-ends, Alex and Professor Euler remained undeterred. Their passion for mathematics fueled their journey as they pushed the boundaries of their knowledge, determined to unravel the secrets of the triangle medians.\n\nIn the midst of their tireless efforts, the two eventually discovered patterns and symmetries within the world of integral-sided triangles. The relationships between the sides and the length of the median began to reveal themselves, providing valuable insights into the solutions.\n\nWith each newfound discovery, Alex and Professor Euler grew closer to understanding the nature of these wondrous triangles. Their excitement grew as they realized they were on the verge of solving the problem that had captivated them for so long.\n\nBut as they stood on the precipice of the solution, Alex's mind began to wander. He pondered the significance of their findings\u2014what practical applications could this knowledge have? How could it be used to benefit the people of Mathlandia?\n\nUnable to ignore these thoughts, Alex proposed a challenge to Professor Euler. He suggested that they embark on a mission to apply their newfound knowledge in a way that could create positive change. Professor Euler, equally thrilled by the notion, agreed wholeheartedly.\n\nAnd so, dear reader, our story comes to an end, with a question lingering in the air, waiting for you to solve it. Can you find the value of F(100000)? Can you continue the journey that Alex and Professor Euler have embarked upon?\n\nThe mysteries of integral-sided triangles and the lengths of their medians await your exploration. The future of Mathlandia's inhabitants may just rest in your hands."}, {"id": 526, "euler_id": 526, "title": "Largest prime factors of consecutive numbers", "problem": "Let f(n) be the largest prime factor of n.\nLet g(n) = f(n) + f(n+1) + f(n+2) + f(n+3) + f(n+4) + f(n+5) + f(n+6) + f(n+7) + f(n+8), the sum of the largest prime factor of each of nine consecutive numbers starting with n.\nLet h(n) be the maximum value of g(k) for 2 \u2264 k \u2264 n.\nYou are given:\nf(100) = 5\nf(101) = 101\ng(100) = 409\nh(100) = 417\nh(109) = 4896292593Find h(1016).", "solution": "49601160286750947", "difficulty": 60, "story": "Once upon a time, in the enchanting kingdom of Numeria, lived a young boy named Ethan. Ethan had always been fascinated by numbers and loved solving mathematical puzzles. He would spend hours pouring over equations, trying to decipher their hidden secrets. Little did he know that he was about to stumble upon the greatest mathematical challenge of his life.\n\nOne sunny afternoon, while exploring a dusty attic, Ethan stumbled upon an ancient book covered in cobwebs. Intrigued, he carefully opened it, revealing pages filled with intricate symbols and equations. It was a book of forgotten mathematical knowledge, belonging to the legendary mathematician, Professor Cassius.\n\nWith wide eyes and a racing heart, Ethan dove into the book's depths. As he read on, he came across a peculiar problem that caught his attention. It read:\n\nLet f(n) be the largest prime factor of n.\nLet g(n) = f(n) + f(n+1) + f(n+2) + f(n+3) + f(n+4) + f(n+5) + f(n+6) + f(n+7) + f(n+8), the sum of the largest prime factor of each of nine consecutive numbers starting with n.\nLet h(n) be the maximum value of g(k) for 2 \u2264 k \u2264 n.\n\nEthan's eyes dazzled with curiosity. He started jotting down the given values:\n\nf(100) = 5\nf(101) = 101\ng(100) = 409\nh(100) = 417\nh(109) = 4896292593\n\nEngulfed in the magic of numbers, Ethan's imagination ran wild. He envisioned himself harnessing the power of Professor Cassius' mathematical secrets and becoming a legendary mathematician in his own right.\n\nBut what could this problem mean? How could he find h(1016)? The answer seemed impossibly distant, but Ethan was undeterred. He decided to embark on a grand adventure to unlock the secrets of this ancient puzzle.\n\nEquipped with only a backpack filled with notebooks, pencils, and a thirst for knowledge, Ethan set off on a journey through forests and mountains, toward the renowned Ivory Tower\u2014a sanctuary where the greatest minds of Numeria sought answers to life's mysteries.\n\nUpon reaching the Ivory Tower, Ethan was both awed and intimidated by the towering structure. The ancient walls echoed with the voices of scholars who had come before him. With determination in his eyes, he entered the vast library, a labyrinth of endless books and scrolls.\n\nEthan immersed himself in days and nights of tireless research, poring over countless textbooks and consulting learned professors. He explored the deepest realms of mathematics, tirelessly seeking answers to his burning questions. He jotted down theories and scribbled equations, piecing together fragments of knowledge.\n\nDays turned into weeks, weeks into months. Ethan's excitement never waned, even as he was faced with numerous dead ends and complexities. He discovered that the challenge Professor Cassius presented was a formidable one\u2014a mathematical riddle that brought together the beauty of prime numbers, series, and maximum values.\n\nAs the seasons changed outside, so did Ethan's understanding of the problem deepen. Slowly but surely, the pieces of the puzzle began to fall into place. He spent countless nights lost in thought, searching for patterns and connections, gradually building the bridge that would transport him to the elusive solution.\n\nBut as Ethan inched closer to his goal, he also started to question why he had embarked on this journey in the first place. He realized that solving the mathematical problem wasn't merely a means to an end. It was about the joy of exploration, the thrill of discovery, and the pursuit of knowledge itself.\n\nAnd so, dear reader, as we find ourselves at this juncture in Ethan's journey, I pose a question to you: Can you solve the mathematical problem that has captivated young Ethan's heart and mind? Can you determine the value of h(1016)? The answer awaits, woven deep within the fabric of numbers, waiting for you to unlock its secrets. Will you be the one to solve this riddle?\n\n"}, {"id": 528, "euler_id": 528, "title": "Constrained Sums", "problem": "Let S(n,k,b) represent the number of valid solutions to x1 + x2 + ... + xk \u2264 n, where 0 \u2264 xm \u2264 bm for all 1 \u2264 m \u2264 k.\nFor example, S(14,3,2) = 135, S(200,5,3) = 12949440, and S(1000,10,5) mod 1 000 000 007 = 624839075.\nFind (\u221110 \u2264 k \u2264 15 S(10k,k,k)) mod 1 000 000 007.", "solution": "779027989", "difficulty": 60, "story": "Once upon a time in the kingdom of Arithma, there lived a young and curious princess named Aurora. She was fascinated by numbers and loved spending her days in the royal library, exploring the vast collection of mathematical books.\n\nOne sunny morning, Aurora stumbled upon an ancient book tucked away in a forgotten corner of the library. The book had an intriguing title: \"The Secret World of Numbers.\" Eager to uncover its mysteries, the princess opened it and began to read.\n\nAs she turned the pages, a particular problem caught her eye. It was called \"The Magical Equation.\" Aurora read aloud:\n\n\"Let S(n,k,b) represent the number of valid solutions to x1 + x2 + ... + xk \u2264 n, where 0 \u2264 xm \u2264 bm for all 1 \u2264 m \u2264 k. For example, S(14,3,2) = 135, S(200,5,3) = 12949440, and S(1000,10,5) mod 1 000 000 007 = 624839075. Find (\u221110 \u2264 k \u2264 15 S(10k,k,k)) mod 1 000 000 007.\"\n\nIntrigued by the problem, Aurora pondered its implications. She realized that this equation could hold the key to unlocking incredible possibilities within the world of mathematics. But how could she prove its validity? And what could she gain from finding its solution?\n\nHer curiosity grew into a burning desire, and Aurora decided to consult with the kingdom's mathematicians. From scholars to wizards, she sought counsel from all who possessed knowledge of numbers. Each one shared a piece of wisdom, adding to her understanding of the problem.\n\nAs she delved deeper into the complexities of the equation, Aurora's intuition was heightened. She recognized patterns and observed hidden relationships between the variables. It was as if the magical equation created a doorway into a realm governed by order and logic.\n\nMonths passed, and the determined princess toiled day and night, driven by her passion for numbers. And finally, after countless hours of calculations and deep contemplation, Aurora made a breakthrough.\n\nShe discovered a correlation between the solutions to the equation and the structures of various mathematical systems. An incredible realization washed over her as she saw the equation as not just an abstract problem but a bridge connecting different branches of mathematics.\n\nExcited by her findings, Aurora felt a newfound appreciation for the importance of mathematics in society. It was more than numbers and calculations; it was a language that united the world in a common understanding.\n\nNow, as the princess prepared to present her findings to the gathered mathematicians and scholars of Arithma, she found herself overcome with a question. A question that would challenge even the brightest minds and test the limits of their mathematical prowess.\n\nWould you be able to solve the equation, dear reader? Can you find (\u221110 \u2264 k \u2264 15 S(10k,k,k)) mod 1 000 000 007 and unlock the secrets hidden within the magical equation?\n\nAs Aurora stepped onto the stage, gazing at the eager faces before her, she posed her question, a twinkle of excitement in her eyes. And in that moment, she knew that the answer held unimaginable possibilities, just waiting to be discovered."}, {"id": 530, "euler_id": 530, "title": "GCD of Divisors", "problem": "Every divisor d of a number n has a complementary divisor n/d.\nLet f(n) be the sum of the greatest common divisor of d and n/d over all positive divisors d of n, that is\nf(n)=\u2211d|ngcd(d,nd).\nLet F be the summatory function of f, that is\nF(k)=\u2211n=1kf(n).\nYou are given that F(10)=32 and F(1000)=12776.\nFind F(1015).", "solution": "207366437157977206", "difficulty": 60, "story": "Once upon a time in the small village of Numeria, there lived a clever mathematician named Amara. She had a remarkable talent for solving complex mathematical problems, and the people of Numeria admired her greatly.\n\nOne sunny morning, as Amara was sipping her tea and gazing at the beautiful landscape outside her window, a messenger burst through her door, panting heavily.\n\n\"Amara! The Royal Council requests your assistance!\" exclaimed the messenger, struggling to catch his breath.\n\nAmara quickly put on her cloak and followed the messenger to the grand castle of Numeria. Inside the council chamber, she found the King and his advisors huddled around a large parchment, deep in discussion. Sensing her presence, the King beckoned Amara closer.\n\n\"Amara, we have a great problem that we need your help with,\" the King explained. \"It's a matter of utmost importance. We must find the value of F(1015), and time is of the essence.\"\n\nAmara's eyes widened at the mention of the mathematical problem. She knew that finding F(1015) would not be an easy task. This problem had confounded many mathematicians for centuries.\n\nGently taking the parchment from the King's hands, Amara studied the numbers and equations carefully. She pondered for a moment before a smile lit up her face.\n\n\"I have an idea,\" she exclaimed. \"But in order to solve this problem, I need to travel to the Library of Ancients. There, I can consult ancient texts and seek the wisdom of the scholars who came before me.\"\n\nThe King nodded understandingly, realizing that Amara's journey held the key to unlocking the answer they sought. He provided her with a group of trusted knights as escorts and bid her farewell, wishing her good fortune on her quest.\n\nAs Amara embarked on her journey, she faced treacherous terrains and battled against fierce storms, but her determination never wavered. She finally arrived at the Library of Ancients, a grand structure filled with knowledge gathered over countless generations.\n\nDays turned into weeks as Amara tirelessly searched for hints and clues within the ancient texts. She analyzed the mathematical problem from every angle, employing her vast intellect to navigate through complex calculations and formulas.\n\nOne day, deep in thought, Amara stumbled upon a passage that seemed to hold the key to her quest. It spoke of the profound connections between divisors and their complementary divisors, much like the ones described in the mathematical problem she was trying to solve.\n\nWith newfound hope and excitement, Amara spent days meticulously applying the wisdom from the ancient texts. She conducted numerous calculations, uncovering patterns and discovering a method to arrive at F(1015).\n\nAs she emerged from the Library of Ancients, the sun began to set, casting a warm glow upon her face. Amara knew she had found the answer they sought. She had solved the mathematical problem that had plagued countless minds before her.\n\nReturning triumphantly to the castle, Amara was greeted with applause and cheers from the King and his advisors. The villagers rejoiced, knowing that their beloved mathematician had succeeded where others had failed.\n\nHowever, as Amara stood before the crowd, ready to reveal the solution, she hesitated. A mischievous smile played at the corners of her lips.\n\n\"But before I share the answer with all of you,\" Amara announced, \"I want you to embark on a journey of your own. I want you to ponder this mathematical problem just as I did. What is the value of F(1015)? Can you solve it?\"\n\nThe crowd fell silent, the challenge etched in their expressions. The villagers looked at each other, each determined to be the one to unlock the mystery.\n\nAnd so, dear reader, the question remains: What is the value of F(1015)? Can you solve it?"}, {"id": 535, "euler_id": 535, "title": "Fractal Sequence", "problem": "Consider the infinite integer sequence S starting with:S = 1, 1, 2, 1, 3, 2, 4, 1, 5, 3, 6, 2, 7, 8, 4, 9, 1, 10, 11, 5, ...\nCircle the first occurrence of each integer.S = \u2460, 1, \u2461, 1, \u2462, 2, \u2463, 1, \u2464, 3, \u2465, 2, \u2466, \u2467, 4, \u2468, 1, \u2469, \u246a, 5, ...\nThe sequence is characterized by the following properties:\nThe circled numbers are consecutive integers starting with 1.\nImmediately preceding each non-circled numbers ai, there are exactly \u230a\u221aai\u230b adjacent circled numbers, where \u230a\u230b is the floor function.\nIf we remove all circled numbers, the remaining numbers form a sequence identical to S, so S is a fractal sequence.Let T(n) be the sum of the first n elements of the sequence.\nYou are given T(1)\u00a0=\u00a01, T(20)\u00a0=\u00a086, T(103)\u00a0=\u00a0364089 and T(109)\u00a0=\u00a0498676527978348241.\nFind T(1018). Give the last 9 digits of your answer.", "solution": "611778217", "difficulty": 60, "story": "Once upon a time, in the bustling kingdom of Numeria, there lived a young mathematician named Lila. Lila had always been intrigued by numbers, their patterns, and hidden secrets. She spent her days pouring over ancient texts, deciphering cryptic equations, and unraveling the mysteries of the numerical realm.\n\nOn a bright summer morning, as Lila sat in her study engrossed in her never-ending quest for knowledge, a letter arrived addressed to her. Curious, she unfolded the parchment and read the elegant script.\n\n\"Greetings, esteemed mathematician! The Kingdom of Numeria is in desperate need of your skills. We are facing a peculiar phenomenon that has baffled our scholars for generations. Please come to the royal palace immediately. Your expertise could be the key to unraveling this enigma.\"\n\nIntrigued by the mystery that awaited her, Lila made haste and arrived at the grand palace. King Regalus himself greeted her with a warm smile, leading her to a chamber filled with scrolls and ancient texts. The room was buzzing with scholars who had been tirelessly studying the strange sequence known as \"S.\"\n\nLila immersed herself in the problem, her mind racing to make sense of the intricate pattern hidden within the numbers. She realized that the circled numbers seemed to form a consistent pattern, with each circled number being one more than the previous one. Furthermore, she observed that between the circled numbers, there were precisely the square root of the non-circled number of adjacent circled numbers.\n\nAs the days turned into weeks, Lila delved deeper into the sequence, scribbling calculations, and attempting to decipher the underlying mathematical formula. Sleepless nights turned into months, but Lila never gave up. She was determined to crack the code and solve the riddle that had plagued the kingdom for centuries.\n\nOne moonlit night, as Lila stared at the sequence, a revelation struck her like a lightning bolt. She realized that the sequence S was not just a pattern; it was a fractal sequence \u2013 a never-ending, infinitely complex pattern that held the key to understanding the mysteries of Numeria. The circled numbers acted as markers, guiding one through the fractal.\n\nWith trembling hands, Lila rushed to the king and presented her findings. Excitement filled the air as the scholars of Numeria gathered to witness the discovery. Lila explained how the sum of the sequence, denoted by T(n), could be calculated using the fractal structure of S. She described how each element of S was intricately connected to the previous ones, forming an intricate web of numerical relationships.\n\nThe king, awestruck by Lila\u2019s brilliance, eagerly asked, \"Tell me, Lila, what is T(1018)? Can you predict the last nine digits of this monumental sum?\"\n\nLila's heart skipped a beat. She knew that the answer to this question held immense power. With the last nine digits of T(1018), Numeria would be able to unlock the secrets of the universe, solve complex problems, and pave the way for a new era of discovery.\n\nAnd so, dear reader, I leave you with this question: Can you solve the conundrum that confounded even the brightest minds of Numeria? What are the last nine digits of T(1018)?"}, {"id": 536, "euler_id": 536, "title": "Modulo power identity ", "problem": "\nLet S(n) be the sum of all positive integers m not exceeding n having the following property:a m+4 \u2261 a (mod m) for all integers a.\n\n\nThe values of m \u2264 100 that satisfy this property are 1, 2, 3, 5 and 21, thus S(100) = 1+2+3+5+21 = 32.\nYou are given S(106) = 22868117.\n\n\nFind S(1012).\n", "solution": "3557005261906288", "difficulty": 60, "story": "Once upon a time, in the bustling kingdom of Numeria, lived a young mathematician named Mia. Mia had always been fascinated by numbers and patterns, and her curiosity often led her on thrilling adventures in search of mathematical enigmas to solve. One day, while engrossed in her studies, Mia stumbled upon a peculiar problem that intrigued her immensely.\n\nThe problem read:\nLet S(n) be the sum of all positive integers m not exceeding n having the following property: a m+4 \u2261 a (mod m) for all integers a.\n\nIntrigued, Mia's mathematical instincts kicked in, and she began exploring the properties of this equation. As she delved deeper into the problem, Mia uncovered a hidden pattern that she couldn't resist investigating further. The mathematical journey that awaited her seemed both thrilling and challenging at the same time.\n\nDetermined to crack the puzzle, Mia packed her bag with her trusty pen, notebook, and a map of the kingdom, and set off on her mathematical quest. All she had was a starting point\u2014the solution to S(106) was given as 22,868,117. Unbeknownst to Mia, the kingdom of Numeria was waiting for her to unlock the mystery that lay within.\n\nMia traveled from village to village, consulting with the wise elders and scholars, hoping to find any hint or clue that could guide her in solving the problem. She encountered scholars who marveled at the intricacy of the equation, yet couldn't provide her with any breakthroughs.\n\nOne day, while exploring an ancient library stacked with dusty tomes, Mia stumbled upon a musty old manuscript that caught her attention. The yellowed pages contained calculations and diagrams that seemed to hint at the solution she was searching for. Excited, Mia read through the manuscript, taking notes and deciphering the cryptic symbols.\n\nAs Mia puzzled over the ancient knowledge, her understanding of the equation grew, and she made connections that shed light on the properties of the numbers involved. The manuscript led her to the doors of a forgotten temple nestled deep in the heart of the Numerian forest. The temple's engravings depicted equations and formulas that danced across the walls, waiting for Mia to decipher them.\n\nInside the temple, Mia found herself surrounded by an aura of mystic energy, as if the spirits of the ancient mathematicians were watching her every move. Following the clues from the manuscript, Mia carefully performed calculations using the engravings as a guide. The intricate dance of numbers and symbols filled the air, as Mia combined her knowledge with that of the ancient masters.\n\nHours turned into days, and days turned into weeks, as Mia tirelessly devoted herself to unraveling the secrets of the temple. Fueled by her determination and love for mathematics, she pushed through moments of frustration and confusion.\n\nFinally, one fateful morning, as the first rays of sunlight peeked through the temple's stained glass windows, something clicked in Mia's mind. A wave of realization washed over her, and she felt an overwhelming surge of excitement. Mia had discovered the answer\u2014a revelation that seemed to unite the disparate pieces of the equation into a harmonious whole.\n\nBreathless with anticipation, Mia hurriedly recorded her solution in her notebook. With S(1012) within her grasp, Mia wondered how this newfound knowledge could impact the world of mathematics. And so, the question that lingered in her mind as she exited the temple and embarked on her journey back home was this:\n\nWhat is the value of S(1012)?\n\nWith a mixture of wonder and hope shining in her eyes, Mia set off to share her findings with fellow mathematicians, eager to learn if anyone else had solved the enigma that had captivated her for so long.\n\nWill you be the one to solve the mathematical riddle that consumed Mia's thoughts? What could the value of S(1012) be?"}, {"id": 550, "euler_id": 550, "title": "Divisor game", "problem": "\nTwo players are playing a game, alternating turns. There are k piles of stones.\nOn each turn, a player has to choose a pile and replace it with two piles of stones under the following two conditions:\n\n Both new piles must have a number of stones more than one and less than the number of stones of the original pile.\n The number of stones of each of the new piles must be a divisor of the number of stones of the original pile.\nThe first player unable to make a valid move loses.\n\nLet f(n,k) be the number of winning positions for the first player, assuming perfect play, when the game is played with k piles each having between 2 and n stones (inclusively).f(10,5)=40085.\n\n\nFind  f(107,1012).Give your answer modulo 987654321.\n", "solution": "328104836", "difficulty": 60, "story": "Once upon a time in the kingdom of Mathania, there lived two close friends, Alice and Bob. Their favorite pastime was playing games, and they would often challenge each other to test their wit. One sunny afternoon, as they sat beneath the shade of a majestic oak tree, Alice proposed a new game she had recently discovered.\n\n\"Bob, I have a fascinating game that I think you will enjoy,\" Alice said, her eyes sparkling with excitement. \"It's called 'The Piles of Stones.' Let me explain the rules.\"\n\nIntrigued, Bob nodded and listened intently as Alice explained the intricacies of the game. Two players would take turns, and there would be k piles of stones available for them. On each turn, a player could choose a pile and replace it with two new piles, following specific conditions.\n\n\"Both new piles must have a number of stones more than one but less than the original pile,\" Alice continued. \"Additionally, the number of stones in each of the new piles must be a divisor of the original pile.\"\n\nBob stroked his chin, deep in thought. \"Interesting. So, it's a game of strategy and careful calculation. The first player unable to make a valid move loses, right?\"\n\n\"Exactly!\" Alice beamed, pleased by Bob's quick understanding. \"And the best part is that we can analyze the game using mathematics. We can determine the number of winning positions for the first player, assuming perfect play, when we have k piles each having between 2 and n stones.\"\n\nBob's eyes sparkled with both curiosity and a competitive fire. \"Let's give it a try then! But, Alice, what's the mathematical expression for the number of winning positions?\"\n\nAlice smiled and pondered for a moment. \"Let's call it f(n,k). It represents the number of winning positions for the first player. If we play the game with k piles, each having between 2 and n stones inclusively, what is f(n,k)?\"\n\nThe two friends spent the entire afternoon playing the game, immersed in the strategic challenge it presented. Each move felt like a carefully crafted equation, and the excitement grew with every decision they made.\n\nAs the sun began to set on Mathania, they paused their game, their minds buzzing with calculations and possibilities.\n\n\"Bob,\" Alice finally broke the silence, \"I have a challenging question for you.\"\n\nBob's eyes shone with anticipation. \"What is it, Alice? I'm ready for it!\"\n\n\"What is f(107,1012)? Give your answer modulo 987654321.\"\n\nBob's mind whirred with the complexity of the question. He knew it would require precise calculations and careful analysis. Determined to find the solution, he looked at Alice and asked, \"Shall we continue our game tomorrow, and in the meantime, dive into the world of mathematics to solve this intriguing problem?\"\n\nAlice nodded, her eyes sparkling with anticipation. \"Absolutely, Bob. Let's solve this mathematical puzzle together and discover the secrets hidden within the piles of stones. Tomorrow, our game will continue, but for now, our minds shall embark on a thrilling journey through numbers and strategies.\"\n\nWith that, the two friends bid each other farewell, carrying with them the challenge of f(107,1012). The story of Alice and Bob's quest to solve the mathematical problem had only just begun.\n\nCan you find the answer to f(107,1012)? Give your solution modulo 987654321."}, {"id": 564, "euler_id": 564, "title": "Maximal polygons", "problem": "A line segment of length 2n\u22123 is randomly split into n segments of integer length (n\u22653). In the sequence given by this split, the segments are then used as consecutive sides of a convex n-polygon, formed in such a way that its area is maximal.  All of the (2n\u22124n\u22121) possibilities for splitting up the initial line segment occur with the same probability. \nLet E(n) be the expected value of the area that is obtained by this procedure.\nFor example, for n=3 the only possible split of the line segment of length 3 results in three line segments with length 1, that form an equilateral triangle with an area of 143. Therefore E(3)=0.433013, rounded to 6 decimal places.\nFor n=4 you can find 4 different possible splits, each of which is composed of three line segments with length 1 and one line segment with length 2. All of these splits lead to the same maximal quadrilateral with an area of 343, thus E(4)=1.299038, rounded to 6 decimal places.\nLet S(k)=\u2211n=3kE(n).\nFor example, S(3)=0.433013, S(4)=1.732051, S(5)=4.604767 and S(10)=66.955511, rounded to 6 decimal places each.\nFind S(50), rounded to 6 decimal places.", "solution": "12363.698850", "difficulty": 60, "story": "Once upon a time, in the quaint town of Mathlandia, there lived a young girl named Sophie. Sophie was known for her inquisitive mind and her love for all things mathematical. She spent her days exploring the world around her, always on the lookout for new puzzles and problems to solve.\n\nOne beautiful summer day, Sophie stumbled upon an ancient map hidden in the attic of her grandmother's house. The map led her to a secret clearing in the nearby forest, where a mysterious old man awaited her arrival.\n\n\"Welcome, Sophie,\" the old man said with a twinkle in his eyes. \"I've been waiting for you. I have a mathematical challenge for you, one that may change the way you see the world.\"\n\nIntrigued, Sophie eagerly listened as the old man presented her with the mathematical problem. He explained how a line segment of length 2n\u22123 is randomly split into n segments of integer length, and how these segments are used to form a convex n-polygon with the maximum possible area.\n\nSophie's eyes widened with excitement. She could already envision the complex shapes and structures that could be formed with such a challenge. But she also knew that the key to solving this problem lay in finding the expected value of the area, denoted as E(n).\n\nDetermined to unveil the mysteries of this mathematical puzzle, Sophie embarked on a journey of exploration and discovery. She spent hours upon hours scribbling equations and sketching diagrams, searching for patterns and connections that would lead her closer to the solution.\n\nAs the days turned into weeks, Sophie's passion for the problem grew. She began to see the world around her through a different lens, applying mathematical principles to everyday objects and scenarios. The splashing of raindrops on a puddle became a lesson in geometric shapes, and the petals of a flower were measured and classified based on complex mathematical formulas.\n\nWord of Sophie's quest spread throughout Mathlandia, and soon she found herself surrounded by curious onlookers and fellow mathematicians. The townspeople were captivated by her dedication and determination, and they eagerly awaited the day she would announce her findings.\n\nFinally, after months of relentless exploration, Sophie stood before the people of Mathlandia. With bated breath, they listened as she unveiled the result of her tireless efforts.\n\n\"S(k)=\u2211n=3kE(n),\" Sophie announced, her voice steady and confident. \"This is the sum of the expected values of the area obtained using the aforementioned procedure.\"\n\nThe crowd waited with anticipation, hoping to hear the numerical value of S(50). But instead, Sophie surprised them all with a question that lingered in the air.\n\n\"What is S(50)? Can you solve this mathematical problem that has consumed my every waking moment? The answer lies within the deeper understanding of shapes, patterns, and possibilities. Will you rise to the challenge?\"\n\nAnd with that, Sophie left the stage, leaving the people of Mathlandia inspired and determined to solve the mathematical problem she had presented. They knew that within their collective knowledge and passion for mathematics, they would find the answer to S(50), and in doing so, they would unlock the secrets of the universe.\n\nSo, dear reader, will you be the one to solve this intricate puzzle? Can you find the sum of the expected values of the area for n=3, 4, 5, all the way up to 50? The answer awaits, beckoning you to embark on your own mathematical journey and discover the wonders that lie within the realm of numbers."}, {"id": 590, "euler_id": 590, "title": "Sets with a given Least Common Multiple", "problem": "\nLet H(n) denote the number of sets of positive integers such that the least common multiple of the integers in the set equals n.\nE.g.:\nThe integers in the following ten sets all have a least common multiple of 6:\n{2,3}, {1,2,3}, {6}, {1,6}, {2,6} ,{1,2,6}, {3,6}, {1,3,6}, {2,3,6} and {1,2,3,6}.\nThus H(6)=10.\n\n\nLet L(n) denote the least common multiple of the numbers 1 through n.\nE.g. L(6) is the least common multiple of the numbers 1,2,3,4,5,6 and L(6) equals 60.\n\n\nLet HL(n) denote H(L(n)).\nYou are given HL(4)=H(12)=44.\n\n\nFind HL(50000). Give your answer modulo 109.\n", "solution": "834171904", "difficulty": 60, "story": "Once upon a time, in the enchanted Kingdom of Numeria, there lived a young magician named Ethan. Ethan possessed a magical ability to understand and manipulate numbers. From an early age, he found solace in studying complex mathematical problems that others found intimidating or bewildering. And as he grew older, his capabilities in mathematics surpassed those of any sage or scholar in the land.\n\nOne fateful day, a great calamity fell upon Numeria. A powerful curse had befallen the kingdom, causing chaos and confusion. The curse had taken the form of a swirling vortex of numbers, and it swallowed everything in its path. The people were paralyzed with fear, and their cries for help echoed through the once-vibrant streets.\n\nEthan, armed with his extraordinary mathematical prowess, knew that he had to find a way to break the curse. He spent countless sleepless nights studying ancient texts and consulting dusty tomes until, at last, he stumbled upon a passage that caught his eye.\n\nThe passage described a mathematical problem that seemed eerily similar to the curse plaguing Numeria. It spoke of sets of positive integers and their least common multiple. Ethan felt a surge of hope as he thought this might provide the key to saving his kingdom.\n\nDetermined to understand the problem, Ethan immersed himself in its intricacies. He discovered H(n), the number of sets of positive integers that had a least common multiple of n. He followed the example given in the text, creating sets that had a least common multiple of 6, such as {2,3}, {6}, and {1,2,3,6}. Astonishingly, Ethan found that H(6) equaled 10.\n\nBut Ethan\u2019s curiosity didn't end there. Another function, L(n), caught his attention. It represented the least common multiple of the numbers 1 through n. L(6), for example, gave the least common multiple of 1,2,3,4,5, and 6, which was 60.\n\nRealizing its significance, Ethan combined these functions and defined HL(n) as H(L(n)). That was when he discovered an intriguing clue within the text - HL(4) equaled H(12) and equaled 44. This realization struck Ethan like a bolt of lightning, for if he could solve for HL(50000), he might be able to unravel the curse that consumed Numeria!\n\nWith renewed determination, Ethan delved into endless calculations as he sought to determine HL(50000). The answer was eluding him, wrapped in a veil of mystery. He pondered countless possibilities, twisting and turning numbers in his mind until he nearly lost himself in the labyrinth of equations.\n\nDays turned into weeks, and weeks turned into months, yet Ethan remained undeterred. Friends and family had all but forgotten him, for he spent every waking hour trying to find the answer that would save Numeria.\n\nAs the crucial moment approached, Ethan couldn't help but wonder if he had overlooked some vital clue. Although his mind was sharp and focused, doubt gnawed at him like a persistent ache. Could it be that he was chasing a dead-end? Was there a solution to this riddle, or had he deluded himself into thinking there was a way out?\n\nNow, dear reader, the burden falls upon you. Can you, with your own mathematical prowess, find the answer to HL(50000)? Can you decipher the secret within the numbers and bring salvation to Numeria? The fate of a kingdom rests in your calculations. Will you accept the challenge and seek the answer that Ethan could not find?\n\nRemember, Numeria needs you, and the solution lies in the realm of numbers. Can you unlock the mystery and find HL(50000)?\n\nThe question awaits your answer."}, {"id": 592, "euler_id": 592, "title": "Factorial trailing digits 2", "problem": "For any N, let f(N) be the last twelve hexadecimal digits before the trailing zeroes in N!.\nFor example, the hexadecimal representation of 20! is 21C3677C82B40000,\nso f(20) is the digit sequence 21C3677C82B4.\nFind f(20!). Give your answer as twelve hexadecimal digits, using uppercase for the digits A to F.", "solution": "13415DF2BE9C", "difficulty": 60, "story": "Once upon a time in the quaint village of Hexhaven, there lived a young and curious mathematician named Ethan. With his unruly brown hair and thick round glasses, he roamed the winding streets of Hexhaven, eagerly seeking answers to complex mathematical riddles. One day, Ethan stumbled upon a dusty old book in the village library, its pages yellowed and frayed.\n\nAs he carefully opened the ancient tome, a mysterious inscription caught his attention: \"For any N, let f(N) be the last twelve hexadecimal digits before the trailing zeroes in N!.\" The young mathematician was intrigued. He had studied factorial equations before, but this problem seemed unique, begging for his attention.\n\nEthan closed the book and hurriedly made his way home, his mind buzzing with excitement. He knew that in order to solve this mathematical enigma, he had to put his skills to the test. But first, he must decipher the significance of f(N) and why it mattered.\n\nDays turned into weeks as Ethan locked himself in his room, pouring over stacks of books and scribbling equations on countless pieces of parchment. He pieced together the significance of hexadecimal digits, understanding that they were base-16 numbers represented by the symbols 0-9 and A-F. But how did this relate to the factorial equation and the trailing zeroes?\n\nWatching Ethan's obsession grow, his family worried about his isolation. His mother, Mrs. Johnson, a kind-hearted woman with a twinkle in her eye, entered his room one evening. She observed Ethan hunched over his desk, his eyes glazed with determination.\n\n\"Ethan, my dear, it's time for dinner,\" Mrs. Johnson gently said, placing a warm hand on Ethan's shoulder. \"Your mind needs nourishment just as much as your body.\"\n\n\"Please, mother, I cannot partake in such mundane activities,\" Ethan replied, his gaze still fixated on his calculations. \"I am so close to unraveling the mystery of f(N). Once I have cracked this code, it will be a breakthrough for mathematics.\"\n\nMrs. Johnson sighed, worried for her son. \"Remember, Ethan, the answers you seek are not only found in your equations but also in the beauty of the world around you. It's important not to lose sight of that.\"\n\nEthan listened to his mother's words, realizing the truth in her gentle admonition. He closed his books and agreed to accompany his family on a picnic the next day, to the lush meadows just outside Hexhaven.\n\nAs the sun rose the next morning, Ethan gazed at the beauty that surrounded him. The meadows stretched out endlessly, bathed in golden light. Butterflies fluttered through the air, and the sweet scent of wildflowers filled his nostrils.\n\nWith each breath, Ethan felt a renewed sense of purpose. He began to see patterns in the way the flowers grew, and he realized the sheer elegance of nature's mathematical harmony. The answers he longed for were not confined to dusty tomes or abstract equations; they were alive and breathing all around him.\n\nAs the picnic progressed, Ethan's mind raced with newfound inspiration. A thought struck him like a bolt of lightning. Could the answer to the mysterious f(N) lie in the factorial equation itself?\n\nWith a burst of energy, Ethan excused himself from the picnic and retreated to a quiet spot beneath a towering oak tree. He frantically scribbled down equations, his hands unable to keep up with his racing thoughts. Moments turned into hours as he immersed himself in his work, eager to crack the code.\n\nAs the sun began to set, Ethan slumped against the tree, his eyes fixed on the twilight sky. The question in the problem kept echoing in his mind: \"Find f(20!). Give your answer as twelve hexadecimal digits, using uppercase for the digits A to F.\"\n\nFrom the depths of his exhaustion, Ethan wondered if he had come any closer to finding the elusive answer. He yearned to see how the story unfolded, but found himself at a crossroads. Could he solve the riddle of f(N) on his own, or would he need to seek help beyond his own knowledge?\n\nBreathing in the cool evening air, Ethan whispered his question into the gathering darkness, hoping for an answer that would lead him towards the solution.\n\nAnd so, dear reader, as Ethan rests beneath the oak tree, his mind racing with possibilities, I pose the question to you: Can you find f(20!)? What are those twelve hexadecimal digits that hold the key to unlocking this mathematical enigma?"}, {"id": 599, "euler_id": 599, "title": "Distinct Colourings of a Rubik's Cube", "problem": "\nThe well-known Rubik's Cube puzzle has many fascinating mathematical properties. The 2\u00d72\u00d72 variant has 8 cubelets with a total of 24 visible faces, each with a coloured sticker. Successively turning faces will rearrange the cubelets, although not all arrangements of cubelets are reachable without dismantling the puzzle.\n\n\nSuppose that we wish to apply new stickers to a 2\u00d72\u00d72 Rubik's cube in a non-standard colouring. Specifically, we have n different colours available (with an unlimited supply of stickers of each colour), and we place one sticker on each of the 24 faces in any arrangement that we please. We are not required to use all the colours, and if desired the same colour may appear in more than one face of a single cubelet.\n\n\nWe say that two such colourings c1,c2 are essentially distinct if a cube coloured according to c1 cannot be made to match a cube coloured according to c2 by performing mechanically possible Rubik's Cube moves.\n\n\nFor example, with two colours available, there are 183 essentially distinct colourings.\n\n\nHow many essentially distinct colourings are there with 10 different colours available?\n", "solution": "12395526079546335", "difficulty": 60, "story": "Once upon a time, in a small village nestled amidst rolling hills, there lived a talented young artist named Lily. She had a particular knack for paints and brushes, creating the most vibrant and enchanting artworks that mesmerized everyone who laid their eyes upon them.\n\nOne day, Lily found a dusty old box tucked away in the attic of her family's cottage. Curiosity sparked within her, and she opened it to find a Rubik's Cube tucked beneath a layer of cobwebs. Memories flooded back from her childhood as she remembered the hours spent twisting and turning the colorful cube in an attempt to restore its original state.\n\nBut instead of merely revisiting her nostalgia, the Rubik's Cube intrigued Lily in a different way. She was fascinated by its mathematical properties. The idea of applying her artistic touch to the cube was irresistible. And so, she set herself a challenge - to create a one-of-a-kind masterpiece that would bequeath the cube a new identity.\n\nLily rushed to gather her paints and brushes, her mind brimming with ideas. As she sat down at her desk, she pondered how many essentially distinct colorings could be achieved with different color combinations. The Rubik's Cube became a canvas for her calculations, and she couldn't wait to uncover the answer.\n\nIn the days that followed, Lily delved into the marvelous world of colors and numbers. She mixed shades, tested combinations, and doodled in the margins of her notebook. With each stroke of her brush, she wondered if two colorings could ever be essentially distinct. It became a puzzle she was determined to solve.\n\nAs she painted, her art began to reflect her quest for uniqueness. Each face of the cube boasted a different hue, delicately crafted with love and care. The colors danced upon the canvas, merging and separating, creating a kaleidoscope of possibilities. Lily couldn't help but smile with satisfaction as she neared completion.\n\nFinally, the moment arrived when she placed the last few strokes upon the Rubik's Cube. As she held it up, her heart filled with both trepidation and excitement. Would her creation be one of the few genuinely distinctive and unique ones? Or would it blend in with the myriad of ordinary cubes that had been solved countless times?\n\nLily's eyes shone as she turned the cube in her hands, admiring her masterpiece from every angle. The colors blended effortlessly, creating something truly extraordinary. A question weighed upon her mind - how many essentially distinct colorings could be formed with ten different colors? It was a challenge she posed to herself, and now one she posed to the world.\n\nAnd thus, dear reader, I present you with the same query that enticed Lily. How many essentially distinct colorings are there with ten different colors available? Take a moment to ponder, to let the Rubik's Cube's enchanting properties seep into your thoughts. For just like Lily, you may find yourself captivated by the mesmerizing world where art and mathematics intertwine."}, {"id": 611, "euler_id": 611, "title": "Hallway of square steps", "problem": "Peter moves in a hallway with N+1 doors consecutively numbered from 0 through N. All doors are initially closed. Peter starts in front of door 0, and repeatedly performs the following steps:\nFirst, he walks a positive square number of doors away from his position.\nThen he walks another, larger square number of doors away from his new position.\nHe toggles the door he faces (opens it if closed, closes it if open).\nAnd finally returns to door 0.\nWe call an action any sequence of those steps. Peter never performs the exact same action twice, and makes sure to perform all possible actions that don't bring him past the last door.\nLet F(N) be the number of doors that are open after Peter has performed all possible actions. You are given that F(5)\u00a0=\u00a01, F(100)\u00a0=\u00a027, F(1000)\u00a0=\u00a0233 and F(106)\u00a0=\u00a0112168.\nFind F(1012).", "solution": "49283233900", "difficulty": 60, "story": "Once upon a time in a small village, there lived a young and curious boy named Peter. He was known for his adventurous spirit and his incredible love for puzzles. Peter was always on the lookout for new challenges to test his intellect.\n\nOne sunny afternoon, Peter stumbled upon an old, dusty book in the attic of his family's house. Intrigued by its weathered pages, he carefully blew away the dust and opened it up. To his surprise, the book contained a collection of puzzles, riddles, and mysteries from times long past.\n\nEagerly flipping through the pages, Peter's eyes fell upon a peculiar mathematical problem. It was about a hallway with doors that could be opened or closed. The problem described the actions of a person named Peter (quite a coincidence, he thought) as he moved along the doors, toggling them opened or closed.\n\nAs he read through the problem, Peter's mind sparked with excitement. This was just the kind of challenge he was looking for! The book stated that the number of doors open after Peter had performed all possible actions was denoted as F(N).\n\nIntrigued, Peter started to think deeply about the problem. He drew diagrams, made calculations, and tried to understand the patterns. The more he studied, the more fascinated he became. Peter discovered that F(N) varied depending on the value of N, and he wanted to know what F(1012) would be.\n\nDriven by his determination, Peter embarked on a quest to solve the mystery. He walked around the village, seeking advice and knowledge from the village elders, who were renowned for their wisdom. They shared their insights about mathematics, probability, and the patterns of numbers.\n\nPeter listened diligently, taking note of every clue and tip they offered. He came to realize that the problem wasn't just about doors and actions; it was a hidden puzzle waiting to be unraveled. It represented a pathway to unravel the hidden connections between numbers and sequences.\n\nDays turned into weeks, and weeks turned into months. Peter put his heart and soul into deciphering the problem, going beyond the realm of numbers. The mathematical puzzle had become an integral part of his life, influencing his thoughts, dreams, and daily routines.\n\nThrough his journey, Peter's understanding of mathematics deepened, and his analytical skills sharpened. He reveled in the joy of unraveling patterns and recognizing the beauty of numbers. The village soon regarded him as a prodigy, and his quest became a source of inspiration for others.\n\nNow, as Peter stood on the verge of solving F(1012), he couldn't help but wonder how this newfound knowledge could impact the world. Perhaps the puzzle held secrets that could revolutionize the way people approached mathematics and problem-solving.\n\nWith newfound excitement and determination, Peter set off on the final leg of his journey. The villagers looked on, their hopes riding high on the young prodigy's shoulders. What would F(1012) reveal? How would Peter's discovery change their understanding of numbers and their interconnections?\n\nBut as the anticipation grew, a question lingered in Peter's mind, one he couldn't answer alone. He needed others, fellow puzzle enthusiasts, to join him in unraveling the mystery. Could he find the ones willing to delve into the realm of numbers and patterns, eager to unlock the hidden secrets and solve F(1012)?\n\nAnd so, as Peter embraced the weight of his quest and the responsibility it brought, he turned his gaze to the reader, to you. Will you be the one to join him on this journey of numbers, puzzles, and the ever-elusive F(1012)?"}, {"id": 627, "euler_id": 627, "title": "Counting products", "problem": "Consider the set S of all possible products of n positive integers not exceeding m, that is\nS={x1x2\u2026xn|1\u2264x1,x2,...,xn\u2264m}.\n\nLet F(m,n) be the number of the distinct elements of the set S.\nFor example, F(9,2)=36 and F(30,2)=308.\nFind F(30,10001)\u00a0mod\u00a01000000007.", "solution": "220196142", "difficulty": 60, "story": "In the small town of Willowbrook, there lived a young girl named Lily. Lily had a peculiar passion for numbers and patterns that intrigued her curious mind. Her days were often spent exploring the outskirts of the town, peering into the depths of the vast fields and meadows for something that could feed her insatiable hunger for knowledge.\n\nOne day, as Lily wandered deeper into the countryside, she came across a hidden cottage nestled amidst a grove of ancient oak trees. The cottage appeared old and weathered, its walls adorned with faded swirls of paint. Intrigued by its mystery, Lily stepped closer and, with a hesitant hand, knocked on the door.\n\nTo her surprise, the door creaked open, revealing an elderly man with a long white beard and kind, twinkling eyes. His name was Professor Benjamin, known throughout the region for his expertise in mathematics.\n\n\"You must be Lily,\" the professor said with a smile, as if he had been expecting her. \"I've heard about your love for numbers and patterns. Come on in, my dear.\"\n\nCuriosity got the better of Lily, and she entered the cottage, marveling at the shelves filled with books on mathematics, astronomy, and various other subjects that piqued her interest. She knew she had stumbled upon a treasure trove of knowledge that would satisfy her thirst for understanding.\n\nSeveral hours passed as Professor Benjamin shared stories of great mathematicians and their discoveries. Lily listened intently, absorbing every word. Then, sensing the perfect moment to unveil something extraordinary, the professor presented her with a question.\n\n\"Have you ever thought of the possibilities that arise when we multiply positive integers?\" he asked, his eyes sparkling with anticipation.\n\nLily's mind began to race, as she contemplated the question. She envisioned numbers dancing together, their combinations creating a mesmerizing tapestry of patterns.\n\nThe professor continued, \"Consider the set S of all possible products of n positive integers not exceeding m. How many distinct elements do you think this set can have? Can you find a formula, my dear Lily?\"\n\nA sudden sense of excitement coursed through Lily's veins. She realized that within this mathematical problem lay a secret, waiting to be unraveled. The professor had given her a key to a new realm of knowledge, and she was determined to unlock it.\n\nDays turned into weeks, and Lily tirelessly worked on constructing a formula to calculate the number of distinct elements in the set S. Nights were spent poring over calculations, scribbling away by the soft glow of candlelight.\n\nFinally, after much perseverance and countless calculations, Lily discovered the beauty hidden within the numbers. As she rushed back to Professor Benjamin's cottage to share her findings, she couldn't contain her excitement.\n\nEntering the cottage, Lily found the professor waiting for her with a twinkle in his eyes, as if he already knew what she was about to say.\n\n\"Professor,\" she said, breathless with anticipation, \"I believe I've found the solution! The formula to find the number of distinct elements in the set S is F(m,n)!\"\n\nProfessor Benjamin smiled, his expression testament to his pride in his young prot\u00e9g\u00e9. \"You've done well, Lily. Now, I have one final question for you.\"\n\nLily's heart raced with anticipation as she waited for the professor's question. It felt as if the very fabric of the mathematical world rested upon her response.\n\n\"What is the value of F(30,10001) mod 1000000007?\" he asked, his voice echoing with importance.\n\nThe answer to this final question eluded Lily at that moment, but she knew she could find it. She would embark on a new journey, guided by her love for numbers, armed with the knowledge she had gained from Professor Benjamin. And as for the solution to the mathematical problem, it was now left to the reader to unravel its mysteries.\n\nSo, dear reader, can you find the value of F(30,10001) mod 1000000007? What hidden patterns lie within the set S?"}, {"id": 689, "euler_id": 689, "title": "Binary Series", "problem": "For 0\u2264x<1, define di(x) to be the ith digit after the binary point of the binary representation of x.\nFor example d2(0.25)=1, di(0.25)=0 for i\u22602.\nLet f(x)=\u2211i=1\u221edi(x)i2.\nLet p(a) be probability that f(x)>a, given that x is uniformly distributed between 0 and 1.\nFind p(0.5). Give your answer rounded to 8 digits after the decimal point.", "solution": "0.56565454", "difficulty": 60, "story": "Once upon a time in the magical land of Numeria, there lived a young sorcerer named Alex. Alex had always been fascinated by the power and beauty of numbers. He would spend hours studying prime numbers, calculating intricate equations, and exploring the depths of mathematical wonders. But one day, he stumbled upon a problem that would challenge his intellect like never before.\n\nIt was a sunny morning when Alex's mentor, the great wizard Merlin, handed him a peculiar scroll. Unfolding it carefully, Alex's eyes widened as he read the mathematical problem that lay before him.\n\n\"For 0\u2264x<1, define di(x) to be the ith digit after the binary point of the binary representation of x. For example, d2(0.25)=1, di(0.25)=0 for i\u22602. Let f(x)=\u2211i=1\u221edi(x)i2. Let p(a) be the probability that f(x)>a, given that x is uniformly distributed between 0 and 1. Find p(0.5). Give your answer rounded to 8 digits after the decimal point.\"\n\nCuriosity burned within Alex like a wildfire. The problem consumed his every thought, and he realized that solving it could unlock a new level of understanding in the realm of mathematics. But it wasn't just the allure of knowledge that enticed him. Deep down, Alex felt that the answer to this problem held a secret power, one that could reshape the course of magic itself.\n\nDriven by passion and a thirst for discovery, Alex embarked on an arduous journey across Numeria. He sought out the wise sages, the ancient libraries, and even the mythical beings who possessed great mathematical wisdom. Along the way, he encountered other adventurers who were equally fascinated by the enigmatic problem, forming an alliance dedicated to unraveling its mysteries.\n\nTogether, they delved into the intricacies of binary representation, exploring the patterns and symmetries that lay within. They discovered that the digits after the binary point played a crucial role in constructing the infinite series, f(x). As they deciphered the inner workings of this mathematical formula, a new realization dawned on them\u2014the key to understanding f(x) resided within the enigmatic world of probability.\n\nDriven by their enthusiasm, the adventurers tirelessly refined their calculations, seeking the probabilities that would unlock the secret behind f(x)>a. They simulated countless iterations, meticulously analyzing the patterns that emerged. Day and night, they pushed the boundaries of their knowledge, fueled by determination and a shared sense of wonder.\n\nBut as the months turned into years, doubt began to cast a shadow over Alex's once unwavering resolve. The complexities of the problem weighed heavily on his soul. Doubts haunted his dreams, whispering that perhaps the answer existed beyond the realm of numbers\u2014a truth he might never comprehend.\n\nOne day, as Alex stood on the precipice of abandoning his quest, he noticed a glimmer of hope in the corner of his eye. In the depths of an ancient tome, he stumbled upon a faint clue\u2014a fragment of a forgotten spell.\n\nWith renewed determination, Alex pieced together the remnants of the ancient magic, realizing that the answer to the problem was not only a mathematical solution but a magical one as well. The probability p(a) rested on the intersection of mathematics and the mystical forces that governed their world.\n\nAnd so, dear reader, as Alex stands on the brink of unlocking the ultimate secret, peering into the unknown, I must ask you: Can you solve the enigmatic problem he faces? What is p(0.5), rounded to 8 digits after the decimal point?\n\nFor in the answer to this mathematical conundrum lies the very essence of Numeria's magic, waiting to be brought to light by a curious mind."}, {"id": 690, "euler_id": 690, "title": "Tom and Jerry", "problem": "\nTom (the cat) and Jerry (the mouse) are playing on a simple graph G.\n\n\nEvery vertex of G is a mousehole, and every edge of G is a tunnel connecting two mouseholes.\n\n\nOriginally, Jerry is hiding in one of the mouseholes.\nEvery morning, Tom can check one (and only one) of the mouseholes. If Jerry happens to be hiding there then Tom catches Jerry and the game is over.\nEvery evening, if the game continues, Jerry moves to a mousehole which is adjacent (i.e. connected by a tunnel, if there is one available) to his current hiding place. The next morning Tom checks again and the game continues like this.\n\n\nLet us call a graph G a Tom graph, if our super-smart Tom, who knows the configuration of the graph but does not know the location of Jerry, can guarantee to catch Jerry in finitely many days.\nFor example consider all graphs on 3 nodes:\n\n\n\n\nFor graphs 1 and 2, Tom will catch Jerry in at most three days. For graph 3 Tom can check the middle connection on two consecutive days and hence guarantee to catch Jerry in at most two days. These three graphs are therefore Tom Graphs. However, graph 4 is not a Tom Graph because the game could potentially continue forever.\n\n\nLet T(n) be the number of different Tom graphs with n vertices. Two graphs are considered the same if there is a bijection f between their vertices, such that (v,w) is an edge if and only if (f(v),f(w)) is an edge.\n\n\nWe have T(3)=3, T(7)=37, T(10)=328 and T(20)=1416269.\n\n\nFind T(2019) giving your answer modulo 1000000007.\n", "solution": "415157690", "difficulty": 60, "story": "Once upon a time in a small town, there lived a mischievous mouse named Jerry and a cunning cat named Tom. The two were always playing games, each trying to outsmart the other. One day, Tom came up with a clever plan to catch Jerry once and for all.\n\nTom had heard of a mathematical problem that involved catching a mouse hiding in one of several mouseholes connected by tunnels. He was intrigued by this concept and decided to use it to his advantage. Tom knew that if he could construct a graph that was a Tom graph, he would be able to catch Jerry in a finite number of days.\n\nHe spent hours poring over different graphs and playing around with the configurations of mouseholes and tunnels. Tom's goal was to create a graph that would guarantee Jerry's capture. As he worked, he couldn't help but wonder how many different Tom graphs existed for various numbers of vertices.\n\nDays turned into weeks, and weeks turned into months. Tom became so engrossed in his quest to catch Jerry that he neglected his usual cat activities like chasing birds and taking catnaps. He spent every waking moment experimenting with different graphs, trying to find the perfect design that would lead to Jerry's capture.\n\nMeanwhile, Jerry, unaware of Tom's plan, continued his carefree life of mischief and escapades. He roamed the town, causing havoc wherever he went. Little did he know that Tom was closing in on him, armed with a mathematical problem.\n\nOne sunny morning, after months of tireless work, Tom finally found a graph that he believed could be the solution. It had 2019 vertices, and Tom was convinced that this particular configuration would allow him to catch Jerry in a finite number of days. He named it Graph 2019.\n\nExcitedly, Tom set out to catch Jerry using his newly discovered graph. He started his search by checking the mousehole at the center of the graph. To his satisfaction, he found Jerry hiding there. Tom had successfully caught Jerry in just one day!\n\nAs Tom celebrated his victory, a thought crossed his mind. How many different Tom graphs existed for various numbers of vertices? He was curious to know if there was a pattern, and whether the number of Tom graphs increased exponentially with the number of vertices.\n\nAnd with that question lingering in the air, the story of Tom and Jerry's eternal game continued.\n\n**Question**: Can you find T(2019), the number of different Tom graphs with 2019 vertices, giving your answer modulo 1000000007?"}, {"id": 715, "euler_id": 715, "title": "Sextuplet Norms", "problem": "Let f(n) be the number of 6-tuples (x1,x2,x3,x4,x5,x6) such that:\nAll xi are integers with 0\u2264xi<n\ngcd(x12+x22+x32+x42+x52+x62,\u00a0n2)=1\nLet G(n)=\u2211k=1nf(k)k2\u03c6(k)\nwhere \u03c6(n) is Euler's totient function.\nFor example, G(10)=3053 and G(105)\u2261157612967(mod1000000007).\nFind G(1012)mod1000000007.", "solution": "883188017", "difficulty": 60, "story": "Once upon a time in the magical land of Numeria, there lived a young wizard named Eli. Eli was known for his unparalleled mastery of mathematics and his ability to solve the most challenging problems with ease. His intelligence and wit made him a favorite among the wizards and a point of interest for the King himself. \n\nOne day, a raven arrived at the entrance of Eli's small cottage, bearing a message. It was an invitation from the King to participate in a grand mathematics competition. The competition was held every century, and the winner was granted a wish of their choosing. Eli's heart skipped a beat with excitement as he read the message. He had always dreamed of unraveling the mysteries of numbers and discovering the hidden patterns within them, and becoming the winner of the competition would be a dream come true.\n\nEli arrived at the grand hall of the castle, where the competition was to take place. The room was filled with chatter, and wizards from all over Numeria had gathered to test their skills. The King sat on his throne, waiting to greet each participant personally. When Eli's turn came, the King smiled warmly and said, \"Eli, I have a puzzle for you, a mathematical conundrum that has puzzled the greatest minds of Numeria. Solve it, and the wish of your heart shall be granted.\"\n\nThe King presented Eli with the mysterious mathematical problem, describing the function f(n) and its relationship to Euler's totient function, \u03c6(n). The room fell silent as Eli studied the problem. He realized the significance of the challenge and how it would test his understanding of number theory and his ability to think critically.\n\nDays turned into nights, and Eli immersed himself in the depths of the mathematics problem. Hour after hour, he scribbled calculations on parchment, consulted ancient texts, and experimented with different formulas. His eyes sparkled with determination, and his mind raced with possibilities. He was driven by the desire to solve the problem, not only to win the competition but also to uncover the beauty hidden within the numbers.\n\nAs the days passed, the other participants grew weary and soon started to lose hope. The competition was fierce, but Eli's dedication and talent became evident to all. Rumors spread throughout the kingdom about the young wizard who was on the verge of solving the unsolvable. Even the King himself couldn't help but anticipate the outcome.\n\nFinally, the day of reckoning arrived. Eli was called to the stage to present his solution. A hushed silence fell upon the room as all eyes turned towards him. Eli took a deep breath, feeling the weight of the moment upon his shoulders. Slowly, he walked towards the podium, his confident stride reflecting the knowledge he had gained during his tireless efforts.\n\nWith a voice filled with conviction, Eli began explaining his solution, eloquently describing the intricacies of the mathematical problem. As he spoke, the audience was captivated by his brilliance, each word shaping a world of numbers within their minds. Even the King, who had heard countless presentations in his lifetime, found himself spellbound by Eli's explanations.\n\nFinally, Eli concluded his presentation, leaving the room in a state of awe. The judges conferred amongst themselves, pondering the complexity and brilliance of Eli's solution. After what felt like an eternity, a smile spread across the face of the lead judge, and he declared, \"Eli, your solution is both elegant and correct. You have not only solved a puzzle that has troubled us for ages, but you have also expanded our understanding of number theory. You are the winner of this year's competition.\"\n\nThe cheers and applause echoed through the grand hall as Eli's victory was celebrated. The King himself approached Eli with a smile, ready to grant him his well-deserved wish. However, just as Eli was about to make his wish known, a mischievous twinkle appeared in the King's eye. He leaned forward and whispered into Eli's ear, \"You have proven yourself to be a master of numbers, but there is still one challenge left. Tell me, young wizard, what is G(1012)mod1000000007?\"\n\nThe question hung in the air, and Eli's heart skipped a beat once again. His mind raced with possibilities, and determination filled his eyes. The King's little game had ignited a new flame within Eli. He knew the answer lay hidden within the numbers, and this was a challenge he would gladly accept.\n\nAnd so, dear reader, the question remains: What is G(1012)mod1000000007? Can you unlock the answer and solve the final challenge that awaits Eli?"}, {"id": 747, "euler_id": 747, "title": "Triangular Pizza", "problem": "Mamma Triangolo baked a triangular pizza. She wants to cut the pizza into n pieces. She first chooses a point P in the interior (not boundary) of the triangle pizza, and then performs n cuts, which all start from P and extend straight to the boundary of the pizza so that the n pieces are all triangles and all have the same area.\nLet \u03c8(n) be the number of different ways for Mamma Triangolo to cut the pizza, subject to the constraints.\nFor example, \u03c8(3)=7.\n\n\nAlso \u03c8(6)=34, and \u03c8(10)=90.\nLet \u03a8(m)=\u2211n=3m\u03c8(n). You are given \u03a8(10)=345 and \u03a8(1000)=172166601.\nFind \u03a8(108). Give your answer modulo 1000000007.", "solution": "681813395", "difficulty": 60, "story": "Once upon a time in the vibrant city of Numeria, there lived Mamma Triangolo, a renowned mathematician and a talented chef. Not only did she possess a brilliant mind for solving complex equations, but she also had a remarkable ability to turn ordinary ingredients into extraordinary culinary masterpieces.\n\nOne sunny morning, Mamma Triangolo found herself in her kitchen, inspired to create something special. She decided to bake a triangular pizza, a challenge she had never attempted before. With great care, she blended the finest ingredients to form a perfect triangle-shaped dough, fluffy and aromatic.\n\nAs the pizza baked in the scorching oven, Mamma Triangolo pondered an intriguing mathematical problem that had occupied her thoughts lately. She wanted to cut the pizza into n pieces, each forming a triangle and having the same area. But how many different ways could she achieve this? She named this problem \u03c8(n).\n\nWhile the pizza turned golden and crispy, Mamma Triangolo's mind delved into the possibilities. The challenge fascinated her, presenting patterns and calculations. She sketched diagrams, scribbled equations, and lost herself in the labyrinth of numbers.\n\nOnce the pizza emerged from the oven, its savory aroma filled the air. Mamma Triangolo marveled at her creation. It was indeed a perfect triangular pizza! But the mystery of \u03c8(n) still lingered in her mind. How many ways could she trim it, ensuring each resultant triangle had the same area?\n\nThe mathematical problem weighed heavily on her, affecting her daily life. Guests would visit Mamma Triangolo's restaurant, enchanted by her cuisine, but each time they ordered the triangular pizza, she couldn't help but wonder about \u03c8(n).\n\nDays turned into weeks, and Mamma Triangolo's culinary expertise continued to grow. Her restaurant became a gathering place for intellectuals, philosophers, and artists. They were drawn to her delectable creations, but also to the way she effortlessly blended mathematics and food.\n\nOne evening, as Mamma Triangolo sat on the balcony of her restaurant, a young mathematician named Luca approached her. He had heard rumors about the famous triangular pizza and was eager to meet the woman who had created it.\n\nMamma Triangolo couldn't help but notice the spark in Luca's eyes as he spoke about the beauty of numbers and their hidden patterns. He shared her passion for mathematics. An idea struck her like a lightning bolt.\n\nWith a smile on her face, Mamma Triangolo extended an invitation to Luca, offering him a chance to tackle the enigma of \u03c8(n) together. They spent days and nights immersed in calculations, discussing countless possibilities and drawing intricate diagrams.\n\nMonths flew by, but their determination never wavered. The charming city of Numeria witnessed their shared pursuit of unraveling the secret behind \u03c8(n). People marveled at their dedication, encouraged by their spirit.\n\nFinally, after years of collaboration, Mamma Triangolo and Luca made a groundbreaking discovery. They revealed \u03c8(3), \u03c8(6), and even \u03c8(10) to the world, showing that there were indeed 7, 34, and 90 distinct ways to cut the triangular pizza into three, six, and ten equal-area triangles, respectively.\n\nTheir work attracted recognition from across the globe, and their research took them to far-flung conferences and symposiums, where they spread knowledge and ignited the mathematician's flame in young minds. Eventually, they discovered \u03a8(10) equaled 345 and that \u03a8(1000) amounted to the astonishing number of 172166601.\n\nNow, dear reader, the time has come to unlock the final puzzle. The journey of Mamma Triangolo and Luca is nearing its end, but the mathematical problem remains. Can you find \u03a8(108)? Give your answer modulo 1000000007.\n\nAs you take a moment to ponder this question, remember that every piece of knowledge gained, every equation solved, brings us one step closer to the infinite possibilities hidden within the realm of numbers."}, {"id": 767, "euler_id": 767, "title": "Window into a Matrix II", "problem": "A window into a matrix is a contiguous sub matrix.\nConsider a 16\u00d7n matrix where every entry is either 0 or 1.\nLet B(k,n) be the total number of these matrices such that the sum of the entries in every 2\u00d7k window is k.\nYou are given that B(2,4)=65550 and B(3,9)\u226187273560(mod1000000007).\nFind B(105,1016). Give your answer modulo 1000000007.", "solution": "783976175", "difficulty": 60, "story": "Once upon a time, in the peaceful village of Mathlandia, lived a young mathematician named Maya. Maya had a brilliant mind and a burning curiosity that led her to unravel the mysteries of numbers and patterns. Her favorite place to ponder equations and solve problems was the cozy library in the heart of the village.\n\nOne sunny morning, while Maya was engrossed in a book about matrices, she stumbled upon an intriguing problem. The book revealed a window into the world of matrices, presenting a question that captured her attention immediately.\n\nIn this fascinating problem, Maya learned about a special type of window called a contiguous sub matrix. It stated that a contiguous sub matrix is a rectangular section within a larger matrix that consists of adjacent rows and columns. Furthermore, this particular problem dealt with a specific 16\u00d7n matrix. In every entry of this matrix, there could only be two possibilities: 0 or 1.\n\nThe problem, however, didn't stop there. It introduced a concept called B(k,n), which represented the total number of contiguous sub matrices. These matrices possessed a compelling property: the sum of the entries in every 2\u00d7k window equaled k.\n\nMaya's mathematical instincts kicked in, and she couldn't help but delve into the depths of this enchanting problem. The book offered a glimpse into the solution to B(2,4), which stood at a staggering 65550. The magnitude of this number surprised Maya, fueling her desire to explore even more.\n\nEager to apply her knowledge, Maya decided to embark on a quest to solve the next part of the problem: finding B(3,9). It was mentioned in the book that B(3,9) \u2261 87273560 (mod 1000000007). Although Maya was unsure of what \"mod\" meant, she had a hunch that it had something to do with a remainder.\n\nWith an insatiable thirst for answers and driven by her love for mathematics, Maya dedicated weeks to finding the elusive B(3,9). She immersed herself in research, studied countless matrices, and examined patterns arising from different combinations of 0s and 1s. Maya spent sleepless nights experimenting with ideas, her mind buzzing with excitement.\n\nFinally, the day arrived when Maya unraveled B(3,9)\u2261 87273560 (mod 1000000007). It was a euphoric moment for her, as if she had unraveled a secret code woven into the fabric of numbers. She couldn't contain her jubilation and ran throughout the village, sharing her newfound achievement with anyone willing to listen.\n\nBut amidst the celebration, Maya's excitement couldn't be contained. She yearned for more challenges, greater possibilities. Her heart ached to tackle the ultimate mathematical puzzle: B(105, 1016).\n\nMaya's quest had just begun. Determined to uncover the secrets hidden within the matrix, she put everything else aside and focused solely on finding B(105, 1016). Months passed as her dedication remained unyielding. She spent countless hours analyzing complex patterns, developing ingenious algorithms, and sifting through an unimaginable number of combinations.\n\nNow, dear reader, the time has come for you to step into the story. Can you solve the ultimate mathematical conundrum that Maya devoted her life to unlock? Tell me, what is B(105, 1016)? Remember, you must give your answer modulo 1000000007.\n\nAs the tale of Maya continues, the final chapter awaits its resolution. Will you be the one to solve this perplexing problem and illuminate the path forward? Only you hold the key to the conclusion of Maya's extraordinary journey."}, {"id": 791, "euler_id": 791, "title": "Average and Variance", "problem": "Denote the average of k numbers x1,...,xk by x\u00af=1k\u2211ixi. Their variance is defined as 1k\u2211i(xi\u2212x\u00af)2.\nLet S(n) be the sum of all quadruples of integers (a,b,c,d) satisfying 1\u2264a\u2264b\u2264c\u2264d\u2264n such that their average is exactly twice their variance.\nFor n=5, there are 5 such quadruples, namely: (1,1,1,3),(1,1,3,3),(1,2,3,4),(1,3,4,4),(2,2,3,5).\nHence S(5)=48. You are also given S(103)=37048340.\nFind S(108). Give your answer modulo 433494437.", "solution": "404890862", "difficulty": 60, "story": "Once upon a time, in the bustling city of Mathville, there lived a young and ambitious mathematician named Alice. Alice was known for her uncanny ability to solve complex mathematical problems, and she reveled in the challenge they brought. Her deep fascination with numbers made her the talk of the town, and her name echoed through the corridors of the prestigious Mathville University.\n\nOne ordinary day, as Alice sat in her favorite coffee shop, sipping her latte and pondering the mysteries of numbers, a peculiar envelope arrived at her table. Intrigued, she carefully opened it and found a cryptic message written on a sheet of old parchment. The message read:\n\n\"Alice, dear mathematician extraordinaire, your skills are about to be put to the ultimate test. Inside this envelope lies a mathematical problem that will have profound implications on the future of Mathville. Find the sum of all quadruples of integers satisfying a specific condition, and you shall be rewarded handsomely.\"\n\nCuriosity piqued, Alice unfolded another sheet of paper within the envelope and scanned the problem. At first glance, it seemed daunting, but Alice's excitement grew with every word she read. This mathematical problem involved finding the sum of quadruples with a peculiar average-to-variance ratio. Could this formula hold the key to something greater?\n\nAs Alice delved into the problem, her heartbeat quickened. She spent countless hours in her cozy study, pouring over numbers, and scribbling equations on the countless papers that blanketed her desk. Days turned into weeks, and weeks turned into months, but Alice never wavered in her determination.\n\nThe problem consumed her every waking moment, and Mathville became a blurred backdrop to her solitary existence. She would often find herself gazing out of the window, pondering the relationship between averages and variances, and how it could affect the world she knew.\n\nOne fateful evening, just as Alice's frustration reached its peak, a breakthrough came. She fell into a deep sleep, and in her dream, the numbers whispered to her, revealing the secrets she sought. In a flurry of calculations, Alice realized how to obtain the sum S(n) and why it was of such great importance.\n\nEnergized by her newfound understanding, Alice rushed to present her findings to the mathematical community. Professors and students alike gathered in the vast auditorium of Mathville University, eager to quench their thirst for knowledge. Alice stood on the stage, her eyes gleaming with excitement, and began to explain the elusive relationship she had unearthed.\n\nAs Alice narrated her journey through the problem, the crowd was mesmerized by her words. The audience hung on her every syllable, their imaginations ignited by the power of numbers and the significance of her discovery. The air buzzed with anticipation, for they all knew that this finding could reshape the very fabric of their world.\n\nFinally, the crescendo of Alice's speech reached its peak, and the audience erupted in applause. She had done it. She had solved the mathematical problem that had captivated her mind for so long. But in the midst of her triumph, a question emerged, one that sent shivers down everyone's spines.\n\nAs the room fell silent, Alice's voice pierced the stillness. \"Now I pose this question to you, my fellow mathematicians, lovers of numbers and seekers of truth. Can any of you, in all your brilliance, solve the final challenge that lies before us? What is the sum S(108)? Give your answer, but remember, you must find it modulo 433494437. The future of Mathville hangs in the balance.\"\n\nAnd so, dear reader, the question is now posed to you. Can you unravel the secrets of the mathematical problem Alice set out to solve? Can you find the sum S(108), knowing that the future of Mathville rests upon your answer?"}, {"id": 825, "euler_id": 825, "title": "Chasing Game", "problem": "Two cars are on a circular track of total length 2n, facing the same direction, initially distance n apart.\nThey move in turn. At each turn, the moving car will advance a distance of 1, 2 or 3, with equal probabilities.\nThe chase ends when the moving car reaches or goes beyond the position of the other car. The moving car is declared the winner.\nLet S(n) be the difference between the winning probabilities of the two cars.\nFor example, when n=2, the winning probabilities of the two cars are 911 and 211, and thus S(2)=711.\nLet T(N)=\u2211n=2NS(n).\nYou are given that T(10)=2.38235282 rounded to 8 digits after the decimal point.\nFind T(1014), rounded to 8 digits after the decimal point.", "solution": "32.34481054", "difficulty": 60, "story": "In the small town of Lakeview, nestled amidst rolling hills and picturesque landscapes, there lived two friends named Emma and Lucas. They shared a deep bond and were known for their friendly competitiveness. One sunny day, while strolling by the shimmering lake, their conversation took an unexpected turn.\n\n\"I heard there's an upcoming car race in town, Emma,\" Lucas said with an excited gleam in his eyes. \"Wouldn't it be fun if we participated together?\"\n\nEmma's face brightened up, and a mischievous smile played on her lips. \"Of course, Lucas! But let's make it more interesting. What if we enter this race as rivals? We'll see who can outsmart the other and reach the finish line first.\"\n\nThe challenge intrigued Lucas. He agreed, and they dared each other to unleash their competitive spirits on the racetrack. Little did they know that their friendly race would soon involve the complexities of mathematics.\n\nOn the day of the race, Emma and Lucas found themselves on a circular track. The track had a total length of 2n, and they were initially placed n units apart. Both cars faced the same direction, ready to showcase their racing skills.\n\nThe race began, and the cars moved in turns. At each turn, a moving car could advance a distance of 1, 2, or 3 units, with equal probabilities. Emma and Lucas felt their hearts pound with anticipation as they maneuvered their cars with utmost precision and strategy.\n\nBut the race was no ordinary competition. Emma's mind, as sharp as a mathematician's, quickly realized the implications of their movements. She understood that the chase would only end when one car reached or went beyond the position of the other car. Emma saw the opportunity to incorporate math into their race, to determine the winning probabilities for both cars.\n\nAs they raced, Emma calculated the probabilities for each turn, constantly analyzing the possible outcomes. She painstakingly computed the winning probabilities for both cars: 911 for her car and 211 for Lucas's car when n = 2. The difference, S(2), was 711.\n\nSensing the desperation in her friend's eyes, Emma decided to share her calculations. Lucas was astounded by the mathematical aspects of the race, his curiosity piqued beyond measure.\n\nWith each race they competed in, the complexity of their calculations grew. Lucas perpetually devised new strategies, utilizing statistical models he had learned in mathematics class, while Emma took pleasure in analyzing the outcomes of their races. T(10), which represented the sum of S(n) from 2 to 10, astoundingly rounded to 2.38235282.\n\nBut the question that lingered in their minds was monumental: What would T(1014) be?\n\nAs the wind danced through the trees, Emma looked at Lucas with a glimmer of determination. \"Lucas, my friend, we've solved the mathematical problem up to T(10). Now, do you dare to take it further? Can you find T(1014), rounded to 8 digits after the decimal point?\"\n\nAnd so, their race continues, not just on the racetrack but within the depths of mathematics. As Emma and Lucas push the boundaries of their intellectual aptitude, the question remains: Can you solve T(1014), rounded to 8 digits after the decimal point?"}]