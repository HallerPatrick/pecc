[{"id": 106, "euler_id": 106, "title": "Special subset sums: meta-testing", "problem": "Let S(A) represent the sum of elements in set A of size n. We shall call it a special sum set if for any two non-empty disjoint subsets, B and C, the following properties are true:\nS(B) \u2260 S(C); that is, sums of subsets cannot be equal.\nIf B contains more elements than C then S(B) > S(C).\nFor this problem we shall assume that a given set contains n strictly increasing elements and it already satisfies the second rule.\nSurprisingly, out of the 25 possible subset pairs that can be obtained from a set for which n = 4, only 1 of these pairs need to be tested for equality (first rule). Similarly, when n = 7, only 70 out of the 966 subset pairs need to be tested.\nFor n = 12, how many of the 261625 subset pairs that can be obtained need to be tested for equality?\nNOTE: This problem is related to Problem 103 and Problem 105.", "solution": "21384", "difficulty": 50, "story": "In the small town of Brooksville, there lived a curious young girl named Emily. From a young age, Emily had always been fascinated with patterns and numbers. She would spend hours in her room, delighting in solving puzzles and exploring the mysteries of mathematics.\n\nOne sunny afternoon, Emily stumbled upon an old book in her local library. Its pages were yellowed with age, and the cover bore the inscription, \"Mathematical Enigmas\". Intrigued, she brought the book back home and began flipping through its worn pages.\n\nAs Emily perused the book, she came across a problem that caught her attention. It involved a concept called a \"special sum set.\" The problem stated that for any set containing n strictly increasing elements, it is considered a special sum set if the sums of any two non-empty disjoint subsets are never equal. In addition, if one subset contains more elements than another, its sum must be greater.\n\nThis seemed fascinating to Emily, and she found herself lost in thought, pondering the implications of such a set. She wondered if there was a pattern to determine how many subset pairs needed to be tested for equality. The problem called out to her, urging her to find its solution.\n\nThe following days saw Emily engrossed in her research. She spent countless hours poring over mathematical journals and textbooks, her mind ablaze with excitement. The more she delved into the subject, the more she realized the significance of the problem she had discovered.\n\nOne night, as Emily lay in bed, her mind buzzing with new-found knowledge, she had an epiphany. She realized that the number of subset pairs that needed to be tested for equality depended on the size of the set. The problem specifically mentioned that for n = 4, only 1 out of the 25 possible subset pairs needed to be tested. Similarly, when n = 7, only 70 out of the 966 subset pairs required testing.\n\nBut what about when n = 12? How many of the 261,625 subset pairs would need to be tested for equality? Emily's excitement grew, and she couldn't wait to find the answer. The question burned in her mind, urging her to unravel its mystery.\n\nDays turned into weeks, and weeks into months, but Emily never gave up. She continued to delve deeper into the problem, determined to uncover its hidden secrets. She immersed herself in complex calculations and intricate algorithms, searching for the elusive solution.\n\nAnd now, as you read this story, dear reader, I ask you, can you solve the mathematical problem that fascinated young Emily? How many of the 261,625 subset pairs that can be obtained from a set of size 12 need to be tested for equality? Will you be the one to uncover the answer, to unlock the hidden truth behind this enigma of mathematics?"}, {"id": 127, "euler_id": 127, "title": "abc-hits", "problem": "The radical of n, rad(n), is the product of distinct prime factors of n. For example, 504 = 23 \u00d7 32 \u00d7 7, so rad(504) = 2 \u00d7 3 \u00d7 7 = 42.\nWe shall define the triplet of positive integers (a, b, c) to be an abc-hit if:\nGCD(a, b) = GCD(a, c) = GCD(b, c) = 1\na < b\na + b = c\nrad(abc) < c\nFor example, (5, 27, 32) is an abc-hit, because:\nGCD(5, 27) = GCD(5, 32) = GCD(27, 32) = 1\n5 < 27\n5 + 27 = 32\nrad(4320) = 30 < 32\nIt turns out that abc-hits are quite rare and there are only thirty-one abc-hits for c < 1000, with \u2211c = 12523.\nFind \u2211c for c < 120000.", "solution": "18407904", "difficulty": 50, "story": "Once upon a time in the peaceful village of Arithmia, there was a young and curious child named Alice. Unlike the other children, Alice had a great fascination with numbers and patterns. Each day after she finished her chores, she would retreat to the quiet corner of her humble home and immerse herself in the world of mathematics.\n\nOne sunny afternoon, as Alice was pondering over an intriguing problem, she overheard a conversation between her parents and the village elder. They were discussing a puzzle that had left the villagers puzzled for years. It was known as the abc-hits, where the sum of three positive integers forms a perfect equation.\n\nCuriosity piqued, Alice moved closer to listen intently. The village elder explained, \"An abc-hit occurs when three numbers - a, b, and c - satisfy the conditions of having a greatest common divisor of 1 with each other, with a being smaller than b, and when a + b equals c. But that's not all, young Alice. The product of the distinct prime factors of abc, also known as its radical, must be lesser than c.\"\n\nAlice's eyes sparkled with excitement. Her young mind was determined to solve this mysterious puzzle and unravel its secrets. She spent hours upon hours studying numbers and solving mathematical problems, trying to understand the underlying patterns. Day by day, Alice delved deeper into the world of abc-hits, hoping to discover a breakthrough.\n\nOne day, as Alice was walking through the woods, she stumbled upon a worn-out book hidden amidst the foliage. Its pages were filled with calculations, and it seemed to hold the key to understanding abc-hits. Without hesitation, Alice eagerly flipped through the fragile pages, reading every word with utmost attention.\n\nIn the book, she discovered a theorem stated by a famous mathematician that helped her crack the code to finding abc-hits. Her eyes widened with wonder as the formulas and equations danced before her. It was like witnessing the beauty of mathematics unfold right in front of her eyes.\n\nFilled with newfound knowledge, Alice returned to the village with a mission in her heart. She wanted to find a way to make the lives of the villagers better, to give them hope and joy through the revelation of abc-hits. Armed with her calculations and an unwavering determination, Alice began solving the puzzle, one by one.\n\nAs days turned into months, and months into years, Alice grew older, and her quest to find abc-hits became a legacy. The villagers admired Alice's perseverance and dedication to solving the puzzle that had haunted them for so long. Some even believed that she possessed a hidden realm of numbers and equations in her mind.\n\nFinally, the day came when Alice had successfully found all the abc-hits for c numbers less than 120,000. The villagers rejoiced, their hearts filled with gratitude for the brilliant young girl who had breathed life into a seemingly impossible problem. Alice had helped them see the beauty and elegance of numbers, and their lives had been forever enriched.\n\nBut amidst the celebration, Alice pondered something deeper. She wondered if abc-hits were a mere mathematical curiosity or if they held a greater purpose. As she gazed up at the starry night sky, Alice whispered to the universe, \"What mysteries lie beyond the realm of abc-hits? What secrets do they hold that are yet to be unveiled?\"\n\nAnd so, dear reader, I pose this question to you: Can you calculate the sum of the c-values for abc-hits less than 120,000? Can you unravel the enigma that has captivated the villagers of Arithmia and brought joy to the heart of young Alice?\n\nThe answer lies in the depths of numbers, waiting to be discovered by those who dare to venture into the realm of mathematical wonders."}, {"id": 133, "euler_id": 133, "title": "Repunit nonfactors", "problem": "A number consisting entirely of ones is called a repunit. We shall define R(k) to be a repunit of length k; for example, R(6) = 111111.\nLet us consider repunits of the form R(10n).\nAlthough R(10), R(100), or R(1000) are not divisible by 17, R(10000) is divisible by 17. Yet there is no value of n for which R(10n) will divide by 19. In fact, it is remarkable that 11, 17, 41, and 73 are the only four primes below one-hundred that can  be a factor of R(10n).\nFind the sum of all the primes below one-hundred thousand that will never be a factor of R(10n).", "solution": "453647705", "difficulty": 50, "story": "Once upon a time in the small village of Arithmos, there lived a young girl named Aurora. Aurora had a curious mind, always seeking adventure and looking for ways to solve impossible puzzles. Her fascination with numbers often kept her up late at night, dreaming of the magical possibilities hidden within them.\n\nOne sunny morning, while strolling through the village, Aurora stumbled upon an old and tattered book in the dusty corner of the local library. The book had an intriguing title that caught her attention: \"The Secrets of the Repunits.\" She flipped through the delicate pages, discovering a fascinating mathematical problem that would forever change her life.\n\nThe village of Arithmos, like many others, had been plagued by mysterious incidents in recent months. Crops were failing, livestock were falling ill, and the villagers were living in perpetual fear. Local rumors spoke of an ancient curse that had befallen the village, tied to a powerful sequence of numbers.\n\nIntrigued and determined, Aurora decided to delve deeper into the problem described in the book. She read about repunits, numbers consisting entirely of ones, and how they were defined as R(k), where k denoted the number of ones in the repunit. Pondering upon the possibilities, Aurora found herself drawn to repunits of the form R(10n).\n\nAs she read further, the book revealed a remarkable finding. Repunits of the form R(10n) were never divisible by certain prime numbers. For example, R(10000) was divisible by 17, but there was no value of n for which R(10n) would divide by 19. The book went on to identify 11, 17, 41, and 73 as the only four primes below one-hundred that could be factors of R(10n).\n\nAurora couldn't shake off the feeling that these findings held the key to solving the curse that plagued her village. The primes below one-hundred thousand had always fascinated her, and this new discovery fueled her determination to uncover the truth.\n\nShe spent countless nights poring over the numbers, creating charts and trying to find patterns, desperately trying to find the connection between the primes and the repunits of the form R(10n). The village watched in awe and amazement as Aurora's passion and dedication grew. She became known as the village's \"Number Whisperer.\"\n\nChallenged by the immense task before her, Aurora reasoned that the primes below one-hundred thousand that could never be factors of R(10n) must hold the answer to the curse that haunted her village. If she could just find their sum, she believed she could lift the veil of darkness that enveloped Arithmos.\n\nAs Aurora delved deeper into her research, her determination never wavered. The village rallied behind her, offering support and encouragement. They believed in her ability to solve the insurmountable mathematical puzzle and bring light back to their lives.\n\nWeeks turned into months, and Aurora's sleep-deprived eyes never faltered. Each page in the book, each line of digits, held a clue. She spent hours, days, and nights unraveling the secrets, hoping to unlock the elusive connection between primes and repunits.\n\nThe day finally arrived when Aurora made a breakthrough. She had discovered a pattern in the primes that could never be factors of R(10n). Excitement filled her heart as the pieces of the puzzle fell into place. A solution was within her grasp.\n\nBut as Aurora contemplated her findings, a trepidation stirred within her soul. She realized that revealing the answer to the mystery would require great caution. The consequences could be unimaginable if the secret was misused or fell into the wrong hands.\n\nWith the villagers eagerly awaiting her revelation, Aurora had a choice to make. Would she expose her findings, unlock the wisdom held within those hidden numbers, and forever change the destiny of her village? Or would she keep the secret buried, preserving the ancient curse and the balance it had unknowingly brought to their lives?\n\nAs Aurora stands at the precipice of her decision, ready to face the curious villagers, a question lingers in the air, waiting to be answered. Can you, dear reader, solve the mathematical problem and uncover the sum of all the primes below one-hundred thousand that will never be a factor of R(10n)?"}, {"id": 136, "euler_id": 136, "title": "Singleton difference", "problem": "The positive integers, x, y, and z, are consecutive terms of an arithmetic progression. Given that n is a positive integer, the equation, x2 \u2212 y2 \u2212 z2 = n, has exactly one solution when n = 20:\n132 \u2212 102 \u2212 72 = 20\nIn fact there are twenty-five values of n below one hundred for which the equation has a unique solution.\nHow many values of n less than fifty million have exactly one solution?", "solution": "2544559", "difficulty": 50, "story": "Once upon a time, in the kingdom of Mathematica, there lived a young and curious prince named Leo. Leo was known throughout the kingdom for his insatiable thirst for knowledge and his love for problem-solving. From an early age, he had shown a remarkable aptitude for mathematics and enjoyed exploring its intricate puzzles.\n\nOne fateful day, as Leo was perusing the royal library, he stumbled upon an old, worn-out scroll hidden amidst a collection of forgotten books. Intrigued, he unfurled the scroll and found himself face-to-face with a mathematical problem that piqued his interest.\n\nDeep in thought, Leo studied the problem. The positive integers, x, y, and z, were revealed to be consecutive terms of an arithmetic progression. The equation, x\u00b2 \u2212 y\u00b2 \u2212 z\u00b2 = n, had exactly one solution when n was given the value of 20. Leo's eyes widened with excitement.\n\nThe young prince delved deeper into the scroll, discovering that beneath the initial problem lay an even more mysterious puzzle. The scroll spoke of twenty-five values of n below one hundred, where the equation with the consecutive terms had a unique solution. Leo's mind raced, wondering why these specific values were significant.\n\nAs Leo pondered the problem, he felt his sense of adventure urging him to embark on a quest to find the answer. Determined to solve the mystery, he gathered his most trusted companions: his loyal hound, Max, and an esteemed mathematician named Professor Euler.\n\nTogether, the trio set off on a grand adventure through the kingdom of Mathematica, traversing forests and scaling mountains in their pursuit of knowledge. They encountered various mind-bending riddles and mathematical conundrums along the way, each sowing seeds of wisdom into Leo's already remarkable mind.\n\nDays turned into weeks, and weeks into months, as Leo and his companions wandered the vast kingdom seeking an answer. They consulted ancient sages, deciphered hidden cryptograms, and even enlisted the help of mythical creatures believed to possess otherworldly intelligence.\n\nOn their journey, they met a wise old sage who claimed to know the solution they sought. He revealed to them that the key to unlocking the answer lay within the concept of consecutive terms. The sage explained that the unique solution occurred because of the specific relationship between x, y, and z in an arithmetic progression.\n\nBut the sage could only offer a hint and refused to divulge the exact answer to Leo's query. Doggedly pursuing knowledge, Leo pressed on, never losing hope of uncovering the truth. As he ventured further into the heart of the kingdom, he encountered mathematical enigmas that pushed the boundaries of his understanding.\n\nFinally, after an unforgettable journey full of trials and tribulations, Leo stood at the summit of Mount Mathematica. As a gentle breeze brushed his face, he cast his gaze upon the breathtaking view before him, his mind whirling with possibilities.\n\nIn that moment, as Leo surveyed the kingdom below, he felt a profound realization wash over him. The answer to the mathematical problem was now so close, almost within his grasp. It resonated deep within his being, tugging at the strings of his mind.\n\nBut before he could reach the conclusion, a thought struck him. Leo pondered the question that had been with him throughout this extraordinary adventure. How many values of n less than fifty million have exactly one solution? It was the ultimate question, the grand finale of his mathematical quest.\n\nAs the story draws to a close, dear reader, I pose this question to you, the intrepid solver of puzzles. With the knowledge that Leo acquired on his epic journey, can you muster the wisdom to discover the answer?"}, {"id": 137, "euler_id": 137, "title": "Fibonacci golden nuggets", "problem": "Consider the infinite polynomial series AF(x)=xF1+x2F2+x3F3+\u2026, where Fk is the kth term in the Fibonacci sequence: 1,1,2,3,5,8,\u2026; that is, Fk=Fk\u22121+Fk\u22122, F1=1 and F2=1.\nFor this problem we shall be interested in values of x for which AF(x) is a positive integer.\nSurprisinglyAF(12)=(12)\u00d71+(12)2\u00d71+(12)3\u00d72+(12)4\u00d73+(12)5\u00d75+\u22ef=12+14+28+316+532+\u22ef=2\nThe corresponding values of x for the first five natural numbers are shown below.\n\nxAF(x)\n2\u221211\n122\n13\u2212233\n89\u2212584\n34\u2212355\n\nWe shall call AF(x) a golden nugget if x is rational, because they become increasingly rarer; for example, the 10th golden nugget is 74049690.\nFind the 15th golden nugget.", "solution": "1120149658760", "difficulty": 50, "story": "In a cozy little village named Fibonacci, nestled deep in the heart of a lush valley, there lived a young girl named Alice. The village, as its name suggests, was known for its mathematical brilliance and the enchanting pattern that inspired its name\u2014the Fibonacci sequence. Every street, building, and garden in Fibonacci followed the sequence, embracing the magic of numbers.\n\nAlice, an inquisitive and imaginative soul, spent her days exploring the village, seeking new adventures and intriguing mysteries. It was during one of her wanderings that she stumbled upon an old, weathered book lying discarded in a dusty corner of the village library. As she brushed off the layers of neglect, words seemed to leap off the pages, captivating her attention.\n\nThe book chronicled the tale of an ancient mathematician who had discovered a mysterious series, which the villagers later named AF(x). Alice, engrossed in the narrative, followed the mathematician's journey as he unraveled the secrets of AF(x). The series fascinated her\u2014a treasure trove of x-values for which AF(x) resulted in positive integers.\n\nAs Alice read on, she discovered a peculiar mention about golden nuggets. The mathematician referred to rational x-values that transformed AF(x) into golden nuggets\u2014infinitely rare moments in the vast tapestry of numbers. The emergence of these golden nuggets captured Alice's imagination, igniting a spark within her.\n\nDetermined to find these treasures and witness their incredible beauty for herself, Alice embarked on a mathematical quest. Armed with a pencil, notebook, and her boundless curiosity, she eagerly dove into the depths of numbers, seeking the enlightenment bestowed by the 15th golden nugget.\n\nDays turned into weeks, and weeks into months, as Alice delved deeper into the infinite polynomial series. She examined each value of x that had led to a golden nugget before, hoping that the 15th one awaited her discovery. Her mind became a whirlwind of calculations, Fibonacci sequences swirling around her like colorful ribbons.\n\nThe people of Fibonacci watched Alice with affectionate curiosity, knowing the significance of her journey. Villagers whispered stories of her perseverance, inspired by the young girl who sought a treasure buried within the vastness of numbers.\n\nSoon, Alice's breakthrough arrived\u2014a profound realization. An idea dawned on her, so radiant and promising that it kindled her desire to unravel the 15th golden nugget. She toiled day and night, scribbling furiously, seeking patterns, and questioning everything she once knew.\n\nThe village of Fibonacci was alive with anticipation, waiting for Alice's triumphant return. She knew she was on the cusp of unveiling the 15th golden nugget\u2014a discovery that would enrich not only her own life but the lives of everyone in the village. Clutching her notebook, she approached the village square, where villagers had gathered to witness her unveiling.\n\nWith bated breath, Alice stepped onto the stage, her eyes shining with determination. She turned to face the crowd, a wave of excitement rushing over her. The villagers, their eyes brimming with hope and curiosity, sensed the significance of this moment.\n\nAlice paused, taking a deep breath, and posed her question to the rapturous crowd: \"What is the 15th golden nugget?\"\n\nThe villagers leaned in, ears tuned to the mathematical enigma that had consumed Alice's being. They held their breath, waiting eagerly for the solution that eluded them for so long. They knew that, just as Alice had sought answers within the labyrinth of numbers, it was now their turn to embark on their own journey\u2014to solve the puzzle besieging their minds.\n\nAnd so, the villagers began their own quest, their minds alight with the spark ignited by Alice. As they delved into the intricate world of the Fibonacci sequence, they unraveled its beauty, one number at a time, hoping to unearth the elusive 15th golden nugget that had captivated the heart of their beloved village.\n\nWith each page turned, each calculation performed, they inched closer to the solution. Their determination grew, fueled by the knowledge that in the realm of numbers, a treasure awaits. The villagers and Alice worked tirelessly, driven by the same spark, the same insatiable curiosity that imbued Fibonacci with its magical essence.\n\nAnd as they journeyed deeper into the tangled mesh of mathematics, they whispered a question, a challenge to all who encounter their tale:\n\n\"Will you unravel the mystery that eludes us\u2014a treasure forged by numbers, known as the 15th golden nugget?\""}, {"id": 139, "euler_id": 139, "title": "Pythagorean tiles", "problem": "Let (a, b, c) represent the three sides of a right angle triangle with integral length sides. It is possible to place four such triangles together to form a square with length c.\nFor example, (3, 4, 5) triangles can be placed together to form a 5 by 5 square with a 1 by 1 hole in the middle and it can be seen that the 5 by 5 square can be tiled with twenty-five 1 by 1 squares.\n\n\nHowever, if (5, 12, 13) triangles were used then the hole would measure 7 by 7 and these could not be used to tile the 13 by 13 square.\nGiven that the perimeter of the right triangle is less than one-hundred million, how many Pythagorean triangles would allow such a tiling to take place?", "solution": "10057761", "difficulty": 50, "story": "Once upon a time, in the quaint village of Pythagora, there lived a young and curious mathematician named Emma. Emma had a deep love for numbers and a particular delight in solving mathematical puzzles. She spent her days strolling through the fields, finding inspiration in the patterns of nature. \n\nOne sunny afternoon, as Emma wandered into the village library, her eyes fell upon an old and weathered book, whose pages were yellowed with age. It was a book of ancient math problems, each offering a unique challenge that tickled her mathematical mind.\n\nWith eager anticipation, Emma flipped through the pages until she stumbled upon a problem that immediately captured her attention. The problem presented a collection of right angle triangles, each with integral length sides, and tasked Emma with arranging four of these triangles to form a square with side length c.\n\nThe first example in the problem described triangles with side lengths (3, 4, 5). Emma envisioned these triangles, and a spark of creativity ignited within her. She imagined arranging four of them together, forming a 5 by 5 square with a small 1 by 1 hole in the center. Giddy with excitement, Emma realized that the 5 by 5 square could be tiled perfectly with twenty-five 1 by 1 squares. The sense of accomplishment washed over her as she marveled at the patterns these triangles created.\n\nBut the problem did not end there. Another set of triangles, with side lengths (5, 12, 13), presented a challenge. Emma pondered over these triangles, trying to visualize their arrangement. With an intense focus, she arranged four of these triangles together, only to realize that the hole in the center would measure 7 by 7. These triangles could not be used to tile a 13 by 13 square. Disappointment filled her, but Emma realized the beauty of mathematics - obstacles, even if they seemed insurmountable at first, were meant to be conquered.\n\nDetermined to explore further, Emma dived deep into her study of Pythagorean triangles. She spent hours immersed in their properties, discovering the patterns and relationships that made them unique. As her understanding grew, Emma realized that not all Pythagorean triangles could create a tiling as the problem required. The perimeter of the triangle had to be less than one-hundred million for them to fit perfectly.\n\nInspired by her research, Emma ventured into the nearby woods, where her imagination was set free. Amongst the towering trees and dancing wildlife, she allowed her mathematical mind to weave tales of triangles and squares, of patterns and possibilities. And as she wandered, the question lingered: How many Pythagorean triangles would allow such a tiling to take place?\n\nAnd so, dear reader, I ask you this question as well. Can you solve the puzzle that has captivated Emma's heart? How many Pythagorean triangles, with their integral length sides, would create a perfect tiling inside a square? Let your mathematical prowess guide you as you untangle this fascinating problem, and may your journey be as rewarding as Emma's."}, {"id": 144, "euler_id": 144, "title": "Investigating multiple reflections of a laser beam", "problem": "In laser physics, a \"white cell\" is a mirror system that acts as a delay line for the laser beam. The beam enters the cell, bounces around on the mirrors, and eventually works its way back out.\nThe specific white cell we will be considering is an ellipse with the equation 4x2 + y2 = 100\nThe section corresponding to \u22120.01 \u2264 x \u2264 +0.01 at the top is missing, allowing the light to enter and exit through the hole.\n\nThe light beam in this problem starts at the point (0.0,10.1) just outside the white cell, and the beam first impacts the mirror at (1.4,-9.6).\nEach time the laser beam hits the surface of the ellipse, it follows the usual law of reflection \"angle of incidence equals angle of reflection.\" That is, both the incident and reflected beams make the same angle with the normal line at the point of incidence.\nIn the figure on the left, the red line shows the first two points of contact between the laser beam and the wall of the white cell; the blue line shows the line tangent to the ellipse at the point of incidence of the first bounce.The slope m of the tangent line at any point (x,y) of the given ellipse is: m = \u22124x/yThe normal line is perpendicular to this tangent line at the point of incidence.\nThe animation on the right shows the first 10 reflections of the beam.\nHow many times does the beam hit the internal surface of the white cell before exiting?", "solution": "354", "difficulty": 50, "story": "Once upon a time, in a land filled with mystery and wonder, there was a young inventor named Oliver. He had always been fascinated by lasers and spent countless hours in his workshop, tinkering with various gadgets. One day, while perusing an old book on laser physics, Oliver stumbled upon a mathematical problem that piqued his curiosity.\n\nThe problem involved a peculiar device known as a \"white cell,\" which acted as a delay line for a laser beam. The beam would enter the cell, bounce around on mirrors, and eventually find its way out. This white cell was shaped like an ellipse and had a specific equation that described its dimensions.\n\nOliver's mind raced with ideas. He could hardly contain his excitement as he began to imagine the possibilities. But before he could fully grasp the concept, he needed to understand the inner workings of the white cell.\n\nWith the equation 4x\u00b2 + y\u00b2 = 100 in mind, Oliver set out to test his understanding. He constructed a small prototype of the white cell, carefully placing mirrors inside an elliptical chamber. The result was a mesmerizing creation that seemed to hold boundless potential.\n\nEager to witness the magic firsthand, Oliver brought the prototype outside and positioned it under the night sky. He grabbed a laser pointer and, with trembling hands, aimed it at the hole at the top of the white cell. His heart pounded with anticipation as he flicked the switch, sending the laser beam soaring into the night.\n\nTo his amazement, the beam of light grazed a mirror, ricocheted off at a perfect angle, and struck another mirror. This dance continued as the beam gracefully bounded within the white cell, creating an intricate pattern of light.\n\nSuddenly, an idea struck Oliver like a bolt of lightning. He realized that the trajectory of the laser beam was guided by the mathematical equation of the ellipse. Each time the beam hit the surface, it followed the law of reflection, bouncing off at precisely the same angle as it entered.\n\nAs Oliver watched the mesmerizing display, he couldn't help but wonder how many times the beam would hit the internal surface before making its grand exit. He knew that finding the answer to this mathematical problem could unlock endless possibilities in the realm of laser physics.\n\nThe beam continued its dance within the white cell, seemingly lost in an eternal loop of reflections. Oliver eagerly counted each impact, but the number seemed to be increasing at a rapid pace. The thought of solving this mathematical puzzle consumed his every waking moment.\n\nFor days on end, Oliver tirelessly worked on finding a solution. He consulted textbooks, confided in fellow scientists, and even conducted his own experiments. But no matter how hard he tried, the answer remained elusive.\n\nFrustration started to creep into Oliver's mind. He began to doubt his abilities and questioned whether he was truly meant to solve this mathematical problem. But deep down, a fire burned within him, urging him to push forward and persevere.\n\nAnd so, dear reader, I pose the question to you: How many times does the beam hit the internal surface of the white cell before exiting? As you ponder this intriguing mathematical problem, remember the journey of Oliver and the countless possibilities that await those who dare to seek answers in the realm of science and mathematics."}, {"id": 146, "euler_id": 146, "title": "Investigating a Prime Pattern ", "problem": "The smallest positive integer n for which the numbers n2+1, n2+3, n2+7, n2+9, n2+13, and n2+27 are consecutive primes is 10. The sum of all such integers n below one-million is 1242490.\nWhat is the sum of all such integers n below 150 million?", "solution": "676333270", "difficulty": 50, "story": "Once upon a time, in a quiet village nestled between rolling hills, there lived a young girl named Lily. She was known for her curiosity, always seeking out new and exciting adventures. However, Lily's true love was numbers. She could spend hours solving intricate mathematical problems, finding beauty and patterns in the equations that seemed to dance before her eyes.\n\nOne sunny morning, as Lily solved equations under a large oak tree near the village square, she overheard the whispered conversation of two villagers. They spoke with hushed excitement about a mysterious mathematical problem that had baffled even the most seasoned mathematicians. The problem involved prime numbers and seemed to hold the secret to unlocking something extraordinary.\n\nIntrigued, Lily made it her mission to unravel the enigma. She delved into ancient texts and sought the counsel of renowned mathematicians, immersing herself in the world of numbers like never before. It wasn't long before the villagers noticed Lily's dedication and began seeking her help with their everyday problems rooted in mathematics.\n\nDuring her search for a solution, Lily stumbled upon an old, dusty book in the village library. Its yellowed pages contained cryptic symbols and equations that seemed to radiate with potential. Among those symbols, Lily discovered a series of consecutive primes expressed in the form n\u00b2+1, n\u00b2+3, n\u00b2+7, n\u00b2+9, n\u00b2+13, and n\u00b2+27.\n\nAs she read on, Lily's eyes widened with excitement. The book bore an example that stated the smallest positive integer, n, for which those numbers became consecutive primes was 10. An answer! But it was only the beginning of her journey.\n\nDriven by a newfound sense of purpose, Lily set out to find more integers, n, that would satisfy the same condition. She spent countless days and nights meticulously calculating, jotting down numbers, and tirelessly testing her theories. The villagers watched in awe as Lily's passion breathed life into abstract numbers, transforming them into tangible secrets.\n\nWord of Lily's pursuits quickly spread beyond the village's borders. Mathematicians from far and wide flocked to see the prodigious young girl who dared to unlock the mysteries of consecutive primes. They marveled at the elegance of her equations and the delicate balance between patterns and randomness within her work.\n\nWith every solved equation, Lily's enthusiasm grew. She discovered that the sum of all integers, n, below one-million, satisfying the conditions, was 1,242,490. It was a remarkable achievement, but one question lingered in the air: What would be the sum of all such integers, n, below 150 million?\n\nAs thoughts of an even greater discovery consumed Lily's mind, she couldn't help but dream about the possibilities. Would a solution to this problem unlock a secret hidden within the realm of numbers? Or was it merely a puzzle designed to challenge the minds of those daring enough to unravel its complexity?\n\nOnce again, Lily found herself consumed by a glorious quest. Armed with her unyielding determination and unwavering love for numbers, she set forth on a grand adventure that would take her to the far corners of her imagination. Lily's journey was just beginning, and with every step she took, she asked herself, and the reader, the question that would propel her forward:\n\nWhat is the sum of all such integers, n, below 150 million?"}, {"id": 148, "euler_id": 148, "title": "Exploring Pascal's triangle", "problem": "We can easily verify that none of the entries in the first seven rows of Pascal's triangle are divisible by 7:\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\u00a01\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\u00a01\n\u00a0\n\u00a01\n\u00a0\n\u00a0\n\u00a0\n\u00a0\n\u00a01\n\u00a0\n\u00a02\n\u00a0\n\u00a01\n\u00a0\n\u00a0\n\u00a0\n\u00a01\n\u00a0\n\u00a03\n\u00a0\n\u00a03\n\u00a0\n\u00a01\n\u00a0\n\u00a0\n\u00a01\n\u00a0\n\u00a04\n\u00a0\n\u00a06\n\u00a0\n\u00a04\n\u00a0\n\u00a01\n\u00a0\n\u00a01\n\u00a0\n\u00a05\n\u00a0\n10\n\u00a0\n10\n\u00a0\n\u00a05\n\u00a0\n\u00a01\n1\n\u00a0\n\u00a06\n\u00a0\n15\n\u00a0\n20\n\u00a0\n15\n\u00a0\n\u00a06\n\u00a0\n\u00a01\nHowever, if we check the first one hundred rows, we will find that only 2361 of the 5050 entries are not divisible by 7.\nFind the number of entries which are not divisible by 7 in the first one billion (109) rows of Pascal's triangle.", "solution": "2129970655314432", "difficulty": 50, "story": "The sun was setting over the small town of Willow Creek, casting long shadows over the quaint houses and cobbled streets. In a cozy cottage, tucked away on the outskirts of town, lived a young woman named Amelia. She had always been fascinated by the mysteries of the world, with a particular love for numbers.\n\nAmelia possessed a special gift\u2014the ability to see patterns and connections in everything she encountered. Numbers spoke to her in a way that words never could. It was this unique talent that drew her gaze towards the enigmatic Pascal's Triangle.\n\nOne day, while poring over the intricate sequences of numbers in Pascal's Triangle, Amelia stumbled upon a peculiar pattern. Every number in the first seven rows of the triangle was untouched by the shadow of seven. Not one of them was divisible by that particular number.\n\nIntrigued, Amelia couldn't help but wonder if this pattern persisted beyond those initial rows. With fervor in her heart, she decided to embark on a grand mathematical quest\u2014to unravel the secrets hidden within Pascal's Triangle, vowing to unlock its mysteries one row at a time.\n\nDays turned into weeks, and weeks turned into months. Amelia barely left her cottage, except to gather supplies and satisfy her basic needs. Her walls were covered with countless sheets of paper, each marked with an array of numbers, scribbled formulas, and sketches of the triangle.\n\nWith unwavering determination, Amelia systematically calculated the entries of the triangle, row by row, tirelessly brainstorming methods to tackle the ever-increasing complexity. On one side, she developed a way to generate the triangle efficiently, while on the other, she devised strategies to identify which numbers were divisible by seven.\n\nAs Amelia delved deeper into the triangle, it seemed as if the world around her faded away, leaving only her and the daunting numbers on her parchment. Pascal's Triangle became her labyrinth, and she was the courageous explorer, unyielding in her pursuit of mathematical truth.\n\nAnd then, after years of dogged perseverance, Amelia arrived at a stunning discovery. In the first 100 rows of Pascal's Triangle, she found that out of the 5,050 entries, only 2,361 were not divisible by seven. These numbers, like hidden gems in a vast mine, sparked a sense of excitement within her. But as the scope grew larger, could she continue finding these elusive numbers?\n\nNight after night, Amelia pushed herself further, constantly recalculating, searching for patterns, and hoping to reach a definitive conclusion. The town noticed her absence, her family grew concerned, but Amelia was consumed by the profound beauty of numbers, oblivious to her surroundings.\n\nNow, as the sun begins to set on the eve of a new day, the world beyond her cottage holds its breath, waiting for Amelia's answer. In her hands are the first billion rows of Pascal's Triangle, a treasure trove of mathematical possibilities. But the question remains unanswered, the enigma unsolved. How many entries in this vast expanse are not divisible by seven?\n\nAs the shadows grow longer in the final glow of the day, with her heart racing, Amelia poses a question\u2014a challenge to herself and to the world. Who will rise to the occasion, solve this mathematical riddle, and bring closure to her unparalleled journey through Pascal's Triangle?\n\nThe story continues in the pages of mathematics textbooks and the minds of brilliant thinkers, waiting patiently for the one who will uncover this answer to forever change the course of numbers and ignite the flames of discovery. Will this mathematical mystery yield to the persistent curiosity of another Amelia? Only time will tell.\n\nCan you find the number of entries that are not divisible by 7 in the first one billion rows of Pascal's Triangle?"}, {"id": 149, "euler_id": 149, "title": "Searching for a maximum-sum subsequence", "problem": "Looking at the table below, it is easy to verify that the maximum possible sum of adjacent numbers in any direction (horizontal, vertical, diagonal or anti-diagonal) is 16 (= 8 + 7 + 1).\n\n\u221225329\u22126513273\u221218\u22124\u00a0 8\nNow, let us repeat the search, but on a much larger scale:\nFirst, generate four million pseudo-random numbers using a specific form of what is known as a \"Lagged Fibonacci Generator\":\nFor 1 \u2264 k \u2264 55, sk = [100003 \u2212 200003k + 300007k3] (modulo 1000000) \u2212 500000.\nFor 56 \u2264 k \u2264 4000000, sk = [sk\u221224 + sk\u221255 + 1000000] (modulo 1000000) \u2212 500000.\nThus, s10 = \u2212393027 and s100 = 86613.\nThe terms of s are then arranged in a 2000\u00d72000 table, using the first 2000 numbers to fill the first row (sequentially), the next 2000 numbers to fill the second row, and so on.\nFinally, find the greatest sum of (any number of) adjacent entries in any direction (horizontal, vertical, diagonal or anti-diagonal).", "solution": "52852124", "difficulty": 50, "story": "Once upon a time in the small town of Numeria, there lived a curious young girl named Lily. Lily was known for her love of numbers and puzzles, often spending her days exploring the mysteries of mathematics. She spent hours solving equations and riddles, but her biggest challenge awaited her in an old abandoned laboratory on the outskirts of town.\n\nOne sunny afternoon, Lily stumbled upon an ancient book hidden in the basement of her family's home. The pages were yellowed and fragile, filled with mathematical secrets and puzzles. As she turned each page, her excitement grew, until she came across an intriguing problem.\n\nThe problem described a table of numbers and promised to unlock the secrets of the greatest sum of adjacent entries in any direction. The example given seemed simple enough, but what intrigued Lily the most was the mention of a much larger scale.\n\nUnable to resist the challenge, Lily decided to put her mathematical skills to the test. She meticulously followed the instructions, generating four million pseudo-random numbers using a Lagged Fibonacci Generator. With each calculation, she felt more and more engrossed in the puzzle, as if she was unraveling a hidden code.\n\nOnce she had all the numbers, Lily arranged them in a magnificent 2000x2000 table. The sight of the massive grid filled her with a mix of excitement and anticipation. It was a task that seemed daunting, but she couldn't help feeling that this puzzle held the key to something extraordinary.\n\nAs Lily started examining the table, she marveled at each row and column, searching for patterns and combinations. She iterated through every possible direction, horizontally, vertically, diagonally, and anti-diagonally. The numbers began to come alive, whispering secrets to her as she entangled herself in their numerical dance.\n\nDays turned into weeks, and weeks into months, but Lily's determination never wavered. Her passion consumed her very being, and she couldn't rest until she had deciphered the enigma hidden within the table.\n\nEvery day, she would solve a little more, pushing her limits and exploring uncharted territories within the vast sea of numbers. Her dedication brought her closer to the answer, step by step, until she felt as if she could reach out and touch the truth.\n\nBut just as Lily was on the verge of unlocking the greatest sum of adjacent entries, she found herself at a crossroads. A question loomed before her: Was this puzzle worth sacrificing everything else? Friends, family, and the world outside had become mere shadows as she delved deep into this mathematical abyss.\n\nLily knew that she had to make a choice. She could continue her relentless pursuit, abandoning all else for the sake of discovery, or she could step back and remind herself that life was more than just numbers and puzzles. It was about connections, love, and the beauty of human existence.\n\nAs the story draws to an end, I invite you, dear reader, to ponder the wonders of this mathematical problem. What will Lily choose? Will she forsake everything for the sake of unraveling its mystery, or will she find balance and embrace the greater puzzle of life itself? Only you can decide."}, {"id": 151, "euler_id": 151, "title": "Paper sheets of standard sizes: an expected-value problem", "problem": "A printing shop runs 16 batches (jobs) every week and each batch requires a sheet of special colour-proofing paper of size A5.\nEvery Monday morning, the supervisor opens a new envelope, containing a large sheet of the special paper with size A1.\nThe supervisor proceeds to cut it in half, thus getting two sheets of size A2. Then one of the sheets is cut in half to get two sheets of size A3 and so on until an A5-size sheet is obtained, which is needed for the first batch of the week.\nAll the unused sheets are placed back in the envelope.\n\nAt the beginning of each subsequent batch, the supervisor takes from the envelope one sheet of paper at random. If it is of size A5, then it is used. If it is larger, then the 'cut-in-half' procedure is repeated until an A5-size sheet is obtained, and any remaining sheets are always placed back in the envelope.\nExcluding the first and last batch of the week, find the expected number of times (during each week) that the supervisor finds a single sheet of paper in the envelope.\nGive your answer rounded to six decimal places using the format x.xxxxxx .", "solution": "0.464399", "difficulty": 50, "story": "Once upon a time in the bustling town of Graphville, there existed a small printing shop nestled between two towering buildings. The shop was known for its precision and efficiency, catering to the needs of the town's residents.\n\nAt the helm of the printing shop was a supervisor named Mr. Newton. He was a man of logic, always obsessed with finding order in chaos. Every Monday morning, as the sun peeked over the horizon, Mr. Newton would arrive at the shop with vigor and purpose.\n\nIn his hand, he clutched a small envelope, sealed with a mysterious insignia. Inside the envelope lay a large sheet of special paper, precisely sized A1. It was the key to a mathematical puzzle that lay at the heart of the printing shop's operations.\n\nAs the door swung open, Mr. Newton would be greeted by the sound of the printing machines humming, eagerly waiting for their first job of the week. He wasted no time and immediately set to work. With great precision, he sliced the A1 sheet in half, creating two smaller sheets of size A2.\n\nHe raised an eyebrow at the spectacle of symmetry and precision before him but continued without hesitation. Taking one of the A2 sheets, he promptly cut it in half again, creating two sheets of A3 size. The process continued, like the steady beat of a metronome, until finally, an A5-size sheet was obtained.\n\nThis magical transformation fascinated Mr. Newton every week. He marveled at how complexity could be distilled so elegantly into simplicity. But little did he know that this seemingly mundane act of paper-cutting had a profound impact on the shop's operations.\n\nYou see, every time Mr. Newton cut a sheet and discarded the unused portion, he intuitively understood the need to preserve order. All the remaining sheets, the A5s as well as the larger ones, were reverently placed back inside the envelope. It was this act that would ultimately determine the future outcome of his printing shop.\n\nAs the week progressed, the printing shop buzzed with activity. Mr. Newton meticulously ensured that each job was done to perfection. However, there was one particular enigma that perplexed him. Excluding the first and last batch, he pondered upon the expected number of times he would find only a single sheet inside the envelope.\n\nFor hours, he analyzed the patterns emerging from his calculations. He sketched diagrams, wrote equations, and even tried to reason with the noise bustling outside his window. But the answer eluded him, like the proof to an unsolved theorem.\n\nAnd so, dear reader, as you immerse yourself in the world of Mr. Newton and the printing shop, I pose the question to you: What is the expected number of times, excluding the first and last batch, that Mr. Newton will find a single sheet of paper in the envelope during each week?\n\nAs you embark on this mathematical journey, let your imagination soar and your logical mind unravel the secrets hidden within the folds of the A1 sheet. Will you find the answer that eluded Mr. Newton? The answer to this question lies within you, waiting to be discovered."}, {"id": 166, "euler_id": 166, "title": "Criss Cross", "problem": "A 4x4 grid is filled with digits d, 0 \u2264 d \u2264 9.\nIt can be seen that in the grid\n\n6 3 3 0\n5 0 4 3\n0 7 1 4\n1 2 4 5\nthe sum of each row and each column has the value 12. Moreover the sum of each diagonal is also 12.\nIn how many ways can you fill a 4x4 grid with the digits d, 0 \u2264 d \u2264 9 so that each row, each column, and both diagonals have the same sum?", "solution": "7130034", "difficulty": 50, "story": "Once upon a time in the bustling city of Mathlandia, there lived a brilliant and curious mathematician named Professor Euler. With his unruly grey hair and spectacles perched precariously on his nose, he spent his days engrossed in the captivating world of numbers. Professor Euler was known for his prowess in solving intricate mathematical problems, which had earned him a reputation as the city's most esteemed problem solver.\n\nOne sunny morning, as Professor Euler sat in his study surrounded by towers of books and stacks of papers, he received a mysterious letter. Intrigued, he carefully opened it, revealing a neatly handwritten message. The letter explained that an ancient artifact, famously known as the \"Mathematical Matrix\", had been discovered deep within the heart of Mathlandia's enchanted forest. It bore the power to unlock unimaginable secrets, but only if a specific mathematical problem was solved.\n\nAs Professor Euler read the problem aloud, his eyes widened with excitement. \"A 4x4 grid is filled with digits d, 0 \u2264 d \u2264 9,\" he repeated, his mind racing with possibilities. \"Each row, each column, and both diagonals must have the same sum. But how many ways can this be achieved?\"\n\nDriven by a burning curiosity, Professor Euler embarked on a journey through the mystical forest, determined to uncover the truths hidden within the Mathematical Matrix. He encountered magical creatures, each with their own unique mathematical challenges. A wise old owl challenged him to solve complex algebraic equations under the light of the moon, while a mischievous sprite led him through a labyrinth filled with geometric puzzles.\n\nAlong the way, Professor Euler found himself faced with a series of obstacles designed to test his mathematical prowess. Each challenge was intricately woven into the fabric of the enchanted forest, forcing him to use his knowledge and intuition to find solutions. As he solved each problem, the forest seemed to come alive with an ethereal energy, as if the very essence of mathematics was awakening.\n\nFinally, after days of grueling challenges, Professor Euler reached the heart of the enchanted forest. He stood before a shimmering portal, the gateway to the Mathematical Matrix. The portal pulsed with a mysterious energy, emanating a feeling of profound significance.\n\nAs he approached the portal, Professor Euler couldn't help but ponder the mathematical problem that brought him here. How many ways could the 4x4 grid be filled so that each row, column, and both diagonals had the same sum? It was a question that held countless possibilities, a tantalizing enigma begging to be unraveled.\n\nWith bated breath, Professor Euler took a step forward and reached out to touch the portal. The moment his fingers made contact, a blinding flash of light engulfed him. When the light faded, he found himself back in his study, the mysterious letter still held firmly in his hands.\n\nAs he sat there, the professor couldn't help but wonder. Did he truly solve the mathematical problem concealed within the Mathematical Matrix? Or was there more to be discovered? And so, dear reader, I leave you with this question: In how many ways can you fill a 4x4 grid with the digits d, 0 \u2264 d \u2264 9, so that each row, each column, and both diagonals have the same sum?"}, {"id": 169, "euler_id": 169, "title": "Exploring the number of different ways a number can be expressed as a sum of powers of 2", "problem": "Define f(0)=1 and f(n) to be the number of different ways n can be expressed as a sum of integer powers of 2 using each power no more than twice.\nFor example, f(10)=5 since there are five different ways to express 10:\n1 + 1 + 8\n1 + 1 + 4 + 41 + 1 + 2 + 2 + 4\n2 + 4 + 4\n2 + 8\nWhat is f(1025)?", "solution": "178653872807", "difficulty": 50, "story": "Once upon a time in the Kingdom of Numeria, there lived a young and curious mathematician named Adrian. He possessed a natural talent for numbers and had a mind that craved logic and patterns. Adrian's favorite pastime was to wander through the streets of the capital, Carthos, engaging in thoughtful conversations with local scholars to expand his mathematical horizons.\n\nOne sunny afternoon, as he strolled down the bustling marketplace, Adrian stumbled upon a peculiar book lying on an old merchant's table. The book was worn and tattered, its pages yellowed with age. Intrigued, Adrian picked it up and dusted off the cover to reveal the title: \"The Enigma of Numbers.\"\n\nUnable to resist his thirst for knowledge, Adrian purchased the book and hurriedly made his way back to his cozy study. With his quill in hand, he eagerly flipped through the pages until something caught his eye. There, on a weathered page, was a mathematical problem that piqued his interest.\n\nThe problem puzzled him: finding the number of different ways n could be expressed as a sum of integer powers of 2, using each power no more than twice. Eager to solve this enigma, Adrian delved into intensive research, digging through ancient scrolls and deciphering cryptic equations. Days turned into nights, and nights into weeks, but no solutions presented themselves. The young mathematician knew he needed to find a way to crack this enigma.\n\nWith newfound determination, Adrian ventured into the heart of the forests surrounding Numeria. He sought solace among the towering trees, hoping nature would gift him the answer he sought. Far away from the distractions of the city, he immersed himself in the study of the problem. Countless hours passed, but still, the solution eluded him.\n\nAs the sky darkened, Adrian reluctantly decided to take a break. He sat on a moss-covered rock and gazed up at the night sky, dotted with sparkling stars. His mind wandered, searching for inspiration amidst the glittering constellations. Suddenly, as if the stars heard his silent pleas, an idea struck him.\n\nAdrian remembered a technique he had learned during his studies\u2014an algorithm for solving problems involving combinations. He rose from the rock, invigorated and determined to test his newfound theory. With renewed hope, he made his way back to Carthos, eager to put his plans into action.\n\nBack in his study, Adrian meticulously implemented his algorithm, carefully noting each result. His quill danced across the parchment as he recorded the countless combinations of integer powers of 2. One after another, each sum revealed itself, bringing Adrian satisfaction and fulfillment.\n\nTime slipped away as Adrian tirelessly worked, never wavering in his pursuit of the ultimate answer. Days turned into weeks, and weeks into months until finally, an unexpected revelation lit up the mathematician's eyes. The missing piece of the puzzle, the key to unlocking the answer, lay before him.\n\nJust as Adrian prepared to shout his victorious discovery to the world, a profound thought crossed his mind. What if the question was not meant to be solved by him alone? What if it was a challenge meant to inspire others, to ignite the spark of curiosity and push them to explore the depths of mathematical beauty?\n\nWith a newfound realization, Adrian set aside his quill and parchment, choosing instead to inspire his fellow mathematicians and aspiring scholars. He compiled his findings, leaving behind detailed instructions and explanations, hoping they would carry on his work and build upon it. He concluded his compilation with a thought-provoking question, a question that would resonate with every curious mind:\n\n\"What is f(1025)?\"\n\nAnd so, the story of Adrian's pursuit of knowledge became more than just a mathematical problem. It became a symbol of curiosity and determination, inspiring generations of mathematicians to explore the uncharted territories of numbers. With Adrian's question lingering in the air, the legacy of his passion for mathematics continued to thrive, encouraging countless minds to seek answers and unlock the beauty hidden within the enigma of numbers."}, {"id": 190, "euler_id": 190, "title": "Maximising a weighted product", "problem": "Let Sm = (x1, x2, ... , xm) be the m-tuple of positive real numbers with x1 + x2 + ... + xm = m for which Pm = x1 * x22 * ... * xmm is maximised.\nFor example, it can be verified that [P10] = 4112 ([ ] is the integer part function).\nFind \u03a3[Pm] for 2 \u2264 m \u2264 15.", "solution": "371048281", "difficulty": 50, "story": "Once upon a time, in the tranquil village of Mathland, there lived a young mathematician named Max. Max was fascinated with numbers and could effortlessly solve complex equations that would leave others scratching their heads. He loved to explore the realm of mathematics, seeking new challenges and finding beauty in the world of numbers.\n\nOne day, Max stumbled upon a mysterious old tome hidden deep within the village library. As he flipped through its dusty pages, his eyes fell upon an intriguing mathematical problem. It read:\n\n\"Let Sm = (x1, x2, ..., xm) be the m-tuple of positive real numbers with x1 + x2 + ... + xm = m for which Pm = x1 * x22 * ... * xmm is maximized. For example, it can be verified that [P10] = 4112. Find \u03a3[Pm] for 2 \u2264 m \u2264 15.\"\n\nCuriosity engulfed Max, and he couldn't resist the lure of this perplexing problem. He knew he had to solve it and uncover its secrets. With a newfound determination, Max set out on this mathematical journey.\n\nAs days turned into weeks, Max immersed himself in the problem, tirelessly working through countless equations and exploring various combinations of real numbers. His mind became a bustling marketplace, filled with calculations and formulas, searching for patterns that would unlock the solution.\n\nMeanwhile, the village of Mathland was bustling with excitement as well. Word had quickly spread about Max's ingenious endeavors, and the villagers followed his progress with anticipation. Max's passion for mathematics inspired them, igniting a love for numbers within their own hearts.\n\nSeeing the impact his journey had on the villagers, Max realized that this was more than just an academic pursuit. The mathematical problem held the power to unite and inspire a whole community. Energized by this thought, Max delved deeper into his quest, determined to find the solution and share it with his fellow villagers.\n\nWeeks turned into months, and Max's pursuit became more than a mere calculation. It became a tale of perseverance and determination. The village stood united, cheering Max on as he tirelessly faced each mathematical challenge. The young mathematician's passion had ignited a fire within Mathland, and together they explored the beauty of numbers.\n\nFinally, after what seemed like an eternity, Max's eyes grew wide with joy, a smile stretching across his face. He had unwrapped the problem's secret, revealing a path to its solution. But Max knew this wasn't just any mathematical answer; it was a key that could unlock a realm of possibility for Mathland.\n\nFilled with excitement, Max gathered the villagers, their eyes shining with anticipation. As he started to explain the solution, he noticed a newfound light in their eyes, a glimmer of understanding. It was as if the numbers had come alive, dancing enchantingly before them.\n\nBut just as Max was about to reveal the complete solution, he paused, a mischievous twinkle in his eye. He realized that this puzzle had captured the hearts and minds of Mathland, connecting them in a way that no other problem could. And so, with a playful smile, Max refrained from disclosing the final answer.\n\nInstead, he turned to the villagers and asked, \"Now, my dear friends, it's time for you to embark on your own mathematical journey. Can you find \u03a3[Pm] for 2 \u2264 m \u2264 15?\"\n\nWith that question hanging in the air, Mathland transformed into a buzzing hub of mathematical exploration. The villagers set out on their quests, their minds filled with equations and strategies. They discovered the joy of uncovering hidden patterns, the thrill of overcoming challenges, and the beauty inherent in the world of mathematics.\n\nAnd so, in Mathland, the pursuit of the mathematical problem became a never-ending journey, connecting generations to come. As day turned to night, and night turned to day, the village's love for numbers continued to flourish, forever inspired by Max's tale and the captivating magic of mathematics."}, {"id": 211, "euler_id": 211, "title": "Divisor Square Sum", "problem": "For a positive integer n, let \u03c32(n) be the sum of the squares of its divisors. For example,\n\u03c32(10) = 1 + 4 + 25 + 100 = 130.\nFind the sum of all n, 0 < n < 64,000,000 such that \u03c32(n) is a perfect square.", "solution": "1922364685", "difficulty": 50, "story": "Once upon a time, in the enchanting kingdom of Arithmia, there lived a young prince named Oliver. Prince Oliver was known throughout the kingdom for his insatiable curiosity and love for solving puzzles. His adventures often took him far and wide, seeking treasures and knowledge hidden in the most unexpected places.\n\nOne sunny morning, as the castle bells rang, a messenger hurrying to find the prince with an urgent message disrupted Oliver's peaceful routine. The message was from an old wizard named Mortimer, who lived in a remote corner of the kingdom, known for his vast knowledge of numbers and mathematical secrets.\n\nPrince Oliver, intrigued by the message, decided to set off immediately to meet the wise wizard and discover the truth behind the mysterious note. After a long and treacherous journey through dense forests and treacherous mountains, the young prince reached the modest hut where the wizard resided.\n\nMortimer welcomed Oliver with a warm smile and, after exchanging pleasantries, began to explain the purpose of his summoning. \"Prince Oliver,\" the wizard began, \"I have been studying a mathematical problem that has been puzzling me for ages. I believe you are the one destined to solve it.\"\n\nIntrigued, the prince listened intently as Mortimer described the problem of sigma 2(n) and perfect squares. The wizard explained that sigma 2(n) represented the sum of squares of divisors of a positive integer, and he wondered if there existed a sum of all n, between zero and 64,000,000, where sigma 2(n) is a perfect square.\n\nPrince Oliver's eyes sparkled with excitement upon hearing the intriguing problem. He realized that solving this mystery could not only bring him great fame but also potentially unlock ancient wisdom and secrets.\n\nDetermined to unravel the enigma, the prince engaged in countless hours of calculations and conducted extensive research in the kingdom's vast library. He studied ancient scrolls, surveyed the works of renowned mathematicians, and consulted with scholars from near and far. The mathematical world held him spellbound as the puzzle consumed his every thought.\n\nAs days turned into weeks, and weeks into months, the young prince delved deeper into the limitless realm of numbers. He discovered fascinating patterns, formulated innovative equations, and experimented with various hypotheses, each leading to another intriguing possibility. The problem became as much a part of him as the air he breathed, driving him onward in his quest for the solution.\n\nOliver's journey had become a race against time, a battle between knowledge and the ever-present realization that the answer might elude him forever. The kingdom's lively streets seemed to blur into a sea of equations, the numbers dancing and swirling before his very eyes.\n\nBut just as Prince Oliver approached the verge of giving up, a moment of clarity struck his weary mind. The solution seemed to emerge from the cauldron of his thoughts, as though it had been hiding in plain sight all along. With renewed determination, he scribbled the final calculations fervently, sensing the answer inching closer.\n\nThe tantalizing truth teetered on the edge of his mind, ready to reveal itself, as if the very fabric of the universe held its breath. In a moment of pure mathematical clarity, the prince finally discovered the solution he had sought for so long.\n\nBut alas! That is where our tale must pause, for revealing the elusive answer would unravel the mystery before you've had the chance to unravel it yourself.\n\nSo dear reader, we pose the question to you: Can you discern the sum of all n, between zero and 64,000,000, where sigma 2(n) is a perfect square?"}, {"id": 215, "euler_id": 215, "title": "Crack-free Walls", "problem": "Consider the problem of building a wall out of 2\u00d71 and 3\u00d71 bricks (horizontal\u00d7vertical dimensions) such that, for extra strength, the gaps between horizontally-adjacent bricks never line up in consecutive layers, i.e. never form a \"running crack\".\nFor example, the following 9\u00d73 wall is not acceptable due to the running crack shown in red:\n\n\nThere are eight ways of forming a crack-free 9\u00d73 wall, written W(9,3) = 8.\nCalculate W(32,10).", "solution": "806844323190414", "difficulty": 50, "story": "Once upon a time in the small village of Numeria, there lived a young and curious mathematician named Emma. Emma was known for her insatiable appetite for puzzles and her love for exploring the wonders of numbers. She had a deep passion for solving mathematical problems, and her enthusiasm led her down many exciting paths.\n\nOne sunny morning, Emma stumbled upon an ancient book in the village library. The book was filled with enigmatic puzzles and riddles, including one that caught Emma's attention. It was about building walls using bricks of different dimensions.\n\nIntrigued by the challenge, Emma read the problem carefully and began contemplating possible solutions. It seemed that the positioning of the bricks was crucial to prevent the formation of a running crack. Emma was determined to find a solution that would satisfy this criterion.\n\nDriven by her mathematical curiosity, Emma embarked on a journey to a nearby city, where she hoped to find inspiration and guidance for her puzzle. She wandered through the bustling streets, seeking out scholars and experts who could assist her in cracking the code.\n\nAfter days of searching, Emma found herself in the humble shop of an elderly man known as Professor Matherson. The shop was filled with an array of intricate puzzles and mathematical artifacts. Emma approached the professor and shared her excitement about the wall-building problem she had discovered.\n\nProfessor Matherson's eyes twinkled with excitement as he listened to Emma's tale. He had spent a great part of his life delving into the mysteries of mathematics and was thrilled to encounter a fellow enthusiast so eager to learn.\n\n\"Ah, my dear Emma,\" the professor said, his voice filled with warmth. \"Building walls using these special bricks is a fascinating challenge indeed. The concept behind it lies in the artistry of creating a harmonious pattern, where the bricks fit seamlessly together while maintaining structural integrity.\"\n\nEmma listened intently as the professor intricately explained the rules and patterns she would need to observe when constructing the walls. He drew diagrams on a chalkboard, illustrating the importance of avoiding cracks and the combinations that would result in an acceptable structure.\n\nAs each piece of the puzzle fell neatly into place, Emma's enthusiasm grew. She couldn't wait to return to Numeria and put her newfound knowledge to the test. Filled with inspiration, she bid Professor Matherson farewell and set off on her journey back home.\n\nBack in Numeria, Emma spent days immersed in the project, tirelessly experimenting with different arrangements of the bricks. She crafted walls of various sizes, meticulously ensuring the absence of those running cracks. Late into the nights, her room was filled with sketches and calculations, inspiring her imagination.\n\nFinally, as the sun began to set on yet another fruitful day, Emma completed her masterpiece\u2014a magnificent wall that defied the odds and remained free of running cracks. She stared at her creation, pride and satisfaction radiating from her.\n\nHowever, just as Emma stood back to admire her work, a voice whispered in her mind, reminding her of the most significant challenge she had yet to face. How could she calculate the number of possible crack-free walls of a much grander magnitude? She pondered over this, contemplating how many possibilities there could be for a wall of the given dimensions of 32x10.\n\nAnd so, dear reader, I leave you with a question that now occupies Emma's mind. Can you calculate W(32,10)? The answer lies in the realm of numbers and patterns, an enigma awaiting your insight and mathematical prowess."}, {"id": 230, "euler_id": 230, "title": "Fibonacci Words", "problem": "For any two strings of digits, A and B, we define FA,B to be the sequence (A,B,AB,BAB,ABBAB,...) in which each term is the concatenation of the previous two.\nFurther, we define DA,B(n) to be the nth digit in the first term of FA,B that contains at least n digits.\nExample:\nLet A=1415926535, B=8979323846. We wish to find DA,B(35), say.\nThe first few terms of FA,B are:\n1415926535\n8979323846\n14159265358979323846\n897932384614159265358979323846\n14159265358979323846897932384614159265358979323846\nThen DA,B(35) is the 35th digit in the fifth term, which is 9.\nNow we use for A the first 100 digits of \u03c0 behind the decimal point:\n14159265358979323846264338327950288419716939937510 \n58209749445923078164062862089986280348253421170679 \nand for B the next hundred digits:\n82148086513282306647093844609550582231725359408128 \n48111745028410270193852110555964462294895493038196 .\nFind \u2211n = 0,1,...,17 \u00a0 10n\u00d7 DA,B((127+19n)\u00d77n) .", "solution": "850481152593119296", "difficulty": 50, "story": "Once upon a time, in a small town nestled at the foot of a majestic mountain, there lived a young girl named Lily. Lily was known for her insatiable curiosity and her love for puzzles and riddles. Every day, she would spend hours wandering through the local library, seeking new mysteries to unravel.\n\nOne afternoon, as she combed through the dusty shelves, a peculiar book caught her eye. Its faded cover bore the words \"The Enigma of Numbers\" in elegant golden letters. Excitedly, she reached for the book and opened it to a random page. To her delight, she stumbled upon a fascinating mathematical problem that intrigued her curious mind.\n\nThe problem described a peculiar sequence called FA,B. It involved two strings of digits, A and B, and with each subsequent term being the concatenation of the previous two. The book presented an example using the strings A = 1415926535 and B = 8979323846, and asked to find a specific digit within the sequence.\n\nAs Lily delved deeper into the mathematical enigma, she discovered that this peculiar sequence had incredible properties. It seemed to be expansive, almost never-ending, requiring countless iterations to reveal its hidden treasures. The more she read, the more captivated she became by the mystery of FA,B.\n\nA spark ignited within Lily's imagination. She dreamt of embarking on a grand adventure to unlock the secrets of this mathematical enigma. With her heart filled with determination, she decided to recreate the example given in the book, using her newfound knowledge.\n\nFor days on end, Lily tirelessly worked on calculating the sequence FA,B. She meticulously wrote down each term, the numbers growing longer and more entangled with each iteration. Her room was soon filled with scraps of paper, covered in digits and calculations.\n\nLily began with the strings A and B. She chose the first 100 digits of \u03c0 behind the decimal point for A, and the next hundred for B. The task was arduous, but she was fueled by her love for the mystery and the desire to solve the riddle that had captured her imagination.\n\nAs the days turned into weeks, and the weeks into months, Lily's obsession with the enigma grew. Friends and family worried about her well-being, but she paid no heed. She had found something that lit a fire within her, and nothing could dampen her spirit.\n\nThe townsfolk started to whisper about the strange girl who would spend hours in solitude, scribbling numbers on scraps of paper. They couldn't understand her relentless pursuit of this seemingly imaginary sequence. But Lily knew she was onto something extraordinary.\n\nMonths turned into years, and Lily found herself on the brink of discovering something incredible. She had calculated the sequence up to the fourth term, with each iteration revealing new patterns and hidden structures. The town's people began to take notice of her dedication and resilience. Some were wary, but others marveled at her tenacity.\n\nAs Lily's journey neared its climax, she came across a significant point in the sequence, contemplating \u2211n = 0,1,...,17   10n\u00d7 DA,B((127+19n)\u00d77n). The book mentioned these factors as an essential part of the enigma. It felt as though she was on the precipice of unraveling the ultimate secret.\n\nWith trembling hands and a racing heart, Lily embarked on the last leg of her epic quest. She grappled with the symbolism, calculated the perplexing equation, and tried to grasp the magnitude of the problem she was trying to solve. Every fiber of her being was dedicated to finding the answer.\n\nAnd now, dear reader, it is your turn. What will Lily find when she reaches the end of her journey? What is the solution to this captivating mathematical problem? The book does not reveal the outcome, and the townsfolk eagerly await your insight. Can you solve the enigma and unveil the answer that has eluded Lily for so long?"}, {"id": 234, "euler_id": 234, "title": "Semidivisible numbers", "problem": "For an integer n \u2265 4, we define the lower prime square root of n, denoted by lps(n), as the largest prime \u2264 \u221an and the upper prime square root of n, ups(n), as the smallest prime \u2265 \u221an.\nSo, for example, lps(4) = 2 = ups(4), lps(1000) = 31, ups(1000) = 37.\nLet us call an integer n \u2265 4 semidivisible, if one of lps(n) and ups(n) divides n, but not both.\nThe sum of the semidivisible numbers not exceeding 15 is 30, the numbers are 8, 10 and 12. 15 is not semidivisible because it is a multiple of both lps(15) = 3 and ups(15) = 5.\nAs a further example, the sum of the 92 semidivisible numbers up to 1000 is 34825.\nWhat is the sum of all semidivisible numbers not exceeding 999966663333 ?", "solution": "1259187438574927161", "difficulty": 50, "story": "Title: The Enchanted Cipher\n\nOnce upon a time, in the mystical land of Numeria, there was a renowned mathematician named Professor Elias. He possessed a deep curiosity for numbers and their enigmatic properties. Elias spent his days exploring the hidden secrets of arithmetic, unraveling mathematical riddles that confounded even the most knowledgeable scholars.\n\nOne day, a strange incident occurred that shook Numeria to its core. The Great Numerian Enchantress, Elara, cast a powerful spell on the kingdom, turning all the numbers in the land into ethereal beings. These living numbers floated through the air, engaging in whimsical dances and complex patterns.\n\nAs the story spread across Numeria, Professor Elias, with his insatiable thirst of knowledge, ventured forth to investigate the phenomenon. He uncovered ancient texts that spoke of a cure \u2014 a secret cipher that could break Elara's curse and restore the numbers to their conventional states.\n\nAfter poring over countless texts, equations, and ancient prophecies, Professor Elias stumbled upon a perplexing mathematical problem. The text mentioned semidivisible numbers, denoted by lps(n) and ups(n). Elias couldn't fathom how these unique numbers were tied to the curse, but he realized they held the key to solving the enchanted cipher.\n\nDriven by determination and his love for numbers, Elias embarked on a quest to unravel the secrets of semidivisible numbers. He traversed vast forests, navigated treacherous rivers, and climbed towering mountains, all the while pondering this enigma. Elias theorized that if he understood the nature of these numbers, he could use their properties to decrypt Elara's curse.\n\nAs Elias delved deeper into his research, he discovered that semidivisible numbers held a peculiar property. Each semidivisible number had either its lower prime square root, lps(n), or its upper prime square root, ups(n), dividing n, but not both. The revelation intrigued the professor, for he knew that grasping this concept would be crucial in devising a solution.\n\nHis journey became a race against time. Elias traversed the enchanted forests, seeking counsel from ancient sages and mathematical wizards who resided in Numeria's distant corners. With each new discovery, Elias grew closer to understanding the secret behind semidivisible numbers.\n\nFinally, after months of relentless pursuit, Elias unlocked the immense power hidden within semidivisible numbers. Their unique quality revealed a path to break Elara's spell and restore Numeria to its former glory. Harnessing this newfound knowledge, he created a powerful numerical algorithm known as the Numerian Decipherer.\n\nAs Elias prepared to cast the Numerian Decipherer, he stood before the citizens of Numeria, who had come to witness the culmination of his journey. He spoke with a voice that resonated with wisdom and determination, \"People of Numeria, I have persevered to understand the mystery of semidivisible numbers. Now, with my Numerian Decipherer, we can break Elara's curse and restore our beloved numbers to their rightful form. But, before I proceed, let me pose a question to you all.\"\n\nHis voice echoed across the land as he continued, \"What is the sum of all semidivisible numbers not exceeding 999966663333?\"\n\nSilence enveloped Numeria as the people attempted to comprehend the question. Elias knew that if the citizens of Numeria could solve this mathematical problem, they would actively contribute to breaking the curse.\n\nAnd so, as the people pondered the question, Elias began the arduous process of activating the Numerian Decipherer, his heart filled with hope and anticipation. The fate of Numeria hung in the balance, solely reliant on the collective brilliance of its citizens to unlock the solution.\n\nWould Numeria, through the combined power of its inhabitants, be able to restore its numbers and defeat the mighty enchantress?\n\nAs we stand on the precipice of this momentous question, imagine yourself as a citizen of Numeria, tasked with solving the puzzle. Can you decipher the sum of all semidivisible numbers not exceeding 999966663333?"}, {"id": 267, "euler_id": 267, "title": "Billionaire", "problem": "You are given a unique investment opportunity.\nStarting with \u00a31 of capital, you can choose a fixed proportion, f, of your capital to bet on a fair coin toss repeatedly for 1000 tosses.\nYour return is double your bet for heads and you lose your bet for tails.\nFor example, if f\u2009=\u20091/4,  for the first toss you bet \u00a30.25, and if heads comes up you win \u00a30.5 and so then have \u00a31.5. You then bet \u00a30.375 and if the second toss is tails, you have \u00a31.125.\nChoosing f to maximize your chances of having at least \u00a31,000,000,000 after 1,000 flips, what is the chance that you become a billionaire?\nAll computations are assumed to be exact (no rounding), but give your answer rounded to 12 digits behind the decimal point in the form 0.abcdefghijkl.", "solution": "0.999992836187", "difficulty": 50, "story": "Once upon a time, in a small town called Riverville, there lived a man named Jonathan. Jonathan was an ordinary individual, leading an ordinary life. However, he always found himself searching for something more exciting, something that would change his life drastically. Little did he know that his quest for the extraordinary was about to begin.\n\nOne sunny morning, as Jonathan was sipping his coffee and flipping through the newspaper, he stumbled upon an intriguing advertisement. It read, \"Unique Investment Opportunity! Chance to become a billionaire!\" His heart skipped a beat as he read the details.\n\nHis curiosity piqued, Jonathan called the number mentioned in the advertisement and soon found himself in a grand office, face-to-face with a well-dressed man named Mr. Sterling. Mr. Sterling was the mastermind behind the opportunity that Jonathan was about to embark on.\n\n\"Welcome, Jonathan,\" Mr. Sterling greeted with a warm smile. \"Today, I present to you the most extraordinary chance of your life. I'm offering you the opportunity to become a billionaire through a series of coin tosses.\"\n\nJonathan recoiled in surprise. \"Coin tosses? How can that possibly make me a billionaire?\"\n\nMr. Sterling chuckled and began to explain. \"You see, Jonathan, you will start with \u00a31 of capital. Then, you will choose a fixed proportion, f, of your capital to bet on a fair coin toss. If heads comes up, your bet is doubled, and if tails shows its face, you lose your bet. This process will be repeated for a total of 1000 tosses.\"\n\nJonathan's eyes widened as he tried to grasp the enormity of the opportunity before him. \"So, what proportion, f, should I choose to maximize my chances of having at least \u00a31,000,000,000?\"\n\nMr. Sterling leaned back in his chair, a thoughtful expression on his face. \"That, my dear Jonathan, is the crux of the matter. The choice of f is pivotal to your success. Choose wisely, and the world could be at your feet. Choose poorly...\" He left the ominous thought hanging in the air.\n\nWith the immense gravity of the situation weighing on him, Jonathan knew that he had to make a well-informed decision. He spent countless hours studying the laws of probability, taking notes, and calculating furiously. As the days turned into weeks, his excitement grew, but so did his anxiety.\n\nEventually, after much contemplation, Jonathan came to a conclusion. Armed with his newfound knowledge, he visited Mr. Sterling's office once again. This time, he was brimming with confidence.\n\n\"Mr. Sterling,\" Jonathan began, his voice laced with determination. \"I have analyzed all the odds, probabilities, and potential outcomes. I have made my decision. I am ready to embark on this incredible journey to become a billionaire.\"\n\nMr. Sterling smiled. \"Excellent! I admire your dedication, Jonathan. It is time to start your adventure.\"\n\nAs Jonathan walked out of Mr. Sterling's office, he couldn't help but feel a mix of excitement and apprehension. Had he made the right choice? Was it truly possible to become a billionaire through a series of coin tosses? And most importantly, what was the chance that he would achieve his goal?\n\nNow, dear reader, the question is yours to answer. Can you calculate the probability that Jonathan becomes a billionaire after 1,000 coin tosses? \n\nTell me, what is the chance that he achieves his dream of amassing a fortune exceeding \u00a31,000,000,000?"}, {"id": 278, "euler_id": 278, "title": "Linear Combinations of Semiprimes", "problem": "\nGiven the values of integers 1<a1<a2<\u22ef<an, consider the linear combination\nq1a1+q2a2+\u22ef+qnan=b, using only integer values qk\u22650. \n\n\nNote that for a given set of ak, it may be that not all values of b are possible.\nFor instance, if a1=5 and a2=7, there are no q1\u22650 and q2\u22650 such that b could be\n1,2,3,4,6,8,9,11,13,16,18 or 23.\n\nIn fact, 23 is the largest impossible value of b for a1=5 and a2=7. We therefore call f(5,7)=23. Similarly, it can be shown that f(6,10,15)=29 and f(14,22,77)=195.\n\n\nFind \u2211f(pq,pr,qr), where p, q and r are prime numbers and p<q<r<5000.\n", "solution": "1228215747273908452", "difficulty": 50, "story": "Once upon a time, in a small village in the kingdom of Mathematica, there lived a young girl named Lily. She had always been fascinated by numbers and patterns. Lily spent her days exploring the countryside, seeking inspiration for her mathematical puzzles.\n\nOne beautiful morning, as the sun painted the sky with hues of gold and pink, Lily stumbled upon an abandoned cabin hidden deep in the forest. Curiosity fueled her, and she couldn't resist going inside. To her surprise, she found dusty old books filled with strange symbols and mathematical equations.\n\nLily's eyes widened with excitement as she flipped through the pages. She discovered a problem that intrigued her the most \u2013 the one concerning the impossible values of b in a linear combination. The concept fascinated her, leaving her thirsty for more knowledge.\n\nAs months went by, Lily dug deeper into the problem. She read countless books, solved numerous equations, and consulted with renowned mathematicians from faraway lands. Determined to understand the patterns behind these impossible values, Lily embarked on a journey to collect data.\n\nShe created a series of experiments using various sets of integers, keeping in mind the conditions stipulated by the problem. Lily spent many sleepless nights, adding more and more values to her growing list.\n\nOne sunny day, as Lily sat under a sprawling oak tree, she noticed the beauty of nature around her. The singing birds, rustling leaves, and swaying flowers all seemed to follow a hidden rhythm. It struck her \u2013 could nature hold the key to the mystery of the impossible values?\n\nLily decided to investigate further by observing the patterns in the natural world. She discovered that the Fibonacci sequence, a sequence of numbers commonly found in nature, played a crucial role. The Fibonacci sequence starts with 0 and 1, and each subsequent number is the sum of the two preceding ones: 0, 1, 1, 2, 3, 5, 8, 13, 21, and so on.\n\nUsing this newfound insight, Lily connected the dots and noticed a correlation between the Fibonacci sequence and the impossible values of b. She found that if she multiplied two consecutive Fibonacci numbers, she obtained a new series of impossible values. This revelation sent shivers down her spine, and she couldn't wait to share her discovery with the world.\n\nLily wrote her findings in a notebook, jotting down the fascinating relationship between the Fibonacci sequence and the impossible values of b. She then traveled to a renowned mathematics conference to present her research. Mathematicians from all across the kingdom listened intently as Lily explained her groundbreaking connection.\n\nAfter she concluded her presentation, a hush fell over the room. The mathematicians pondered Lily's discovery, realizing the far-reaching implications it held for various fields of study. The room erupted in applause, and Lily's heart soared with joy. Her hard work and dedication had paid off.\n\nNow, dear reader, it is your turn to delve into this captivating mathematical problem. Can you find \u2211f(pq,pr,qr), where p, q, and r are prime numbers, and p<q<r<5000? Can you unlock the hidden patterns and reach a solution that even Lily herself couldn't find? Remember, the answer lies within the intricate world of numbers, waiting to be discovered by minds open to its secrets."}, {"id": 286, "euler_id": 286, "title": "Scoring probabilities", "problem": "Barbara is a mathematician and a basketball player. She has found that the probability of scoring a point when shooting from a distance x is exactly (1\u2009-\u00a0x/q), where q is a real constant greater than 50.\nDuring each practice run, she takes shots from distances x\u2009=\u20091, x\u2009=\u20092, ..., x\u2009=\u200950 and, according to her records, she has precisely a 2\u2009% chance to score a total of exactly 20 points.\nFind q and give your answer rounded to 10 decimal places.", "solution": "52.6494571953", "difficulty": 50, "story": "Once upon a time in the small town of Mathville, there lived a brilliant mathematician named Barbara. Barbara had always been fascinated by numbers and formulas, but she also had a hidden passion for basketball. Just like numbers, she found an elegant symmetry in the art of shooting hoops.\n\nBarbara would spend hours every day practicing her basketball skills at the local court. She meticulously recorded her progress, noting down every shot she took and the distance from which it was taken. It was during these practice sessions that Barbara stumbled upon an interesting mathematical problem.\n\nOne day, as Barbara analyzed her records, she noticed a peculiar pattern. She found that the probability of scoring a point when shooting from a distance x was exactly (1 - x/q), where q was a real constant greater than 50. Intrigued, Barbara began to experiment further.\n\nDuring each practice run, she took shots from distances x = 1, x = 2, x = 3, and so on, all the way up to x = 50. She meticulously observed her success rates and meticulously calculated the probabilities. And that's when she made a remarkable discovery.\n\nAccording to her records, Barbara had precisely a 2% chance to score a total of exactly 20 points during her practice sessions. The significance of this finding struck her like a lightning bolt. The mathematical problem she had inadvertently stumbled upon held the key to unlocking a whole new level of proficiency in her basketball game.\n\nBarbara's mind raced with excitement as she realized the potential implications of this mathematical problem. It wasn't just about scoring points efficiently; it was about understanding the calculus of success in basketball. How could she utilize this newfound knowledge to improve her shooting skills?\n\nAs she delved deeper into her calculations, Barbara couldn't help but wonder: what was the value of q? The real constant greater than 50 that would unravel the mysteries of the basketball court.\n\nBut the question remained: how could she find q? The solution had eluded her, and she could feel her excitement turning into frustration. As her mind tirelessly searched for an answer, Barbara pondered the significance of this mathematical problem. What if she could crack the code to perfect her shooting technique based on q's value? Could she become the best mathematician and basketball player in Mathville?\n\nIntrigued by the challenge, Barbara posed the question to herself and to anyone who would listen, \"Find q and give your answer rounded to 10 decimal places. How can I find the value that will unlock a new realm of basketball excellence?\"\n\nAnd so, dear reader, the task is now yours. Can you solve the mathematical problem and help Barbara achieve her dreams of becoming a basketball prodigy? How can you determine the elusive value of q?"}, {"id": 290, "euler_id": 290, "title": "Digital Signature", "problem": "\nHow many integers 0 \u2264 n < 1018 have the property that the sum of the digits of n equals the sum of digits of 137n?\n", "solution": "20444710234716473", "difficulty": 50, "story": "Once upon a time, in a quaint little village nestled in the heart of the countryside, lived a young boy named Ethan. Ethan had an insatiable curiosity for the world around him, especially mathematics. Every day after school, he would immerse himself in his books, eagerly devouring the knowledge that lay within their pages.\n\nOne sunny afternoon, as Ethan sat under the shade of a large oak tree, engrossed in his favorite math book, he stumbled upon a fascinating problem. It went like this: \"How many integers 0 \u2264 n < 1018 have the property that the sum of the digits of n equals the sum of digits of 137n?\"\n\nIntrigued, Ethan's analytical mind started racing. He couldn't help but wonder how this mathematical problem could be relevant to his own life. Determined to solve it, he embarked on a quest for understanding. Determination lit up his young eyes as he embarked on a journey to find the answer.\n\nDays turned into weeks, and weeks turned into months, but Ethan's obsession with the problem only grew stronger. His whiteboard was covered in scribbles, equations, and failed attempts at finding a pattern. The villagers began to wonder if he had lost his mind, spending his days in solitude, mumbling numbers to himself.\n\nOne evening, when the sun bathed the village in shades of gold, Ethan stumbled upon a dusty old diary in the attic of his house. As he gently blew off the dust, a faded inscription caught his eye. It read, \"To anyone who can solve this problem, untold riches await.\" The young boy's heart skipped a beat. Could this be the key to solving his mathematical enigma?\n\nWith newfound hope, Ethan scoured the pages of the diary. It belonged to a long-lost ancestor, a brilliant mathematician who was hailed as a genius. Deep within the diary's crevices, Ethan uncovered a hidden message. It revealed an ancient legend of a mystical talisman that possessed the power to unlock the answer he sought.\n\nDriven by a relentless fascination, Ethan embarked on a thrilling adventure to find the talisman. The journey was fraught with peril, as he braved treacherous mountains, mystical forests, and dark caverns rumored to guard secrets of the universe. But Ethan's determination knew no limits as he trudged forward, guided by his unwavering belief in the power of mathematics.\n\nAs Ethan finally reached the inner sanctum of a hidden temple, bathed in an ethereal glow, he laid eyes upon the fabled talisman. A chill ran down his spine, and his heart raced in anticipation. He could feel the answer to his problem, hidden within the ancient artifact.\n\nBut just as he reached out to touch it, a deafening rumble filled the room. The talisman, surrounded by an aura of pulsating energy, began to crack. Ethan's heart sank as he realized that the talisman was not meant to give him the answer he sought, but rather to guide him on his journey of discovery.\n\nWith a sense of calm, Ethan carefully took note of the cracks forming on the talisman, each fracture symbolizing a piece of the answer. As the room filled with blinding light, he felt a profound connection between the mystical artifact and the mathematical problem burning within his mind.\n\nAs the light faded, Ethan returned home with a newfound resolve and a deeper understanding of the problem that had consumed him. With the diary as his guide and the cracked talisman as a reminder of his journey, he continued to delve into the depths of mathematics.\n\nAnd so, dear reader, I leave you with a question that haunts Ethan to this day: How many integers 0 \u2264 n < 1018 have the property that the sum of the digits of n equals the sum of digits of 137n? Can you unravel the mysterious connection between the two?"}, {"id": 300, "euler_id": 300, "title": "Protein folding", "problem": "In a very simplified form, we can consider proteins as strings consisting of hydrophobic (H) and polar (P) elements, e.g. HHPPHHHPHHPH. \nFor this problem, the orientation of a protein is important; e.g. HPP is considered distinct from PPH. Thus, there are 2n distinct proteins consisting of n elements.\nWhen one encounters these strings in nature, they are always folded in such a way that the number of H-H contact points is as large as possible, since this is energetically advantageous.\nAs a result, the H-elements tend to accumulate in the inner part, with the P-elements on the outside.\nNatural proteins are folded in three dimensions of course, but we will only consider protein folding in two dimensions.\nThe figure below shows two possible ways that our example protein could be folded (H-H contact points are shown with red dots).\n\nThe folding on the left has only six H-H contact points, thus it would never occur naturally.\nOn the other hand, the folding on the right has nine H-H contact points, which is optimal for this string.\nAssuming that H and P elements are equally likely to occur in any position along the string, the average number of H-H contact points in an optimal folding of a random protein string of length 8 turns out to be 850\u00a0/\u00a028=3.3203125.\nWhat is the average number of H-H contact points in an optimal folding of a random protein string of length 15?\nGive your answer using as many decimal places as necessary for an exact result.", "solution": "8.0540771484375", "difficulty": 50, "story": "Once upon a time in a quaint little village, there lived a young and ambitious mathematician named Maxwell. Maxwell had always been captivated by the wonders of numbers and how they explained the mysteries of the world. His heart pounded with excitement as he embarked on his latest mathematical journey - protein folding.\n\nIn his tiny study, adorned with equations scribbled on the walls, Maxwell spent endless nights unraveling the secrets of protein structures. He had read about the incredible complexity that lay within the minuscule strings of hydrophobic (H) and polar (P) elements, and he yearned to understand it further.\n\nAs Maxwell dived deeper into his research, he discovered that proteins in nature were meticulously folded to ensure the maximum number of H-H contact points. The significance of this discovery was not lost on him, as he realized the intricacy behind the folding patterns that occurred within these proteins.\n\nThe more Maxwell delved into the mathematical intricacies, the more he realized the power of protein folding. It was not just a scientific phenomenon; it held the key to unlocking untold potential. If he could decipher the optimal folding patterns, he could pave the way for revolutionary advancements in medicine, genetic engineering, and even the treatment of diseases.\n\nDays turned into weeks, and weeks into months as Maxwell meticulously worked on his hypotheses. He meticulously folded and unfolded countless imaginary proteins in his mind, searching for the pattern that would unlock the secrets of nature's design.\n\nOne rainy evening, Maxwell stumbled upon a groundbreaking revelation hidden within the folds of his own thoughts. With a mix of euphoria and the certainty of a true scientist, he realized that the average number of H-H contact points in an optimal folding of a random protein string could be the key to understanding the complexity of these structures.\n\nHis heart leaped with excitement - a puzzle to solve, a mystery to unravel. Maxwell spent days poring over simulations and calculations, pushing the boundaries of his mathematical prowess. It was in that moment he knew he had found his life's purpose, his calling within the realm of proteins.\n\nAs the autumn leaves painted the village in shades of fiery red and burnt orange, Maxwell excitedly approached the common gathering spot, where the villagers would often share stories and ignite their curiosity. His friends and neighbors gathered around, eager to hear the tale Maxwell had to tell.\n\nWith passion radiating from his eyes, Maxwell recounted his incredible journey through the world of proteins, weaving his story into the fabric of the village's collective imagination. He explained the significance of H-H contact points, the delicate dance of hydrophobic and polar elements, and the remarkable complexity hidden within each folded string.\n\nThe villagers listened intently, their imaginations ignited by the power of Maxwell's words. They marveled at the ingenuity of nature, the elegance that lay within the very building blocks of life itself.\n\nIn a single breath, Maxwell concluded his tale, leaving the villagers in awe of the mysteries that lurked behind seemingly mundane protein strings. But just as the story reached its climactic peak, Maxwell paused, realizing that he had not yet answered the most important question of all.\n\nWith a twinkle in his eye, Maxwell looked at the villagers, a mischievous smile playing on his lips. \"Now, dear friends,\" he exclaimed, \"I have shared with you the wonders of protein folding, the beauty of H-H contact points, and the significance they hold. But tell me this - what is the average number of H-H contact points in an optimal folding of a random protein string of length 15?\"\n\nAs the villagers pondered this question, their minds raced, captivated by the challenge Maxwell had presented. The mathematical problem now rested in their hands, ready to test their intellect and awaken their thirst for knowledge.\n\nThe villagers contemplated, discussed, and debated, each embracing the mystery with their unique perspective. And so, in the village that thrived on the pursuit of knowledge, a new task unfolded - to solve the mathematical problem that lay at the heart of Maxwell's tale.\n\nAnd so, dear reader, I leave you with the same question: What is the average number of H-H contact points in an optimal folding of a random protein string of length 15? The answer lies within the folds of your imagination, awaiting your exploration."}, {"id": 309, "euler_id": 309, "title": "Integer Ladders", "problem": "In the classic \"Crossing Ladders\" problem, we are given the lengths x and y of two ladders resting on the opposite walls of a narrow, level street. We are also given the height h above the street where the two ladders cross and we are asked to find the width of the street (w).\n\nHere, we are only concerned with instances where all four variables are positive integers.\nFor example, if x = 70, y = 119 and h = 30, we can calculate that w = 56.\nIn fact, for integer values x, y, h and 0 < x < y < 200, there are only five triplets (x,y,h) producing integer solutions for w:\n(70, 119, 30), (74, 182, 21), (87, 105, 35), (100, 116, 35) and (119, 175, 40).\nFor integer values x, y, h and 0 < x < y < 1 000 000, how many triplets (x,y,h) produce integer solutions for w?", "solution": "210139", "difficulty": 50, "story": "Once upon a time in a small town called Numeria, there lived a brilliant mathematician named Professor Ethan. Known for his sharp mind and problem-solving skills, Professor Ethan was respected by everyone in the town. He spent his days pondering over numbers and equations, looking for patterns and solutions to the most complex mathematical problems.\n\nOne sunny morning, as Professor Ethan sat in his study, engrossed in his latest project, a knock came at his door. He looked up to find a young man named Max standing nervously before him. Max was a carpenter and had often sought the professor's advice on various calculations for his work.\n\n\"Good morning, Max!\" Professor Ethan greeted warmly. \"What brings you here today?\"\n\nMax shifted uncomfortably and said, \"Professor Ethan, I have a problem that I just can't solve. You see, I've been tasked with building two ladders on opposite sides of a narrow street. But the catch is that the ladders need to meet at a specific height above the street. I've measured everything, but I'm at a loss when it comes to figuring out how wide the street should be. Can you help me?\"\n\nThe professor's eyes lit up with excitement. This was no ordinary problem, but a classic \"Crossing Ladders\" problem. He had read about it in ancient mathematical texts, but he had never encountered it in real life. This was an opportunity to put his knowledge to the test.\n\n\"Max,\" Professor Ethan began, \"tell me, what are the lengths of the two ladders and the height at which they cross?\"\n\nMax replied, \"The length of the first ladder is 70 units, the second ladder is 119 units, and they meet at a height of 30 units above the street.\"\n\nProfessor Ethan smiled. He reached for a pen and paper, rapidly scribbling equations and sketching diagrams. As he worked, he explained to Max the intricacies of the problem and the importance of finding integer solutions.\n\nMax watched with fascination as the professor analyzed the problem using his mathematical expertise. It was almost like witnessing magic unfold before his eyes. After a few minutes, the professor put down his pen and looked at Max, his eyes gleaming with excitement.\n\n\"Max, I have found a solution!\" Professor Ethan exclaimed. \"The width of the street should be 56 units.\"\n\nMax was amazed. The professor's calculations had solved his problem perfectly. He thanked Professor Ethan profusely and left his study, ready to build the ladders with confidence.\n\nDays turned into weeks, and Professor Ethan continued to receive visits from townsfolk seeking his help in various mathematical quandaries. The \"Crossing Ladders\" problem became a legend in Numeria, with Max's story inspiring others to explore the world of mathematics. The professor's legacy grew, and his reputation as a master problem solver spread far and wide.\n\nBut amidst the admiration and acclaim, good Professor Ethan found himself pondering a deep and fundamental question: How many triplets of integer values (x, y, h) would produce integer solutions for the width of the street, given that 0 < x < y < 1,000,000?\n\nAnd so, as the sun set over Numeria, Professor Ethan posed this yet-unsolved question to the readers: Can you find the answer to this mathematical mystery?"}, {"id": 312, "euler_id": 312, "title": "Cyclic paths on Sierpi\u0144ski graphs", "problem": "- A Sierpi\u0144ski graph of order-1 (S1) is an equilateral triangle.\n- Sn+1 is obtained from Sn by positioning three copies of Sn so that every pair of copies has one common corner.\n\n\nLet C(n) be the number of cycles that pass exactly once through all the vertices of Sn.\nFor example, C(3) = 8 because eight such cycles can be drawn on S3, as shown below:\n\n\nIt can also be verified that :\nC(1) = C(2) = 1\nC(5) = 71328803586048\nC(10 000) mod 108 = 37652224\nC(10 000) mod 138 = 617720485\nFind C(C(C(10 000))) mod 138.\n", "solution": "324681947", "difficulty": 50, "story": "Once upon a time, in a quaint village nestled at the foot of a majestic mountain range, there lived a young girl named Lily. Lily possessed a curious mind and an insatiable thirst for knowledge, particularly when it came to mathematics. Her favorite pastime was exploring the mysteries hidden within the natural world.\n\nOne sunny morning, as Lily set out on her daily adventure, she stumbled upon an ancient, weathered book hidden among a bed of vibrant wildflowers. She blew away the dust and opened it, revealing a magical tale that promised to challenge her mathematical prowess. The story spoke of a mystical graph called the Sierpi\u0144ski graph and its infinite possibilities.\n\nIntrigued, Lily dived into her studies, poring over intricate diagrams and complex equations. She soon discovered that each Sierpi\u0144ski graph had a unique property. As she dwelled deeper into the book, she learned that the number of cycles passing exactly once through all the vertices of the graph, denoted as C(n), was a profound puzzle yet to be fully unraveled.\n\nLily's inquisitive nature kicked into high gear as she delved deeper into the world of Sierpi\u0144ski graphs. Like a detective working on a challenging case, she unraveled the mystery of C(1) and C(2), which were both equal to 1. But it was the enigmatic C(5) that truly captivated her.\n\nAs Lily immersed herself into the mystical world of C(5), her imagination soared. She marveled at the complex dance of cycles weaving through Sierpi\u0144ski graphs of higher orders, demonstrating an awe-inspiring dance of connectivity. In the graph's intricate patterns, Lily discerned beauty and harmony, as if the universe itself held its breath, waiting for her to crack its secrets.\n\nAs days turned into weeks, Lily's obsession with Sierpi\u0144ski graphs grew. She spent countless hours contemplating the significance of C(n) and its underlying structure. Night and day, her mind raced with numbers and symbols, desperate to uncover the true meaning behind C(10,000).\n\nAt long last, Lily stumbled upon a golden nugget buried deep within the annals of mathematical knowledge. She discovered that C(10,000) could be reduced to a series of modulo equations, promising to unlock the secrets of the universe.\n\nWith trembling hands and bated breath, Lily dared to solve C(C(C(10,000))) modulo 138\u2014an equation that held the key to the ultimate understanding of Sierpi\u0144ski graphs and their infinite cycles. This was her moment of truth, her chance to glimpse into the very blueprint of creation.\n\nAnd as the sun dipped below the horizon, casting a warm glow over the mountains, Lily's question lingered in the air, echoing through the village and into the hearts of all who yearned for knowledge: What is C(C(C(10,000))) modulo 138?\n\nThe answer awaited, patiently nestled within the unfathomable depths of mathematical wonder, eager to challenge the minds and ignite the spirits of those who dared to seek it. And so, the journey to uncover the solution had just begun. Would Lily, armed with her insatiable curiosity and boundless determination, unravel the enigma of C(C(C(10,000)))? Only time would tell."}, {"id": 318, "euler_id": 318, "title": "2011 nines", "problem": "\nConsider the real number 2+3.\nWhen we calculate the even powers of 2+3\nwe get:\n(2+3)2=9.898979485566356\u2026\n(2+3)4=97.98979485566356\u2026\n(2+3)6=969.998969071069263\u2026\n(2+3)8=9601.99989585502907\u2026\n(2+3)10=95049.999989479221\u2026\n(2+3)12=940897.9999989371855\u2026\n(2+3)14=9313929.99999989263\u2026\n(2+3)16=92198401.99999998915\u2026\n\nIt looks as if the number of consecutive nines at the beginning of the fractional part of these powers is non-decreasing.\nIn fact it can be proven that the fractional part of (2+3)2n approaches 1 for large n.\n\n\nConsider all real numbers of the form p+q with p and q positive integers and p<q, such that the fractional part \nof (p+q)2n approaches 1 for large n.\n\n\nLet C(p,q,n) be the number of consecutive nines at the beginning of the fractional part of (p+q)2n.\n\n\nLet N(p,q) be the minimal value of n such that C(p,q,n)\u22652011.\n\n\nFind \u2211N(p,q)\u00a0for\u00a0p+q\u22642011.\n", "solution": "709313889", "difficulty": 50, "story": "Once upon a time in the mystical kingdom of Numeria, there lived a young princess named Persephone. Known for her love of numbers and solving mathematical puzzles, she spent most of her time engrossed in her studies, searching for patterns and relationships in the world around her. One day, as she was perusing through an ancient scroll, she stumbled upon a peculiar mathematical problem that captivated her imagination.\n\n\"Consider the real number 2+3,\" the problem read. Intrigued, Persephone began delving deeper into the problem. As she calculated the even powers of 2+3, she noticed a peculiar pattern emerging. The fractional parts of these powers seemed to have an increasing number of consecutive nines at the beginning. Excited by this discovery, Persephone couldn't help but wonder if this pattern held true for all real numbers of the form p+q with p and q being positive integers, and if so, what were the minimum values of n where this occurred.\n\nDeep in thought, Persephone pondered the implications of this mathematical phenomenon. Her mind started swirling with possibilities, and she couldn't shake the idea of harnessing this pattern to create a powerful magical spell. In her heart, she knew that if she could uncover the formula behind this pattern, it could change the way magic was practiced in Numeria forever.\n\nWith newfound determination, Persephone embarked on a grand adventure to uncover the secrets of this mathematical puzzle. She consulted the wise elders of Numeria, who pointed her in the direction of the legendary Numerian Sage, Roderick. \n\nRoderick, an elderly wizard known for his wisdom and expertise in numerical magic, welcomed Persephone into his mystical tower. They spent countless hours pouring over ancient scrolls, discussing theories, and debating the intricacies of mathematics. Roderick, impressed by Persephone's passion and intellect, urged her to explore the problem far beyond the constraints of the original question.\n\nAs the months passed, Persephone's understanding of the problem grew. She discovered that the fractional part of (p+q)2n approached 1 for large values of n, for any real numbers of the form p+q with p and q being positive integers. Guided by her discoveries, she developed her own formula to calculate the number of consecutive nines at the beginning of the fractional part of these powers.\n\nPersephone's excitement knew no bounds. She felt as if she held the key to a hidden treasure, a treasure that could unlock the true power of magic. With newfound hope, she called upon the people of Numeria, mathematicians, scholars, and magical beings alike, to help her decipher the mystery of the minimum values of n where the consecutive nines appeared.\n\nAnd so, the kingdom of Numeria buzzed with excitement as the search for answers unfolded. Months turned into years, and the crowds at Persephone's palace grew larger each day. Mathematicians from distant realms poured in, each contributing their unique perspectives and insights. The streets of the kingdom were lined with chalkboards, filled with equations and conjectures, as everyone eagerly joined in the quest to solve the mathematical puzzle that once captivated the curious mind of Princess Persephone.\n\nAs the story unfolds, what will become of Persephone's quest? Will she uncover the secrets of the mathematical problem that had ignited her passion? What challenges lie ahead, and how will she overcome them? And most importantly, can you, dear reader, solve the mathematical problem that had enveloped the kingdom of Numeria in a cloud of intrigue and anticipation?"}, {"id": 320, "euler_id": 320, "title": "Factorials divisible by a huge integer", "problem": "\nLet N(i) be the smallest integer n such that n! is divisible by (i!)1234567890\n\nLet S(u)=\u2211\u2009N(i) for 10 \u2264 i \u2264 u.\n\n\nS(1000)=614538266565663.\n\n\nFind S(1 000 000) mod 1018.\n", "solution": "278157919195482643", "difficulty": 50, "story": "Once upon a time, in a small village nestled within a lush green valley, lived a young girl named Lily. Lily was known for her insatiable curiosity and her love for solving intricate puzzles. It seemed that her mind was always abuzz with numbers, equations, and mathematical problems.\n\nOne sunny morning, as Lily was helping her mother tend to their beautiful garden, she noticed an old book tucked away in a corner. The cover was worn and faded, but Lily's eyes lit up with excitement. She felt an inexplicable pull towards the book and knew that it held something extraordinary within its tattered pages.\n\nCarefully wiping away the dust, Lily discovered that the book was filled with complex mathematical problems. As she flipped through the pages, her eyes caught sight of a particular problem that intrigued her. It involved factorials, a concept she had recently learned in her mathematics class.\n\nThe problem was as follows:\n\nLet N(i) be the smallest integer n such that n! is divisible by (i!)1234567890\n\nLet S(u) = \u2211\u2009N(i) for 10 \u2264 i \u2264 u.\n\n\nS(1000) = 614538266565663.\n\n\nFind S(1 000 000) mod 1018.\n\nThe numbers danced before Lily's eyes, arousing her inquisitiveness. She wondered how she could utilize this mathematical problem to benefit her village. Lily realized that by solving this, she could unlock a powerful secret that might change the lives of those around her.\n\nDriven by her passion for knowledge and the pursuit of enlightenment, Lily left the comfort of her village and embarked on a journey to seek guidance from renowned mathematicians and scholars across the realm. Her hope was to gain wisdom and find a solution to this enigmatic mathematical tale.\n\nAs her journey took her through bustling cities and quiet towns, Lily encountered a multitude of people from all walks of life. From humble farmers to sage-like scholars, every person she met had their unique perspective on the problem. Each conversation was like a thread in the tapestry of Lily's search for understanding.\n\nWith every encounter, Lily gained more insight into the problem. The tangle of numbers began to become clearer, and she could almost taste the answer at the tip of her tongue. But as she delved deeper, she realized that the solution was not confined to theory or equations alone; it required imagination, creativity, and a true understanding of the world.\n\nOne evening, after days of intense contemplation, Lily found herself sitting beneath a massive oak tree. Its branches swayed gently in the evening breeze, whispering ancient secrets to her. The sun was setting, casting a warm golden glow across the landscape. It was in this serene moment that inspiration struck Lily like a lightning bolt.\n\nIn the unity of nature and numbers, Lily discovered the answer that had eluded her for so long. The mathematical problem, as complex as it seemed, hid a remarkable truth about the very fabric of life itself. She realized that every number, every factorial, was interconnected, woven with an invisible thread that connected every living thing in the universe.\n\nEager to share her newfound clarity with her village and the world beyond, Lily returned home. She organized a gathering in the village square, where villagers eagerly listened to her tale. As she explained the mathematical problem and its implications, a sense of wonder filled the air. Lily's words kindled a spark of curiosity within each person, and soon the entire village was immersed in a collective pursuit of knowledge.\n\nAnd so, the village of Lily's childhood became a haven for learning, where young minds flourished and new discoveries were made every day. The problem that once puzzled Lily, now illuminated the path towards greater understanding and scientific advancement.\n\nNow, dear reader, I pose this question to you: Can you solve this mathematical problem that Lily unravelled amidst her incredible journey? Can you find S(1,000,000) mod 10^18? Similar to Lily, will you too uncover the hidden wisdom and connect it to the wonders of the world around us?"}, {"id": 324, "euler_id": 324, "title": "Building a tower", "problem": "Let f(n) represent the number of ways one can fill a 3\u00d73\u00d7n tower with blocks of 2\u00d71\u00d71. You're allowed to rotate the blocks in any way you like; however, rotations, reflections etc of the tower itself are counted as distinct.\nFor example (with q = 100000007) :f(2) = 229,f(4) = 117805,f(10) mod q = 96149360,f(103) mod q = 24806056,f(106) mod q = 30808124.\nFind f(1010000) mod 100000007.", "solution": "96972774", "difficulty": 50, "story": "Once upon a time in a distant kingdom, there was a young mathematician named Emma. She lived in a small cottage on the edge of the royal city and was known for her love of puzzles and patterns. Emma's passion for mathematics was matched only by her curiosity.\n\nOne day, as Emma was strolling through the marketplace, she overheard a group of merchants conversing about an unsolved mathematical problem. Intrigued, she approached them and asked what the problem was.\n\nThe merchants explained that the problem involved filling a peculiar structure called a 3\u00d73\u00d7n tower with blocks of 2\u00d71\u00d71. These blocks could be rotated in any way, but the tower itself was fixed in place. The goal was to determine the number of different ways the tower could be filled.\n\nAlthough the problem seemed deceptively simple, Emma immediately recognized the intricate nature of its solution. The interaction between the size of the tower and the dimensions of the blocks intrigued her, and she knew it would consume her thoughts until she cracked it.\n\nUnable to resist the allure of the problem, Emma retreated to her cottage, which was adorned with shelves lined with books on mathematics. She poured over countless pages, sketching diagrams, and developing algorithms to solve the enigma posed by the 3\u00d73\u00d7n tower.\n\nDays turned into weeks, weeks into months, and Emma's determination grew stronger with each passing moment. She was consumed by the challenge, her meals interrupted only by the scribbling of equations and the scratching of pencils. The townspeople began to wonder if Emma had disappeared into a world of numbers.\n\nAs she delved deeper into her quest, Emma discovered a pattern emerging. With each new layer of the tower, the number of ways to fill it increased exponentially. She marveled at how a simple change in height could yield such profound alterations in solutions.\n\nFinally, after months of tireless efforts, Emma felt a spark of excitement. She had determined that the number of ways to fill the 3\u00d73\u00d7n tower correlated with the Fibonacci sequence, a famous sequence in mathematics. This realization sent chills down her spine, as she saw the beauty and complexity in the problem.\n\nEmma felt an incredible rush of joy, knowing she had come one step closer to solving the mathematical problem. However, she also felt a tinge of sorrow, for she knew that her journey was not yet complete. The ultimate challenge would be finding the value of f(1010000) mod 100000007, a task that exceeded the limits of her current knowledge.\n\nShe realized that solving this final piece of the puzzle required collaboration, a joint effort from mathematicians far and wide. With a determined glimmer in her eye, Emma set forth to share her discovery with the world, hoping that together they could uncover the answer.\n\nAs you read this tale, dear reader, I ask you to join Emma on her quest. Will you help her find the value of f(1010000) mod 100000007? In doing so, you become part of a larger narrative, one that transcends time and space, a quest that unites curious minds in search of truth. Will you embrace the challenge and embark on this mathematical journey?"}, {"id": 332, "euler_id": 332, "title": "Spherical triangles", "problem": "A spherical triangle is a figure formed on the surface of a sphere by three great circular arcs intersecting pairwise in three vertices.\n\nLet C(r) be the sphere with the centre (0,0,0) and radius r.\nLet Z(r) be the set of points on the surface of C(r) with integer coordinates.\nLet T(r) be the set of spherical triangles with vertices in Z(r).\nDegenerate spherical triangles, formed by three points on the same great arc, are not included in T(r).\nLet A(r) be the area of the smallest spherical triangle in T(r).\nFor example A(14) is 3.294040 rounded to six decimal places.\nFind \u2211r=150A(r). Give your answer rounded to six decimal places.", "solution": "2717.751525", "difficulty": 50, "story": "Once upon a time, in the small village of Mathville, there lived a young girl named Alice. Alice had always been fascinated by numbers and shapes, so much so that she often dreamed of exploring the hidden patterns that lay within them.\n\nOne sunny afternoon, as Alice lay lazily on the grass, she spotted a peculiar object glittering in the distance. Curiosity won over her and she hopped to her feet, her eyes shining brightly with excitement. As she approached, she realized it was a spherical gem, shimmering with different hues of light.\n\nAlice carefully picked up the gem, marveling at its perfect spherical shape. Little did she know that this gem held the key to a magical adventure that would forever change her life. As soon as Alice held the gem tightly in her palm, she felt a warm glow enveloping her, transporting her to a mysterious realm.\n\nWhen Alice opened her eyes, she found herself standing in a vast, magical library. Ancient books lined the shelves, each one holding secrets and knowledge waiting to be uncovered. Intrigued, Alice began to explore. As she roamed through the aisles, she stumbled upon a book titled \"The Realm of Spherical Triangles.\"\n\nIntrigued by the title, Alice opened the book and began to read about the concept of spherical triangles. The book explained that these triangles were formed on the surface of a sphere when three great circular arcs intersected. She learned about the sphere's center, the points on its surface with integer coordinates, and the degenerate triangles formed by points on the same great arc.\n\nAs Alice delved deeper into the book, she realized that the author had left a puzzle for the reader to solve. It involved finding the area of the smallest spherical triangle in a set called T(r), with r being the radius of the sphere. Her mind raced with delight and intrigue \u2013 she had stumbled upon a mathematical mystery!\n\nDetermined to solve the puzzle, Alice embarked on a quest to find the answers. She encountered different challenges along the way\u2014 riddles, puzzles, and even magical creatures that tested her mathematical acumen. With each triumph, Alice grew more confident, realizing the importance of perseverance and the brilliance of mathematics.\n\nFinally, after countless challenges and with her heart pounding in her chest, Alice found herself face to face with the mystical mathematician, the guardian of the puzzle's solution. The guardian congratulated her on her perseverance and understanding of spherical triangles.\n\nHowever, the guardian did not reveal the answer, for that was not their role. Instead, they posed another question to Alice, one that was intricately tied to the mathematical problem she had been unraveling.\n\n\"Now, Alice,\" the guardian said, their voice filled with wisdom, \"imagine a grand sphere with a radius of 150. Can you find the sum of the areas of the smallest spherical triangles, A(r), for each radius from 1 to 150?\"\n\nAlice stood there, gazing at the guardian with determination in her eyes. The question stirred up an excitement deep within her. She knew that the answer would lie not only within her mathematical abilities but also within her persistence, creativity, and the never-ending spirit of exploration.\n\nAnd so, dear reader, now that you have heard the tale of Alice and her mind-boggling mathematical puzzle, I present the question to you: \n\nCan you find \u2211r=150A(r)? Give your answer rounded to six decimal places."}, {"id": 342, "euler_id": 342, "title": "The totient of a square is a cube", "problem": "\nConsider the number 50.\n502 = 2500 = 22 \u00d7 54, so \u03c6(2500) = 2 \u00d7 4 \u00d7 53 = 8 \u00d7 53 = 23 \u00d7 53. 1\nSo 2500 is a square and  \u03c6(2500) is a cube.\n\n\nFind the sum of all numbers n, 1 < n < 1010 such that \u03c6(n2) is a cube.\n\n\n1 \u03c6 denotes Euler's totient function.\n", "solution": "5943040885644", "difficulty": 50, "story": "Once upon a time in the small village of Numeria, there lived a young prodigy named Amelia. She had always possessed a remarkable way with numbers, and her mind was like a vast, infinite universe, constantly exploring the mysteries of mathematics. While her peers were content with mundane activities, Amelia found solace in the complexity of numbers.\n\nOne fateful day, a peculiar letter arrived at Amelia's doorstep. With trembling hands, she opened it, revealing a cryptic message written in elegant calligraphy.\n\n\"Dear Amelia,\n\nI have heard tales of your extraordinary talent with numbers, and I am in dire need of your assistance. I have stumbled upon an enigma that has left mathematicians perplexed for centuries. Consider the number 50; it possesses a remarkable property. 502 can be written as 22 multiplied by 54, which means that phi of 2500, denoted as \u03c6(2500), is equal to 2 multiplied by 4 multiplied by 53, which simplifies to 8 multiplied by 53 or 23 multiplied by 53. In other words, 2500 is a perfect square, and \u03c6(2500) is a perfect cube.\n\nMy query to you, dear Amelia, lies in unraveling a more profound mystery. I implore you to find all the numbers, n, within the range of 1 to 1010, where \u03c6(n squared) is a perfect cube.\"\n\nAmelia's eyes sparkled with excitement as she pondered the magnitude of the problem before her. She spent sleepless nights engrossed in her calculations, seeking patterns and connections within the vast realm of numbers. The villagers watched in awe as Amelia's fervor consumed her days, her countenance illuminated by an unfathomable thirst for knowledge.\n\nMonths turned into years, and the whispers of Amelia's quest spread far beyond the village borders. Scholars and mathematicians from distant lands flocked to Numeria, drawn by the allure of the unsolved problem. They marveled at Amelia's brilliance, her unwavering dedication to her cause.\n\nAs the years went by, the village transformed into a mecca of mathematical exploration. The presence of such brilliant minds coming together breathed new life into the once-sleepy hamlet. Conversations echoed through the cobblestone streets filled with complex equations and infinite possibilities.\n\nBut amidst the intellectual fervor, Amelia remained focused on her quest. Hours bled into days, days into weeks, weeks into months, and finally, a breakthrough emerged from the depths of her tireless calculations.\n\nWith trembling hands, Amelia presented her findings to the gathered scholars and mathematicians. The room was filled with anticipation as she revealed the answer - the sum of all numbers, n, from 1 to 1010, where \u03c6(n squared) is a perfect cube.\n\nJust as the words left Amelia's lips, the village of Numeria fell into complete silence. But before anyone could absorb the magnitude of her discovery, a single question danced in the air, lingering on the lips of every witness: \"Can you find the solution to this profound mathematical enigma?\"\n\nAnd thus, dear reader, with the story of Amelia's mathematical quest unraveling before you, I leave you with that very same question. Can you solve this fascinating challenge and find the sum of all numbers, n, from 1 to 1010, where \u03c6(n squared) is a perfect cube?"}, {"id": 353, "euler_id": 353, "title": "Risky moon", "problem": "\nA moon could be described by the sphere C(r) with centre (0,0,0) and radius r. \n\n\nThere are stations on the moon at the points on the surface of C(r) with integer coordinates. The station at (0,0,r) is called North Pole station, the station at (0,0,\u2212r) is called South Pole station.\n\n\nAll stations are connected with each other via the shortest road on the great arc through the stations. A journey between two stations is risky. If d is the length of the road between two stations, (d\u03c0r)2 is a measure for the risk of the journey (let us call it the risk of the road). If the journey includes more than two stations, the risk of the journey is the sum of risks of the used roads.\n\n\nA direct journey from  the North Pole station to the South Pole station has the length \u03c0r and risk 1. The journey from the North Pole station to the South Pole station via (0,r,0) has the same length, but a smaller risk:\n(12\u03c0r\u03c0r)2+(12\u03c0r\u03c0r)2=0.5\n\nThe minimal risk of a journey from the North Pole station to the South Pole station on C(r) is M(r).\n\n\nYou are given that M(7)=0.1784943998  rounded to 10 digits behind the decimal point. \n\n\nFind \u2211n=115M(2n\u22121).\n\n\nGive your answer rounded to 10 digits behind the decimal point in the form a.bcdefghijk.\n", "solution": "1.2759860331", "difficulty": 50, "story": "The moon had always been a mysterious place, but as human civilization expanded into space, it became a realm of possibilities. In this future era, a network of stations was established on the moon's surface, each one meticulously placed to maximize efficiency and exploration. Among these stations were the North Pole station and the South Pole station, separated by a perilous journey that few dared to attempt.\n\nIn the bustling control room of the North Pole station, Commander Ava Cooper surveyed the monitors displaying the numerous stations dotted around the moon. As a seasoned astronaut, Ava had dedicated her life to exploring the cosmos and pushing the boundaries of human knowledge. Today, she found herself captivated by a mathematical problem that had recently surfaced.\n\nAva's attention was drawn to a document that detailed the mathematical intricacies of the moon's topology, specifically the risks associated with interconnecting the stations. It stated that the risk of a journey between any two stations was quantified by the equation (d\u03c0r)\u00b2. The risk increased exponentially based on the length of the road, measured by d, and the radius of the moon, denoted as r.\n\nCuriosity piqued, Ava delved deeper into the document and discovered that a direct journey from the North Pole station to the South Pole station had a length of \u03c0r and a risk of 1. But what intrigued her even more was the mention of a less risky, alternate route passing through a point midway between the poles.\n\nAva ran the calculations multiple times, tracing the shorter path that ventured through (0,r,0). According to the document, this alternative route had the same length as the direct journey but a smaller risk. The equation (1/2\u03c0r\u03c0r)\u00b2 accounted for the decreased risk, measuring to 0.5.\n\nAs she pondered the significance of this discovery, a thought flashed across Ava's mind. \"What if we could find the minimal risk, M(r), of a journey from the North Pole station to the South Pole station on C(r)? How would that help us strategize and enhance the safety of future moon missions?\"\n\nLost in her contemplation, Ava realized that she held a vital key to unlocking this mathematical enigma\u2014a solution that could revolutionize lunar travel. But she couldn't do it alone; she needed the collective genius of the scientific community to crack this problem.\n\nWith determination in her eyes, she made her way to the communications room. Ava picked up the radio and broadcasted a call to all scientists, mathematicians, and thinkers across the globe who were passionate about solving mathematical conundrums.\n\n\"Attention, all inquisitive minds! I present to you an extraordinary problem\u2014one that belongs to the moon itself. Together, let us find M(r), the minimal risk of a journey from the North Pole station to the South Pole station on C(r). The answer lies within the recesses of this mathematical labyrinth. Will you join me on this quest to unlock the moon's secrets?\"\n\nAs Ava uttered her challenge, she couldn't help but wonder: Who would rise to the occasion? And how far would humanity go in pursuit of knowledge?\n\nWith that question lingering in the air, the story of the lunar mathematician began\u2014a tale that would unite curiosity, courage, and intellect in a quest to solve the mathematical problem of M(r)."}, {"id": 360, "euler_id": 360, "title": "Scary Sphere", "problem": "\nGiven two points (x1,y1,z1) and (x2,y2,z2) in three dimensional space, the Manhattan distance  between those points is defined as  |x1-x2|+|y1-y2|+|z1-z2|.\n\n\nLet C(r) be a sphere with radius r and center in the origin O(0,0,0).\nLet I(r) be the set of all points with integer coordinates on the surface of C(r).\nLet S(r) be the sum of the Manhattan distances of all elements of I(r) to the origin O.\n\n\nE.g. S(45)=34518.\n\n\nFind S(1010).\n", "solution": "878825614395267072", "difficulty": 50, "story": "Once upon a time, in a quaint little town nestled in the valley, there lived a young girl named Lily. Lily was a curious and adventurous soul, always seeking new discoveries and challenges. One day, as she was wandering through the enchanted forest that bordered her town, she stumbled upon a mysterious-looking stone in the shape of a cube. Intrigued by its unusual appearance, she picked it up and noticed some peculiar symbols etched into its surface.\n\nUnable to resist the urge to investigate further, Lily embarked on a quest to uncover the true meaning behind the symbols. She consulted every book and ancient scroll she could find, but none of them revealed the cube's secrets. Determined to solve the puzzle, she sought out the wise old wizard who resided deep within the heart of the enchanted forest.\n\nThe wizard, with his long flowing beard and twinkling eyes, greeted Lily warmly and listened intently as she recounted her discovery. After a moment of contemplation, the old wizard smiled and said, \"Ah, my dear child, what you have found is not just any ordinary cube. It is a key to unlock the secrets of the mystical realm of mathematics.\"\n\nIntrigued, Lily leaned forward, her eyes filled with wonder. The wizard continued, \"You see, embedded within those symbols is a mathematical problem that only the bravest and cleverest of souls can solve.\"\n\nEager to prove her worth, Lily listened intently as the wizard explained the problem. He spoke of the Manhattan distance between two points in three-dimensional space, of spheres and sets, and of the sum of distances of all points on the surface of a sphere with integer coordinates to its center. The wizard set her a challenge: to find the sum of distances for a sphere with a radius of 1010.\n\nLily stared at the wizard, her mind spinning with the complexity of the problem. It seemed unfathomable, but she was not one to shy away from a challenge. Determined to unlock the secrets of the cube, she delved deep into her studies. She studied geometry, algebra, and trigonometry, immersing herself in the world of numbers and formulas.\n\nDays turned into weeks, and weeks into months, but Lily persisted. She began to see patterns and connections, unraveling the intricate web of formulas and calculations. She worked tirelessly, scribbling equations and diagrams onto parchment until her fingers ached.\n\nAs Lily's journey continued, the enchantment of the cube seeped into every aspect of her life. She found herself spotting its mathematical patterns in nature, in the kaleidoscope of colors that painted the sky at sunset and in the rhythmic beat of raindrops on a windowpane. The cube had become a part of her very being.\n\nOne day, as Lily sat under a majestic oak tree, her mind raced with thoughts, calculations, and ideas. She knew she was on the brink of a breakthrough. With renewed determination, she worked tirelessly through the night, contemplating the intricate symphony of numbers and distances.\n\nAnd then, finally, it happened. Lily's eyes widened as the solution unfolded before her. A radiant smile spread across her face as she realized the true essence of the problem. She had deciphered the code, unlocked the cube's secrets, and arrived at the sum of distances for the sphere with a radius of 1010.\n\nBut this story does not end here, dear reader. For now, it is your turn to embark on this journey of discovery. Can you solve the mathematical problem? Can you calculate the enigmatic sum of distances for the sphere with a radius of 1010? The answer, my friend, lies within the web of numbers and their infinite possibilities. Will you take up the challenge and seek the truth?"}, {"id": 364, "euler_id": 364, "title": "Comfortable distance", "problem": "\nThere are N seats in a row. N people come after each other to fill the seats according to the following rules:\nIf there is any seat whose adjacent seat(s) are not occupied take such a seat.\nIf there is no such seat and there is any seat for which only one adjacent seat is occupied take such a seat.\nOtherwise take one of the remaining available seats. \n\nLet T(N) be the number of possibilities that N seats are occupied by N people with the given rules. The following figure shows T(4)=8.\n\n\n\n\nWe can verify that T(10) = 61632 and T(1 000) mod 100 000 007 = 47255094.\nFind T(1 000 000) mod 100 000 007.", "solution": "44855254", "difficulty": 50, "story": "Once upon a time in the distant kingdom of Numeria, there was a grand theater known as the Royal Playhouse. This theater was famous throughout the land for its exceptional performances, and people from far and wide came to witness the magic that unfolded on its stage. The Royal Playhouse had a peculiar seating arrangement that made every performance a unique experience.\n\nInside the theater, there were rows upon rows of seats, each meticulously crafted from rich oak. It was said that these seats held a certain power, capable of transforming a mere attendee into a loyal spectator. However, it wasn't just the craftsmanship that made them special; it was the rules of seating they adhered to.\n\nThe King of Numeria, a lover of both mathematics and the arts, devised a mathematical problem that determined how the seats were to be occupied. As each performance began, N people would enter the theater and take their seats, following these rules:\n\nRule 1: If there was any seat whose adjacent seat(s) were unoccupied, they would take such a seat.\n\nRule 2: If there was no seat meeting Rule 1, and there was a seat with only one adjacent seat occupied, they would take such a seat.\n\nRule 3: If neither Rule 1 nor Rule 2 could be followed, they would occupy any remaining available seat.\n\nThe King called this problem T(N). The more people watched a performance, the more possibilities there were for T(N). It fascinated him to see how different seating arrangements could influence the audience's experience, and he wanted to explore it further.\n\nOne sunny morning, the Royal Playhouse unveiled a grand production titled \"The Symphony of Numbers,\" a musical tale that delved into the magical world of mathematics. The citizens of Numeria eagerly awaited the performance, as it promised to be one unlike any other.\n\nAs the day arrived, the esteemed guests began to pour into the theater, and the ushers diligently guided them to their designated seats. Each attendee found their place, unknowingly becoming a part of the King's grand experiment.\n\nAmong the spectators was a young girl named Elena, an inquisitive mind with a deep love for numbers and puzzles. As she settled into her seat, she couldn't help but notice the intricate pattern of occupied and unoccupied chairs around her. It was as if the seating arrangement itself told a story.\n\nShe studied the seats, spotting the ones that followed Rule 1. People preferred those, she thought to herself, as they provided ample personal space. Then her eyes observed the chairs where Rule 2 came into play, where individuals could be closer to someone. Lastly, there were those seats that followed Rule 3, haphazardly dotted throughout the theater, where attendees had limited options.\n\nIn the midst of pondering this mathematical problem, Elena watched as the curtains were drawn, triggering a collective hush throughout the theater. The symphony of music and dance began to unfold, captivating the hearts of everyone present.\n\nAs the performance reached its peak, Elena's mind raced with excitement, not only as an audience member but also as someone eager to unlock the secrets of T(N). She could see how different seating arrangements influenced the way people perceived the show, and she realized the power the King had bestowed upon them.\n\nWhen the final note resonated through the theater, and the applause echoed in the grand hall, Elena found herself yearning to understand more. She longed to know the number of possibilities that N seats could be occupied by N people, as defined by the King\u2019s rules.\n\nAs the theater emptied, Elena's mind whirled with possibilities. She knew that answering the King's mathematical problem would bring a deeper understanding of the complex tapestry that numbers wove around them all. She looked back at the stage, the rows of seats stretching out before her, and she couldn't help but wonder:\n\nWhat would T(1,000,000) mod 100,000,007 be? \n\nAnd so, the question lingered in her mind, inviting her to dive deeper into the realm of T(N). As the theater doors closed behind her, Elena embarked on a journey, eager to solve the mathematical riddle that had taken hold of her heart.\n\nWould she uncover the answer? Would the Kingdom of Numeria ever comprehend the magnitude of T(1,000,000) mod 100,000,007?\n\nOnly time and the flickering flames of curiosity would reveal the truth."}, {"id": 383, "euler_id": 383, "title": "Divisibility comparison between factorials", "problem": "\nLet f5(n) be the largest integer x for which 5x divides n.\nFor example, f5(625000) = 7.\n\n\nLet T5(n) be the number of integers i which satisfy f5((2\u00b7i-1)!) < 2\u00b7f5(i!) and 1 \u2264 i \u2264 n.\nIt can be verified that T5(103) = 68 and T5(109) = 2408210.\n\n\nFind T5(1018).\n", "solution": "22173624649806", "difficulty": 50, "story": "Once upon a time, in the enchanting kingdom of Mathematica, there lived a young sorcerer named Elias. Born with an innate talent for magic, Elias had a special affinity for numbers and equations. He spent most of his days poring over old scrolls, uncovering hidden formulas, and exploring the depths of mathematical mysteries.\n\nOne sunny morning, as Elias eagerly flipped through a dusty tome at the Magical Library, a peculiar problem caught his attention. It was a mathematical puzzle that centered around the function f5 and its sibling T5. Intrigued, Elias started to dive into the problem, determined to understand its intricacies.\n\nAs days turned into weeks and weeks into months, Elias's obsession with the problem grew. He scribbled countless equations, tested various hypotheses, and sought advice from fellow sorcerers. But no matter how hard he tried, Elias couldn't quite crack the code.\n\nOne gloomy evening, as the rain poured down outside Elias's cozy cottage, his best friend, a wise old owl named Ophelia, fluttered through the window. Recognizing the frustration and exhaustion in Elias's eyes, Ophelia perched herself on a stack of books and inquired about his predicament.\n\nElias explained the enigma of f5 and T5, and how many lives it had consumed. Ophelia listened intently, her wise eyes gleaming with curiosity. She pondered for a moment before offering her insight.\n\n\"My dear Elias,\" Ophelia hooted softly, \"Perhaps the solution lies not only in the numbers but in the world around us. Math is but one reflection of nature's dance, after all. Seek inspiration beyond the pages of your books, and you might just find the answer you seek.\"\n\nFueled by Ophelia's words, Elias embarked on a journey throughout the kingdom. He observed the patterns within the petals of blooming flowers, counted the symmetry of a butterfly's wings, and marveled at the harmonious rhythms of the ocean's tides.\n\nDays turned into weeks once again, and Elias's understanding of the world around him deepened. He began to perceive mathematical patterns in nature, the ebb and flow of numbers resonating with the harmony of existence.\n\nFinally, after years of tireless exploration, Elias returned to his cottage, weary but determined. Sitting at his cluttered desk, he glanced at the old problem he had wrestled with for so long. With newfound clarity, he formulated a theory that connected the function f5((2\u00b7i-1)!) with 2\u00b7f5(i!).\n\nAn electrifying burst of excitement coursed through Elias. Every fiber of his being told him he was on the right track. But just as he was about to solve the problem and uncover the secrets of T5(1018), a nagging thought stopped him in his tracks.\n\n\"Do I really want to discover the answer on my own?\" Elias wondered aloud. \"Or shall I extend an invitation to other curious minds, challenging them to unravel this enchanting mystery alongside me?\"\n\nWith that, Elias sat back, closed his eyes, and wrote the final sentence of his short story. It was a question that would echo through the ages, beckoning mathematicians far and wide.\n\n\"And so, dear reader, I pose this wondrous challenge to you: Can you find T5(1018)?\"\n\nAnd with that question, Elias sent his story out into the world, hoping that someone would accept his invitation, explore the realms of f5 and T5, and together, unlock the final piece of the magical puzzle.\n\nNow, dear reader, the story is in your hands. Can you solve this enchanting mathematical problem and complete the journey that Elias started?"}, {"id": 393, "euler_id": 393, "title": "Migrating ants", "problem": "\nAn  n\u00d7n grid of squares contains  n2 ants, one ant per square.\nAll ants decide to move simultaneously to an adjacent square (usually 4 possibilities, except for ants on the edge of the grid or at the corners).\nWe define f(n) to be the number of ways this can happen without any ants ending on the same square and without any two ants crossing the same edge between two squares.\n\n\nYou are given that f(4) = 88.\nFind  f(10).\n", "solution": "112398351350823112", "difficulty": 50, "story": "Once upon a time, in the bustling city of Mathlandia, there was a mischievous mathematician named Max. Max was known for his unparalleled love for numbers and his knack for solving complex mathematical problems. Living alone in a modest house on the outskirts of town, he spent his days engrossed in mathematical puzzles and conundrums.\n\nOne sunny morning, when Max woke up with an unusual sense of excitement, he quickly scurried to his study. As he sat at his desk, surrounded by stacks of papers and books, he stumbled upon a peculiar problem that caught his attention. The problem involved ants on an n\u00d7n grid, which instantly intrigued Max.\n\nAn n\u00d7n grid of squares contained n\u00b2 ants, each occupying a separate square. The curious ants, in unison, decided to move to an adjacent square. Normally, there were four possible directions to move, but the ants at the edge or corners had fewer possibilities. What fascinated Max the most was the idea of finding the number of ways the ants could move without any ants ending up on the same square or crossing the same edge between two squares. This was represented by the function f(n).\n\nUnable to resist the allure of this mathematical challenge, Max delved into the problem. He meticulously calculated and explored various possibilities, determined to find the solution. After hours of mental exertion, he triumphantly discovered that f(4) equaled 88, cracking one piece of the puzzle.\n\nOverjoyed by his success, Max couldn't help but wonder about the grander scope of the problem. If f(4) resulted in 88, he pondered what f(10) might be. This question sparked a fire within Max, and he felt a newfound purpose to unveil the mysterious answer.\n\nHowever, this mathematical revelation was not just limited to Max's personal curiosity. Filled with excitement, he realized that this problem had the potential to transform the world of mathematics and its practical applications. The possibilities were endless. If he could figure out the value of f(10), it could lead to breakthroughs in computer algorithms, network optimization, and even robotics.\n\nMax understood that this challenge required more than just calculations. He needed to unleash his creativity and mathematical ingenuity to tackle f(10), to push the boundaries of his intellect. He eagerly grabbed a fresh sheet of paper, preparing to embark on a journey of discovery.\n\nAs Max lost himself in a world of numbers, he couldn't help but wonder what f(10) could mean for the future. What insights would it reveal? How would it impact the lives of people? And so, dear reader, the question lies before you: Can you solve f(10)? Can you unravel the mathematical magic behind the ants and their intricate moves on the grid?\n\nThat, my friend, is a tale yet to be told."}, {"id": 406, "euler_id": 406, "title": "Guessing Game", "problem": "We are trying to find a hidden number selected from the set of integers {1, 2, ..., n} by asking questions. \nEach number (question) we ask, we get one of three possible answers: \"Your guess is lower than the hidden number\" (and you incur a cost of a), or\n \"Your guess is higher than the hidden number\" (and you incur a cost of b), or\n \"Yes, that's it!\" (and the game ends).\nGiven the value of n, a, and b, an optimal strategy minimizes the total cost for the worst possible case.\nFor example, if n = 5, a = 2, and b = 3, then we may begin by asking \"2\" as our first question.\nIf we are told that 2 is higher than the hidden number (for a cost of b=3), then we are sure that \"1\" is the hidden number (for a total cost of 3).\nIf we are told that 2 is lower than the hidden number (for a cost of a=2), then our next question will be \"4\".\nIf we are told that 4 is higher than the hidden number (for a cost of b=3), then we are sure that \"3\" is the hidden number (for a total cost of 2+3=5).\nIf we are told that 4 is lower than the hidden number (for a cost of a=2), then we are sure that \"5\" is the hidden number (for a total cost of 2+2=4).\nThus, the worst-case cost achieved by this strategy is 5. It can also be shown that this is the lowest worst-case cost that can be achieved. \nSo, in fact, we have just described an optimal strategy for the given values of n, a, and b.\nLet C(n,a,b) be the worst-case cost achieved by an optimal strategy for the given values of n, a and b.\nHere are a few examples:\nC(5,2,3)=5\nC(500,2,3)=13.22073197\u2026\nC(20000,5,7)=82\nC(2000000,5,7)=49.63755955\u2026\nLet Fk be the Fibonacci numbers: Fk=Fk\u22121+Fk\u22122 with base cases F1=F2=1.Find \u2211k=130C(1012,k,Fk), and give your answer rounded to 8 decimal places behind the decimal point.", "solution": "36813.12757207", "difficulty": 50, "story": "Once upon a time in the village of Mathemaria, there lived a young and curious mathematician named Sophie. Sophie was known far and wide for her ingenious mind and her insatiable appetite for solving complex problems. One day, news arrived in Mathemaria about the legendary Hidden Number Game, a game that challenged even the most skilled mathematicians.\n\nIn the Hidden Number Game, players had to find a hidden number from a set of integers by asking questions. The villagers were fascinated by this game, and soon the entire village was buzzing with anticipation. The game was said to be a test of both mathematical prowess and strategic thinking.\n\nAs Sophie walked through the village square, she couldn't help but be drawn to the crowd gathered around the bulletin board. There, she saw the announcement of the ultimate challenge - a Hidden Number Game with the largest set of integers ever played before. The set would contain a staggering 1012 numbers, and the costs for incorrect guesses were given as a = 130 and b = F130, the 130th Fibonacci number.\n\nSophie's heart skipped a beat. She knew that the challenge required her to use her knowledge of the Fibonacci sequence to devise the most optimal strategy. She had always admired the elegance and beauty of Fibonacci numbers, and now they held the key to her success in this grand game.\n\nDetermined to triumph, Sophie locked herself in her study, immersing herself in the world of Fibonacci numbers. Her walls were adorned with various illustrations, formulas, and patterns of the sequence. She spent hours examining the recurrence relation, Fk=Fk\u22121+Fk\u22122, and exploring the properties of these extraordinary numbers.\n\nAs she delved deeper into her studies, Sophie began to see a pattern emerging. The Fibonacci numbers seemed to follow a rhythm, a sequence of peaks and valleys. With each new number, the game's cost fluctuated. But Sophie couldn't shake the feeling that there was a hidden secret, something overlooked by all the mathematicians who had come before her.\n\nDays turned into weeks, and weeks turned into months. Sophie tirelessly worked on her strategy, refining and optimizing her plan. Finally, the moment of truth arrived. She emerged from her study, equipped with her newfound knowledge and unshakable determination.\n\nThe villagers watched in awe as Sophie approached the Hidden Number Game arena, a place where champions were made and legends were born. She stood before the massive board displaying the set of 1012 integers, her eyes sparkling with anticipation. The crowd held its breath, waiting to witness her brilliance.\n\nSophie knew that to achieve the lowest worst-case cost, she needed to make her guesses strategically. She took a deep breath and began her attack. One by one, she methodically selected the Fibonacci numbers as her guesses, using their relationship to minimize her costs. With each correct guess, the crowd erupted in applause, marveling at her genius.\n\nAs the game progressed, Sophie's confidence grew. She had uncovered the secret hidden within the Fibonacci sequence, unlocking the power to control her costs with precision. The number of hidden integers dwindled, and Sophie's guesses became more calculated and accurate.\n\nFinally, after a grueling competition that pushed her mind to its limits, Sophie stood triumphant. She had solved the Hidden Number Game for the largest set of integers ever played, achieving the lowest worst-case cost. The village of Mathemaria erupted in cheers and applause, celebrating her remarkable achievement.\n\nBut Sophie's journey was not complete. As the dust settled and the celebration subsided, she found herself pondering the true nature of the Hidden Number Game. A question burned in her mind, urging her to explore further. Sophie wondered about the seemingly infinite possibilities and complexities of the game, and the role the Fibonacci sequence played in solving it. How could she truly understand the depths of this mathematical challenge?\n\nAnd so, dear reader, the question remains. Can you find \u2211k=130C(1012,k,Fk), and give your answer rounded to 8 decimal places behind the decimal point?"}, {"id": 408, "euler_id": 408, "title": "Admissible paths through a grid", "problem": "Let's call a lattice point (x, y) inadmissible if x, y and x\u00a0+\u00a0y are all positive perfect squares.\nFor example, (9, 16) is inadmissible, while (0, 4), (3, 1) and (9, 4) are not.\nConsider a path from point (x1, y1) to point (x2, y2) using only unit steps north or east.\nLet's call such a path admissible if none of its intermediate points are inadmissible.\nLet P(n) be the number of admissible paths from (0, 0) to (n, n).\nIt can be verified that P(5) = 252, P(16) = 596994440 and P(1000) mod 1\u00a0000\u00a0000\u00a0007 = 341920854.\nFind P(10\u00a0000\u00a0000) mod 1\u00a0000\u00a0000\u00a0007.", "solution": "299742733", "difficulty": 50, "story": "Once upon a time, in a small kingdom nestled in the heart of the countryside, there lived a young prince named Xavier. Like any prince, Xavier was expected to one day become a wise and just ruler. However, he had a secret passion that set him apart from his fellow royals \u2013 a deep love for mathematics.\n\nXavier spent hours each day wandering the castle's vast library, his mind consumed by equations and problems. The kingdom's advisors and scholars were astounded by his remarkable talent, often seeking his advice when faced with complex numerical conundrums. But as much as Xavier enjoyed solving problems, he yearned for a challenge that transcended mere calculation. \n\nOne day, Xavier stumbled upon an ancient scroll deep within the library's vaults. The scroll recounted a tale of lost knowledge, containing an enigma that spoke directly to his mathematical sensibilities. The scroll described a mystical path, and the number of ways one could reach a destination while obeying certain rules. The problem fascinated him, and he realized that the answer to this riddle held the key to unleashing the hidden power of the ancient magic described in the scroll.\n\nDetermined to solve this mathematical puzzle, Xavier delved deep into the problem's intricacies. And so, he discovered a peculiar set of points on a grid that he termed inadmissible. These inadmissible points defied traditional mathematical logic - all of them were positive perfect squares. It seemed as though some unknown force in the universe had marked them as forbidden ground.\n\nBut Xavier's mind was tireless and innovative. He pondered over the conundrum, and soon his brilliant mind discovered a crucial attribute of these inadmissible points. It turned out that on the path between any two points, there shouldn't be a single inadmissible point. This revelation thrilled Xavier immensely as he realized that he could use this knowledge to build admissible paths- paths that circumvented these forbidden grounds.\n\nThe more he examined the problem, the clearer his understanding became. He realized that every admissible path had a common starting point, point (0,0), and a distinct destination, (n,n). Furthermore, each admissible path only allowed unit steps north or east.\n\nIntrigued by the power of this discovery, Xavier sought to calculate the number of admissible paths to a given destination. He formulated a function, P(n), which counted the number of admissible paths from (0,0) to (n,n). He marveled at the sheer beauty of this mathematical expression, knowing that P(5) equaled 252, P(16) equaled 596994440, and P(1000) mod 1,000,000,007 equaled 341920854.\n\nNow, Xavier's greatest challenge lay ahead - finding the value of P(10,000,000) mod 1,000,000,007. The answer held immeasurable significance, for the ancient scroll hinted that the one who could solve this problem would gain access to a tremendous power that could reshape the world.\n\nWith this task at hand, both the future of the kingdom and Xavier's ambitions hinged on the resolution of this mathematical enigma. Thus, the young prince sought the aid of fellow mathematicians, scholars, and even enchanters to help him unlock the secret hidden within the numbers.\n\nAs the quest to solve this riddle began, Xavier's mind overflowed with excitement and anticipation. He knew that the solution to this mathematical problem was not mere numbers, but a profound journey that could unveil greater truths and fulfill his deepest dreams.\n\nAnd now, dear reader, I leave you with a question: Can you find the value of P(10,000,000) mod 1,000,000,007? Can you unravel the secrets of the admissible paths and help Xavier unlock the hidden magic of the ancient scroll?"}, {"id": 412, "euler_id": 412, "title": "Gnomon numbering", "problem": "For integers m, n (0\u00a0\u2264\u00a0n\u00a0<\u00a0m), let L(m,\u00a0n) be an m\u00d7m grid with the top-right n\u00d7n grid removed.\nFor example, L(5, 3) looks like this:\n\nWe want to number each cell of L(m,\u00a0n) with consecutive integers 1, 2, 3, ... such that the number in every cell is smaller than the number below it and to the left of it.\nFor example, here are two valid numberings of L(5,\u00a03):\n\nLet LC(m, n) be the number of valid numberings of L(m, n).\nIt can be verified that LC(3,\u00a00) = 42, LC(5,\u00a03) = 250250, LC(6,\u00a03) = 406029023400 and LC(10,\u00a05) mod 76543217 = 61251715.\nFind LC(10000,\u00a05000) mod 76543217.", "solution": "38788800", "difficulty": 50, "story": "Once upon a time in a small village named Numeria, lived a passionate and curious mathematician named Marcus. Marcus had always been fascinated by the beauty of numbers and the puzzles they presented. He spent most of his days in his study, surrounded by piles of books and scrolls, delving deep into the mysteries of mathematics.\n\nOne sunny morning, as Marcus sipped his tea and flipped through the pages of an ancient manuscript, he stumbled upon a peculiar problem. It spoke of a grid, with cells waiting to be numbered. As his eyes scanned the problem, a spark of excitement ignited within him. This was no ordinary problem. It had the elegance of a mathematical enigma, the kind that could captivate the minds of both scholars and dreamers.\n\nHis gaze shifted to the window, and Marcus's eyes danced with determination. He had to solve it, not just for the joy it brought him, but to uncover the hidden secrets within these mystical grids. He sprung from his chair, setting his cup down with a clang, and journeyed to the neighboring town. There, in a dusty library, he tirelessly studied, attempting various strategies and formulas, desperately searching for the key to crack the problem's enigmatic shell.\n\nDays passed, and yet Marcus couldn't find the solution. His excitement began to mingle with frustration, and doubts started to cloud his mind. Was he on a wild-goose chase? Or worse, were these grids merely figments of some mathematical imagination, with no grounding in reality?\n\nJust as Marcus was about to give up, he stumbled upon a hidden corner of the library, where a solitary book sat untouched for years. As he carefully turned its ancient pages, he discovered a cryptic poem. The words spoke of the grandeur of numbers and their hidden patterns, urging him to gaze beyond the obvious.\n\nInspired, Marcus returned to his study, an inferno of determination burning within him. He dissected the problem from every angle, realizing that the grids were not just arbitrary puzzles. They were intrinsically linked to the laws of mathematics, with each cell tightly bound to its neighbors, harmonizing together in a dance of numbers.\n\nDays turned into weeks, and weeks into months. Day and night blurred together as Marcus lost all track of time. Finally, like a beacon of hope illuminating his weary soul, he discovered a breakthrough. Through a combination of clever techniques and ingenious reasoning, he unlocked the secret to numbering the cells of the grid according to the rules.\n\nExcitement coursed through his veins as he envisioned the possibilities that lay within the grid's confines. What patterns would emerge? What new insights would be revealed to him? The mere thought of it sent shivers down his spine.\n\nWith trembling hands and unparalleled focus, Marcus embarked on the monumental task of applying his newfound knowledge to real-life examples. He carefully selected a grid of 10000 by 10000 cells, and with each passing day, his determination grew stronger, forgoing sleep and sustenance in his relentless quest.\n\nIn the final stage of his journey, he encountered the most challenging grid yet, with dimensions of 10000 by 5000. A twisted smile adorned his face as he realized the implications of this particular grid. It was not just a mathematical problem anymore; it had become his life's purpose, a reflection of his unwavering dedication.\n\nAs the days turned into weeks once again, Marcus tirelessly calculated, scribbled, and recalculated. He pushed himself to the limits of his mind, the exhaustion and desperation fighting against the flickering light of hope that still burned within him. He longed for the moment when all his efforts would align, and the grid would finally submit to his mastery.\n\nAnd so, dear reader, as Marcus's tale weaves its way towards its climax, I pose a question to you. After witnessing his passion and unwavering commitment to finding the solution, can you crack the code to LC(10000, 5000) mod 76543217? Can you see beyond the numbers and delve into the depths of this mathematical mystery?\n\nThe answer awaits, patiently hidden within the realms of Numeria's grids. Will you be the one to unveil it?"}, {"id": 419, "euler_id": 419, "title": "Look and say sequence", "problem": "\nThe look and say sequence goes 1, 11, 21, 1211, 111221, 312211, 13112221, 1113213211, ...\nThe sequence starts with 1 and all other members are obtained by describing the previous member in terms of consecutive digits.\nIt helps to do this out loud:\n1 is 'one one' \u2192 11\n11 is 'two ones' \u2192 21\n21 is 'one two and one one' \u2192 1211 \n1211 is 'one one, one two and two ones' \u2192 111221\n111221 is 'three ones, two twos and one one' \u2192 312211\n...\n\n\nDefine A(n), B(n) and C(n) as the number of ones, twos and threes in the n'th element of the sequence respectively.\nOne can verify that A(40) = 31254, B(40) = 20259 and C(40) = 11625.\n\n\nFind A(n), B(n) and C(n) for n = 1012. \nGive your answer modulo 230 and separate your values for A, B and C by a comma. \nE.g. for n = 40 the answer would be 31254,20259,11625\n", "solution": "998567458,1046245404,43363922", "difficulty": 50, "story": "Once upon a time, in a small village nestled in the rolling hills, lived a young boy named Oliver. Oliver was a curious and imaginative child, known for his love of numbers and patterns. Every day, he would spend hours exploring the secrets of the universe through the lens of mathematics.\n\nOne sunny morning, as Oliver sat under the shade of his favorite apple tree, he pondered over a fascinating sequence he had recently come across - the look and say sequence. This sequence fascinated him with its simplicity and yet intricate nature. He could not help but wonder about its deeper patterns and connections to the world around him.\n\nAs he sat there, lost in thought, a gentle breeze rustled the leaves of the apple tree, and an idea sprouted in his mind. The look and say sequence was a window into the universe, a key to unlocking hidden mysteries. Inspired by this newfound purpose, Oliver set off on a quest to understand the sequence like no one else had before.\n\nDays turned into weeks, and weeks turned into months as Oliver tirelessly studied the look and say sequence. He diligently wrote down every element, carefully analyzing the patterns that emerged with each iteration. Through countless nights of deep contemplation, the young boy realized that each number in the sequence could be described in terms of consecutive digits.\n\nArmed with this knowledge, Oliver began to see connections between the look and say sequence and the world around him. He observed that the numbers in the sequence had a unique way of expressing themselves, much like the people in his village. Just as the sequence described the previous number in terms of consecutive digits, people had their own unique stories to tell, shaped by their experiences.\n\nOliver's fascination grew stronger with each passing day, and he couldn't help but wonder how the look and say sequence could be used to understand his village and the people who lived there. He decided to conduct a study, carefully observing and documenting the lives of his fellow villagers.\n\nAs Oliver delved deeper into his research, he noticed a remarkable parallel between the sequence and the characteristics of the villagers. The number of ones in each element represented the abundance of kindness and compassion, while the number of twos reflected the harmony and balance within the community. Similarly, the number of threes denoted the resilience and unity that held the village together.\n\nExcitement grew within Oliver's heart as he made these connections. He realized that by understanding the look and say sequence, he could gain insights into the very essence of his village. But he knew his quest was not yet complete. A formidable challenge awaited him - determining the values of A(n), B(n), and C(n) for n = 1012, and unlocking the full potential of this mysterious sequence.\n\nAnd so, as daylight faded and stars began to twinkle in the night sky, Oliver posed a question to himself, one that would guide him on his mathematical journey:\n\nHow can I find A(1012), B(1012), and C(1012) for the look and say sequence, and what secrets of the universe will be revealed by their discovery?\n\nCuriosity burning within him, Oliver sought the answer. And now, dear reader, it is up to you to follow in his footsteps and solve this mathematical puzzle. Can you uncover the hidden treasures concealed within the look and say sequence?"}, {"id": 421, "euler_id": 421, "title": "Prime factors of n15+1", "problem": "\nNumbers of the form n15+1 are composite for every integer n > 1.\nFor positive integers n and m let s(n,m) be defined as the sum of the distinct prime factors of n15+1 not exceeding m.\n\nE.g. 215+1 = 3\u00d73\u00d711\u00d7331.\nSo s(2,10) = 3 and s(2,1000) = 3+11+331 = 345.\n\nAlso 1015+1 = 7\u00d711\u00d713\u00d7211\u00d7241\u00d72161\u00d79091.\nSo s(10,100) = 31 and s(10,1000) = 483.\nFind \u2211\u2009s(n,108) for 1 \u2264 n \u2264 1011.\n", "solution": "2304215802083466198", "difficulty": 50, "story": "It was a warm summer afternoon as Alice sat in her favorite bookstore, engrossed in a book about ancient civilizations. As she turned the page, she couldn't help but notice a peculiar piece of paper stuffed between the pages. Curiosity piqued, she eagerly unfolded it, and her eyes widened as she read the intricate equations and mathematical problem scrawled across the surface.\n\nNumbers of the form n15+1 are composite for every integer n > 1.\nFor positive integers n and m let s(n,m) be defined as the sum of the distinct prime factors of n15+1 not exceeding m.\n\nIntrigued by the challenge presented before her, Alice decided to investigate further. Little did she know that this problem would soon take her on a marvelous journey.\n\nLater that evening, Alice found herself sitting in a cozy caf\u00e9, surrounded by books and theories written by brilliant mathematicians. With a steaming cup of tea in hand, she delved into the depths of the problem. As she slowly unraveled its complexity, her excitement grew.\n\nDays turned into weeks as Alice's obsession with the problem consumed her every waking moment. She was determined to find the solution and uncover the hidden secrets it held. Hours upon hours were spent poring over ancient texts, scribbling equations, and testing theories.\n\nOne fateful evening, as Alice was perusing a dusty old tome, she stumbled upon a passage that seemed to contain a clue. It spoke of a mystical device, known as the Mathemagical Compass, legendary for its ability to unlock the secrets of prime numbers and their patterns. Hope ignited within Alice's heart.\n\nFuelled by her newfound purpose, Alice embarked on a quest to find the Mathemagical Compass. Her journey took her through treacherous mountains and enchanted forests, where mythical creatures lurked in the shadows. But Alice was not deterred. The thought of solving the mathematical problem and uncovering the truth compelled her forward.\n\nFinally, after countless trials and near-impossible challenges, Alice reached the ancient temple where the Mathemagical Compass was rumored to be housed. She stood before an intricately carved door, adorned with symbols that seemed to dance in the moonlight. With trembling hands, Alice pressed her palm against the door, and it yielded, granting her entry.\n\nInside, the temple held legendary artifacts and ancient texts, but all Alice could focus on was the Mathemagical Compass. As she approached it, a surge of energy enveloped her. The compass hummed and glowed with an ethereal light. Alice could feel the answers she had sought for so long coursing through her veins.\n\nWith the Mathemagical Compass in her grasp, Alice returned to her cozy study. She carefully adjusted the compass, its orbs aligning with celestial bodies. As she breathed life into the ancient device, it sprang to life, projecting a mesmerizing display of numbers and symbols onto the walls.\n\nAlice's heart raced as she input the necessary parameters into the compass, invoking its power to solve the mathematical problem that had consumed her for months. But as the room filled with dancing numbers and illuminated equations, a new question formed in Alice's mind.\n\nShe had the answer in her hands, the solution to the mathematical problem that had driven her on this remarkable adventure. Yet, as she studied the Latin inscription on the wall, her eyes wide with wonder, a smile tugged at her lips. She realized that this mathematical problem was far more than just numbers and equations. It was a gateway to a vast realm of knowledge and discovery.\n\nAnd so, dear reader, I leave you with a question. Can you solve the mathematical problem that Alice journeyed so far to uncover? Take a leap into the unknown, a path that may lead you to unravel the secrets held within the universe of numbers. Will you follow in Alice's footsteps and seek the answer, or will you let the enigma slip through your fingers like sand? The choice is yours to make."}, {"id": 445, "euler_id": 445, "title": "Retractions A", "problem": "\nFor every integer n>1, the family of functions fn,a,b is defined \nby  \nfn,a,b(x)\u2261ax+bmodn for a,b,x integer and  0<a<n,0\u2264b<n,0\u2264x<n. \n\nWe will call fn,a,b a retraction if fn,a,b(fn,a,b(x))\u2261fn,a,b(x)modn for every 0\u2264x<n.\nLet R(n) be the number of retractions for n.\n\n\nYou are given that\n\u2211k=199999R((100000k))\u2261628701600mod1000000007.\n \nFind \u2211k=19999999R((10000000k)).\nGive your answer modulo 1000000007.\n", "solution": "659104042", "difficulty": 50, "story": "Once upon a time in a quaint village, there lived a young mathematician named Alice. With her unruly brown hair and spectacles perched on her nose, Alice was renowned for her love of numbers and solving complex mathematical problems. She spent her days immersed in formulas and calculations, constantly trying to decipher the secrets of the universe.\n\nOne sunny morning, as Alice sat by the riverbank scribbling equations in her notebook, a sudden gust of wind swept one of her loose papers into the air. Frantically, she chased after it until she reached a small meadow, where the paper gently came to rest.\n\nCuriosity piqued, Alice picked up the paper and examined its contents. To her astonishment, she discovered a perplexing mathematical problem. The problem was as follows:\n\n\"For every integer n>1, the family of functions fn,a,b is defined by fn,a,b(x)\u2261ax+bmodn for a,b,x integer and 0<a<n,0\u2264b<n,0\u2264x<n. \n\nWe will call fn,a,b a retraction if fn,a,b(fn,a,b(x))\u2261fn,a,b(x)modn for every 0\u2264x<n. Let R(n) be the number of retractions for n.\n\nYou are given that\n\u2211k=199999R((100000k))\u2261628701600mod1000000007.\n\nFind \u2211k=19999999R((10000000k)).\nGive your answer modulo 1000000007.\"\n\nIntrigued by the problem, Alice's mind began to race. She knew that solving this mathematical quandary held the key to a deeper understanding of the fn,a,b functions. Vowing to delve into its intricacies, Alice spent days and nights pondering, eagerly trying to decipher the patterns hidden within.\n\nAs the seasons changed and the village transformed from lush green to winter's icy grip, Alice finally had a breakthrough. She discovered a crucial connection between the number of retractions and the function parameters, a, b, and n. Every integer increment in n opened up new avenues of exploration, revealing profound revelations about the relationship between the functions.\n\nWith each revelation, Alice's excitement grew. She realized that the fn,a,b functions had far-reaching implications, not only in the realm of mathematics but in countless other fields. This newfound knowledge could revolutionize scientific discoveries and change the way people perceived the world.\n\nJust as Alice prepared to share her findings with the world, another gust of wind whisked away her precious notes, leaving her with only fragments of her work. Desperate to recompose her discoveries, she scoured the village for clues, but all seemed lost.\n\nFeeling dejected, Alice sat by the river once more, her reflection mirroring her disappointment. Suddenly, her gaze fell upon her notebook, still open to the mathematical problem that had sent her on this incredible journey. Its intricate details, the intricacies of the fn,a,b functions, and their connection to retractions were etched into her memory.\n\nIn that moment, Alice knew she had something special, despite losing her notes. Armed with the unshakeable confidence in her abilities, she pushed forward, determined to share her insights despite the odds stacked against her.\n\nNow, dear reader, it's up to you. Can you solve the final part of the mathematical problem? Can you find \u2211k=19999999R((10000000k))? The fate of Alice's discoveries rests in your hands."}, {"id": 454, "euler_id": 454, "title": "Diophantine reciprocals III", "problem": "In the following equation x, y, and n are positive integers.\n1x+1y=1n\nFor a limit L we define F(L) as the number of solutions which satisfy x < y \u2264 L.\nWe can verify that F(15) = 4 and F(1000) = 1069.\nFind F(1012).", "solution": "5435004633092", "difficulty": 50, "story": "Once upon a time, in a small village by the sea, lived a young boy named Noah. Noah was known for his inquisitive nature and passion for puzzles, often spending his days lost in thought, contemplating the mysteries of the world. One sunny morning, as he walked along the shore, he stumbled upon a peculiar old book, half-buried in the sand.\n\nIntrigued by its weathered pages and faded ink, Noah dusted off the book and cradled it in his hands. The title read \"The Enigma of Equations,\" and it seemed to emanate an aura of mystique. Curiosity ignited, he decided to delve into its secrets.\n\nAs he leafed through the pages, his eyes caught sight of an equation prominently displayed:\n\n1x + 1y = 1n\n\nThe numbers beckoned Noah, whispering a stimulating challenge. He pondered the equation, trying to decipher its hidden meaning. The book then revealed a fascinating concept \u2014 a limitless framework called F(L), which counted the number of solutions that satisfactorily fit the equation's conditions: x < y \u2264 L.\n\nNoah's imagination ignited like a spark, and he embarked on an adventure to unravel the enigmatic world of F(L). With pencil and paper in hand, he began to solve equations, counting the solutions as they unfolded. Time seemed to slip away as he became engrossed in the sheer delight of exploration.\n\nDays turned into weeks, and weeks transformed into months, yet Noah never wavered in his pursuit. He wrote down the answers meticulously, teasing out patterns and observing the limits of L. His scribbles covered the walls of his room, symbolizing his tireless quest for knowledge.\n\nFinally, he reached the zenith of his endeavor. Amid his sea of calculations, Noah made a remarkable discovery: F(15) equaled 4, and F(1000) amounted to an astonishing 1069. The sheer magnitude of these numbers astonished him and added fuel to his fervor for mathematical exploration.\n\nBut as his gaze transcended his room, Noah realized there was one final task that lay unresolved\u2014 a challenge that beckoned him to venture further. An unanswered question lingered in the air: What about F(1012)?\n\nNoah's mind raced with countless possibilities, envisioning the countless solutions that awaited his discovery. He pondered the very essence of F(L), searching for hints in the world around him. He embarked on a journey through the village, seeking wisdom from scholars, artisans, and even fortune tellers, hoping to uncover clues that would unlock the hidden treasures of F(1012).\n\nAnd now, dear reader, as you dive deep into Noah's journey, I implore you to undertake this quest alongside him. Can you find the elusive value of F(1012)? Can you discover the hidden intricacies of the equation that captivated Noah's every waking thought?\n\nMay the numbers guide and inspire you as you embark on your own mathematical odyssey. Now, it is your turn to solve the enigma. F(1012) awaits your insight and imagination.\n\nWill you answer the call?"}, {"id": 467, "euler_id": 467, "title": "Superinteger", "problem": "An integer s is called a superinteger of another integer n if the digits of n form a subsequence of the digits of s.\nFor example, 2718281828 is a superinteger of 18828, while 314159 is not a superinteger of 151.\n\nLet p(n) be the nth prime number, and let c(n) be the nth composite number. For example, p(1) = 2, p(10) = 29, c(1) = 4 and c(10) = 18.\n{p(i) : i \u2265 1} = {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, ...}\n{c(i) : i \u2265 1} = {4, 6, 8, 9, 10, 12, 14, 15, 16, 18, ...}\nLet PD the sequence of the digital roots of {p(i)} (CD is defined similarly for {c(i)}):\nPD = {2, 3, 5, 7, 2, 4, 8, 1, 5, 2, ...}\nCD = {4, 6, 8, 9, 1, 3, 5, 6, 7, 9, ...}\nLet Pn be the integer formed by concatenating the first n elements of PD (Cn is defined similarly for CD).\nP10 = 2357248152\nC10 = 4689135679\nLet f(n) be the smallest positive integer that is a common superinteger of Pn and Cn. For example, f(10) = 2357246891352679, and f(100) mod 1\u00a0000\u00a0000\u00a0007 = 771661825.\nFind f(10\u00a0000) mod 1\u00a0000\u00a0000\u00a0007.", "solution": "775181359", "difficulty": 50, "story": "Once upon a time in the bustling city of Mathville, there lived a brilliant mathematician named Professor Archimedes. Professor Archimedes had devoted his life to the pursuit of solving complex mathematical problems. His curious mind was always seeking out new challenges and intriguing puzzles.\n\nOne sunny morning, as Professor Archimedes was sipping his tea and reflecting on the mysteries of numbers, he stumbled upon a remarkable mathematical problem. The problem involved something called a superinteger, which fascinated him greatly.\n\nAn integer, he learned, is called a superinteger of another integer if its digits form a subsequence of the digits of the latter. To illustrate this, he thought about the numbers 2718281828 and 18828. The former was a superinteger of the latter, while a number like 314159 was not a superinteger of 151.\n\nIntrigued, Professor Archimedes delved deeper into the problem. He discovered a sequence of numbers that fascinated him even more \u2013 the sequence of prime numbers (p) and the sequence of composite numbers (c). The digital roots of these sequences, which he represented as PD and CD respectively, excited him greatly.\n\nPD = {2, 3, 5, 7, 2, 4, 8, 1, 5, 2, ...}\nCD = {4, 6, 8, 9, 1, 3, 5, 6, 7, 9, ...}\n\nHe then formed another sequence, Pn, by concatenating the first n elements of PD (Cn was defined similarly for CD). For example, P10 was obtained by combining the first 10 elements of PD, resulting in the number 2357248152. Similarly, C10 was formed by combining the first 10 elements of CD, giving us 4689135679.\n\nProfessor Archimedes pondered over the problem for days, trying to devise a method to determine the smallest positive integer that was a common superinteger of Pn and Cn. He called this mysterious integer \"f\".\n\nAs Professor Archimedes delved deeper into the problem, he realized that this concept of common superintegers had far-reaching implications. It could potentially unlock a hidden code, a pattern that had been hiding in plain sight.\n\nCaught up in the excitement of his discovery, Professor Archimedes found himself at a crossroads. Solving this problem could change everything. The world of mathematics would shift its course, revealing secrets that had been hidden for centuries. The allure of this mathematical enigma was simply too enticing for him to resist.\n\nWith a determined gleam in his eyes, Professor Archimedes set off on a journey of exploration and enlightenment. He traveled far and wide, seeking out fellow mathematicians, consulting ancient manuscripts, and diving deep into the depths of numerical mysteries.\n\nAs he ventured through deserts and mountains, forests and cities, Professor Archimedes scribbled equations and theories in his trusted notebook. He immersed himself in the world of numbers, hoping to unravel the secrets of the common superintegers.\n\nAnd so, dear reader, I ask you this: Can you solve the mathematical problem that consumed Professor Archimedes? Can you find the smallest positive integer that is a common superinteger of Pn and Cn?\n\nThe fate of mathematics awaits your answer."}, {"id": 474, "euler_id": 474, "title": "Last digits of divisors", "problem": "\nFor a positive integer n and digits d, we define F(n, d) as the number of the divisors of n whose last digits equal d.\nFor example, F(84, 4) = 3. Among the divisors of 84 (1, 2, 3, 4, 6, 7, 12, 14, 21, 28, 42, 84), three of them (4, 14, 84) have the last digit 4.\n\n\nWe can also verify that F(12!, 12) = 11 and F(50!, 123) = 17888.\n\n\nFind F(106!, 65432) modulo (1016 + 61).\n", "solution": "9690646731515010", "difficulty": 50, "story": "Once upon a time in the mystical kingdom of Arithma, there lived a young and curious mathematician named Amelia. Amelia had always been fascinated by the intricate patterns and hidden mysteries of numbers. She spent her days under the shade of an ancient oak tree, engrossed in her calculations and pondering the secrets that the world of mathematics held.\n\nOne sunny day, as Amelia was deep in thought, a messenger arrived from the kingdom's castle, bearing an urgent message. It was from the wise and enigmatic King Algebrus, who sought her expertise in solving a mathematical problem that could potentially change the fate of the kingdom.\n\nThe problem was as follows: for any positive integer n and a given digit d, F(n, d) should be calculated. This function counted the number of divisors of n whose last digits equaled d. Intrigued by the challenge, Amelia's heart raced with excitement.\n\nWithout hesitation, Amelia grabbed her quill and parchment and began her investigation. She started with a simple example: F(84, 4). Amelia meticulously listed all the divisors of 84, which were 1, 2, 3, 4, 6, 7, 12, 14, 21, 28, 42, and 84. To her delight, she found that three divisors, namely 4, 14, and 84, ended with the digit 4, confirming that F(84, 4) returned the number 3.\n\nAmelia's excitement grew as she delved deeper into the problem. She discovered that F(12!, 12) was equal to 11, and F(50!, 123) astonishingly equaled a colossal number, 17888. The calculations and patterns fascinated her, as if they were whispers from the gods of numbers themselves. But now, there was a much more complex and urgent matter at hand: finding F(106!, 65432) modulo (1016 + 61).\n\nThe fate of the kingdom hung in the balance. As Amelia pondered the daunting task, she realized that the solution to this problem might hold the key to unlocking the powers of an ancient artifact hidden within the castle's walls. This precious artifact was said to possess vast knowledge that could revolutionize the world of mathematics and send ripples throughout the entire kingdom.\n\nFilled with determination, Amelia set out on a quest. Her journey took her through a cryptic labyrinth, where every step revealed new clues and challenges that tested her skills and intellect. She battled abstract puzzles and equations, and as she overcame each hurdle, her confidence grew.\n\nDays turned into weeks, and weeks into months, until Amelia reached the final chamber, guarded by a fearsome dragon. With her knowledge and skills as her only weapons, she courageously faced the monstrous creature. She chanted ancient mathematical incantations, woven seamlessly into formulas and equations. The dragon's fiery breath could not defeat her unwavering focus.\n\nFinally, the dragon succumbed to the enchanting power of mathematics. As Amelia stood victorious, she reached for the hidden artifact. The moment her fingers brushed its surface, she felt a surge of energy, as if the artifact recognized her as the chosen one.\n\nAs she gazed at the artifact, Amelia couldn't help but wonder: What was the value of F(106!, 65432) modulo (1016 + 61)? The answer to this mathematical problem would not only reveal the secrets of the artifact but also shape the destiny of the entire kingdom.\n\nWith this question lingering in her mind, Amelia returned to the kingdom, her heart filled with hope. The once-curious mathematician had now become the savior of Arithma, armed with the knowledge to unlock the mysterious powers contained within the artifact.\n\nHowever, dear reader, the fate of the kingdom still hangs in the balance. Will you be the one to solve the mathematical problem? Will you uncover the secrets of F(106!, 65432) modulo (1016 + 61)? Only then will the future of Arithma be decided."}, {"id": 475, "euler_id": 475, "title": "Music festival", "problem": "12n musicians participate at a music festival. On the first day, they form 3n quartets and practice all day.\nIt is a disaster. At the end of the day, all musicians decide they will never again agree to play with any member of their quartet.\nOn the second day, they form 4n trios, with every musician avoiding any previous quartet partners.\nLet f(12n) be the number of ways to organize the trios amongst the 12n musicians.\nYou are given f(12) = 576 and f(24) mod 1 000 000 007 = 509089824.\nFind f(600) mod 1 000 000 007.", "solution": "75780067", "difficulty": 50, "story": "Once upon a time in the bustling town of Melodyville, there was an annual music festival that brought together the most talented musicians from far and wide. This year, the festival was graced by the presence of 12n musicians who had come to showcase their incredible abilities.\n\nOn the first day of the festival, the organizers decided to form 3n quartets with the hope that the musicians would create beautiful harmonies and mesmerize the audience. However, fate had a different plan in mind. The day turned out to be a complete disaster as the musicians, unfortunately, couldn't synchronize their melodies. Discordant notes echoed through the festival grounds, leaving the audience disappointed.\n\nDisheartened, the musicians huddled together at the end of the day, frustrated with their lackluster performance. They agreed unanimously that they would never again agree to play with any member of their previous quartet. This decision stemmed from their desire to ensure a more harmonious experience for themselves and the audience.\n\nThe next day arrived, and with it came renewed energy and determination. The musicians regrouped, eager to prove themselves capable of creating enchanting melodies. This time, they decided to form 4n trios, carefully avoiding any previous quartet partners. Each musician hoped that by reshuffling the groups, they could find their perfect harmony.\n\nAs the day unfolded, beautiful music filled the air. The melodies were now flawless, each trio complementing one another's notes perfectly. The audience was captivated, their disappointment from the previous day a distant memory.\n\nUnbeknownst to the musicians, their decision to form trios instead of quartets held a fascinating mathematical problem. They had unknowingly become part of a puzzle that had fascinated mathematicians for ages. The number of ways to organize trios amongst the 12n musicians was represented by f(12n).\n\nThe organizers of the festival wanted to unravel this mystery and reached out to mathematicians from all over the world. They discovered that f(12) was 576, providing a valuable clue to solving the puzzle. Additionally, they stumbled upon a breakthrough - f(24) mod 1 000 000 007 equaled 509089824. This only fueled their determination to solve the enigma.\n\nAs the festival drew to a close, the musicians prepared for their final performance. The thrill of playing together harmoniously was unparalleled, and they couldn't help but wonder about the elusive answer to f(600) mod 1 000 000 007. What would this number be? And how could they calculate it?\n\nWith these questions lingering in the air, the story of Melodyville's music festival, the musicians, and the unsolved mystery of f(600) mod 1 000 000 007 will forever be etched in the minds of those who attended. Can you solve the mathematical problem at the heart of this tale and uncover the answer to f(600) mod 1 000 000 007?"}, {"id": 496, "euler_id": 496, "title": "Incenter and circumcenter of triangle", "problem": "Given an integer sided triangle ABC:\nLet I be the incenter of ABC.\nLet D be the intersection between the line AI and the circumcircle of ABC (A \u2260 D).\nWe define F(L) as the sum of BC for the triangles ABC that satisfy AC = DI and BC \u2264 L.\nFor example, F(15) = 45 because the triangles ABC with (BC,AC,AB) = (6,4,5), (12,8,10), (12,9,7), (15,9,16) satisfy the conditions.\nFind F(109).", "solution": "2042473533769142717", "difficulty": 50, "story": "Once upon a time, in the whimsical kingdom of Mathlandia, there lived a young prince named Arthur. Prince Arthur was known far and wide for his inquisitive mind and his fondness for solving puzzles. He spent his days exploring the nooks and crannies of the kingdom, searching for challenging problems to solve.\n\nOne sunny afternoon, as Prince Arthur was strolling through the royal gardens, he stumbled upon a old and dusty book hidden beneath a rose bush. Intrigued, he picked it up and gently blew off the dust. To his delight, the book contained a collection of the most marvelous mathematical problems, each one more perplexing than the last.\n\nAs he leafed through the pages, one particular problem caught his eye. The problem involved triangles and numbers - two subjects that Prince Arthur loved dearly. With enthusiasm sparkling in his eyes, he read the problem aloud:\n\n\"Given an integer-sided triangle ABC: Let I be the incenter of ABC. Let D be the intersection between the line AI and the circumcircle of ABC (A \u2260 D). We define F(L) as the sum of BC for the triangles ABC that satisfy AC = DI and BC \u2264 L. For example, F(15) = 45 because the triangles ABC with (BC,AC,AB) = (6,4,5), (12,8,10), (12,9,7), (15,9,16) satisfy the conditions. Find F(109).\"\n\nPrince Arthur's mind whirred with excitement. He knew right then and there that he had stumbled upon a truly extraordinary problem. Determined to crack the code, he pondered the problem as he continued to explore the gardens.\n\nDays turned into weeks, and weeks into months, but still, Prince Arthur couldn't crack the elusive solution to the problem. He sought help from the kingdom's wisest scholars, but even they were stumped. Frustration mingled with determination, as Prince Arthur refused to give up.\n\nNight after night, Prince Arthur poured over the pages, his candle casting a soft glow on the numbers and symbols. He sketched countless triangles on parchment, attempting to find patterns and connections. Patiently, he conducted experiments and meticulously recorded his findings. The solution seemed to elude him, hiding behind intricate lines and angles.\n\nBut Prince Arthur was no ordinary prince. He possessed a relentless curiosity and a never-ending pursuit of knowledge. With each failure, he grew more determined, refusing to let this riddle defeat him.\n\nAs the nights grew longer and colder, the young prince's tireless efforts finally bore fruit. Little by little, he began to unravel the secrets hidden within the problem. Solutions started to reveal themselves, appearing like shining stars in the dark canvas of his mind.\n\nWith every new breakthrough, Prince Arthur's heart raced with anticipation. His excitement grew with each successful trial, confirming the validity of his findings. The pieces of the puzzle were falling into place, creating an intricate tapestry that tied together angles, sides, and numbers.\n\nYet, as Prince Arthur reached the final pages of the book, he found himself at a crossroads. With his vast knowledge, he had managed to uncover the solution to every single problem except one \u2013 the one he had first stumbled upon in the royal gardens. The problem that had started it all.\n\nWith a mixture of anticipation and apprehension, Prince Arthur penned the final question that would end his remarkable journey: \"Find F(109).\"\n\nNow, dear reader, it is your turn to embark on an adventure of your own. Will you let the allure of numbers and triangles captivate your mind? Will you solve the mystery that has stumped scholars and challenged the brightest minds in Mathlandia?\n\nAs you ponder the question Prince Arthur left behind, remember that sometimes, the journey itself is as valuable as the destination. Are you ready to step into the footsteps of our young, determined prince, and unravel the secrets that lie within F(109)?"}, {"id": 519, "euler_id": 519, "title": "Tricoloured Coin Fountains", "problem": "An arrangement of coins in one or more rows with the bottom row being a block without gaps and every coin in a higher row touching exactly two coins in the row below is called a fountain of coins. Let f(n) be the number of possible fountains with n coins. For 4 coins there are three possible arrangements:\n\nTherefore f(4)\u00a0=\u00a03 while f(10)\u00a0=\u00a078.\nLet T(n) be the number of all possible colourings with three colours for all f(n) different fountains with n coins, given the condition that no two touching coins have the same colour. Below you see the possible colourings for one of the three valid fountains for 4 coins:\n\nYou are given that T(4)\u00a0=\u00a048 and T(10)\u00a0=\u00a017760.\nFind the last 9 digits of T(20000).", "solution": "804739330", "difficulty": 50, "story": "Once upon a time, in the mystical kingdom of Numeria, there lived a young princess named Ariadne. Unlike her noble peers who indulged in royal banquets and lavish parties, Ariadne's true passion resided in the realm of mathematics. She would spend her days poring over ancient scrolls and quizzing the kingdom's scholars on perplexing problems.\n\nOne day, as Ariadne ventured deep into the kingdom's enchanted forest, she stumbled upon an old, forgotten fountain. The fountain was not like any she had seen before, for it was adorned with shimmering coins of all shapes and sizes. Intrigued, the princess knelt beside it, tracing her fingers along the intricate engravings.\n\nAs she examined the arrangement of coins, an age-old mathematical problem whispered to Ariadne's inquisitive mind. The coins were arranged in such a way that each coin touched exactly two coins in the row below, forming what mathematicians called a fountain of coins. The concept fascinated her, and she yearned to unravel its secrets.\n\nAriadne's thoughts drifted to a function called f(n), which represented the number of possible fountains with a given number of coins, n. Her scholarly efforts had revealed the values of f(4) - which was 3 - and f(10) - which was 78. But there was more to this problem than met the eye. Another function, T(n), represented the number of colorings for each arrangement. The catch was that no two touching coins could have the same color.\n\nAs Ariadne pondered the mystical properties of the fountain, she understood that understanding T(n) wasn't merely about embracing the beauty of color but also about comprehending the underlying harmony and order of the coins.\n\nIn her quest for knowledge, Ariadne delved into the magical arts, seeking inspiration from Numeria's ancient wizards. With each colorful experiment, the true magnitude of T(n) revealed itself. She discovered that T(4) was equal to 48, and T(10) expanded to the astonishing number of 17760.\n\nDays turned into weeks, and then into months, as Ariadne dedicated herself entirely to the study of fountains and their enchanting colorings. She scoured libraries and sought wisdom from the kingdom's brightest minds, all in search of the elusive answer to T(20000).\n\nThe princess tried to formulate a pattern, a rule, anything that would unlock the secret of T(20000). She tested countless theories and scribbled endless diagrams in her royal chamber. But like a puzzle with missing pieces, the solution remained elusive.\n\nAs the kingdom prepared for the grandest festival of the year, Ariadne's spirit refused to be discouraged. Surrounded by the reverberating sounds of jubilation, she gazed upon the twinkling lights and wondered if the answer to her mathematical conundrum was hidden within the joyous spectacle.\n\nAnd so, dear reader, as we bid farewell to the young princess, her quest continues. The question lingers in the air like a magical riddle waiting to be solved: What are the last nine digits of T(20000)?"}, {"id": 521, "euler_id": 521, "title": "Smallest prime factor", "problem": "\nLet smpf(n) be the smallest prime factor of n.\nsmpf(91)=7 because 91=7\u00d713 and smpf(45)=3 because 45=3\u00d73\u00d75.\nLet S(n) be the sum of smpf(i) for 2 \u2264 i \u2264 n.\nE.g. S(100)=1257.\n\n\nFind S(1012) mod 109.\n", "solution": "44389811", "difficulty": 50, "story": "Once upon a time in the peaceful village of Arithmea, there lived a young girl named Amelia. Amelia was not like the other children in the village. While they enjoyed playing outside and adventuring, Amelia was fascinated by numbers and the mysteries they held. She could spend hours poring over equations and mathematical puzzles, finding solace in the logic they provided.\n\nAmelia had stumbled upon an intriguing mathematical problem that consumed her thoughts. It involved finding the sum of the smallest prime factors of various numbers, a concept she found both intriguing and immensely challenging. As she delved deeper into her studies, Amelia's curiosity led her to the solution of the problem for smaller values of n. But there was one particular question that kept her awake at night - what would be the sum of the smallest prime factors of 1012?\n\nDetermined to uncover the answer, Amelia set off on a journey to meet the renowned mathematician, Professor Henry, who resided in the Mathemagica Kingdom. The kingdom was known for its love of mathematics, and Professor Henry was its greatest exponent. With her mind buzzing with excitement, Amelia embarked on her adventure, leaving behind her quaint village and setting forth to find the answer.\n\nAs she arrived at Mathemagica Kingdom, Amelia was overwhelmed by the grandeur around her. People bustled through the streets, their conversations filled with mathematical riddles and solutions. The air was thick with the scent of curiosity, and at every turn, she encountered chalkboards filled with complex equations.\n\nWith diligence and determination, Amelia navigated through the vibrant streets until she reached Professor Henry's Tower of Numbers. The tower stood tall and majestic, a testament to the profound knowledge that resided within its walls. Taking a deep breath, Amelia climbed the stairs, growing more excited with each step.\n\nFinally, she arrived at the Professor's study, adorned with shelves overflowing with ancient mathematical manuscripts and tools. Professor Henry, a wise man with a white beard that reached his chest, greeted Amelia with a warm smile. He had heard of her exceptional talent and welcomed her eagerly.\n\n\"Ah, dear Amelia, what brings you to my humble abode?\" Professor Henry asked, studying her with curious eyes.\n\n\"Professor,\" Amelia replied, her voice brimming with anticipation, \"I seek your guidance on a mathematical problem that has captivated my mind. It involves finding the sum of the smallest prime factors of various numbers, and I have come to you seeking the solution for n equal to 1012.\"\n\nProfessor Henry stroked his beard, his eyes twinkling with delight. \"Ah, yes, S(n), the sum of smpf(i) for 2 \u2264 i \u2264 n. An intriguing problem indeed, my dear. Allow me to explain.\"\n\nAs Professor Henry began to unravel the mathematical intricacies, Amelia hung onto his every word. She absorbed his explanations, realizing the importance of prime factors in the realm of numbers. It was as if she had discovered the key to unlocking a vast universe of patterns and secrets.\n\nIn the midst of their discussion, Professor Henry presented Amelia with an extraordinary challenge. \"My dear Amelia, when you find the solution to S(1012), come back to me and tell me what you uncover. Solving this puzzle holds the power to reveal the depths of your mathematical prowess.\"\n\nAmelia nodded with determination, understanding the magnitude of the task at hand. Her journey had only just begun, and she knew she had to explore the realm of numbers more thoroughly in order to solve this intricate puzzle. Thus, she bid farewell to Professor Henry, leaving his tower with a newfound fire within her.\n\nAs Amelia returned to her village, she immersed herself in her studies. Days turned into weeks, and weeks turned into months. Armed with her newfound knowledge and a burning curiosity, she dove into the world of prime factors, analyzing their patterns and uncovering the intricate relationships they held.\n\nBut as the days turned into years, it became clear to Amelia that the solution to the problem for n equal to 1012 still eluded her grasp. She felt a mixture of frustration and determination, realizing that finding the sum of the smallest prime factors for such a vast number required more time and effort.\n\nAnd so, dear reader, the question remains - what is S(1012) mod 109? Can you uncover the solution that Amelia sought so desperately? Pick up the mantle where she left off and delve into the realm of numbers. The mathematical world awaits your discovery, and the solution to this captivating problem lies within your grasp."}, {"id": 533, "euler_id": 533, "title": "Minimum values of the Carmichael function", "problem": "The Carmichael function \u03bb(n) is defined as the smallest positive integer m such that am = 1 modulo n for all integers a coprime with n.\nFor example \u03bb(8) = 2 and \u03bb(240) = 4.\nDefine L(n) as the smallest positive integer m such that \u03bb(k)\u00a0\u2265\u00a0n for all k\u00a0\u2265\u00a0m.\nFor example, L(6)\u00a0=\u00a0241 and L(100)\u00a0=\u00a020\u00a0174\u00a0525\u00a0281.\nFind L(20\u00a0000\u00a0000). Give the last 9 digits of your answer.", "solution": "789453601", "difficulty": 50, "story": "Once upon a time in the small village of Oakbrook, nestled among rolling hills and glistening streams, there lived a curious and gifted young boy named Oliver. Oliver had always been fascinated by numbers, their patterns and secrets. While other children played in the meadows, Oliver spent his days immersed in mathematical puzzles and enigmas.\n\nOne sunny morning, as Oliver sat under an ancient oak tree, he stumbled upon an intriguing problem. It was a dilemma that had been puzzling mathematicians for centuries - the Carmichael function \u03bb(n) and its elusive counterpart, L(n). Oliver's eyes sparkled with excitement as he read about the smallest positive integers, m and k, and how they were entwined within the fabric of numbers.\n\nUnable to resist the allure of the challenge, Oliver decided to embark on a quest to comprehend the enigmatic Carmichael function and discover L(20,000,000). Little did he know that his journey would take him to extraordinary places and grant him extraordinary encounters.\n\nDetermined to solve the mathematical puzzle, Oliver set off, armed with his boundless curiosity and a worn-out map that had been passed down through generations. As he ventured deeper into the unknown, he stumbled upon a mystical gateway guarded by a wise old sage.\n\n\"Seeker of knowledge, approach,\" the sage beckoned, his voice resonating with ancient wisdom. \"If you desire to unravel the secrets of the Carmichael function, you must first pass this test.\"\n\nPerplexed, Oliver nodded, eager to prove his worth. The sage presented him with a dusty old scroll and said, \"Within this scroll, you will find a series of number sequences. Your task is to discover the pattern and deduce the next number.\"\n\nFor hours on end, Oliver pondered over the cryptic scrolls, immersing himself in the labyrinth of numbers and equations. The enigmatic patterns revealed themselves slowly, and with each revelation, Oliver's understanding deepened.\n\nDays turned into weeks, and weeks turned into months as Oliver toiled tirelessly to uncover the secret of L(20,000,000). Along his journey, he encountered other scholars and mathematicians, all equally captivated by the allure of numbers. They debated and collaborated, each contributing a piece of the puzzle, each unlocking a secret within the tangled web of mathematical truths.\n\nTogether, they delved into the hidden recesses of ancient libraries, studying forgotten texts and deciphering cryptic manuscripts. The equations danced before their eyes, breathing life into their discoveries. Oliver's passion grew into a blazing fire that illuminated even the darkest corners of the mathematical realm.\n\nOne fateful day, as the sun set over a verdant meadow, Oliver found himself at the edge of a shimmering lake. The brilliant hues of the sunset reflected in the water, mirroring the fire of his determination.\n\nWith unwavering focus, Oliver finally united all the fragments of his knowledge and unraveled the mystery of L(20,000,000). The answer slowly unraveled before his eyes, like a delicate tapestry being woven together. He marveled at the beauty and elegance of the numerical tapestry, realizing that this vast world of numbers held endless potential and infinite wonders.\n\nBut now, dear reader, it is your turn to continue Oliver's journey. The last nine digits of L(20,000,000) await your ingenious calculation. Can you decipher the enigmatic puzzle that Oliver resolved? Will you be the one to illuminate the world with your mathematical prowess?\n\nAs the stars twinkle above, the question lingers in the air, waiting for someone to unlock its hidden answer, waiting for someone to become the next harbinger of mathematical enlightenment.\n\nWhat are the last nine digits of L(20,000,000)? Can you solve this mathematical marvel?"}, {"id": 551, "euler_id": 551, "title": "Sum of digits sequence", "problem": "Let a0, a1, a2, ... be an integer sequence defined by:\na0 = 1;\nfor n \u2265 1, an is the sum of the digits of all preceding terms.\nThe sequence starts with 1, 1, 2, 4, 8, 16, 23, 28, 38, 49, ...\nYou are given a106\u00a0=\u00a031054319.\nFind a1015.", "solution": "73597483551591773", "difficulty": 50, "story": "Once upon a time in the quaint village of Numeria, there lived a young boy named Oliver. Oliver had always been fascinated with numbers. He loved the way they seemed to have a rhythm and pattern, each one telling its own unique story. His days were spent exploring the intricate world of mathematics, and his nights were filled with dreams of solving the most complex problems.\n\nOne sunny afternoon, while Oliver was practicing his multiplication tables under the shade of an old oak tree, a mysterious book fell from the sky and landed in his lap. As he opened it, he discovered that it was a magical tome filled with out-of-this-world calculations and perplexing problems.\n\nAmong the pages, a particular mathematical problem caught Oliver's eye. It spoke of a never-ending sequence, starting with 1, 1, 2, 4, 8, 16, 23, 28, 38, 49, and so on. The sequence fascinated Oliver, for it seemed to be governed by a mysterious rule.\n\nAccording to the problem, each new term was defined as the sum of the digits of all the preceding terms. Oliver was captivated by the pattern, the way the numbers increased and danced with each other. But there was one question that puzzled him the most. What was a1015?\n\nHis eyes widened with excitement, for he knew that solving this puzzle meant uncovering the secrets of this magical sequence. If he could crack this enigma, it would be a triumph that would satisfy his insatiable thirst for knowledge. The mathematical problem had now become the ultimate quest of his young life.\n\nWith renewed determination, Oliver embarked on a journey through the realms of mathematics. He studied day and night, pouring over countless textbooks, consulting with wise sages, and exploring forgotten libraries. He strived to understand the intricacies of the mathematical problem that now consumed his every waking thought.\n\nAs years turned into decades, Oliver's hair grew gray, but his enthusiasm never waned. He became a renowned mathematician, respected by scholars near and far. Yet, the puzzle of a1015 remained elusive, like a distant star twinkling in the night sky, just beyond his reach.\n\nDespite the countless accolades, Oliver felt a void in his heart. He had dedicated his entire life to the pursuit of knowledge, and yet this one unsolved problem gnawed at him. Was it even possible to solve it? Or was it a puzzle that would remain forever embedded in the realms of mystery?\n\nAs Oliver pondered this conundrum, he realized that the answer may not lie in the world of academia. Perhaps the key to unlocking a1015 was hidden within his own self. He closed his eyes and delved deep into his memories, searching for a clue to this enigmatic sequence.\n\nBut then he stopped.\n\nOliver wondered, what if the answer wasn't meant to be discovered by him alone? What if it was a challenge left for others to solve, to continue the legacy of curiosity and exploration? And so, with a newfound sense of purpose, he decided to share the mystery of a1015 with the world, in hopes that someone, someday, would solve this captivating puzzle.\n\nAnd now, dear reader, the fate of a1015 rests in your hands. Can you unveil the secrets of this mathematical problem that has puzzled even the most brilliant minds? Can you discover the elusive value of a1015?\n\nThe answer lies waiting to be unraveled, calling out to those who dare to venture into the fascinating world of numbers. Will you be the one to solve the riddle and bring an end to this age-old mystery?"}, {"id": 572, "euler_id": 572, "title": "Idempotent matrices", "problem": "\nA matrix M is called idempotent if M2=M.\nLet M be a three by three matrix : \nM=(abcdefghi).\nLet C(n) be the number of  idempotent three by three matrices M with integer elements such that\n\u2212n\u2264a,b,c,d,e,f,g,h,i\u2264n.\n\nC(1)=164 and C(2)=848.\n\n\nFind C(200).\n", "solution": "19737656", "difficulty": 50, "story": "Once upon a time in a small village nestled in the mountains, lived a young and curious girl named Lily. She had a mind that soared beyond the boundaries of her quiet surroundings, constantly seeking knowledge and adventure. Her favorite activity was to explore the village library, filled with countless dusty books and hidden secrets.\n\nOne fateful afternoon, as the sun shone through the library windows, casting vibrant rays of light on the old, musty shelves, Lily stumbled upon a peculiar book. Titled \"The Mysteries of Mathematics,\" it beckoned her with worn pages and an air of anticipation. Taking a seat at a nearby oak table, she began leafing through the yellowed pages.\n\nAs she delved deeper into the book, Lily discovered a mathematical problem that piqued her interest. It challenged her understanding of matrices and idempotency, enigmatic terms she had never encountered before. The problem appeared to be nothing short of magic\u2014a tantalizing invitation to unravel the mysteries of numbers and patterns.\n\nThe book explained that a matrix M is called idempotent if M\u00b2 equals M. In simpler terms, multiplying the matrix by itself once should yield the same result as multiplying it twice. The problem asked for the number of idempotent three by three matrices M with integer elements, and specifically, the case when \u2212n is less than or equal to each of the matrix's elements and n is less than or equal to n. The book provocatively provided the cases for C(1), which amounted to 164 idempotent matrices, and C(2), which yielded 848 matrices.\n\nLily's mind sparked with excitement as she envisioned an adventure that would take her into the heart of mathematics. She decided to embark on a quest to solve the mathematical riddle hidden within the book's pages. With pen and paper in hand, she contemplated over each element of the matrix, searching for patterns, and experimenting with different combinations.\n\nWeeks turned into months, and Lily became consumed by her pursuit. The charm of the village, the laughter of her friends, and even the beauty of nature, all took a back seat to the enigmatic world of matrices. She devoted every waking moment to solving the mathematical mystery that had bewitched her.\n\nFinally, one misty morning, as dawn draped the village in its ethereal embrace, Lily uncovered a revelation. She had discovered the key to solving the problem\u2014at least, she thought so. With trembling anticipation, she calculated the value of C(200) using her newfound understanding of idempotent matrices.\n\nBut as she reached the moment of truth, doubts cast their shadows upon her. The thrill of the journey seemed to fade, replaced by an unyielding question that lingered in Lily's heart. Was her solution correct? Had she truly unveiled the secret to unlocking C(200)?\n\nFaced with uncertainty, Lily closed her eyes and pondered the magnificent journey she had embarked upon. Would she ever find the validation she sought? Was there another path to the truth she had yet to explore? The story of Lily and her quest for the mathematical answer whispered through the halls of the library, eager to be told.\n\nAnd so, dear reader, the story is now in your hands. Will you be the one to decipher the mystery of C(200)? The mathematical problem awaits your resolution, its answer etched within the vast realm of numbers. Will you join Lily on this extraordinary journey and solve the enigma that lies within?"}, {"id": 574, "euler_id": 574, "title": "Verifying Primes", "problem": "Let q be a prime and A\u2265B>0 be two integers with the following properties:\n A and B have no prime factor in common, that is gcd(A,B)=1.\n The product AB is divisible by every prime less than q.\nIt can be shown that, given these conditions, any sum A+B<q2 and any difference 1<A\u2212B<q2 has to be a prime number. Thus you can verify that a number p is prime by showing that either p=A+B<q2 or p=A\u2212B<q2 for some A,B,q fulfilling the conditions listed above.\nLet V(p) be the smallest possible value of A in any sum p=A+B and any difference p=A\u2212B, that verifies p being prime. Examples:\nV(2)=1, since 2=1+1<22. \nV(37)=22, since 37=22+15=2\u22c511+3\u22c55<72 is the associated sum with the smallest possible A.\nV(151)=165 since 151=165\u221214=3\u22c55\u22c511\u22122\u22c57<132 is the associated difference with the smallest possible A. \n\nLet S(n) be the sum of V(p) for all primes p<n. For example, S(10)=10 and S(200)=7177.\n\nFind S(3800).\n", "solution": "5780447552057000454", "difficulty": 50, "story": "Once upon a time, in the peaceful town of Mathville, there lived a young mathematician named Alice. She was known throughout the kingdom for her exceptional talent in solving complex mathematical problems. People sought her out from far and wide, hoping she could crack the code to their most perplexing equations.\n\nOne sunny morning, as Alice sat beneath the towering oak tree in the town square, a group of villagers approached her with a troubled look on their faces. They explained that Mathville was under threat from an evil sorcerer who planned to unleash chaos by manipulating the power of numbers.\n\nTo save their town, Alice would need to discover a way to identify prime numbers quickly. The villagers explained a unique mathematical problem to her. They said, \"Alice, let q be a prime number, and A and B be two integers greater than zero. If the product of A and B is divisible by every prime number less than q, any sum A+B less than q squared, and any difference A-B greater than one and less than q squared, must be prime. We believe this could be the key to defeating the sorcerer. Please, Alice, will you help us?\"\n\nIntrigued by the challenge, Alice delved into the problem deeply. She realized that if she could solve this mathematical mystery, the townspeople would have a powerful weapon against the sorcerer's dastardly plans.\n\nDays turned into weeks, and weeks turned into months. Alice immersed herself in books, scrolls, and ancient manuscripts, following every lead that promised a solution. Sleepless nights spent poring over equations and endless cups of tea fueled her determination.\n\nOne autumn afternoon, as the golden leaves fluttered to the ground, Alice stumbled across a hidden chamber deep within the Royal Library. Inside, she discovered an ancient book adorned with faded symbols and cryptic numbers. The numbers seemed to align perfectly with the problem she had been working on for so long.\n\nExcitement coursed through her veins as she raced back to the town square to share her findings with the villagers. With each passing day, Alice's understanding of the problem grew, and the solution began to reveal itself.\n\nOne morning, as the first rays of sunlight peeked over the horizon, Alice stood before the townspeople and unveiled her findings. Explaining her solution, she said, \"By finding the smallest possible value, A, in both the sum and the difference of a prime number p, we can determine if p is prime. This will be our weapon against the sorcerer.\"\n\nThe people of Mathville erupted into applause and rejoiced at the newfound hope Alice had bestowed upon them. However, their celebration was short-lived, as the sorcerer, aware of their discovery, began launching relentless attacks on the town.\n\nRealizing that she needed more time to fine-tune her solution, Alice wondered if the ancient book held the answer. She pored over its pages once again and discovered a series of calculations that seemed to hint at the sum of V(p) for all primes p<n.\n\nFrantically, Alice deciphered the clues, her mind racing to make sense of the pattern before her. Finally, after hours of calculations, she arrived at a sum. S(n) equaled 7177 when n was 200, but what would the ultimate challenge be?\n\nNow, dear reader, I leave you with a question as Alice herself once pondered. Can you find the sum S(3800)? Within this seemingly insurmountable number lies the hope and fate of Mathville. May your mathematical prowess guide you to the solution and save our beloved town from the sorcerer's clutches."}, {"id": 582, "euler_id": 582, "title": "Nearly isosceles 120 degree triangles", "problem": "\nLet a, b and c be the sides of an integer sided triangle with one angle of 120 degrees, a\u2264b\u2264c and b-a\u2264100.\nLet T(n) be the number of such triangles with c\u2264n.\nT(1000)=235 and T(108)=1245.\nFind T(10100).\n", "solution": "19903", "difficulty": 50, "story": "Once upon a time in the magical land of Quadracor, there lived a young and ambitious mathematician named Lily. Lily possessed an insatiable curiosity for all things numerical and a passion for unraveling the secrets hidden within the enchanting world of mathematics.\n\nOne sunny morning, as Lily was strolling through a meadow dotted with vibrant flowers, a peculiar puzzle tumbled into her path. She picked it up, her eyes widening as she read the intricate problem engraved upon its surface.\n\n\"Let a, b, and c be the sides of an integer sided triangle with one angle of 120 degrees, a\u2264b\u2264c, and b-a\u2264100. Let T(n) be the number of such triangles with c\u2264n. T(1000)=235 and T(108)=1245. Find T(10100).\"\n\nLily's mind raced with excitement as she began pondering the problem. It was an unsolved mystery, waiting to be unraveled. Determined to find the answer, she ventured towards the ethereal library hidden deep within the forest.\n\nAs Lily entered the library, she was met by an eccentric librarian named Professor Merlin, renowned for his vast knowledge of numerical enigmas. Lily approached him, clutching the puzzle tightly in her hands.\n\n\"Professor Merlin, I have stumbled upon a mathematical conundrum,\" she said, her voice filled with anticipation. \"This problem tells a tale of a magical triangle. Its sides form a triangle with one angle of 120 degrees. The sides are integers, and the largest side should not exceed the specified limit, 'n.' However, I'm confounded by the task at hand. Could you enlighten me on how to find T(10100)?\"\n\nMerlin peered at the puzzle, his eyes twinkling with curiosity. \"Ah, young Lily, you have discovered a problem as old as time itself,\" he replied, his voice filled with wisdom. \"The elusive T(n) is a journey that requires careful calculations and a keen eye for patterns.\"\n\nTogether, Lily and Merlin delved into a world of triangles, angles, and mysterious equations. They explored countless possibilities, meticulously examining the constraints of the problem and overcoming various mathematical hurdles. Through sleepless nights spent huddled over ancient tomes and days consumed by endless calculations, they painstakingly determined the values of T(1000) and T(108).\n\nThe library grew silent as their search for the mystical T(10100) continued. Lily's mind brimmed with excitement as she imagined the tale this particular value would unveil. Would it be a hidden treasure, waiting to be revealed? Or perhaps an ancient secret guarded by the enigmatic triangle?\n\nWith each passing day, Lily and Merlin delved deeper, constructing formulas and forging connections. They discovered the beauty hidden within the language of numbers, and their quest became a dance of exhilarating exploration.\n\nFinally, after weeks of ardent investigation, they stood at the precipice of an answer. The elusive T(10100) was within their grasp. However, the magnitude of this discovery was far greater than they had ever imagined.\n\nAs the numbers aligned, the earth beneath them gently shook, and the walls of the library trembled. Lily and Merlin exchanged astonished glances, realizing that their pursuit of T(10100) had awakened a powerful force within Quadracor.\n\nThe ancient magic of the land surged through the library, surrounding the two mathematicians in a whirlwind of mystic energy. As the tempest subsided, they found themselves standing before an ethereal figure.\n\nIt was Lady Pythagoria, the guardian of the Mathematical Realm. Her voice resonated with the knowledge of ages as she addressed the astounded pair. \"You have sought the answer to T(10100), a question that delves into the very fabric of our existence. I shall grant you the final clue, but heed my warning: tread lightly, for the answer lies at the intersection of numbers and fate.\"\n\nWith that, Lady Pythagoria vanished, leaving Lily and Merlin to contemplate the hint she had bestowed upon them. Their quest had now reached its climax, and all they had left were bated breaths and innumerable questions. Could they finally solve the final equation and decipher the secret of T(10100)? Would it reveal the true nature of triangles and their mystical properties?\n\nDear reader, as you follow Lily and Merlin on their mathematical odyssey, let me pose the final question: What is T(10100)?"}, {"id": 583, "euler_id": 583, "title": "Heron Envelopes", "problem": "\nA standard envelope shape is a convex figure consisting of an isosceles triangle (the flap) placed on top of a rectangle.  An example of an envelope with integral sides is shown below.  Note that to form a sensible envelope, the perpendicular height of the flap (BCD) must be smaller than the height of the rectangle (ABDE).  \n\n\n\n\nIn the envelope illustrated, not only are all the sides integral, but also all the diagonals (AC, AD, BD, BE and CE) are integral too. Let us call an envelope with these properties a Heron envelope.\n\n\nLet S(p) be the sum of the perimeters of all the Heron envelopes with a perimeter less than or equal to p. \n\n\nYou are given that S(104) = 884680.  Find S(107).\n", "solution": "1174137929000", "difficulty": 50, "story": "Once upon a time in the small town of Numerica, there lived a brilliant mathematician named Professor Pythagoras. He had a mind as sharp as a compass and a passion for all things numerical. Professor Pythagoras spent his days studying the intricacies of mathematical problems, searching for patterns and solutions that could unlock the secrets of the universe.\n\nOne sunny morning, as Professor Pythagoras was walking through the bustling streets of Numerica, he stumbled upon an old bookstore. The shelves were dusty and filled with forgotten books, but one particular volume caught his eye. Its worn-out cover concealed the potential for a fascinating story.\n\nUnable to resist, Professor Pythagoras reached for the book and blew away the specks of dust, revealing the title: \"The Envelopes of Mystery.\" Intrigued, he opened it to find a tale that would challenge his mathematical prowess.\n\nThe story revolved around a kingdom where all the letters were carried by a special kind of envelope called \"Heron envelopes.\" These envelopes were unique\u2014they had integral sides and diagonals. The illustration showed a magnificent Heron envelope with a beaming flourish.\n\nThe mathematical problem came to life within the story. The noble king had tasked his people with determining the sum of the perimeters of all the Heron envelopes with a perimeter less than or equal to a given value, p. The readers were given an example of S(104) and were asked to find S(107).\n\nEnthralled by the story, Professor Pythagoras couldn't help but feel a stirring in his mathematical soul. He knew that he had to unravel the mystery of these Heron envelopes. With a determined gleam in his eye, he embarked on a quest to solve the problem and find S(107).\n\nDays turned into weeks, and weeks into months as Professor Pythagoras delved into the realm of triangles, rectangles, and the magic behind Heron envelopes. His mind danced with geometric figures and arithmetic sequences, all in search of the solution that would unlock the secrets long hidden within the pages of the story.\n\nNight after night, he scribbled equations onto chalkboards, trying to uncover the hidden patterns that lay within the problem. His mind whirred with calculations and possibilities, akin to a symphony of numbers. With each passing day, his excitement grew as he inched closer to the solution.\n\nFinally, after countless sleepless nights and endless contemplation, a spark of insight struck Professor Pythagoras. He jumped up from his desk and rushed to the nearest computer, typing away furiously to test his newfound theory.\n\nWith bated breath, Professor Pythagoras watched as the numbers on the screen rolled in front of his eyes. The result lay clear before him: S(107) was revealed, a triumph of mathematical discovery.\n\nJust as he was about to celebrate his success, a curious thought crossed his mind. Although he had found the answer, the mathematical problem still remained to be solved by those who would stumble upon the story.\n\nAnd so, with a smile on his face and an enigmatic twinkle in his eye, Professor Pythagoras pondered the question that would challenge the knowledge-hungry souls who followed in his footsteps.\n\n\"I have found S(107), but can you?\""}, {"id": 596, "euler_id": 596, "title": "Number of lattice points in a hyperball", "problem": "Let T(r) be the number of integer quadruplets x, y, z, t such that x2 + y2 + z2 + t2 \u2264 r2. In other words, T(r) is the number of lattice points in the four-dimensional hyperball of radius r.\nYou are given that T(2) = 89, T(5) = 3121, T(100) = 493490641 and T(104) = 49348022079085897.\nFind T(108) mod 1000000007.", "solution": "734582049", "difficulty": 50, "story": "Once upon a time, in the bustling city of Mathville, there was a young girl named Lily who had an insatiable curiosity for mathematics. She loved to explore the hidden connections that numbers held, and her friends often sought her out for help with their math homework.\n\nOne sunny afternoon, as Lily sat under a large oak tree in the center of town, her friend Max approached her with an intriguing problem. \"Lily, I have a puzzle for you,\" he said with a mischievous grin. \"Can you find the number of lattice points in a four-dimensional hyperball of radius r?\"\n\nLily's eyes sparkled with excitement. She had never explored the world beyond three dimensions before, and this problem was a gateway to a whole new mathematical realm. \"Of course, Max,\" she replied. \"I accept your challenge. Let's see what we can discover.\"\n\nOver the days that followed, Lily and Max dedicated themselves to unraveling the mystery of T(r), the number of lattice points. They spent hours drawing intricate diagrams and experimenting with various values of r. Their enthusiasm grew as they discovered fascinating patterns and relationships between the number of lattice points and the radius of the hyperball.\n\nAs they delved deeper into their research, Lily began to realize that T(r) had profound implications beyond just numbers. Their study of the lattice points allowed them to visualize the intricate fabric that connected different dimensions, as if they were peeking into the secrets of the universe itself.\n\nOne fateful evening, while sitting in the park, their findings led them to a stunning revelation. \"Max, listen,\" Lily exclaimed. \"T(2) is 89, T(5) is 3121, and T(100) is 493490641. But when we calculate T(104), we find a gargantuan number,\" she said, her voice filled with awe.\n\nMax nodded, his eyes wide with wonder. \"You're right, Lily. T(104) is 49348022079085897, an unfathomably large number. But the question that now arises is this: What will T(108) be?\"\n\nLily's mind raced with possibilities. She imagined the countless lattice points dancing through the fourth dimension, eagerly waiting to be counted. The mystery of T(108) consumed her thoughts, and she knew that finding its value would unlock a deeper understanding of space and dimensionality.\n\nAs the sky darkened and the stars began to twinkle, Lily looked up and uttered her question to the cosmos. \"What is T(108) mod 1000000007?\" she asked softly, her voice filled with determination.\n\nAnd so, dear reader, the answer to this question lies in the mathematical realm, waiting to be discovered. Will you join Lily on her quest to uncover the value of T(108) mod 1000000007?"}, {"id": 606, "euler_id": 606, "title": "Gozinta Chains II", "problem": "\nA gozinta chain for n is a sequence {1,a,b,...,n} where each element properly divides the next. \nFor example, there are eight distinct gozinta chains for 12: \n{1,12}, {1,2,12}, {1,2,4,12}, {1,2,6,12}, {1,3,12}, {1,3,6,12}, {1,4,12} and {1,6,12}.\n\n\nLet S(n) be the sum of all numbers, k, not exceeding n, which have 252 distinct gozinta chains. \nYou are given S(106)=8462952 and S(1012)=623291998881978.\n\n\nFind S(1036), giving the last nine digits of your answer.\n", "solution": "158452775", "difficulty": 50, "story": "Once upon a time, in the mystical land of Mathematica, there lived a young mathematician named Clio. Clio was known far and wide for her prowess in numbers and her insatiable curiosity for all things mathematical. She spent most of her days immersed in books, uncovering the hidden secrets and patterns that lay within.\n\nOne sunny morning, as she sat in her study, a large, dusty tome caught her attention. It was a forgotten book, hidden behind a stack of old manuscripts. Its pages were fragile, its ink fading, but the words within piqued Clio's curiosity.\n\nThe pages revealed a fascinating mathematical problem, one that involved a concept Clio had never encountered before. It spoke of a peculiar sequence called the \"gozinta chain.\" Intrigued, Clio delved deeper into the problem.\n\nA gozinta chain for any number n was a sequence that started with 1 and gradually built up to n, with each element properly dividing the next. The book provided an example with the number 12, listing eight distinct gozinta chains for it.\n\nClio's mind raced with possibilities. The gozinta chains seemed to be a beautiful puzzle waiting to be deciphered. She pondered their properties, their patterns, and how they interconnected. Little did she know that her exploration of the gozinta chains would lead her on an unexpected adventure.\n\nDays turned into weeks, and weeks turned into months. Clio tirelessly unraveled the secrets of the gozinta chains. She discovered that some numbers had fewer chains than others, while some had none at all. This revelation fascinated her, and she couldn't help but wonder why.\n\nThen, a breakthrough came when Clio stumbled upon a remarkable connection between the number of gozinta chains and a sum labeled S(n). S(n) represented the sum of all numbers not exceeding n that had exactly 252 distinct gozinta chains. The book revealed that S(106) equaled 8,462,952, and S(1012) amounted to 623,291,998,881,978.\n\nClio's excitement was tangible, and she marveled at the sheer magnitude of these sums. The book teased her further, inviting her to discover what S(1036) held, asking her to find the last nine digits of the answer. Her mind raced with possibilities. What could these numbers represent? What secrets lay hidden within?\n\nDetermined to plunge deeper into the mystery, Clio set forth on a quest. She embarked on a journey through the enchanting landscapes of Mathematica, encountering fantastical creatures and facing numerous challenges. Her quest was dedicated to unraveling the patterns of gozinta chains, understanding their intricacies, and ultimately solving the mystery behind S(1036).\n\nAs Clio's story unfolds, it hinges upon the very enigma of S(1036). How will she navigate the treacherous landscapes of Mathematica? What risks will she take in her pursuit of knowledge? Will she uncover the answer to S(1036) and the last nine digits that lay hidden within? And most importantly, what crucial role will the gozinta chains play in her adventures?\n\nBut now, dear reader, it is your turn. Can you solve the tantalizing mathematical problem and find the value of S(1036)? The mystic land of Mathematica awaits your answer."}, {"id": 633, "euler_id": 633, "title": "Square prime factors II", "problem": "For an integer n, we define the square prime factors of n to be the primes whose square divides n. For example, the square prime factors of 1500=22\u00d73\u00d753 are 2 and 5.\nLet Ck(N) be the number of integers between 1 and N inclusive with exactly k square prime factors. It can be shown that with growing N the ratio Ck(N)N gets arbitrarily close to a constant ck\u221e, as suggested by the table below.\nk=0k=1k=2k=3k=4Ck(10)73000Ck(102)6136300Ck(103)6083434810Ck(104)60833363533210Ck(105)607943356253452972Ck(106)60792633543853358321860Ck(107)6079291335395653314032777834Ck(108)607926943353919653297473290289257Ck(109)60792712433538970653294365329179195821ck\u221e6\u03c023.3539\u00d710\u221215.3293\u00d710\u221223.2921\u00d710\u221239.7046\u00d710\u22125\nFind c7\u221e. Give the result in scientific notation rounded to 5 significant digits, using a e to separate mantissa and exponent. E.g. if the answer were 0.000123456789, then the answer format would be 1.2346e-4.\n", "solution": "1.0012e-10", "difficulty": 50, "story": "Once upon a time in the peaceful kingdom of Arithville, there lived a young prince named Oliver. Oliver was intelligent and loved to explore the mysteries of mathematics. His favorite pastime was to solve complicated problems and unravel the secrets hidden in numbers.\n\nOne sunny day, as Oliver strolled through the royal gardens, he stumbled upon an ancient book hidden among the foliage. The book was old and worn, with pages yellowed by time. Intrigued, Oliver picked it up and blew away the dust that coated its cover. As he opened it, he discovered a page filled with intriguing puzzles, formulas, and calculations.\n\nCuriosity piqued, Oliver's eyes landed on a particular problem that sparked his interest. It spoke of a function called Ck(N), which calculated the number of integers between 1 and N with exactly k square prime factors. The book suggested that by analyzing the ratio Ck(N)/N, one could find a constant ck\u221e.\n\nEager to explore this mathematical enigma, Oliver delved into its depths, spending days and nights poring over numbers, equations, and theorems. Each calculation added to his excitement, as he tried to understand the patterns and the secrets hidden within.\n\nHis days turned into weeks, and his weeks turned into months, but Oliver's determination never wavered. He spent countless hours locked in his study, surrounded by stacks of books and scrolls. The people of Arithville began to wonder if their talented prince had lost himself in the realm of numbers.\n\nOliver's parents, King Robert and Queen Victoria, grew concerned for their son. They realized that his obsession with this mathematical problem had consumed him, leaving no room for anything else. The king consulted the kingdom's wisest scholars and mathematicians, hoping they could find a solution.\n\nOne evening, as Oliver buried his face in his hands, trying to unlock the final piece of the puzzle, a knock echoed on his chamber door. Startled, he looked up to find his parents standing in the doorway, their faces etched with worry.\n\n\"Oliver,\" Queen Victoria said softly, \"we understand your passion for mathematics, but you need to find a balance. There is more to life than numbers.\"\n\nKing Robert nodded in agreement. \"Son, take a break from this problem that has consumed you. Go out into the world, breathe in the fresh air, and find some joy outside these four walls.\"\n\nOliver realized that his parents spoke from a place of love and concern. He had neglected his duties as a prince and had forgotten the joy of simple pleasures. Reluctantly, he closed the old book and set it aside, determined to follow his parents' advice.\n\nDays turned into weeks, and Oliver immersed himself in the world outside, spending time with his friends, exploring the beautiful landscapes of Arithville, and regaining the balance that had eluded him for so long. And yet, the mathematical problem constantly lingered in the back of his mind.\n\nOne evening, as the sun set over the kingdom, Oliver and his friends gathered around a bonfire. Sharing stories and laughter, they marveled at the wonders of the world. Suddenly, Oliver's eyes fell upon the embers dancing in the fire, and a spark of realization flashed within him. He jumped to his feet, excitement coursing through his veins.\n\n\"Guys, I think I've solved it!\" he exclaimed, unable to contain his enthusiasm. \"The constant c7\u221e, I think I've cracked the code!\"\n\nHis friends leaned in closer, eager to hear his revelation. Oliver began to explain his theory, weaving his newfound understanding into the tapestry of the story of his journey.\n\nAs he spoke, the flickering firelight illuminated their faces, reflecting the spark of curiosity and excitement Oliver had kindled within them. The friends sat in awe, absorbing the knowledge he shared.\n\nBut the story doesn't end here, dear reader. Now it is your turn to take on the challenge that captivated Oliver's mind. Can you find the constant c7\u221e, that he worked so tirelessly to uncover?\n\nAnd so, I leave you with this question: What is c7\u221e, the constant that holds the secret to the mathematical puzzle Oliver stumbled upon in that ancient book? Take a leap of curiosity and immerse yourself in the world of numbers, for the answer lies waiting to be discovered."}, {"id": 640, "euler_id": 640, "title": "Shut the Box", "problem": "Bob plays a single-player game of chance using two standard 6-sided dice and twelve cards numbered 1 to 12. When the game starts, all cards are placed face up on a table.\nEach turn, Bob rolls both dice, getting numbers x and y respectively, each in the range 1,...,6. He must choose amongst three options: turn over card x, card y, or card x+y. (If the chosen card is already face down, it is turned to face up, and vice versa.)\nIf Bob manages to have all twelve cards face down at the same time, he wins.\nAlice plays a similar game, except that instead of dice she uses two fair coins, counting heads as 2 and tails as 1, and that she uses four cards instead of twelve. Alice finds that, with the optimal strategy for her game, the expected number of turns taken until she wins is approximately 5.673651.\nAssuming that Bob plays with an optimal strategy, what is the expected number of turns taken until he wins? Give your answer rounded to 6 places after the decimal point.", "solution": "50.317928", "difficulty": 50, "story": "Once upon a time in the bustling city of Numeria, there lived a young man named Bob. Bob was known for his love of games and his knack for solving puzzles. Word of his talents had spread far and wide, catching the attention of a peculiar old man named Professor Mathius.\n\nOne sunny afternoon, as Bob was engrossed in playing his favorite board game at the local park, he noticed an old man in a tattered coat observing him curiously. The old man approached Bob with a smile, revealing a glimmer of mischief in his eyes.\n\n\"Ah, greetings young master of games,\" Professor Mathius greeted Bob. \"I have a challenge for you\u2014one that requires not only your skills but also your mathematical prowess.\"\n\nNaturally intrigued, Bob put his game aside and listened intently as the old man explained the rules of a game he had devised.\n\nThe game involved two standard dice and twelve numbered cards laid out on a table. Bob's objective was to flip all twelve cards face down. Each turn, he would roll the dice and obtain two numbers\u2014a value for each die. Bob had three options: flipping over the card corresponding to the first die, flipping over the card corresponding to the second die, or flipping over the card corresponding to the sum of both dice.\n\nThe Professor explained that Bob had to strive for an optimal strategy if he wanted to succeed. However, he gave no further clues to what this strategy might be.\n\nIntrigued by the challenge, Bob decided to take up the game. He found himself engrossed in it, rolling the dice and flipping cards in a desperate attempt to uncover the optimal approach. Bob was determined to devise a strategy that would allow him to win the game in the fewest possible turns.\n\nDays turned into weeks, and weeks turned into months. Bob played the game tirelessly, capturing the attention of onlookers who were equally captivated by his determination. With each roll of the dice, Bob's mind whirled with calculations and probabilities. He jotted down endless notes and charts, gradually forming patterns and rules.\n\nOne evening, as the sun began to set, Bob finally arrived at a stunning realization. He had discovered an optimal strategy\u2014one that had eluded him for so long. With newfound excitement, he approached Professor Mathius, ready to share his findings.\n\n\"Professor Mathius, I believe I have uncovered a strategy that will maximize my chances of winning the game,\" Bob said eagerly.\n\nA smile crept across the old man's face, betraying his anticipation. \"Ah, young Bob, you have indeed grown wiser through your endeavors. But tell me, what is the expected number of turns it will take you to win the game with your newfound strategy?\"\n\nBob was momentarily stunned by the question, his mind racing to process the mathematical problem behind the game. The concept of expected value whispered through his thoughts, reminding him of Alice's game and the approximate number of turns it took for her to win.\n\nAs the answer loomed just beyond his grasp, Bob couldn't help but wonder: what was the expected number of turns it would take him to win the game? He knew it was a pivotal question, one that would determine the efficacy of his strategy and its impact on his chances of success.\n\nCaught in a tantalizing web of curiosity, Bob turned to the old man and posed his ultimate question, \"Professor Mathius, can you enlighten me? What is the expected number of turns it will take me to win this game?\"\n\nAnd with that, the professor's eyes twinkled mischievously, leaving Bob to ponder the question as he continued on his journey towards mathematical conquest.\n\nWhat is the expected number of turns taken until Bob wins the game? Give your answer rounded to 6 places after the decimal point."}, {"id": 656, "euler_id": 656, "title": "Palindromic sequences", "problem": "\nGiven an irrational number \u03b1, let S\u03b1(n) be the sequence S\u03b1(n)=\u230a\u03b1\u22c5n\u230b\u2212\u230a\u03b1\u22c5(n\u22121)\u230b for n\u22651. \n(\u230a...\u230b is the floor-function.)\n\n\nIt can be proven that for any irrational \u03b1 there exist infinitely many values of n such that the subsequence {S\u03b1(1),S\u03b1(2)...S\u03b1(n)} is palindromic.\n\nThe first 20 values of n  that give a palindromic subsequence for \u03b1=31 are:\n1, 3, 5, 7, 44, 81, 118, 273, 3158, 9201, 15244, 21287, 133765, 246243, 358721, 829920, 9600319, 27971037, 46341755, 64712473.\n\nLet Hg(\u03b1) be the sum of the first g values of n  for which the corresponding subsequence is palindromic.\nSo H20(31)=150243655.\n\nLet T={2,3,5,6,7,8,10,...,1000} be the set of positive integers, not exceeding 1000, excluding perfect squares.\nCalculate the sum of H100(\u03b2) for  \u03b2\u2208T. Give the last 15 digits of your answer.\n", "solution": "888873503555187", "difficulty": 50, "story": "As the sun set over the small coastal town of Carmont, a young, curious boy named Oliver gazed at the vast expanse of the ocean. He loved spending his evenings by the harbor, watching fishing boats return with their bountiful catch and the seagulls swooping down to scavenge the leftover scraps.\n\nOne particular evening, while Oliver was lost in thought, he overheard a conversation between two fishermen sitting nearby. They were discussing a peculiar occurrence that had captured their attention over the past few days.\n\n\"Did you hear about the strange sequence that our mathematician friend discovered?\" one of the fishermen exclaimed.\n\nIntrigued, Oliver eavesdropped, his ears perked up. The fisherman continued, \"He mentioned something about palindromic subsequences. Apparently, for any irrational number, there are infinite values of n that result in a palindromic sequence. I can't wrap my head around it!\"\n\nCuriosity piqued, Oliver carefully listened to their conversation, trying to decipher the complexities of this mathematical problem. He had always been fascinated with numbers, and this newfound concept excited him greatly.\n\nDetermined to learn more, Oliver spent the next few days studying the mathematics behind this phenomenon. He eagerly delved into the intricacies of the irrational number alpha, examining the properties of the sequence S_alpha(n).\n\nAs Oliver began to understand the concept, he realized the significance of this mathematical problem. It held a key that could unlock numerous secrets, not only within the numeric world but potentially in other domains as well.\n\nWith newfound determination, Oliver embarked on a mission to explore the impact of palindromes in different aspects of life. He analyzed patterns in nature, seeking symmetry and harmony, and observed the recurring presence of palindromic structures.\n\nHis discoveries took him on a whirlwind journey through ancient architecture, classical music compositions, and intricate artworks. Everywhere he looked, he witnessed the beauty and intrigue generated by palindromes.\n\nOliver's quest for knowledge expanded his horizons in unimaginable ways. He met people from various disciplines who were captivated by the same concept, all united by their curiosity and unwavering desire to understand the underlying mathematics.\n\nMonths turned into years, and Oliver's expertise grew exponentially. He became renowned for his unique perspective, blending mathematical theory with creative imagination. His insights were highly sought after by scientists, artists, and mathematicians, who admired his ability to bridge the gap between seemingly unrelated fields.\n\nOne evening, as the full moon illuminated the sky, Oliver found himself back at the harbor where his journey began. Sitting on a weathered wooden bench, he looked out at the tranquil ocean, reflecting upon the extraordinary adventure he had undertaken.\n\nLost in a whirlwind of thoughts, Oliver pondered the sum of H100(beta) for beta belonging to set T. He realized that such a calculation would require innumerable hours of calculations and intense concentration, yet the endeavor enthralled him.\n\nWith an earnest passion burning within him, Oliver was burdened by the weight of his question. He yearned for someone to share his enthusiasm, to embark on this mathematical journey and find the answer alongside him.\n\nAs the cool ocean breeze caressed his face, Oliver contemplated the countless possibilities that awaited him. He needed someone as audacious as he was, someone who ardently sought knowledge and was willing to dive into the depths of mathematical enigma.\n\nFinally, he mustered the courage to voice his question to the vast expanse of the sea, hoping that it would find its way to someone who would dare to answer:\n\n\"Who will join me in unraveling the sum of H100(beta) for beta in set T? Can we decipher the last 15 digits of this remarkable calculation?\"\n\nAnd with that question hanging in the air, Oliver's story continued, his search for a like-minded companion who shared his insatiable thirst for knowledge and adventure."}, {"id": 672, "euler_id": 672, "title": "One more one", "problem": "Consider the following process that can be applied recursively to any positive integer n:\nif n=1 do nothing and the process stops,\nif n is divisible by 7 divide it by 7,\notherwise add 1.\nDefine g(n) to be the number of 1's that must be added before the process ends. For example:\n125\u2192+1126\u2192\u00f7718\u2192+119\u2192+120\u2192+121\u2192\u00f773\u2192+14\u2192+15\u2192+16\u2192+17\u2192\u00f771.\nEight 1's are added so g(125)=8. Similarly g(1000)=9 and g(10000)=21.\nDefine S(N)=\u2211n=1Ng(n) and H(K)=S(7K\u2212111). You are given H(10)=690409338.\nFind H(109) modulo 1117117717.", "solution": "91627537", "difficulty": 50, "story": "Once upon a time, in a peaceful village nestled between rolling hills and blooming wildflowers, there lived a young girl named Lily. Lily was known for her vibrant personality and insatiable curiosity, which often led her to embark on exciting adventures beyond the confines of her village.\n\nOne sunny afternoon, as Lily wandered through the woods, she stumbled upon a hidden clearing. In its center stood an old oak tree, its gnarled branches reaching towards the sky. Curiosity tingling in her veins, she approached the majestic tree and noticed a small, worn book tucked beneath its roots.\n\nWith trembling fingers, Lily delicately lifted the book and opened it to the first page. To her surprise, she found a fascinating mathematical problem inscribed there.\n\nIntrigued, Lily immersed herself in the realms of numbers, reading the problem aloud for herself. As she absorbed the words, she couldn't help but feel a mysterious connection between the mathematical problem and the enchanted clearing.\n\nFrom that day forward, Lily began her quest to solve the mathematical riddle. She embarked on a journey to understand the recursive process, exploring its complexities with relentless determination.\n\nWhile traveling from village to village, she encountered numerous mathematical puzzles, which acted as stepping stones, guiding her ever closer to the solution. Lily met wise scholars who taught her invaluable lessons about divisibility and the power of adding one.\n\nAs she learned more, the mathematical problem presented itself in different forms, appearing in the most unexpected places. Lily saw it etched on the bark of trees, whispered by the wind, and reflected in the shimmering surface of lakes. The puzzle became more than just numbers\u2014it became a living, breathing part of her journey.\n\nThe villagers marveled at Lily's unwavering zeal and watched as she grew stronger with each challenge she overcame. They admired her resilience and the way she effortlessly wove numbers into stories, mesmerizing listeners with her tales of mathematical wonder.\n\nEventually, news of Lily's exploits reached the ears of the Kingdom's royal mathematician, an illustrious figure named Professor Huxley. Intrigued by the young girl and her profound grasp of mathematics, he invited her to his grand castle.\n\nIn the presence of Professor Huxley, surrounded by dusty tomes and ancient manuscripts, Lily delved deeper into the problem. The professor shared his own insights, leading them on a merry chase through countless theories.\n\nAs the days passed, the castle walls bore witness to animated debates, chalkboards covered in scribbles, and nights spent poring over equations. Lily's eyes sparkled with exhilaration, for she knew she was on the brink of unraveling the mystery that had captured her heart.\n\nThen, one fateful evening, as the setting sun cast hues of gold across the sky, Lily discovered a vital clue\u2014the formula for S(N), the sum of g(n). The pieces of the puzzle aligned perfectly, and she experienced an exhilarating eureka moment.\n\nHer heart raced as she swiftly scribbled down the formula, capturing the essence of her journey within those elegant symbols. With trembling hands, Lily handed the solution to Professor Huxley, her eyes filled with anticipation.\n\nHowever, the professor's face creased with concern as he studied her work. \"This formula is incomplete,\" he murmured, his brow furrowed deep in thought.\n\nLily's excitement turned to confusion. \"What do you mean, Professor?\" she asked, the weight of disappointment pooling in her voice.\n\n\"In all my years of study, I have yet to determine the correct value of H(109) modulo 1117117717,\" Professor Huxley explained. \"It remains an enigma\u2014an unsolved mathematical mystery.\"\n\nAs Lily listened to the professor's words, a mix of emotions washed over her. Her journey had brought her so far, yet the final answer eluded her grasp.\n\nNow, dear reader, as you immerse yourself in Lily's remarkable story, I pose this final question to you: Can you solve the mathematical problem, finding the value of H(109) modulo 1117117717?"}, {"id": 676, "euler_id": 676, "title": "Matching Digit Sums", "problem": "\nLet d(i,b) be the digit sum of the number i in base b. For example d(9,2)=2, since 9=10012.\nWhen using different bases, the respective digit sums most of the time deviate from each other, for example d(9,4)=3\u2260d(9,2).\n\n\nHowever, for some numbers i there will be a match, like d(17,4)=d(17,2)=2.\nLet M(n,b1,b2) be the sum of all natural numbers i\u2264n for which d(i,b1)=d(i,b2).\nFor example, M(10,8,2)=18, M(100,8,2)=292 and M(106,8,2)=19173952.\n\n\nFind \u2211k=36\u2211l=1k\u22122M(1016,2k,2l), giving the last 16 digits as the answer.\n", "solution": "3562668074339584", "difficulty": 50, "story": "In a quiet village nestled among rolling hills, there lived a curious young girl named Lily. Lily had an insatiable thirst for knowledge and a mind as sharp as a needle. One sunny afternoon, as she sat under her favorite tree, engrossed in a book about numbers, she stumbled upon a peculiar mathematical problem.\n\n\"Let d(i,b) be the digit sum of the number i in base b,\" she read aloud in fascination. Her heart began to race with excitement. Lily was always captivated by the wonders of mathematics, and this problem promised to be no different.\n\nAs the days turned into nights, the mystery of the mathematical problem consumed Lily's thoughts. She imagined herself discovering a solution that would unlock the secrets of the universe. With each passing day, her determination grew stronger, and she vowed to solve the problem.\n\nOne evening, as the village prepared for its annual fair, Lily hatched a plan. She knew that all the reputed mathematicians from neighboring lands would attend the event. It was her chance to seek their guidance and unravel the enigma that had taken hold of her mind.\n\nClutching her notebook and pencil, Lily made her way to the fairgrounds. She walked among the bustling crowd, her eyes darting around in search of the wisest minds. Finally, she spotted them, gathered under a large oak tree, discussing mathematical equations in hushed tones.\n\nSummoning her courage, Lily approached the mathematicians and introduced herself. With wide-eyed enthusiasm, she shared the mathematical problem she had encountered.\n\nOne of the mathematicians, an old man with a long white beard, scratched his chin and pondered. \"Ah, the beauty of number theory,\" he mused. \"This problem, my dear, holds a key to understanding the intricacies of different number bases.\"\n\nLily's heart raced with anticipation. \"Please, tell me more,\" she urged.\n\nThe old mathematician continued, \"You see, most of the time, the digit sums in different bases deviate from each other. But for certain numbers, like 17, there can be a match. The sum of its digits in base 4 is the same as in base 2.\"\n\nLily's eyes glistened with excitement. She realized the significance of this revelation. It wasn't just a random mathematical puzzle but a glimpse into the interconnectedness of numbers.\n\nAs the night grew darker, Lily listened intently to the tales the mathematicians shared. They spoke of prime numbers, perfect squares, and the intricacies of base systems. Lily's notebook overflowed with sketches, calculations, and endless scribbles.\n\nNow, dear reader, I ask you this: Can you solve the mathematical problem that captured Lily's imagination? Can you find the sum, \u2211k=36\u2211l=1k\u22122M(1016,2k,2l), and uncover those last 16 elusive digits?"}, {"id": 681, "euler_id": 681, "title": "Maximal Area", "problem": "\nGiven positive integers a\u2264b\u2264c\u2264d, it may be possible to form quadrilaterals with edge lengths a,b,c,d (in any order). When this is the case, let M(a,b,c,d) denote the maximal area of such a quadrilateral. For example, M(2,2,3,3)=6, attained e.g. by a 2\u00d73 rectangle.\n\n\nLet SP(n) be the sum of a+b+c+d over all choices a\u2264b\u2264c\u2264d for which M(a,b,c,d) is a positive integer not exceeding n.\nSP(10)=186 and SP(100)=23238.\n\n\nFind SP(1000000).\n", "solution": "2611227421428", "difficulty": 50, "story": "Once upon a time, in a small village nestled in the rolling hills, there lived a young girl named Alice. Alice was known for her intrinsic curiosity and an insatiable thirst for knowledge. Her favorite spot to spend her time was the Village Library, where she could escape into the enchanting world of books.\n\nOne sunny afternoon, Alice found herself immersed in a peculiar tale that had caught her attention. It was a story about a mystical land where quadrilaterals played a vital role. In this extraordinary land, quadrilaterals with specific edge lengths possessed a wondrous power. Alice's eyes sparkled with intrigue as she read further.\n\nIn this land, each quadrilateral was formed by selecting positive integers a, b, c, and d. These numbers were special because they followed a particular order: a was less than or equal to b, b was less than or equal to c, and c was less than or equal to d. These parameters ensured that extraordinary quadrilaterals were formed.\n\nAlice read with bated breath as she discovered another incredible facet of this land: the maximal area of these quadrilaterals. Each quadrilateral had a unique maximal area denoted by M(a, b, c, d). For instance, M(2, 2, 3, 3) equaled 6, which could be achieved by creating a 2\u00d73 rectangle.\n\nMathematical problems danced off the page, seducing Alice's mind. She couldn't resist the allure of the unknown. Determined to unravel the secret behind M(a, b, c, d), Alice embarked on a journey, armed with her unwavering determination and a pocketful of numbers.\n\nAs Alice traveled through enchanted forests and crossed vast rivers, she encountered wise sages and mystical creatures who held partial answers to the mathematical problem that consumed her thoughts. They revealed snippets of information, guiding her towards the solution.\n\nThe journey was arduous, but it was through her interactions that Alice began to understand the significance of the mathematical problem. The sum of a, b, c, and d played a crucial role in unlocking the hidden wonders within these quadrilaterals. Dubbed as SP(n), it symbolized the sum of a, b, c, and d for all possible combinations that resulted in a maximal area less than or equal to n.\n\nAlice felt a spark of excitement as she neared the end of her journey. The sages had granted her insights into the sum of a, b, c, and d, which equaled 186 for SP(10) and an astonishing 23,238 for SP(100).\n\nNow, Alice stood at a crossroads, with one final challenge ahead. She pondered the magnitude of SP(1,000,000), a number beyond anything she had ever encountered. The enormity of the task ahead weighed on her, but Alice couldn't walk away without delving into the mysteries that lay within this grand number.\n\nHer mind buzzing with ideas, Alice took a deep breath and glanced at the path stretching out before her. The journey would be long and treacherous, but the rewards of discovering SP(1,000,000) were unimaginable. Encouraged by an insatiable curiosity, Alice embarked on her greatest adventure yet.\n\nAnd as Alice took her first step towards this colossal challenge, she couldn't help but wonder \u2013 Would you be the one to solve the enigma of SP(1,000,000)?"}, {"id": 682, "euler_id": 682, "title": "5-Smooth Pairs", "problem": "5-smooth numbers are numbers whose largest prime factor doesn't exceed 5.\n5-smooth numbers are also called Hamming numbers.\nLet \u03a9(a) be the count of prime factors of a (counted with multiplicity).\nLet s(a) be the sum of the prime factors of a (with multiplicity).\nFor example, \u03a9(300)=5 and s(300)=2+2+3+5+5=17.\nLet f(n) be the number of pairs, (p,q), of Hamming numbers such that \u03a9(p)=\u03a9(q) and s(p)+s(q)=n.\nYou are given f(10)=4 (the pairs are (4,9),(5,5),(6,6),(9,4)) and f(102)=3629.\nFind f(107)mod1000000007.", "solution": "290872710", "difficulty": 50, "story": "Once upon a time, in the quiet village of Numerville, lived a young boy named Ethan. Ethan was well-known among the villagers for his exceptional talent in mathematics. He had a sharp mind and an insatiable curiosity for all things numerical. The villagers often sought his help whenever they encountered a mathematical puzzle or problem they couldn't solve.\n\nOne sunny afternoon, as Ethan was walking through the village square, he noticed an old book sitting on a bench. The book had a worn-out cover with strange symbols and diagrams adorning its pages. Curiosity getting the better of him, Ethan picked up the book and began to flip through its ancient pages.\n\nTo his astonishment, the book contained a collection of mathematical problems, unlike anything he had ever seen before. One particular problem caught his eye, and it went as follows:\n\n\"5-smooth numbers are numbers whose largest prime factor doesn't exceed 5.\n5-smooth numbers are also called Hamming numbers.\nLet \u03a9(a) be the count of prime factors of a (counted with multiplicity).\nLet s(a) be the sum of the prime factors of a (with multiplicity).\nFor example, \u03a9(300)=5 and s(300)=2+2+3+5+5=17.\nLet f(n) be the number of pairs, (p,q), of Hamming numbers such that \u03a9(p)=\u03a9(q) and s(p)+s(q)=n.\nYou are given f(10)=4 (the pairs are (4,9),(5,5),(6,6),(9,4)) and f(102)=3629.\nFind f(107)mod1000000007.\"\n\nEthan's eyes widened with excitement as he realized the significance of this problem. \"If I can solve this, I might be able to uncover something magnificent!\" he thought.\n\nDetermined to crack the code, Ethan delved into the depths of his mathematical knowledge. He spent days and nights meticulously analyzing the problem, jotting down calculations, and attempting different approaches. As he delved deeper into the intricacies of the problem, Ethan realized that the concept of Hamming numbers was the key to solving it.\n\nSoon enough, the village started noticing Ethan's absence. They would ask, \"Where is Ethan? We need his mathematical expertise.\" However, no one knew about his newfound mission to conquer the mysterious problem from the old book.\n\nAs months turned into years, Ethan became increasingly consumed by the problem. His obsession grew, and he dedicated all his time to solving it. The village began to worry about him, wondering if he had lost his touch with reality.\n\nOne night, while poring over his calculations, Ethan had a realization. A revelation that could potentially unlock the answer he had been seeking for so long. His eyes lit up with a newfound hope as he scribbled down the final piece of the puzzle.\n\nNow, emotionally exhausted and on the brink of unraveling, Ethan emerged from his humble abode. He stood in front of the villagers, their faces filled with relief to see him again, but also filled with concern for his well-being.\n\nWith a confident and determined voice, Ethan spoke, \"My dear friends, I have devoted the past years of my life to a remarkable mathematical problem that has challenged my every waking moment. However, I need your help to uncover its solution. Can any of you solve the equation f(107) mod 1000000007?\"\n\nThe villagers looked at Ethan, astonished by his request. Their jaws dropped at the complexity of the problem and the significance it held. And then, the question echoed through the village square, leaving a cloud of anticipation hanging in the air... \n\nCan you solve the equation f(107) mod 1000000007?"}, {"id": 708, "euler_id": 708, "title": "Twos are all you need", "problem": "A positive integer, n, is factorised into prime factors. We define f(n) to be the product when each prime factor is replaced with 2. In addition we define f(1)=1.\nFor example, 90=2\u00d73\u00d73\u00d75, then replacing the primes, 2\u00d72\u00d72\u00d72=16, hence f(90)=16.\nLet S(N)=\u2211n=1Nf(n). You are given S(108)=9613563919.\nFind S(1014).", "solution": "28874142998632109", "difficulty": 50, "story": "Once upon a time, in a quaint little village known as Numeria, lived a young and curious tailor named Theo. Theo was known for his meticulous attention to detail and his remarkable ability to transform scraps of fabric into exquisite garments. While his fellow villagers marveled at his talent, there was one thing that captivated Theo's mind more than needle and thread: numbers.\n\nTheo had always been fascinated by numbers, seeing patterns and equations where others saw chaos. His favorite pastime was solving mathematical puzzles, often losing himself in the pursuit of finding elegant solutions. One day, while browsing through an old dusty book in the village library, Theo stumbled upon a peculiar problem that seemed to hold a world of mystery within its lines.\n\nThe problem read as follows: \"A positive integer, n, is factorized into prime factors. We define f(n) to be the product when each prime factor is replaced with 2. In addition, we define f(1)=1.\" Intrigued by its cryptic nature, Theo was determined to solve it.\n\nAs days turned into weeks, and weeks turned into months, Theo delved deeply into the realms of numbers and prime factorization. Each evening, he would retreat to his cozy cabin, surrounded by walls adorned with mathematical formulas, and immerse himself in solving the enigma that plagued his thoughts.\n\nHis dedication led him on a journey through the labyrinths of countless prime numbers, struggling to decipher their secrets. Day after day, Theo poured over ancient manuscripts and spoke with wise mathematicians, seeking their guidance and wisdom.\n\nEventually, the villagers of Numeria noticed a change in Theo; his once cheerful demeanor was replaced with a furrowed brow and sleepless nights. Concerned for their beloved tailor, they decided to intervene. One by one, they came knocking on his door, offering words of encouragement and solace, telling tales of their own struggles and how they overcame them.\n\nAs Theo listened to their stories, he realized that he had failed to see the beauty in the journey itself, solely focusing on the destination. He had overlooked the fact that this problem was not meant to be solved in isolation but rather as part of a larger tapestry, woven together by the diverse experiences and perspectives of the villagers.\n\nWith newfound optimism, Theo returned to his pursuit, only this time seeking assistance from the people of Numeria. They collaborated, sharing their knowledge and discoveries, building bridges of understanding where there were once walls of confusion.\n\nDays turned into weeks once again, until finally, the day arrived when Theo emerged from his cabin, a sense of triumph emanating from his smile. He had done it! He had found an elegant solution to the mathematical problem that had consumed his thoughts for so long.\n\nOverjoyed, Theo rushed to the village square, gathering everyone in anticipation of his revelation. The villagers listened intently as he explained how he had cracked the problem and uncovered the secret of prime factorization. They marveled at his brilliance and applauded his tenacity.\n\nBut just as their celebration began, a sudden realization dawned on Theo. He realized that his quest for knowledge had been fueled not by the desire for recognition or applause, but by the sheer joy of discovery.\n\nWith a twinkle in his eye and a grin on his face, Theo turned to address the villagers. \"My dear friends,\" he said, \"I have unlocked the secrets hidden within this mathematical problem. But now, I pose a question to all of you. Can you find the value of S(1014)? Can you solve this marvelous mystery?\"\n\nThe villagers looked at each other, their eyes filled with determination, knowing that they too could embark on a journey of discovery. And so, they set forth, armed with the knowledge they had gained from Theo's guidance and their own unique perspectives.\n\nAs the villagers dispersed, ready to delve into the enchantment of numbers, Theo watched with pride. He had not merely solved a mathematical problem; he had sparked a love for learning, a desire to unravel the secrets hiding beneath the surface of our everyday lives.\n\nAnd so, dear reader, I pass the torch onto you. Can you find the value of S(1014)? Can you uncover the intricacies that lie within the magical world of prime factorization?"}, {"id": 726, "euler_id": 726, "title": "Falling bottles", "problem": "\nConsider a stack of bottles of wine. There are n layers in the stack with the top layer containing only one bottle and the bottom layer containing n bottles. For n=4 the stack looks like the picture below.\n\n\n\n\nThe collapsing process happens every time a bottle is taken. A space is created in the stack and that space is filled according to the following recursive steps:\nNo bottle touching from above: nothing happens. For example, taking F.\nOne bottle touching from above: that will drop down to fill the space creating another space. For example, taking D.\nTwo bottles touching from above: one will drop down to fill the space creating another space. For example, taking C.\n\nThis process happens recursively; for example, taking bottle A in the diagram above. Its place can be filled with either B or C. If it is filled with C then the space that C creates can be filled with D or E. So there are 3 different collapsing processes that can happen if A is taken, although the final shape (in this case) is the same.\n\n\nDefine f(n) to be the number of ways that we can take all the bottles from a stack with n layers. \nTwo ways are considered different if at any step we took a different bottle or the collapsing process went differently.\n\n\nYou are given f(1)=1, f(2)=6 and f(3)=1008.\n\nAlso define\n\nS(n)=\u2211k=1nf(k)\n\nFind S(104) and give your answer modulo 1000000033.\n", "solution": "578040951", "difficulty": 50, "story": "Once upon a time, in a small village nestled at the heart of the countryside, there lived a young and curious girl named Lily. Lily had always been fascinated by puzzles and mathematical mysteries, often spending her days deep in thought, contemplating the intricate patterns and calculations of the world around her.\n\nOne sunny morning, as Lily wandered through the village, she stumbled upon an old, dusty book lying forgotten on a park bench. With her curiosity piqued, she picked up the book and began to read. To her amazement, the book contained a collection of mathematical conundrums and mind-bending problems that seemed to jump off its timeworn pages.\n\nOne problem, in particular, intrigued Lily. It spoke of a stack of wine bottles, carefully arranged in a pyramid shape, with each layer holding one more bottle than the previous. The process of taking a bottle from the stack fascinated her - for every bottle taken, a space was created and filled, resulting in a vast array of collapsing possibilities. \n\nLily delved deeper into the problem, discovering that the total number of ways one could take all the bottles from the stack, f(n), was dependent on the number of layers within the stack. The book provided her with the first few values of f(n) - f(1) equaled 1, f(2) equalled 6, and f(3) was an astounding 1008. The beauty of this mathematical enigma overwhelmed Lily, and she became determined to solve it herself.\n\nDays turned into weeks, as Lily poured over pages filled with equations, diagrams, and countless annotations. She experimented with various approaches, exploring different patterns, and drawing connections that she believed might unlock the secrets hidden within the problem. As she delved further into its depths, Lily realized that the solution required her not only to understand the intricacies of the collapsing process but also to comprehend the underlying mathematical principles behind it.\n\nThe villagers marveled at Lily's tireless pursuit of knowledge. They watched as she meticulously arranged and rearranged stacks of empty bottles, lost in a world only she seemed to comprehend. Many approached her, eager to understand the purpose behind her strange experiments, but Lily could not be distracted. She knew she was on the verge of unraveling a great mathematical marvel.\n\nAt long last, after countless sleepless nights and countless scraps of paper filled with equations and calculations, Lily thought she had finally cracked the code. Her heart thumped within her chest as she calculated S(n), the sum of f(k) for all values of k from 1 to n. It was time to put her theory to the test. \n\nBut before Lily could proceed, doubt began to creep into her mind. She questioned whether the great mystery she had spent countless hours unraveling could be solved by a young girl from a small village. The enormity of her task weighed heavily on her shoulders. Determined to prove herself, Lily took a deep breath, mustered all her courage, and decided to embark on a journey to the city, seeking assistance from renowned mathematicians.\n\nAnd so, dear reader, the question remains: Can you solve this astonishing mathematical problem? Can you find S(104), the sum of f(k) for all values of k from 1 to 104? The fate of Lily's journey and the mystery of the collapsing wine bottles await your answer."}, {"id": 736, "euler_id": 736, "title": "Paths to Equality", "problem": "Define two functions on lattice points:\nr(x,y)=(x+1,2y)\ns(x,y)=(2x,y+1)\nA path to equality of length n for a pair (a,b) is a sequence ((a1,b1),(a2,b2),\u2026,(an,bn)), where:\n(a1,b1)=(a,b)\n(ak,bk)=r(ak\u22121,bk\u22121) or (ak,bk)=s(ak\u22121,bk\u22121) for k>1\nak\u2260bk for k<n\nan=bn\nan=bn is called the final value.\nFor example,\n(45,90)\u2192r(46,180)\u2192s(92,181)\u2192s(184,182)\u2192s(368,183)\u2192s(736,184)\u2192r\n(737,368)\u2192s(1474,369)\u2192r(1475,738)\u2192r(1476,1476)\nThis is a path to equality for (45,90) and is of length 10 with final value 1476. There is no path to equality of (45,90) with smaller length.\nFind the unique path to equality for (45,90) with smallest odd length. Enter the final value as your answer.", "solution": "25332747903959376", "difficulty": 50, "story": "Once upon a time in the enchanting land of Numerica, there lived two best friends named Alice and Bob. They were inseparable and spent all their days exploring the magical forests and solving the mysterious riddles that lay hidden within.\n\nOne sunny morning, as Alice and Bob ventured through a dense thicket, they stumbled upon an ancient scroll. The scroll was adorned with intricate symbols and cryptic messages. Curiosity piqued, they eagerly unraveled its secrets only to discover a perplexing mathematical problem.\n\nAs it turned out, the problem involved defining two functions on lattice points - r(x,y) and s(x,y). The duo learned that a path to equality of length 'n' for a pair (a,b) was a sequence of steps that would eventually lead to the numbers 'a' and 'b' being equal.\n\nDetermined to find the unique path to equality for (45,90) with the smallest odd length, Alice and Bob delved into deciphering the hidden meaning behind the symbols on the scroll.\n\nFor hours, they immersed themselves in the world of numbers, strategizing and combining the functions r(x,y) and s(x,y) like a fascinating puzzle. As they crisscrossed the lattice points, Alice and Bob realized that each step mirrored the transformations of their own lives.\n\nThe function r(x,y) represented Alice's love for exploration and new horizons. It propelled her forward, always seeking to uncover the mysteries that lay beyond the known. Conversely, the function s(x,y) embodied Bob's grounded nature, his unwavering support for Alice, and their shared journey through life.\n\nIn their quest to find the unique path to equality, the friends encountered unforeseen challenges and tempting shortcuts. They faced moments of doubt when self-doubt threatened to cloud their minds. Yet, their unwavering friendship and determination carried them through each twist and turn.\n\nAs Alice and Bob poured over the scroll, they couldn't help but wonder: What were the adventures that awaited them on this extraordinary path? How could they achieve equality using the smallest odd number of steps possible? And most importantly, what would be the final value they would uncover at the end of it all?\n\nAnd so, the friends set forth, their imaginations ablaze, their spirits intertwined. As they journeyed through the mystical realm of Numerica, their hearts echoed with excitement and anticipation. The answer awaited, but it held more than just a numerical value. Deep within, it held the power to unlock new realms of understanding, a testimony to the strength of friendship and the beauty of mathematics.\n\nWith their minds filled with wonder, Alice and Bob continued their adventure, progressing through the magical lattice points, each step bringing them closer to the answer they sought. But what would be the final value they'd discover?\n\nNow, dear reader, I present you with the same challenge that Alice and Bob faced. Can you unravel the mystery and find the unique path to equality for (45,90) with the smallest odd length? And most crucially, what will be the final value? The power to uncover these secrets rests in your hands."}, {"id": 758, "euler_id": 758, "title": "Buckets of Water", "problem": "\nThere are 3 buckets labelled S (small) of 3 litres, M (medium) of 5 litres and L (large) of 8 litres.\nInitially S and M are full of water and L is empty.\nBy pouring water between the buckets exactly one litre of water can be measured.\nSince there is no other way to measure, once a pouring starts it cannot stop until either the source bucket is empty or the destination bucket is full.\nAt least four pourings are needed to get one litre:\n\n\n(3,5,0)\u2192M\u2192L(3,0,5)\u2192S\u2192M(0,3,5)\u2192L\u2192S(3,3,2)\u2192S\u2192M(1,5,2)\n\nAfter these operations, there is exactly one litre in bucket S.\n\n\nIn general the sizes of the buckets S,M,L are a, b, a+b litres, respectively. Initially S and M are full and L is empty. If the above rule of pouring still applies and a and b are two coprime positive integers with a\u2264b then it is always possible to measure one litre in finitely many steps.\n\n\nLet P(a,b) be the minimal number of pourings needed to get one litre. Thus P(3,5)=4.\nAlso, P(7,31)=20 and P(1234,4321)=2780.\n\n\nFind the sum of P(2p5\u22121,2q5\u22121) for all pairs of prime numbers p,q such that p<q<1000.\nGive your answer modulo 1000000007.\n", "solution": "331196954", "difficulty": 50, "story": "Once upon a time in the kingdom of Matheisia, there lived a young and curious princess named Aurora. She was known for her sharp intellect and insatiable thirst for knowledge. Princess Aurora had a never-ending desire to learn about the world, and she often embarked on exciting adventures to satisfy her inquisitive mind.\n\nOne sunny morning, as Princess Aurora was strolling through the royal gardens, she stumbled upon a peculiar sight. There, hidden amongst the vibrant flowers and towering trees, was an intricate puzzle. It consisted of three buckets, beautifully labeled \"S\" for small, \"M\" for medium, and \"L\" for large. Princess Aurora's interest was immediately piqued.\n\nCuriosity getting the better of her, the princess approached the puzzle and read the instructions engraved nearby. The puzzle challenged her to solve a mathematical problem involving the buckets and the measurement of water. According to the instructions, the aim was to measure one liter of water using the three buckets and a specific pouring technique.\n\nAs Princess Aurora delved deeper into the intricacies of the problem, she discovered that the sizes of the buckets were dictated by two coprime positive integers, a and b, with a\u2264b. The puzzle would require her to find the minimal number of pourings needed to obtain one liter of water using the formula P(a,b).\n\nIntrigued, Princess Aurora knew that she could not resist the allure of solving this mathematical enigma. This was not just a challenge, but an opportunity to unravel something new about the world she inhabited. Little did she know: the answer to this puzzle would unlock countless other wonders hidden within the realm of mathematics.\n\nWith determination shining in her eyes, Princess Aurora pondered the problem, allowing the possibilities to dance through her mind. She realized that the pouring method was the key element: starting with two full buckets, the water needed to be poured from one to another until the destination bucket was full or the source bucket was empty.\n\nThe princess spent hours contemplating P(a,b) and exploring different combinations of pouring techniques, trying to find patterns and unravel the secrets of the puzzle. She conducted numerous experiments, diligently tracking the number of pourings required to measure one liter of water for various pairs of a and b, always ensuring that a and b were prime numbers less than 1000.\n\nAs the days and nights went by, Princess Aurora's dedication never wavered. She became more enamored with the intricacies of the problem, realizing that the puzzle was not just about finding the optimal solution but about the beauty of mathematics itself.\n\nFinally, after much toil, the princess made a breakthrough. She discovered a pattern emerging from her calculations, allowing her to determine the minimal number of pourings, P(a,b), for any given pair of prime numbers a and b. Each pair held the key to unraveling the mystery.\n\nThe exhilaration of conquering the mathematical problem filled Princess Aurora's heart with joy and pride. She marveled at how mathematics could be both challenging and captivating, with secrets waiting to be unlocked by those brave enough to seek them.\n\nAs dusk settled over the royal gardens, Princess Aurora was left with one final question lingering in her mind. She had found P(a,b) for various pairs of primes; but now, she wondered, what would be the sum of P(2p5\u22121,2q5\u22121) for all prime numbers p and q, where p<q<1000?\n\nAnd so, the princess took her final question and the intricate puzzle back to the castle, eager to share her discovery with the wise scholars and mathematicians of Matheisia.\n\nWill you be the one to help Princess Aurora find the sum of P(2p5\u22121,2q5\u22121) for all pairs of prime numbers p and q, where p<q<1000? The answer lies within the realm of mathematics, awaiting the touch of a curious mind."}, {"id": 762, "euler_id": 762, "title": "Amoebas in a 2D grid", "problem": "Consider a two dimensional grid of squares. The grid has 4 rows but infinitely many columns.\nAn amoeba in square (x,y) can divide itself into two amoebas to occupy the squares (x+1,y) and (x+1,(y+1)mod4), provided these squares are empty.\nThe following diagrams show two cases of an amoeba placed in square A of each grid. When it divides, it is replaced with two amoebas, one at each of the squares marked with B:\n\n\nOriginally there is only one amoeba in the square (0,0). After N divisions there will be N+1 amoebas arranged in the grid. An arrangement may be reached in several different ways but it is only counted once. Let C(N) be the number of different possible arrangements after N divisions.\nFor example, C(2)=2, C(10)=1301, C(20)=5895236 and the last nine digits of C(100) are 125923036.\nFind C(100000), enter the last nine digits as your answer.", "solution": "285528863", "difficulty": 50, "story": "Once upon a time in a small town called Amoebaville, there lived a curious young girl named Lily. Lily had an insatiable thirst for knowledge and loved exploring the natural world around her. One day, as she was wandering through the vast forest near her house, she stumbled upon a peculiar sight - a shimmering portal nestled between two old oak trees. Lily's eyes widened with excitement as she stepped closer to investigate.\n\nAs she peered into the portal, she discovered a breathtaking sight - a vast, infinite grid filled with countless squares. Each square seemed to pulse with energy, beckoning Lily to enter. Without hesitation, she took a step forward and found herself transported into the heart of the grid.\n\nLily marveled at the beauty and complexity of the grid. It stretched on endlessly in all directions, with four rows neatly laid out before her. Intrigued, she decided to explore further. She spotted a single amoeba in the square (0,0), seemingly alone in its existence.\n\n\"Hello, little amoeba,\" Lily whispered, her eyes brimming with curiosity. \"What secrets do you hold within your tiny body?\"\n\nTo her surprise, the amoeba responded, \"Greetings, young explorer. I am not alone. In fact, I have the ability to divide myself into two amoebas, expanding my presence in this grid.\"\n\nLily's eyes widened with excitement. She realized that this peculiar creature held the key to a fascinating mathematical puzzle. The amoeba continued, explaining the rules of its divisions.\n\n\"I can divide myself into two amoebas,\" it said, \"to occupy the squares (x+1,y) and (x+1,(y+1)mod4), provided these squares are empty.\"\n\nLily's mind buzzed with possibilities. She had always loved math, and this newfound knowledge intrigued her immensely. She couldn't help but wonder how many different arrangements were possible after 'N' divisions.\n\nAs she spent more time exploring the grid, Lily became determined to solve the puzzle. She noticed that the arrangement of amoebas after each division could be reached in various ways, but only counted once. She began to keep track of the different arrangements she encountered, scribbling notes and making sketches in her trusted notebook.\n\nDays turned into weeks, and weeks turned into months, but Lily's passion for solving the mathematical problem never waned. She delved deeper into the intricacies of amoeba divisions, mapping out possibilities and seeking patterns in the ever-expanding grid.\n\nFinally, after much perseverance and countless late nights, Lily made an astonishing discovery. She found a formula, C(N), to calculate the number of different possible arrangements after N divisions.\n\n\"C(N) represents the number of possibilities!\" Lily exclaimed in excitement. \"This formula can help me find the arrangement for any given number of divisions.\"\n\nHer heart swelled with triumph, and she couldn't wait to share her findings with the rest of Amoebaville. The townspeople were astounded by Lily's intelligence and determination. They admired her for unraveling the mysteries of the grid and the fascinating world of amoebas.\n\nAs the sun set over the horizon, casting a golden glow on the town of Amoebaville, Lily pondered the grandness of the universe and the boundless possibilities it held. She wondered if, in a different dimension or a far-off galaxy, other young minds like hers were unraveling their own mathematical puzzles.\n\nAnd so, dear reader, I leave you with a question: Can you find the value of C(100000)? What are the last nine digits of C(100000)? As you embark on your own journey to solve this mathematical conundrum, remember the passion and curiosity of Lily, the young explorer from Amoebaville, whose love for knowledge turned the ordinary into extraordinary."}, {"id": 773, "euler_id": 773, "title": "Ruff Numbers", "problem": "\nLet Sk be the set containing 2 and 5 and the first k primes that end in 7. For example, S3={2,5,7,17,37}.\n\nDefine a k-Ruff number to be one that is not divisible by any element in Sk.\n\nIf Nk is the product of the numbers in Sk then define F(k) to be the sum of all k-Ruff numbers less than Nk that have last digit 7. You are given F(3)=76101452.\n\nFind F(97), give your answer modulo 1000000007.", "solution": "556206950", "difficulty": 50, "story": "Once upon a time in the quaint village of Numeria, lived a young math prodigy named Oliver. Oliver had always possessed an incredible knack for numbers since he was a little boy. He would spend countless hours in deep contemplation, pondering the mysteries of mathematics. \n\nOne sunny afternoon, as Oliver sat under the shade of a towering oak tree, he stumbled upon a peculiar problem hidden within an ancient book. It was a mathematical enigma that intrigued him like no other. The problem read:\n\n\"Let Sk be the set containing 2 and 5 and the first k primes that end in 7. For example, S3={2,5,7,17,37}.\nDefine a k-Ruff number to be one that is not divisible by any element in Sk.\nIf Nk is the product of the numbers in Sk then define F(k) to be the sum of all k-Ruff numbers less than Nk that have the last digit 7. You are given F(3)=76101452.\nFind F(97), give your answer modulo 1000000007.\"\n\nOliver's eyes sparkled with excitement as he immersed himself in the enchanting world of the problem. Sk was a set unlike any he had encountered before, involving both primes and a specific pattern within their digits. F(k) represented a compilation of these unique numbers, all with the last digit 7, and he was expected to calculate its value modulo 1000000007.\n\nCaptivated by the challenge, Oliver embarked on a quest to solve this perplexing conundrum. He wandered through libraries, delved into dusty scrolls, and consulted wise old mathematicians. Days turned into weeks, and weeks into months, but the answer remained elusive.\n\nOne autumn evening, as Oliver sat beside a crackling fire, he suddenly realized something profound. The answer was not merely a mathematical solution; it was a tale that needed to be woven into the very fabric of Numeria. With newfound determination, he set out to incorporate the mystery into a story that would captivate the villagers, just as the problem had captured his imagination.\n\nOliver's story began with a kingdom ruled by an eccentric queen, who believed that numbers held the key to happiness. To test her theory, she decided to summon a grand contest that would only be won by someone who possessed a profound understanding of arithmetic and its intricacies.\n\nThe queen's subjects eagerly followed the unfolding tale of Oliver's journey, eagerly awaiting the solution to the riddle. They marveled at the intricate relationships between the k-Ruff numbers, Sk, and F(k). They watched as Oliver's hero delved deeper into the kingdom's numerical secrets, racing against time to find the solution.\n\nAs the story progressed, the tension grew, compelling the villagers to think deeply. They pondered the patterns and properties of the prime numbers, searching for a glimmer of insight that might lead them closer to the solution. They enthusiastically charted the possibilities and combinations of Sk, hoping to discover the key that would unlock F(97).\n\nFinally, the day of the grand contest arrived, and the entire kingdom held its breath. Oliver, the hero, stood before the queen, a glimmer of excitement in his eyes. The queen stared intently at him, her gaze filled with anticipation.\n\nOliver paused for a moment, taking in the air thick with anticipation. The room was filled with eager faces, all yearning for a resolution. And then, with a smile that held the weight of the problem's complexity, he posed a final question to the crowd.\n\nHe asked, \"Can you find F(97), give your answer modulo 1000000007?\"\n\nThe villagers gasped, their hearts filled with a renewed fervor. The moment they had been waiting for was at hand. They knew that beyond the boundaries of the story lay the path to the answer, and it rested in their collective minds.\n\nAs the story came to an end, the villagers found themselves facing an immense mathematical challenge. They had to summon their knowledge of primes, explore the intricacies of Sk, and search for the elusive F(97). Each villager embarked on their journey, combining their intellect, intuition, and passion for numbers.\n\nAnd now, dear reader, the question falls upon you. Can you solve the enigma of F(97)? Can you discover the answer that Oliver sought so desperately and weave together the magic of numbers? The key to Numeria's future lies within your grasp."}, {"id": 783, "euler_id": 783, "title": "Urns", "problem": "\nGiven n and k two positive integers we begin with an urn that contains kn white balls. We then proceed through n turns where on each turn k black balls are added to the urn and then 2k random balls are removed from the urn.\n\nWe let Bt(n,k) be the number of black balls that are removed on turn t.\n\nFurther define E(n,k) as the expectation of \u2211t=1nBt(n,k)2.\n\nYou are given E(2,2)=9.6\n\nFind E(106,10). Round your answer to the nearest whole number.", "solution": "136666597", "difficulty": 50, "story": "Once upon a time in the small town of Arithmia, there lived a young aspiring mathematician named Emma. Emma was known for her love of numbers and her endless curiosity about the world around her. She would spend hours upon hours in her room, engrossed in solving complex mathematical problems and dreaming of one day becoming a renowned mathematician.\n\nOne fateful afternoon, as Emma was walking home from the local library, deep in thought about her latest mathematical conundrum, she stumbled upon an ancient-looking book lying on the sidewalk. Intrigued, she picked it up and brushed off the dust to reveal a title written in faded golden letters: \"The Enigma of Arithmia.\"\n\nEmma's eyes widened with excitement as she realized that this book might hold the answers to the mathematical riddle she had been struggling with. She hurriedly made her way back home, eager to delve into the mysterious pages.\n\nAs Emma settled into her comfortable armchair, ready to immerse herself in the secrets of the book, she came across a chapter titled \"The Urn of Possibilities.\" In this chapter, she found a mathematical problem she had never encountered before.\n\n\"This is it,\" Emma whispered to herself, feeling a thrill running down her spine. \"The key to unlocking a world of knowledge.\"\n\nThe problem described an urn filled with white balls, and in each turn, black balls were added and then a random selection of balls were removed. There was a specific formula mentioned, E(n,k), which represented the expectation of a certain calculation. Emma's eyes widened further when she noticed the example given: E(2,2) equaled 9.6.\n\nHer mind began to race with possibilities, trying to figure out the significance of this problem. Emma realized that it required not just her knowledge of mathematics, but also her creativity and critical thinking.\n\nDays turned into weeks, and Emma spent countless hours engrossed in the problem from the ancient book. She experimented with various mathematical equations, solving equations that had never been solved before, but the answer still eluded her.\n\nWith every passing day, Emma's sense of determination intensified. She reached out to other mathematicians, both near and far, searching for anyone who might hold the key to solving the puzzle. However, no one had ever encountered such a problem, and Emma realized that she was on a journey to unravel a mystery that seemed unsolvable.\n\nAs the years went by, Emma never gave up. She continued to explore the hidden depths of the mathematical problem, relentlessly pursuing every lead. The search took her to distant lands, where she met renowned mathematicians and discovered ancient manuscripts with arcane formulas.\n\nAnd so, my dear reader, here we find ourselves, on the edge of this enchanting tale. I must ask you: Can you solve the enigma that Emma stumbled upon? Can you find the value of E(106,10)? Round your answer to the nearest whole number.\n\nAs you ponder this question, remember that in the realm of numbers lies endless fascination, just as Emma found in her journey towards solving this mathematical problem."}, {"id": 789, "euler_id": 789, "title": "Minimal pairing modulo p", "problem": "Given an odd prime p, put the numbers 1,...,p\u22121 into p\u221212 pairs such that each number appears exactly once. Each pair (a,b) has a cost of abmodp. For example, if p=5 the pair (3,4) has a cost of 12mod5=2.\nThe total cost of a pairing is the sum of the costs of its pairs. We say that such pairing is optimal if its total cost is minimal for that p.\nFor example, if p=5, then there is a unique optimal pairing: (1,2),(3,4), with total cost of 2+2=4.\nThe cost product of a pairing is the product of the costs of its pairs. For example, the cost product of the optimal pairing for p=5 is 2\u22c52=4.\nIt turns out that all optimal pairings for p=2000000011 have the same cost product.\nFind the value of this product.", "solution": "13431419535872807040", "difficulty": 50, "story": "Once upon a time in the kingdom of Mathoria, there lived a young and brilliant mathematician named Amelia. Amelia's love for numbers was unmatched, and her mind constantly craved new challenges to solve. She could often be found in the garden, scribbling equations on a notepad, seeking the thrill of solving complex mathematical problems.\n\nOne sunny morning, as Amelia sat under the shade of a tall oak tree, she noticed a da Vinci-inspired raven soaring across the sky. The bird dropped a small scroll before disappearing into thin air. Curiosity piqued, Amelia quickly unraveled the parchment to find an intriguing mathematical problem.\n\nAs she read the given problem, her eyes lit up with excitement. Amelia had never encountered such a challenging task before. Determined to solve it, she set off on her journey to unravel the mystery. She knew this problem had the potential to change the way Mathoria approached mathematical pairings forever.\n\nWith her trusty quill and an inkpot, Amelia delved into the depths of her mathematical prowess. She spent countless nights analyzing patterns, generating formulas, and testing her hypotheses. Days turned into weeks, and weeks turned into months, but Amelia's perseverance never wavered.\n\nIn Mathoria, the people marveled at Amelia's unyielding dedication to her craft. The king heard tales of her genius and summoned Amelia to his majestic palace. The grand hall was adorned with intricate golden tapestries and sparkling chandeliers, an exquisite setting for a monumental occasion.\n\nAs Amelia stood before King Mathius, she presented her findings. She revealed that optimal pairings exist for any odd prime p, using the formula abmodp to determine the cost of each pair. Her voice filled the hall, her passion evident in every word she spoke.\n\nThe king, intrigued by this newfound knowledge, recognized the significance of Amelia's work. He knew that this mathematical revelation would improve the lives of his people and elevate Mathoria's status in the world of mathematics.\n\nAmelia's discovery soon spread far and wide. Scholars and mathematicians from neighboring kingdoms flocked to Mathoria, eager to understand and study her findings. They marveled at the beauty of her proofs and the elegance of her solutions.\n\nAmong the admirers was a young prince named Julian. He was captivated by Amelia's brilliance and was inspired to learn more about this mathematical problem. Determined to impress her, Julian embarked on a personal journey to solve the problem for the prime number p=2000000011.\n\nAs dawn broke over the kingdom, Julian secluded himself in the castle's library, surrounded by dusty tomes and scrolls. Page after page, the prince teased his mind, trying to decipher the secret hidden within the numbers. His calculations grew increasingly complex, but Julian was undeterred. He knew that finding the solution would be both a testament to his abilities and the key to Amelia's heart.\n\nMonths passed, and the kingdom eagerly anticipated Julian's revelation. The day finally arrived when Julian emerged from his self-imposed exile. With a gleam in his eyes, he stood before Amelia in the garden, where their paths had first crossed.\n\n\"Amelia,\" Julian began, his voice filled with determination. \"I have attempted to find the value of the cost product for the optimal pairing of p=2000000011. But alas, I am in need of your guidance.\"\n\nAmelia smiled, her heart filled with admiration for Julian's efforts. She knew that the value of the cost product was both a treasure and a puzzle waiting to be solved.\n\nAnd so, dear reader, as Amelia and Julian stood beneath the oak tree, their minds entwined in the realm of numbers, the question remains:\n\nWhat is the value of the cost product for the optimal pairing of p=2000000011?\n\nAs you join Amelia and Julian on their quest, you must now rise to the challenge and unravel the mysteries within the realm of numbers. Can you find the elusive answer and uncover the secret that awaits? The fate of Mathoria's mathematical legacy lies in your hands."}, {"id": 797, "euler_id": 797, "title": "Cyclogenic Polynomials", "problem": "A monic polynomial is a single-variable polynomial in which the coefficient of highest degree is equal to 1.\nDefine F to be the set of all monic polynomials with integer coefficients (including the constant polynomial p(x)=1). A polynomial p(x)\u2208F is cyclogenic if there exists q(x)\u2208F and a positive integer n such that p(x)q(x)=xn\u22121. If n is the smallest such positive integer then p(x) is n-cyclogenic.\nDefine Pn(x) to be the sum of all n-cyclogenic polynomials. For example, there exist ten 6-cyclogenic polynomials (which divide x6\u22121 and no smaller xk\u22121):\nx6\u22121x4+x3\u2212x\u22121x3+2x2+2x+1x2\u2212x+1x5+x4+x3+x2+x+1x4\u2212x3+x\u22121x3\u22122x2+2x\u22121x5\u2212x4+x3\u2212x2+x\u22121x4+x2+1x3+1\ngiving\nP6(x)=x6+2x5+3x4+5x3+2x2+5x\nAlso define\nQN(x)=\u2211n=1NPn(x)\nIt's given that\nQ10(x)=x10+3x9+3x8+7x7+8x6+14x5+11x4+18x3+12x2+23x and Q10(2)=5598.\nFind Q107(2). Give your answer modulo 1000000007.", "solution": "47722272", "difficulty": 50, "story": "Once upon a time in the bustling town of Mathville, there lived a brilliant and curious mathematician named Professor Euler. His mind was always abuzz with numbers and equations, seeking to unravel the mysteries of the mathematical world.\n\nOne sunny morning, as Professor Euler was going through his old dusty books, he stumbled upon a peculiar problem. It was about monic polynomials and their fascinating properties. The problem intrigued him, and he knew he had to solve it.\n\nDetermined, Professor Euler delved deep into his research, spending days and nights immersed in his calculations. The more he understood about these cyclogenic polynomials, the more his excitement grew. He found that they possessed unique qualities unlike any other polynomials he had previously encountered.\n\nThen a thought struck him. What if he could find the sum of these fascinating cyclogenic polynomials? Professor Euler set out on a mission to uncover the secrets hidden within the cyclogenic world.\n\nAs weeks turned into months, Professor Euler tirelessly explored the realm of monic polynomials. He discovered intricate connections between various polynomials, their coefficients, and the exponents that held secret patterns. It was like a symphony of numbers playing in his mind.\n\nOne quiet evening, when the sun was setting, Professor Euler made a breakthrough. He had finally found a method to calculate Pn(x), the sum of all n-cyclogenic polynomials. The solution seemed almost magical, as if it held the key to unlock the secrets of the universe.\n\nOverjoyed, Professor Euler couldn't wait to understand the implications of his discovery. He realized that by summing the cyclogenic polynomials, he could obtain a new polynomial, which he called QN(x). This QN(x) was something extraordinary, a representation of the entire cyclogenic polynomial world.\n\nAs Professor Euler further analyzed QN(x), he noticed a fascinating property. Every time he substituted the value of 2 in Q10(x), the result was 5598. This revelation astounded him. It was as though the numbers were whispering secrets only he could understand.\n\nBut the relentless mathematician was not satisfied. He craved more. He wanted to know what Q107(2) would be. How would the numbers interplay and evolve as he increased the value of n? What hidden patterns would emerge? What profound discoveries lay in wait?\n\nWith eager anticipation in his heart, Professor Euler pondered the elusive Q107(2). He knew this answer would be a masterpiece, a culmination of his dedication to the world of mathematics. But alas, the answer eluded him still.\n\nSo, dear reader, the story of Professor Euler's quest ends here, and the journey continues to find Q107(2). Can you, the brilliant mathematician in your own right, solve this intricate puzzle? What secrets and patterns will be revealed as you navigate the intricate world of cyclogenic polynomials? What will Q107(2) be when expressed modulo 1000000007?\n\nNow, I pose this question to you, dear reader: What is Q107(2)?"}, {"id": 799, "euler_id": 799, "title": "Pentagonal Puzzle", "problem": "\nPentagonal numbers are generated by the formula: Pn=12n(3n\u22121) giving the sequence:\n\n1,5,12,22,35,51,70,92,\u2026\n\nSome pentagonal numbers can be expressed as the sum of two other pentagonal numbers.\nFor example:\n\nP8=92=22+70=P4+P7\n\n3577 is the smallest pentagonal number that can be expressed as the sum of two pentagonal numbers in two different ways\n\nP49=3577=3432+145=P48+P10=3290+287=P47+P14\n\n107602 is the smallest pentagonal number that can be expressed as the sum of two pentagonal numbers in three different ways.\n\n\nFind the smallest pentagonal number that can be expressed as the sum of two pentagonal numbers in over 100 different ways.\n", "solution": "1096910149053902", "difficulty": 50, "story": "Once upon a time, in the bustling city of Mathville, lived a curious and ambitious mathematician named Ethan. He was renowned for his exceptional problem-solving abilities and relentless pursuit of new mathematical frontiers. One day, while strolling through the city's famous Math Square, Ethan stumbled upon an enigmatic riddle.\n\nA local mathematician had posted it on a bulletin board, capturing the attention of passersby. The riddle intrigued Ethan, who deduced that it involved the esoteric field of pentagonal numbers. It stated that some pentagonal numbers could be expressed as the sum of two other pentagonal numbers. The riddle specifically mentioned a few examples, including the smallest pentagonal number that could be expressed in over 100 different ways.\n\nEthan's eyes sparkled with excitement. He realized that uncovering the solution to this perplexing problem would elevate his status in the mathematical community. Determined to crack the riddle's code, he embarked on an intense journey of numerical exploration.\n\nAs the days turned into weeks, Ethan delved deeper into the world of pentagonal numbers. He pored over ancient texts, consulted with fellow mathematicians, and even dreamed of various equations and formulas. The allure of finding the elusive solution consumed his every thought.\n\nThrough countless nights of insomnia, Ethan scribbled equations on his chalkboard until his hands ached. He discovered that pentagonal numbers could be represented by the formula: Pn=12n(3n\u22121). Armed with this knowledge, he fervently tested different values for 'n', determined to find a pentagonal number that fulfilled the riddle's criteria.\n\nDays turned into months, and finally, after relentless perseverance, Ethan found his breakthrough. He stumbled upon the smallest pentagonal number that could be expressed as the sum of two pentagonal numbers in over 100 different ways. The exhilaration was overwhelming, and a sense of accomplishment washed over him. But then, doubt crept in.\n\nEthan realized that, in his frenzied quest to unlock the riddle's answer, he had lost sight of the reason behind his passion for mathematics. He had become so consumed by the pursuit of solving this puzzle that he had forgotten the importance of fostering curiosity and sharing knowledge with others. This revelation hit him like an awakening, igniting a newfound clarity within his mind.\n\nAs he pondered the depths of his ambition, Ethan looked at the riddle one last time, etching its words into his memory. He decided to embark on a different path, one that would inspire others to explore and appreciate the beauty of mathematics. The question held the key to this new endeavor.\n\nWith a renewed sense of purpose, Ethan decided not to reveal the solution to the mathematical problem in his short story. Instead, he concluded the narrative with a stimulating question: \"Can you find the smallest pentagonal number that can be expressed as the sum of two pentagonal numbers in over 100 different ways?\"\n\nThis question, he hoped, would ignite a spark within those who encountered it, encouraging them to embrace the wonders of mathematics and embark on their own journeys of discovery. While Ethan may have found the solution himself, he understood that it was the journey that truly mattered, and he wished to share this sentiment with the world.\n\nAnd so, the legacy of Ethan, the mathematician who found solace in questions rather than answers, lived on in the hearts and minds of those inspired by his story."}, {"id": 801, "euler_id": 801, "title": "xy\u2261yx", "problem": "The positive integral solutions of the equation xy=yx are (2,4), (4,2) and (k,k) for all k>0.\nFor a given positive integer n, let f(n) be the number of integral values 0<x,y\u2264n2\u2212n such that\nxy\u2261yx(modn)\nFor example, f(5)=104 and f(97)=1614336.\nLet S(M,N)=\u2211f(p) where the sum is taken over all primes p satisfying M\u2264p\u2264N.\nYou are given S(1,102)=7381000 and S(1,105)\u2261701331986(mod993353399).\nFind S(1016,1016+106). Give your answer modulo 993353399.", "solution": "638129754", "difficulty": 50, "story": "Once upon a time in the kingdom of Numeria, there lived a brilliant mathematician named Professor Euler. Professor Euler was renowned for his ability to solve the most complex mathematical problems with ease. His reputation had spread far and wide, and people from all walks of life sought his expertise.\n\nOne sunny morning, as Professor Euler was enjoying his cup of tea, a young boy named Oliver rushed into his study. With a look of curiosity in his eyes, Oliver exclaimed, \"Professor Euler, I heard that you are the wisest mathematician in the land. Can you help me solve a problem?\"\n\nIntrigued, Professor Euler set aside his cup of tea and smiled warmly at Oliver. \"Of course, my young friend. What seems to be the problem?\" he asked.\n\nOliver took a deep breath before launching into his question. \"I have recently discovered a mathematical problem that has been puzzling me. It involves the equation xy = yx, where x and y are positive integers. I have found the solutions (2, 4) and (4, 2) for this equation. However, I am curious to know how many more solutions there are for a given positive integer, n.\"\n\nProfessor Euler's eyes sparkled with excitement. He had encountered this particular problem during his studies in his youth. The equation xy = yx, often referred to as the commutative property of multiplication, was an intriguing concept. It stated that the order of numbers in a multiplication equation did not matter as long as the numbers involved were positive integers.\n\n\"My young friend, you have stumbled upon a fascinating problem indeed,\" Professor Euler exclaimed. \"In your question, you mentioned the function f(n), which represents the number of integral values of x and y satisfying the equation xy \u2261 yx (mod n). Would you like to find the value of f(n) for a specific positive integer?\"\n\nOliver's eyes widened with anticipation. \"Yes, Professor Euler! I would like to know how many integral values of x and y, both ranging from 1 to n^2 - n, satisfy this equation.\"\n\nProfessor Euler pondered the question for a moment, the gears in his brilliant mind turning. He thought back to his extensive knowledge of number theory and modular arithmetic, considering various approaches to solving the problem.\n\n\"It is a fascinating challenge, Oliver,\" Professor Euler mused, his voice tinged with excitement. \"Finding the number of integral solutions to this equation for a given positive integer, n, requires careful analysis. Each solution is like a small piece of a puzzle that, when complete, will reveal the true nature of this equation.\"\n\nAs Oliver listened intently, Professor Euler continued, \"This problem also extends beyond individual values of n. We can explore a larger domain by considering the summation of f(p) over all primes p, where p lies between two given values, M and N. This function, denoted as S(M,N), allows us to comprehend the behavior of the equation xy \u2261 yx (mod n) on a grand scale.\"\n\nOliver's eyes widened in awe. He had not expected the problem to be so profound. The implications of Professor Euler's words began to sink in, and he realized how crucial finding the value of S(M,N) could be in understanding this enigmatic equation.\n\nAfter some calculations and intense discussions, the duo determined that S(1, 102) equaled 7,381,000. This information intrigued them, but their appetite for knowledge was unsatisfied.\n\nProfessor Euler and Oliver continued their exploration, pushing the boundaries of their understanding. They discovered that S(1, 105) was congruent to 701,331,986 modulo 993,353,399. The vastness of this number amazed them, and it left them yearning for more.\n\nDetermined to uncover greater mysteries, Professor Euler and Oliver now set their sights on surmounting a new challenge: finding S(10^16, 10^16+10^6) modulo 993,353,399. They understood that this task would require unrelenting dedication and the combined brilliance of their minds.\n\nAs they embarked on their mathematical journey, their excitement grew exponentially. What secrets would the equation xy \u2261 yx (mod n) reveal on this extraordinary exploration? How would S(10^16, 10^16+10^6) manifest itself modulo 993,353,399?\n\nWith fervor in their hearts and numbers dancing in their minds, Professor Euler and Oliver delved deeper into the mathematical realm, eager to conquer the mystery that awaited them.\n\nAnd so, dear reader, the question falls upon you: Can you solve the mathematical problem? What is the value of S(10^16, 10^16+10^6) modulo 993,353,399? Can you unveil the secrets hidden within the equation xy \u2261 yx (mod n)?\n\nThe challenge awaits."}, {"id": 814, "euler_id": 814, "title": "Mezzo-forte", "problem": "\n4n people stand in a circle with their heads down. When the bell rings they all raise their heads and either look at the person immediately to their left, the person immediately to their right or the person diametrically opposite. If two people find themselves looking at each other they both scream.\n\nDefine S(n) to be the number of ways that exactly half of the people scream. You are given S(1)=48 and S(10)\u2261420121075mod998244353.\n\nFind S(103). Enter your answer modulo 998244353.", "solution": "307159326", "difficulty": 50, "story": "Once upon a time in the small village of Numeria, a group of friends gathered in the town square. Mathilda, the town's beloved mathematician, was known for her love of numbers and puzzles. She always sought to entertain her friends, and tonight was no different.\n\nAs the sun set, Mathilda called the group to attention and posed a perplexing challenge. \"My dear friends, tonight we shall explore a mathematical conundrum,\" she announced with a gleam in her eye. \"Imagine a circle in which 4n people stand with their heads down. When a bell rings, they raise their heads and choose whom to look at: their left neighbor, their right neighbor, or the person diametrically opposite. If two people find themselves looking at each other, they both scream.\"\n\nThe villagers chuckled at the amusing image Mathilda painted in their minds. \"But Mathilda, tell us, how many ways are there for exactly half of the people to scream?\" inquired Samuel, a curious young man.\n\nWithout missing a beat, Mathilda replied, \"Ah, my dear Samuel, that is the very question we shall pursue tonight. For now, let us envision the tale of the village's annual celebration, where this peculiar game became renowned.\"\n\nThe villagers leaned in closer, eager to hear the story unfold.\n\n\"Legend has it that deep in the heart of the forest, there lived a mischievous magical creature named Riddle. Every year, during the festival, Riddle would enchant the villagers with his mind-bending challenges. And so, the game of the screaming circle was born.\"\n\nMathilda continued, her voice filled with intrigue. \"In the first year of the festival, Riddle enchanted the entire village, and 48 different arrangements were found for half of the people to scream. The villagers were astounded, yet Riddle's puzzles only grew more challenging with each passing year.\"\n\nThe villagers listened with bated breath, wondering how Riddle's enchantments would evolve.\n\n\"Ten years later, Riddle struck again,\" Mathilda said dramatically. \"This time, he ensured that the number of arrangements for half of the people to scream was congruent to 420121075, modulo 998244353.\"\n\nThe villagers gasped, realizing the complexity of the puzzle they faced. They knew Mathilda had a knack for infusing enchantment into their lives, but this mathematical conundrum had taken them by surprise.\n\n\"I present to you a question, my dear friends,\" Mathilda said, locking eyes with each villager. \"If Riddle's enchantments continued to increase in difficulty, what would be the number of arrangements for exactly half of the people to scream in the one hundred and third year of the festival?\"\n\nSilence fell upon the villagers as they pondered the magnitude of the problem. They realized that Mathilda's challenge held the key to unraveling Riddle's enchantments and preserving their beloved festival.\n\nAnd so, the villagers set forth, minds bursting with curiosity, ready to decipher the complex web of numbers woven by Riddle's enigmatic magic.\n\nBut now, my dear reader, I ask you: can you discover the answer to Mathilda's question? What is the number of arrangements for exactly half of the people to scream in the one hundred and third year of the festival? Enter your answer modulo 998244353, and let the tale of Numeria carry you on a mathematical adventure."}, {"id": 823, "euler_id": 823, "title": "Factor Shuffle", "problem": "A list initially contains the numbers 2,3,\u2026,n.\nAt each round, every number in the list is divided by its smallest prime factor. Then the product of these smallest prime factors is added to the list as a new number. Finally, all numbers that become 1 are removed from the list.\nFor example, below are the first three rounds for n=5:\n[2,3,4,5]\u2192(1)[2,60]\u2192(2)[30,4]\u2192(3)[15,2,4].\nLet S(n,m) be the sum of all numbers in the list after m rounds.\nFor example, S(5,3)=15+2+4=21. Also S(10,100)=257.\nFind S(104,1016). Give your answer modulo 1234567891.", "solution": "865849519", "difficulty": 50, "story": "Once upon a time, in the magical kingdom of Numeria, there lived a wise but eccentric mathematician named Professor Arithmos. He was renowned for his ability to solve even the most complex numerical conundrums. One day, as he sat in his study, engrossed in his latest mathematical quest, the door creaked open, revealing a young boy named Jack.\n\nJack was a curious lad, always seeking adventure and knowledge. He had wandered into Professor Arithmos' study, eager to learn something new. The professor looked up from his books and smiled warmly at the intruder.\n\n\"Ah, young Jack! What brings you here today?\" the professor asked, his eyes twinkling with excitement.\n\n\"I've heard tales of your fascinating puzzles, Professor Arithmos,\" Jack replied. \"I want to challenge my mind and unravel the mysteries of mathematics. Can you teach me something incredible?\"\n\nThe professor's grin widened as an idea sprouted in his mind. \"Indeed, I have just the puzzle for you, Jack,\" he said, tapping his quill on a page filled with numbers and calculations. \"Have a seat, and listen carefully.\"\n\nJack eagerly took a seat while the professor explained a peculiar problem. He detailed the process of dividing a list of numbers by their smallest prime factors, adding new numbers to the list along the way. The professor's eyes sparkled with excitement as he described the rounds and how all the ones were eventually removed.\n\n\"Each round, the list evolves, and the numbers change. It's a fascinating experiment that demonstrates the power and intricacy of numbers,\" the professor explained. \"You must calculate the sum of all the numbers in the list after m rounds, given n as the starting point.\"\n\nAs Jack's mind absorbed the mathematical problem, he couldn't help but visualize the numbers dancing in his mind. They multiplied, divided, and formed new patterns, engaging his every thought. The story within the numbers began to unfold like a magic tale.\n\nThe young boy's heart raced as he immersed himself in the problem, discovering patterns, and making connections. Days turned into weeks, and weeks turned into months as Jack delved deeper into the cryptic puzzle. He found solace in his newfound love for numbers, each round of calculations unraveling a new secret.\n\nThe professor watched proudly as Jack poured his heart and soul into the puzzle. He knew that the young boy had embarked on a journey of discovery, one that would change his life forever. Jack's eyes sparkled with determination, and his mind embraced the complexities that lay before him.\n\nFinally, after endless hours of calculations, Jack reached a breakthrough. He leaped from his chair, elated, and rushed to share his findings with Professor Arithmos. The professor listened intently, his eyes gleaming with admiration for his protege.\n\n\"You've done it, young Jack!\" the professor exclaimed. \"You've cracked the code, unearthed the secrets hidden within the numbers.\"\n\nJack beamed with pride, his heart full of accomplishment. But within the joy, a single question burned in his mind, a question that the professor had planted unknowingly. He turned to face the professor, his voice filled with excitement.\n\n\"Professor, I have found the solution to the mathematical problem you presented, but now I can't help but wonder... Can you solve it too?\" Jack asked, his eyes twinkling mischievously.\n\nThe professor chuckled softly, his eyes twinkling like stars. \"Ah, Jack, my brilliant student, the answer lies within you. The journey you've undertaken, the knowledge you've acquired, it is yours to uncover. The question I pose to you is not for me to answer, but for you to discover and embrace.\"\n\nJack pondered the professor's words, his mind swirling with possibilities. Could he truly find the answer within himself? He realized that the professor had not just given him a mathematical problem but had ignited a passion for exploration and a thirst for knowledge.\n\nAnd so, with a renewed determination and the professor's wisdom guiding him, Jack set forth on a quest through the enchanted kingdom of Numeria. Armed with the power of numbers and an insatiable curiosity, he ventured forth to solve the puzzle that had captured his heart.\n\nWhat is S(104,1016)? Can you find the answer hidden within the intricate dance of numbers, just as Jack did?"}]