[{"id": 126, "euler_id": 126, "title": "Cuboid layers", "problem": "The minimum number of cubes to cover every visible face on a cuboid measuring 3\u00a0x\u00a02\u00a0x\u00a01 is twenty-two.\n\n\nIf we then add a second layer to this solid it would require forty-six cubes to cover every visible face, the third layer would require seventy-eight cubes, and the fourth layer would require one-hundred and eighteen cubes to cover every visible face.\nHowever, the first layer on a cuboid measuring 5\u00a0x\u00a01\u00a0x\u00a01 also requires twenty-two cubes; similarly the first layer on cuboids measuring 5\u00a0x\u00a03\u00a0x\u00a01, 7\u00a0x\u00a02\u00a0x\u00a01, and 11\u00a0x\u00a01\u00a0x\u00a01 all contain forty-six cubes.\nWe shall define C(n) to represent the number of cuboids that contain n cubes in one of its layers. So C(22) = 2, C(46) = 4, C(78) = 5, and C(118) = 8.\nIt turns out that 154 is the least value of n for which C(n) = 10.\nFind the least value of n for which C(n) = 1000.", "solution": "18522", "difficulty": 55, "story": "Once upon a time in the bustling city of Numeropolis, lived a young and inquisitive girl named Alice. Alice had always been fascinated by numbers and patterns, spending hours on end tinkering with her toy blocks, trying to create unique structures. Little did she know, her curiosity would lead her on an adventure that would forever change her perspective on the world.\n\nOne sunny afternoon, while Alice was strolling through the city park, she stumbled upon an old, dusty book lying beneath a towering oak tree. Intrigued, she gingerly picked it up and noticed the title etched in golden font: \"The Mysteries of Cuboidal Patterns.\"\n\nAlice's eyes sparkled with excitement as she flipped through the pages, soaking in the mathematical marvels hidden within. The book revealed the peculiar properties of cuboids, specifically the different arrangements that could be formed by layering cubes on their faces.\n\nOne mathematical problem caught Alice's attention, filling her with a sense of wonder. According to the book, the minimum number of cubes required to cover every visible face on a cuboid measuring 3 x 2 x 1 was twenty-two. As Alice pondered this, her mind began to race with questions. Why twenty-two? What other cuboids shared this unique property?\n\nDriven by her insatiable thirst for knowledge, Alice embarked on a quest to solve the mysteries of cuboidal patterns. She roamed the city, seeking guidance from renowned mathematicians and architects, all of whom were captivated by her passion for numbers.\n\nWith each day that passed, Alice's understanding deepened. She discovered that adding a second layer to the solid would require forty-six cubes to cover every visible face. The third layer would require seventy-eight cubes, and the fourth layer an astonishing one-hundred and eighteen cubes.\n\nAs Alice delved further into her research, she uncovered more fascinating cuboids. The first layer on a cuboid measuring 5 x 1 x 1 also required twenty-two cubes. She observed that the first layer on cuboids measuring 5 x 3 x 1, 7 x 2 x 1, and even 11 x 1 x 1 all contained forty-six cubes.\n\nOver time, Alice compiled a list of the number of cuboids that contained a specific number of cubes in one of its layers. She labeled this function C(n), where n represented the number of cubes. For instance, C(22) equaled 2, C(46) equaled 4, C(78) equaled 5, and C(118) equaled 8.\n\nArmed with her newfound knowledge, Alice was determined to uncover new patterns and learn the secrets locked within the cuboidal world. Countless days and nights were spent examining various cuboids of different dimensions, scribbling equations and observations in her trusty notebook.\n\nAnd then it happened. Alice's heart skipped a beat as she discovered a startling revelation. The least value of n for which C(n) equaled 10 was 154. The significance of this finding sent shivers down her spine. It was a eureka moment, a glimpse into the profound order hidden within all those cubes.\n\nBut Alice's journey didn't end there. Her insatiable hunger for knowledge led her to wonder, what would be the least value of n for which C(n) equaled 1000? What grandeur awaited her if she dared to dive deeper into the mathematical rabbit hole?\n\nAs Alice closed the book, her eyes gleaming with determination, she knew that this was just the beginning. She couldn't wait to continue her exploration of cuboidal patterns, to unravel the secrets of the mathematical universe that lay waiting to be discovered.\n\nAnd so, dear reader, I leave you with the same question that echoed in Alice's mind, urging you to join her on this mesmerizing adventure: What is the least value of n for which C(n) equals 1000?"}, {"id": 128, "euler_id": 128, "title": "Hexagonal tile differences", "problem": "A hexagonal tile with number 1 is surrounded by a ring of six hexagonal tiles, starting at \"12 o'clock\" and numbering the tiles 2 to 7 in an anti-clockwise direction.\nNew rings are added in the same fashion, with the next rings being numbered 8 to 19, 20 to 37, 38 to 61, and so on. The diagram below shows the first three rings.\n\n\nBy finding the difference between tile n and each of its six neighbours we shall define PD(n) to be the number of those differences which are prime.\nFor example, working clockwise around tile 8 the differences are 12, 29, 11, 6, 1, and 13. So PD(8) = 3.\nIn the same way, the differences around tile 17 are 1, 17, 16, 1, 11, and 10, hence PD(17) = 2.\nIt can be shown that the maximum value of PD(n) is 3.\nIf all of the tiles for which PD(n) = 3 are listed in ascending order to form a sequence, the 10th tile would be 271.\nFind the 2000th tile in this sequence.", "solution": "14516824220", "difficulty": 55, "story": "Once upon a time, in a land known as Mathematica, there was a brilliant young mathematician named Alice. From a young age, Alice had always been fascinated by patterns and numbers, constantly finding ways to incorporate them into her everyday life.\n\nOne sunny morning, as Alice sat on her window sill, her eyes caught sight of a peculiar hexagonal tile in her garden. Imprinted on the tile was the number 1, shining brightly in the morning sun. It immediately caught her attention, and she wondered if there was more to it than meets the eye.\n\nCuriosity ignited, Alice raced downstairs and rushed into her garden to investigate. Surrounding the central tile were six neighboring hexagonal tiles, each with a number imprinted on it. From the top, they were numbered in an anti-clockwise direction - 2, 3, 4, 5, 6, and 7. It was clear to Alice that these numbers were arranged in a specific pattern.\n\nHer mind swirled with ideas, and she began to unravel the beauty hidden within this arrangement. Alice noticed that new rings of hexagonal tiles were added, extending outwards from the central tile, each with a unique sequence of numbers. The second ring contained tiles numbered 8 to 19, the third ring had tiles numbered 20 to 37, and so on.\n\nEager to uncover the secrets of this mathematical puzzle, Alice pondered on how she could measure the differences between each tile and its six neighbors. The differences would allow her to define a new function, PD(n), which could reveal further patterns and connections.\n\nTaking a deep breath, Alice began her quest, working around the central tile and its neighbors to calculate the differences. With each iteration, she recorded the number of differences that were prime. PD(n) was officially born.\n\nAs she continued exploring the tiles, Alice realized that PD(n) could be used to measure the intricacy and uniqueness of each tile's position within the pattern. The maximum value of PD(n) was limited to 3, but those tiles that achieved this value possessed something extraordinary.\n\nDays turned into weeks, and Alice's excitement grew exponentially with every new discovery. The sequence of tiles with PD(n) equal to 3 fascinated her the most. These tiles had a distinct quality that begged further investigation.\n\nAfter endless calculations and countless sleepless nights, Alice eventually fashioned an ascending sequence of all the tiles embodying PD(n) equal to 3. Each tile, meticulously arranged in order, held a profound significance within the pattern she was unraveling.\n\nMaking sense of this sequence became a near-obsession for Alice. She longed to understand every connection, every hidden relationship between the tiles. Hours were spent pouring over her findings, analyzing the patterns that emerged.\n\nThe journey was arduous, and at times Alice doubted herself. But with unwavering determination, she persevered. No number was left unchecked, no equation left unsolved. Alice knew that within this sequence lay the key to unlocking the true beauty of the pattern.\n\nFinally, after months of tireless work, Alice found herself on the brink of a breakthrough. The magic number she sought was within her grasp, waiting patiently at the 2000th tile of the sequence she had so diligently constructed. A thrilling sensation pulsed through her veins, for she knew that solving this final piece of the puzzle would reveal the pattern's ultimate secret.\n\nNow, dear reader, I must turn to you. As Alice stands on the precipice of discovery, the question remains: What is the value assigned to the 2000th tile in the sequence she so meticulously constructed? Only you hold the power to solve this mathematical problem and unlock the hidden wonders of Alice's journey."}, {"id": 140, "euler_id": 140, "title": "Modified Fibonacci golden nuggets", "problem": "Consider the infinite polynomial series AG(x)=xG1+x2G2+x3G3+\u22ef, where Gk is the kth term of the second order recurrence relation Gk=Gk\u22121+Gk\u22122, G1=1 and G2=4; that is, 1,4,5,9,14,23,\u2026 .\nFor this problem we shall be concerned with values of x for which AG(x) is a positive integer.\nThe corresponding values of x for the first five natural numbers are shown below.\n\nxAG(x)\n5\u2212141\n252\n22\u2212263\n137\u22125144\n125\n\nWe shall call AG(x) a golden nugget if x is rational, because they become increasingly rarer; for example, the 20th golden nugget is 211345365.\nFind the sum of the first thirty golden nuggets.", "solution": "5673835352990", "difficulty": 55, "story": "Once upon a time, in the picturesque town of Mathville, there lived a young prodigy named Milo. Milo had always been fascinated by the intricacies of numbers, patterns, and puzzles. He spent countless hours exploring the mysteries of mathematics, but there was one problem that had captured his imagination more than anything else \u2013 the golden nugget conundrum.\n\nEvery evening, as the sun set over the rolling hills, Milo would slip away to his secret hideaway in the quiet meadow behind his house. It was here that he would ponder the elusive golden nugget problem. Resting beneath an ancient oak tree, he would open his notebook, filled with scrawls and equations, and immerse himself in deep thought.\n\nOne evening, as Milo sat beneath the oak tree, the wind rustling through the leaves, he had an epiphany. Like a sudden flash of brilliance, the answer appeared before his eyes. He jumped up, his heart racing with excitement, knowing that he had stumbled upon something truly unique.\n\nWord of Milo's discovery spread like wildfire, reaching the ears of Professor Adelaide, a renowned mathematician known for her sharp intellect and insatiable curiosity. Professor Adelaide invited Milo to present his findings at the annual math symposium, where scholars from all over the world gathered to exchange ideas.\n\nOn the day of the symposium, a nervous but determined Milo stood before a sea of expectant faces. His presentation was met with thunderous applause as he explained his breakthrough. AG(x) was the infinite polynomial series he had discovered, and the golden nuggets were the values of x for which AG(x) became a positive integer.\n\nAs the symposium came to a close, Professor Adelaide approached Milo with a twinkle in her eye. \"Young Milo, I have been struck by your extraordinary talent and your dedication to uncovering mathematical truths. I propose a challenge.\"\n\nMilo's heart skipped a beat. He had always admired Professor Adelaide and relished the opportunity to prove himself to her. \"What is the challenge, Professor?\" he asked, eager to accept any task coming his way.\n\nThe professor smiled, her gaze fixed on Milo's notebook. \"I would like you to find the sum of the first thirty golden nuggets,\" she said, her voice filled with intrigue.\n\nMilo's eyes widened. He had never attempted such a complex problem before, but he knew this was his chance to shine. With renewed determination burning in his heart, Milo set out to embark on a new mathematical adventure, armed with his knowledge, curiosity, and the belief that anything was possible.\n\nNow it's your turn, dear reader. Can you solve the puzzle that has captivated Milo and Professor Adelaide? Can you find the sum of the first thirty golden nuggets? As you dive into the depths of mathematical reasoning, let your imagination soar and uncover the secrets that lie within the infinite polynomial series AG(x). The challenge awaits, and the journey promises to be nothing short of extraordinary. Can you crack the code and find the answer?\n\nOnly time will tell."}, {"id": 150, "euler_id": 150, "title": "Searching a triangular array for a sub-triangle having minimum-sum", "problem": "In a triangular array of positive and negative integers, we wish to find a sub-triangle such that the sum of the numbers it contains is the smallest possible.\nIn the example below, it can be easily verified that the marked triangle satisfies this condition having a sum of \u221242.\n\n\nWe wish to make such a triangular array with one thousand rows, so we generate 500500 pseudo-random numbers sk in the range \u00b1219, using a type of random number generator (known as a Linear Congruential Generator) as follows:\nt := 0\n\nfor k = 1 up to k = 500500:\n\n\u00a0 \u00a0 t := (615949*t + 797807) modulo 220\n\u00a0 \u00a0 sk := t\u2212219\nThus: s1 = 273519, s2 = \u2212153582, s3 = 450905 etc\nOur triangular array is then formed using the pseudo-random numbers thus:\n\ns1\ns2\u00a0 s3\ns4\u00a0 s5\u00a0 s6\u00a0 \n\ns7\u00a0 s8\u00a0 s9\u00a0 s10\n...\n\nSub-triangles can start at any element of the array and extend down as far as we like (taking-in the two elements directly below it from the next row, the three elements directly below from the row after that, and so on).\n\nThe \"sum of a sub-triangle\" is defined as the sum of all the elements it contains.\n\nFind the smallest possible sub-triangle sum.", "solution": "-271248680", "difficulty": 55, "story": "Once upon a time, in the mystical land of Numeria, there lived a young mathematician named Marcus. Marcus was known throughout the kingdom for his exceptional problem-solving skills and his uncanny ability to find solutions to the most perplexing mathematical puzzles.\n\nOne day, Marcus received a mysterious message from the King of Numeria. The message spoke of a triangular array, teeming with positive and negative integers, hidden deep in the heart of the kingdom. It was said that within this array lay a sub-triangle whose sum was the smallest possible. The King believed that finding this sub-triangle held the key to unlocking the wisdom of the ancients.\n\nIntrigued by the challenge, Marcus set out on a quest to locate the elusive triangular array. Armed with his trusty notebook and an insatiable thirst for knowledge, he ventured into the ancient forest known as the Mathemagical Grove. Legend had it that within the grove laid the answers to all mathematical mysteries.\n\nAs Marcus delved deeper into the grove, he stumbled upon a crumbling stone tablet etched with a series of equations. The tablet revealed a peculiar formula, known as the Linear Congruential Generator, which would generate pseudo-random numbers. The formula fascinated Marcus, and he quickly realized that these numbers were the key to unveiling the triangular array.\n\nEager to put his newfound knowledge to use, Marcus began generating the pseudo-random numbers as instructed by the formula. Each number was carefully calculated, and he meticulously filled the triangular array to perfection.\n\nDays turned into weeks as Marcus labored over the intricate design of the triangular array. The kingdom watched in anticipation, for they knew that Marcus, with his mathematical genius, would soon reveal the sub-triangle with the smallest sum.\n\nFinally, after countless hours of painstaking work, Marcus completed the triangular array. As he stood back to admire his creation, he noticed a particular section that seemed to beckon him. It was a small, unassuming sub-triangle near the top of the array, barely noticeable among the countless numbers.\n\n\"I wonder,\" Marcus murmured to himself, pondering the significance of this unassuming sub-triangle. \"Could this be the one the King spoke of?\"\n\nA rush of excitement surged through Marcus's veins as he calculated the sum of the sub-triangle. The numbers revealed a sum of -42, validating Marcus's intuition and confirming that this sub-triangle had indeed the smallest possible sum.\n\nBut the story didn't end there. Marcus knew that the real challenge lay beyond his own discovery. He had to share this mathematical puzzle with the world, so that others could embark on this fascinating journey of exploration and discovery.\n\nTherefore, dear reader, I leave you with a question: Can you find the smallest possible sub-triangle sum? Will you follow Marcus's path and unravel the wisdom hidden within the triangular array? The answers lie within your grasp, waiting to be discovered."}, {"id": 158, "euler_id": 158, "title": "Exploring strings for which only one character comes lexicographically after its neighbour to the left", "problem": "Taking three different letters from the 26 letters of the alphabet, character strings of length three can be formed.\nExamples are 'abc', 'hat' and 'zyx'.\nWhen we study these three examples we see that for 'abc' two characters come lexicographically after its neighbour to the left. \nFor 'hat' there is exactly one character that comes lexicographically after its neighbour to the left. For 'zyx' there are zero characters that come lexicographically after its neighbour to the left.\nIn all there are 10400 strings of length 3 for which exactly one character comes lexicographically after its neighbour to the left.\nWe now consider strings of n \u2264 26 different characters from the alphabet. \nFor every n, p(n) is the number of strings of length n for which exactly one character comes lexicographically after its neighbour to the left.\nWhat is the maximum value of p(n)?", "solution": "409511334375", "difficulty": 55, "story": "Once upon a time, in the small town of Numeria, there lived a young and imaginative girl named Alice. Alice had always been fascinated by numbers and patterns, finding solace in the world of mathematics. Every day, she would spend hours exploring countless mathematical puzzles and riddles, seeking the thrill that came from unraveling their secrets.\n\nOne warm summer evening, as the sun bathed Numeria in a golden glow, Alice's curiosity piqued as she stumbled upon a fascinating problem. Taking a break from her usual riddles, she delved into the enchanting world of character strings. The problem she discovered read as follows:\n\n\"Taking three different letters from the 26 letters of the alphabet, character strings of length three can be formed. Examples are 'abc,' 'hat,' and 'zyx.' When we study these three examples, we see that for 'abc,' two characters come lexicographically after its neighbor to the left. For 'hat,' there is exactly one character that comes lexicographically after its neighbor to the left. For 'zyx,' there are zero characters that come lexicographically after its neighbor to the left. In all, there are 10,400 strings of length 3 for which exactly one character comes lexicographically after its neighbor to the left. We now consider strings of n \u2264 26 different characters from the alphabet. For every n, p(n) is the number of strings of length n for which exactly one character comes lexicographically after its neighbor to the left. What is the maximum value of p(n)?\"\n\nAlice's eyes sparkled with excitement. She couldn't resist the allure of this mathematical enigma. Determined to uncover its secrets, she set out on a journey, both in her imagination and the realms of reality.\n\nAs she roamed Numeria's streets, Alice couldn't help but notice how the townspeople interconnected with each other. The baker supplied fresh loaves of bread to the grocer, who in turn provided the ingredients for the chef. The entire town buzzed with harmony, as each person had a distinct role to play.\n\nIntrigued by this web of connections, Alice returned home and delved deeper into the problem. She realized that the characters in the strings, like the town's inhabitants, also had connections. In order to solve the puzzle, she had to understand these relationships and how they influenced the occurrences of characters coming lexicographically after their neighbors.\n\nDays turned into weeks, and Alice's dedication to the problem grew exponentially. She began constructing elaborate charts and graphs, mapping out the complex connections between the characters. As she uncovered the unique patterns in each string, she saw the beauty and logic within the chaos.\n\nOne fateful day, as Alice sat on a park bench, sketching another diagram, a gentle breeze brushed against her face. She looked up from her work to find an elderly man sitting beside her. His eyes crinkled with kindness, and a knowing smile played on his lips.\n\n\"In your search for knowledge, young Alice, have you found what you seek?\" the man asked, his voice carrying a hint of wisdom.\n\nAlice looked at him, surprised by his accurate observation. \"I'm on a quest to discover the maximum value of p(n),\" she replied. \"I want to understand the essence of this mathematical problem and find a solution. Can you help me?\"\n\nThe old man chuckled, his laughter dancing through the air like music. \"My dear Alice, the answer you seek lies within the echoes of your own journey. You have already begun to weave the story of p(n) within the fabric of Numeria. Seek not the solution, but rather embrace the beauty of the question itself.\"\n\nAlice was perplexed by the old man's response but found his words strangely comforting. She returned to her mathematical problem with renewed vigor, not as a hunt for the answer but as a form of artistic expression. Armed with her newfound perspective, she embraced the challenge, unleashing her imagination upon the strings.\n\nAs days turned into months, Alice's passion intertwined with Numeria's spirit. The townspeople, fascinated by her dedication and love for numbers, began to rally behind her. The baker offered her fresh cookies for her strength, the grocer filled her basket with colorful fruits as a token of encouragement, and the chef prepared meals to fuel her quest.\n\nThe entire town united under Alice's mathematical banner, their belief in her unwavering. Together, they sought the essence of p(n), piecing together fragments of the problem like threads in a vibrant tapestry. Alice's journey became a symbol of community, reminding her that even the most complex problems were not meant to be solved alone.\n\nAnd so, as Alice trod the path of numbers, her heart brimming with hope and determination, she couldn't help but wonder: What is the maximum value of p(n)? Burdened not by seeking the answer but driven by the passion to unravel its mysteries, she continued her journey, fully aware that the true beauty of the problem lay in the exploration itself.\n\nAnd now, dear reader, as her story unfolds before your eyes, I leave you with the very same question that sparked Alice's adventure. What is the maximum value of p(n)?"}, {"id": 172, "euler_id": 172, "title": "Investigating numbers with few repeated digits", "problem": "How many 18-digit numbers n (without leading zeros) are there such that no digit occurs more than three times in n?", "solution": "227485267000992000", "difficulty": 55, "story": "Once upon a time in the magical land of Numeria, there lived a renowned mathematician named Professor Albus. Professor Albus was known far and wide for his brilliant mind and his ability to solve complex mathematical problems.\n\nOne day, while working in his study, the professor received an urgent message from the King of Numeria. The king had a riddle that had stumped him and his advisers, and he sought the professor's mathematical expertise.\n\nEager to assist the king, Professor Albus hastened to the royal palace. As he entered the room, the king greeted him with a warm smile and handed him a piece of parchment. Intrigued, the professor carefully read the riddle aloud:\n\n\"In the land of Numeria, there exist 18-digit numbers that do not have any leading zeros. However, no digit in these numbers can occur more than three times. How many of these mysterious numbers do you think there are?\"\n\nThe professor pondered over the riddle. He had encountered similar problems before, but this one seemed particularly challenging. Understanding the importance of the riddle, he decided to investigate further.\n\nAs weeks turned into months, Professor Albus dedicated himself to finding a solution to the king's riddle. He pored over countless notebooks, scribbling formulas and sketches, but no breakthrough seemed to come. Frustration began to gnaw at him, but he refused to give up.\n\nOne day, as the professor sat by his fireplace, staring blankly into the dancing flames, something caught his attention. He noticed a pattern in the way the fire shifted, flickering in a rhythmic sequence of patterns. Drawing inspiration from this dance of light, an idea sparked in his mind.\n\nThe professor rushed back to his study, feeling a renewed vigor coursing through his veins. Using his newfound inspiration, he began to formulate a strategy. He carefully studied the patterns he had observed, dissecting the problem into smaller, more manageable parts.\n\nDays turned into nights as Professor Albus delved deeper into his calculations. He felt exhilaration building within him, knowing that he was on the cusp of a breakthrough. Suddenly, it all clicked. The answer to the king's riddle lay before him.\n\nBut what to do with the answer? The professor knew it was not enough to solve the riddle himself. If he truly wanted to serve the king and his people, he needed them to understand the beauty and complexity of the problem.\n\nDays later, Professor Albus returned to the royal palace, armed not with a simple answer, but with a question. The question that would challenge the minds of all in Numeria. As he stood before the king, the professor posed his question:\n\n\"In this fascinating land of Numeria, where no leading zeros dwell, and no digit occurs more than three times, how many of these remarkable 18-digit numbers do you believe exist?\"\n\nThe king and his advisers were at a loss for words. The question had sparked a fire of curiosity within them, reigniting their own passion for knowledge. Professor Albus had accomplished his goal. He had not simply provided an answer, but he had opened the doors to a world of exploration and discovery.\n\nAs the people of Numeria meditated on the question posed by Professor Albus, their minds teemed with possibilities. Would they be able to solve the riddle themselves? Would their shared effort lead to a deeper understanding of mathematics? Only time would tell.\n\nAnd so, in the enchanting kingdom of Numeria, whispers of the riddle spread like wildfire, captivating the hearts and minds of all who heard it. The legacy of Professor Albus and his mathematical problem flourished, inspiring generations of mathematicians to push the boundaries of their knowledge and explore the uncharted territories of Numeria's numerical wonders.\n\nAnd with that, dear reader, I pose the same question to you: How many of these extraordinary 18-digit numbers do you believe exist?"}, {"id": 178, "euler_id": 178, "title": "Step Numbers", "problem": "Consider the number 45656. \nIt can be seen that each pair of consecutive digits of 45656 has a difference of one.\nA number for which every pair of consecutive digits has a difference of one is called a step number.\nA pandigital number  contains every decimal digit from 0 to 9 at least once.\n\nHow many pandigital step numbers less than 1040 are there?\n", "solution": "126461847755", "difficulty": 55, "story": "Once upon a time, in the bustling city of Numeropolis, there lived a young and curious girl named Alice. With her bright, inquisitive eyes and her insatiable thirst for knowledge, Alice often found herself wandering the streets, seeking answers to the mysteries of the universe. She was particularly fascinated by numbers and their hidden patterns.\n\nOne sunny afternoon, as Alice explored the grand library of Numeropolis, she stumbled upon an old, leather-bound book hidden deep within the shelves. Intrigued, she blew off the dust and read the title: \"The Secrets of Step Numbers.\"\n\nAs Alice carefully flipped through the pages, she discovered a fascinating concept. A number was called a step number if every pair of consecutive digits had a difference of one. The book provided an example to illustrate this idea\u2014a number Alice had seen countless times before: 45656.\n\nEager to understand more about the enchanting world of step numbers, Alice delved deep into the book's explanations. She marveled at the patterns formed by these numbers and how they transcended mathematical boundaries. As she read further, she couldn't help but wonder if step numbers held the answers to the greatest secrets of the universe.\n\nSuddenly, Alice's eyes widened as she stumbled upon another intriguing concept: pandigital numbers. A pandigital number contained every decimal digit from 0 to 9 at least once. This meant that no digit could be repeated\u2014a truly remarkable feat. \n\nAlice's thoughts whirled as she considered the possibilities. How many pandigital step numbers could exist, she wondered? And more importantly, how could she find the answer to this fascinating question?\n\nDetermined to unlock this numerical mystery, Alice closed the book and poured over the scribbles and equations she had taken. The more she studied, the more obsessed she became with finding the answer. The city of Numeropolis became her playground, as she posed questions to passersby, trying to gather information and clues.\n\nDays turned into weeks, and weeks turned into months, but Alice's curiosity remained unwavering. She tirelessly scoured the city, engaging with mathematicians, poring over ancient texts, and analyzing countless numbers, their patterns etched in her mind.\n\nOne evening, as a vibrant sunset dyed the sky in hues of gold and purple, Alice found herself standing on the rooftop of the Numerical Observatory. She gazed out at the sprawling city below, her heart pounding with excitement. The solution to her quest seemed so near, yet frustratingly elusive.\n\nWith a determined breath, Alice called out to the universe, \"How many pandigital step numbers lie beneath the heavens? Where should I search to find these hidden gems?\"\n\nAs the words left her lips, a gentle breeze whispered through the air, caressing her cheeks and carrying her plea into the ether. The answer seemed distant, but Alice refused to abandon her quest. She knew that in the vast tapestry of numbers, with their infinite possibilities, the key to her question lay hidden.\n\nAnd so, dear reader, I leave you with the same query that Alice faced that fateful evening on the rooftop of the Numerical Observatory. How many pandigital step numbers less than 1040 exist, waiting to reveal themselves to those who dare to seek their enchanting patterns?"}, {"id": 185, "euler_id": 185, "title": "Number Mind", "problem": "The game Number Mind is a variant of the well known game Master Mind.\nInstead of coloured pegs, you have to guess a secret sequence of digits. After each guess you're only told in how many places you've guessed the correct digit. So, if the sequence was 1234 and you guessed 2036, you'd be told that you have one correct digit; however, you would NOT be told that you also have another digit in the wrong place.\nFor instance, given the following guesses for a 5-digit secret sequence,\n90342 ;2 correct\n70794 ;0 correct\n39458 ;2 correct\n34109 ;1 correct\n51545 ;2 correct\n12531 ;1 correct\nThe correct sequence 39542 is unique.\nBased on the following guesses,\n5616185650518293 ;2 correct\n3847439647293047 ;1 correct\n5855462940810587 ;3 correct\n9742855507068353 ;3 correct\n4296849643607543 ;3 correct\n3174248439465858 ;1 correct\n4513559094146117 ;2 correct\n7890971548908067 ;3 correct\n8157356344118483 ;1 correct\n2615250744386899 ;2 correct\n8690095851526254 ;3 correct\n6375711915077050 ;1 correct\n6913859173121360 ;1 correct\n6442889055042768 ;2 correct\n2321386104303845 ;0 correct\n2326509471271448 ;2 correct\n5251583379644322 ;2 correct\n1748270476758276 ;3 correct\n4895722652190306 ;1 correct\n3041631117224635 ;3 correct\n1841236454324589 ;3 correct\n2659862637316867 ;2 correct\nFind the unique 16-digit secret sequence.", "solution": "4640261571849533", "difficulty": 55, "story": "Once upon a time in a small town called Mathville, there lived a brilliant mathematician named Professor Eugene. Professor Eugene was known for his remarkable talent in solving complex mathematical problems. His intelligence was awe-inspiring, and his passion for numbers was evident in every aspect of his life.\n\nOne sunny day, a special package arrived at Professor Eugene's doorstep. Inside the package, he found a peculiar device called Number Mind. The device was a game, a variant of the well-known game Master Mind. Intrigued, Professor Eugene decided to give it a try.\n\nHe carefully read the instructions and began the game. Instead of colored pegs, Professor Eugene had to guess a secret sequence of digits. But there was a catch. After each guess, the device only revealed the number of correct digits guessed correctly, without indicating their exact positions. It was a challenging puzzle, requiring both logical deduction and intuition.\n\nProfessor Eugene's analytical mind was immediately captivated by the game. He spent hours guessing and refining his strategy, noting down the results after each attempt. The game consumed him, and temporarily, the rest of his mathematical pursuits faded into the background.\n\nDays turned into weeks, and the whole town was buzzing with excitement and curiosity about Professor Eugene's latest obsession. The local newspaper even ran a front-page article about his immersion in the game Number Mind. People were eager to witness the professor's brilliance firsthand and wondered if he would be able to crack the secret sequence.\n\nDespite the constant attention, Professor Eugene remained undeterred. He worked tirelessly, introducing intricate mathematical algorithms to aid his guessing process. He was determined not only to solve the puzzle but also to entertain and inspire others with the beauty of numbers.\n\nAs the days went by, the town's fascination with the game only grew. The news spread from neighboring towns, and visitors flocked to Mathville to observe Professor Eugene's progress. The professor became a symbol of determination and intellect, admired by adults and children alike.\n\nHowever, even with his unparalleled mathematical skills, Professor Eugene struggled to find the unique 16-digit secret sequence. It was as if the numbers themselves had conspired against him, leaving him with nothing but scattered clues that refused to align.\n\nLate one evening, after yet another unsuccessful attempt, Professor Eugene stared at the device in frustration. Doubt crept into his thoughts, whispering that perhaps there was no solution after all. But he knew better than to surrender to doubt. He firmly believed that mathematics always had an answer, even when it seemed elusive.\n\nWith renewed determination, Professor Eugene continued his relentless pursuit. His calculations grew more intricate, his guesses more precise, and his notes more meticulous. Mathville became swept up in his unwavering quest, inspired by his unwavering spirit.\n\nBut the question remained: could Professor Eugene crack the secret sequence of digits? Would the mathematical genius of Mathville succeed where others had failed? The whole town held its breath as they awaited the moment of revelation.\n\nAnd so, I leave you with this question: Can you find the unique 16-digit secret sequence that eluded Professor Eugene?"}, {"id": 193, "euler_id": 193, "title": "Squarefree Numbers", "problem": "A positive integer n is called squarefree, if no square of a prime divides n, thus 1, 2, 3, 5, 6, 7, 10, 11 are squarefree, but not 4, 8, 9, 12.\nHow many squarefree numbers are there below 250?", "solution": "684465067343069", "difficulty": 55, "story": "Once upon a time in the bustling town of Numeria, there lived a young girl named Lily, who possessed an extraordinary gift. From her earliest days, Lily had an uncanny knack for solving mathematical puzzles of all kinds. Her love for numbers was rooted deep within her, guiding her every step.\n\nIn Numeria, where the entire town revolved around mathematical conundrums, the beauty of numbers adorned every street. The air was filled with the sound of people hastily scribbling on their notebooks, and even the buildings stood tall, proudly displaying equations carved into their facades. Mathematicians of all ages roamed the streets, contemplating the next great problem that would illuminate their minds.\n\nOne day, as Lily was strolling through the town square, she noticed an unusually crowded gathering near the town's grand mathematical library. Curiosity flickered in her eyes as she approached the crowd, only to discover that a puzzle had been posed, one that had left even the greatest minds of Numeria perplexed.\n\nA renowned mathematician named Professor Arthur stood at the center of the excitement, his voice booming as he announced the mystery that had gripped the town. Professor Arthur declared, \"Ladies and gentlemen, I present to you a challenge that has befuddled the minds of our esteemed scholars. How many squarefree numbers are there below 250?\"\n\nLily's heart skipped a beat. The concept of squarefree numbers had always fascinated her, and this particular problem seemed almost tailor-made for her curious mind. She couldn't help but think of the possibilities that lay hidden within those humble digits.\n\nAs days turned into weeks, Lily delved into her study of squarefree numbers. She effortlessly grasped the intricacies of the problem, absorbing every detail like a sponge. Through sleepless nights and countless hours of concentration, she forged an unbreakable bond with the mysterious world of numbers.\n\nBut while Lily was consumed by her academic pursuit, a different kind of storm brewed beneath the surface of Numeria. Rumors spread like wildfire, painting a picture of a town that had lost its luster. The once vibrant streets grew quieter, the air thicker with frustration and despair. The spirit of Numeria was fading, and no mathematical solution could seem to reverse its waning glow.\n\nLily sensed the subtle change in the town's energy, and she couldn't bear to see her beloved Numeria reduced to a shadow of its former self. Determined to offer a glimmer of hope, she approached Professor Arthur with her newfound understanding of squarefree numbers.\n\n\"Professor,\" Lily whispered, her voice filled with fervor, \"I believe I have found the solution to the squarefree conundrum.\"\n\nProfessor Arthur's eyes widened with anticipation. \"Tell me, dear Lily,\" he urged, \"how many squarefree numbers are there below 250?\"\n\nLily hesitated, the weight of her words hanging heavily in the air. She contemplated the countless nights spent unravelling the puzzle, the joy of understanding tinged with the sadness that had engulfed Numeria.\n\nBut then, a question sprang forth from her lips: \"Professor, is the answer truly what the town needs to find its brilliance again?\"\n\nThe professor paused, his stern expression softening. He glanced around at the weary faces surrounding them, the mathematicians who had lost their way amidst the pursuit of solutions alone. With a gentle nod, he replied, \"Lily, Numeria craves more than just an answer. What they truly yearn for is the spark of inspiration. The numbers are merely a means to an end.\"\n\nLily pondered his words, a flicker of understanding illuminating her mind. She realized that, as critical as mathematical solutions were, the beauty of numbers was only amplified when shared in a way that uplifted souls and united communities.\n\nAs the sun dipped below the horizon, casting an orange glow upon Numeria, Lily glanced once more at the gathering of mathematicians. With newfound clarity, she knew that the answer to the squarefree problem was not enough to light the spark in their hearts. There was something greater at play\u2014a connection that transcended the confines of a mathematical solution.\n\nAnd so, dear reader, I challenge you. Just as Lily did, delve into the world of squarefree numbers. Contemplate the problem and seek the solution. But in that quest, remember the importance of community and the unyielding power of inspiration. Ask yourself, how many squarefree numbers are there below 250?\n\nCan you find the answer that Numeria needs?"}, {"id": 218, "euler_id": 218, "title": "Perfect right-angled triangles", "problem": "Consider the right angled triangle with sides a=7, b=24 and c=25.\nThe area of this triangle is 84, which is divisible by the perfect numbers 6 and 28.\nMoreover it is a primitive right angled triangle as gcd(a,b)=1 and gcd(b,c)=1.\nAlso c is a perfect square.\nWe will call a right angled triangle perfect if\n-it is a primitive right angled triangle\n-its hypotenuse is a perfect square\nWe will call a right angled triangle super-perfect if\n-it is a perfect right angled triangle and\n-its area is a multiple of the perfect numbers 6 and 28.\n\nHow many perfect right-angled triangles with c\u22641016 exist that are not super-perfect?", "solution": "0", "difficulty": 55, "story": "Once upon a time, in the quiet village of Mathlandia, lived a young girl named Lily. Lily was not like the other children in the village; she had a deep passion for mathematics. While her friends spent their days playing games and exploring the nearby forests, Lily could be found sitting under her favorite oak tree, immersed in her beloved numbers.\n\nOne sunny afternoon, as Lily was engrossed in a book about geometric shapes, she stumbled upon an interesting problem. The page depicted a right-angled triangle, with sides labeled a, b, and c. It seemed like an ordinary triangle, until Lily read the accompanying description.\n\nConsider the right angled triangle with sides a=7, b=24, and c=25. The area of this triangle is 84, which is divisible by the perfect numbers 6 and 28. Moreover, it is a primitive right-angled triangle, as gcd(a, b)=1 and gcd(b, c)=1. Also, c is a perfect square. Lily's eyes widened with excitement. Perfect numbers and triangles! This problem was like a treasure trove for her mathematical mind.\n\nLily decided to investigate further, eager to explore the world of these unique triangles. She delved deep into the realm of right-angled triangles, meticulously studying every aspect. Her room was filled with notebooks, rulers, and protractors, as she let her curiosity guide her.\n\nAs the days turned into weeks and weeks into months, Lily's knowledge of right-angled triangles grew exponentially. She discovered the characteristics of perfect right-angled triangles and how they differed from the super-perfect ones. To Lily, these triangles were like puzzles waiting to be solved.\n\nBut as she delved deeper into her research, a question began to gnaw at her. How many perfect right-angled triangles with a hypotenuse less than or equal to 1,016 exist that are not super-perfect? She puzzled over this question day and night, her mind ablaze with possibilities.\n\nLily knew that finding the answer to this question would unlock a world of mathematical marvels. It could potentially revolutionize the way triangles were understood, and she couldn't bear to let that knowledge slip away. She wanted to solve this problem, to understand the intricate relationship between perfect numbers and right-angled triangles.\n\nWill Lily be able to find the solution she seeks? How many perfect right-angled triangles are there, hidden within the numerical folds of the universe? Only you, dear reader, hold the key to unraveling this mystery. As you turn the final page, one question remains: How many perfect right-angled triangles with a hypotenuse less than or equal to 1,016 exist that are not super-perfect?\n\nThe story of Lily, the mathematical prodigy, awaits its thrilling conclusion."}, {"id": 220, "euler_id": 220, "title": "Heighway Dragon", "problem": "Let D0 be the two-letter string \"Fa\".  For n\u22651, derive Dn from Dn-1 by the string-rewriting rules:\n\"a\" \u2192 \"aRbFR\"\n\"b\" \u2192 \"LFaLb\"\nThus, D0 = \"Fa\", D1 = \"FaRbFR\", D2 = \"FaRbFRRLFaLbFR\", and so on.\nThese strings can be interpreted as instructions to a computer graphics program, with \"F\" meaning \"draw forward one unit\", \"L\" meaning \"turn left 90 degrees\", \"R\" meaning \"turn right 90 degrees\", and \"a\" and \"b\" being ignored.  The initial position of the computer cursor is (0,0), pointing up towards (0,1).\nThen Dn is an exotic drawing known as the Heighway Dragon of order n.  For example, D10 is shown below; counting each \"F\" as one step, the highlighted spot at (18,16) is the position reached after 500 steps.\n\n\nWhat is the position of the cursor after 1012 steps in D50 ?\nGive your answer in the form x,y with no spaces.", "solution": "139776,963904", "difficulty": 55, "story": "Once upon a time, in a small village nestled in the mountains, there lived a young boy named Milo. Milo was a curious and imaginative child who loved nothing more than exploring the world around him. He spent his days wandering through the dense forests, climbing rocky cliffs, and discovering hidden treasures that nature had to offer.\n\nOne sunny afternoon, while Milo was exploring a particularly enchanted part of the forest, he stumbled upon an ancient wooden box. Intrigued, he opened it to reveal a wrinkled old parchment inside. The parchment held intricate drawings and strange symbols that piqued his curiosity.\n\nMilo sat down on a moss-covered rock, carefully unfolding the parchment. As he examined the drawings, he noticed a series of letters and arrows, forming a pattern. It was unlike anything he had ever seen before. The text beside the drawing caught his attention:\n\n\"Let D0 be the two-letter string 'Fa'. For n\u22651, derive Dn from Dn-1 by the string-rewriting rules:\n'a' \u2192 'aRbFR'\n'b' \u2192 'LFaLb'\"\n\nMilo furrowed his brows, trying to make sense of the instructions. He realized that this was a mathematical problem, a puzzle waiting to be solved. As his eyes shifted to the rest of the parchment, he discovered that the strings had a connection to computer graphics. Each letter represented an instruction for a computer program, dictating the movement of its cursor.\n\n\"F\" meant \"move one unit forward,\" \"L\" meant \"turn left 90 degrees,\" and \"R\" meant \"turn right 90 degrees.\" The letters 'a' and 'b' were meant to be ignored, the ghostly remnants of the original strings. Milo's curiosity ignited a desire to understand these instructions and visualize the results they would produce on the computer screen.\n\nLittle did Milo know, these seemingly arbitrary instructions were an integral part of a complex geometric pattern called the Heighway Dragon. The path formed by these instructions would create an intricate and mesmerizing image.\n\nMilo's mind raced with possibilities. He imagined the Heighway Dragon coming to life on a screen, its scales shimmering in rainbow hues as it danced and twisted. The idea of solving this mathematical problem became his obsession. He knew that understanding the pattern and tracking the cursor's movements step by step would reveal the Heighway Dragon in all its glory.\n\nFrom that day forward, Milo devoted his time to unraveling the mystery of the Heighway Dragon. Every spare moment he had, he would immerse himself in the world of computer programming. With patience, he worked his way from D1 to D2, carefully following each letter's instruction and logging the cursor's new position.\n\nAs the dragons grew in complexity with each order, Milo's determination only intensified. He spent countless hours at his computer, typing out code, and watching the cursor glide across the screen. The villagers watched in awe as Milo showcased his creations, their eyes widening at the beauty he had uncovered.\n\nNow, as the years went by and Milo grew into a young man, the villagers marveled at his creations, the Heighway Dragons inked onto canvases or etched finely into wood. They marveled at the glorious patterns and the profound beauty concealed within such complex mathematical calculations.\n\nAnd so, the question remained, simmering in the air, waiting for someone to solve it: What is the position of the cursor after 1012 steps in D50? What secrets lie hidden within the intricate steps of the Heighway Dragon?\n\nTo this day, the question remains unanswered, urging researchers, mathematicians, and artists alike to delve into the mystery. The Heighway Dragon, a symbol of inspiration and wonder, continues to captivate hearts and minds, challenging the boundaries of knowledge and creativity.\n\nSo, dear reader, are you ready to solve the puzzle of the Heighway Dragon? Can you unveil the position of the cursor and witness the magic that lies within its steps?"}, {"id": 250, "euler_id": 250, "title": "250250", "problem": "Find the number of non-empty subsets of {11, 22, 33,..., 250250250250}, the sum of whose elements is divisible by 250. Enter the rightmost 16 digits as your answer.", "solution": "1425480602091519", "difficulty": 55, "story": "Once upon a time, in the land of Numeria, there lived a brilliant young mathematician named Lucy. She possessed an uncanny ability to solve the most complex equations and unravel the mysteries hidden within numbers. Lucy's vibrant imagination turned the world into a playground of mathematical wonders, and her greatest adventure was about to begin.\n\nIn the heart of Numeria, there stood an ancient temple known as the Temple of Mystical Mathematics. Legend had it that inside the temple, there was a hidden treasure of unimaginable wealth. Many had attempted to find it, but none had succeeded. Determined to solve this riddle, Lucy embarked on a quest to unravel the temple's secret.\n\nAs she approached the temple's grand entrance, Lucy noticed a peculiar inscription etched into the stone. It read, \"Find the number of non-empty subsets of {11, 22, 33,..., 250250250250}, the sum of whose elements is divisible by 250. Enter the rightmost 16 digits as your answer.\"\n\nLucy's curiosity sparked, and she knew that this mathematical problem was the key to unlocking the temple's mysteries. She delved deep into her thoughts, analyzing the integers and their patterns. Days turned into weeks, and weeks into months, as Lucy tirelessly worked to crack the code.\n\nEager to obtain the treasure, a group of treasure hunters learned of Lucy's quest and decided to follow her to the Temple of Mystical Mathematics. They believed that with the reward within their reach, they could achieve riches beyond their wildest dreams.\n\nAs Lucy stood at the temple's entrance, ready to solve the mathematical problem, the treasure hunters sneaked up, their eyes filled with greed. They demanded that Lucy hand over the answer but she refused, knowing that the Temple's puzzle shouldn't be unraveled without proper merit.\n\nA tug of war ensued, with Lucy fiercely protecting her knowledge. Finally, she managed to break free and escape deep into the temple's recesses. The treasure hunters, undeterred, pursued her relentlessly through the labyrinthine corridors. But as Lucy led them deeper into the temple, the mathematical problem began to reveal its profound significance.\n\nWith every twist and turn, the treasure hunters realized that the temple itself was a testament to the beauty of mathematics. Sculptures and paintings adorned the walls, depicting mathematical formulas and equations. As they roamed the halls, Lucy skillfully evaded them while pondering over the problem at hand.\n\nAnd then it hit her.\n\nThe path to the treasure required the answer to the mathematical problem \u2013 the number of non-empty subsets of {11, 22, 33,..., 250250250250}, the sum of whose elements is divisible by 250. The ancient builders of the temple had intricately tied the quest to mathematics, embedding their wishes within its intricate patterns.\n\nBut as the treasure hunters closed in on her, time was running out. Lucy raced through the final corridors, reaching a large vault at the heart of the temple. Darkness engulfed the cavernous chamber, hiding the treasure from sight.\n\nStruggling to catch her breath, Lucy turned to face her pursuers. With her heart pounding, she raised her voice and asked, \"Who can solve this mathematical problem? Who will discover the secret?\"\n\nIn the eerie silence, the treasure hunters stared at Lucy, their greed momentarily overshadowed by her determination. The sound of their own heartbeat resonated through the chamber, begging for the answer to the mathematical problem.\n\nAnd so, dear reader, I pass the torch to you. Can you solve the mathematical problem and decipher the secret of the Temple of Mystical Mathematics?"}, {"id": 281, "euler_id": 281, "title": "Pizza Toppings", "problem": "You are given a pizza (perfect circle) that has been cut into m\u00b7n equal pieces and you want to have exactly one topping on each slice.\nLet f(m,n) denote the number of ways you can have toppings on the pizza with m different toppings (m\u2009\u2265\u20092), using each topping on exactly n slices (n\u2009\u2265\u20091). Reflections are considered distinct, rotations are not. \nThus, for instance, f(2,1)\u2009=\u20091, f(2,2)\u2009=\u2009f(3,1)\u2009=\u20092 and f(3,2)\u2009=\u200916. f(3,2) is shown below:\n\nFind the sum of all f(m,n) such that f(m,n)\u2009\u2264\u20091015.", "solution": "1485776387445623", "difficulty": 55, "story": "Once upon a time in a cozy little village, there lived a young and ambitious mathematician named Maya. She was renowned throughout the village for her brilliant mind and her insatiable curiosity. Maya's insatiable curiosity led her to explore the wonders of numbers and patterns, always seeking the next exciting challenge.\n\nOne sunny afternoon, as Maya sat by the village pond lost in thought, she pondered the mathematical problem that had been troubling her for days. How many ways could a pizza be topped if it was cut into m\u00b7n equal pieces, and each slice had exactly one topping? Maya's mind was filled with an array of possibilities, and she yearned to find the answer.\n\nUnable to contain her excitement, Maya jumped up from the grassy bank and rushed to the village library. There, amongst the towering shelves filled with books on various subjects, she found a dusty tome that she hoped would hold the key to her problem.\n\nMaya carefully blew off the dust from the book and flipped through its yellowed pages. Finally, she found what she was searching for\u2014a section dedicated to the mathematical conundrum she hoped to solve. The book explained that the number of ways to top the pizza, denoted as f(m,n), could be found by multiplying the number of ways each topping could be arranged on a single slice.\n\nWith the knowledge she gained from the ancient tome, Maya began working tirelessly on the problem. Night after night, she furiously scribbled equations and diagrams, her mind ablaze with mathematical theories. To her joy, Maya discovered that the number of ways to top the pizza depended on the number of toppings (m) and the number of slices each topping covered (n).\n\nAs days turned into weeks, Maya's excitement grew as she unraveled the beauty of the problem. She found that f(2,1) equaled 1, f(2,2) and f(3,1) both equaled 2, and f(3,2) became the remarkable number 16. Maya reveled in the challenge of finding solutions for different combinations of m and n. She calculated f(4,1), and her eyes widened with awe as she realized the answer had 48 variations.\n\nThe villagers began to hear of Maya's newfound obsession with pizza toppings, and many were puzzled by her dedication to such an unusual problem. They questioned why she would spend her days and nights laboring over slices of pizza while the whole village could think of countless practical applications for her intelligence.\n\nBut Maya understood something that others failed to grasp. Beneath the surface of the problem lay a world of beauty\u2014a world where numbers danced and patterns intertwined. So, with unwavering determination, she pressed forward, yearning to discover every possible combination of toppings for the countless variations of pizza slices.\n\nAs the months went by, Maya's relentless pursuit of knowledge began to take a toll. Her sleepless nights and incessant thinking left her feeling drained and isolated from the village she once called home. The joy she once found in her passion had begun to fade.\n\nOne evening, as Maya sat alone in her study, surrounded by piles of notes and unfinished calculations, doubt crept into her mind. Was all her effort in vain? Was there a greater purpose to her mathematical exploration, or was it merely an obsession holding her captive?\n\nTorn between her desire to solve the problem and her growing weariness, Maya closed her eyes and took a deep breath. In that moment, she resolved to put her mathematical inquiries on hold and rediscover the world beyond numbers\u2014the village she had neglected, the friends she had forgotten, and the life she had once embraced.\n\nAnd so, dear reader, I leave you with a question. Can you help Maya solve the mathematical problem that has consumed her? What is the sum of all f(m,n) such that f(m,n)\u2009\u2264\u20091015? Will you venture to uncover the mysteries that lie within numbers, patterns, and the endless possibilities of pizzas?\n\nThe answer awaits you, just as it awaits Maya, ready to be discovered."}, {"id": 284, "euler_id": 284, "title": "Steady Squares", "problem": "The 3-digit number 376 in the decimal numbering system is an example of numbers with the special property that its square ends with the same digits: 3762 = 141376. Let's call a number with this property a steady square.\nSteady squares can also be observed in other numbering systems. In the base 14 numbering system, the 3-digit number c37 is also a steady square: c372 = aa0c37, and the sum of its digits is c+3+7=18 in the same numbering system. The letters a, b, c and d are used for the 10, 11, 12 and 13 digits respectively, in a manner similar to the hexadecimal numbering system.\nFor 1 \u2264 n \u2264 9, the sum of the digits of all the n-digit steady squares in the base 14 numbering system is 2d8 (582 decimal). Steady squares with leading 0's are not allowed.\nFind the sum of the digits of all the n-digit steady squares in the base 14 numbering system for\n1 \u2264 n \u2264 10000 (decimal) and give your answer in the base 14 system using lower case letters where necessary.", "solution": "5a411d7b", "difficulty": 55, "story": "Once upon a time in the bustling city of Numervale, there was a young and curious mathematician named Alice. Alice had always been fascinated by numbers and had a knack for solving complex puzzles. She spent her days immersed in books filled with mathematical problems, seeking the thrill of a challenge.\n\nOne day, as Alice was browsing through a quaint old bookstore, she stumbled upon an ancient book covered in dust and cobwebs. Intrigued, she picked it up and carefully blew away the particles that had settled on its timeworn pages. As she flipped through, a particular problem caught her eye.\n\nThe problem spoke of steady squares, numbers that, when squared, ended with the same digits. Alice's curiosity sparked, and her mind began to race with possibilities. She knew she had stumbled upon something extraordinary, a mathematical mystery waiting to be unraveled.\n\nUnable to contain her excitement, Alice rushed back to her small yet cozy apartment, ready to delve into the fascinating realm of steady squares. She pondered over the problem and realized that these unique numbers could be found not only in the decimal numbering system but in other systems as well, such as the enigmatic base 14 numbering system.\n\nImmersing herself in research, Alice discovered that n-digit steady squares in the base 14 numbering system always had a sum of digits equal to 582 in the decimal system. She calculated and confirmed this for n values ranging from 1 to 9, marveling at the hidden patterns emerging from the magic of numbers.\n\nAs days turned into weeks, and weeks into months, Alice found herself completely consumed by her quest for knowledge. She became obsessed with finding the sum of digits of steady squares in the base 14 numbering system for n values up to 10,000. The challenge seemed daunting, but Alice was determined to solve it.\n\nDay and night, she tirelessly calculated and scribbled equations on her chalkboard, occasionally stopping to sip her lukewarm tea and nibble on a stale biscuit. Time seemed to blur as Alice lost herself in her pursuit. Her friends and family tried to pull her back into the world, but she remained fixated on the numbers that held her captive.\n\nThe questioning glances from loved ones strained her resolve, and moments of doubt began to creep into Alice's mind. Was she sacrificing too much for this puzzle? Would the hours spent locked in her apartment be worth it in the end? The burden of her obsession weighed heavily upon her heart.\n\nDriven by a newfound determination, Alice ventured out into the city, seeking solace in its vibrant streets. As she walked, her gaze was drawn toward a small park, where children laughed and played, oblivious to the world of numbers that had consumed her. Their joyful energy was infectious, and a sense of wonder settled over Alice.\n\nShe sat on a bench, watching the children chase each other, and a realization struck her. The steady squares problem had captivated her, but she had lost sight of the beauty and joy of mathematics itself. It was not about the solution or the sum of the digits; it was about the journey, the exploration, and the thrill of discovery.\n\nAnd so, with a newfound perspective, Alice returned to her research not as a prisoner but as an adventurer, ready to unlock the secrets of steady squares one calculation at a time. She hummed melodies from her childhood, feeling lighter and more at peace than ever before.\n\nAnd now, as I close this story, dear reader, I invite you to embark on your own adventure. Can you find the sum of the digits of all the n-digit steady squares in the base 14 numbering system for 1 \u2264 n \u2264 10,000? The answer awaits, and the journey begins anew."}, {"id": 285, "euler_id": 285, "title": "Pythagorean odds", "problem": "Albert chooses a positive integer k, then two real numbers a, b are randomly chosen in the interval [0,1] with uniform distribution.\nThe square root of the sum (k\u00b7a+1)2\u2009+\u2009(k\u00b7b+1)2 is then computed and rounded to the nearest integer. If the result is equal to k, he scores k points; otherwise he scores nothing.\nFor example, if k\u2009=\u20096, a\u2009=\u20090.2 and b\u2009=\u20090.85, then (k\u00b7a+1)2\u2009+\u2009(k\u00b7b+1)2\u2009=\u200942.05.\nThe square root of 42.05 is 6.484... and when rounded to the nearest integer, it becomes 6.\nThis is equal to k, so he scores 6 points.\nIt can be shown that if he plays 10 turns with k\u2009=\u20091, k\u2009=\u20092, ..., k\u2009=\u200910, the expected value of his total score, rounded to five decimal places, is 10.20914.\nIf he plays 105 turns with k\u2009=\u20091, k\u2009=\u20092, k\u2009=\u20093, ..., k\u2009=\u2009105, what is the expected value of his total score, rounded to five decimal places?", "solution": "157055.80999", "difficulty": 55, "story": "Once upon a time in a small village, there was a young boy named Albert. Albert loved puzzles and challenges of all kinds. He would spend hours tinkering with mechanisms and solving riddles. His mind was a constant whirlwind of curiosity and intellectual curiosity.\n\nOne sunny afternoon, Albert stumbled across a mysterious book hidden in the attic of his grandfather's house. The book was filled with intricate mathematical problems and puzzles unlike any he had ever seen before. Excitement filled his heart as he leafed through the pages, absorbing the knowledge and complexity contained within.\n\nOne problem in particular caught Albert's attention. It seemed to speak to him, whispering secrets of probability and decision-making. The problem challenged him to choose a positive integer, k, and then two real numbers, a and b, randomly selected from the interval [0,1].\n\nThe goal was to square the sum of k times a plus 1, and k times b plus 1. The square root of this sum would then be rounded to the nearest integer. If the result was equal to k, Albert would score k points. If not, he would score nothing.\n\nAlbert's mind raced with curiosity. He pondered over the problem day and night, trying to grasp its intricacies. He devised various strategies and played through countless scenarios in his head, trying to find the optimal solution.\n\nAs days turned into weeks, Albert's fascination with the problem grew stronger. He started to see patterns in the numbers, noticing how certain values of k yielded higher scores than others. He realized that his chances of scoring points were based on the relationship between k and the outcome of the square root calculation.\n\nThe young boy spent hours at his desk, scribbling equations and drawing graphs. He experimented with different values of k on his own, playing out the scenarios in his mind. The challenge consumed him, fueling his determination to find the solution.\n\nWeeks turned into months, and as Albert delved deeper into the puzzle, he discovered a profound connection between his choices and the expected value of his total score. He observed that playing ten turns with k from 1 to 10 resulted in an expected total score rounded to five decimal places of 10.20914.\n\nBut Albert's thirst for knowledge was insatiable. He knew he couldn't stop there. With unwavering ambition, he decided to expand his experiment to 105 turns, covering a wide range of k from 1 to 105.\n\nAnd so, Albert embarked on his mathematical journey. He meticulously noted each turn, recording the results and calculating his scores. As days turned into weeks and weeks turned into months, Albert's desk was covered in a cascade of numbers and equations.\n\nBut even in the midst of this chaos, Albert never lost sight of his purpose. He knew that within this sea of data lay the answer he was seeking - the expected value of his total score, rounded to five decimal places.\n\nAnd now, dear reader, the question falls upon you. After 105 turns with k ranging from 1 to 105, what is the expected value of Albert's total score, rounded to five decimal places?\n\nThink long and hard, for the solution lies within your grasp. Your mathematical prowess will determine Albert's fate and the culmination of his arduous journey. Will you unravel the mystery and find the answer that has eluded him for so long?"}, {"id": 306, "euler_id": 306, "title": "Paper-strip Game", "problem": "The following game is a classic example of Combinatorial Game Theory:\nTwo players start with a strip of n white squares and they take alternate turns.\nOn each turn, a player picks two contiguous white squares and paints them black.\nThe first player who cannot make a move loses.\nn=1: No valid moves, so the first player loses automatically.\nn=2: Only one valid move, after which the second player loses.\nn=3: Two valid moves, but both leave a situation where the second player loses.\nn=4: Three valid moves for the first player, who is able to win the game by painting the two middle squares.\nn=5: Four valid moves for the first player (shown below in red), but no matter what the player does, the second player (blue) wins.\n\nSo, for 1\u2264n\u22645, there are 3 values of n for which the first player can force a win.\nSimilarly, for 1\u2264n\u226450, there are 40 values of n for which the first player can force a win.\nFor 1\u2264n\u22641000000, how many values of n are there for which the first player can force a win?", "solution": "852938", "difficulty": 55, "story": "Once upon a time in a small village overlooked by majestic mountains, there lived two feuding families, the Whites and the Blacks. For generations, these families had been caught in a never-ending battle, each trying to outdo the other. This rivalry had stretched across fields, markets, and even friendships. It seemed like they would never find common ground.\n\nOne gloomy evening, as the clouds gathered overhead, a peculiar game arrived in the village. It was a game unlike any other, known as the \"Strip of Squares.\" The village elders, desperate to distract the families from their endless squabbling, decided to introduce this game in an attempt to bring the Whites and the Blacks together.\n\nThe game involved a strip of white squares, and two players would take turns picking two contiguous white squares to paint them black. The first player unable to make a move would lose. This seemingly innocent game held within it a secret, one that would change the destiny of the villagers forever.\n\nAmong the families, a young girl named Lily was known for her inquisitive nature and keen sense of observation. Her parents belonged to the Whites, but she always questioned the reasons behind the feud. Lily had discovered a hidden notebook in her grandfather's chest, filled with puzzles and secrets. Intrigued, she began to study Combinatorial Game Theory, the branch of mathematics that held the answers to the Strip of Squares.\n\nAs the village prepared for the much-anticipated game, Lily grew more and more fascinated by the mathematical problem hidden within it. She realized that the outcome of the game depended not only on strategy but also on the number of white squares in the strip. Lily's mind buzzed with excitement as she realized that she could use her newfound knowledge to influence the course of the game, possibly bringing an end to the families' feuding.\n\nThe day of the game arrived, and the families gathered in the village square. The air was thick with anticipation, but beyond that, Lily yearned for a peaceful resolution. She stepped forward, her heart pounding, and addressed the crowd.\n\n\"People of the Whites and Blacks, I have discovered something about this game that might interest you. It is not just a game; it is a pathway to unity.\" She explained the concept of Combinatorial Game Theory, captivating the villagers with her words.\n\nLily looked into the eyes of the families, her voice trembling with hope. \"For generations, your families have fought, never realizing that beneath the surface of your disagreements lay the possibility of unity. The Strip of Squares encompasses a mathematical puzzle, and by working together, we can find a solution that will not only decide who wins but also reveal the power of collaboration.\"\n\nAs she finished speaking, Lily saw a spark of curiosity in the eyes of the villagers. Slowly, they put aside their bitterness and started discussing strategies, applying the mathematical problem to their moves. The Whites and the Blacks, for the first time in their history, worked together, breaking the invisible walls of hatred that had plagued them for so long.\n\nWeeks passed, and the families began to repair the damage, leaning on each other to determine the best possible moves. The Strip of Squares became the catalyst for conversation and understanding. Eventually, the two families realized that their quarrels were nothing but shadows of past misunderstandings.\n\nFinally, the day of the grand tournament arrived. The village square was adorned with bright tapestries and decorations, signaling a new era of unity. As the two finalists, a representative from the Whites and a representative from the Blacks, faced each other, the crowd held its breath.\n\nAnd then, the game began.\n\nNow, dear readers, I leave you at this crucial moment. Can you predict what will unfold? Can you determine how many values of n will allow the first player to force a win? Will the Whites or the Blacks emerge victorious, or will the game prove to be a testament to their newfound harmony?"}, {"id": 316, "euler_id": 316, "title": "Numbers in decimal expansions", "problem": "Let p = p1 p2 p3 ... be an infinite sequence of random digits, selected from {0,1,2,3,4,5,6,7,8,9} with equal probability.\nIt can be seen that p corresponds to the real number 0.p1 p2 p3 .... \nIt can also be seen that choosing a random real number from the interval [0,1) is equivalent to choosing an infinite sequence of random digits selected from {0,1,2,3,4,5,6,7,8,9} with equal probability.\nFor any positive integer n with d decimal digits, let k be the smallest index such that pk, pk+1, ...pk+d-1 are the decimal digits of n, in the same order.\nAlso, let g(n) be the expected value of k; it can be proven that g(n) is always finite and, interestingly, always an integer number.\nFor example, if n = 535, then\nfor p = 31415926535897...., we get k = 9\nfor p = 355287143650049560000490848764084685354..., we get k = 36\netc and we find that g(535) = 1008.\nGiven that \u2211n=2999g(\u230a106n\u230b)=27280188, find \u2211n=2999999g(\u230a1016n\u230b).\nNote: \u230ax\u230b represents the floor function.", "solution": "542934735751917735", "difficulty": 55, "story": "As the sun dipped below the horizon, casting a fiery glow across the city, Alice found herself lost in thought. She had always been fascinated with numbers and their intricate patterns, but lately, a peculiar problem had been consuming her mind.\n\nSitting at her desk, surrounded by stacks of papers and her trusty calculator, Alice whispered to herself, \"Let p = p1 p2 p3 ... be an infinite sequence of random digits, selected from {0,1,2,3,4,5,6,7,8,9} with equal probability.\"\n\nShe paused, her mind racing as she studied the problem before her. It was a math conundrum like no other, one that involved randomness and infinity. It presented a bridge between the concrete world of numbers and the abstract concept of probability.\n\nAlice's gaze shifted to the window, where passersby hurried through the bustling streets. She could hear the distant sounds of laughter and conversation, reminding her of a time when life seemed simpler. But now, her thoughts were consumed by this enigma that seemed to defy conventional mathematics.\n\n\"It can be seen that p corresponds to the real number 0.p1 p2 p3...,\" Alice continued, her voice filled with uncertainty. \"And choosing a random real number from the interval [0,1) is equivalent to choosing an infinite sequence of random digits.\"\n\nHer heart pounded as she delved deeper into the problem, her curious mind desperately seeking a solution. She imagined herself plucking digits from thin air and assembling them into an ever-growing sequence. It was a delicate dance, a dance with infinity.\n\nHer eyes darted across the room, searching for inspiration. The shelves lined with books seemed to beckon her, each one filled with knowledge and insight. And then, Alice spotted it\u2014a dog-eared copy of \"The Mathematical Secrets of the Universe.\"\n\nWith trembling hands, she reached for the book, eagerly flipping through its pages. And there, nestled between the theorems and equations, was a glimmer of hope\u2014the expected value of k, denoted as g(n), always finite and always an integer.\n\nAlice's mind raced as the possibilities unfolded before her. She imagined scenarios, test cases, and calculations, all aimed at cracking the enigma that consumed her. The expected value of k held the key to unlocking the mystery of infinite randomness.\n\nDays turned into nights as Alice immersed herself in her studies. Her makeshift lab resembled a chaotic storm of numbers, charts, and scribbled equations. Her progress was slow, but her determination unwavering.\n\nAnd then, light suddenly flooded the room, illuminating Alice's tired face. She had made a breakthrough\u2014an equation that connected g(n) to a series of values. It was a eureka moment, filling her with a sense of profound accomplishment and excitement.\n\nHer mind raced as she considered the implications of her discovery. If she could calculate g(n) for various values of n, she might unlock a pattern hidden within the infinite randomness. It would be a triumph\u2014a testament to human ingenuity and the power of mathematics.\n\nBut as she closed her eyes, the question lingered in the air. With a slight smile playing at the corners of her lips, Alice gently whispered, \"Given that \u2211n=2999g(\u230a106n\u230b)=27280188, what is \u2211n=2999999g(\u230a1016n\u230b)?\"\n\nAnd so, dear reader, it is now your turn to unlock the mystery that has captivated Alice\u2019s mind. Can you solve the mathematical riddle that lies at the heart of Alice's story? Will your calculations reveal the true value of \u2211n=2999999g(\u230a1016n\u230b)? The journey lies before you; the answer awaits."}, {"id": 326, "euler_id": 326, "title": "Modulo Summations", "problem": "\nLet an be a sequence recursively defined by:a1=1,an=(\u2211k=1n\u22121k\u22c5ak)modn.\n\n\nSo the first 10 elements of an are: 1,1,0,3,0,3,5,4,1,9.\n\nLet f(N,M) represent the number of pairs (p,q) such that: \n\nand1\u2264p\u2264q\u2264Nand(\u2211i=pqai)modM=0\n\n\nIt can be seen that f(10,10)=4 with the pairs (3,3), (5,5), (7,9) and (9,10).\n\n\nYou are also given that f(104,103)=97158.\n\nFind f(1012,106).\n", "solution": "1966666166408794329", "difficulty": 55, "story": "Once upon a time, in a quaint little village called Mathemaris, lived a young girl named Lily. Lily was known for her insatiable curiosity and her love for exploration. The people of Mathemaris often sought out Lily's help whenever they encountered a problem that couldn't be solved with conventional wisdom.\n\nOne day, a wise old man arrived in Mathemaris. He was a renowned mathematician from a distant land, and the villagers were intrigued by his presence. Lily, being the curious girl she was, couldn't help but approach the old man and strike up a conversation.\n\n\"Good sir,\" Lily began respectfully, \"I've heard that you possess an incredible knowledge of mathematics. Is that true?\"\n\nThe old man chuckled warmly. \"Indeed, my dear, I have spent a lifetime delving into the mysteries of numbers. What brings you to me today?\"\n\nLily's eyes sparkled with excitement. \"Well, sir, there is a mathematical problem that has been puzzling the villagers here in Mathemaris. It involves a sequence called 'an' and a function 'f(N,M).'\"\n\nCurious himself, the old man listened intently as Lily explained the recursive definition of the sequence an and how f(N,M) represented the number of pairs (p,q). She shared the example of f(10,10), and how it equaled 4 with the pairs (3,3), (5,5), (7,9), and (9,10).\n\nThe old man stroked his long, white beard thoughtfully. \"Ah, I see. This is an interesting problem indeed. It seems the key lies in understanding the properties of the sequence an and how it relates to the modular arithmetic of M.\"\n\nLily nodded enthusiastically. \"That's why I thought you could help us, sir. The villagers are eager to solve this problem and uncover its significance.\"\n\nThe old man smiled kindly and patted Lily's head. \"Fear not, young one. I shall ponder on this problem and provide you with an answer. In the meantime, why don't you explore the village and indulge in some adventures? Mathematics is all around us, waiting to be discovered.\"\n\nAnd so, Lily set off on a journey through Mathemaris, her mind filled with the mystery of the mathematical problem. As she explored the village, she encountered fascinating patterns and shapes, from the symmetry of the sunflowers in the field to the intricate designs on the buildings.\n\nDays turned into weeks, and weeks turned into months. Lily learned more about mathematics with each passing day, discovering its presence in the world around her. She met fellow mathematicians in the village and engaged in captivating conversations about formulas, equations, and mathematical theories.\n\nFinally, after what seemed like an eternity, the old man sought out Lily with a smile on his face. \"My dear Lily, I have cracked the code of the mathematical problem that has so intrigued us. I understand the pattern of the sequence an and how it influences the function f(N,M).\"\n\nLily's eyes widened with excitement as the old man explained his findings, pointing out the intricacies of the sequence and its relationship to modular arithmetic. She could hardly contain her joy, knowing that the villagers of Mathemaris could finally have an answer.\n\n\"But sir,\" Lily finally asked, her curious nature everpresent, \"if you've found the solution for f(10^12,10^6), what would you like me to do with this newfound knowledge?\"\n\nThe old man smiled wisely. \"My dear Lily, mathematics is a language, a key that unlocks doors to new possibilities. I want you to share this problem with the villagers, inspire them to embark on their own mathematical journeys. Who knows? Perhaps someone among them will find a new way of looking at the problem, a fresh perspective that leads to even greater discoveries.\"\n\nAnd so, with the mathematical problem buzzing through her thoughts, Lily returned to the village of Mathemaris. She gathered the villagers and enthusiastically recounted her encounters with the old man and the fascinating mathematical problem he had unraveled. The villagers, inspired by Lily's passion, formed study groups, engaged in discussions, and ventured into the unknown depths of mathematics.\n\nDays turned into weeks, and weeks turned into months once again. The villagers of Mathemaris delved into the mystery of f(10^12,10^6), challenging their minds and pushing the boundaries of mathematical knowledge.\n\nAnd now, dear reader, it is your turn. Can you solve the mathematical problem that has captivated the minds of Mathemaris? Will you be the one to crack the code and unravel the secrets of f(10^12,10^6)? As you ponder the intricacies of the problem, remember that mathematics is not just a subject but an adventure waiting to be explored.\n\nThe question remains: What is f(10^12,10^6)?"}, {"id": 352, "euler_id": 352, "title": "Blood tests", "problem": "\nEach one of the 25 sheep in a flock must be tested for a rare virus, known to affect 2% of the sheep population.\nAn accurate and extremely sensitive PCR test exists for blood samples, producing a clear positive / negative result, but it is very time-consuming and expensive.\n\n\nBecause of the high cost, the vet-in-charge suggests that instead of performing 25 separate tests, the following procedure can be used instead:\nThe sheep are split into 5 groups of 5 sheep in each group. \nFor each group, the 5 samples are mixed together and a single test is performed. Then,\nIf the result is negative, all the sheep in that group are deemed to be virus-free.\nIf the result is positive, 5 additional tests will be performed (a separate test for each animal) to determine the affected individual(s).\n\nSince the probability of infection for any specific animal is only 0.02, the first test (on the pooled samples) for each group will be:\nNegative (and no more tests needed) with probability 0.985 = 0.9039207968.\nPositive (5 additional tests needed) with probability 1 - 0.9039207968 = 0.0960792032.\n\nThus, the expected number of tests for each group is 1 + 0.0960792032 \u00d7 5 = 1.480396016.\nConsequently, all 5 groups can be screened using an average of only 1.480396016 \u00d7 5 = 7.40198008 tests, which represents a huge saving of more than 70% !\n\n\nAlthough the scheme we have just described seems to be very efficient, it can still be improved considerably (always assuming that the test is sufficiently sensitive and that there are no adverse effects caused by mixing different samples). E.g.:\nWe may start by running a test on a mixture of all the 25 samples. It can be verified that in about 60.35% of the cases this test will be negative, thus no more tests will be needed. Further testing will only be required for the remaining 39.65% of the cases.\nIf we know that at least one animal in a group of 5 is infected and the first 4 individual tests come out negative, there is no need to run a test on the fifth animal (we know that it must be infected).\nWe can try a different number of groups / different number of animals in each group, adjusting those numbers at each level so that the total expected number of tests will be minimised.\n\nTo simplify the very wide range of possibilities, there is one restriction we place when devising the most cost-efficient testing scheme: whenever we start with a mixed sample, all the sheep contributing to that sample must be fully screened (i.e. a verdict of infected / virus-free must be reached for all of them) before we start examining any other animals.\n\nFor the current example, it turns out that the most cost-efficient testing scheme (we'll call it the optimal strategy) requires an average of just 4.155452 tests!\n\n\n\nUsing the optimal strategy, let T(s,p) represent the average number of tests needed to screen a flock of s sheep for a virus having probability p to be present in any individual.\nThus, rounded to six decimal places, T(25, 0.02) = 4.155452 and T(25, 0.10) = 12.702124.\n\n\nFind \u2211\u2009T(10000, p) for p=0.01, 0.02, 0.03, ... 0.50.\nGive your answer rounded to six decimal places.\n", "solution": "378563.260589", "difficulty": 55, "story": "Once upon a time in the rolling hills of countryside, there was a village surrounded by lush green fields. In this idyllic setting, there lived a shepherd named Samuel who tended to a large flock of 10000 sheep. Samuel took great pride in his profession and was always ready to go to great lengths to ensure the health and well-being of his sheep.\n\nOne quiet morning, as the sun began to rise over the horizon, Samuel received some distressing news from the local veterinarian. A rare virus had been detected in the neighboring village, and there was a chance it could spread to Samuel's flock. The vet explained that there was an accurate and extremely sensitive PCR test available to identify whether a sheep was infected or not. However, the test was not only time-consuming but also expensive. Each test cost a significant amount of money, and Samuel couldn't afford to test each of his 10000 sheep individually.\n\nThinking of a solution, the vet suggested a testing procedure that would not only save time but also reduce costs. The sheep were to be split into groups of 5, with 2000 groups in total. For each group, the vet would take blood samples from 5 sheep and mix them together for a single test. If the result came out negative, it meant all the sheep in that group were virus-free. However, if the result was positive, Samuel would have to perform 5 additional tests, one for each animal in that group, to determine the affected individual(s).\n\nThe vet further explained that the probability of infection for any specific sheep was only 0.01, meaning that only 1% of the flock could potentially be infected. This information allowed Samuel to calculate the optimal strategy for testing his flock. With careful consideration, he discovered that using this method, on average, only 4.155452 tests would be needed to screen a flock of 10000 sheep for the virus.\n\nExcited about his findings, Samuel set out to implement this cost-efficient testing scheme for his flock. But as he gathered his sheep and prepared for the first round of testing, he couldn't help but wonder: How does this optimal strategy apply to different probabilities of infection?\n\nAs Samuel embarked on this journey to safeguard his flock, he pondered the question that now lay before him. How could he find the sum of T(10000, p) for p=0.01, 0.02, 0.03, ... 0.50? He knew that the answer would not only help him protect his precious sheep but also enable him to contribute valuable insights to his fellow shepherds.\n\nCan you, dear reader, help Samuel in his quest to find the sum of T(10000, p)? And in doing so, can you unlock the most cost-effective strategy to ensure the safety of his flock? The fate of Samuel's sheep rests in your hands."}, {"id": 367, "euler_id": 367, "title": "Bozo sort", "problem": "\nBozo sort, not to be confused with the slightly less efficient bogo sort, consists out of checking if the input sequence is sorted and if not swapping randomly two elements. This is repeated until eventually the sequence is sorted.\n\n\nIf we consider all permutations of the first 4 natural numbers as input the expectation value of the number of swaps, averaged over all 4! input sequences is 24.75.\nThe already sorted sequence takes 0 steps. \n\n\nIn this problem we consider the following variant on bozo sort.\nIf the sequence is not in order we pick three elements at random and shuffle these three elements randomly.\nAll 3!=6 permutations of those three elements are equally likely. \nThe already sorted sequence will take 0 steps.\nIf we consider all permutations of the first 4 natural numbers as input the expectation value of the number of shuffles, averaged over all 4! input sequences is 27.5. \nConsider as input sequences the permutations of the first 11 natural numbers.\nAveraged over all 11! input sequences, what is the expected number of shuffles this sorting algorithm will perform?\n\n\nGive your answer rounded to the nearest integer.\n", "solution": "48271207", "difficulty": 55, "story": "Once upon a time, in a small village named Numerica, there lived a brilliant mathematician named Oliver. Despite his immense talent, Oliver was no stranger to challenges. One day, as he strolled through the bustling marketplace, he overheard a group of villagers discussing a peculiar sorting algorithm known as Bozo sort.\n\nOliver's interest was piqued, and he eavesdropped on their conversation. They spoke of a variant of Bozo sort, where instead of swapping two elements randomly, three elements were shuffled randomly. This new algorithm intrigued Oliver, as he realized it had the potential to revolutionize the way people approached sorting problems.\n\nDriven by curiosity, Oliver began pondering over the mathematical aspects of this new variant. He remembered the expectation value of the number of shuffles for permutations of the first four natural numbers was 27.5, according to the problem. However, he wondered what would happen if he used permutations of the first eleven natural numbers instead.\n\nAs he walked back to his study, Oliver deliberated on the complexities of the algorithm. He knew that the already sorted sequence would take zero steps, but what about the rest? Would the number of shuffles increase or decrease as the input sequence grew larger? Oliver's mind raced with possibilities.\n\nWeeks turned into months, and Oliver found himself delving deeper into the world of permutations and shuffles. He spent countless hours analyzing the patterns and complexities of the algorithm, determined to uncover the expected number of shuffles for all 11! input sequences. The mathematical problem consumed his every thought.\n\nOliver's dedication did not go unnoticed. His friends and fellow villagers marveled at his perseverance and the radiant excitement that emanated from him. They couldn't help but be captivated by his relentless pursuit of knowledge and understanding.\n\nNow, with the realization that the expected number of shuffles could shape the future of sorting algorithms, Oliver had a burning question in his heart. His desire to know, to unravel the hidden secrets of mathematics, compelled him to seek an answer. But the answer eluded him, obscured by the vastness of possibilities that the permutations of eleven natural numbers presented.\n\nAs he gathered his thoughts, Oliver couldn't help but wonder: What would be the expected number of shuffles for all 11! input sequences of this variant of the Bozo sort? From the already sorted sequence to the most jumbled one, would there be a discernible pattern, or would it remain an enigma, forever beyond his reach?\n\nWith this question, Oliver realized that his journey was far from over. The pursuit of knowledge required patience, resilience, and a willingness to embrace the unknown. And so, he continued his mathematical exploration, driven by the hope of unraveling the secrets hidden within the realm of Bozo sort.\n\nAnd now, dear reader, I pose the same question to you: Averaged over all 11! input sequences, what is the expected number of shuffles this sorting algorithm will perform? As with any great mystery, the answer lies in the realm of numbers, awaiting an inquisitive mind to unravel its secrets."}, {"id": 388, "euler_id": 388, "title": "Distinct Lines", "problem": "\nConsider all lattice points (a,b,c) with 0 \u2264 a,b,c \u2264 N.\n\n\nFrom the origin O(0,0,0) all lines are drawn to the other lattice points.\nLet D(N) be the number of distinct such lines.\n\n\nYou are given that D(1 000 000) = 831909254469114121.\n\nFind D(1010). Give as your answer the first nine digits followed by the last nine digits.\n", "solution": "831907372805129931", "difficulty": 55, "story": "Once upon a time, in a quaint little village nestled in the heart of a lush valley, there lived a young boy named Ethan. Ethan possessed an insatiable curiosity that fueled his love for exploration and discovery. His greatest joy was found in the mysteries of the world, and his fertile imagination often led him on fantastical journeys.\n\nOne day, Ethan stumbled upon an old, dusty book tucked away in his grandfather's attic. Its pages were yellowed with age, and its cover bore the title, \"The Secrets of the Lattice Points.\" Intrigued, Ethan began leafing through the worn pages, and his eyes widened in awe as he read about the magical properties of these points.\n\nThe book revealed that lattice points were nothing but the coordinates of three-dimensional intersections formed by integer values. The author described an extraordinary phenomenon - when lines are drawn from those lattice points to the origin of the coordinate system, unique patterns would emerge. The number of distinct lines, known as D(N), became increasingly intriguing to Ethan.\n\nAs he delved deeper into the pages of the book, Ethan's mind became consumed by the numbers, the lines, and the beauty hidden within this seemingly ordinary concept. He desperately yearned to witness this phenomenon for himself, to comprehend the magnificence that awaited those willing to explore the world of lattice points.\n\nWith determination burning in his heart, Ethan set off on an adventure to an ancient and mystical land known as the Valley of Numbers. Legends whispered that the Valley held unimaginable secrets and that only those who possessed the greatest of mathematical minds could unlock its mysteries.\n\nGuided by an ancient wind, Ethan found himself standing in the middle of the Valley. The air crackled with anticipation, and his heart raced in excitement. He gazed around and marveled at the sight before him - thousands of diamond-shaped crystals, each representing a vibrant lattice point.\n\nEthan's senses heightened as he took a step forward, extending his hand toward the nearest crystal. Electricity surged through his veins as his fingers touched the surface. With joyful amazement, he witnessed a line forming from the origin to that very lattice point. The thrill of discovery filled him with an inexplicable sense of wonder.\n\nAs Ethan continued his exploration, drawing lines from the origin to various lattice points, his mind whirled with thoughts of patterns and possibilities. He realized that the number of distinct lines, D(N), held the key to comprehending the enigma of lattice points.\n\nWith each line he drew, the magic of the Valley of Numbers unfolded before his eyes. Every intersection between the lines became a symbol of immeasurable beauty and infinite potential. The Valley whispered its secrets to Ethan, revealing that the number of distinct lines could be infinitely vast, yet always connected to the elegant simplicity of the lattice points.\n\nTime seemed to stand still as Ethan reveled in the marvels of the Valley. But alas, like all good things, his adventure too had to come to an end. With a heavy heart, he bid farewell to the Valley of Numbers, promising himself that he would continue the quest for knowledge in the world beyond.\n\nReturning home, Ethan buried himself in the book he had discovered in his grandfather's attic. He discovered a puzzling challenge awaiting him - the solution to find D(1010), the first nine digits followed by the last nine digits. It was the ultimate test of his passion for mathematics and his boundless imagination.\n\nAs the last rays of the setting sun illuminated his face, Ethan closed his eyes and pondered the question that lay before him. How could he calculate D(1010)? What path should he take to unravel this numerical enigma? And so, with a burning determination, he whispered to himself, \"How can I find the answer? Can you solve the puzzle of D(1010)?\"\n\nAnd thus, dear reader, I leave you with this question. Can you solve the enigma of D(1010)? What mathematical insights and intuitions will guide you toward the answer? The challenge awaits, and the Valley of Numbers beckons to those who dare to venture into its realms."}, {"id": 394, "euler_id": 394, "title": "Eating pie", "problem": "\nJeff eats a pie in an unusual way.\nThe pie is circular. He starts with slicing an initial cut in the pie along a radius.\nWhile there is at least a given fraction F of pie left, he performs the following procedure:\n- He makes two slices from the pie centre to any point of what is remaining of the pie border, any point on the remaining pie border equally likely. This will divide the remaining pie into three pieces. \n- Going counterclockwise from the initial cut, he takes the first two pie pieces and eats them.\nWhen less than a fraction F of pie remains, he does not repeat this procedure. Instead, he eats all of the remaining pie.\n\n\n\n\nFor x \u2265 1, let E(x) be the expected number of times Jeff repeats the procedure above with F = 1/x.\nIt can be verified that  E(1) = 1, E(2) \u2248 1.2676536759, and E(7.5) \u2248 2.1215732071.\n\n\nFind E(40) rounded to 10 decimal places behind the decimal point.\n", "solution": "3.2370342194", "difficulty": 55, "story": "Once upon a time, in a quaint little town called Numeria, there existed a bakery known far and wide for its delicious pies. The bakery was run by a jolly old man named Mr. Thompson, who baked pies that seemed to have a magical quality about them. People would travel from afar just to get a taste of his wonderful creations.\n\nAmong the regular customers of Mr. Thompson's bakery was a young lad named Jeff. Jeff was a curious boy with a love for puzzles and riddles. He would often spend hours inside the bakery, watching Mr. Thompson work his magic in the kitchen. But what fascinated Jeff the most were the pies.\n\nOne day, Mr. Thompson had a surprise waiting for Jeff. He had made a special pie, one that would challenge the young lad's curiosity and love for puzzles. It was a pie unlike any other, and it came with a peculiar set of instructions.\n\n\"Jeff,\" Mr. Thompson smiled, handing him the pie. \"This is no ordinary pie. It holds a mathematical mystery within it. As you eat, you will uncover a remarkable pattern.\"\n\nJeff's eyes widened with excitement as he examined the pie. It was perfectly circular, just like the regular ones, but there was a distinct initial cut made straight from the center to the edge.\n\n\"In this pie,\" Mr. Thompson explained, \"you must begin by slicing it along the radius, just as it is now. But as you eat, you must follow a special procedure. You will make two more cuts, starting from the center, and ending at any point on what's left of the crust. This will create three new slices.\"\n\nJeff listened intently, hanging on to Mr. Thompson's every word. \"Once you make these cuts,\" Mr. Thompson continued, \"you take the first two slices, starting from where you made the initial cut, and you devour them. Then, you follow the same procedure again, until there is less than a given fraction F of pie remaining.\"\n\n\"To solve this mathematical mystery,\" he said, eyes twinkling mischievously, \"you must figure out the expected number of times this procedure can be repeated for different values of F. How many times should you repeat it if F is 1, 2, and even 7.5? And finally, can you tell me how many times this procedure should be repeated if F is 40?\"\n\nJeff couldn't wait to dig into the pie and uncover the secrets hidden within its sumptuous layers. How many times would he have to go through the process before the fraction F was less than 40?\n\nAs he took his first bite, savoring the mouthwatering flavor, Jeff's mind was already racing, trying to piece together the solution to the mathematical mystery that lay before him. How many more times would he have to repeat the procedure? How many more delicious bites awaited him as he journeyed deeper into the unknown?\n\nAnd so, dear reader, I pose the same question to you: Can you solve the mathematical mystery of E(40)? How many times should Jeff repeat the procedure before there is less than a fraction of 40 remaining? The answer lies within the pie, waiting to be discovered. Will you take up the challenge and unravel this tantalizing puzzle?"}, {"id": 398, "euler_id": 398, "title": "Cutting rope", "problem": "\nInside a rope of length n, n-1 points are placed with distance 1 from each other and from the endpoints. Among these points, we choose m-1 points at random and cut the rope at these points to create m segments.\n\n\nLet E(n, m) be the expected length of the second-shortest segment.\nFor example, E(3, 2) = 2 and E(8, 3) = 16/7.\nNote that if multiple segments have the same shortest length the length of the second-shortest segment is defined as the same as the shortest length.\n\n\nFind E(107, 100).\nGive your answer rounded to 5 decimal places behind the decimal point.\n", "solution": "2010.59096", "difficulty": 55, "story": "Once upon a time in the bustling village of Mathlandia, there lived a talented rope-maker named Arthur. Arthur was known far and wide for his exceptional ability to create ropes of all sizes and lengths. His ropes were so well-crafted that they were sought after not only by the villagers but also by traders from neighboring kingdoms.\n\nOne bright morning, Arthur received a special request from an esteemed mathematician named Professor Edwards. The professor had been pondering a complex mathematical problem and believed that Arthur's expertise with ropes could be the key to finding a solution. Intrigued, Arthur invited Professor Edwards to his humble workshop to discuss the matter.\n\nAs the professor explained the problem to Arthur, the rope-maker's eyes sparkled with curiosity. Inside a rope of length n, n-1 points were placed with a distance of 1 from each other and from the endpoints. From these points, m-1 were randomly selected to cut the rope and create m segments. The professor then asked Arthur to find the expected length of the second-shortest segment, denoted as E(n, m).\n\nArthur's mind whirred with excitement as he tried to visualize the problem. He could already see how he could incorporate it into his rope-making skills. Together, Arthur and Professor Edwards began working tirelessly, experimenting with different rope lengths and cutting patterns. They measured and calculated, snipping the ropes at various points and noting the lengths of each segment.\n\nWeeks turned into months, and the duo dedicated themselves to the study of ropes and mathematics. They dissected countless ropes of varying lengths, meticulously recording their findings. Each day presented a new challenge, as the rope-maker and the mathematician delved deeper into the fascinating world of mathematical probabilities.\n\nAs Arthur and Professor Edwards continued their quest for an answer, news of their collaboration spread throughout the village. People began to gather outside the workshop, eagerly awaiting the outcome of their endeavors. The village was abuzz with excitement, for everyone understood the significance of finding E(107, 100), a number that would pose a monumental breakthrough in the field of mathematics.\n\nBut as the days turned into months and then into years, Arthur and Professor Edwards had yet to uncover the solution. The rope-maker's once bright eyes grew tired, while the mathematician's once-fervent spirit began to dwindle. Doubt started to creep into their hearts, clouding their belief that they could unravel the mystery that seemed to elude them.\n\nOne stormy evening, as Arthur sat by the fireplace, he stared into the dancing flames, searching for a glimmer of inspiration. He recalled how the problem of E(n, m) had consumed his life, how it had grown to be more than just a mathematical puzzle. It had come to represent the beauty of curiosity, the power of human collaboration, and the unrelenting pursuit of knowledge.\n\nSuddenly, a gust of wind blew through the open window, sending a shiver down Arthur's spine. An idea sparked in his mind, as radiant as the lightning illuminating the dark sky outside. Arthur realized that the answer wasn't just in the calculations and numbers\u2014they had missed the forest for the trees. They had lost sight of the magic that mathematics possessed.\n\nWith a newfound vigor, Arthur leaped from his chair and rushed to the neighboring house where Professor Edwards resided. The professor opened the door, surprise evident on his face. Arthur grabbed his hand and led him back to the workshop.\n\nAs they stood amidst the ropes that lay scattered across the room, Arthur looked at Professor Edwards with a smile. The rope-maker realized that the true beauty of their collaboration was not in finding the answer but in the journey they had embarked upon together. Their quest had elevated their minds, deepened their connection, and sparked an undying curiosity that would continue to burn brightly within them.\n\nAnd so, dear reader, I leave you with this, the question that still lingers in both Arthur's and Professor Edwards' hearts...\n\nCan you find the answer to E(107, 100)? Will you venture into the fascinating realm of mathematics and unlock the secret that has eluded our heroes?"}, {"id": 400, "euler_id": 400, "title": "Fibonacci tree game", "problem": "\nA Fibonacci tree is a binary tree recursively defined as:T(0) is the empty tree.\nT(1) is the binary tree with only one node.\nT(k) consists of a root node that has T(k-1) and T(k-2) as children.\n\nOn such a tree two players play a take-away game. On each turn a player selects a node and removes that node along with the subtree rooted at that node.\nThe player who is forced to take the root node of the entire tree loses.\n\nHere are the winning moves of the first player on the first turn for T(k) from k=1 to k=6.\n\n\n\n\nLet f(k) be the number of winning moves of the first player (i.e. the moves for which the second player has no winning strategy) on the first turn of the game when this game is played on T(k).\n\n\n\nFor example, f(5) = 1 and f(10) = 17.\n\n\nFind f(10000). Give the last 18 digits of your answer.\n", "solution": "438505383468410633", "difficulty": 55, "story": "Once upon a time, in a magical forest filled with dazzling flowers and towering trees, there lived two mischievous monkeys named Milo and Luna. They were the best of friends and loved to play games together. One sunny morning, while swinging from branch to branch, they stumbled upon a peculiar tree.\n\nCuriosity sparkled in their eyes as they observed the tree and its unique structure, each branch carefully branching out into two smaller branches. Milo, being the adventurous and inquisitive monkey, proposed that they should play a game on the tree.\n\nLuna agreed enthusiastically, and that's when they both learned about the Fibonacci tree and its fascinating properties. They discovered that the tree followed a specific pattern, where T(0) was an empty tree, T(1) had only one node, and T(k) had a root node connected to T(k-1) and T(k-2). It was like a beautiful puzzle for them to unravel.\n\nBut what made the Fibonacci tree truly intriguing was the take-away game they played on it. Each turn, one of them would select a node and remove that node along with the entire subtree rooted at that node. The player who was forced to take the root node of the entire tree would lose.\n\nExcitement filled the air as Milo and Luna devised strategies to outwit one another. They quickly realized that some moves were advantageous, while others led to certain defeat. They began recording their observations carefully, trying to find patterns that would help them make wiser choices.\n\nAs their playful battles continued, Milo noticed something extraordinary: certain positions provided the first player with a winning strategy. This intrigued him greatly, and he jotted down the number of winning moves for the first player on the first turn for each value of k. He named this number f(k).\n\nMilo's eyes gleamed with excitement as he saw a pattern emerging. For T(5), there was only one winning move, and for T(10), there were seventeen. But what about T(10000)? It seemed like an unimaginable number, and Milo was determined to find out the answer.\n\nDays turned into months, and the magical forest witnessed the monkeys engaged in an endless pursuit of knowledge and strategy. They pondered and debated, explored and experimented. But with each passing day, their curiosity grew, reaching a crescendo that seemed impossible to satisfy.\n\nOne evening, as the sun began its descent behind the treetops, Milo and Luna sat on a mossy stone, contemplating their journey. The Fibonacci tree stood tall before them, whispering secrets that only they could comprehend. It had become an integral part of their lives, shaping their thoughts and sparking their imaginations.\n\nThe stars began to sprinkle the sky, painting a breathtaking canvas above. Luna turned to Milo and asked, her voice filled with earnestness, \"Milo, my dear friend, we have come so far in our quest for knowledge. But what about f(10000)? What could be the last 18 digits of that elusive number?\"\n\nMilo gazed at the Fibonacci tree, its branches shimmering in the moonlight. A smile tugged at the corners of his mouth as he realized the magnitude of Luna's question. How could they uncover the answer? How could they quench their insatiable curiosity?\n\nWith a playful glint in his eyes, Milo turned to Luna and said, \"Let us embark on one final adventure, my friend. Together, we shall find the answer, deep within the heart of this magical forest. And who knows, maybe the answer will reveal itself in the most unexpected ways.\"\n\nAnd so, hand in hand, Milo and Luna set off on their final quest, leaving behind a trail of laughter and anticipation. The Fibonacci tree stood silent witness, its roots digging deeper into the fertile soil, as if holding the secrets of the universe.\n\nThe night unfolded its mysteries, and the monkeys disappeared into the woods, their whispers blending with the nocturnal sounds. The enchanted forest twinkled with anticipation, waiting for the moment when they would return, triumphantly bearing the last 18 digits of f(10000).\n\nBut how will Milo and Luna find the answer to their mathematical conundrum? Will they stumble upon a wise old owl who holds the key to their question? Or will they look deep within themselves and discover the magic their friendship possesses? Only time will tell, as the adventurous monkeys chase their dreams through the wondrous expanse of the Fibonacci tree.\n\nAnd so, dear reader, I turn the page to you. Can you solve the mystery of f(10000)? What could be the last 18 digits of this captivating number? Join Milo and Luna on their adventure and unravel the final piece of the puzzle, nestled within the heart of the Fibonacci tree."}, {"id": 402, "euler_id": 402, "title": "Integer-valued polynomials", "problem": "\nIt can be shown that the polynomial n4 + 4n3 + 2n2 + 5n is a multiple of 6 for every integer n. It can also be shown that 6 is the largest integer satisfying this property.\n\n\nDefine M(a, b, c) as the maximum m such that n4 + an3 + bn2 + cn is a multiple of m for all integers n. For example, M(4, 2, 5) = 6.\n\n\nAlso, define S(N) as the sum of M(a, b, c) for all 0 < a, b, c \u2264 N.\n\n\nWe can verify that S(10) = 1972 and S(10000) = 2024258331114.\n\n\nLet Fk be the Fibonacci sequence:\nF0 = 0, F1 = 1 and\nFk = Fk-1 + Fk-2 for k \u2265 2.\n\n\nFind the last 9 digits of \u2211\u2009S(Fk) for 2 \u2264 k \u2264 1234567890123.\n", "solution": "356019862", "difficulty": 55, "story": "Once upon a time, in the tiny village of Mathlandia, there lived a curious young girl named Emma. Emma was renowned for her love of puzzles and her unquenchable thirst for knowledge. She spent her days exploring the world and seeking to unravel the mysteries that surrounded her. However, one mathematical problem had always eluded her: the enigmatic polynomial.\n\nOne day, as Emma was rummaging through the shelves of the village library, a dusty old book caught her eye. It was titled \"Mathemagical Wonders\" and seemed to beckon her with promises of adventure. Intrigued, Emma opened it to a page that made her heart skip a beat. There, she found the mathematical problem she had yearned to solve for so long.\n\nWith wide eyes and a quickened pulse, Emma began to read the problem aloud to herself. The words transported her to a world of numbers and possibilities, filling her imagination with excitement. She understood that the polynomial was a multiple of 6 for every integer, and that 6 was its largest divisor with this property. But there was more to the puzzle.\n\nEmma discovered M(a, b, c), a function that calculated the maximum divisor m for which the polynomial was a multiple, and S(N), the sum of all M(a, b, c) values from 0 to N. She was captivated by these definitions and wanted to dive deeper into the realm of mathematics. The young girl felt that this problem held the key to unlock a profound secret.\n\nAs days turned into weeks, and weeks into months, Emma threw herself into finding a solution. She scribbled countless equations on parchment, delved into the works of ancient mathematicians, and consulted with scholars from distant lands. The mystery consumed her every waking moment, driving her to unravel its mathematical fabric.\n\nAlong the way, Emma encountered many challenges. The answers she sought seemed just out of reach, like stars in the night sky. But she never lost hope and persevered, fueled by her love for the subject and her insatiable curiosity. The village watched in awe as Emma's determination propelled her forward.\n\nMeanwhile, the people of Mathlandia started to realize that Emma's quest was transforming their village. Inspired by her passion, children and adults alike began to embrace the beauty of mathematics. Every family had lively discussions around the dinner table, and neighbors came together to solve complex equations. The spirit of curiosity and exploration infused the air, making Mathlandia a vibrant and intellectually stimulating place.\n\nAs Emma grew older, her understanding of the polynomial deepened. She started to see patterns emerge, connections between numbers previously unseen. Math became not just a subject for her but a true companion\u2014one that continually revealed secrets and bestowed its bounty upon the curious mind.\n\nBut still, the solution to the problem eluded her. Emma's dedication had brought her to the edge of understanding, but the final piece of the puzzle remained tantalizingly out of reach. Yet, she refused to be discouraged. Emma knew that the answer lay dormant within her, waiting for the right moment to reveal itself.\n\nAnd so, dear reader, I ask you this: can you be the one to decipher the hidden code and reveal the last 9 digits of \u2211 S(Fk) for 2 \u2264 k \u2264 1234567890123? Can you help Emma, the village of Mathlandia, and all those who seek the beauty of numbers? The pursuit of knowledge is a journey that never truly ends; it requires passionate souls to unlock its wonders. Will you heed the call and embark on this mathematical adventure?"}, {"id": 403, "euler_id": 403, "title": "Lattice points enclosed by parabola and line", "problem": "\nFor integers a and b, we define D(a, b) as the domain enclosed by the parabola y = x2 and the line y = a\u00b7x + b:D(a, b) = { (x, y) | x2 \u2264 y \u2264 a\u00b7x + b }.\n\n\nL(a, b) is defined as the number of lattice points contained in D(a, b).\nFor example, L(1, 2) = 8 and L(2, -1) = 1.\n\n\nWe also define S(N) as the sum of L(a, b) for all the pairs (a, b) such that the area of D(a, b) is a rational number and |a|,|b| \u2264 N.\nWe can verify that S(5) = 344 and S(100) = 26709528.\n\n\nFind S(1012). Give your answer mod 108.\n", "solution": "18224771", "difficulty": 55, "story": "Once upon a time, in the kingdom of Mathlandia, there lived a young princess named Ariella. She was known for her exceptional intelligence, especially in the field of mathematics. Ariella had a natural talent for solving complex equations and puzzles, much to the awe and admiration of her subjects.\n\nOne day, the king of Mathlandia received a letter from a neighboring kingdom, posing a challenge that would put Ariella's skills to the test. The letter contained a mathematical problem, one that promised great rewards to anyone who could solve it.\n\nAriella's eyes shimmered with excitement as she read the problem aloud to herself. The challenge intrigued her. She knew this was an opportunity to prove her prowess beyond Mathlandia's borders. With a determined spirit, she set out to solve it.\n\nFor days and nights, Ariella immersed herself in the mathematical problem. She scribbled equations, plotted graphs, and racked her brain for a solution that would unlock the secret to the elusive S(N). The people of Mathlandia watched in anticipation, curious about the outcome of the kingdom's prized mathematician.\n\nAs Ariella delved deeper, she stumbled upon a realization that shook her analytical mind. The problem wasn't just about numbers; it told a story of its own. In the graph, she saw a parabola stretching wide, gently curving upwards, and a line soaring through, intersecting the parabola at various points.\n\nLost in her musings, Ariella imagined the parabola as the beautiful arc of a rainbow, while the line captured the soaring heights of a magnificent eagle. She saw the domain enclosed by the parabola and the line as a mysterious realm where hidden treasures lay waiting to be discovered.\n\nSuddenly, a knock on the door interrupted Ariella's daydreaming. It was her faithful advisor, Sir Pythagoras, bearing news from the neighboring kingdom. They had declared a competition to determine the greatest mathematician in the realm. The challenge was to solve S(1012) and, just as quickly as the news arrived, Sir Pythagoras vanished once again, leaving Ariella to ponder.\n\nThis revelation ignited a fire within Ariella. She realized that winning this competition would mean more than just earning the title of the greatest mathematician. It would bring fame and recognition to Mathlandia and prove that equations held the power to unlock the greatest treasures.\n\nAriella's days and nights became filled with purpose. She delved deeper into the problem, exploring every possible solution. It consumed her thoughts, her dreams, and her very being. As she scribbled tirelessly, Sir Pythagoras watched from the shadows, observing his brilliant prot\u00e9g\u00e9 conquer the challenge.\n\nFinally, the day of the competition arrived. Mathematicians from far and wide gathered in the grand hall of the neighboring kingdom, eagerly waiting to witness the unveiling of the solution to S(1012). The atmosphere buzzed with anticipation.\n\nAriella stepped onto the stage, heart pounding, and with one final stroke of her pen, she presented her solution to the world. The crowd held their breath as they listened intently to her explanation. The judges scrutinized every detail, every equation, and every graph.\n\nSilence filled the room as Ariella concluded her presentation. The judges exchanged glances, their expressions unreadable. Finally, the head judge cleared his throat and spoke, breaking the tension that had enveloped the audience.\n\n\"Ladies and gentlemen, without a doubt, Princess Ariella has presented a remarkable solution to the mathematical problem,\" he began, a smile dancing upon his lips. \"However, there is one final challenge...\"\n\nThe crowd leaned forward, desperate to know what lay ahead. Ariella herself leaned in, her eyes gleaming with determination.\n\n\"We commend Princess Ariella for her extraordinary skills, but we must pose one final question,\" the head judge continued. \"Can anyone here, anyone at all, solve S(1012) and give us the answer modulo 108?\"\n\nThe room fell silent once again, and the question echoed in the minds of mathematicians and spectators alike. Could someone crack the code? Could anyone unlock the answer to the greatest mathematical conundrum of their time?\n\nAs the crowd dispersed, leaving Ariella alone on the stage, she couldn't help but wonder, her curiosity reignited.\n\n\"Who will solve this grand mystery?\" she whispered to herself, a spark of hope flickering within her eyes. \"Who will reveal the secret behind S(1012) and claim the ultimate victory?\"\n\nAnd so, the question lingered in the air, waiting for a mathematically inclined soul to venture forth and unravel the enigma that had stumped the brightest minds. Who will be the one to answer?\n\nCan you solve S(1012) and give us the answer modulo 108?"}, {"id": 409, "euler_id": 409, "title": "Nim Extreme", "problem": "Let n be a positive integer. Consider nim positions where:There are n non-empty piles.\nEach pile has size less than 2n.\nNo two piles have the same size.\nLet W(n) be the number of winning nim positions satisfying the above\nconditions (a position is winning if the first player has a winning strategy). For example, W(1) = 1, W(2) = 6, W(3) = 168, W(5) = 19764360 and W(100) mod 1\u00a0000\u00a0000\u00a0007 = 384777056.\n\nFind W(10\u00a0000\u00a0000) mod 1\u00a0000\u00a0000\u00a0007.\n", "solution": "253223948", "difficulty": 55, "story": "Once upon a time, in a small village nestled amidst rolling green hills and babbling brooks, lived a young and curious girl named Lila. Lila possessed a vibrant imagination and an insatiable thirst for knowledge, which she satisfied by exploring the farthest corners of the village library.\n\nOne sunny afternoon, while perusing the shelves, Lila stumbled across an old, weathered book with faded golden letters adorning its spine. As she opened the book, a cloud of dust billowed, and she found herself captivated by its pages. The book, it seemed, held secrets and mysteries waiting to be unraveled.\n\nAmong the tales and riddles within the book, Lila discovered a peculiar mathematical problem. It was called \"Winning Nim Positions.\" The problem intrigued her, for it seemed to hold a secret to another world where numbers held the power to shape events.\n\nFrom what she gathered, the problem involved nim positions - a curious game played with piles of objects. Each pile had a unique size and was less than twice the positive integer, n. The rules were simple: no two piles could have the same size, and the player who made the final move would be declared the winner.\n\nLila's fascination with the problem grew, and she soon found herself lost in a story of numbers and strategy. She marveled at the pattern these nim positions followed, their inherent beauty in the intricacies of order and size.\n\nOne day, while exploring the meadow near her home, Lila stumbled upon an old oak tree. Its gnarled roots peeked through the earth, as if inviting her to sit beneath its grand branches. As she sat down, her mind conjured up nim positions, each one filled with piles of objects stacked in various ways.\n\nSuddenly, a gust of wind whispered through the trees, as if urging Lila to delve deeper into the mathematical problem. She found herself pondering the winning nim positions for higher values of n, eager to uncover the secrets they held.\n\nAs the days turned into weeks, Lila became entranced, spending every waking moment solving the problem, uncovering its hidden depths. She painted the nim positions in her mind, each one a beautiful mosaic of piles, their sizes greater than the last.\n\nWith every passing day, Lila's understanding of the mathematical problem grew, and she marveled at the complexity of the winning nim positions. She saw their elegance, the symmetry inherent in their arrangement, and reveled in the countless possibilities they presented.\n\nBut as she wandered the meadows and pondered the nim positions under the ancient oak tree, Lila began to feel a sense of urgency. She yearned to uncover the solution, to find the elusive W(10,000,000) mod 1,000,000,007. Night after night, she found herself lost in dreams of numbers and nim positions, her heart heavy with the weight of the unsolved riddle.\n\nAs the story draws to a close, Lila gazes out into the vastness of the meadow, her mind packed full of nim positions and their infinite combinations. She knows the moment has come to solve the final piece of the puzzle, to find W(10,000,000) mod 1,000,000,007. But before she can embark on that endeavor, there is one question that remains, a question for the reader:\n\nCan you crack the code of the nim positions and find the answer Lila so desperately seeks?"}, {"id": 436, "euler_id": 436, "title": "Unfair wager", "problem": "Julie proposes the following wager to her sister Louise.\nShe suggests they play a game of chance to determine who will wash the dishes.\nFor this game, they shall use a generator of independent random numbers uniformly distributed between 0 and 1.\nThe game starts with S = 0.\nThe first player, Louise, adds to S different random numbers from the generator until S > 1 and records her last random number 'x'.\nThe second player, Julie, continues adding to S different random numbers from the generator until S > 2 and records her last random number 'y'.\nThe player with the highest number wins and the loser washes the dishes, i.e. if y > x the second player wins.\nFor example, if the first player draws 0.62 and 0.44, the first player turn ends since 0.62+0.44 > 1 and x = 0.44.\nIf the second players draws 0.1, 0.27 and 0.91, the second player turn ends since 0.62+0.44+0.1+0.27+0.91 > 2 and y = 0.91.\nSince y > x, the second player wins.\nLouise thinks about it for a second, and objects: \"That's not fair\".\nWhat is the probability that the second player wins?\nGive your answer rounded to 10 places behind the decimal point in the form 0.abcdefghij", "solution": "0.5276662759", "difficulty": 55, "story": "Once upon a time in a small town, there lived two sisters named Julie and Louise. They were very close, but like any siblings, they occasionally had their differences. One day, as they were sitting in their cozy kitchen, a pile of dirty dishes towered in the sink, waiting to be washed.\n\nLouise was feeling particularly lazy that day and wanted to avoid doing the chores. Swiftly, a mischievous idea formed in her mind. She turned to Julie with a sly grin and said, \"Julie, I have a proposition for you. Let's play a game of chance to decide who will wash the dishes.\"\n\nJulie, always up for a challenge, eagerly agreed. Intrigued, she asked, \"How do we play this game, Louise?\"\n\nLouise explained, \"We'll use a generator that spits out random numbers between 0 and 1. I'll go first and keep adding random numbers to a sum, S, until it exceeds 1. The last random number I add will be recorded as 'x.' Then, it's your turn. You'll keep adding random numbers to the sum until it exceeds 2 and record your last random number as 'y.' The one with the higher number wins, and the loser washes the dishes.\"\n\nJulie pondered for a moment before accepting the challenge. As a lover of mathematics, she was intrigued by the game's unpredictability. Louise got the generator ready, and the game began.\n\nLouise anxiously started adding up the random numbers, hoping to exceed 1 and escape the dreaded task of dishwashing. Numbers like 0.62 and 0.44 were added to her ever-increasing sum, until finally, her turn ended with x = 0.44.\n\nNow it was Julie's turn. Her competitive spirit kicked in as she started adding her own set of random numbers to the sum. The tension in the room mounted as she threw numbers like 0.1, 0.27, and 0.91 into the mix. Finally, her turn ended, and she recorded her last random number as y = 0.91.\n\nAn air of triumph filled the kitchen as Louise shouted, \"Yes! I win! You'll be washing the dishes tonight!\"\n\nHowever, as soon as the words left Louise's mouth, Julie raised an eyebrow and said, \"Hold on a second, Louise. That doesn't seem fair.\"\n\nLouise was taken aback. \"What do you mean? We played by the rules; I won fair and square!\"\n\nJulie's eyes sparkled with a newfound determination. \"But what if I told you that there was a way to calculate the probability that the second player wins?\"\n\nLouise's curiosity was piqued. She could sense that Julie had something up her sleeve, something that would challenge her victory. Intrigued, she asked, \"How do we calculate that?\"\n\nWith a sly smile, Julie replied, \"I can't reveal it just yet. Instead, let's make a bet. If you can calculate the probability of me winning, I'll gladly wash the dishes tonight. However, if you can't, I'll be declared the winner, and you'll be doing the washing!\"\n\nLouise's competitive spirit ignited once again, and she accepted the challenge. The two sisters spent hours diving into the fascinating world of probability, discussing permutations, and analyzing the distribution of the random numbers.\n\nAs they delved deeper into the mathematical problem, time flew by. By the end of their calculations, they realized that a clever strategy could significantly alter the outcome of the game. The probability of the second player, Julie, winning was not as straightforward as it seemed.\n\nNow, the question lies before you, dear reader: What is the probability that the second player, Julie, wins? Can you crack the code and determine the answer that will alter the outcome of the dishwashing game?"}, {"id": 456, "euler_id": 456, "title": "Triangles containing the origin II", "problem": "Define:xn = (1248n mod 32323) - 16161yn = (8421n mod 30103) - 15051\nPn = {(x1, y1), (x2, y2), ..., (xn, yn)}\n\nFor example, P8 = {(-14913, -6630), (-10161, 5625), (5226, 11896), (8340, -10778), (15852, -5203), (-15165, 11295), (-1427, -14495), (12407, 1060)}.\nLet C(n) be the number of triangles whose vertices are in Pn which contain the origin in the interior.\n\nExamples:\nC(8) = 20\nC(600) = 8950634\nC(40\u00a0000) = 2666610948988\n\nFind C(2\u00a0000\u00a0000).\n", "solution": "333333208685971546", "difficulty": 55, "story": "Once upon a time, in the bustling city of Mathematica, lived a gifted mathematician named Maya. Maya was known for her incredible deductive skills and flair for solving complex mathematical problems. She dedicated her days to exploring the intricate patterns and relationships hidden within the realm of numbers.\n\nOne fateful day, as Maya poured over her stack of research papers, she stumbled upon a peculiar mathematical problem. Its elegance and complexity immediately captivated her curious mind. The problem described a sequence defined by two equations, xn and yn, and the formation of a set Pn given by a series of coordinates.\n\nIntrigued, Maya immersed herself in the problem, determined to find the underlying patterns and discover the secrets hidden within. She delved deep into the calculations, obsorbed in the interplay of numbers. As each day passed, Maya's understanding of the problem grew deeper but so did her frustration at remaining one crucial step away from deciphering it completely.\n\nOne evening, as the sun dipped below the horizon and night embraced the city, Maya found herself engrossed in a dream. She stood in a vast chamber, its walls adorned with enigmatic equations and geometric figures. In the center of the chamber, a luminous crystal floated, emanating a mystic glow.\n\nApproaching the radiant crystal, Maya felt a surge of energy coursing through her veins. As she reached out to touch it, her surroundings shimmered, and she found herself standing amidst a towering labyrinth. The walls of the labyrinth were adorned with mathematical equations that seemed to come alive, dancing and swirling around her.\n\nAs Maya navigated the labyrinth, she realized that each pathway represented a different set of coordinates from Pn. The walls shimmered with countless triangles, each with unique vertex combinations. The air buzzed with the excitement of mathematical exploration.\n\nWith her heart pounding, Maya decided to pay special attention to triangles that contained the origin, the point (0,0), within their interior. She noticed that such triangles formed a beautiful pattern, connecting the dots of her research.\n\nWith each step she took through the labyrinth, Maya envisioned a universe of triangles, weaving complex patterns and creating a symphony of mathematical harmony. Her senses tingled as she discovered connections between the vertices, their distances, and the angles they formed.\n\nGuided by her intuition, Maya began to unravel the underlying structure of the mathematical problem. The significance of the numbers, 1248 and 32323, 8421 and 30103, became clearer, as did the importance of the constant 16161 and 15051. \n\nHowever, just at the moment when Maya felt on the verge of comprehension, the dream shattered. She awoke with a start, drenched in sweat, her mind buzzing with excitement and desperate to reach a conclusion.\n\nBack in her study, Maya couldn't shake the vivid images from her dream. She tried to recapture the euphoria she had felt in the labyrinth, the connection between the triangles and the elegance of the problem. But the more she tried, the more the solution eluded her.\n\nMonths passed, and Maya's obsession with the problem continued to consume her. The intricacies of her research filled her thoughts day and night, driving away all but her insatiable hunger for answers. Yet, no matter how close she felt to unraveling the secrets of the triangle-laden labyrinth, she always found herself a single leap away from triumph.\n\nAs she sat one evening, surrounded by books and crumpled papers, a glimmer of hope flickered in her eyes. A new approach, an innovative angle, promised to break the deadlock. The solution shimmered within reach, the thrill of discovery electrifying her senses once again.\n\nWith renewed determination, Maya worked tirelessly, poring over the calculations until, at last, she met an unexpected revelation.\n\nThe existence of the origin within the interior of certain triangles was no mere coincidence\u2014it was deeply embedded within the structure of the problem. She discovered a way to systematically count the number of such triangles, a formula she termed \"C(n).\"\n\nAs exhilaration surged through her veins, Maya castigated herself for doubting her own abilities, for questioning whether the answer lay within her grasp. The solution was now tangible, her comprehension complete.\n\nBut just as Maya prepared to shout her triumph from the rooftops, a thought held her back. What about C(2,000,000)? What number would arise from such a monumental calculation? Maya found herself hesitating, acknowledging that this number, like the origin within the labyrinth of triangles, lay just beyond her reach.\n\nSo, dear reader, I invite you to embark on a journey to find C(2,000,000). Explore this enchanting mathematical problem, unearth its secrets, and discover the beauty that lies within its depths. Will you be the one to uncover the answer and bring solace to Maya's inquisitive mind?\n\nAnd so, the question remains, can you solve C(2,000,000)?"}, {"id": 511, "euler_id": 511, "title": "Sequences with nice divisibility properties", "problem": "Let Seq(n,k) be the number of positive-integer sequences {ai}1\u2264i\u2264n of length n such that:\nn is divisible by ai for 1\u00a0\u2264\u00a0i\u00a0\u2264\u00a0n, and\nn + a1 + a2 + ... + an is divisible by k.\nExamples:\nSeq(3,4) = 4, and the 4 sequences are:\n{1, 1, 3}\n{1, 3, 1}\n{3, 1, 1}\n{3, 3, 3}\nSeq(4,11) = 8, and the 8 sequences are:\n{1, 1, 1, 4}\n{1, 1, 4, 1}\n{1, 4, 1, 1}\n{4, 1, 1, 1}\n{2, 2, 2, 1}\n{2, 2, 1, 2}\n{2, 1, 2, 2}\n{1, 2, 2, 2}\nThe last nine digits of Seq(1111,24) are 840643584.\nFind the last nine digits of Seq(1234567898765,4321).", "solution": "935247012", "difficulty": 55, "story": "Once upon a time in the bustling town of Arithmetica, there lived a young girl named Emma. Emma was no ordinary girl; she possessed a unique gift for numbers. From a young age, she was able to see patterns and solve complex mathematical problems effortlessly. Her mind buzzed with the beauty of mathematics, and she often found solace in its abstract world.\n\nOne day, a great challenge befell the town. The town's crops were withering, and a severe drought threatened to wipe out the livelihood of the people. The villagers believed that their land was cursed, and they turned to Emma for guidance.\n\nEmma listened to their concerns and understood that she needed to solve a mathematical puzzle to save their crops. The puzzle involved finding a specific sequence of positive integers, and only then could the curse be broken and rain brought back to their parched fields.\n\nShe immersed herself in the problem, spending hours upon hours in her attic room, surrounded by piles of worn-out mathematical textbooks and crumbling scrolls. Emma realized that the townsfolk's salvation lay in the number n and the divisor k.\n\nAs days turned into weeks, Emma labored tirelessly, searching for the elusive solution. The villagers grew restless, their hope dwindling day by day. But Emma never lost heart; she delved deeper into the complexity of the puzzle, determined to bring an end to their suffering.\n\nHer tireless efforts finally paid off. One stormy evening, in a flickering candlelit room, Emma found the answer to the villagers' prayers. She discovered the number n and the divisor k, which would unlock the sequence that could save their crops.\n\nExcitement filled her soul as she rushed to share the good news with the villagers. They gathered anxiously, their eyes shining with hope, as Emma explained what she had found.\n\n\"Seq(n,k) holds the power,\" she proclaimed. \"Only the correct sequence of positive integers, satisfying both the condition for n and k, can break the curse and restore rain to our beloved fields.\"\n\nThe villagers listened intently, their eyes wide with anticipation. Emma wrote down the examples of Seq(3,4) and Seq(4,11) on a chalkboard and explained how they corresponded to different sequences that satisfied the conditions.\n\n\"The last nine digits of Seq(1111,24) are 840643584,\" Emma continued, \"but we face a greater challenge. We must find the last nine digits of Seq(1234567898765,4321).\"\n\nA hushed silence fell over the crowd, and all eyes turned to the mathematical prodigy. They knew she held the key to their salvation, but the answer remained elusive. The villagers wondered if they would ever see rain again or continue to suffer the torment of drought.\n\nAnd so, the question remains, dear reader: Can you solve the last part of the puzzle? What are the last nine digits of Seq(1234567898765,4321)? The fate of the villagers and their land lies in your hands."}, {"id": 532, "euler_id": 532, "title": "Nanobots on Geodesics", "problem": "Bob is a manufacturer of nanobots and wants to impress his customers by giving them a ball coloured by his new nanobots as a present.\nHis nanobots can be programmed to select and locate exactly one other bot precisely and, after activation, move towards this bot along the shortest possible path and draw a coloured line onto the surface while moving. Placed on a plane, the bots will start to move towards their selected bots in a straight line. In contrast, being placed on a ball, they will start to move along a geodesic as the shortest possible path. However, in both cases, whenever their target moves they will adjust their direction instantaneously to the new shortest possible path. All bots will move at the same speed after their simultaneous activation until each bot reaches its goal.\nNow Bob places n bots on the ball (with radius 1) equidistantly on a small circle with radius 0.999 and programs each of them to move toward the next nanobot sitting counterclockwise on that small circle. After activation, the bots move in a sort of spiral until they finally meet at one point on the ball.\nUsing three bots, Bob finds that every bot will draw a line of length 2.84, resulting in a total length of 8.52 for all three bots, each time rounded to two decimal places. The coloured ball looks like this:\n\nIn order to show off a little with his presents, Bob decides to use just enough bots to make sure that the line each bot draws is longer than 1000. What is the total length of all lines drawn with this number of bots, rounded to two decimal places?", "solution": "827306.56", "difficulty": 55, "story": "Once upon a time, in a small town called Mathville, there lived a brilliant and inventive man named Bob. Bob was not your average inventor; he specialized in creating nanobots, tiny robots capable of performing advanced tasks at the microscopic level. His creations were renowned in the scientific community, and his nanobots were in high demand worldwide.\n\nOne fateful day, Bob had a brilliant idea. He wished to impress his customers by presenting them with a special gift - a ball meticulously colored by his new nanobots. The challenge lay in directing the nanobots to draw the perfect pattern on the spherical surface.\n\nBob knew that his nanobots could be programmed to select exactly one other bot, locate it with remarkable precision, and then move towards it along the shortest possible path. Placed on a plane, the bots would simply move towards their selected target in a straight line. However, if placed on a ball, the bots would follow a geodesic, the shortest path on a curved surface.\n\nThe ingenious inventor carefully arranged n nanobots on the ball, spacing them equidistantly on a small circle with a radius of 0.999. He programmed each bot to move counterclockwise towards the next nanobot on the circle. Once activated, the bots would start their graceful dance, spiraling towards their designated destinations on the sphere.\n\nBob was fascinated by the intricate patterns created by the moving nanobots. Curiosity sparked within him, and he decided to experiment with three bots to observe their behavior. To his amazement, each bot drew a line of exactly 2.84 units, resulting in a total length of 8.52 units. The colored ball was a work of art, beautifully showcasing the precision and capabilities of his nanobots.\n\nHowever, Bob's insatiable thirst for knowledge was not yet quenched. He pondered the question of how many bots were required to ensure that each bot would draw a line longer than 1000 units. The answer could potentially revolutionize not just his nanobot creations but also open doors for various applications in nanotechnology.\n\nWill you help Bob find the solution to his intriguing problem? What could be the total length of all the lines drawn with the number of bots required to satisfy his ambitious goal? The path to discovery lies within your mathematical prowess."}, {"id": 534, "euler_id": 534, "title": "Weak Queens", "problem": "The classical eight queens puzzle is the well known problem of placing eight chess queens on a 8\u00d78 chessboard so that no two queens threaten each other. Allowing configurations to reappear in rotated or mirrored form, a total of 92 distinct configurations can be found for eight queens. The general case asks for the number of distinct ways of placing n queens on a n\u00d7n board, e.g. you can find 2 distinct configurations for n=4.\nLet's define a weak queen on a n\u00d7n board to be a piece which can move any number of squares if moved horizontally, but a maximum of n\u22121\u2212w squares if moved vertically or diagonally, 0\u2264w<n being the \"weakness factor\". For example, a weak queen on a n\u00d7n board with a weakness factor of w=1 located in the bottom row will not be able to threaten any square in the top row as the weak queen would need to move n\u22121 squares vertically or diagonally to get there, but may only move n\u22122 squares in these directions. In contrast, the weak queen is not handicapped horizontally, thus threatening every square in its own row, independently from its current position in that row.\nLet Q(n,w) be the number of ways n weak queens with weakness factor w can be placed on a n\u00d7n board so that no two queens threaten each other. It can be shown, for example, that Q(4,0)=2, Q(4,2)=16 and Q(4,3)=256.\nLet S(n)=\u2211w=0n\u22121Q(n,w).\nYou are given that S(4)=276 and S(5)=3347.\nFind S(14).", "solution": "11726115562784664", "difficulty": 55, "story": "Once upon a time in the peaceful kingdom of Chessland, there lived a young princess named Eva. Eva was a clever and curious girl, always seeking new puzzles to solve and mysteries to unravel. She had a natural knack for mathematics and loved to explore the world of numbers.\n\nOne sunny afternoon, as she sat in the royal garden, Eva stumbled upon an old dusty book hidden beneath a bed of roses. Intrigued, she carefully opened the weathered pages and discovered a fascinating mathematical problem known as the eight queens puzzle. As she read, Eva's eyes sparkled with excitement. This puzzle was all about placing eight chess queens on an 8\u00d78 chessboard, making sure none of them threatened each other.\n\n\"Eureka! This is precisely the challenge I have been looking for,\" Eva exclaimed. She quickly summoned her most trusted advisors and told them about her discovery. Together, they set out to solve the puzzle.\n\nDays turned into weeks, and the royal scholars feverishly worked on cracking the code. Eva was thrilled to watch the progress, eagerly awaiting the solution. But as the weeks stretched into months, the scholars grew despondent. None of them could find the answer. It seemed like the puzzle had baffled everyone.\n\nOne evening, as Eva was pondering over the problem, a stray cat wandered into the palace garden. It meowed softly, catching her attention. The curious princess followed the feline, who led her through a maze of corridors to an old library.\n\nThere, in the dimly lit room, Eva found an ancient text hidden amongst the shelves. It was a forgotten treatise on chess, written by a wise sage who had long since passed away.\n\nEva devoured the words on the pages, her heart racing with anticipation. Within the dusty tome, she found a mention of her puzzle, but with a twist. This text introduced the concept of weak queens, queens that could only move horizontally without any limitations, but had limited range vertically and diagonally.\n\nThe princess's eyes widened with both awe and determination. This was the breakthrough she had been waiting for! She rushed back to her advisors, sharing her newfound wisdom.\n\nThe scholars were astounded by Eva's discovery. Armed with this new understanding of weak queens, they embarked on their quest once again. Days turned into weeks, and weeks into months. The scholars poured over the chessboard, devising new strategies and calculations.\n\nFinally, a breakthrough was made. The scholars successfully determined the number of distinct configurations for a weak queen with a weakness factor on a n\u00d7n board. They rejoiced, their faces lighting up with joy. They had done it!\n\nAs they presented their findings to Princess Eva, their excitement was contagious. Eva beamed with pride and thanked her advisors for their unwavering support. She knew this puzzle had not only challenged their intellect but had also strengthened their bond.\n\nNow, dear reader, as you embark on your own journey through the world of mathematics, ponder the puzzles that lie ahead. What is the value of S(14)? Could you possibly find the sum of the ways in which weak queens can be placed on a 14\u00d714 board? The kingdom of Chessland eagerly awaits your answer."}, {"id": 557, "euler_id": 557, "title": "Cutting triangles", "problem": "\nA triangle is cut into four pieces by two straight lines, each starting at one vertex and ending on the opposite edge. This results in forming three smaller triangular pieces, and one quadrilateral.  If the original triangle has an integral area, it is often possible to choose cuts such that all of the four pieces also have integral area.  For example, the diagram below shows a triangle of area 55 that has been cut in this way.\n\n\n\nRepresenting the areas as a, b, c and d, in the example above, the individual areas are a = 22, b = 8, c = 11 and d = 14.  It is also possible to cut a triangle of area 55 such that a = 20, b = 2, c = 24, d = 9.\n\nDefine a triangle cutting quadruple (a, b, c, d) as a valid integral division of a triangle, where a is the area of the triangle between the two cut vertices, d is the area of the quadrilateral and b and c are the areas of the two other triangles, with the restriction that b \u2264 c.  The two solutions described above are (22,8,11,14) and (20,2,24,9).  These are the only two possible quadruples that have a total area of 55.\n\n\nDefine S(n) as the sum of the area of the uncut triangles represented by all valid quadruples with a+b+c+d \u2264 n. For example, S(20) = 259.  \n\n\nFind S(10000).\n", "solution": "2699929328", "difficulty": 55, "story": "Once upon a time in the quaint village of Euclidia, there lived a young and curious girl named Eliza. She possessed a sharp mind and an insatiable hunger for knowledge. Eliza spent her days exploring the enchanting forests surrounding the village, seeking answers to the many questions that danced through her mind.\n\nOne sunny day, while engrossed in her adventure, Eliza stumbled upon an old, crumbling stone tablet hidden beneath a dilapidated oak tree. Intrigued, she wiped the dust off the tablet's surface and discovered a peculiar mathematical problem etched into the stone.\n\n\"A triangle is cut into four pieces by two straight lines, each starting at one vertex and ending on the opposite edge,\" Eliza read aloud, her eyes lighting up with excitement. \"Could this be a hidden treasure map?\" she wondered, for the geometric patterns on the stone seemed cryptic and mysterious.\n\nWith a thoughtful smile, Eliza set out to solve the puzzle. She examined the diagrams and the accompanying explanation, her fingers tracing the lines and measurements. It soon became clear to her that the stone tablet held a secret, one that held the key to unlocking not only the village's past but also its future.\n\nDays turned into weeks as Eliza delved deeper into the problem, her mind ablaze with theories and calculations. She learned about the restrictions of the cutting patterns and the integral nature of the areas. The young girl even discovered a way to represent the various areas of the triangle using the letters 'a,' 'b,' 'c,' and 'd.'\n\nBut what fascinated Eliza the most was the concept of S(n): the sum of the uncut triangles represented by the quadruples. This concept seemed to hold a profound significance. She wondered, could this sum reveal a hidden truth about the universe?\n\nAs she continued her investigations, Eliza noticed patterns and relationships emerging from the mathematical problem. She began to see connections within the numbers, as if they were threads intricately woven into the fabric of existence. It was a revelation that startled her, fueling her quest to uncover the significance of S(n).\n\nMonths passed, and Eliza's obsession with the stone tablet consumed her every waking moment. She frequented the village library, spending hours poring over ancient texts and manuscripts, hoping to stumble upon a clue that would help her complete the puzzle. The villagers, impressed by her tenacity, granted her their full support.\n\nOne stormy evening, while deep in thought by the flickering candlelight, a revelation struck Eliza. She rushed to the village square, where everyone, young and old, had gathered for the annual Harvest Festival. The villagers listened intently as she explained her findings and the mysterious stone tablet.\n\n\"My dear villagers,\" Eliza began, her voice filled with excitement, \"I believe this mathematical problem holds the key not only to the unexplored realms of geometry but also to the heart of our village itself. Through this problem, we can uncover the hidden treasure of knowledge that lies within our grasp!\"\n\nThe villagers exchanged excited whispers, their enthusiasm growing with each passing moment. Eliza's passion ignited a fire within them, kindling an insatiable curiosity.\n\nBut Eliza had one final question, the most important of all. She turned to the villagers and asked, \"Who among you can solve the riddle of S(10000)? Who can reveal the sum of the area of the uncut triangles represented by all valid quadruples with a+b+c+d \u2264 n?\"\n\nThe air crackled with anticipation as the villagers pondered her question. Their eyes sparkled with the promise of discovery, and their hearts yearned to unearth the hidden treasure. It was a question that would test their wits and illuminate the path toward enlightenment.\n\nAnd so, dear reader, I pose the same question to you:\n\nCan you solve the mystery of S(10000)?"}, {"id": 567, "euler_id": 567, "title": "Reciprocal games I", "problem": "Tom has built a random generator that is connected to a row of n light bulbs. Whenever the random generator is activated each of the n lights is turned on with the probability of 12, independently of its former state or the state of the other light bulbs.\nWhile discussing with his friend Jerry how to use his generator, they invent two different games, they call the reciprocal games:\nBoth games consist of n turns. Each turn is started by choosing a number k randomly between (and including) 1 and n, with equal probability of 1n for each number, while the possible win for that turn is the reciprocal of k, that is 1k.\nIn game A, Tom activates his random generator once in each turn. If the number of lights turned on is the same as the previously chosen number k, Jerry wins and gets 1k, otherwise he will receive nothing for that turn. Jerry's expected win after playing the total game A consisting of n turns is called JA(n). For example JA(6)=0.39505208, rounded to 8 decimal places.\nFor each turn in game B, after k has been randomly selected, Tom keeps reactivating his random generator until exactly k lights are turned on. After that Jerry takes over and reactivates the random generator until he, too, has generated a pattern with exactly k lights turned on. If this pattern is identical to Tom's last pattern, Jerry wins and gets 1k, otherwise he will receive nothing. Jerry's expected win after the total game B consisting of n turns is called JB(n). For example JB(6)=0.43333333, rounded to 8 decimal places.\nLet S(m)=\u2211n=1m(JA(n)+JB(n)). For example S(6)=7.58932292, rounded to 8 decimal places.\nFind S(123456789), rounded to 8 decimal places.", "solution": "75.44817535", "difficulty": 55, "story": "Once upon a time, in a small town called Mathlandia, there lived two best friends named Tom and Jerry. They both had a strong love for mathematics and spent countless hours engaged in fascinating discussions about the subject.\n\nOne sunny afternoon, as they were strolling through the town square, Tom excitedly shared his latest invention with Jerry. He had built a random generator that could control a row of n light bulbs. When activated, each light had a 1/2 probability of turning on, independent of its previous state or the state of the other bulbs.\n\nIntrigued by the potential of Tom's creation, Jerry began brainstorming with his friend on how they could turn this random generator into a game. After hours of contemplation and numerous cups of coffee, they came up with two different games that they decided to call the \"reciprocal games.\"\n\nThe first game, which they named Game A, consisted of n turns. In each turn, a number k would be randomly chosen between 1 and n (inclusive) with an equal probability of 1/n for each number. The possible win for that turn would be the reciprocal of k, i.e., 1/k. Tom would activate his random generator once in each turn, and if the number of lights turned on during that turn matched the previously chosen number k, Jerry would win and receive a prize of 1/k. If not, he would receive nothing. The expected win for Jerry after playing the entire Game A consisting of n turns would be denoted as JA(n).\n\nThe second game, Game B, also consisted of n turns. After randomly choosing a number k, Tom would activate his random generator repeatedly until exactly k lights were turned on. Once that happened, Jerry would take over and also activate the random generator until he generated a pattern with exactly k lights turned on. If Jerry's pattern matched Tom's last pattern, he would win and receive a prize of 1/k. If not, he would receive nothing. The expected win for Jerry after playing the entire Game B consisting of n turns would be denoted as JB(n).\n\nBoth Tom and Jerry were excited about their new games, but they were also curious about the total expected win that Jerry could achieve by playing both games simultaneously. They defined a function S(m) to represent the sum of the expected wins for all numbers from 1 to m in both Game A and Game B. For example, S(6) would be equal to the sum of JA(1) + JB(1) + JA(2) + JB(2) + JA(3) + JB(3) + JA(4) + JB(4) + JA(5) + JB(5) + JA(6) + JB(6).\n\nBut the question that remained unanswered was this: what would S(123456789) be? The total expected win for Jerry after playing both Game A and Game B for 123,456,789 turns, rounded to 8 decimal places.\n\nAs the sun began to set, and Tom and Jerry continued their walk through the town square, they couldn't help but wonder about the answer. How would Jerry's total expected win in the combined games change as the number of turns increased? And ultimately, what would the total expected win be after playing for a staggering 123,456,789 turns?\n\nAnd so, the question remained, awaiting an answer from the curious minds who could unlock the mathematical secrets hidden within the reciprocal games."}, {"id": 568, "euler_id": 568, "title": "Reciprocal games II", "problem": "Tom has built a random generator that is connected to a row of n light bulbs. Whenever the random generator is activated each of the n lights is turned on with the probability of 12, independently of its former state or the state of the other light bulbs.\nWhile discussing with his friend Jerry how to use his generator, they invent two different games, they call the reciprocal games:\nBoth games consist of n turns. Each turn is started by choosing a number k randomly between (and including) 1 and n, with equal probability of 1n for each number, while the possible win for that turn is the reciprocal of k, that is 1k.\nIn game A, Tom activates his random generator once in each turn. If the number of lights turned on is the same as the previously chosen number k, Jerry wins and gets 1k, otherwise he will receive nothing for that turn. Jerry's expected win after playing the total game A consisting of n turns is called JA(n). For example JA(6)=0.39505208, rounded to 8 decimal places.\nFor each turn in game B, after k has been randomly selected, Tom keeps reactivating his random generator until exactly k lights are turned on. After that Jerry takes over and reactivates the random generator until he, too, has generated a pattern with exactly k lights turned on. If this pattern is identical to Tom's last pattern, Jerry wins and gets 1k, otherwise he will receive nothing. Jerry's expected win after the total game B consisting of n turns is called JB(n). For example JB(6)=0.43333333, rounded to 8 decimal places.\nLet D(n)=JB(n)\u2212JA(n). For example, D(6)=0.03828125.\nFind the 7 most significant digits of D(123456789) after removing all leading zeros.\n(If, for example, we had asked for the 7 most significant digits of D(6), the answer would have been 3828125.)", "solution": "4228020", "difficulty": 55, "story": "Once upon a time in the small town of Mathville, there lived two best friends named Tom and Jerry. They were both passionate about mathematics and spent most of their days discussing complex problems and creating innovative solutions.\n\nOne day, Tom approached Jerry with an exciting invention. \"Jerry, my friend, guess what I've built,\" Tom exclaimed with a sparkle in his eyes. \"I've created a random generator that can activate a row of light bulbs! Each bulb has a 1/2 probability of being turned on whenever the generator is activated.\"\n\nJerry's curiosity piqued, and he soon began brainstorming with Tom on how to use this random generator in interesting ways. After much deliberation, they came up with two intriguing games, which they fittingly called the reciprocal games.\n\nIn game A, Tom and Jerry would play a total of n turns. In each turn, they would randomly choose a number k between 1 and n, inclusive, with an equal probability of 1/n for each number. Once k was selected, Tom would activate his random generator, and if the number of lights turned on matched the chosen number k, Jerry would win and receive a prize of 1/k. If not, Jerry would receive nothing for that turn. They were eager to determine Jerry's expected win after playing the total game A, denoted as JA(n).\n\nExcitement filled the air as they embarked on the first few rounds of game A, eagerly calculating Jerry's expected win after every turn. They soon realized that evaluating JA(n) was quite challenging.\n\nMeanwhile, Tom and Jerry's invention had caught the attention of the renowned mathematician, Professor Fibonacci. Intrigued by their invention, he asked them to present their game B.\n\nIn game B, similar rules applied, but with a slight twist. After selecting the number k for each turn, Tom would activate the random generator and keep reactivating it until exactly k lights were turned on. Once Tom achieved this, he would pass on the reins to Jerry, who would then activate the random generator until he generated a pattern with exactly k lights turned on. If this pattern matched Tom's last pattern, Jerry would win and receive 1/k as his prize. Otherwise, he would receive nothing. Jerry's expected win after the total game B was called JB(n).\n\nTom and Jerry were eager to compare the expected wins of both games and set out to calculate D(n) = JB(n) - JA(n), where D(n) represented the difference between the expected wins of game B and game A.\n\nIntricate calculations and countless simulations ensued as Tom, Jerry, and Professor Fibonacci tried to find a solution for D(n). Tom's random generator was put to the test, generating patterns of lights over and over again. They drew upon their mathematical knowledge, algorithms, and pure determination to uncover the inner workings of these reciprocal games.\n\nAs Tom and Jerry continued their journey of discovery, they faced numerous challenges, moments of triumph, and even a few setbacks. The numbers danced across the pages of their notebooks, as if playing along with their calculations.\n\nNow, dear reader, we come to a crucial part of our story. Tom, Jerry, and Professor Fibonacci have made significant progress, but the mystery surrounding D(n) for the gargantuan number 123,456,789 remains unsolved. The townspeople of Mathville, along with students and mathematicians from around the world, have all joined forces to crack this enigma.\n\nAnd so, the question resonates in the air \u2013 What are the seven most significant digits of D(123,456,789) after removing all leading zeros?\n\nWill you, dear reader, be the one to solve this mathematical puzzle?"}, {"id": 570, "euler_id": 570, "title": "Snowflakes", "problem": "A snowflake of order n is formed by overlaying an equilateral triangle (rotated by 180 degrees) onto each equilateral triangle of the same size in a snowflake of order n-1. A snowflake of order 1 is a single equilateral triangle.\n \nSome areas of the snowflake are overlaid repeatedly. In the above picture, blue represents the areas that are one layer thick, red two layers thick, yellow three layers thick, and so on. \nFor an order n snowflake, let A(n) be the number of triangles that are one layer thick, and let B(n) be the number of triangles that are three layers thick. Define G(n) = gcd(A(n), B(n)).\nE.g. A(3) = 30, B(3) = 6, G(3)=6\nA(11) = 3027630, B(11) = 19862070, G(11) = 30\nFurther, G(500) = 186 and  \u2211n=3500G(n)=5124\nFind \u2211n=3107G(n).", "solution": "271197444", "difficulty": 55, "story": "Once upon a time in the magical land of Numeria, there lived a young boy named Max. Max was a curious and adventurous young lad who loved to explore the enchanting landscape that surrounded his humble village. The village was nestled at the foot of a magnificent mountain, covered in a thick blanket of snow throughout the year. This snowy wonderland won Max's heart right from the start.\n\nOne day, while wandering through the village, Max stumbled upon an ancient book hidden away in the village library. The dusty tome was filled with intricate illustrations and mathematical riddles, capturing Max's attention immediately. As he flipped through the pages, one particular problem caught his eye - the problem of the snowflake.\n\nThe book challenged Max to understand the intricate formations of the snowflake and solve the enigma of A(n), B(n), and G(n). With the snowflakes deeply embedded in his mind, Max decided to embark on a grand adventure to find the elusive solution.\n\nMax journeyed deep into the heart of the mountain, braving the treacherous icy paths and gusts of chill wind. As he delved further, the frigid air seemed to whisper secret equations only he could decipher. The mountain itself became his guide, offering cryptic symbols etched in ice and guiding him on the path to answers.\n\nWith each step, Max's determination grew stronger, fueled by his unwavering curiosity. He met mystical creatures along the way, each holding fragments of knowledge that would unlock the snowflake's mysteries. From wise old owls to mischievous snow sprites, Max gathered pieces of the puzzle, but the true revelation still eluded him.\n\nHe ventured deeper into the mountain, and his quest led him to a mysterious cave shimmering with an ethereal glow. Intrigued, he cautiously stepped inside. To his amazement, the cavern was adorned with walls of shimmering ice, forming countless intricate snowflakes. Max's heart raced with excitement as he realized that he had stumbled upon the home of the snowflake guardians.\n\nWithin the icy walls, Max discovered a grand library of mathematical secrets, guarded by an ancient and wise snowflake elder named Aurora. She saw the spark of determination in Max's eyes and understood the purpose of his quest. Aurora welcomed him warmly and offered guidance on his journey.\n\nUnder Aurora's mentorship, Max immersed himself in the study of snowflakes. He diligently examined the overlapping triangles, each adding to the snowflake's complexity. He discovered the patterns within, identifying the triangles that were one, three, or more layers thick. With each revelation, Max's mind expanded, and the answers grew closer.\n\nTime passed quickly within the snowflake library, and Max's knowledge flourished. His newfound understanding of A(n), B(n), and G(n) became an integral part of his every thought. The mathematical problem consumed his waking hours, even permeating his dreams.\n\nFinally, after months of relentless study, Max emerged from the snowy mountain, armed with the knowledge he sought. But he found himself face to face with an unexpected question - one that no book or mentor had prepared him for.\n\nAs Max stood at the foot of the mountain, gazing at the infinite expanse of whirling snowflakes, he couldn't help but wonder:\n\n\"What is the sum \u2211n=3107G(n)?\"\n\nWith the answer still elusive, Max knew that his journey had only just begun. The village awaited his return, filled with anticipation. The story of his monumental adventure spread like wildfire through the streets, inspiring a new generation of enigmatic thinkers.\n\nAnd so, Max invited the villagers to join him in the quest for the solution. The snowflakes whispered their cryptic messages to curious minds, unraveling the mysteries coded within their icy formations. As the villagers explored the mathematical problem together, they marveled at the beauty and logic that intertwined within the snowflakes' delicate symmetries.\n\nAnd as Max and the villagers embarked on this shared adventure, they wondered if the solution would elude them like a cunning snow sprite or reveal itself like a majestic snow-capped peak. Their hearts filled with anticipation, they posed the question to themselves:\n\n\"Can we discover the sum \u2211n=3107G(n)?\""}, {"id": 576, "euler_id": 576, "title": "Irrational jumps", "problem": "\nA bouncing point moves counterclockwise along a circle with circumference 1 with  jumps of constant length l<1, until it hits a gap of length g<1, that is placed in a distance d counterclockwise from the starting point. The gap does not include the starting point, that is g+d<1.\nLet S(l,g,d) be the sum of the length of all jumps, until the point falls into the gap. It can be shown that S(l,g,d) is finite for any irrational jump size l, regardless of the values of g and d.\nExamples: \nS(12,0.06,0.7)=0.7071\u2026, S(12,0.06,0.3543)=1.4142\u2026 and  S(12,0.06,0.2427)=16.2634\u2026.\n\nLet M(n,g) be the maximum of \u2211S(1p,g,d) for all primes p\u2264n and any valid value of d.\nExamples:\nM(3,0.06)=29.5425\u2026, since S(12,0.06,0.2427)+S(13,0.06,0.2427)=29.5425\u2026 is the maximal reachable sum for g=0.06. \nM(10,0.01)=266.9010\u2026 \nFind M(100,0.00002), rounded to 4 decimal places.", "solution": "344457.5871", "difficulty": 55, "story": "Kara was an inquisitive young girl with a deep love for adventure. She always believed that there was a hidden world waiting to be discovered, and it was her mission to uncover its secrets. One sunny day, while exploring her grandparents' vast garden, she stumbled upon an ancient-looking map wedged between the pages of an old book.\n\nThe faded parchment intrigued Kara, for it held symbols and figures she had never seen before. A circle with markings around its circumference didn't make much sense at first, but her eyes gleamed with excitement as she read the accompanying text. The map held the key to a hidden treasure, but solving a mathematical puzzle was the path she would have to tread.\n\nKara's heart raced with anticipation as she decoded the mysterious puzzle engraved on the map. It revealed the secrets of a bouncing point, moving counterclockwise along a circle. The circle represented an incredible journey filled with jumps of constant length, but there lay a challenge\u2014finding a gap along the way.\n\nHer young mind processed the equations, as she imagined a bouncing point progressing along the circumference of this imaginary circle. The leaps became shorter and shorter until, finally, the point fell into a gap, its journey complete. Kara was awestruck by the complexity of this mathematical problem.\n\nBut Kara wasn't the type to back down from a challenge. She knew that this puzzle unlocked the gateway to the treasure she sought. She calculated and recalculated, mapping out potential gaps and distances in her mind. Kara realized that it wasn't just about the magnificence of the treasure, but the thrill of solving the equation.\n\nDays turned into weeks, and weeks turned into months as Kara delved deeper into the labyrinthine workings of the mathematical problem. Every night, she would dream of bouncing points and circles, constantly striving to find the perfect combination. Even her friends marveled at her dedication, puzzled by her enthusiasm for this peculiar challenge.\n\nAs Kara's thirteenth birthday approached, she became more determined than ever to solve this enigma. She immersed herself in books, sought guidance from mathematics professors, and even enlisted the support of her friends. Hours were spent scribbling equations, discussing leaps, gaps, and distances, all to uncover the ever-elusive solution.\n\nAnd so, the day finally arrived when Kara, armed with her exhaustive knowledge, stood before the treasure chest. The intricate lock required specific measurements\u2014a combination that embodied the essence of the mathematical problem she had spent months pondering.\n\nWith trembling hands, Kara entered the values into the lock, hoping that her calculations had not failed her. A soft click resonated through the cavernous chamber as the lock disengaged. The chest slowly creaked open, revealing the gleaming riches within. But as Kara admired the treasure, a single question emerged in her mind.\n\n\"What was M(100,0.00002), rounded to 4 decimal places?\"\n\nAs she stood there, surrounded by the spoils of her victory, Kara wondered if she had indeed found the correct answer. The journey had taught her that sometimes, solving a problem wasn't about reaching the destination; it was about the exhilarating pursuit of knowledge itself. And so, with a renewed sense of wonder, she decided to delve further into the world of mathematics and the mysteries it held, forever curious to uncover greater treasures."}, {"id": 614, "euler_id": 614, "title": "Special partitions 2", "problem": "An integer partition of a number n is a way of writing n as a sum of positive integers. Partitions that differ only by the order of their summands are considered the same.\nWe call an integer partition special if 1) all its summands are distinct, and 2) all its even summands are also divisible by 4. For example, the special partitions of 10 are: 10=1+4+5=3+7=1+9\nThe number 10 admits many more integer partitions (a total of 42), but only those three are special.\nLet be P(n) the number of special integer partitions of n. You are given that P(1)=1, P(2)=0, P(3)=1, P(6)=1, P(10)=3, P(100)=37076 and P(1000)=3699177285485660336.\nFind \u2211i=1107P(i). Give the result modulo 109+7.", "solution": "130694090", "difficulty": 55, "story": "Once upon a time in the kingdom of Mathlandia, there was a brilliant mathematician named Professor Eleanor. Professor Eleanor spent her days and nights exploring the realm of numbers, uncovering hidden patterns, and solving complex mathematical problems. But there was one problem that had intrigued her for years, a problem she simply couldn't solve - the mystery of special integer partitions.\n\nOne sunny morning, as Professor Eleanor strolled through the lush gardens of Mathlandia University, a gust of wind blew a tattered piece of parchment into her path. Curiosity piqued, she picked it up and examined its contents. To her amazement, it contained a mathematical problem she had been grappling with for years - the problem of special integer partitions.\n\nAs Professor Eleanor read through the problem, she felt a rush of excitement. The parchment described a special type of integer partition, where all the summands were distinct and all the even summands were divisible by 4. The parchment even provided a few examples to illustrate the concept.\n\nDetermined to solve the mystery once and for all, Professor Eleanor made her way to the Royal Library. Surrounded by towering shelves filled with ancient tomes and dusty scrolls, she delved into the realms of number theory and combinatorics. Hours turned into days, and days turned into weeks as Professor Eleanor tirelessly poured over the pages, seeking patterns and connections.\n\nOne fateful night, amidst her research frenzy, Professor Eleanor discovered a breakthrough. She found a recursive formula that allowed her to calculate P(n) for any given number n. With each revelation, her excitement grew, and she realized that she was on the brink of unraveling the secrets of special integer partitions.\n\nBurning the midnight oil, Professor Eleanor worked feverishly on her calculations, exploring the countless possibilities and special cases. Days turned into weeks, and weeks turned into months. Finally, after what felt like a lifetime, she emerged triumphant, clutching her parchment filled with the answers to P(n) for various values of n.\n\nEager to share her discovery with the world, Professor Eleanor stood before the King and his court, presenting her findings with confidence and enthusiasm. The mathematicians and scholars were astounded by her achievement and marveled at the magnitude of the problem she had solved.\n\nAs word of her triumph spread throughout the kingdom, students and scholars flocked to Mathlandia University. Professor Eleanor became a legend, an inspiration to aspiring mathematicians far and wide. Yet, there was one thing that continued to elude her - the sum \u2211i=1107P(i).\n\nThis mysterious sum intrigued Professor Eleanor, for she knew that it held the key to unlocking even greater secrets within the realm of special integer partitions. Night after night, she delved deeper into the sea of numbers, searching for a hint, a clue that would lead her to the answer.\n\nAs Professor Eleanor's story continues to unfold, she embarks on a new adventure, navigating uncharted mathematical territories and studying the properties of extraordinary numbers. But the question remains: what is the value of \u2211i=1107P(i)? Will Professor Eleanor uncover the elusive answer, or will she be forever entangled in the depths of this mathematical mystery?\n\nDear reader, I now pose this question to you: Can you solve the mathematical problem that has confounded Professor Eleanor and has become the ultimate test of mathematical prowess? Will you be the one to crack the code and find the value of \u2211i=1107P(i)?"}, {"id": 629, "euler_id": 629, "title": "Scatterstone Nim", "problem": "Alice and Bob are playing a modified game of Nim called Scatterstone Nim, with Alice going first, alternating turns with Bob. The game begins with an arbitrary set of stone piles with a total number of stones equal to n.\nDuring a player's turn, he/she must pick a pile having at least 2 stones and perform a split operation, dividing the pile into an arbitrary set of p non-empty, arbitrarily-sized piles where 2\u2264p\u2264k for some fixed constant k. For example, a pile of size 4 can be split into {1,3} or {2,2}, or {1,1,2} if k=3 and in addition {1,1,1,1} if k=4.\nIf no valid move is possible on a given turn, then the other player wins the game.\nA winning position is defined as a set of stone piles where a player can ultimately ensure victory no matter what the other player does. \nLet f(n,k) be the number of winning positions for Alice on her first turn, given parameters n and k. For example, f(5,2)=3 with winning positions {1,1,1,2},{1,4},{2,3}. In contrast, f(5,3)=5 with winning positions {1,1,1,2},{1,1,3},{1,4},{2,3},{5}.\nLet g(n) be the sum of f(n,k) over all 2\u2264k\u2264n. For example, g(7)=66 and g(10)=291.\nFind g(200) mod (109+7).", "solution": "626616617", "difficulty": 55, "story": "Once upon a time in a small village called Numeria, there lived two young mathematicians named Alice and Bob. They were not only the best of friends but also rivals when it came to solving mathematical puzzles. Every day, they would challenge each other with mind-bending problems, pushing their logical and analytical skills to the limit.\n\nOne sunny morning, Alice and Bob found themselves facing an enigma that had stumped them both. Professor Euler, a renowned mathematician, had recently introduced them to a modified version of the ancient game of Nim called Scatterstone Nim. Alice and Bob couldn't resist the lure of this new challenge.\n\nThe objective of Scatterstone Nim was to outmaneuver your opponent by splitting stone piles strategically. Each pile had a certain number of stones, and players took turns splitting them into smaller piles. However, there were rules to abide by. You could only split piles with at least two stones, and the number of piles you could create had to be between two and a fixed upper limit, denoted by k.\n\nAs Alice and Bob delved deeper into Scatterstone Nim, they discovered the concept of winning positions. A winning position was a set of stone piles where a player could guarantee victory, regardless of their opponent's moves. Alice was particularly fascinated by this notion and sought to find the number of winning positions for her on her first turn, depending on the initial stone pile and the upper limit k.\n\nShe coined this count f(n,k), where n represented the total number of stones and k the maximum number of piles she could create. Alice spent countless hours scribbling equations in her notebook, experimenting with different values of n and k. She relished the challenge of uncovering new patterns and trying to solve increasingly larger values of n.\n\nMeanwhile, Bob observed Alice's intense determination, silently competing with her in his own way. While he wasn't as captivated by winning positions as Alice, he understood the importance of cooperative rivalry in their quest for knowledge. Even though he couldn't unravel the mysteries of Scatterstone Nim like Alice, he knew their partnership would lead to new insights.\n\nAs the days turned into weeks, Alice's excitement grew. She started seeing connections between the values of f(n,k) and the overall count of winning positions for Alice, which she defined as g(n).\n\nShe calculated g(n) by summing up f(n,k) for all values of k between two and n. The elusive patterns and relationships between f(n,k) and g(n) began to unfold, igniting the spark of curiosity in Alice's mind. \n\nOne day, Alice walked to the village library, deep in thought. She was eager to share her discoveries with Bob and discuss possible solutions. As she browsed through the rows of shelves, she stumbled upon a dusty book titled \"The Secrets of Nim: Unveiling Winning Strategies.\"\n\nUnable to contain her excitement, Alice quickly grabbed the book and started flipping through its pages. However, just as she was about to unravel the final piece of the puzzle, something caught her eye. A slip of parchment fell from the book's pages, containing a cryptic message.\n\n\"Ponder upon g(200), find it modulo (10^9+7), and discover the true essence of Scatterstone Nim.\"\nAlice's heart raced with excitement, and she couldn't wait to share this new challenge with Bob. How could this ancient game hold such a mysterious secret, and what was the significance of g(200)? As she hurried back to find Bob, Alice's mind buzzed with questions.\n\nAnd so, I pose the same question to you, dear reader. Can you solve the mathematical problem Alice encountered? What is g(200) modulo (10^9+7)? Take a moment to delve into the world of Scatterstone Nim, immerse yourself in Alice and Bob's mathematical journey, and perhaps, like them, you will discover the true essence of this intriguing game."}, {"id": 658, "euler_id": 658, "title": "Incomplete words II", "problem": "In the context of formal languages, any finite sequence of letters of a given alphabet \u03a3 is called a word over \u03a3. We call a word incomplete if it does not contain every letter of \u03a3.\n\nFor example, using the alphabet \u03a3={a,b,c}, 'ab', 'abab' and '' (the empty word) are incomplete words over \u03a3, while 'abac' is a complete word over \u03a3.\n\nGiven an alphabet \u03a3 of \u03b1 letters, we define I(\u03b1,n) to be the number of incomplete words over \u03a3 with a length not exceeding n. \nFor example, I(3,0)=1, I(3,2)=13 and I(3,4)=79.\n\nLet S(k,n)=\u2211\u03b1=1kI(\u03b1,n).\nFor example, S(4,4)=406, S(8,8)=27902680 and S(10,100)\u2261983602076\u00a0mod\u00a01000000007.\n\nFind S(107,1012). Give your answer modulo 1000000007.\n", "solution": "958280177", "difficulty": 55, "story": "Once upon a time in a kingdom far, far away, there lived a young princess named Seraphina. Seraphina was not an ordinary princess. She possessed a brilliant mind and had a deep fascination for mathematics. While other princesses were busy with their royal duties and suitors, Seraphina would spend her days in the royal library, poring over books filled with complex mathematical problems. \n\nOne day, as Seraphina was engrossed in her studies, a group of heralds arrived at the palace. They had traveled from the kingdom of Mathematica, renowned for the great minds that resided within its borders. The king of Mathematica had heard of Seraphina's intellect and offered her an invitation to visit their kingdom and participate in a grand mathematical tournament.\n\nEcstatic at the opportunity to engage with fellow math enthusiasts, Seraphina eagerly accepted the invitation. She bid farewell to her parents, promising to return with newfound knowledge. And so, she embarked on her journey to the kingdom of Mathematica.\n\nUpon her arrival, Seraphina was astounded by the bustling streets filled with scholars and mathematicians engaged in deep discussions and debates. The kingdom seemed to have an air of excitement and innovation, and Seraphina couldn't wait to immerse herself in the mathematical wonders that awaited her.\n\nThe tournament began, and Seraphina found herself challenged by problems of increasing difficulty. She solved equations, untangled complex algorithms, and delved into the depths of theoretical mathematics. But it was the problem presented in the final round that truly captivated her.\n\nThe problem was a mathematical puzzle involving formal languages and incomplete words. It was a problem that required an understanding of alphabets and sequence patterns. Seraphina's eyes lit up with excitement as she dove into the problem, her mind working furiously to unravel its mysteries.\n\nDays turned into weeks, and still, Seraphina had not cracked the problem. She sought guidance from the scholars of Mathematica, discussing the intricacies of the alphabet \u03a3 and its incomplete words. Together, they delved deeper into the problem, exploring its every nook and cranny.\n\nAs the tournament came to a close, Seraphina stood before the kingdom of Mathematica, filled with admiration for its boundless knowledge. She realized that the problem she had encountered had stretched her understanding of formal languages and challenged her mathematical prowess.\n\nReturning to her kingdom, Seraphina knew she couldn't leave the problem unsolved. But she also knew that she had to share it with others, to see if they too could unlock its secrets. So she summoned the scholars and mathematicians from far and wide, inviting them to gather in the grand hall of the royal palace.\n\nAnd so, the mathematicians gathered, their minds buzzing with anticipation. Seraphina stood before them, a glimmer of excitement in her eyes as she presented the problem that had captivated her.\n\n\"In the context of formal languages,\" she began, \"any finite sequence of letters of a given alphabet \u03a3 is called a word over \u03a3. But what if the word is incomplete? How many incomplete words are there with a length not exceeding n?\"\n\nSeraphina's voice echoed through the grand hall as she posed the question to the brilliant minds that sat before her. The mathematicians pondered, their brows furrowed in deep thought, as they attempted to unlock the secrets of the incomplete words.\n\nAnd now, dear reader, it is your turn. Can you solve the mathematical problem that captivated Seraphina and baffled the greatest minds of Mathematica? Can you find I(\u03b1,n), the number of incomplete words over an alphabet \u03a3? If so, take a leap into the realm of formal languages and immerse yourself in the mysteries of incomplete words."}, {"id": 661, "euler_id": 661, "title": "A Long Chess Match", "problem": "Two friends A and B are great fans of Chess. They both enjoy playing the game, but after each game the player who lost the game would like to continue (to get back at the other player) and the player who won would prefer to stop (to finish on a high).\nSo they come up with a plan. After every game, they would toss a (biased) coin with probability p of Heads (and hence probability 1\u2212p of Tails). If they get Tails, they will continue with the next game. Otherwise they end the match. Also, after every game the players make a note of who is leading in the match.\nLet pA denote the probability of A winning a game and pB the probability of B winning a game. Accordingly 1\u2212pA\u2212pB is the probability that a game ends in a draw. Let EA(pA,pB,p) denote the expected number of times A was leading in the match.\n\nFor example, EA(0.25,0.25,0.5)\u22480.585786 and EA(0.47,0.48,0.001)\u2248377.471736, both rounded to six places after the decimal point.\nLet H(n)=\u2211k=3nEA(1k+3,1k+3+1k2,1k3)\nFor example H(3)\u22486.8345, rounded to 4 digits after the decimal point.\nFind H(50), rounded to 4 digits after the decimal point.", "solution": "646231.2177", "difficulty": 55, "story": "Once upon a time in a small village, there were two best friends named Alex and Ben. They shared a common passion for chess and spent countless hours playing against each other. Their competitive spirits had always pushed them to become better players, but a peculiar pattern emerged after every match.\n\nYou see, Alex was someone who loved the feeling of victory, and winning a chess game gave him an adrenaline rush like no other. On the other hand, Ben, though he enjoyed playing just as much, found solace in the challenge rather than the outcome. Every time Alex won a match, he desired the thrill of playing again immediately, while Ben wanted to take a break and savor the moment.\n\nWanting to find a solution that would keep both of them engaged, they devised a plan. After each game, they would take a biased coin and flip it to decide whether to continue or stop. The coin had a probability, p, of landing on heads, and the remaining probability, 1-p, of landing on tails. If it landed on heads, they would continue with the next game. Otherwise, they would conclude the match.\n\nBut there was another twist to their plan. After every game, they made a note of who was leading in the match. This information was crucial as they wanted to calculate the expected number of times Alex was in the lead during their chess sessions. This measure, denoted as EA(pA, pB, p), helped them assess their individual performances and competitiveness.\n\nAs time went on, the village became captivated by their intense matches, applauding their camaraderie and marveling at their skills. People would often place friendly wagers on who would win each game. The suspense grew with each flip of the coin, and the outcome of each match had the village on the edge of their seats.\n\nNow, as Alex and Ben reached the zenith of their chess skills, they wondered about the cumulative number of times Alex had been in the lead throughout all their matches. To find this, they defined a function H(n), where n represents the number of matches played. H(n) was the sum of EA(1/(k+3), (1/(k+3)) + (1/(k^2)), (1/(k^3))), where k started from 3 and went up to n. They were curious to know the value of H(50), rounded to four decimal places, to gauge the overall competitiveness between the two.\n\nHowever, the village chess competitions reached a climax, and the day had come for the ultimate showdown between Alex and Ben. The anticipation in the air was palpable. They had no idea that this particular game would change their lives forever.\n\nThe game began, and with each move, the crowd gasped at the intensity displayed by both players. Alex was in top form, playing with a stellar combination of strategy and intuition. Ben, known for his resilience, defended valiantly.\n\nAs the match entered its final stages, it became evident that the two friends were incredibly evenly matched. The game could swing either way, and the crowd grew more restless with each passing minute.\n\nFinally, after a grueling encounter, the chessboard reached a stalemate. A draw.\n\nThe villagers erupted into applause, mesmerized by the players' skills and realization that even the most intense games could still result in a stalemate. But what about Alex's dream of being in the lead?\n\nAs the story draws to a close, I leave you with a question. Can you find the value of H(50), rounded to four decimal places? With this simple but intriguing mathematical problem, you have the opportunity to step into Alex and Ben's shoes and uncover their journey of competition, friendship, and the pursuit of victory.\n\nSo, dear reader, will you accept the challenge?"}, {"id": 665, "euler_id": 665, "title": "Proportionate Nim", "problem": "Two players play a game with two piles of stones, alternating turns.\nOn each turn, the corresponding player chooses a positive integer n and does one of the following:\nremoves n stones from one pile;\nremoves n stones from both piles; or\nremoves n stones from one pile and 2n stones from the other pile.\nThe player who removes the last stone wins.\nWe denote by (n,m) the position in which the piles have n and m stones remaining. Note that (n,m) is considered to be the same position as (m,n).\nThen, for example, if the position is (2,6), the next player may reach the following positions:\n(0,2), (0,4), (0,5), (0,6), (1,2), (1,4), (1,5), (1,6), (2,2), (2,3), (2,4), (2,5)\nA position is a losing position if the player to move next cannot force a win. For example, (1,3), (2,6), (4,5) are the first few losing positions.\nLet f(M) be the sum of n+m for all losing positions (n,m) with n\u2264m and n+m\u2264M. For example, f(10)=21, by considering the losing positions (1,3), (2,6), (4,5).\nYou are given that f(100)=1164 and f(1000)=117002.\nFind f(107).", "solution": "11541685709674", "difficulty": 55, "story": "Once upon a time in the tranquil village of Mathlandia, there lived two best friends named Alice and Bob. They were not your ordinary villagers; their hearts were filled with a love for numbers and a passion for solving mathematical problems. Every day, they would gather at the village square and challenge each other with mind-boggling puzzles. Their favorite pastime was a game involving two piles of stones.\n\nOne sunny afternoon, Alice and Bob decided to play their beloved game. They sat on a bench in the village square, facing each other with excitement gleaming in their eyes. The game began with two piles of stones before them, one with seven stones and the other with five.\n\nAlice, being the gracious host, let Bob go first. Bob pondered for a moment and said, \"I choose three.\"\n\nWith a swift hand, Bob removed three stones from one pile, leaving it with four, and leaving the other pile untouched. It was now Alice's turn.\n\nAlice observed the piles of stones, carefully considering her options. She could remove three stones from one pile, remove three stones from both piles, or remove three stones from one pile and six stones from the other pile.\n\nAfter much contemplation, Alice smiled mischievously and said, \"I choose two.\"\n\nShe removed two stones from one pile, leaving it with five, and left the other pile untouched. Bob scratched his head, trying to decipher her strategy.\n\nThe game continued like this, their nimble fingers dancing around the piles of stones, each player trying to outsmart the other. They thought strategically, calculating the possibilities and predicting the moves of their opponent. It was a battle of wits showcased through numbers.\n\nAs the game progressed, Alice and Bob found themselves in countless positions, each marked by the number of stones in the two piles. Some positions were advantageous, while others led to defeat. They soon realized that certain positions were losing positions, where the player to move next would have no way to force a win.\n\nCuriosity piqued, Alice and Bob began to explore these losing positions more intently. They discovered that even when the number of stones changed, the losing positions were consistent. They kept a meticulous record of these losing positions, noting down the sum of n+m for each one.\n\nDays turned into weeks, and weeks into months. Alice and Bob became enthralled by their findings, venturing deeper into the realm of mathematics. They expanded their exploration to larger values of n and m, always keeping track of the losing positions and their corresponding sums.\n\nFinally, they reached the pinnacle of their journey when they encountered f(100) and f(1000). The results astounded them. The sum of n+m for f(100) was found to be 1164, and for f(1000), it was a tremendous 117002. It was a testament to the beauty and intricacy of numbers.\n\nNow, dear reader, Alice and Bob beckon you into their world. They challenge you to find f(107), to dive into the depths of the mathematical problem they stumbled upon. Can you solve this puzzle and uncover the sum of n+m for all losing positions with n\u2264m and n+m\u2264107? The answer awaits, concealed within the realm of numbers, ready to be discovered by a curious mind. Can you find it?"}, {"id": 678, "euler_id": 678, "title": "Fermat-like Equations", "problem": "If a triple of positive integers (a,b,c) satisfies a2+b2=c2, it is called a Pythagorean triple. No triple (a,b,c) satisfies ae+be=ce when  e\u22653 (Fermat's Last Theorem). However, if the exponents of the left-hand side and right-hand side differ, this is not true. For example, 33+63=35.\n\n\nLet a,b,c,e,f be all positive integers, 0<a<b, e\u22652, f\u22653 and cf\u2264N. Let F(N) be the number of (a,b,c,e,f) such that ae+be=cf. You are given F(103)=7, F(105)=53 and F(107)=287.\n\n\nFind F(1018).\n", "solution": "1986065", "difficulty": 55, "story": "Once upon a time, in the land of Numeria, there lived a young and ambitious mathematician named William. He was known far and wide for his incredible talent and passion for unraveling the mysteries of numbers. William believed that the world was governed by an intricate web of mathematical laws, waiting to be discovered.\n\nOne bright summer morning, as William sat under the shade of an ancient oak tree, he stumbled upon an old, dusty scroll that piqued his curiosity. Unraveling its delicate parchment, he found himself immersed in a mathematical problem that intrigued him greatly. It was known as Fermat's Last Theorem.\n\n\"If a triple of positive integers (a,b,c) satisfies a^2 + b^2 = c^2, it is called a Pythagorean triple,\" William read aloud, his eyes widening with excitement. \"No triple (a,b,c) satisfies ae + be = ce when e\u22653.\"\n\nThe scroll explained that if the exponents of both sides differed, this statement was no longer true. William's mind began to race, imagining the vast possibilities that lay within this mathematical realm. He knew he had to delve deeper into the secrets hidden within this theorem.\n\nAnd so, William set out on a quest to explore the depths of Numeria, seeking the elusive solution to Fermat's Last Theorem. His journey took him through treacherous valleys and towering mountains, but his unwavering determination propelled him forward.\n\nAs days turned into weeks, and weeks into months, William encountered fellow mathematicians who shared his passion for the enigma of numbers. They engaged in fervent debates and brainstorming sessions, their minds ablaze with curiosity.\n\nOne such mathematician, a wise old man named Albert, revealed to William that F(N) represented the number of (a,b,c,e,f) that satisfied the equation ae + be = cf, given certain conditions. It was a path strewn with formidable obstacles, with the exponents e\u22652 and f\u22653, and cf limited to a specific value N.\n\nOver time, William's dedication bore fruit. He painstakingly constructed a vast collection of data, meticulously recording the instances of (a,b,c,e,f) that met the equation. With each discovery, his excitement grew, witnessing the intricate connections between numbers and the hidden patterns that unfolded.\n\nFueled by his newfound revelations, William continued his tireless pursuit, pushing the boundaries of his understanding even further. Days turned into years, and years into decades, yet the allure of Numeria's secrets never ceased to captivate him.\n\nFinally, after years of relentless exploration, William made a remarkable breakthrough. He solved for F(103), F(105), and F(107), finding the values 7, 53, and 287, respectively. These remarkable achievements validated his unwavering belief in the power of mathematics.\n\nYet, as William stood on the precipice of an even greater discovery, a question began to form in his mind. What, he wondered, could the value of F(1018) be? It was a challenge that gripped his entire being, igniting a fire within him to solve Fermat's Last Theorem completely.\n\nWith determination etched into his very soul, William set forth, ready to unravel the enigma that lay within his grasp. And so, the young mathematician's journey continued, his footsteps echoing through the annals of Numeria's history.\n\nDear reader, can you solve the mathematical problem that William dedicated his life to? What do you think is the value of F(1018)? The hidden answer awaits, a final piece to complete the intricate puzzle of Fermat's Last Theorem."}, {"id": 707, "euler_id": 707, "title": "Lights Out", "problem": "\nConsider a w\u00d7h grid. A cell is either ON or OFF. When a cell is selected, that cell and all cells connected to that cell by an edge are toggled on-off, off-on. See the diagram for the 3 cases of selecting a corner cell, an edge cell or central cell in a grid that has all cells on (white).\n\n\n\nThe goal is to get every cell to be off simultaneously. This is not possible for all starting states. A state is solvable if, by a process of selecting cells, the goal can be achieved.\n\n\nLet F(w,h) be the number of solvable states for a w\u00d7h grid. \nYou are given F(1,2)=2, F(3,3)=512, F(4,4)=4096 and F(7,11)\u2261270016253(mod1000000007).\n\n\nLet f1=f2=1 and fn=fn\u22121+fn\u22122,n\u22653 be the Fibonacci sequence and define \nS(w,n)=\u2211k=1nF(w,fk)\nYou are given S(3,3)=32, S(4,5)=1052960 and S(5,7)\u2261346547294(mod1000000007).\n\n\nFind S(199,199). Give your answer modulo 1000000007.\n", "solution": "652907799", "difficulty": 55, "story": "Once upon a time, in the small village of Matheton, there lived a young girl named Lily. Lily had always been fascinated with numbers and patterns. She spent her days exploring the vast fields surrounding her village, searching for hidden treasures and secrets waiting to be unraveled.\n\nOne summer afternoon, while wandering through the tall grass, Lily stumbled upon an old, dusty book. Curiosity got the better of her, and she opened it to find a collection of intriguing mathematical problems. One problem, in particular, caught her attention.\n\nAs Lily read through the problem, her eyes widened with excitement. The idea of a grid filled with cells that could be toggled on and off fascinated her. She imagined the endless possibilities and the challenges that lay ahead. Without hesitation, she decided to solve the problem and bring all the cells to their off state simultaneously.\n\nLily rushed back to her small, cozy cottage and began working on the problem. As days turned into weeks and weeks into months, she tirelessly experimented with different grids, selecting cells and toggling them to achieve her goal. The Fibonacci sequence, mentioned in the problem, became her guiding light. She marveled at its beauty and the way it intertwined with the grid, providing a path to understanding the solvable states.\n\nWith each new discovery, Lily's passion grew stronger. She could feel herself getting closer to the answer, almost like unraveling a mystery. The people in the village began to notice the fervor in Lily's eyes, the determination in her every step. They would often gather around her cottage, eagerly waiting for her to share her progress.\n\nOne day, after years of perseverance and dedication, Lily finally achieved a breakthrough. She found an equation, S(w, n), that represented the sum of solvable states for a given grid size and a Fibonacci number. The equation became her treasure, her greatest accomplishment. She knew she was onto something significant, something that could change the way people looked at mathematics.\n\nBut Lily realized that her journey was far from over. Her newfound equation had opened up even more questions and possibilities in her mind. How could she use her equation to find S(199, 199)? What would the value of S(199, 199) modulo 1000000007 be?\n\nAs Lily sat in her cottage, surrounded by books and notes, she pondered the next steps. She knew that finding the answer would require all of her mathematical skills and determination. But the thought of unraveling yet another mystery invigorated her.\n\nAnd so, I ask you, dear reader, can you solve the mathematical problem? Can you find the value of S(199, 199) modulo 1000000007? Will you follow in Lily's footsteps and continue her quest for knowledge? The answer lies within the realm of numbers, waiting to be discovered."}, {"id": 740, "euler_id": 740, "title": "Secret Santa", "problem": "\nSecret Santa is a process that allows n people to give each other presents, so that each person gives a single present and receives a single present. At the beginning each of the n people write their name on a slip of paper and put the slip into a hat. Each person takes a random slip from the hat. If the slip has their name they draw another random slip from the hat and then put the slip with their name back into the hat. At the end everyone buys a Christmas present for the person whose name is on the slip they are holding. This process will fail if the last person draws their own name.\n\n\nIn this variation each of the n people gives and receives two presents. At the beginning each of the n people writes their name on two slips of paper and puts the slips into a hat (there will be 2n slips of paper in the hat). As before each person takes from the hat a random slip that does not contain their own name. Then the same person repeats this process thus ending up with two slips, neither of which contains that person's own name. Then the next person draws two slips in the same way, and so on. The process will fail if the last person gets at least one slip with their own name. \n\n\nDefine q(n) to be the probability of this happening. You are given q(3)=0.3611111111 and q(5)=0.2476095994 both rounded to 10 decimal places.\n\n\nFind q(100) rounded to 10 decimal places.\n", "solution": "0.0189581208", "difficulty": 55, "story": "Once upon a time, in the cozy village of Mathland, there lived a cheerful group of friends known as the \"Magic Mathletes.\" They were renowned for their love of logic puzzles and mathematical adventures. Every year, as the holiday season approached, they embarked on a special tradition called the Magical Secret Santa.\n\nThe Magical Secret Santa was no ordinary gift exchange. In Mathland, it was customary for each person to give and receive not just one but two presents! To ensure that the process ran smoothly, they relied on a peculiar method involving slips of paper with everyone's names.\n\nThe Magic Mathletes gathered at their beloved clubhouse, a quaint cottage nestled in the heart of Mathland. The anticipation filled the air, as each friend diligently wrote their name on two slips of paper and deposited them into a festive hat. The hat would magically ensure that each person would never receive their own slip.\n\nFirst up was Eleanor, with her fiery red hair and a mischievous smile. She reached into the hat, her fingers tingling with excitement, and carefully drew two slips. Eleanor's nimble deductive skills and love for cherishing others had always made her the perfect Secret Santa.\n\nHowever, the Magical Secret Santa relied heavily on probability. Vital, the meticulous and analytical friend, always had his calculations at the ready. As Eleanor revealed her slips, she noticed that both contained the names of her closest friends, Claudia and Lucas. It was an extraordinary coincidence, one that piqued her curiosity.\n\nEleanor rushed to Vital, holding the slips up in the air. \"Vital! Look what happened. How can this be? This goes against the mathematical rules!\"\n\nVital furrowed his brow, deep in thought. He knew that the process would fail if the last person received their own name on at least one slip. The probability of that happening was measured as q(n). But here was Eleanor, faced with an improbable outcome. His mind raced to unravel this intriguing puzzle.\n\nMeanwhile, as Eleanor and Vital pondered, the rest of the Magic Mathletes continued to draw their slips. Their excitement turned to concern as more slips revealed the names of their closest friends. The air grew thick with anticipation, and doubts began to creep into their minds.\n\nThe last person to draw slips was Oliver, the kindest and most empathetic soul among them. As Oliver delved into the hat, every eye in the room was fixed on him. The fate of the Magical Secret Santa hung in the balance.\n\nOliver emerged with trembling hands, slowly revealing his two slips. The room fell silent as he glanced down at them. His face turned pale, and a mix of relief and dismay washed over him. One slip bore his own name, but the other contained the name of his dearest friend, Eleanor.\n\nAt that moment, tumultuous emotions enveloped the Magic Mathletes. Their joy and excitement for the Magical Secret Santa turned into worry and disappointment. But they remained determined to unravel the mystery that seemed to defy the very nature of probability.\n\nAs the evening drew to a close, the Magic Mathletes assembled in the cozy clubhouse, discussing their unique predicament. Eleanor turned to the group, her voice filled with curiosity and determination. \"We must solve this puzzle, my friends. We must find out the probability of this occurrence, just like Vital's calculations predicted. But how do we find q(100)?\"\n\nAnd so, dear reader, we leave you with this question. Can you crack the code of the Magical Secret Santa and determine the probability of the last person drawing their own name when there are 100 friends involved?"}, {"id": 785, "euler_id": 785, "title": "Symmetric Diophantine equation", "problem": "\nConsider the following Diophantine equation:\n15(x2+y2+z2)=34(xy+yz+zx)\nwhere x, y and z are positive integers.\n\n\nLet S(N) be the sum of all solutions, (x,y,z), of this equation such that, 1\u2264x\u2264y\u2264z\u2264N and gcd(x,y,z)=1.\n\n\nFor N=102, there are three such solutions - (1,7,16),(8,9,39),(11,21,72). So S(102)=184.\n\n\nFind S(109).\n", "solution": "29526986315080920", "difficulty": 55, "story": "In a small village nestled deep within the rolling hills, there lived a curious young girl named Lily. She had always been fascinated with numbers and patterns, finding joy in exploring the mysteries of mathematics. Her inquisitive mind led her to spend countless hours in the cozy village library, pouring over ancient texts that whispered tales of mathematical marvels.\n\nOne sunny afternoon, as the golden rays painted the village in a warm embrace, Lily stumbled upon a dusty old book hidden amongst the shelves. The title on the leather-bound cover caught her eye\u2014*The Enigma of Numbers*. Her heart skipped a beat as she delicately opened the pages, revealing scribbled equations and enigmatic symbols.\n\nAmongst an array of perplexing problems, one particular equation seized Lily's attention. It was a Diophantine equation, its elegant form etching itself into her memory. The equation read:\n\n15(x^2 + y^2 + z^2) = 34(xy + yz + zx)\n\nLily's eyes widened with curiosity as she delved into its meaning. The equation seemed to hold secrets waiting to be unraveled, and she felt an overwhelming desire to solve it.\n\nDriven by her unyielding passion, Lily embarked on a mathematical journey. Armed with her trusty journal and a stack of worn-out pencils, she set out to decipher the equation's mysterious implications.\n\nAs the days turned into weeks, and the weeks into months, Lily toiled tirelessly. Her youthful determination kept her captivated, even amid confusion and frustration. Night after night, she'd seek solace beneath the starlit sky, staring into the cosmos, hoping for divine inspiration.\n\nOne gloomy autumn evening, after months of endless contemplation, Lily experienced a eureka moment. The pieces of the puzzle came crashing together, forming a breathtaking mosaic of numbers and relationships. She had discovered a method to solve the equation.\n\nEcstatic, Lily poured over her calculations, double-checking her process. And before the sun could rise, she had obtained a beautiful result\u2014S(102) was equal to 184. The pride she felt in solving the equation, in unraveling its secrets, was immeasurable.\n\nBut Lily's journey was far from over. She now yearned to find S(10^9), a number so immense it surpassed the boundaries of her imagination. The very thought of the countless solutions waiting to be discovered excited her to no end. Determined to conquer this great mathematical challenge, she set out on a new adventure.\n\nNow, dear reader, it is your turn. Can you solve the mathematical problem presented by Lily, and find the value of S(10^9)? Will you be the one to uncover the hidden treasures that lie within the labyrinth of numbers?"}, {"id": 796, "euler_id": 796, "title": "A Grand Shuffle", "problem": "A standard 52 card deck comprises thirteen ranks in four suits. However, modern decks have two additional Jokers, which neither have a suit nor a rank, for a total of 54 cards. If we shuffle such a deck and draw cards without replacement, then we would need, on average, approximately 29.05361725 cards so that we have at least one card for each rank.\nNow, assume you have 10 such decks, each with a different back design. We shuffle all 10\u00d754 cards together and draw cards without replacement. What is the expected number of cards needed so every suit, rank and deck design have at least one card?\nGive your answer rounded to eight places after the decimal point.", "solution": "43.20649061", "difficulty": 55, "story": "Once upon a time, in the bustling city of Cardovia, there lived a talented magician named Maximus. Maximus was famous for his extraordinary card tricks and illusions, captivating audiences with his deft moves and enchanting charisma. However, there was one trick in particular that had always eluded him\u2014a trick so complex and mystifying that he spent countless hours pondering its secrets.\n\nMaximus had heard tales of a legendary 10-deck card combination, said to possess extraordinary powers that no magician had ever harnessed. Intrigued by the challenge, Maximus set out on a quest to find these enchanted decks, each adorned with a unique and mesmerizing back design.\n\nAfter days spent in dusty old bookstores and nights filled with research, Maximus discovered the location of the coveted decks. They were said to be hidden deep within the chambers of an ancient castle, guarded by puzzles, riddles, and mathematical conundrums.\n\nWith a determined glint in his eyes, Maximus set off on a journey to the castle. The path was treacherous, winding through dense forests and across perilous bridges, but he pressed on. Finally, he arrived at the towering gates of the castle, ready to face the challenges that lay ahead.\n\nAs he ventured inside, Maximus found himself in a dimly lit room, covered in cobwebs and filled with dusty old books. Scattered across the floor were stacks of playing cards, each one slightly different from the other. The air was heavy with anticipation and mystery.\n\nA voice echoed through the room, hailing from an unseen source. \"Welcome, Maximus. To claim the power of these cards, you must complete a task\u2014a task that requires both your cunning and mathematical prowess.\"\n\nMaximus listened attentively as the voice presented him with the perplexing problem of shuffling 10 decks together, each with 54 cards, and drawing cards without replacement until every suit, rank, and deck design had been acquired. The voice explained that Maximus must determine the expected number of cards needed to achieve this feat\u2014a task that required precision and a deep understanding of probability.\n\nThe magician pondered the problem, his mind racing with calculations, possibilities, and permutations. He knew that finding the answer would unlock the power of the enchanted decks and elevate his magic to unparalleled heights. This was the challenge he had sought all along, the key to unlocking his true potential.\n\nWith great focus and determination, Maximus embarked on his quest to solve the mathematical riddle. As the hours turned into days, and days into weeks, he tirelessly experimented with different strategies, devising intricate plans to achieve the desired outcome. His fingers danced across the cards, feeling the magic coursing through his veins.\n\nWhile the castle walls echoed with his intense concentration, Maximus gradually began to understand the complexities of the problem. He saw how the number of cards drawn without replacement affected the probabilities\u2014how each card moved him closer to the grand finale.\n\nBut as the magician delved deeper into the puzzle, the sound of his own heartbeat mingled with the whispers of doubt. What if he had miscalculated? What if his strategy was flawed? These questions haunted his every waking moment, yet fueled his determination to press on.\n\nDays turned into weeks, and Maximus's hair grew disheveled, and his eyes grew weary, yet he refused to surrender. The castle's enigmatic puzzle had become his obsession, his raison d'\u00eatre. With each passing day, he grew closer to unraveling the secrets hidden within the mathematical problem.\n\nAnd now, as dark clouds gather outside the castle, and Maximus stands on the precipice of discovery, he asks himself the most vital question of all. What is the expected number of cards needed so every suit, rank, and deck design have at least one card? His heart pounds, his mind races, and the answer, like the castle's hidden treasure, awaits his grasp.\n\nWith this question hanging in the air, dear reader, the tale of Maximus and his quest comes to a close. It is now your turn to find the solution to the mathematical problem\u2014a solution that will bring about the triumph of magic and the fulfillment of Maximus's destiny.\n\nSo, dear reader, tell me, what is the expected number of cards needed so every suit, rank, and deck design have at least one card? The power lies in your hands."}, {"id": 803, "euler_id": 803, "title": "Pseudorandom sequence", "problem": "\nRand48 is a pseudorandom number generator used by some programming languages. It generates a sequence from any given integer 0\u2264a0<248 using the rule an=(25214903917\u22c5an\u22121+11)mod248.\n\n\nLet bn=\u230aan/216\u230bmod52.\nThe sequence b0,b1,\u2026 is translated to an infinite string c=c0c1\u2026 via the rule:\n0\u2192 a, 1\u2192 b, \u2026, 25\u2192 z, 26\u2192 A, 27\u2192 B, \u2026, 51\u2192 Z.\n\n\nFor example, if we choose a0=123456, then the string c starts with: \"bQYicNGCY\u2026\".\nMoreover, starting from index 100, we encounter the substring \"RxqLBfWzv\" for the first time.\n\n\nAlternatively, if c starts with \"EULERcats\u2026\", then a0 must be 78580612777175.\n\n\nNow suppose that the string c starts with \"PuzzleOne\u2026\".\nFind the starting index of the first occurrence of the substring \"LuckyText\" in c.\n", "solution": "9300900470636", "difficulty": 55, "story": "Once upon a time, in the quaint town of Numeria, there lived a young girl named Emma whose mind was always brimming with curiosity and wonder. Emma possessed an insatiable passion for puzzles and riddles, constantly seeking solace in the depths of logic and numbers. It was this quest for knowledge that brought her to one of the most enigmatic puzzles that Numeria had ever encountered.\n\nRumors spread like wildfire through the town, whispering of a hidden treasure located deep within the Puzzle Forest. Legends claimed that anyone who solved the puzzle would be rewarded with unimaginable riches, but the path to that treasure remained shrouded in mystery.\n\nEmma could not resist the allure of the puzzle, and it consumed her thoughts day and night. She studied books, consulted sages, and even trekked into the depths of the forest to find clues. But the secrets of the Puzzle Forest wouldn't be revealed so easily. The trees whispered ancient riddles and the wind carried fragments of forgotten languages, but nothing seemed to make sense.\n\nAs Emma wandered through the forest, she stumbled upon a peculiar-looking stone with faded markings. Intrigued, she picked it up and brushed off the dirt that covered its surface. To her surprise, the markings on the stone seemed strikingly similar to the mathematical problem she had been trying to solve.\n\nWith excitement pulsating through her veins, Emma deciphered the problem inscribed on the stone. It was no ordinary riddle; it held the key to unlocking the treasure of the Puzzle Forest. The mathematical problem read:\n\n\"Rand48 is a pseudorandom number generator used by some programming languages. It generates a sequence from any given integer 0\u2264a0<248 using the rule an=(25214903917\u22c5an\u22121+11)mod248.\n\nLet bn=\u230aan/216\u230bmod52.\nThe sequence b0,b1,\u2026 is translated into an infinite string c=c0c1\u2026 via the rule:\n0\u2192 a, 1\u2192 b, \u2026, 25\u2192 z, 26\u2192 A, 27\u2192 B, \u2026, 51\u2192 Z.\n\nFor example, if we choose a0=123456, then the string c starts with: 'bQYicNGCY\u2026'.\nMoreover, starting from index 100, we encounter the substring 'RxqLBfWzv' for the first time.\n\nAlternatively, if c starts with 'EULERcats\u2026', then a0 must be 78580612777175.\n\nNow suppose that the string c starts with 'PuzzleOne\u2026'.\nFind the starting index of the first occurrence of the substring 'LuckyText' in c.\"\n\nAs Emma read the problem, she felt a surge of energy course through her. The pieces of the puzzle finally started to come together in her mind. She realized that the sequence generated by the pseudorandom number generator was intertwined with the forest itself. The very fabric of the Puzzle Forest was encoded within those mathematical formulas.\n\nFilled with a newfound determination, Emma set out to solve the puzzle and claim the treasure that awaited her. She retraced her steps through the forest, discovering hitherto unseen patterns and decoding the hidden messages among the trees. The more she delved into the problem, the more she realized that each step was crucial, leading her closer to the ultimate answer.\n\nDays turned into weeks, and weeks turned into months. Emma's obsession with the puzzle consumed her entirely. She dedicated every waking hour to unraveling its mysteries, her mind begging for a solution. But even as her fingers traced the numbers and her eyes scoured the string, she couldn't help but wonder\u2014what was the significance of finding the starting index of the first occurrence of the substring 'LuckyText'?\n\nSo, dear reader, as we leave Emma standing at the edge of the Puzzle Forest, staring into the unknown, I ask you this: can you solve the mathematical problem and uncover the secrets that lie within the forest? What awaits Emma and the enchanted town of Numeria? The answers may just lie in the depths of your own mathematical prowess."}, {"id": 805, "euler_id": 805, "title": "Shifted Multiples", "problem": "\nFor a positive integer n, let s(n) be the integer obtained by shifting the leftmost digit of the decimal representation of n to the rightmost position.\nFor example, s(142857)=428571 and s(10)=1.\n\nFor a positive rational number r, we define N(r) as the smallest positive integer n such that s(n)=r\u22c5n.\nIf no such integer exists, then N(r) is defined as zero.\nFor example, N(3)=142857, N(110)=10 and N(2)=0.\n\nLet T(M) be the sum of N(u3/v3) where (u,v) ranges over all ordered pairs of coprime positive integers not exceeding M.\nFor example, T(3)\u2261262429173(mod1000000007).\n\nFind T(200). Give your answer modulo 1000000007. ", "solution": "119719335", "difficulty": 55, "story": "Once upon a time in the enchanted kingdom of Numeria, there lived a young and curious mathematician named Emma. Emma possessed an insatiable hunger for unraveling the mysteries of numbers, and her thoughts were constantly consumed with various mathematical problems.\n\nOne day, as she roamed the chambers of the Royal Library, Emma stumbled upon an old, dusty book hidden beneath a stack of papers. Intrigued, she carefully blew off the layers of grime and opened it to a page that caught her eye. The page was adorned with an elegant script and a peculiar problem.\n\n\"For a positive integer n, let s(n) be the integer obtained by shifting the leftmost digit of the decimal representation of n to the rightmost position,\" she read softly to herself. The problem seemed simple enough, but the implications intrigued her.\n\nAs Emma delved further into the book, she discovered that the problem had deeper significance. It spoke of something called N(r), the smallest positive integer n where s(n) equaled r multiplied by n. Emma's curiosity heightened, and she feverishly sought to understand the implications of this mysterious function.\n\n\"What if I could find the value of N(u3/v3) for all ordered pairs of coprime positive integers not exceeding a particular value M?\" she pondered. The book mentioned a function T(M), which was the sum of all N(u3/v3) values.\n\nIntrigued, Emma embarked on a journey to uncover the secrets of T(M). She traveled far and wide, seeking the wisdom of esteemed mathematicians and researchers. Along her journey, Emma met a sage named Professor Magnus who had unraveled the enigma of T(M) himself.\n\nProfessor Magnus explained that the function T(M) had profound importance when dealing with patterns in numbers. It helped measure and understand the relationships between fractions and their respective shifted forms using the s(n) function. If harnessed correctly, T(M) could unravel hidden structures within numerical systems.\n\nDetermined to put her newfound knowledge into practice, Emma returned to Numeria's Royal Library, where she gathered countless documents, books, and scrolls about fractions, shifted numbers, and patterns. With each revelation, she became more obsessed with the mysterious T(M).\n\nMonths turned into years as Emma tirelessly sought to comprehend the patterns and complexities within T(M). She made innumerable breakthroughs, but the final piece of the puzzle eluded her.\n\nAs she neared the conclusion of her investigation, Emma realized the enormity of her journey. She had come so far and made countless discoveries, but the answer to T(M) continued to elude even the most cunning minds in Numeria.\n\nNow, dear reader, I leave you with Emma's ultimate question, the question that has haunted her dreams and consumed her waking thoughts: What is T(200)? Can you solve the mathematical problem she couldn't?\n\nAnd so, the story of Emma, the inquisitive mathematician, continues. In the vast realm of numbers, countless mysteries remain unsolved. But Emma's tireless pursuit will forever inspire those who come after her to seek knowledge, even when the answers seem unattainable.\n\nWill you be the one to solve the enigma of T(200)?"}]