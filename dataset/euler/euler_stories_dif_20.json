[{"id": 60, "euler_id": 60, "title": "Prime pair sets", "problem": "The primes 3, 7, 109, and 673, are quite remarkable. By taking any two primes and concatenating them in any order the result will always be prime. For example, taking 7 and 109, both 7109 and 1097 are prime. The sum of these four primes, 792, represents the lowest sum for a set of four primes with this property.\nFind the lowest sum for a set of five primes for which any two primes concatenate to produce another prime.", "solution": "26033", "difficulty": 20, "story": "Once upon a time, in a quaint little village nestled between rolling hills and a sparkling river, there lived a young boy named Milo. Milo had always been fascinated with numbers and patterns, spending countless hours with his nose buried in books about mathematics. He dreamed of unraveling the mysteries of the world, of finding hidden treasures within the numbers that surrounded him. Little did he know that his dreams were about to come true.\n\nOne sunny day, as Milo was playing in the meadow, he stumbled upon an old diary tucked beneath a moss-covered log. Intrigued, he blew away the dust and opened it, revealing yellowed pages filled with complex equations and scribbled notes.\n\nAs Milo pored over the diary's contents, he discovered a remarkable mathematical problem outlined on one of the pages. It spoke of four extraordinary primes\u20143, 7, 109, and 673. These primes possessed a unique quality; when any two of them were concatenated in any order, the resulting number would always be prime. Milo's mind began to weave intricate patterns, and he couldn't help but wonder if there was more to uncover.\n\nDays turned into weeks, and weeks into months as Milo eagerly delved deeper into the problem. He spent countless nights beneath his cozy blanket, pencil in hand, diligently searching for a set of five primes that held the same mysterious property\u2014the elusive quest for the lowest sum. Excitement bubbled within him, as if he were on the verge of unraveling the secrets of the universe itself.\n\nThe village could see the transformation in young Milo, how his eyes seemed to sparkle with a newfound purpose. The villagers marveled at his dedication and admired his unyielding curiosity. Word of Milo's pursuit reached the ears of a renowned mathematician, Professor Arthur, who had spent his life uncovering the enigmas locked within numbers.\n\nIntrigued, Professor Arthur journeyed to the village and sought out Milo beneath the ancient oak tree where the young boy often spent his afternoons. The professor was impressed by Milo's determination and knowledge, and together they explored the depths of the mathematical problem.\n\n\"Do you realize what this means, young Milo?\" Professor Arthur exclaimed, his eyes shining with excitement. \"This set of remarkable primes holds a mystery yet to be unraveled. It is as if the numbers themselves possess a secret language, a hidden code waiting to be deciphered.\"\n\nMilo's heart raced, his mind spinning with possibilities. He knew that this quest was not just a journey into the world of numbers, but a journey into discovery. Together, they immersed themselves in the problem, pouring over graphs and equations, seeking the patterns that would unlock the solution.\n\nAs months rolled by and the sun inched closer to the horizon, Milo and Professor Arthur grew closer to the answer. The village watched with bated breath as their young prodigy neared the pinnacle of his quest.\n\nBut as the last golden leaf of autumn finally surrendered to the chilly winds of winter, Milo and Professor Arthur came to a standstill. They found themselves staring at a seemingly insurmountable hurdle\u2014a problem that lingered just beyond their reach.\n\n\"Can it be solved?\" Milo whispered, his gaze locked on the numbers speckling the page of the diary. He couldn't bear the thought of the mysterious primes eluding him, fading into obscurity like whispers lost in the wind.\n\nNow, dear reader, it is up to you to continue this tale. Can you find the lowest sum for a set of five primes with the same remarkable property? Will Milo's dreams of unraveling the secrets of this mathematical problem ever be realized? The answers lie within the realm of numbers, waiting to be discovered."}, {"id": 61, "euler_id": 61, "title": "Cyclical figurate numbers", "problem": "Triangle, square, pentagonal, hexagonal, heptagonal, and octagonal numbers are all figurate (polygonal) numbers and are generated by the following formulae:\nTriangle\n\u00a0\nP3,n=n(n+1)/2\n\u00a0\n1, 3, 6, 10, 15, ...\nSquare\n\u00a0\nP4,n=n2\n\u00a0\n1, 4, 9, 16, 25, ...\nPentagonal\n\u00a0\nP5,n=n(3n\u22121)/2\n\u00a0\n1, 5, 12, 22, 35, ...\nHexagonal\n\u00a0\nP6,n=n(2n\u22121)\n\u00a0\n1, 6, 15, 28, 45, ...\nHeptagonal\n\u00a0\nP7,n=n(5n\u22123)/2\n\u00a0\n1, 7, 18, 34, 55, ...\nOctagonal\n\u00a0\nP8,n=n(3n\u22122)\n\u00a0\n1, 8, 21, 40, 65, ...\nThe ordered set of three 4-digit numbers: 8128, 2882, 8281, has three interesting properties.\nThe set is cyclic, in that the last two digits of each number is the first two digits of the next number (including the last number with the first).\nEach polygonal type: triangle (P3,127=8128), square (P4,91=8281), and pentagonal (P5,44=2882), is represented by a different number in the set.\nThis is the only set of 4-digit numbers with this property.\nFind the sum of the only ordered set of six cyclic 4-digit numbers for which each polygonal type: triangle, square, pentagonal, hexagonal, heptagonal, and octagonal, is represented by a different number in the set.", "solution": "28684", "difficulty": 20, "story": "Once upon a time, in the kingdom of Mathlandia, there was a young princess named Aria. She had the remarkable ability to see patterns and solve puzzles. Her mind was always brimming with curiosity, and she spent her days exploring the vast gardens of the royal palace.\n\nOne sunny afternoon, as Princess Aria sat by a sparkling fountain, she noticed an elderly man named Professor Euler. With his long white beard and spectacles perched on his nose, he was engrossed in a book filled with numbers. Princess Aria's curiosity was piqued, and she approached the professor.\n\n\"Excuse me, Professor Euler,\" Princess Aria said politely, \"may I ask what you're reading? It seems so fascinating!\"\n\nThe professor looked up and smiled. \"Ah, Princess Aria, you have a keen eye. I am studying a series of numbers known as figurate numbers. They have unique properties and follow specific formulas.\"\n\nIntrigued, Princess Aria leaned in closer. \"Tell me more, Professor! I would love to learn about these figurate numbers.\"\n\nThe professor nodded and began explaining. \"Well, my dear princess, these numbers are derived from different polygon shapes. Each polygon has its own formula that generates a sequence of numbers. For example, triangular numbers follow the formula P3, n = n(n+1)/2, resulting in a sequence like 1, 3, 6, 10, 15, and so on.\"\n\nPrincess Aria's eyes sparkled with excitement. \"So each polygon has its own formula and sequence of numbers?\"\n\n\"Yes, indeed!\" Professor Euler replied. \"There are square, pentagonal, hexagonal, heptagonal, and octagonal numbers as well. Each of them has its own unique formula and series.\"\n\nThe princess's imagination ran wild as she contemplated these fascinating numbers. The idea of different polygons and their corresponding formulas intrigued her greatly. But it was when the professor mentioned a remarkable set of numbers that Princess Aria's curiosity was truly piqued.\n\n\"The ordered set of three 4-digit numbers: 8128, 2882, 8281, has three interesting properties,\" the professor explained. \"The set is cyclic, in that the last two digits of each number is the first two digits of the next number. Additionally, each polygonal type - triangle, square, and pentagonal - is represented by a different number in the set. This is the only set of 4-digit numbers with this property.\"\n\nPrincess Aria's mind raced with excitement. She could hardly contain her eagerness to unravel this mathematical mystery. \"Professor, is it possible to find a set of six cyclic 4-digit numbers that represent each polygonal type?\"\n\nThe wise professor chuckled and tapped his chin. \"Ah, Princess Aria, that is where the real challenge lies. Finding such a set is no easy feat. It requires a deep understanding of figurate numbers and their interplay. But if anyone can crack this puzzle, it is you, my young princess.\"\n\nPrincess Aria's eyes shone with determination. She knew she was up for the challenge. As she delved further into the world of figurate numbers, she couldn't help but wonder. Could she uncover the elusive set of six cyclic 4-digit numbers that represented each polygonal type? Would she be able to find a solution to this fascinating mathematical problem?\n\nAnd so, dear reader, I leave you with this question: Can you unravel the mystery and find the sum of the only ordered set of six cyclic 4-digit numbers for which each polygonal type is represented by a different number in the set?"}, {"id": 64, "euler_id": 64, "title": "Odd period square roots", "problem": "All square roots are periodic when written as continued fractions and can be written in the form:\nN=a0+1a1+1a2+1a3+\u2026\nFor example, let us consider 23:\n23=4+23\u22124=4+1123\u22124=4+11+23\u221237\nIf we continue we would get the following expansion:\n23=4+11+13+11+18+\u2026\nThe process can be summarised as follows:\n\na0=4,123\u22124=23+47=1+23\u221237\na1=1,723\u22123=7(23+3)14=3+23\u221232\na2=3,223\u22123=2(23+3)14=1+23\u221247\na3=1,723\u22124=7(23+4)7=8+23\u22124\na4=8,123\u22124=23+47=1+23\u221237\na5=1,723\u22123=7(23+3)14=3+23\u221232\na6=3,223\u22123=2(23+3)14=1+23\u221247\na7=1,723\u22124=7(23+4)7=8+23\u22124\nIt can be seen that the sequence is repeating. For conciseness, we use the notation 23=[4;(1,3,1,8)], to indicate that the block (1,3,1,8) repeats indefinitely.\nThe first ten continued fraction representations of (irrational) square roots are:\n\n2=[1;(2)], period=1\n3=[1;(1,2)], period=2\n5=[2;(4)], period=1\n6=[2;(2,4)], period=2\n7=[2;(1,1,1,4)], period=4\n8=[2;(1,4)], period=2\n10=[3;(6)], period=1\n11=[3;(3,6)], period=2\n12=[3;(2,6)], period=2\n13=[3;(1,1,1,1,6)], period=5\n\nExactly four continued fractions, for N\u226413, have an odd period.\nHow many continued fractions for N\u226410000 have an odd period?", "solution": "1322", "difficulty": 20, "story": "Once upon a time in the enchanting land of Mathemagica, there lived a peculiar wizard named Professor Fibonacci. With a long white beard that reached the ground and a hat adorned with numbers and symbols, he was known far and wide for his mathematical prowess. Professor Fibonacci spent his days tinkering in his tower, exploring the mysteries of numbers and the secrets they held.\n\nOne sunny morning, as Professor Fibonacci was sipping his morning tea, a young girl named Lily came rushing into his tower. Breathless and excited, she proclaimed, \"Professor, I have discovered something fascinating! It's about square roots and continued fractions!\"\n\nIntrigued, the professor motioned for Lily to sit down and explain further. She began, \"Professor, I was studying the nature of square roots, and I stumbled upon this mathematical problem. All square roots can be written as continued fractions! You see, the square root of a number can be expressed as the sum of a whole number and the reciprocal of another number. And this process can be continued indefinitely!\"\n\nAs Lily spoke, Professor Fibonacci's eyes sparkled with excitement. He had spent years investigating the properties of numbers, and this revelation opened up a whole new avenue for exploration. He realized that this arcane mathematical problem was not just some esoteric curiosity but held immense potential.\n\n\"Lily, my dear, you have discovered a magnificent secret,\" Professor Fibonacci exclaimed. \"This continued fraction representation of square roots is remarkable. It allows us to express irrational numbers in a finite and concise form. But there is more. The length of these continued fractions can be periodic, repeating in a pattern! I must delve deeper into this mystery.\"\n\nFrom that moment on, Professor Fibonacci and Lily worked tirelessly, pouring over ancient texts, experimenting with various square roots, and uncovering the patterns hidden within the continued fractions. They discovered that some square roots had a periodicity of odd lengths \u2013 a peculiar quirk that captured their attention.\n\nTheir excitement knew no bounds as they delved further into these odd periods and the mathematical harmony they represented. They marveled at the elegance of the numbers, their interplay, and the rhythmic dance they orchestrated. The odd periods became a subject of obsession for the professor and his young apprentice.\n\nThe secret of the odd periods drove Professor Fibonacci and Lily to create the most intricate and complex formulas, pushing the boundaries of mathematical knowledge. Each day, they would work tirelessly, their passion burning brightly as they strove to solve the enigma of odd periods.\n\nAnd now dear reader, the story reaches its climax. Professor Fibonacci and Lily have journeyed far and wide, exploring the depths of their beloved Mathemagica, discovering and unlocking new mathematical realms. But the question remains, dear reader: how many continued fractions, for all numbers up to 10000, will possess an odd period?\n\nAs the sun sets on this enchanting tale, I leave you with this final question. Can you unlock the secret that has captivated the minds of Professor Fibonacci and Lily? How many continued fractions will indeed have an odd period? The answer lies at the intersection of imagination and mathematical prowess."}, {"id": 70, "euler_id": 70, "title": "Totient permutation", "problem": "Euler's Totient function, \u03c6(n) [sometimes called the phi function], is used to determine the number of positive numbers less than or equal to n which are relatively prime to n. For example, as 1, 2, 4, 5, 7, and 8, are all less than nine and relatively prime to nine, \u03c6(9)=6.The number 1 is considered to be relatively prime to every positive number, so \u03c6(1)=1. \nInterestingly, \u03c6(87109)=79180, and it can be seen that 87109 is a permutation of 79180.\nFind the value of n, 1 < n < 107, for which \u03c6(n) is a permutation of n and the ratio n/\u03c6(n) produces a minimum.", "solution": "8319823", "difficulty": 20, "story": "Once upon a time in a small village, there lived a young and curious girl named Ada. Ada had always been fascinated by numbers and patterns. While her friends spent their days playing tag and hide-and-seek, Ada could often be found sitting under a large oak tree, pouring over her books of mathematics and puzzles. To Ada, the world was like a giant puzzle waiting to be solved, and she reveled in the challenge.\n\nOne day, a tired and disheveled traveler arrived in the village square. He carried with him a large backpack filled with dusty scrolls and papers. Ada's eyes lit up with excitement, intrigued by the mysterious visitor.\n\nIntrigued, Ada approached the traveler and asked, \"Excuse me, sir. I couldn't help but notice the many scrolls you carry. What brings you to our humble village?\"\n\nThe traveler smiled wearily. \"Ah, young one. I am in search of a solution to a mathematical problem that has confounded me for weeks. It involves Euler's Totient function, \u03c6(n), and I fear I have exhausted all my resources. These scrolls contain my notes and calculations.\"\n\nAda's heart skipped a beat. It was as if the universe had conspired to bring this problem to her, like a gift waiting to be unwrapped. She knew that she had to help the traveler and solve the problem that had eluded him.\n\n\"Sir, I am Ada, and I have spent years studying mathematics. Perhaps I can be of assistance,\" she offered eagerly.\n\nThe traveler raised an eyebrow and regarded her with cautious hope. \"Very well, young Ada. The problem at hand involves finding a specific value of n, where \u03c6(n) is a permutation of n, and the ratio n/\u03c6(n) produces a minimum. Can you help me find this value?\"\n\nAda's eyes sparkled with excitement. This problem was like a mysterious treasure waiting to be uncovered. She pondered for a moment, quickly recognizing that this problem could not be solved by brute force alone.\n\n\"Sir, I believe I can provide a solution, but I need to analyze the properties of Euler's Totient function more deeply,\" Ada explained. \"May I take these scrolls and study them further?\"\n\nThe traveler, grateful for Ada's willingness to help, handed her the dusty scrolls with a word of caution. \"Be careful, young Ada. This problem has consumed me for weeks. Make haste, for time is of the essence.\"\n\nFor days and nights, Ada delved into the scrolls, her mind swirling with symbols and equations. She discovered that Euler's Totient function, \u03c6(n), was intimately connected with the prime factors of a number. The more prime factors a number had, the smaller the value of \u03c6(n). Ada also realized that in the case of a prime number, \u03c6(n) would always be n-1.\n\nExcitedly, Ada began generating a list of prime numbers. She checked each prime number for the condition that \u03c6(n) was a permutation of n. Iterating through the list, Ada kept calculating n/\u03c6(n), seeking to minimize its value.\n\nFinally, after countless sleepless nights, Ada found a value of n that fulfilled both conditions\u2014the ratio n/\u03c6(n) reached its minimum, and \u03c6(n) was indeed a permutation of n. Her mind raced with possibilities\u2014what was the value of n? Was the traveler still waiting for her solution?\n\nWith a renewed sense of purpose, Ada rushed to the village square, clutching her notes and calculations. As she approached, her eyes surveyed the crowd, searching for the familiar face of the weary traveler. But he was nowhere to be found.\n\nDespair gripped her heart. Had the traveler given up? Were her efforts in vain? Ada felt a single tear trickle down her cheek as she whispered into the wind, \"Where are you, sir? Have you lost hope?\"\n\nAs if in response, a gust of wind swept through the square, carrying with it a gentle voice. \"Ada, my dear girl, you have found the answer. But the task was never about me. It was about you and your insatiable hunger for knowledge.\"\n\nAda looked up, her eyes filled with confusion. \"Who are you?\"\n\n\"I am the embodiment of your thirst for understanding, to unravel the mysteries of the universe,\" the voice replied. \"Now, tell me, Ada, what is the value of n that fulfills the conditions?\"\n\nBut before Ada could answer, the voice dissipated, leaving only a sense of fulfillment and an insatiable curiosity within her soul.\n\nDear reader, can you solve the mystery that Ada has unlocked? What is the value of n, 1 < n < 107, for which \u03c6(n) is a permutation of n, and the ratio n/\u03c6(n) produces a minimum?"}, {"id": 72, "euler_id": 72, "title": "Counting fractions", "problem": "Consider the fraction, n/d, where n and d are positive integers. If n<d and HCF(n,d)=1, it is called a reduced proper fraction.\nIf we list the set of reduced proper fractions for d \u2264 8 in ascending order of size, we get:\n1/8, 1/7, 1/6, 1/5, 1/4, 2/7, 1/3, 3/8, 2/5, 3/7, 1/2, 4/7, 3/5, 5/8, 2/3, 5/7, 3/4, 4/5, 5/6, 6/7, 7/8\nIt can be seen that there are 21 elements in this set.\nHow many elements would be contained in the set of reduced proper fractions for d \u2264 1,000,000?", "solution": "303963552391", "difficulty": 20, "story": "Once upon a time in the kingdom of Arithmania, there lived a young and curious prince named Frederick. Unlike his royal peers who delighted in extravagant parties and hunting, Prince Frederick found solace in numbers and the secrets they held. He spent his days exploring the magic of arithmetic and the wonders of mathematics.\n\nOne sunny day, Prince Frederick stumbled upon an ancient scroll hidden deep within the royal library. As he carefully unraveled it, his eyes widened in awe at the complex symbols and equations it contained. The scroll held within it the key to a mysterious mathematical problem that had perplexed the greatest minds of the kingdom for centuries.\n\nThe problem intrigued Prince Frederick, and he devoted all his time to deciphering its hidden meaning. It spoke of a set of unique fractions, called reduced proper fractions, and their order of appearance when the denominator, represented as d, was limited to numbers no greater than 8. The scroll listed these fractions in ascending order of size, and displayed 21 elements, but the real mystery lay in the question it posed.\n\nPrince Frederick read aloud, \"How many elements would be contained in the set of reduced proper fractions for d \u2264 1,000,000?\" The young prince's mind whirled with excitement. This was a challenge he couldn't resist. The answer lay within his grasp, and he felt an urge to solve the riddle and reveal the secret of the set.\n\nIn the days that followed, Prince Frederick became consumed with finding the solution to the mathematical problem. He immersed himself in the world of fractions, exploring their patterns, simplifying and reducing them until he understood the intricacies of the unique set described in the ancient scroll. The young prince's determination knew no bounds as he delved deeper into the realm of numbers.\n\nAs Prince Frederick's knowledge grew, so did his ambition. He realized that solving this problem would not only reveal the secrets of the kingdom's mysterious scroll but would also elevate him to the esteemed ranks of great mathematicians and scholars. The prospect of securing his place in history fueled his every thought and action.\n\nMonths turned into years as Prince Frederick tirelessly worked on unraveling the mystery. His dedication was unmatched, yet the answer to the mathematical problem eluded him. Doubt began to creep into his thoughts, clouding his once-clear vision of triumph. But the young prince refused to give up.\n\nThe kingdom of Arithmania waited with bated breath as news of Prince Frederick's pursuit spread. The great minds of the kingdom watched in awe as the once-young prince grew into an exceptional mathematician. People began flocking to the royal palace, seeking answers to their own mathematical conundrums.\n\nThe years turned into decades, and Prince Frederick became an aging king. He never lost sight of his purpose, the mathematical problem forever etched in his mind. His nights were spent poring over the scroll, his days filled with discussions with scholars and mathematicians from far and wide. The magical secrets of the set of reduced proper fractions remained just beyond his grasp.\n\nOne fateful day, King Frederick sat alone in his study, surrounded by a lifetime of efforts and unanswered questions. He gazed out the window at the kingdom he had devoted his life to, pondering his legacy. The king's weary eyes fell upon the scroll, and once again, he allowed himself to be consumed by the enigma.\n\nWith a surge of determination, King Frederick made a decision. He summoned the kingdom's greatest scribes and ordered them to duplicate the ancient scroll. His intention was simple but profound; he would share the scroll with the world, utilizing the combined intellect of the entire kingdom to solve the riddle that had evaded him for decades.\n\nAnd so, the scroll was meticulously copied, and copies were distributed to scholars, mathematicians, and curious souls from every corner of the realm. The kingdom of Arithmania buzzed with excitement and anticipation. Would the combined might of countless minds finally unlock the mathematical problem's secret, and reveal the answer that had eluded King Frederick for so long?\n\nAs the story comes to an end, the question remains unanswered. Can you, dear reader, unravel the secret of the scroll? How many elements would be contained in the set of reduced proper fractions for d \u2264 1,000,000?"}, {"id": 80, "euler_id": 80, "title": "Square root digital expansion", "problem": "It is well known that if the square root of a natural number is not an integer, then it is irrational. The decimal expansion of such square roots is infinite without any repeating pattern at all.\nThe square root of two is 1.41421356237309504880..., and the digital sum of the first one hundred decimal digits is 475.\nFor the first one hundred natural numbers, find the total of the digital sums of the first one hundred decimal digits for all the irrational square roots.", "solution": "40886", "difficulty": 20, "story": "Once upon a time in the mystical land of Numeralia, where every aspect of life revolved around numbers and mathematical phenomena, lived a young apprentice by the name of Leonardo. Leonardo was a diligent student who aspired to become a respected mathematician. Under the guidance of his mentor, Professor Euler, he delved into the magical world of numbers, seeking to unravel their secrets.\n\nOne sunny morning, as Leonardo scurried through the vibrant streets of Numeralia, he stumbled upon a peculiar sight. A crowd had gathered outside a modest house, murmuring and shaking their heads with a mix of curiosity and confusion. Intrigued, he pushed his way through, anxious to discover the source of their bewilderment.\n\nInside the house, Leonardo found a frail old man named Archimedes, who was renowned for his unmatched knowledge of numbers. Archimedes had dedicated his life to solving the mysteries of mathematics. However, age had gotten the better of him, and he now found himself trapped within the confines of a seemingly unsolvable challenge.\n\nCuriosity sparked within Leonardo as he observed Archimedes poring over countless equations and scribbling furiously with a quill. Sensing an opportunity to impress his mentor, he stepped forward and bowed respectfully.\n\n\"Sir, I am Leonardo, an apprentice of Professor Euler. How may I assist you?\" he asked, his voice trembling with excitement.\n\nArchimedes looked up, a glimmer of hope shining in his weary eyes. \"Leonardo, my dear boy,\" he said, his voice raspy with age, \"I seek the solution to a perplexing mathematical problem that has plagued me for days. I fear my time is running out, and I need your help.\"\n\n\"Tell me, sir,\" Leonardo urged eagerly. \"I will do everything within my power to aid you.\"\n\nArchimedes nodded in appreciation. \"Young Leonardo, it is well known that if the square root of a natural number is not an integer, then it is irrational. The decimal expansion of such square roots is infinite without any repeating pattern at all. The square root of two, for example, is 1.41421356237309504880... As you know, the digital sum of the first one hundred decimal digits is 475.\"\n\nLeonardo furrowed his brow, attempting to comprehend the significance of Archimedes' words. \"If I may, sir,\" he ventured tentatively. \"Could you explain how this relates to your current predicament?\"\n\nArchimedes's gaze softened. \"Of course, my young apprentice. I have endeavored to find the solution to a seemingly impossible task: the total of the digital sums of the first one hundred decimal digits for all the irrational square roots of the first one hundred natural numbers. This conundrum has consumed me, Leonardo. Will you embark on this quest with me?\"\n\nLeonardo's heart swelled with a mix of trepidation and excitement. He knew that solving Archimedes' puzzle would not only earn him respect among the people of Numeralia but also solidify his reputation as a talented mathematician.\n\nWith newfound purpose, Leonardo set off on a grand adventure, traversing the mystical landscapes of Numeralia in search of clues and hidden knowledge. He visited ancient libraries, consulted sage mathematicians, and even braved treacherous caves rumored to hold the secrets of the universe.\n\nAs he delved deeper into his quest, Leonardo discovered fascinating patterns and numerical structures, each piece of the puzzle leading him closer to the answer. The air buzzed with anticipation as he made breakthrough after breakthrough, recording his findings in a tattered notebook.\n\nDays turned into weeks, and weeks turned into months, but Leonardo's dedication remained unwavering. He sacrificed sleep and pushed his mind to its limits, all in the pursuit of mathematical truth. He knew that the answer to Archimedes' problem lay tantalizingly close, waiting to be unraveled.\n\nAnd now, as the sun begins its descent behind the majestic mountains of Numeralia, Leonardo finds himself on the precipice of discovery. The air tingles with an almost palpable excitement as he gazes at the final equation etched upon the pages of his notebook, the culmination of endless calculations and restless nights.\n\nBut dear reader, I must leave you here, with Leonardo on the verge of extraordinary revelation. The question that echoes through Numeralia and hangs in the air, begging for an answer, remains: For the first one hundred natural numbers, what is the total of the digital sums of the first one hundred decimal digits for all the irrational square roots?\n\nIt is now your turn to embark on this thrilling quest, to dive into the infinite world of numbers and unravel the enigma that has captivated the minds of wise mathematicians and young apprentices alike. Can you find the answer that Archimedes and Leonardo sought so fervently?"}, {"id": 87, "euler_id": 87, "title": "Prime power triples", "problem": "The smallest number expressible as the sum of a prime square, prime cube, and prime fourth power is 28. In fact, there are exactly four numbers below fifty that can be expressed in such a way:\n28 = 22 + 23 + 24\n33 = 32 + 23 + 24\n49 = 52 + 23 + 24\n47 = 22 + 33 + 24\nHow many numbers below fifty million can be expressed as the sum of a prime square, prime cube, and prime fourth power?", "solution": "1097343", "difficulty": 20, "story": "Once upon a time in the land of Numeria, a young mathematician named Lila was on a quest to solve a mathematical mystery that had puzzled her for months. She had dedicated her life to the world of numbers and equations, seeking the thrill in deciphering their secrets. Deep in her heart, Lila knew that numbers held the key to unlocking the mysteries of the universe.\n\nAs the sun rose over the land, painting the sky with hues of gold and pink, Lila sat in her small study, surrounded by stacks of books and scrolls. Her eyes flickered with anticipation as she embarked on the most enigmatic journey yet, one that centered around a peculiar mathematical problem.\n\n\"The smallest number expressible as the sum of a prime square, prime cube, and prime fourth power is 28,\" Lila recited, her voice filled with determination and curiosity. \"In fact, there are exactly four numbers below fifty that can be expressed in such a way.\"\n\nHer heart raced with excitement as she began to examine the patterns and connections hidden within the numbers. She meticulously wrote down the mathematical equations, searching for a thread that could lead her to the answers she sought. The challenge intrigued her, for it was not merely a series of calculations but a puzzle begging to be solved.\n\nDays turned into weeks, and weeks into months as Lila delved deeper into her quest. Night after night, she pored over ancient texts, seeking guidance from the great mathematicians of the past. She studied the works of Gauss, Euler, and Ramanujan, drawing inspiration from their insights. But even as she unearthed fragments of knowledge, the solution to her puzzle eluded her.\n\nTormented by a restless mind, Lila's days were filled with countless calculations. She roamed the forests surrounding Numeria, her mind engaged in a dance of numbers, trying to find the sacred connection that would unravel the mystery.\n\nAs time passed, her efforts began to bear fruit. Lila discovered that within the vast world of numbers, there indeed existed a sequence that could be expressed as the sum of a prime square, prime cube, and prime fourth power. But curiosity consumed her; she yearned to uncover the extent of this pattern's reach.\n\nLila's thoughts wandered to the kingdom of Arithmos, where scholars and mathematicians gathered to share their knowledge. She knew that if she were to find her answers, she needed to seek guidance from the wise elders of Arithmos.\n\nWith conviction in her heart and a map in her hands, Lila embarked on a journey that would take her across treacherous landscapes and through mystical forests. She crossed raging rivers and faced menacing creatures, each step bringing her closer to the knowledge she sought.\n\nFinally, after what seemed like an eternity, she reached the hallowed halls of Arithmos. Within these ancient walls, her voice was heard, and her mathematical problem echoed through the minds of the scholars.\n\nDays turned into weeks once again as the wisest minds in all of Numeria gathered to ponder the enigma that had captured Lila's imagination. They combed through their extensive libraries, reading every scroll and studying every equation, seeking the elusive answer.\n\nAs the sun set on the day of the grand conclave, Lila sat in the center of a circle of scholars, their collective wisdom pulsating in the air. The moment had finally arrived. The solution was within reach, and it was far greater than Lila had ever imagined.\n\nThe head scholar, an aged man with a flowing white beard, rose from his seat and turned to face Lila. His voice was filled with awe and reverence as he declared, \"Lila, you have discovered something truly extraordinary. The number of numbers below fifty million that can be expressed as the sum of a prime square, prime cube, and prime fourth power is...\"\n\nBut alas, my dear reader, the answer to this enigma remains a mystery, just out of reach. For it is now up to you to take up the mantle, to traverse the intricate labyrinth of numbers and solve the puzzle that has fascinated Lila and all who have dared to tread in her footsteps.\n\nSo I ask you, with a glint of anticipation in my eyes, how many numbers below fifty million can be expressed as the sum of a prime square, prime cube, and prime fourth power? Will you embark on this mathematical adventure and unlock the hidden knowledge that lies within the realm of numbers?"}, {"id": 145, "euler_id": 145, "title": "How many reversible numbers are there below one-billion?", "problem": "Some positive integers n have the property that the sum [ n + reverse(n) ] consists entirely of odd (decimal) digits. For instance, 36 + 63 = 99 and 409 + 904 = 1313. We will call such numbers reversible; so 36, 63, 409, and 904 are reversible. Leading zeroes are not allowed in either n or reverse(n).\nThere are 120 reversible numbers below one-thousand.\nHow many reversible numbers are there below one-billion (109)?", "solution": "608720", "difficulty": 20, "story": "Once upon a time in the small town of Numerica, there lived a talented mathematician named Amelia. Amelia had a special gift for numbers and could solve even the most complicated mathematical problems with ease. But amidst the ordinary life of solving equations and theorems, she stumbled upon a peculiar puzzle that captivated her mind.\n\nOne sunny morning, as she sipped her tea in the tranquil garden, Amelia stumbled upon an ancient book hidden among the shelves of her study. Intrigued by its worn leather cover, she opened it to discover a fascinating problem that piqued her curiosity.\n\nThe problem spoke of reversible numbers - integers that had the unique quality of creating a sum consisting entirely of odd digits when combined with their reverse. This extraordinary property fascinated Amelia, and she set out to explore the mysterious world of reversible numbers.\n\nDays passed, and Amelia immersed herself in the captivating challenge. She discovered that some reversible numbers included quantities such as 36, 63, 409, and 904. As she delved deeper into the problem, she realized that leading zeroes were not allowed in these reversible numbers.\n\nThe book mentioned that there were exactly 120 reversible numbers below one thousand. Amelia's mind swirled with possibilities and curiosity. She wondered how many reversible numbers lay hidden beneath the billion-digit threshold.\n\nDriven by an unyielding determination to unlock the secrets of reversible numbers, Amelia dedicated her every waking hour to the study and exploration of this mathematics enigma. She scoured centuries-old manuscripts, deciphered ancient equations, and consulted renowned mathematicians from around the world.\n\nAs Amelia journeyed deeper into the realm of numbers, she discovered unexpected connections and patterns. The secret lay in the delicate interplay of digits, where the mere rearrangement led to magical transformations. Each reversible number held the key to its reverse, and together they created a symphony of odd digits.\n\nAt long last, the fateful day arrived when Amelia would face the ultimate challenge. With vast knowledge and tireless effort, she pondered how many reversible numbers resided below one billion. The question weighed heavy on her mind as she contemplated its complexity.\n\nWith trembling hands, Amelia sat down at her desk, gazing at the daunting figure of one billion. The enormity of the problem was undeniable, yet her determination burned bright. She knew that the journey was not merely about numbers but about the beauty and mystery they held within.\n\nAnd so, dear reader, I leave you with this question: How many reversible numbers are there below one billion? Like Amelia, let your mind wander through the labyrinth of digits, seeking the answer to this captivating mathematical enigma."}, {"id": 315, "euler_id": 315, "title": "Digital root clocks", "problem": "\nSam and Max are asked to transform two digital clocks into two \"digital root\" clocks.\nA digital root clock is a digital clock that calculates digital roots step by step.\nWhen a clock is fed a number, it will show it and then it will start the calculation, showing all the intermediate values until it gets to the result.\nFor example, if the clock is fed the number 137, it will show: \"137\" \u2192 \"11\" \u2192 \"2\" and then it will go black, waiting for the next number.\nEvery digital number consists of some light segments: three horizontal (top, middle, bottom) and four vertical (top-left, top-right, bottom-left, bottom-right).\nNumber \"1\" is made of vertical top-right and bottom-right, number \"4\" is made by middle horizontal and vertical top-left, top-right and bottom-right. Number \"8\" lights them all.\nThe clocks consume energy only when segments are turned on/off.\nTo turn on a \"2\" will cost 5 transitions, while a \"7\" will cost only 4 transitions.\nSam and Max built two different clocks.\nSam's clock is fed e.g. number 137: the clock shows \"137\", then the panel is turned off, then the next number (\"11\") is turned on, then the panel is turned off again and finally the last number (\"2\") is turned on and, after some time, off.\nFor the example, with number 137, Sam's clock requires:\"137\"\n:\n(2 + 5 + 4) \u00d7 2 = 22 transitions (\"137\" on/off).\n\"11\"\n:\n(2 + 2) \u00d7 2 = 8 transitions (\"11\" on/off).\n\"2\"\n:\n(5) \u00d7 2 = 10 transitions (\"2\" on/off).\n\nFor a grand total of 40 transitions.\n\nMax's clock works differently. Instead of turning off the whole panel, it is smart enough to turn off only those segments that won't be needed for the next number.\nFor number 137, Max's clock requires:\"137\"\n:\n2 + 5 + 4 = 11 transitions (\"137\" on)\n7 transitions (to turn off the segments that are not needed for number \"11\").\n\"11\"\n:\n0 transitions (number \"11\" is already turned on correctly)\n3 transitions (to turn off the first \"1\" and the bottom part of the second \"1\"; \nthe top part is common with number \"2\").\n\"2\"\n:\n4 transitions (to turn on the remaining segments in order to get a \"2\")\n5 transitions (to turn off number \"2\").\n\nFor a grand total of 30 transitions.\n\nOf course, Max's clock consumes less power than Sam's one.\nThe two clocks are fed all the prime numbers between A = 107 and B = 2\u00d7107. \nFind the difference between the total number of transitions needed by Sam's clock and that needed by Max's one.", "solution": "13625242", "difficulty": 20, "story": "Once upon a time in a small town called Mathville, there lived two brothers named Sam and Max. Both brothers were incredibly talented mathematicians and inventors who loved to create unique gadgets. Their latest invention was a pair of digital clocks that could calculate digital roots step by step.\n\nThe clocks were a marvel to behold. Each clock had a series of light segments that could be turned on and off to form different numbers. Sam and Max had spent countless hours designing and building these clocks, infusing them with their love for mathematics.\n\nSam's clock was a fairly straightforward design. When a number was fed into the clock, it would display the number and then start the calculation process, showing each intermediate value until it reached the result. However, it consumed energy every time the segments were turned on or off.\n\nMax, on the other hand, took a slightly different approach. His clock was not only smart enough to display the numbers step by step, but it also had the intelligence to turn off only the segments that would not be needed for the next number. This meant that Max's clock consumed less power than Sam's, making it a more efficient and sustainable choice.\n\nOne day, a group of scientists from a nearby laboratory came to Mathville to see the clocks for themselves. They were amazed by Sam and Max's creations and decided to test them using a unique challenge.\n\nThe scientists wanted the clocks to be fed with all the prime numbers between 107 and 2\u00d7107. The goal was to find the difference between the total number of transitions needed by Sam's clock and that needed by Max's clock.\n\nExcited by the challenge, Sam and Max agreed to participate. They set up their clocks side by side in the town square, where everyone could witness their incredible creations.\n\nAs the challenge began, Sam's clock tirelessly displayed each prime number from 107 to 2\u00d7107, showing all the intermediate values until it reached the digital root. However, the energy consumption of Sam's clock was noticeable, and the segments flickered on and off with each transition.\n\nMax's clock, on the other hand, glowed more steadily. It intelligently turned off segments that were not needed for the next number, conserving energy and reducing the number of transitions required.\n\nAs the days passed by, the townspeople watched in awe as the clocks displayed the digital roots of each prime number. There was an air of anticipation in Mathville as the final prime number was fed into the clocks.\n\nWhen the challenge came to an end, the scientists gathered the data and calculated the difference between the total number of transitions needed by Sam's clock and that needed by Max's clock. The result would indicate which clock was more efficient and sustainable in terms of energy consumption.\n\nHowever, before the scientists could announce the result, a sudden gust of wind swept through Mathville, scattering the calculations and leaving everyone in suspense. As the papers flew through the air, the townspeople wondered, which clock had consumed less power? Which clock had performed more efficiently?\n\nAnd so, the question remained, to be pondered upon by both the townspeople and the readers alike. What was the difference between the total number of transitions needed by Sam's clock and that needed by Max's clock?"}, {"id": 323, "euler_id": 323, "title": "Bitwise-OR operations on random integers", "problem": "Let y0, y1, y2,... be a sequence of random unsigned 32 bit integers\n(i.e. 0 \u2264 yi < 232, every value equally likely).\nFor the sequence xi the following recursion is given:x0 = 0 and\nxi = xi-1| yi-1, for i > 0. ( | is the bitwise-OR operator)\nIt can be seen that eventually there will be an index N such that xi = 232 -1 (a bit-pattern of all ones) for all i \u2265 N.\nFind the expected value of N. \nGive your answer rounded to 10 digits after the decimal point.", "solution": "6.3551758451", "difficulty": 20, "story": "Once upon a time in a quaint little village, there lived a brilliant mathematician named Professor Archimedes. He was known far and wide for his extraordinary mind and his passion for unraveling complex mathematical puzzles. But he was not just any ordinary mathematician; he possessed an uncanny ability to see patterns in the most perplexing problems.\n\nOne lucid morning, as the sun rays gently kissed the ancient library where Archimedes spent most of his days, he stumbled upon an ancient scroll. It was beautifully adorned with intricate illustrations and enigmatic symbols. As he unrolled the ancient parchment, he discovered a mathematical problem that piqued his curiosity.\n\nThe problem itself fascinated him. It involved a sequence of random unsigned 32-bit integers, each equally likely to appear. Intriguingly, this sequence created a recursive pattern that seemed to lead to an ultimate result. Archimedes couldn't help but be captivated by its enigma.\n\nThe problem posed a condition: given a sequence xi, where x0 was defined as 0, and each subsequent term xi could be calculated by performing a bitwise-OR operation with yi-1, how many iterations, or more specifically, when would the value of xi reach a bit-pattern of 32 ones, or 232 - 1?\n\nLost in deep thought, Archimedes realized the potential of this problem. It was more than just a mathematical conundrum; it was a journey waiting to be unraveled. And so, inspired by this newfound quest, he embarked on a quest to weave the mathematical problem into a story, a tale that would captivate not only his own imagination but also the hearts and minds of others.\n\nIn the village, there lived a young orphan named Lily. She was known for her immense curiosity and thirst for knowledge. Although she had never met Archimedes, she had heard tales of his brilliance. Every night, she would gaze up at the stars, wishing she could meet the professor and learn about the secrets of the universe.\n\nOne fateful day, as Lily roamed the village streets, she stumbled upon the library where Archimedes spent his days. Curiosity tugged at her heart, compelling her to enter the ancient structure. As she stepped inside, Lily marveled at the rows upon rows of dusty books, each promising a world of untold wonders.\n\nAs if guided by fate, Lily found herself in the mathematics section of the library. There, she discovered an old book, its pages yellowed with age. It was Archimedes' manuscript, his personal record of the mathematical problem that had long haunted his thoughts.\n\nIntrigued, Lily began reading through the pages. She grew fascinated by the captivating story woven within the problem itself. To her, it was more than just a collection of numbers and symbols; it was an adventure waiting to be discovered, beckoning her to embark on a quest to unveil its secrets.\n\nWith each passing page, Lily's understanding of the problem deepened. She saw the significance of the recursion and the inevitable pattern that emerged. As she delved deeper into the story, she felt as though she was treading upon a mathematical labyrinth, with each turn leading her closer to the expected value of N.\n\nLily's heart raced with excitement. She couldn't tear herself away from the manuscript. The problem consumed her thoughts, dominating her daydreams and haunting her sleep. She yearned to meet Archimedes, to discuss her findings and hear his insights. But little did she know, a meeting with the professor was destined to happen sooner than she could have imagined.\n\nOne morning, as the sun bathed the library in its golden hues, Lily found herself face-to-face with the enigmatic mathematician himself. Archimedes had been drawn to the library by rumors of a young girl who had become entranced by his manuscript.\n\nTheir eyes met, and a spark of recognition passed between them. Archimedes saw in Lily the same passion for discovery that had driven him in his endeavors. A connection was formed\u2014an unspoken understanding.\n\nAnd so, the two embarked on a journey, a journey that would take them deep into the realms of mathematics, to uncover the intricacies of the problem that had fascinated them both. As they sought answers, they saw the beauty in the patterns, unraveled mysteries, and reveled in the joy of discovery.\n\nBut the question remained, seemingly elusive, as their understanding deepened with each passing day. What was the expected value of N? How many iterations would it take for the value of xi to reach 232 - 1? The answer was still a mystery, a mathematical puzzle waiting to be solved.\n\nAnd so, dear reader, as our story nears its end, I pose this question to you: Can you solve the mathematical problem that captivated the hearts and minds of Lily and Archimedes? Can you find the expected value of N, rounded to 10 digits after the decimal point?"}, {"id": 407, "euler_id": 407, "title": "Idempotents", "problem": "\nIf we calculate a2 mod 6 for 0 \u2264 a \u2264 5 we get: 0,1,4,3,4,1.\n\n\nThe largest value of a such that a2 \u2261 a mod 6 is 4.\nLet's call M(n) the largest value of a < n such that a2 \u2261 a (mod n).\nSo M(6) = 4.\n\n\nFind \u2211\u2009M(n) for 1 \u2264 n \u2264 107.\n", "solution": "39782849136421", "difficulty": 20, "story": "Once upon a time, in the village of Arithmos, there lived a young boy named Ethan. With a curious mind and a knack for numbers, Ethan had always been fascinated by the mysteries of mathematics. He spent his days exploring the hidden patterns and secrets that numbers held, eager to solve any mathematical puzzle that came his way.\n\nOne sunny morning, as Ethan sat beneath the ancient oak tree at the heart of the village, he stumbled upon a peculiar scroll. Intrigued, he unfurled it carefully and read the words scrawled across its weathered surface.\n\n\"If we calculate a2 mod 6 for 0 \u2264 a \u2264 5 we get: 0,1,4,3,4,1. The largest value of a such that a2 \u2261 a mod 6 is 4. Let's call M(n) the largest value of a < n such that a2 \u2261 a (mod n). So M(6) = 4. Find \u2211\u2009M(n) for 1 \u2264 n \u2264 107.\"\n\nEthan furrowed his brow, his mind racing to unravel the mystery of this mathematical problem. He pondered over the numbers, the equations, and their possibilities. Little did he know that this puzzle held the key to unlocking a profound discovery.\n\nAs the days turned into weeks and weeks into months, Ethan delved deeper into his quest for answers. He consulted dusty tomes, sought the wisdom of elders, and sought guidance from the greatest mathematical minds in the kingdom. The solution continued to elude him, but he refused to give up.\n\nOne fateful night, as Ethan lay beneath the starry sky, a gentle breeze whispered a familiar tune into his ear. It was the voice of the ancient oak tree, speaking to him in riddles.\n\n\"Ethan, my child, the answers you seek lie within the realms of patterns and recurrence,\" the voice murmured softly. \"Every number holds a secret, and every secret yearns to be revealed. Look closely at the numbers you hold, and you shall find the truth you seek.\"\n\nEthan's eyes widened with realization. He rushed back to his study, filled with newfound determination. He studied the sequence meticulously, examining every relationship between the numbers. And then, like a bolt of lightning, clarity struck him.\n\nThe numbers themselves were letters in disguise, forming words that held the secret to their arrangement. Ethan rearranged the sequence and the numbers transformed into a poignant message:\n\n\"Seek the patterns within the numbers, young scholar. Find the path where a number's square is equal to its identity. Follow the thread of equivalence, and you shall uncover the sum of the largest values.\"\n\nEthan's heart raced with excitement. He knew what he had to do. Armed with newfound understanding, he began his journey once more, crisscrossing the lands in search of ancient texts, forgotten equations, and the whispers of scholars long past.\n\nBut as his quest continued, more questions filled his mind. How could he find M(n) for all n between 1 and 107? Would he be able to spot the patterns and decipher the hidden secrets of the numbers? And most importantly, what implications did this mathematical problem hold for the world as he knew it?\n\nAs Ethan now stands at the precipice of his journey, he looks out into the vast unknown, his mind brimming with curiosity. He ponders the intricacies of those numbers, their enigmatic properties, and the significance they held beyond the realms of his village.\n\nAnd so, dear reader, I pose this question to you: Can you unlock the mystery that lies within the numbers? Can you find \u2211\u2009M(n) for 1 \u2264 n \u2264 107, and perhaps, follow in Ethan's footsteps to illuminate the profound truths that numbers hold?\n\nThe answer, my friend, lies in the unseen dance of patterns and equations. It waits patiently for a curious mind like yours to unravel its secrets. Will you accept the challenge and embark on this mathematical journey of discovery?"}, {"id": 429, "euler_id": 429, "title": "Sum of squares of unitary divisors", "problem": "\nA unitary divisor d of a number n is a divisor of n that has the property gcd(d, n/d) = 1.\nThe unitary divisors of 4! = 24 are 1, 3, 8 and 24.\nThe sum of their squares is 12 + 32 + 82 + 242 = 650.\n\n\nLet S(n) represent the sum of the squares of the unitary divisors of n. Thus S(4!)=650.\n\n\nFind S(100 000 000!) modulo 1 000 000 009.\n", "solution": "98792821", "difficulty": 20, "story": "Once upon a time in the bustling town of Numerica, there lived a talented young mathematician named Emma. Emma was known throughout the town for her unparalleled love and knack for numbers. Numbers were to her what paint was to an artist, or music was to a musician - a medium that enabled her to express herself and make sense of the world.\n\nOne sunny morning, as Emma walked to the town library, she stumbled upon a peculiar ancient scroll lying abandoned on the street. Curiosity overtook her, and she delicately unfurled the scroll, revealing a faded yet elegant mathematical problem.\n\n\"A unitary divisor, hmm?\" Emma pondered, her eyes gleaming with excitement. She quickly scoured her vast mathematical knowledge, flipping through mental databases of algorithms and concepts until she found the information she sought. It seemed that a unitary divisor was a special kind of divisor, one that shared no common factor other than one when paired with its counterpart.\n\nThe story wasn't just about numbers for Emma; it was an opportunity to indulge in the beauty of mathematics. She decided to approach the problem as if it were a whimsical puzzle leading her on a fantastical adventure. The task at hand was to find the sum of the squares of the unitary divisors of a factorial number.\n\nEmma's mind brimmed with excitement as she walked into the library armed with a sense of determination. She traced her fingers over rows upon rows of dusty, old books until she discovered an enchanted tome called \"The Alchemists of Mathematics.\" Its pages were filled with the wisdom of great mathematicians who had come before her, offering secrets hidden in plain sight.\n\nDeep in her mathematical reverie, Emma stumbled upon a fascinating tale, woven within the pages of the ancient book. It chronicled the journey of an unknown mathematician who had discovered an intriguing property of unitary divisors while unraveling the mysteries of factorial numbers.\n\nThe story revealed that these unitary divisors possessed an inherent power, one that could connect the vastness of numbers to the harmony of nature. The mathematician discovered that when these divisors were squared and their sums calculated, profound patterns emerged. These patterns echoed the very essence of the universe, and their revelation could unlock secrets yet undiscovered.\n\nEmma's heart raced as she realized the significance of her find. If she could unravel the mystery of the unitary divisors, she might uncover an undiscovered language of mathematics, one that could connect the tangible and intangible. With a newfound purpose, Emma delved into the sea of numbers, diving deep, unraveling the symphony hidden amidst the chaos.\n\nAs the days turned into weeks, Emma became consumed by her quest to solve the mathematical problem. She tirelessly computed squares, sought patterns, and analyzed the behavior of unitary divisors. She questioned every assumption and delved into the deepest realms of her mathematical prowess.\n\nIn her pursuit of mathematical truth, Emma transitioned from being a mere mathematician to becoming a beacon of inspiration for the citizens of Numerica. People started flocking to her, seeking answers to their own mathematical quandaries. Emma became the living embodiment of the wonders that numbers could unfold.\n\nNow, as Emma's journey draws to a close, she stands before the mirror in her cozy study, the ancient scroll placed carefully beside her. She gazes intently at the reflection of a woman who has unraveled secrets meticulously hidden within numbers. The reflection smiles back at her, eyes shining with curiosity and anticipation.\n\nHer heart pounding, she is almost there. She can feel it - the answer, the key to deciphering the value of `S(100 000 000!) modulo 1 000 000 009`. The last piece of the puzzle is about to reveal itself, like an exquisitely complex equation collapsing into a simple, elegant solution.\n\nBut before Emma can take that final step, before she can lay claim to the ultimate mathematical truth that lies just beyond her fingertips, she pauses. She looks at her reflection once more and asks herself one last question: \"Can you find S(100 000 000!) modulo 1 000 000 009?\"\n\nAnd with that question lingering in the air, the story of Emma, the mathematician of Numerica, awaits an ending only you can provide."}, {"id": 491, "euler_id": 491, "title": "Double pandigital number divisible by 11", "problem": "We call a positive integer double pandigital if it uses all the digits 0 to 9 exactly twice (with no leading zero). For example, 40561817703823564929 is one such number.\nHow many double pandigital numbers are divisible by 11?", "solution": "194505988824000", "difficulty": 20, "story": "Once upon a time in the kingdom of Mathland, there lived a young mathematician named Ethan. Ethan was a lover of numbers, patterns, and all things mathematical. His mind was always buzzing with peculiar puzzles and intriguing problems that he couldn't resist solving.\n\nOne day, Ethan came across an old, dusty book hidden deep within the recesses of the kingdom's great library. The book was titled \"The Mysteries of Double Pandigital Numbers.\" Intrigued, Ethan sat down and started flicking through the book's yellowed pages.\n\nAs he delved deeper into the chapters, Ethan's eyes widened with amazement. He learned that a double pandigital number was a positive integer that used all the digits from zero to nine exactly twice, without any leading zeroes. For instance, 98215743605461372980 was a double pandigital number.\n\nIn his excitement, Ethan stumbled upon a captivating problem within the book that would forever alter his journey. The problem stated, \"How many double pandigital numbers are divisible by 11?\"\n\nThis math problem intrigued Ethan like no other. He yearned to solve it, to uncover the secret behind these extraordinary numbers. He sensed that the answer to this question held the key to unlocking a wealth of knowledge about the mysterious world of double pandigital numbers, leading to groundbreaking discoveries.\n\nEthan embarked on a quest. He scoured the realm, consulting the wise sages, and delving into ancient texts. He sought out fellow mathematicians, hoping to find a clue or whisper of insight. His obsession with the problem consumed him day and night.\n\nMonths turned into years, and still, Ethan remained immersed in his pursuit. The once energetic and lively mathematician began to wear thin, his eyes droopy from countless sleepless nights. Doubt gnawed at him, but he refused to give up.\n\nHis search led him to a remote mountain village, where a wise old sage resided. Known for his extraordinary wisdom, the sage was rumored to have unraveled some of the most enigmatic mathematical problems of the past. Ethan was hopeful that this sage held the key to his final answer.\n\nTrekking up the steep mountain, Ethan reached the sage's humble abode. The sage, sensing Ethan's determination, welcomed him with open arms.\n\n\"You seek answers to the mysteries of double pandigital numbers,\" the sage stated, his wrinkled hands clasped together.\n\n\"Yes,\" Ethan replied, his voice filled with reverence. \"But specifically, I wish to know how many of these numbers are divisible by 11.\"\n\nThe sage's eyes twinkled with wisdom as he looked deep into Ethan's soul. \"Young mathematician, you ask a question that has eluded the greatest minds for centuries. The answer lies within the realms of patterns and divisibility, but such knowledge cannot be given freely. It must be earned.\"\n\nEthan's heart sank. He had come so far, searched so long, and now it seemed the answer would slip through his grasp. \"What must I do to earn this knowledge?\" he asked, his voice trembling.\n\nThe sage smiled, revealing a glimmer of hope. \"Solve the unsolvable. Prove to me that you understand the nature of divisors and the patterns that govern them. Once you have done so, the answer you seek will be revealed.\"\n\nAnd thus, Ethan was faced with his greatest challenge yet. He knew he had the skills to conquer the task, but would he find the answer before it consumed him entirely? Would he be able to overcome this ultimate obstacle and unveil the secret behind the double pandigital numbers divisible by 11?\n\nAs you, dear reader, follow in Ethan's footsteps, I pose the same question to you. Can you solve the mathematical problem that has plagued Ethan's journey? How many double pandigital numbers are divisible by 11?"}, {"id": 516, "euler_id": 516, "title": "5-smooth totients", "problem": "\n5-smooth numbers are numbers whose largest prime factor doesn't exceed 5.\n5-smooth numbers are also called Hamming numbers.\nLet S(L) be the sum of the numbers n not exceeding L such that Euler's totient function \u03c6(n) is a Hamming number.\nS(100)=3728.\n\n\nFind S(1012). Give your answer modulo 232.\n", "solution": "939087315", "difficulty": 20, "story": "Once upon a time, in the charming kingdom of Mathland, lived a young and curious mathematician named Emma. Emma was a brilliant problem solver who loved nothing more than the thrill of unraveling the mysteries of numbers. One sunny morning, while sipping her tea and pondering over a series of mathematical puzzles, she came across an intriguing problem.\n\nThe problem read, \"5-smooth numbers are numbers whose largest prime factor doesn't exceed 5. 5-smooth numbers are also called Hamming numbers. Let S(L) be the sum of the numbers n not exceeding L such that Euler's totient function \u03c6(n) is a Hamming number. S(100)=3728. Find S(1012). Give your answer modulo 232.\"\n\nEmma was instantly fascinated by this enigmatic mathematical quest. She knew that solving it would require her to delve deep into the world of Hamming numbers and the concept of Euler's totient function. Unable to resist the allure of the problem, Emma set off on a mathematical adventure.\n\nAs Emma embarked on her journey, she discovered that Hamming numbers were of great importance in various applications. They lay at the heart of efficient signal processing algorithms and played a crucial role in the field of computer science. Emma felt a surge of excitement as she realized that her quest might have far-reaching implications.\n\nAlong her journey, Emma met a wise old mathematician named Professor Euler. Professor Euler had dedicated his life to understanding the complexities of numbers. Emma shared her problem with him, and with a warm smile, Professor Euler handed her a worn-out journal with countless equations and theorems scribbled on its pages.\n\n\"Emma,\" he said, \"you are about to unlock the secrets of numbers that even I have not yet fully grasped. Euler's totient function is a fascinating concept that relates to the counting of numbers coprime to a given number n. You'll find that understanding this function will lead you closer to your answer.\"\n\nEmma studied Professor Euler's notes with great care, learning about prime factors, coprime numbers, and the intricate dance between them. The more she delved into the mathematics, the more the pieces of the puzzle fell into place. Slowly but surely, Emma began to see the patterns and connections that would help her find the elusive S(1012).\n\nAs the days turned into weeks, Emma tirelessly worked on her calculations, making sense of the vast array of numbers and equations. She realized that S(1012) was a daunting task, but she was determined to solve it.\n\nIn her pursuit of the answer, Emma faced countless obstacles and moments of doubt. But just when she thought she had reached her limits, she'd uncover another clue, pushing her forward. The excitement of discovery fueled her determination, propelling her towards the next breakthrough.\n\nFinally, after months of intense work and sleepless nights, Emma found herself on the brink of a solution. She had unraveled the mysteries of S(1012) and was ready to reveal her findings to the world.\n\nBut as she stood on the precipice of solving the problem, a new thought crossed her mind. What if she let others embark on the journey of discovery as well? Emma knew that the joy of unraveling a mathematical puzzle was as much in the process as it was in the final result. And so, instead of revealing her solution, she chose to pose the question to others, to spark their curiosity and ignite their passion for the infinite world of numbers.\n\nSo, dear reader, the question is now posed to you: Will you take up the challenge and find S(1012)? Can you unlock the secrets of Euler's totient function and the Hamming numbers that lie within? As Emma once did, will you venture into the realm of numbers, ready to explore, solve, and seek the truth?\n\nThe answer awaits, ready to be discovered by the next brave mathematician who dares to embark on this exciting adventure."}, {"id": 518, "euler_id": 518, "title": "Prime triples and geometric sequences", "problem": "Let S(n) = \u03a3 a+b+c over all triples (a,b,c) such that:\na, b, and c are prime numbers.\na < b < c < n.\na+1, b+1, and c+1 form a geometric sequence.\nFor example, S(100) = 1035 with the following triples: \n(2, 5, 11), (2, 11, 47), (5, 11, 23), (5, 17, 53), (7, 11, 17), (7, 23, 71), (11, 23, 47), (17, 23, 31), (17, 41, 97), (31, 47, 71), (71, 83, 97)\nFind S(108).", "solution": "100315739184392", "difficulty": 20, "story": "Once upon a time in the enchanting land of Numeria, three young friends named Axel, Beth, and Cole spent their days exploring the mystical forests and studying the arcane arts of mathematics. They were known amongst the villagers for their intelligence and their knack for solving complex mathematical problems.\n\nOne sunny morning, as they sat by the cool, babbling brook, Beth stumbled upon an ancient scroll tucked away inside a hollowed tree trunk. Eagerly, they unfurled the scroll and read the inscription aloud, \"Let S(n) = \u03a3 a+b+c over all triples (a,b,c) such that...\". The friends exchanged bewildered glances but continued to read, captivated by the magical problem that lay before them.\n\nAs they immersed themselves in deciphering the problem, the world around them seemed to grow hazy. In their shared trance, the friends entered a vivid dreamscape, transported to the heart of Numeria itself. They found themselves standing at the entrance of the Great Library, a towering structure with walls lined from floor to ceiling with innumerable books of knowledge.\n\nThe wise Librarian, Professor Edmond, emerged from the shadows and greeted Axel, Beth, and Cole with a smile. \"Ah, young mathematicians,\" he said, his voice filled with warmth. \"I have been expecting you. The problem you hold in your hands is of utmost importance. It is said that its solution holds the key to unlock the ancient treasure hidden beyond these walls.\"\n\nCurious, Axel asked the professor about the significance of the problem. With a gleam in his eyes, Professor Edmond began to explain. \"S(n) represents the sum of three prime numbers, a, b, and c. However, not just any prime numbers. They must satisfy specific conditions. Firstly, they must be in ascending order, and secondly, when one is added to each of them, it forms a geometric sequence.\"\n\nAxel, Beth, and Cole hung on to every word, realizing the immense importance of the task at hand. If they were to solve this mathematical enigma, they would unlock the door to wonders untold.\n\nWith newfound determination, the adventurers spent days and nights engrossed in their research, pouring over ancient texts and consulting the wise villagers of Numeria. They discovered that the mathematical problem was intricately connected to the very fabric of Numeria's existence.\n\nIn their journey of unraveling the secrets of this problem, the trio formed unbreakable bonds with the residents of Numeria. They met a kind old woman, who shared stories passed down through generations, hinting at the wise forest spirits' ancient knowledge. They encountered a mischievous gnome who reveled in puzzles and riddles, testing their wits at every fascinating turn. And they crossed paths with a stoic knight, who entrusted them with the responsibility of using their mathematical prowess to bring harmony to Numeria's numbers and protect its magical essence.\n\nAs their understanding of the problem grew, so did the longing to find the elusive solution. The deeper they delved, the more they comprehended its significance in Numeria's magical tapestry. Yet, they were only able to uncover fragments of the solution, like pieces of a celestial puzzle scattered across the vastness of Numeria.\n\nUltimately, the time came for Axel, Beth, and Cole to bid farewell to Numeria, departing from the Great Library with their minds brimming with newfound wisdom. They returned to the mortal realm, bearing the immense responsibility of solving S(108) and revealing the ultimate secret.\n\nNow, dear reader, we pose this question to you: Can you solve S(108)? Can you unravel the mystery of these prime numbers and their intricate relationship that lies hidden within the enchantments of Numeria? The fate of this mystical land rests in your hands."}, {"id": 577, "euler_id": 577, "title": "Counting hexagons", "problem": "An equilateral triangle with integer side length n\u22653 is divided into n2 equilateral triangles with side length 1 as shown in the diagram below.\nThe vertices of these triangles constitute a triangular lattice with (n+1)(n+2)2 lattice points.\nLet H(n) be the number of all regular hexagons that can be found by connecting 6 of these points.\n\n\n\nFor example, H(3)=1, H(6)=12 and H(20)=966.\nFind \u2211n=312345H(n).", "solution": "265695031399260211", "difficulty": 20, "story": "Once upon a time in the vibrant city of Numeria, there lived a young mathematician named Leo. Leo had always been fascinated by numbers and patterns, spending endless hours engrossed in solving complex mathematical problems. His favorite spot was the public library, a grand building adorned with towering bookshelves filled with knowledge from all corners of the world.\n\nOn one particularly sunny afternoon, Leo found himself perusing a tome titled \"The Mysteries of Geometry.\" As he skimmed the pages, his gaze fell upon a fascinating problem\u2014a puzzle involving equilateral triangles and hexagons. Intrigued, Leo delved deeper, eager to solve the enigma.\n\nAccording to the book, an equilateral triangle with a side length of 'n,' where 'n' is an integer greater than or equal to 3, could be divided into 'n\u00b2' equilateral triangles, each with a side length of 1. These smaller triangles formed a triangular lattice, with (n+1)(n+2)\u00b2 lattice points. Leo's heart quickened as he imagined the intricate patterns that could be created.\n\nThe mathematician's eyes sparkled with excitement as he discovered the crux of the problem. The book proposed that by connecting six lattice points, one could form regular hexagons within the triangular lattice. Leo could hardly contain his excitement. To explore this idea further, the book came with a challenge\u2014to find the number of regular hexagons, denoted as 'H(n),' that could be formed for various values of 'n.'\n\nLeo had always been one to rise to a challenge. He immediately set his mind to solving the problem in front of him. With pen and paper in hand, he eagerly began making calculations, losing himself in the beauty of numbers.\n\nDays turned into weeks, and weeks into months, but Leo's determination only grew stronger. He scoured countless ancient texts and consulted esteemed mathematicians from around the world. And little by little, he started to unravel the mystery.\n\nSlowly but surely, the narrative of Leo's life became woven with the problem he was striving to solve. The people of Numeria began to recognize his dedication, and news of his pursuit spread far and wide. Even the city's ruler took notice, captivated by Leo's unwavering devotion to unraveling the secret within the hexagonal lattice.\n\nOne fateful evening, Leo found himself staring out of his window, eyes lost in the flickering stars above. He wondered how many secrets the universe held, and if the answer to his problem lay somewhere beyond the realm of numbers. As he pondered, a question emerged from the depths of his being\u2014an inquiry that would challenge his intellect and fuel his passion.\n\nThe question Leo would leave behind for the reader was this: Could you find '\u03a3n=312345H(n)'? Could you discover the sum of 'H(n)' for all values of 'n' from 3 to 312,345? With your own mathematical prowess, could you master the elegant dance of numbers and shape that had consumed his existence?\n\nAs Leo rendered the question in his mind, he realized that the answer lay not only in sheer knowledge but in tenacity, imagination, and a burning desire to explore the depths of what the mind can perceive.\n\nAnd so, dear reader, the tale of Leo and his quest retires to the annals of history, waiting for a curious soul like yours to take up the mantle, solve the mathematical puzzle, and unlock the enchantment woven within the hexagonal lattice. Will you be the one to find the sum and complete this mesmerizing journey?"}, {"id": 587, "euler_id": 587, "title": "Concave triangle", "problem": "\nA square is drawn around a circle as shown in the diagram below on the left.\nWe shall call the blue shaded region the L-section.\nA line is drawn from the bottom left of the square to the top right as shown in the diagram on the right.\nWe shall call the orange shaded region a concave triangle.\n\n\n\n\nIt should be clear that the concave triangle occupies exactly half of the L-section.\n\n\n\nTwo circles are placed next to each other horizontally, a rectangle is drawn around both circles, and a line is drawn from the bottom left to the top right as shown in the diagram below.\n\n\n\n\nThis time the concave triangle occupies approximately 36.46% of the L-section.\n\n\nIf n circles are placed next to each other horizontally, a rectangle is drawn around the n circles, and a line is drawn from the bottom left to the top right, then it can be shown that the least value of n for which the concave triangle occupies less than 10% of the L-section is n\u00a0=\u00a015.\n\n\nWhat is the least value of n for which the concave triangle occupies less than 0.1% of the L-section?\n", "solution": "2240", "difficulty": 20, "story": "Once upon a time, in an ancient village nestled deep within the enchanted forest, there lived a young and curious girl named Luna. Luna had a passion for numbers and patterns and spent most of her days exploring the mysteries of math. One sunny morning, as she strolled through the village square, she noticed a group of villagers gathered around a peculiar drawing.\n\nIntrigued by their fascination, Luna joined the crowd and peered over their shoulders. At the center of the drawing was a perfect circle, and around it, a square had been sketched. The artist had highlighted a section of the square with a gentle shade of blue, and to its side, an orange concave triangle.\n\nAs Luna examined the drawing, she overheard whispers of excitement and marvel at the relationship between the concave triangle and the L-section. Realizing that the mysterious diagram contained a mathematical secret waiting to be revealed, Luna's curiosity soared. She longed to understand the significance of such a geometric connection.\n\nDriven by her inquisitive nature, Luna embarked on a quest to unravel the magic behind the drawing. She sought the wisdom of the village elders and read ancient books in dusty libraries, searching for any remnants of knowledge that could shed light on the enigmatic diagrams.\n\nAfter months of tireless exploration, Luna discovered that the relationship between the concave triangle and the L-section was no mere coincidence. In fact, by placing two circles next to each other horizontally and encasing them within a rectangle, the size of the concave triangle changed. Fascinated, she began experimenting with different circle configurations, drawing more rectangles and lines from the bottom left to the top right.\n\nThe young mathematician's excitement grew with every discovery. She amassed a collection of drawings, carefully noting down the percentage of the L-section occupied by the concave triangle for each configuration. Luna noticed a pattern emerging: as the number of circles increased, the size of the concave triangle decreased. The less space the concave triangle occupied, the more fascinated she became.\n\nDriven by her insatiable hunger for knowledge, Luna resolved to find the smallest number of circles that would cause the concave triangle to occupy less than 0.1% of the L-section. She spent days and nights immersed in calculations and drawings, her mind ablaze with the thrilling anticipation of uncovering the answer.\n\nFinally, as the full moon rose above the forest, Luna gasped in awe. She had found the solution. After countless hours of determination and perseverance, she discovered that the least value of n, the number of circles, for the concave triangle to occupy less than 0.1% of the L-section was n = 62.\n\nWith a heart brimming with satisfaction, Luna knew that she had unlocked the secret of the drawing's mathematical magic. But now, her mind turned to another question, just as captivating, awaiting an answer. If n = 62, what would be the least value of n for the concave triangle to occupy less than 0.01% of the L-section?"}, {"id": 601, "euler_id": 601, "title": "Divisibility streaks", "problem": "\nFor every positive number n we define the function  streak(n)=k   as the smallest positive integer k such that n+k is not divisible by k+1.\nE.g:\n13 is divisible by 1 \n14 is divisible by 2 \n15 is divisible by 3 \n16 is divisible by 4 \n17 is NOT divisible by 5 \nSo streak(13)=4.  \nSimilarly:\n120 is divisible by 1 \n121 is NOT divisible by 2 \nSo streak(120)=1.\n\n\nDefine P(s,N) to be the number of integers n, 1<n<N, for which streak(n)=s.\nSo P(3,14)=1 and P(6,106)=14286.\n\n\nFind the sum, as i ranges from 1 to 31, of P(i,4i).\n", "solution": "1617243", "difficulty": 20, "story": "Once upon a time, in the quaint village of Numeria, there lived a young mathematician named Emilia. She had an insatiable curiosity for numbers and problem-solving, which often led her on exciting adventures. On this particular day, Emilia stumbled upon an old, dusty book in the village library. Its worn pages were filled with intriguing mathematical problems waiting to be unraveled.\n\nAs she flipped through the pages, Emilia's eyes caught sight of a mathematical problem that piqued her interest. It was called the \"Streak Function.\"\n\nIntrigued, Emilia read through the problem. She learned that the Streak Function, denoted as \"streak(n) = k,\" calculates the smallest positive integer 'k' such that 'n + k' is not divisible by 'k + 1.' It was an intricate puzzle that embodied the very essence of her mathematical passion.\n\nEmilia's heart raced with excitement. She knew she needed to explore the Streak Function further and find its applications. She spent days and nights, pencil in hand, testing numbers and studying their corresponding streak values. She discovered that the function could be used to analyze patterns and find unique properties in consecutive integers.\n\nDetermined to delve deeper into the mystery of the Streak Function, Emilia decided to embark on a journey. Equipped with her trusty notebook and filled with enthusiasm, she set off to seek the wisdom of the wise mathematician, Professor Arithmos.\n\nAfter a long and arduous journey through treacherous terrain and dense forests, Emilia finally reached the remote hut where Professor Arithmos resided. The wise old professor welcomed her with a warm smile and listened intently as she shared her newfound fascination with the Streak Function.\n\nWith a gentle nod, Professor Arithmos shared tales of the function's history. He spoke of the brilliant mathematician, Eliza, who had first deciphered its secrets centuries before. Eliza believed that the Streak Function had numerous applications beyond its initial mathematical puzzle\u2014applications that were waiting to be unveiled by someone like Emilia.\n\nThe professor explained to Emilia how the Streak Function could help predict patterns in various real-life situations, such as stock market trends, population growth, and even weather patterns. Emilia was captivated as she realized the immense value of this mathematical concept.\n\nDays turned into weeks, and weeks turned into months, as Emilia and Professor Arithmos dived deeper into the Streak Function. They tirelessly analyzed data, developed equations, and shared their discoveries with fellow mathematicians around the world. Gradually, the Streak Function gained recognition as a powerful tool in understanding randomness and predicting outcomes.\n\nBuoyed by their success, Emilia and Professor Arithmos tackled the final question that had been posed upon them in the old book. They were tasked with finding the sum, as 'i' ranged from 1 to 31, of 'P(i, 4i).' It was a daunting challenge, but Emilia was determined to find the answer.\n\nAnd so, dear reader, I leave you with this question: Can you solve the mathematical problem that Emilia and Professor Arithmos dedicated their lives to? Can you find the sum they sought, adding up 'P(i, 4i)' as 'i' ranges from 1 to 31?\n\nAs you ponder the question, remember Emilia's spirit of exploration and how she followed her passion for numbers to unearth hidden treasures. Perhaps in solving this mathematical conundrum, you too will discover new horizons and fuel your own curiosity for the mysteries that lie within the realm of mathematics.\n\nHappy problem-solving!"}, {"id": 607, "euler_id": 607, "title": "Marsh Crossing", "problem": "\nFrodo and Sam need to travel 100 leagues due East from point A to point B. On normal terrain, they can cover 10 leagues per day, and so the journey would take 10 days. However, their path is crossed by a long marsh which runs exactly South-West to North-East, and walking through the marsh will slow them down. The marsh is 50 leagues wide at all points, and the mid-point of AB is located in the middle of the marsh. A map of the region is shown in the diagram below:\n\n\n\n\nThe marsh consists of 5 distinct regions, each 10 leagues across, as shown by the shading in the map. The strip closest to point A is relatively light marsh, and can be crossed at a speed of 9 leagues per day. However, each strip becomes progressively harder to navigate, the speeds going down to 8, 7, 6 and finally 5 leagues per day for the final region of marsh, before it ends and the terrain becomes easier again, with the speed going back to 10 leagues per day.\n\n\nIf Frodo and Sam were to head directly East for point B, they would travel exactly 100 leagues, and the journey would take approximately 13.4738 days. However, this time can be shortened if they deviate from the direct path.\n\n\nFind the shortest possible time required to travel from point A to B, and give your answer in days, rounded to 10 decimal places.\n", "solution": "13.1265108586", "difficulty": 20, "story": "Once upon a time, in a quaint village nestled between rolling hills, there lived two good friends named Frodo and Sam. They were known throughout the village for their courage, loyalty, and unwavering spirit. And it was on one fine day that a challenge befell them, a challenge that would test their mettle and their understanding of mathematics.\n\nFrodo and Sam had received a message from a distant land, inviting them to a great celebration in honor of their heroic deeds. The celebration was to be held in a beautiful city called Rivendell, situated a hundred leagues to the east from their humble abode. Eager to embrace this new adventure, the two friends set forth on their journey.\n\nThe sun was shining brightly as Frodo and Sam left their village early in the morning. They walked with a brisk pace, hoping to reach their destination as quickly as possible. They knew that on normal terrain, they could cover 10 leagues per day, and the journey would only take them ten days.\n\nHowever, as fate would have it, their path was blocked by a treacherous marsh that spanned the entire width of their journey. The marsh stretched from the southwest to the northeast, dividing their route into two halves. It was as if nature itself had conspired against them.\n\nThe marsh was unlike anything Frodo and Sam had ever encountered. It was a daunting landscape, with murky waters and treacherous grounds. They knew that walking through it would significantly slow them down. But how much time would it cost them?\n\nBoth Frodo and Sam were as resourceful as they were brave. They immediately devised a plan to navigate the marsh as efficiently as possible. They studied the map, and with the mathematical acumen they possessed, they calculated the time it would take to cross each distinct region of the marsh.\n\nThe strip closest to point A was relatively light marsh, and they determined that they could cross it at a speed of 9 leagues per day. The next region was slightly more challenging, with a speed of 8 leagues per day. The marsh continued to grow in difficulty, with speeds of 7, 6, and finally 5 leagues per day for the final region of the marsh.\n\nFrodo and Sam realized that by deviating from the direct path from point A to B, they could potentially decrease their overall travel time. They could traverse through the marsh, calculating which regions would cost them less time to cross. And by doing so, they hoped to reach Rivendell in the shortest possible time.\n\nThe two friends embarked on their journey, traversing through the marsh with determination and a deep understanding of mathematics. They carefully measured the time it took to cross each region, comparing it to the time it would take them to travel the same distance on normal terrain.\n\nAs they ventured deeper into the marsh, Frodo and Sam were faced with various challenges. The murky waters tested their endurance, the unstable ground tested their balance, and the dense undergrowth tested their resilience. But they pressed on, their minds focused on deciphering the optimal path to Rivendell.\n\nAnd now, dear reader, it is up to you to contemplate the shortest possible time required for Frodo and Sam to reach Rivendell. Can you solve this mathematical puzzle, and help them find their way through the marsh? Will they make it to the celebration in time? The answer lies within the calculations, the distances, and the determination of our brave friends.\n\nSo I ask you, can you find the shortest possible time required to travel from point A to B? Can you, dear reader, give your answer in days, rounded to 10 decimal places? The fate of Frodo and Sam's journey awaits your mathematical prowess."}, {"id": 609, "euler_id": 609, "title": "\u03c0 sequences", "problem": "\nFor every n\u22651 the prime-counting function \u03c0(n) is equal to the number of primes\nnot exceeding n.\nE.g. \u03c0(6)=3 and \u03c0(100)=25.\n\n\nWe say that a sequence of integers u=(u0,\u22ef,um) is a \u03c0 sequence if \n un\u22651 for every n\n un+1=\u03c0(un)\n u has two or more elements\n\nFor u0=10 there are three distinct \u03c0 sequences: (10,4),  (10,4,2) and (10,4,2,1).\n\n\nLet  c(u) be the number of elements of u that are not prime.\nLet p(n,k) be the number of \u03c0 sequences u  for which u0\u2264n and c(u)=k.\nLet P(n) be the product of all p(n,k) that are larger than 0.\nYou are given: P(10)=3\u00d78\u00d79\u00d73=648 and P(100)=31038676032.\n\n\nFind P(108). Give your answer modulo 1000000007. \n", "solution": "172023848", "difficulty": 20, "story": "Once upon a time, in the quaint town of Numerville, there lived a brilliant mathematician named Professor Morgan. He had dedicated his life to unraveling the mysteries of numbers, and his mind was constantly filled with intricate equations and fascinating mathematical problems.\n\nOne day, as Professor Morgan was strolling through the town square, he noticed a small group of children gathered around a man who called himself the \"Mathematical Enchanter.\" Intrigued, the professor joined the crowd to see what was happening.\n\nThe Mathematical Enchanter, a charismatic figure with a twinkle in his eye, was displaying a magical box. \"Ladies and gentlemen, in this enchanted box lies the answer to one of the most perplexing mathematical problems of all time,\" he announced dramatically. \"It is called the prime-counting function \u03c0(n), and I possess the key to unlocking its secrets.\"\n\nProfessor Morgan's interest was piqued. He had spent years studying prime numbers and their distribution, and the prime-counting function had always fascinated him. \"Tell us more, oh wise Mathematical Enchanter,\" the professor urged.\n\nThe enchanter smiled, seemingly delighted by the professor's enthusiasm. \"For every n\u22651,\" he explained, \"the prime-counting function \u03c0(n) equates to the number of primes not exceeding n. For example, \u03c0(6) equals 3, and \u03c0(100) equals 25.\"\n\nThe crowd murmured in awe, their curiosity increasing with each passing moment. Professor Morgan's eyes gleamed with excitement. This was a mathematical puzzle he yearned to solve.\n\nSuddenly, the enchanter continued, grabbing everyone's attention once again. \"But that's not all! I present to you the concept of \u03c0 sequences. A sequence of integers u=(u0,\u22ef,um) is considered a \u03c0 sequence if each term in the sequence is greater than or equal to 1, and the next term in the sequence is obtained by applying the prime-counting function to the previous term. The sequence must have at least two elements.\"\n\nAt this point, Professor Morgan was fully captivated by the enchanter's words. It was as though he had stumbled upon a hidden treasure trove of mathematical delights. \"Tell us more about these \u03c0 sequences,\" he implored, unable to contain his excitement.\n\nThe enchanter grinned, his eyes sparkling with mischief. \"There's still more,\" he continued. \"We define a function, c(u), as the number of elements in the sequence u that are not prime. Furthermore, we introduce p(n,k), which represents the number of \u03c0 sequences u for which the first element, u0, is less than or equal to n, and the number of non-prime elements in the sequence, c(u), is equal to k.\"\n\nProfessor Morgan's mind was racing, trying to comprehend the magnitude of what he had just heard. He knew that he had stumbled upon an incredible mathematical puzzle that held the key to unlocking a world of infinite possibilities.\n\n\"And finally,\" the enchanter concluded, \"let P(n) be the product of all p(n,k) that are larger than 0. For instance, P(10) equals 3 times 8 times 9 times 3, which equals 648. Can any of you find P(108) for me?\"\n\nThe crowd was filled with a mix of astonishment and confusion. The enchanter had challenged them with a task that seemed daunting, yet undeniably captivating.\n\nAs Professor Morgan stood at the back of the crowd, his mind buzzing with excitement, he knew that this was an opportunity to delve into the very depths of mathematics and discover its hidden secrets. Now, dear reader, the question is posed to you: Can you solve the enchanter's challenge? What is P(108)? The professor eagerly awaits your answer."}, {"id": 613, "euler_id": 613, "title": "Pythagorean Ant", "problem": "Dave is doing his homework on the balcony and, preparing a presentation about Pythagorean triangles, has just cut out a triangle with side lengths 30cm, 40cm and 50cm from some cardboard, when a gust of wind blows the triangle down into the garden.\nAnother gust blows a small ant straight onto this triangle. The poor ant is completely disoriented and starts to crawl straight ahead in random direction in order to get back into the grass.\nAssuming that all possible positions of the ant within the triangle and all possible directions of moving on are equiprobable, what is the probability that the ant leaves the triangle along its longest side?\nGive your answer rounded to 10 digits after the decimal point.", "solution": "0.3916721504", "difficulty": 20, "story": "Once upon a time, in the peaceful suburb of Willowdale, Dave found himself caught between the rhythmic tapping of raindrops against his window and the alluring concepts of Pythagorean triangles in his math textbook. With a sigh of resignation, he gathered his books and headed out to the sanctuary of the balcony, where he could immerse himself in both the tranquility of rain and the complexities of numbers.\n\nDave meticulously cut out a triangle from a piece of cardboard, its sides measuring 30cm, 40cm, and 50cm. As he admired the geometric beauty, a stray gust of wind slapped his creation, sending it twirling and tumbling through the air. In a cruel twist of fate, the triangle landed somewhere in the vast expanse of his garden.\n\nJust as Dave was contemplating retrieving his fallen triangle, he noticed something peculiar. A small ant, caught in the whirlwind of fate, had been deposited directly onto the triangle. It frantically looked around, discombobulated by its newfound surroundings. Dave watched, intrigued, as the ant began to crawl straight ahead, in no particular direction.\n\nUnbeknownst to the tiny trespasser, its every move was imbued with mathematical significance. Every step it took and every angle it turned would determine the probability of its escape. Dave knew this, for he was well-versed in the enigma known as probability.\n\nAs the ant navigated the cardboard labyrinth, Dave observed its journey. The ant's movements seemed random, yet Dave's mathematical knowledge reminded him that nothing in the world of numbers was truly without reason. Each turn the ant made, and every path it traversed within the triangle, had consequences that lay at the intersection of chance and destiny.\n\nDave pondered the ant's predicament. What were the odds that the desperate insect would find its way out of the triangle? More specifically, what was the probability of it leaving along the triangle's longest side? With bated breath and an eagerness to uncover the answer, Dave focused his mathematical abilities on this intricate problem.\n\nBut as he delved deeper into the realm of probability, a thought arose within him. Could it be possible that the answer to this perplexing question was not only significant in aiding the ant's escape but also held a deeper meaning for Dave himself? Could the answer guide him on a path that led to his own liberation?\n\nAnd so, I leave you with this question: What is the probability that the ant leaves the triangle along its longest side? As you ponder this mathematical puzzle, consider the hidden connections it may hold for both the ant and Dave. Will they find solace in the labyrinthine nature of numbers, or will their destiny be carried away by the whimsical gusts of chance?"}, {"id": 618, "euler_id": 618, "title": "Numbers with a given prime factor sum", "problem": "Consider the numbers 15, 16 and 18:\n15=3\u00d75 and 3+5=8.\n16=2\u00d72\u00d72\u00d72 and 2+2+2+2=8.\n18=2\u00d73\u00d73 and 2+3+3=8. \n\n15, 16 and 18 are the only numbers that have 8 as sum of the prime factors (counted with multiplicity).\n\nWe define S(k) to be the sum of all numbers n where the sum of the prime factors (with multiplicity)  of n is k.\nHence S(8)=15+16+18=49.\nOther examples: S(1)=0, S(2)=2, S(3)=3, S(5)=5+6=11.\n\nThe Fibonacci sequence is F1=1,F2=1,F3=2,F4=3,F5=5, ....\nFind the last nine digits of \u2211k=224S(Fk).", "solution": "634212216", "difficulty": 20, "story": "Once upon a time, in a small village nestled deep within a lush forest, there resided a young girl named Lily. Lily was known for her boundless curiosity and insatiable appetite for adventure. Her favorite pastime was exploring the mysterious woods that surrounded her village, eagerly seeking out hidden treasures and secrets waiting to be discovered.\n\nOne sunny afternoon, while venturing deeper into the forest than ever before, Lily stumbled upon an unusual clearing. In the center stood an ancient oak tree, its branches reaching towards the sky as if trying to touch the heavens themselves. Intrigued, Lily approached the tree and noticed a small, weathered plaque hanging from one of its branches.\n\nWith wide eyes, Lily read aloud the inscription on the plaque:\n\n\"Consider the numbers 15, 16, and 18:\n15=3\u00d75 and 3+5=8.\n16=2\u00d72\u00d72\u00d72 and 2+2+2+2=8.\n18=2\u00d73\u00d73 and 2+3+3=8.\n\n15, 16, and 18 are the only numbers that have 8 as the sum of the prime factors (counted with multiplicity).\n\nWe define S(k) to be the sum of all numbers n where the sum of the prime factors (with multiplicity) of n is k.\nHence S(8)=15+16+18=49.\nOther examples: S(1)=0, S(2)=2, S(3)=3, S(5)=5+6=11.\n\nThe Fibonacci sequence is F1=1, F2=1, F3=2, F4=3, F5=5,....\nFind the last nine digits of \u2211k=224S(Fk).\"\n\nLily's mind raced with excitement, her curiosity fueled by this enigmatic mathematical problem. She knew she must find the solution, for it held the key to something extraordinary. With a determined expression, she quickly memorized the problem and continued exploring the forest, her thoughts consumed by the mysterious equation.\n\nDays turned into weeks, and weeks into months, but Lily could not shake off the mathematical puzzle. Every night, she would lie awake, pondering over the number sequences, the prime factors, and the elusive sum she desperately sought. The villagers would observe her lost in thought, scribbling mathematical notations on scraps of paper, with a glimmer of hope in her eyes.\n\nOne fateful evening, as Lily sat beneath the ancient oak tree, deep in contemplation, a gentle breeze rustled the leaves above her. She looked up and noticed something she hadn't before\u2014an unusual pattern in the branches above her. It dawned on her that the branches, like the Fibonacci sequence, spiraled in a mesmerizing pattern.\n\nSuddenly, it all clicked. The Fibonacci sequence itself was the key to solving the mathematical problem! Each Fibonacci number represented the sum of the prime factors of a particular number. Lily's heart raced with anticipation. She could almost taste the triumph of uncovering the last nine digits of \u2211k=224S(Fk).\n\nShe rushed back to her village, returning to her small hut filled with stacks of old books and research papers. Night after night, she poured over the formulas, crunching numbers with an unwavering determination. Each calculation brought her closer to the solution, feeding her excitement.\n\nWeeks turned into months, and Lily grew weary. Her once sparkling eyes began to dull, her hands trembling with fatigue. Doubt crept into her mind as she encountered mathematical roadblocks and endless possibilities. It seemed as though the answer would forever elude her.\n\nYet, amidst her struggle, a spark of inspiration ignited within Lily. She remembered her adventurous spirit, the joy she felt when exploring the unknown. With renewed vigor, she pressed on, determined to uncover the truth. Holding the weight of the mathematical problem on her shoulders, she dared not give up.\n\nAnd so, dear reader, the question now falls to you. Can you solve the enigma that has consumed Lily's every waking thought?\n\n"}, {"id": 630, "euler_id": 630, "title": "Crossed lines", "problem": "\nGiven a set, L, of unique lines, let M(L) be the number of lines in the set and let S(L) be the sum over every line of the number of times that line is crossed by another line in the set.  For example, two sets of three lines are shown below:\n\n\n\nIn both cases M(L) is 3 and S(L) is 6: each of the three lines is crossed by two other lines.  Note that even if the lines cross at a single point, all of the separate crossings of lines are counted.\n\n\nConsider points (T2k\u22121,\u2009T2k), for integer k\u2009>=1, generated in the following way:\n\n\nS0=290797\nSn+1=Sn2mod50515093\nTn=(\u2009Snmod2000\u2009)\u22121000\n\n\nFor example, the first three points are: (527,\u2009144), (\u2212488,\u2009732), (\u2212454,\u2009\u2212947).  Given the first n points generated in this manner, let Ln be the set of unique lines that can be formed by joining each point with every other point, the lines being extended indefinitely in both directions.  We can then define M(Ln) and S(Ln) as described above.\n\n\nFor example, M(L3)=3 and S(L3)=6.  Also M(L100)=4948 and S(L100)=24477690.\n\nFind S(L2500).\n", "solution": "9669182880384", "difficulty": 20, "story": "Once upon a time, in the quaint town of Arithmia, there lived a young and curious mathematician named Alice. Alice had always been fascinated by numbers and patterns, spending her days immersed in formulas and equations. She would often walk through the streets, her mind lost in the world of endearing puzzles and intriguing problems.\n\nOne sunny morning, as Alice was strolling along her favorite path, she stumbled upon an ancient notebook hidden beneath a pile of fallen leaves. Curiosity got the better of her, and she picked it up, carefully dusting off the dirt that had settled on its worn cover. As she opened it, she discovered a handwritten note that piqued her interest.\n\nThe note described a mathematical problem involving a set of unique lines, intersections, and a sequence of generated points. Alice couldn't help but be captivated by the problem. The more she read, the more determined she became to unravel its secrets.\n\nShe decided to embark on a journey to find the answers she sought. With the notebook clutched tightly in her hand, Alice ventured into the heart of the forbidden forest. The dense trees whispered ancient tales of forgotten knowledge as she made her way through the winding paths.\n\nAfter what felt like an eternity, Alice stumbled upon an enchanted clearing. In the center, an old man stood, surrounded by a swirling mist of numbers and symbols. He introduced himself as Professor Arithmetos, the guardian of the forest and the keeper of all mathematical secrets.\n\nEager to learn, Alice poured out her troubles to the wise professor. She shared the mathematical problem she had discovered in the notebook and asked for his guidance. Professor Arithmetos listened intently, his eyes sparkling with wisdom. He spoke of unique lines that could be formed by joining each point with every other point, lines extended indefinitely in both directions.\n\nAs the professor explained the intricacies of the problem, Alice's imagination soared. She envisioned a world where lines crossed and intersected, weaving a captivating tapestry of mathematics. She saw beauty in the numbers, and the lines danced before her eyes.\n\nDeep in thought, Alice wondered how the number of lines in the set and the sum of their crossings affected the sequence of generated points. She pondered the significance of M(Ln) and S(Ln) and their relationship to the points themselves. Determined to find the truth, she took on the challenge.\n\nDays turned into weeks as Alice delved deeper into the problem, her mind consumed by the enigma. She spent countless hours crisscrossing the lines, mapping the intersections, and devising complex calculations. The notebook became her constant companion, filled with scribbles and formulas.\n\nAs Alice tirelessly worked to find the answer, a question began to form in her mind. A question that would bring clarity and closure to her journey. A question she knew she had to ask the readers of her story:\n\nWhat is S(L2500)?\n\nWith a deep sense of anticipation, Alice closed the ancient notebook and returned to the town of Arithmia. The townspeople marveled at her determination and admired her quest for knowledge. They eagerly awaited the moment when Alice would share her findings and reveal the path to the elusive S(L2500).\n\nAnd so, dear reader, I pose this question to you now. Will you be the one to uncover the answer and solve the mathematical mystery that has captivated Alice's heart?"}, {"id": 659, "euler_id": 659, "title": "Largest prime", "problem": "\nConsider the sequence  n2+3 with n\u22651.  \nIf we write down the first terms of this sequence we get:\n4,7,12,19,28,39,52,67,84,103,124,147,172,199,228,259,292,327,364,... .\nWe see that the terms for n=6 and n=7 (39 and 52) are both divisible by 13.\nIn fact 13 is the largest prime dividing any two successive terms of this sequence.\n\n\nLet P(k) be the largest prime  that divides any two successive terms of the sequence n2+k2.\n\n\nFind the last 18 digits of \u2211k=110000000P(k).\n", "solution": "238518915714422000", "difficulty": 20, "story": "Once upon a time in the mystical land of Numeria, there lived a young and curious mathematician named Lily. She had a deep passion for numbers and spent her evenings exploring their enchanting properties. One day, while perusing an ancient numerical tome, she stumbled upon an intriguing sequence - n\u00b2 + 3, where n was greater than or equal to 1.\n\nLily began calculating the first few terms of this sequence and discovered a fascinating pattern. The initial values were 4, 7, 12, 19, 28, and so on. As she delved deeper into the sequence, Lily noticed something remarkable - the terms for n = 6 and n = 7, specifically 39 and 52, were divisible by 13.\n\nHer eyes widened with excitement. Could it be that 13 was the largest prime number dividing any two consecutive terms? With this newfound revelation, Lily scribbled down her hypothesis and embarked on a quest to confirm it.\n\nShe devoured every book on primes, divisors, and sequences that she could find. The library became her second home as she immersed herself in the world of numbers, tirelessly cracking their secrets. Lily's dedication and resolve were unwavering. She knew that if she could prove her hypothesis, it would be a mathematical breakthrough.\n\nAfter countless weeks spent poring over ancient texts, her efforts bore fruit. Lily discovered that indeed 13 was the largest prime number dividing any two successive terms of the sequence n\u00b2 + 3. It was an astounding revelation that brought her both joy and a sense of accomplishment.\n\nCompletely enraptured by her discovery, Lily decided to delve deeper into the sequence. She wondered if there was a way to generalize this phenomenon for any k, where k represented different values added to n\u00b2. She defined P(k) as the largest prime dividing any two consecutive terms of the sequence n\u00b2 + k\u00b2.\n\nAs she toiled over her research late into the night, Lily's mind brimmed with possibilities. She imagined a world where P(k) became a crucial tool for understanding the intricate relationships between the numbers in this captivating sequence. But her restless mind craved more. Lily yearned to know the sum of all P(k) from 1,100,000,000 onwards.\n\nThe numbers danced in front of her eyes, beckoning her to uncover their secrets. Fueled by a relentless desire to solve this mathematical puzzle, she found herself drifting further into a world of calculations, losing track of time.\n\nAnd so, dear reader, as Lily's story unfolds and her journey through the mystical land of Numeria continues, we leave you with one question. Can you discover the last 18 digits of \u2211k=110000000 P(k)? Only by diving deep into the magical realm of mathematics can you uncover the answer that lies within this enigmatic sequence.\n\nWill you accept the challenge, dear reader, and embark on your own quest for the solution?"}, {"id": 668, "euler_id": 668, "title": "Square root smooth Numbers", "problem": "\nA positive integer is called square root smooth if all of its prime factors are strictly less than its square root.\nIncluding the number 1, there are 29 square root smooth numbers not exceeding 100.\n\n\nHow many square root smooth numbers are there not exceeding 10000000000?", "solution": "2811077773", "difficulty": 20, "story": "Once upon a time in a small village nestled deep in the valleys, an old man named Benjamin lived a quiet and peaceful life. Benjamin was known far and wide for his remarkable talent in brewing the finest herbal potions, much sought after by those who needed healing. His potions were concoctions of rare herbs and plants, carefully blended together to create magic in a bottle.\n\nOne sunny morning, as Benjamin made his way to the marketplace carrying his basket of herbs, he noticed a peculiar gathering around the village square. Curiosity piqued, he joined the crowd and saw a notice posted on the grand oak tree, written in bold letters.\n\n\"Attention, villagers!\" the notice read. \"A mysterious illness has befallen our beloved queen, and no cure has been able to heal her. The royal physicians have exhausted all their knowledge, and now a reward is offered to anyone who can cure her.\"\n\nThe announcement brought a somber mood to the village, and a sense of urgency filled the air. As Benjamin read the notice, his heart skipped a beat. His potions seemed to be the only hope left for their queen. Without wasting another moment, he rushed back to his humble abode to brew a special elixir for the ailing queen.\n\nFor days and nights, Benjamin toiled tirelessly, experimenting with different combinations of rare herbs and plants. But no matter how hard he tried, the elixir failed to heal the queen. Doubt and frustration started to creep into Benjamin's mind. Had his knowledge failed him this time?\n\nIn the midst of his despair, a ray of hope appeared in the form of a young girl named Emily. Emily was a precocious child with a keen interest in mathematics. With her curious mind, she often sought Benjamin's guidance whenever she encountered an intriguing problem. Little did she know that her passion for numbers would eventually play a crucial role in the quest to cure the queen.\n\nOne afternoon, as Emily sat at the foot of Benjamin's porch solving a challenging math problem, she couldn't help but notice the exhaustion etched onto the old man's face. Concerned, she asked, \"What's troubling you, Benjamin?\"\n\nBenjamin sighed deeply, placing the failed elixir aside. \"Dear Emily, I fear my knowledge of herbs and potions is not enough to heal the queen. The illness that plagues her seems to be beyond my understanding.\"\n\nEmily's eyes sparkled with an idea. \"Do you think, perhaps, we could approach the queen's illness with a different perspective? Maybe applying mathematical principles could help?\"\n\nBenjamin looked at her, intrigued yet doubtful. \"How could numbers possibly heal a person?\"\n\nEmily smiled and explained, \"Numbers hold infinite possibilities, just like the herbs you use in your potions. There's a fascinating mathematical problem that I've been pondering. It's called the square root smooth numbers. I believe it might hold the key to understanding the queen's illness.\"\n\nIntrigued, Benjamin leaned in closer as Emily explained the concept of square root smooth numbers\u2014that they're positive integers whose prime factors are all smaller than their square root. She also shared that there were 29 such numbers not exceeding 100.\n\nListening to Emily's explanation, Benjamin's eyes widened with a newfound glimmer of hope. Could this mathematical problem indeed hold the answer to the queen's illness?\n\nWith renewed determination, Benjamin and Emily spent days and nights delving into the world of mathematics and herbs, combining both their expertise to create a groundbreaking solution. They weaved numbers and botanical knowledge together, forming an intricate tapestry of possibilities.\n\nAs the final elixir took shape in Benjamin's cauldron, they looked at each other, their hearts filled with anticipation. They had come so far in their quest to cure the queen, but would their efforts bear fruit?\n\nAnd so, with the elixir in hand, Benjamin and Emily made their way to the grand castle, where they presented their creation to the queen's advisors. The moment of truth arrived as the queen herself took a cautious sip of the potion.\n\nWeeks passed, and the village held its breath, waiting for news of the queen's recovery. And then, one glorious day, the castle's bells tolled, announcing the joyous news. The queen had regained her strength, her illness vanquished by the magic of Benjamin and Emily's joint effort.\n\nOverwhelmed with gratitude, the queen summoned Benjamin and Emily to her chamber. With tears of joy streaming down her face, she embraced them and expressed her deepest gratitude. Their curing potion had not only healed her, but it had also rekindled hope and prosperity throughout the kingdom.\n\nAs they stood before the queen, basking in the glory of their accomplishment, Emily's question echoed in their minds\u2014how many square root smooth numbers were there not exceeding 10,000,000,000?\n\nDear reader, as the tale of Benjamin, Emily, and the queen comes to a close, I pose the same question to you. Do you have the mathematical prowess to solve the riddle of square root smooth numbers?"}, {"id": 679, "euler_id": 679, "title": "Freefarea", "problem": "Let S be the set consisting of the four letters {`A',`E',`F',`R'}.\nFor n\u22650, let S\u2217(n) denote the set of words of length n consisting of letters belonging to S.\nWe designate the words FREE,FARE,AREA,REEF as keywords.\nLet f(n) be the number of words in S\u2217(n) that contains all four keywords exactly once.\nThis first happens for n=9, and indeed there is a unique 9 lettered word that contain each of the keywords once: FREEFAREA\nSo, f(9)=1.\nYou are also given that f(15)=72863.\nFind f(30).", "solution": "644997092988678", "difficulty": 20, "story": "Once upon a time in the mystical land of Numeria, there lived a young and curious wizard named Ardent. Ardent possessed an extraordinary gift for mathematics and was always eager to explore new mathematical problems. His curiosity led him to discover a peculiar amulet hidden deep within the Numerian Forest. The amulet sparkled with an otherworldly glow and bore four inscriptions - the letters 'A,' 'E,' 'F,' and 'R.' Little did Ardent know that this amulet would soon propel him into a remarkable adventure, intertwined with mathematical marvels.\n\nIntrigued by the amulet's enchanting presence, Ardent decided to decipher its purpose by using his mathematical prowess. He observed that the four letters on the amulet made up a set named S. Studying the amulet further, he discovered that it wasn't just an ordinary trinket but a magical artifact with extraordinary properties.\n\nArdent soon realized that the amulet held the key to unlocking a world of words. For every non-negative integer, n, the set S could be combined to form words of length n, creating the set S\u2217(n). However, the magical amulet had a secret power - it designated four specific words as keywords: FREE, FARE, AREA, and REEF.\n\nAs Ardent delved deeper into the mystery, he uncovered a mathematical question linked to the amulet. He sought to determine the number of words in S\u2217(n) that contained all four keywords exactly once. This mathematical count was represented by the function f(n).\n\nDriven by his insatiable curiosity, Ardent began his quest to solve the mathematical problem that lay dormant within the amulet. He spent numerous sleepless nights, exploring the intricacies of the problem, trying to unravel the patterns and connections between the words in S\u2217(n).\n\nFinally, after months of tireless effort and countless scribbles on parchment, Ardent stumbled upon a breakthrough. He found that the first occurrence of a word in S\u2217(n) containing all four keywords precisely once happened when n equaled nine. In a moment of pure mathematical triumph, Ardent discovered a unique nine-lettered word that encompassed each of the keywords once - FREEFAREA.\n\nWith this newfound knowledge, Ardent was able to determine that f(9) equaled one. The satisfaction of solving this puzzle ignited an even greater ambition in the young wizard's heart. He yearned to uncover the value of f(30), knowing it would require an extraordinary feat of perseverance and mathematical wizardry.\n\nAs he delved deeper into his quest, Ardent came across a mysterious scroll hidden within the depths of Numeria's Great Library. The scroll revealed that f(15) had a value of 72863. This astonishing revelation only fueled Ardent's determination to unlock the answer to f(30), a number that would undoubtedly be immense and awe-inspiring.\n\nBut as Ardent ventured further into his exploration, he realized that the solution to f(30) existed beyond the confines of the scroll. It lay within the uncharted realm of imagination and mathematical discovery, urging him to explore further and unearth the elusive numerical truth.\n\nNow, dear reader, the question lies before you. With the amulet's enigma and Ardent's journey in your mind's eye, will you embark on this captivating quest? Can you deduce the incomprehensible value of f(30)? The answer awaits your mathematical acumen, your determination, and your insatiable quest for knowledge. Can you find the numerical treasure that lay hidden within the wondrous world of S\u2217(n)?\n\nWhat is f(30)? The story is yours to continue..."}, {"id": 688, "euler_id": 688, "title": "Piles of Plates", "problem": "\nWe stack n plates into k non-empty piles where each pile is a different size. Define f(n,k) to be the maximum number of plates possible in the smallest pile. For example when n=10 and k=3 the piles 2,3,5 is the best that can be done and so f(10,3)=2. It is impossible to divide 10 into 5 non-empty differently-sized piles and hence f(10,5)=0.\n\n\nDefine F(n) to be the sum of f(n,k) for all possible pile sizes k\u22651. For example F(100)=275.\n\n\nFurther define S(N)=\u2211n=1NF(n). You are given S(100)=12656.\n\n\nFind S(1016) giving your answer modulo 1000000007.\n", "solution": "110941813", "difficulty": 20, "story": "Once upon a time, in the distant land of Numeria, there was a young and ambitious mathematician named Alice. Alice possessed a keen mind and an insatiable curiosity for all things numerical. She spent her days exploring complex mathematical problems and seeking solutions that would unravel the mysteries of the world.\n\nOne day, as Alice was flipping through old manuscripts in the dusty attic of the Numerian Academy, she stumbled upon an ancient scroll. The scroll contained the tale of the enchanted plates, a problem that had captivated mathematicians throughout the ages.\n\nAccording to the legend, there existed an enchanted set of n plates. These plates possessed magical properties that could only be unlocked by stacking them into k non-empty piles, each with a different size. The size of a pile was defined as the number of plates it contained. To make matters more challenging, the piles had to be arranged in such a way that the smallest pile held the maximum number of plates possible.\n\nIntrigued by this enchanting problem, Alice decided to delve deeper into its depths. She took it upon herself to solve this conundrum, uncovering the secrets hidden within the scroll.\n\nAs she pondered over the problem, Alice realized that finding the maximum number of plates in the smallest pile was pivotal to her journey. This value was represented by a function called f(n, k). For every possible pile size, k, Alice had to determine the largest possible number of plates that could be placed in the smallest pile.\n\nAlice's mind raced with numbers and possibilities. She scribbled equations, drew diagrams, and crunched numbers until her eyes grew weary. As the days turned into nights, the piles of parchment papers filled with calculations piled up around her.\n\nHer perseverance paid off when she finally cracked the code and found the answers she was seeking. With the knowledge in hand, Alice realized that the sum of f(n, k) for all possible pile sizes k \u2265 1 was a crucial factor in the story of the enchanted plates. This sum was known as F(n), a value that held the key to unlocking the plates' magical secrets.\n\nTo put her newfound knowledge to the test, Alice began experimenting with various values of n. She found that when n equaled 100, the sum of all possible f(n, k) values amounted to 275. It was a remarkable discovery, confirming the power of her calculations and the significance of F(n).\n\nAs her excitement grew, Alice pondered the ultimate question that swirled around in her mind. She wondered what the sum of F(n) would be for the mind-boggling value of n equals 1016. This was no easy feat, for it required her to consider exceptionally large numbers and contend with their intricacies.\n\nSitting at her desk, surrounded by piles of mathematical texts and illuminated by flickering candlelight, Alice's quest stretched into the night. She lost track of time, lost in the beauty and complexity of her calculations. And finally, as the first light of dawn painted the sky, Alice completed her computations.\n\nWith bated breath, she looked at the result: S(1016) equaled 12656. Her heart swelled with pride at the enormity of her achievement. She had unraveled the mystery, solved the riddle, and found the answer hidden within the numbers. Yet, one question lingered, tugging at her mathematical curiosity.\n\nDear reader, can you find the answer to this question? What is the value of S(1016) modulo 1000000007? As you embark on your own mathematical journey, may the enchantment of the plates inspire you, and may the numbers reveal their secrets to you."}, {"id": 704, "euler_id": 704, "title": "Factors of Two in Binomial Coefficients", "problem": "\nDefine g(n,m) to be the largest integer k such that 2k divides (nm). \nFor example, (125)=792=23\u22c532\u22c511, hence g(12,5)=3. \nThen define F(n)=max{g(n,m):0\u2264m\u2264n}. F(10)=3 and F(100)=6.\n\n\nLet S(N) = \u2211n=1NF(n). You are given that S(100)=389 and S(107)=203222840.\n\n\nFind S(1016).\n", "solution": "501985601490518144", "difficulty": 20, "story": "Once upon a time in the Kingdom of Mathopia, there lived a young and ambitious mathematician named Ethan. From a very young age, Ethan had a gift for numbers and patterns, and his dream was to solve the unsolvable.\n\nEthan's life was governed by the pursuit of knowledge and understanding. He spent his days poring over ancient texts, scribbling equations on parchment, and engaging in lively debates with fellow scholars. His heart was set on uncovering the secrets of the mathematical world.\n\nOne day, as Ethan was engrossed in his research, a mysterious visitor appeared at his door. It was an old sage, known for his cryptic riddles and enigmatic wisdom. The sage was holding a scroll, which he handed to Ethan with a knowing smile.\n\n\"Take this, young Ethan,\" the sage said, his eyes twinkling with mischief. \"This scroll contains a mathematical problem that has perplexed even the greatest minds of Mathopia. Solve it, and you shall be rewarded with unimaginable knowledge. Fail, and your quest for enlightenment will be forever tarnished.\"\n\nEthan's curiosity soared as he unfurled the scroll. The mathematical problem before him was unlike anything he had ever encountered. It spoke of the function g(n,m) and its relationship to numbers and divisibility. The problem intrigued him, captured his imagination, and he knew that its solution would unlock a new realm of understanding.\n\nDays turned into weeks, and weeks into months as Ethan delved into the depths of the problem. He studied the intricacies of divisibility, the properties of primes, and the patterns that emerged from g(n,m). He scribbled countless equations on parchment, filling every inch of his study with symbols and calculations. And yet, the solution continued to elude him.\n\nBut Ethan was not one to give up. His determination fueled his perseverance, and he redoubled his efforts. He sought advice from other mathematicians, he attended conferences and seminars, and he even embarked on a pilgrimage to consult the wisest sages in distant lands.\n\nYears flew by, and Ethan's obsession with the problem grew. The scroll had become his constant companion, always by his side, a tangible reminder of the quest that consumed his life. The mathematical conundrum had not only become an academic challenge but a defining aspect of his identity.\n\nFinally, after a lifetime of diligent pursuit, Ethan felt a spark of enlightenment flicker within him. Suddenly, the patterns aligned, the dots connected, and the solution shimmered tantalizingly close. With bated breath, he pressed his quill to the parchment, ready to etch the elusive solution.\n\nBut then, doubt crept in, like a whisper in the wind. \"What if the solution I've found is wrong? What if I've wasted my life chasing a futile dream?\" Ethan's mind was clouded with uncertainty, his hand poised, but hesitant.\n\nIn that moment of doubt, a gentle voice echoed in his mind. It was the voice of the old sage, reminding him of the rewards that awaited him should he succeed. The voice reminded him of the power of knowledge, the fulfillment of understanding, and the legacy he would leave behind.\n\nWith renewed resolve, Ethan's quill danced across the parchment. He carefully recorded his solution, capturing the essence of the mathematical problem that had consumed him for so long. And as he finished, a sense of accomplishment flooded over him, mingling with his thirst for more.\n\nBut the journey was far from over. With his solution in hand, Ethan realized there was another challenge ahead, the quest for the sum of F(n) for all numbers from 1 to N. His eyes darted to the last line of the scroll, as he read about the enigmatic function S(N) and the tantalizing sums that lay hidden within it.\n\nThe question hanging in the air begged for an answer. What would S(1016) be? Ethan's heart raced as he contemplated the magnitude of the problem, the scope of the challenge ahead. This endeavor would demand all his ingenuity, all his perseverance, and push the limits of his understanding.\n\nAnd so, Ethan's journey continued, with a new purpose and unyielding determination. He threw himself into the pursuit of S(1016), leaving behind a legacy of inspiration and the burning desire to uncover the secrets that lie within the realm of mathematics.\n\nDear reader, can you unlock the mysteries that eluded Ethan? What is S(1016)? Will you embark on this mathematical voyage and solve the unsolvable?"}, {"id": 706, "euler_id": 706, "title": "3-Like Numbers", "problem": "\nFor a positive integer n, define f(n) to be the number of non-empty substrings of n that are divisible by 3. For example, the string \"2573\" has 10 non-empty substrings, three of which represent numbers that are divisible by 3, namely 57, 573 and 3. So f(2573)=3.\n\n\nIf f(n) is divisible by 3 then we say that n is 3-like.\n\n\nDefine F(d) to be how many d digit numbers are 3-like. For example, F(2)=30 and F(6)=290898.\n\n\nFind F(105). Give your answer modulo 1000000007.\n", "solution": "884837055", "difficulty": 20, "story": "Once upon a time in the peaceful village of Arithmia, there lived a young girl named Lily. Lily was known for her exceptional ability to solve problems, particularly those involving numbers and patterns. Her mind was a shining beacon of mathematical brilliance that inspired both awe and admiration from her peers.\n\nOne sunny day, as she ventured through the village, she stumbled upon a dusty old book in the corner of the local library. Intrigued, Lily carefully opened the worn pages, revealing a world of hidden secrets and enigmatic puzzles.\n\nHer eyes flitted across the pages until they settled upon a curious mathematical problem. It was unlike anything she had ever encountered before. For a positive integer n, it defined f(n) to be the number of non-empty substrings of n that were divisible by 3. Lily's mind instantly began to churn, captivated by the complexity of the problem.\n\nAs she delved deeper into the book, Lily discovered that numbers that were divisible by 3 were considered \"3-like\". Furthermore, F(d) denoted the count of d-digit numbers that were 3-like. This piqued her interest even further, and she couldn't help but wonder how the values of F(d) would change as d increased.\n\nDays turned into weeks, and weeks into months, as Lily devoted her time to unravelling the mysteries of the book. The villagers marveled at her dedication and enthusiasm, often finding her engrossed in solving mathematical problems. She would spend hours scribbling numbers and formulas on scraps of paper, her mind consumed by the elegance of numbers.\n\nSoon, Lily's love for numbers began to spread throughout Arithmia. Children waved their hands in the air, excitedly sharing their findings on mathematical sequences, while adults scratched their heads in amazement at the unexpected harmony of the universe that numbers presented.\n\nMonths turned into years, and Lily, now a young woman, had become a respected mathematician. Still, the book's problem haunted her. What was the value of F(105)? She had explored various patterns and formulas, but the solution continued to elude her.\n\nAs the people of Arithmia celebrated Lily's success, their smiles concealed a collective anticipation. They wondered if Lily had finally uncovered the answer to the elusive problem that had captivated their imaginations for so long.\n\nAnd so, with the village gathered around her, Lily stood in front of a chalkboard, ready to share her findings. It was a pivotal moment, not just for Lily but for the entire village of Arithmia.\n\nLily looked around, her gaze meeting those of her friends, family, and fellow villagers. Confidence radiated from her eyes as she spoke, her voice filled with determination.\n\n\"I have dedicated years to understanding the magic of numbers, of patterns weaved into the fabric of arithmetic. But now, I stand before you all, with one final piece of the puzzle missing.\"\n\nWhispers of anticipation filled the air as everyone held their breath.\n\n\"My question, my friends, is this: What is the value of F(105)?\"\n\nSilence enveloped the village as Lily's question hung in the air, a challenge that beckoned the villagers to dive deep into the depths of mathematical exploration. The stage was set, and the people of Arithmia would now embark on a journey of discovery, following in Lily's footsteps.\n\nCan you solve the mystery that has captivated the village of Arithmia for so long? What is the value of F(105)? Only with your keen eye and mathematical prowess can the hidden answer be unveiled."}, {"id": 713, "euler_id": 713, "title": "Tur\u00e1n's water heating system", "problem": "\nTuran has the electrical water heating system outside his house in a shed. The electrical system uses two fuses in series, one in the house and one in the shed. (Nowadays old fashioned fuses are often replaced with reusable mini circuit breakers, but Turan's system still uses old fashioned fuses.)\nFor the heating system to work both fuses must work.\n\n\nTuran has N fuses. He knows that m of them are working and the rest are blown. However, he doesn't know which ones are blown. So he tries different combinations until the heating system turns on.\nWe denote by T(N,m) the smallest number of tries required to ensure the heating system turns on.\nT(3,2)=3 and T(8,4)=7.\n\n\nLet L(N) be the sum of all T(N,m) for 2\u2264m\u2264N.\nL(103)=3281346\n\n\nFind L(107).\n", "solution": "788626351539895", "difficulty": 20, "story": "Once upon a time in a small town called Oakdale, there lived a man named Turan. Turan was a simple, hardworking individual who cherished the peace and tranquility of his quiet neighborhood. He had a beautiful house that he took great pride in, but there was one thing that troubled him. His electrical water heating system, which was essential for his comfort, was located outside in a shed.\n\nTuran's heating system used two fuses, one in the house and one in the shed, to ensure its proper functioning. Unlike modern circuit breakers, Turan's system still relied on old-fashioned fuses. And so, whenever a fuse was blown, Turan would have to replace it.\n\nOne day, Turan noticed that his heating system was not working. He figured that one or both of the fuses must have blown. Determined to fix the problem, he inspected his collection of fuses and found that he had N of them in total. However, he did not know which ones were blown, only that m of them were still functioning.\n\nNot one to shy away from a challenge, Turan devised a plan. He decided to try different combinations of fuses until he found the correct arrangement that would make the heating system turn on. Each time he attempted a combination, he would note whether the system started working or not.\n\nAs he went about his task, Turan discovered an intriguing pattern. The number of tries required to ensure the heating system turned on, denoted by T(N,m), seemed to vary based on the total number of fuses and the number of functioning fuses. For example, he found that T(3,2) was 3 and T(8,4) was 7.\n\nThis mathematical problem fascinated Turan, and he began to wonder if there was a general relationship between the number of fuses and the number of tries required. To explore this further, he decided to calculate L(N), which represented the sum of all T(N,m) for 2 to N. Curious as to what he might discover, Turan embarked on a mathematical journey.\n\nDays turned into weeks as Turan immersed himself in calculations, experimenting with various scenarios and analyzing the results. His house was filled with papers scattered about, filled with intricate equations and formulas. Coffee cups and food wrappers lay neglected as he became consumed by his research.\n\nFinally, one day, Turan arrived at a breakthrough. He found that L(103) equaled 3,281,346. The revelation left him astounded, realizing that his efforts had not been in vain. The sum of T(N,m) for 2 to 103 was a significant number, and he wondered what it might be for an even larger value.\n\nNow, dear reader, the question is posed to you. Can you find L(107), the sum of T(N,m) for 2 to 107? Take a moment to ponder this mathematical riddle. Behind those numbers lies a story waiting to be unraveled."}, {"id": 731, "euler_id": 731, "title": "A Stoneham Number", "problem": "\nA=\u2211i=1\u221e13i103i\n\n\nDefine A(n) to be the 10 decimal digits from the nth digit onward. \nFor example, A(100)=4938271604 and A(108)=2584642393.\n\n\nFind A(1016)\n", "solution": "6086371427", "difficulty": 20, "story": "Once upon a time, in a quaint little village nestled between rolling hills, there lived a gifted mathematician named Amelia. She had always been fascinated by numbers, finding solace and beauty in their patterns and relationships. Amelia's passion for math had earned her the respect and admiration of the villagers, who often sought her guidance when faced with challenging numerical problems.\n\nOne sunny afternoon, as Amelia was walking through the village square, she noticed a small crowd gathered around a notice board. Intrigued, she made her way through the curious onlookers to read the message posted thereon. It was an invitation to participate in a prestigious math competition, promising glory and honor to the winner.\n\nAmelia's heartbeat quickened with excitement. This was her chance to showcase her skills and make her village proud. Without hesitation, she signed up for the competition and began her rigorous training regimen in the hopes of emerging victorious.\n\nDays turned into weeks, and weeks into months, as Amelia toiled away, immersing herself in equations, formulas, and mathematical riddles. Determined not to leave any stone unturned, she delved into research, consulting ancient texts and devouring mathematical theories. It was during one of her late-night study sessions that she stumbled upon a problem that would test her mettle like never before.\n\nThe problem posed an infinite series that seemed both perplexing and fascinating to Amelia. It read:\n\nA = \u2211i=1\u221e 13^i / 103^i\n\nUnable to resist the allure of such a conundrum, Amelia set out to find the solution. She spent countless nights unraveling the intricate calculations, seeking patterns and emerging trends. Gradually, she discovered that the sum of the series equated to a certain digit sequence with an endless string of decimal places.\n\nAs she stumbled upon this realization, a realization that seemed to illuminate the dark corners of her mind, a question weighed heavily on her heart. The moment had arrived to put her newfound knowledge to the ultimate test.\n\nSummoning her courage, Amelia signed the final entry form, submitting it to the competition organizers. With a spark in her eyes and her heart filled with excitement, she wondered how they would react to the tantalizingly enigmatic query:\n\n\"Find A(10^16).\"\n\nAs Amelia waited anxiously to hear the outcome of the competition and how others would tackle the elusive A(10^16), she couldn't help but ponder the inherent beauty of mathematics. Its ability to combine logic, creativity, and curiosity was truly extraordinary.\n\nNow, dear reader, it is your turn to embrace the mathematical baton. Solve the riddle of A(10^16) and unearth the hidden wonders that lie within the infinite reaches of this numeric realm. Can you unveil the ten decimal digits from the 10^16th digit onward? What secrets does this mathematical enigma hold?"}, {"id": 754, "euler_id": 754, "title": "Product of Gauss Factorials", "problem": "The Gauss Factorial of a number n is defined as the product of all positive numbers \u2264n that are relatively prime to n. For example g(10)=1\u00d73\u00d77\u00d79=189. \nAlso we define\nG(n)=\u220fi=1ng(i)\nYou are given G(10)=23044331520000.\nFind G(108). Give your answer modulo 1000000007.", "solution": "785845900", "difficulty": 20, "story": "Once upon a time in the enchanting kingdom of Numeria, a young and curious mathematician named Anna lived. Anna had a knack for numbers and had always been fascinated by the mysteries they held. She enjoyed spending her days exploring the vast landscapes of Numeria, seeking the hidden patterns and puzzles that lay beneath the surface.\n\nOne sunny day, as the birds chirped a melodious tune, an aged mathematician named Professor Hubble paid Anna a visit. The Professor was renowned for his wisdom and had spent years unraveling the secrets of the numbers that governed Numeria.\n\n\"Ah, my dear Anna,\" Professor Hubble beamed, \"I have a most perplexing problem for you today. Have you ever heard of the Gauss Factorial?\"\n\nAnna's eyes sparkled with excitement as she shook her head. \"Tell me more, Professor.\"\n\nThe Professor began to explain the concept of the Gauss Factorial to Anna. He delved into the intricacies, describing how it was the product of all positive numbers less than or equal to 'n' that were relatively prime to 'n'. Anna listened intently, captivated by the idea.\n\n\"To put it simply,\" the Professor continued, \"the Gauss Factorial is a way to measure the uniqueness of a number. For example, g(10) is equal to multiplying 1, 3, 7, and 9, which gives us 189. It tells us how many unique paths a number can take to reach its destination.\"\n\nAnna's curiosity piqued, she asked, \"But what about G(n)? What does it signify?\"\n\nProfessor Hubble smiled, intrigued by Anna's enthusiasm. \"G(n) is the product of the Gauss Factorial of all numbers from 1 to 'n.' It represents the cumulative uniqueness of all the numbers in that range. It's a fascinating concept, isn't it?\"\n\nAnna's mind raced with possibilities. In her heart, she knew that uncovering the value of G(108) would unlock the mysteries hidden within the kingdom of Numeria. She realized that this quest was more than just a mathematical puzzle; it held the key to unraveling the secrets of the universe itself.\n\nAs Anna delved deeper into her research, she discovered ancient scrolls and manuscripts that hinted at the immense power G(108) possessed. Legends whispered of a great power, only attainable through the understanding of this mathematical enigma.\n\nThe young mathematician's determination burned brighter with each passing day. She knew that finding the value of G(108) was a duty she owed to herself, the kingdom, and the countless generations to come.\n\nAnd so, dear reader, the story of Anna's quest begins. Will she uncover the hidden value of G(108)? Can she solve the mathematical riddle that holds the secrets of Numeria?\n\nNow, it is up to you, dear reader, to continue Anna's journey. Solve the mathematical problem that has eluded her and uncover the value of G(108). As the sun sets on Numeria, answer me this: What is G(108), modulo 1000000007?\n\nMay your wisdom guide you on your mathematical odyssey."}, {"id": 772, "euler_id": 772, "title": "Balanceable k-bounded partitions", "problem": "A k-bounded partition of a positive integer N is a way of writing N as a sum of positive integers not exceeding k.\nA balanceable partition is a partition that can be further divided into two parts of equal sums.\nFor example, 3+2+2+2+2+1 is a balanceable 3-bounded partition of 12 since 3+2+1=2+2+2. Conversely, 3+3+3+1 is a 3-bounded partition of 10 which is not balanceable.\nLet f(k) be the smallest positive integer N all of whose k-bounded partitions are balanceable. For example, f(3)=12 and f(30)\u2261179092994(mod1000000007).\nFind f(108). Give your answer modulo 1000000007.", "solution": "83985379", "difficulty": 20, "story": "Once upon a time in the bustling kingdom of Mathlandia, there lived a young princess named Amelia. Princess Amelia was known for her insatiable curiosity and love for numbers. She would spend hours exploring the enchanting gardens, finding patterns in flowers and counting the petals. Her favorite place, however, was the Royal Library, filled with books on all things mathematical.\n\nOne sunny afternoon, Princess Amelia stumbled upon a particularly intriguing book in the library. Its pages were filled with complex equations, elegant theorems, and challenging puzzles. Among them, she found a mathematical problem that caught her eye - the k-bounded partition.\n\nAs Princess Amelia delved deeper into the problem, she became fascinated by the concept of balanceable partitions. The idea that a partition could be divided into two equal sums fascinated her. She realized that this mathematical problem was no ordinary puzzle but held the key to something much more substantial.\n\nEager to unravel the mystery, Princess Amelia embarked on a quest throughout the kingdom. She sought the wisdom of renowned mathematicians, wise sages, and even traveled to distant lands where numbers held mystical powers. But no matter where she went, she couldn't find the answer she sought - the smallest positive integer N whose k-bounded partitions were all balanceable.\n\nWith each failure, Princess Amelia's determination grew stronger. She refused to give up, for she knew that the answer was out there, waiting to be discovered. Day and night, she pondered, calculated, and contemplated, trying to unlock the secrets of the k-bounded partition.\n\nMonths turned into years, and Princess Amelia's quest became legendary. Her unyielding dedication to solving this mathematical problem inspired mathematicians all around the world. People marveled at her unwavering spirit, for she had become synonymous with the pursuit of knowledge.\n\nFinally, after years of tireless effort, Princess Amelia found herself at the top of a towering mountain in a land shrouded in mist. She stood before a wise old man, the last hope for an answer. He studied her with wise eyes, deep in thought. Moments later, he spoke in a voice as old as time.\n\n\"Princess Amelia, you have filled the world with wonder and awe through your pursuit of knowledge. Your journey has been long and arduous, but now, I shall reveal the path you seek.\"\n\nPrincess Amelia's heart leaped with excitement. The wise old man continued, \"The answer lies within the numbers themselves, for they hold the key to their own secrets. Seek the balance through one hundred and eight, and the answer you shall find.\"\n\nWith these cryptic words, the wise old man vanished into thin air, leaving Princess Amelia spellbound.\n\nThe princess sat alone on the mountaintop, contemplating the old man's words. She realized that her journey had come full circle. The answer she sought wasn't hidden within ancient tomes or distant lands; it was within her all along.\n\nAs the sun set behind the mountains, Princess Amelia smiled, her heart filled with resolve. She knew what she had to do. She would return to Mathlandia and find f(108). But this time, she wouldn't be alone. The entire kingdom would join her as they embraced the power of numbers and unraveled the mysteries of the k-bounded partition.\n\nNow, dear readers, the quest passes onto you. Can you help Princess Amelia find f(108)? What is the smallest positive integer N all of whose 108-bounded partitions are balanceable? The answer lies within, waiting for you to discover."}, {"id": 793, "euler_id": 793, "title": "Median of Products", "problem": "\nLet Si be an integer sequence produced with the following pseudo-random number generator:\n\n\nS0=290797\n Si+1=Si2mod50515093\n\n\nLet M(n) be the median of the pairwise products SiSj for 0\u2264i<j<n.\n\n\nYou are given M(3)=3878983057768 and M(103)=492700616748525.\n\n\nFind M(1000003).\n", "solution": "475808650131120", "difficulty": 20, "story": "Once upon a time, in the small village of Numeria, there lived a talented young mathematician named Samuel. Samuel was not like the other villagers; his mind was constantly swirling with numbers and equations. He found solace and excitement in the world of mathematics, often spending his days lost in complex mathematical problems.\n\nOne day, while Samuel was wandering through the village, he stumbled upon an old dusty book hidden deep within the shelves of the local library. The book was worn, its pages yellowed with age, but the title caught Samuel's attention: \"The Mysterious Sequence.\"\n\nCuriosity piqued, Samuel pulled the book from the shelf and began flipping through its pages. As he read, his eyes widened with fascination. The book explained a mathematical problem so perplexing that it had remained unsolved for centuries.\n\nThe problem dealt with a sequence of numbers generated by a pseudo-random number generator. Samuel's heart raced with excitement as he absorbed every detail. The sequence, labeled Si, was generated using a simple formula.\n\nThe book revealed the initial value of S0 as 290797, and instructed that each subsequent term Si+1 was to be calculated by squaring the previous term Si and finding the remainder when divided by 50515093.\n\nAs Samuel delved deeper into the problem, he discovered that the true quest lay in finding the median of the pairwise products of the numbers in the sequence. This was represented by the function M(n), where n indicated the number of terms in the sequence.\n\nThe book provided two examples. It mentioned that M(3) was equal to 3878983057768 and M(103) was equal to 492700616748525. But the ultimate challenge lay in finding M(1000003), which Samuel knew would be an astronomical figure far beyond his wildest dreams.\n\nDetermined to unlock the secrets of this mysterious sequence, Samuel devoted his days and nights to solving the problem. He scribbled countless equations on his chalkboard, lost in his own mathematical realm.\n\nThe villagers, intrigued by Samuel's obsession, would often stop by his little cottage to see if he had made any progress. But every time they asked, Samuel's response remained the same \u2013 a smile masking his determination.\n\nMonths went by, and hope began to waver. Samuel's once bright eyes dimmed, weary from countless failed attempts. Doubt crept into his mind, and the weight of the unsolved problem bore heavily on his shoulders. \n\nOne rainy afternoon, as Samuel was lost in his thoughts, he received a visitor. A wise old man, dressed in a tattered cloak, appeared at his doorstep. He introduced himself as Mathias, a renowned mathematician who had traveled far and wide in search of knowledge.\n\nMathias took notice of Samuel's despondent expression and the worn-out equations scribbled on his chalkboard. With a gentle smile, he approached the young mathematician.\n\n\"Samuel,\" Mathias said, his voice calm and reassuring. \"Do not let despair cloud your mind. Remember, sometimes the answers we seek are hidden where we least expect them.\"\n\nCuriosity sparked within Samuel's heart as he listened to Mathias's wisdom. He had become so focused on finding M(1000003) that he had overlooked other avenues of inspiration.\n\nIn that moment, Samuel realized that he had been searching for enlightenment in his confined world of numbers. He understood that to find the answer, he needed to embrace the world beyond mathematics, to draw inspiration from nature and the enigmas of life itself.\n\nWith renewed hope, Samuel set aside his chalkboard and ventured into the village, observing the world with fresh eyes. He admired the pattern of leaves on the trees, the symphony of sounds carried through the wind.\n\nDays turned into weeks, and as Samuel immersed himself in the wonders of life, something remarkable happened \u2013 a spark of inspiration struck his mind like a bolt of lightning. He saw a connection between the patterns in nature and the mysterious sequence he had sought to unravel.\n\nReturning to his cottage, Samuel scribbled furiously on his chalkboard, his fingers tracing the delicate links between the two worlds. Equations formed coherent patterns, and Samuel's heart raced with excitement.\n\nAfter endless nights of calculations and moments of pure revelation, Samuel finally stood before his chalkboard, his eyes fixed on a new equation, holding the key to the unsolved problem.\n\nAs he read the solution, he felt a mixture of exhilaration and awe. The answer was nothing short of miraculous, a testament to the beauty and complexity of the mathematical universe.\n\nBut dear reader, the story does not end here. It is now your turn to embark on this quest. Can you find M(1000003)? Can you unlock the secrets of the mysterious sequence and discover the median of the pairwise products?\n\nAs Samuel gazes at you expectantly, his eyes filled with anticipation, the question lingers in the air, waiting for your response. Can you solve the mathematical problem?"}, {"id": 804, "euler_id": 804, "title": "Counting Binary Quadratic Representations", "problem": "Let g(n) denote the number of ways a positive integer n can be represented in the form: x2+xy+41y2 where x and y are integers. For example, g(53)=4 due to (x,y)\u2208{(\u22124,1),(\u22123,\u22121),(3,1),(4,\u22121)}.\nDefine T(N)=\u2211n=1Ng(n). You are given T(103)=474 and T(106)=492128.\nFind T(1016).", "solution": "4921370551019052", "difficulty": 20, "story": "Once upon a time in the land of Mathoria, there lived a young adventurer named Luna. Luna had always been fascinated by numbers and enjoyed solving complex mathematical problems. She would spend her days exploring the enchanted forests and solving puzzles left behind by the ancient mathematicians.\n\nOne sunny day, while wandering through the mystical woods, Luna stumbled upon a hidden scroll. Intrigued, she unrolled it and discovered a mathematical problem that had intrigued mathematicians for centuries. It was an ancient riddle that had remained unsolved for generations.\n\nThe riddle read, \"Let g(n) denote the number of ways a positive integer n can be represented in the form: x\u00b2 + xy + 41y\u00b2, where x and y are integers. For example, g(53)=4 due to (x, y)\u2208{(\u22124, 1),(\u22123, \u22121),(3, 1),(4, \u22121)}. Define T(N)=\u2211n=1Ng(n). You are given T(10\u00b3)=474 and T(10\u2076)=492128. Find T(10\u00b9\u2076).\"\n\nLuna's eyes grew wide with excitement. She knew that this was no ordinary riddle. \"This must be the key to unlocking a powerful spell or a hidden treasure,\" she thought. Determined to solve it, she embarked on a quest to find the answer.\n\nAs Luna traveled through Mathoria, she encountered many wise mathematicians who had spent countless years trying to solve the riddle. Each one shared their extensive knowledge, giving her valuable insights that allowed her to uncover patterns and relationships within the mathematical problem.\n\nShe spent days and nights pouring over equations, furiously scribbling numbers onto parchment, and testing out different formulas. Every breakthrough brought her closer to the answer, but it seemed that the solution lay just beyond her reach. Nevertheless, Luna refused to give up.\n\nMonths turned into years, and still, Luna persisted. She sought out the guidance of legendary mathematicians and absorbed their wisdom like a sponge. She even began to dream about the problem, piecing it together in her sleep.\n\nFinally, after what felt like an eternity, Luna had a revelation. The answer to the riddle became clear in her mind, and she eagerly calculated the value of T(10\u00b9\u2076). It was a number so vast that it was hard to comprehend. Luna's heart swelled with pride and satisfaction, knowing that she had accomplished what so many before her had failed to do.\n\nBut as she basked in her achievement, a question formed in her mind, one that cast a shadow of doubt over her triumph. She wondered if the true purpose of the mathematical riddle went beyond finding a numerical solution. Perhaps it was meant to test her perseverance and determination, to remind her of the true power of curiosity and the journey of learning.\n\nWith a renewed spark in her eyes, Luna closed her eyes and whispered her question to the sky. \"Mathematical riddle, what is the true meaning behind your numbers? What secrets lie within your equations? And what other wonders await those who dare to unravel the mysteries of the mathematical universe?\"\n\nAnd so, dear reader, the question now falls upon you. Can you find T(10\u00b9\u2076) and help Luna uncover the hidden secrets of the mathematical riddle? The answer awaits your exploration and understanding."}, {"id": 810, "euler_id": 810, "title": "XOR-Primes", "problem": "We use x\u2295y for the bitwise XOR of x and y.\nDefine the XOR-product of x and y, denoted by x\u2297y, similar to a long multiplication in base 2, except that the intermediate results are XORed instead of the usual integer addition.\nFor example, 7\u22973=9, or in base 2, 1112\u2297112=10012:\n\u22971111112\u22971111112\u22971111112\u22951111129\u22971110012\nAn XOR-prime is an integer n greater than 1 that is not an XOR-product of two integers greater than 1. The above example shows that 9 is not an XOR-prime. Similarly, 5=3\u22973 is not an XOR-prime. The first few XOR-primes are 2,3,7,11,13,... and the 10th XOR-prime is 41.\nFind the 5000000th XOR-prime.", "solution": "124136381", "difficulty": 20, "story": "Once upon a time in the peaceful kingdom of Numeria, numbers were more than just symbols on a page. They were alive, with personalities and stories of their own. The kingdom was filled with vibrant digits, wandering from realm to realm, seeking adventure and fulfillment.\n\nIn one secluded corner of Numeria lived a quiet and introverted digit named Xero. Xero was an unusual number, known for his innate ability to unravel even the most complex puzzles. His love for mathematics was insatiable, and he spent his days embarked on endless mathematical journeys.\n\nOne sunny morning, as Xero was immersed in his latest mathematical conundrum, a faint whisper tickled his ears. \"Xero, dear Xero,\" a mysterious voice beckoned. Curiosity drove him to step out and explore the kingdom, following the ethereal voice echoing through the meandering streets.\n\nGuided by the whispers, Xero found himself standing before a towering gate. The entrance was adorned with inscriptions that gleamed in golden hues, capturing his attention. The mysterious voice spoke again, \"Xero, you have been chosen to embark on a quest that will change the fate of Numeria forever.\"\n\nEager to prove himself, Xero cautiously opened the gate, revealing a magnificent hall bathed in radiant light. Inside, a wise and venerable digit named Prime stood, waiting with a sparkle in his eyes. \"Xero, my dear apprentice, you possess a remarkable talent for mathematics. I have chosen you for a task of immense importance.\"\n\nPrime explained that the kingdom of Numeria was facing a grave threat - the invasion of XOR-primes. These elusive and dangerous numbers wreaked havoc upon the balance of the kingdom, using their unique properties to manipulate the very essence of mathematics. Prime revealed that XOR-primes were created from the XOR-products of two integers greater than 1.\n\n\"Xero, my apprentice, the only way to defeat these chaotic XOR-primes is by finding the 5000000th XOR-prime. We must uncover its secret and undo the evil it has wrought upon us,\" Prime declared, urgency resonating in his voice.\n\nDetermined to protect his beloved kingdom, Xero accepted the challenge with unwavering resolve. Armed with his mathematical prowess, he ventured into the heart of Numeria, exploring libraries, hidden caves, and the wisest digits scattered across the realm.\n\nMonths turned into years, and Xero's dedication never wavered. He pulled numbers apart, examined their souls, and attempted to piece together the hidden patterns that would lead him to the 5000000th XOR-prime. The adventure was arduous, fraught with uncertainties and dead-ends, but Xero persevered, spurred on by his love for Numeria.\n\nAs the days bled into years, Xero's journey transformed him. The once introverted digit now radiated confidence and resilience. He had become an emblem of hope, inspiring the numbers around him with his relentless pursuit.\n\nNow, as Xero stands atop a precipice, overlooking the vast expanse of Numeria, he contemplates the journey thus far. The 5000000th XOR-prime eludes him still, but there is an air of anticipation in the kingdom. Will Xero solve the riddle that will restore peace to Numeria? Will he uncover the secret of this elusive number? Only time, and his undying determination, will tell.\n\nDear reader, as you join Xero on his courageous quest, I leave you with a question that echoes through the corridors of Numeria. Can you find the 5000000th XOR-prime, and bring an end to the chaos that looms over this beloved realm?"}, {"id": 813, "euler_id": 813, "title": "XOR-Powers", "problem": "We use x\u2295y to be the bitwise XOR of x and y.\nDefine the XOR-product of x and y, denoted by x\u2297y, similar to a long multiplication in base 2, except that the intermediate results are XORed instead of the usual integer addition.\nFor example, 11\u229711=69, or in base 2, 10112\u229710112=10001012:\n\u2297111110112\u2297111110112\u2297111110112\u2297111101129\u2295110112999\u22971110001012\nFurther we define P(n)=11\u2297n=11\u229711\u2297\u2026\u229711\u23den. For example P(2)=69.\n\nFind P(812\u22c5128). Give your answer modulo 109+7.", "solution": "14063639", "difficulty": 20, "story": "Once upon a time, in the kingdom of Mathopia, there lived a talented alchemist named Eloise. Eloise had always been fascinated by numbers and their many secrets, often spending her days delving into complex mathematical problems. Her curiosity led her on a continuous quest to discover new ways to apply her knowledge and create extraordinary potions.\n\nOne day, while tinkering in her lab, Eloise stumbled upon an ancient book that contained a spell of great power. The spell promised to unlock the hidden potential of any potion, but it required the alchemist to solve a challenging mathematical problem.\n\nIntrigued, Eloise read the problem, her eyes scanning the intricate equations, and the formulas spun a vivid story in her mind. She immersed herself in the world of numbers, where x\u2295y represented the bitwise XOR of x and y, and x\u2297y the XOR-product. The alchemist's eyes sparkled with excitement as she visualized the process, perceiving it as a form of long multiplication in base 2, only substituting addition with XOR operations.\n\nAs Eloise progressed through the problem, the XOR-product unfolded before her, revealing its potential to enhance her creations. She realized that this magical product, denoted as P(n), could hold the key to unraveling the full potency of her potions. She quickly realized that P(2) was equal to 69, and the possibilities seemed endless.\n\nEloise's mind raced with ideas. She imagined concocting potions that could heal the sick, grant eternal youth, or even turn common stones into gold. With P(n) on her side, she had the potential to revolutionize the alchemical world and bring prosperity to her beloved kingdom.\n\nThe alchemist's excitement grew, and she knew that her next great experiment would be to find P(812\u22c5128). This number, born from the multiplication of 812 and 128, held the promise of unimaginable power. Just the thought of what it could accomplish made her heart race.\n\nBut as Eloise prepared to undertake this epic mathematical challenge, doubt began to creep into her mind. What if she failed? What if her calculations were wrong, and her precious potions turned into disasters? The weight of her decision hung heavily upon her, and she pondered the consequences of her actions.\n\nShould she dare to unleash the power of P(812\u22c5128)? Was this the path her destiny sought, or should she close the book and let this opportunity fade away? The alchemist's fingers trembled as she held the ancient spell in her hands, torn between her thirst for knowledge and the fear of failure.\n\nThe ancient book remained open before Eloise, its pages calling to her, demanding an answer. The fate of her magical journey, the impact upon her kingdom, rested upon her decision.\n\nAnd so, dear reader, I pose this question to you: Should Eloise embark on this perilous quest to find P(812\u22c5128), risking her reputation, her dreams, and the balance of Mathopia itself? Will you help her explore the depths of this mathematical labyrinth, or will you let this opportunity pass?\n\nThe power of P(812\u22c5128) lies within your hands. What will you do?"}, {"id": 817, "euler_id": 817, "title": "Digits in Squares", "problem": "\nDefine m=M(n,d) to be the smallest positive integer such that when m2 is written in base n it includes the base n digit d. For example, M(10,7)=24 because if all the squares are written out in base 10 the first time the digit 7 occurs is in 242=576. M(11,10)=19 as 192=361=2A911.\n\nFind \u2211d=1105M(p,p\u2212d) where p=109+7.", "solution": "93158936107011", "difficulty": 20, "story": "Once upon a time in the vibrant city of Mathematica, there lived a young and curious mathematician named Alice. Alice had a unique gift for unraveling complex mathematical problems, always seeking the beauty that lay in their elegant solutions. But there was one problem that had been eluding her for quite some time - a problem that danced on the tip of her mind like a mischievous equation.\n\nOne sunny morning, as Alice was walking through a bustling marketplace, she stumbled upon a peculiar stall covered in vibrant equations and mathematical puzzles. A kind old man sat behind the stall, his eyes shining with wisdom and curiosity.\n\nIntrigued, Alice approached the old man and asked, \"Sir, do you have any mathematical riddles or puzzles that might challenge me?\"\n\nWith a gentle smile, the old man responded, \"Ah, my dear Alice, I have just the puzzle for you.\" He handed her a slip of paper with the following problem written on it:\n\n\"Define m=M(n,d) to be the smallest positive integer such that when m^2 is written in base n it includes the base n digit d. For example, M(10,7)=24 because if all the squares are written out in base 10 the first time the digit 7 occurs is in 242=576. M(11,10)=19 as 192=361=2A911.\n\nFind \u2211d=1105M(p,p\u2212d) where p=109+7.\"\n\nAlice's eyes lit up with excitement. She had never encountered a problem of this nature before. She knew that this problem revolved around finding the smallest square number that contained a specific digit when written in a given base. Little did she know that her journey to solve this problem would take her to the very heart of Mathematica's mysteries.\n\nDetermined to conquer the problem, Alice dove into her research, poring over old books, discussing with fellow mathematicians, and attending lectures, searching for clues hidden within the enigmatic world of numbers. Day after day, she struggled to find the elusive solution, her mind consumed by this mathematical enigma.\n\nWeeks turned into months, and Alice's obsession began to concern her loved ones. Her once cheerful demeanor dimmed, her thoughts consumed by the riddle that proved to be a formidable opponent. The countless hours spent hunched over her desk began to take their toll.\n\nOne evening, Alice decided to take a much-needed break from her research and went for a long walk under the starlit sky. She found herself meandering through the ancient streets of Mathematica, where whispers of mathematical secrets seemed to float through the air.\n\nLost in her thoughts, Alice stumbled upon an opulent library tucked away in a hidden corner of the city. The library was unlike any she had ever seen, its shelves soaring high into the heavens, teeming with ancient tomes that held the wisdom of countless generations of mathematicians.\n\nAlice stepped inside and was immediately enveloped by the tranquil aura of knowledge emanating from the books around her. Guided by an unseen force, she found herself in front of a dusty old volume with ornate golden lettering on its cover - \"The Riddle of Numbers.\"\n\nCuriosity ignited within Alice as she gingerly opened the book, and her eyes fell upon a chapter titled \"Mysterious Digits: A Path to Infinity.\" As she read, her heart skipped a beat - the chapter described the very mathematical problem that had plagued her for so long.\n\nWith newfound hope, Alice delved deep into the chapter, immersing herself in the intricacies of the problem. Every page she turned revealed new insights, new connections, leading her closer and closer to a solution.\n\nDays turned into weeks as Alice raced against time, pouring over page after page, equation after equation, seeking the hidden patterns and elusive answers to the riddle that had captivated her for what felt like an eternity. And finally, like a flickering light breaking through the darkness, it came to her - a glimmer of understanding, a potential solution to the problem that had consumed her every waking moment.\n\nWith a mind buzzing with excitement, Alice found herself once again standing in front of the old man's stall. When he saw the spark in her eyes, his smile widened, as though he had been waiting for her return.\n\n\"Have you found the solution?\" he asked gently.\n\nAlice took a deep breath and responded, \"I believe I have, but it's an answer that raises more questions. The path I've treaded to reach this point was a testament to the intricate nature of numbers and their endless mysteries. My journey would be incomplete without sharing this puzzle with others. So, dear sir, I ask you, will you carry this problem forward to others, to challenge their minds, and unearth the hidden beauty within?\"\n\nAs the old man took the slip of paper from Alice's hands, he nodded knowingly. \"I shall do as you ask, my dear Alice. Your passion and determination have brought you here today. May this problem ignite a spark in others, just as it has done for you.\"\n\nWith a grateful smile, Alice bid the old man farewell, knowing that she had shared something special with him - a puzzle that had become a part of her being.\n\nAnd so, dear reader, I ask you now: Can you solve the mathematical problem that Alice spent months unraveling? Can you find \u2211d=1105M(p,p\u2212d) where p=109+7?"}]